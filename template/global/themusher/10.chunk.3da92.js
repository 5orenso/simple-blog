(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"5l0g":function(e,t,a){"use strict";(function(e){function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var n,c=a("hosL"),i=(a("Utv1"),a("/eY4")),o=(a("OhSV"),a("cneo"),a("HqZR")),l=(a("ZOvn"),{showAddComment:!1}),d=Object(i.a)(n=function(t){function a(e){var a;return(a=t.call(this,e)||this).state=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},l),a.updateTimer={},a.inputRef={},a}var n,i;i=t,(n=a).prototype=Object.create(i.prototype),n.prototype.constructor=n,n.__proto__=i;var d=a.prototype;return d.loadHeatmap=function(){return new Promise(function(e,t){return this.setState({isLoading:!0}),Promise.resolve(this.props.stores.adminStore.getPublicHeatmap(this.props.raceid)).then(function(){try{return this.setState({isLoading:!1}),e()}catch(e){return t(e)}}.bind(this),t)}.bind(this))},d.componentDidMount=function(){this.loadHeatmap()},d.render=function(){var t=this.props,a=t.waypoints,s=t.zoomToMarkers,r=t.mapid,n=t.fullscreenMap,i=this.props.stores.adminStore.publicHeatmap;return Object(c.h)(e,null,Object(c.h)(o.a,{stores:this.props.stores,mapId:i.length,heatmap:i,minZoom:2,maxZoom:18,height:600,waypoints:a,zoomToMarkers:s,fullscreenMap:n,key:"map-"+r}))},a}(c.Component))||n;t.a=d}).call(this,a("hosL").Fragment)},"8gML":function(e,t,a){"use strict";(function(e){function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var n,c=a("hosL"),i=a("Utv1"),o=a("/eY4"),l=a("OhSV"),d=(a("go65"),a("RMlE"),a("5l0g"),a("ZOvn")),h=(d.a.marginTop(!0),d.a.marginBottom(),d.a.subMenuMarginTop(),{isLoading:!1,email:"",submenu:"ads",jwtToken:i.a.getJwtToken()}),b=Object(o.a)(n=function(t){function a(e){var a;return(a=t.call(this,e)||this).state=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},h),a}var n,i;return i=t,(n=a).prototype=Object.create(i.prototype),n.prototype.constructor=n,n.__proto__=i,a.prototype.render=function(){var t=this.props,a=t.raceid,s=t.path,r=this.props.stores.appState.darkmode,n="default";return s.match(/\/race\/:raceid$/)?n="default":s.match(/\/race\/:raceid\/mushers$/)?n="mushers":s.match(/\/race\/:raceid\/results$/)?n="results":s.match(/\/race\/:raceid\/media$/)?n="media":s.match(/\/race\/:raceid\/tracking$/)&&(n="tracking"),Object(c.h)(e,null,Object(c.h)("div",{class:"row fixed-top pr-3",style:"margin-top: 40px; background-color: "+(r?"#191d21":"#f8f9fa")+";"},Object(c.h)("div",{class:"col-12 my-2 mx-2"},Object(c.h)("ul",{class:"nav nav-pills nav-fill flex-nowrap"},Object(c.h)("li",{class:"nav-item",style:"max-width: 20%;"},Object(c.h)("a",{href:"/race/"+a,class:"text-overflow nav-link "+("default"===n?"active":"")},Object(c.h)("nobr",null,Object(c.h)("i",{class:"fas fa-info-circle"})," ",Object(c.h)(l.c,{id:"race.therace"},"LÃ¸pet")))),Object(c.h)("li",{class:"nav-item",style:"max-width: 20%;"},Object(c.h)("a",{href:"/race/"+a+"/mushers",class:"text-overflow nav-link "+("mushers"===n?"active":"")},Object(c.h)("nobr",null,Object(c.h)("i",{class:"fas fa-users"})," ",Object(c.h)(l.c,{id:"race.mushers"},"Deltakere")))),Object(c.h)("li",{class:"nav-item",style:"max-width: 20%;"},Object(c.h)("a",{href:"/race/"+a+"/results",class:"text-overflow nav-link "+("results"===n?"active":"")},Object(c.h)("nobr",null,Object(c.h)("i",{class:"fas fa-poll"})," ",Object(c.h)(l.c,{id:"race.results"},"Resultater")))),Object(c.h)("li",{class:"nav-item",style:"max-width: 20%;"},Object(c.h)("a",{href:"/race/"+a+"/media",class:"text-overflow nav-link "+("media"===n?"active":"")},Object(c.h)("nobr",null,Object(c.h)("i",{class:"fas fa-images"})," ",Object(c.h)(l.c,{id:"race.media"},"Bilder")))),Object(c.h)("li",{class:"nav-item",style:"max-width: 20%;"},Object(c.h)("a",{href:"/race/"+a+"/tracking",class:"text-overflow nav-link "+("tracking"===n?"active":"")},Object(c.h)("nobr",null,Object(c.h)("i",{class:"fas fa-map-marked-alt"})," ",Object(c.h)(l.c,{id:"race.tracking"},"Tracking"))))))))},a}(c.Component))||n;t.a=b}).call(this,a("hosL").Fragment)},"9lZG":function(e,t,a){"use strict";(function(e){var s,r=a("hosL"),n=a("Utv1"),c=a("/eY4"),i=a("OhSV"),o=a("go65"),l=a("om2D"),d=a("ZOvn"),h=Object(c.a)(s=function(t){function a(e){var a;return(a=t.call(this,e)||this).beforeImagesUploaded=function(){a.setState({sendButtonEnabled:!1})},a.afterImagesUploaded=function(){a.setState({sendButtonEnabled:!0})},a.commentRace=function(){return new Promise((function(e,t){var s,r,n,c,i,o,l,h,b,u,p;return a.state.sendButtonEnabled?(n=void 0===(r=(s=a.props).callback)?function(){}:r,i=void 0===(c=s.inputRefObject)?{}:c,o=a.props.race,l=a.props.stores.raceStore,b=(h=a.state).comment,u=h.showAddImage,a.setState({sendButtonEnabled:!1}),Promise.resolve(l.commentRace({id:o.id,comment:b})).then((function(s){try{return(p=s)&&200===p.status&&(a.setState({comment:{body:"",images:[]}},(function(){d.a.resizeTextarea(i[o.id]),u&&a.addImage()})),n({race:o,response:p})),a.setState({sendButtonEnabled:!0}),e()}catch(e){return t(e)}}),t)):e(!1)}))},a.addImages=function(e){var t,s=a.state.comment;(t=s.images).push.apply(t,e.value),a.setState({comment:s})},a.addImage=function(){var e=a.state.showAddImage;a.setState({showAddImage:!(void 0!==e&&e)})},a.handleImageErrored=function(e){var t=e.target;t.onerror=null,setTimeout((function(){t.src+="?"+new Date}),1e3)},a.state={comment:{body:"",images:[]},showAddImage:!1,sendButtonEnabled:!0},a.inputRef={},a}var s,c;return c=t,(s=a).prototype=Object.create(c.prototype),s.prototype.constructor=s,s.__proto__=c,a.prototype.render=function(){var t=this,a=this.props,s=a.inputRef,c=a.race,h=this.state,b=h.comment,u=h.showAddImage,p=h.sendButtonEnabled,m=this.props.stores.userStore.user,g=void 0===m?{}:m,f=d.a.displayNameShort(g),O=(d.a.displayName(g),g.image||(g.images?g.images[0]:void 0));return Object(r.h)(e,null,Object(r.h)("div",null,Object(r.h)("div",{class:"d-flex mb-0 position-relative w-100"},Object(r.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall",style:(O?"background-image: url('"+O.s3SmallLink+"'); background-size: cover;":"")+" border-width: 3px !important;"},!O&&Object(r.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},f)),Object(r.h)("div",{class:"col pl-3",style:"line-height: 1.2em;"},Object(r.h)("div",{class:"d-flex bd-highlight"},Object(r.h)("div",{class:"p-0 w-100 bd-highlight"},Object(r.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(r.h)(i.c,{id:"comments.comment"},"Kommentar")),Object(r.h)("div",{class:"border rounded rounded-lg position-relative"},Object(r.h)(i.b,null,Object(r.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(r.h)(i.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(o.a)(this,"comment.body"),onKeyUp:d.a.resizeTextarea,onFocus:d.a.resizeTextarea,style:"height: 2.3em;",value:b.body,ref:s})),Object(r.h)("div",{class:"position-absolute",style:"top: 8px; right: 10px; font-size: 1.2em;"},Object(r.h)("i",{class:"fas fa-image pointerCursor","data-id":c.id,onClick:this.addImage})))),Object(r.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(r.h)("button",{type:"button",class:"btn btn-"+(p?"primary":"secondary")+" mb-2",disabled:!p,onClick:this.commentRace},Object(r.h)("i",{class:"fas fa-paper-plane"})))))),u&&Object(r.h)(e,null,Object(r.h)("div",{class:"col-12 text-center"},Object(r.h)("div",{class:"container-fluid"},Object(r.h)("div",{class:"row"},n.a.isArray(b.images)&&b.images.map((function(e){return Object(r.h)("div",{class:"col-3 p-1"},Object(r.h)("img",{src:e.s3SmallLink,class:"img-fluid",onError:t.handleImageErrored}),Object(r.h)("button",{class:"btn btn-sm btn-link",onClick:t.removeImage,"data-name":e.name},Object(r.h)("i",{class:"fas fa-trash"})," ",Object(r.h)(i.c,{id:"comments.remove-image"},"Remove")))})))),Object(r.h)(l.a,{object:b,updateField:this.addImages,before:this.beforeImagesUploaded,after:this.afterImagesUploaded,autoOpen:!0})))))},a}(r.Component))||s;t.a=h}).call(this,a("hosL").Fragment)},LMwI:function(e){e.exports={pointerCursor:"pointerCursor__1W6mM"}},RMlE:function(e,t,a){"use strict";function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var n,c=a("hosL"),i=a("ox/y"),o=(a("Utv1"),a("/eY4")),l=(a("go65"),a("Y3FI")),d=a("OhSV"),h=(a("LMwI"),{menu:{profile:!1,main:!1},searchText:""}),b=Object(o.a)(n=function(e){function t(t){var a;return(a=e.call(this,t)||this).toggleDropdown=function(e){var t=a.state.menu,s=e.target.dataset.name;!s&&e.target.parentNode&&(s=e.target.parentNode.dataset.name),s&&(t[s]=!t[s]),a.setState({menu:t})},a.toggleDarkmode=function(e){a.props.stores.appState.toggleDarkmode(),a.toggleDropdown(e)},a.toggleViewmode=function(e){var t=e.target.dataset.mode;!t&&e.target.parentNode&&(t=e.target.parentNode.dataset.mode),a.props.stores.appState.toggleViewmode(t),a.toggleDropdown(e)},a.reloadApp=function(){window.location.reload(!0)},a.adminLoadAll=function(){return new Promise((function(e,t){return Promise.resolve(a.props.stores.userStore.getInfo(!0)).then((function(){try{return e()}catch(e){return t(e)}}),t)}))},a.changeLanguage=function(e){var t=e.target.value;console.log("changeLanguage",t);var s=a.props.stores,r=s.appState,n=s.userStore,c=n.user,i=void 0===c?{}:c;i.email&&n.setLanguage({email:i.email,language:t}),r.setLanguage(t)},a.search=function(){var e=a.state.searchText;Object(l.route)("/search/"+e)},a.state=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},h),a}var a,n;return n=e,(a=t).prototype=Object.create(n.prototype),a.prototype.constructor=a,a.__proto__=n,t.prototype.render=function(){var e=this.state,t=e.menu,a=this.props.stores,s=a.appState,r=a.userStore,n=s.darkmode,o=r.user,l=r.notifications,h=((void 0===l?[]:l).filter((function(e){return!e.read})),o.language),b=void 0===h?"en":h;return Object(c.h)("nav",{class:"navbar navbar-expand-lg navbar-themed fixed-top py-1",style:"z-index: 99999;"},Object(c.h)("a",{class:"navbar-brand",href:"/race/"},Object(c.h)("img",{src:"./assets/homerun-race-logo-2-"+(n?"white-":"")+"small.png",height:"37",class:"position-absolute",style:"top: 5px; left: 6px"}),Object(c.h)("span",{class:"font-weight-normal",style:"margin-left: 30px; font-size: 20px;"},"Homerun Race")),Object(c.h)("button",{class:"navbar-toggler",type:"button","data-name":"main",onClick:this.toggleDropdown},Object(c.h)("span",{class:"navbar-toggler-icon"})),Object(c.h)("div",{class:"collapse navbar-collapse "+(t.main?"show":""),id:"navbarSupportedContent"},Object(c.h)("ul",{class:"navbar-nav mr-auto ml-5"},Object(c.h)("li",{class:"nav-item"},Object(c.h)(i.Link,{className:"nav-link",activeClassName:"active",href:"/race","data-name":"main",style:"font-size: 1.0em !important;",onClick:this.toggleDropdown},Object(c.h)("i",{class:"fas fa-flag-checkered"})," ",Object(c.h)(d.c,{id:"header.races"},"LÃ¸pene"))),Object(c.h)("li",{class:"nav-item"},Object(c.h)(i.Link,{className:"nav-link",activeClassName:"active",href:"/race/support","data-name":"main",style:"font-size: 1.0em !important;",onClick:this.toggleDropdown},Object(c.h)("i",{class:"far fa-question-circle"})," ",Object(c.h)(d.c,{id:"header.support"},"Support"))),Object(c.h)("li",{class:"nav-item"},Object(c.h)(i.Link,{className:"nav-link",activeClassName:"active",href:"/race/news","data-name":"main",style:"font-size: 1.0em !important;",onClick:this.toggleDropdown},Object(c.h)("i",{class:"fas fa-quote-right"})," ",Object(c.h)(d.c,{id:"header.news"},"Nyheter")))),Object(c.h)("ul",{class:"navbar-nav ml-auto "},Object(c.h)("li",{class:"nav-item mr-2"},Object(c.h)("div",{class:"form-row align-items-center"},Object(c.h)("div",{class:"col-auto my-1",style:"width: 80px;"},Object(c.h)("select",{class:"custom-select",style:"background-color: inherit; border: none; padding: 0; height: 1.1em; font-size: 0.9em;",onInput:this.changeLanguage},Object(c.h)("option",{value:"no",selected:"no"===b},"ð³ð´ NO"),Object(c.h)("option",{value:"en",selected:"en"===b},"ð¬ð§ EN"),Object(c.h)("option",{value:"es",selected:"es"===b},"ðªð¸ ES"),Object(c.h)("option",{value:"de",selected:"de"===b},"ð©ðª DE"),Object(c.h)("option",{value:"fr",selected:"fr"===b},"ð«ð· FR"),Object(c.h)("option",{value:"ru",selected:"ru"===b},"ð·ðº RU"),Object(c.h)("option",{value:"se",selected:"se"===b},"ð¸ðª SE"))))),Object(c.h)("li",{class:"nav-item d-block d-lg-none"},Object(c.h)(i.Link,{className:"nav-link",activeClassName:"active","data-name":"main",onClick:this.toggleDarkmode},Object(c.h)("i",{class:(n?"fas text-warning":"far")+" fa-moon"})," ",Object(c.h)(d.c,{id:"header.darkmode"},"Nattmodus"))),Object(c.h)("li",{class:"nav-item mr-2 d-none d-lg-block"},Object(c.h)("button",{class:"btn btn-link","data-name":"profile",onClick:this.toggleDarkmode},Object(c.h)("i",{class:(n?"fas text-warning":"far")+" fa-moon"}))))))},t}(c.Component))||n;t.a=b},UUHd:function(e,t,a){"use strict";var s,r=a("hosL"),n=(a("Utv1"),a("/eY4")),c=a("OhSV"),i=a("go65"),o=a("ZOvn"),l=Object(n.a)(s=function(e){function t(){for(var t,a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(t=e.call.apply(e,[this].concat(s))||this).commentRace=function(){return new Promise((function(e,a){var s,r,n,c,i,o;return n=void 0===(r=(s=t.props).callback)?function(){}:r,c=t.props.race,i=t.state.comment,Promise.resolve(t.props.stores.raceStore.commentReplyRace({id:c.id,commentId:s.commentId,comment:void 0===i?"":i})).then((function(s){try{return(o=s)&&200===o.status&&(t.setState({comment:""}),n({race:c,response:o})),e()}catch(e){return a(e)}}),a)}))},t}var a,s;return s=e,(a=t).prototype=Object.create(s.prototype),a.prototype.constructor=a,a.__proto__=s,t.prototype.render=function(){var e=this.props.inputRef,t=this.state.comment,a=this.props.stores.userStore.user,s=void 0===a?{}:a,n=o.a.displayNameShort(s),l=(o.a.displayName(s),s.image||(s.images?s.images[0]:void 0));return Object(r.h)("div",{class:"w-100"},Object(r.h)("div",{class:"d-flex mb-0 position-relative w-100"},Object(r.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedThumb",style:(l?"background-image: url('"+l.s3SmallLink+"'); background-size: cover;":"")+" border-width: 3px !important;"},!l&&Object(r.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},n)),Object(r.h)("div",{class:"col pl-3",style:"line-height: 1.2em;"},Object(r.h)("div",{class:"d-flex bd-highlight"},Object(r.h)("div",{class:"p-0 w-100 bd-highlight"},Object(r.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(r.h)(c.c,{id:"comments.comment"},"Kommentar")),Object(r.h)(c.b,null,Object(r.h)("textarea",{class:"form-control rounded-lg",type:"text",placeholder:Object(r.h)(c.c,{id:"comments.write-reply"},"Write a reply..."),onInput:Object(i.a)(this,"comment"),onKeyUp:o.a.resizeTextarea,onFocus:o.a.resizeTextarea,style:"height: 2.3em;",value:t,ref:e}))),Object(r.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(r.h)("button",{type:"button",class:"btn btn-sm btn-primary mb-2",onClick:this.commentRace},Object(r.h)("i",{class:"fas fa-paper-plane"})))))))},t}(r.Component))||s;t.a=l},Ysxg:function(e,t,a){"use strict";(function(e){function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var n,c=a("hosL"),i=a("Utv1"),o=a("/eY4"),l=a("cneo"),d=a("OhSV"),h=a("fh8t"),b=a.n(h),u=a("go65"),p=a("UUHd"),m=a("ZOvn"),g={showAddComment:{},showAllComments:!1,showAllReplies:{},viewImageIdx:{},likeComment:{},likeReply:{},showOriginal:{}},f=Object(o.a)(n=function(t){function a(e){var a;return(a=t.call(this,e)||this).addLikeComment=function(e){return new Promise((function(t,s){var r,n,c,i,o,l,d;return n=void 0===(r=a.props.callback)?function(){}:r,c=e.target.closest(".commentContainer").dataset.id,i=a.props.race,o=a.props.stores.raceStore,(l=a.state.likeComment)[c]=!0,a.setState({likeComment:l}),setTimeout((function(){var e=a.state.likeComment;delete e[c],a.setState({likeComment:e})}),1200),Promise.resolve(o.likeRaceComment({id:i.id,commentId:c})).then((function(e){try{return(d=e)&&200===d.status&&n({type:"likeComment",race:i,commentId:c,response:d}),t(!0)}catch(e){return s(e)}}),s)}))},a.likeReply=function(e){return new Promise((function(t,s){var r,n,c,i,o,l,d,h;return n=void 0===(r=a.props.callback)?function(){}:r,c=e.target.closest(".replyContainer").dataset.id,i=e.target.closest(".replyContainer").dataset.comment,o=a.props.race,l=a.props.stores.raceStore,(d=a.state.likeReply)[c]=!0,a.setState({likeReply:d}),setTimeout((function(){var e=a.state.likeReply;delete e[c],a.setState({likeReply:e})}),1200),Promise.resolve(l.likeRaceCommentReply({id:o.id,replyId:c,commentId:i})).then((function(e){try{return(h=e)&&200===h.status&&n({type:"likeReply",race:o,commentId:i,replyId:c,response:h}),t()}catch(e){return s(e)}}),s)}))},a.replyComment=function(e){return new Promise((function(t){var s=e.target.parentElement.dataset.id||e.target.dataset.id,r=a.state.showAddComment;return r[s]=!r[s],a.setState({showAddComment:r},(function(){a.inputRef[s]&&a.inputRef[s].focus()})),t()}))},a.toggleComments=function(){a.setState({showAllComments:!a.state.showAllComments})},a.toggleReplies=function(e){var t=e.target.parentElement.dataset.id||e.target.dataset.id,s=a.state.showAllReplies;s[t]=!s[t],a.setState({showAllReplies:s})},a.toggleMenu=function(e){var t=e.target.closest("i").dataset.id,s=a.state.showMenu,r=void 0===s?{}:s;r[t]=!r[t],a.setState({showDeleteComment:{},showEdit:{},showMenu:r})},a.toggleEdit=function(e){var t=e.target.closest("button").dataset,s=t.id,r=t.comment,n=a.state.showEdit,c=void 0===n?{}:n;c[s]=!c[s],a.setState({showDeleteComment:{},showEdit:c,showMenu:{},commentEditText:r})},a.toggleDeleteComment=function(e){var t=e.target.closest("button").dataset.id,s=a.state.showDeleteComment,r=void 0===s?{}:s;r[t]=!r[t],a.setState({showDeleteComment:r,showEdit:{},showMenu:{}})},a.deleteComment=function(e){return new Promise((function(t,s){var r;return r=e.target.closest("button").dataset.id,Promise.resolve(a.props.stores.raceStore.deleteCommentRace({id:a.props.race.id,commentId:r})).then((function(){try{return a.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}}),t()}catch(e){return s(e)}}),s)}))},a.deleteCommentReply=function(e){return new Promise((function(t,s){var r;return r=e.target.closest("button").dataset,Promise.resolve(a.props.stores.raceStore.deleteCommentReplyRace({id:a.props.race.id,commentId:r.commentid,replyId:r.id})).then((function(){try{return a.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}}),t()}catch(e){return s(e)}}),s)}))},a.saveComment=function(e){return new Promise((function(t,s){var r;return r=e.target.closest("button").dataset.id,Promise.resolve(a.props.stores.raceStore.editCommentRace({id:a.props.race.id,commentId:r,comment:a.state.commentEditText})).then((function(){try{return a.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}}),t()}catch(e){return s(e)}}),s)}))},a.saveCommentReply=function(e){return new Promise((function(t,s){var r;return r=e.target.closest("button").dataset,Promise.resolve(a.props.stores.raceStore.editCommentReplyRace({id:a.props.race.id,commentId:r.commentid,replyId:r.id,comment:a.state.commentEditText})).then((function(){try{return a.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}}),t()}catch(e){return s(e)}}),s)}))},a.viewImage=function(e){var t=e.target.closest("img").dataset,s=a.state.viewImageIdx;s[t.id]=t.idx,a.setState({viewImageIdx:s})},a.translate=function(e){return new Promise((function(t,s){function r(){return a.setState({showOriginal:p,translatedText:g}),t()}var n,c,i,o,l,d,h,b,u,p,m,g,f;return e.preventDefault(),e.stopPropagation(),n=e.target.closest("button").dataset,o=a.props.race,d=(l=a.props.stores).raceStore,h=l.userStore.user,g=void 0===(m=(b=a.state).translatedText)?{}:m,(p=void 0===(u=b.showOriginal)?{}:u)[f=(i=n.commentid)+((c=n.replyid)?"-"+c:"")]=0,c?Promise.resolve(d.translateCommentReply({commentid:i,replyid:c,race:o,user:h})).then(function(e){try{return g[f]=e,r.call(this)}catch(e){return s(e)}}.bind(this),s):Promise.resolve(d.translateComment({commentid:i,race:o,user:h})).then(function(e){try{return g[f]=e,r.call(this)}catch(e){return s(e)}}.bind(this),s)}))},a.showOriginal=function(e){var t=e.target.closest("button").dataset,s=t.replyid,r=t.commentid;e.preventDefault(),e.stopPropagation();var n=a.state.showOriginal,c=void 0===n?{}:n;c[r+(s?"-"+s:"")]=1,a.setState({showOriginal:c})},a.state=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},g),a.inputRef={},a}var n,o;return o=t,(n=a).prototype=Object.create(o.prototype),n.prototype.constructor=n,n.__proto__=o,a.prototype.render=function(){var t=this,a=this.state,s=a.showAddComment,r=a.showAllComments,n=a.showAllReplies,o=a.viewImageIdx,h=a.showMenu,g=void 0===h?{}:h,f=a.showEdit,O=void 0===f?{}:f,j=a.showDeleteComment,v=void 0===j?{}:j,y=a.commentEditText,w=a.likeComment,k=a.showOriginal,x=void 0===k?{}:k,S=a.translatedText,C=void 0===S?{}:S,D=this.props,I=D.race,P=D.callback,R=void 0===P?function(){}:P,L=D.initCall,E=void 0===L?function(){}:L,T=D.col,A=void 0===T?12:T,U=D.offset,M=void 0===U?0:U,H=D.compact,F=this.props.stores,z=F.raceStore,_=F.userStore.user,N=_.language,B=void 0===N?"en":N,K=[],V=0,Y=0;if(I.comments){if(V=I.comments.length,r)K=I.comments;else K=I.comments.slice(Math.max(V-(void 0!==H&&H?0:2),0));Y=K.length}return Object(c.h)("div",{class:"col-"+A+" offset-"+M+" col-sm-8 col-lg-6 offset-sm-2 offset-lg-3"},I&&i.a.isArray(K)&&K.reverse().map((function(a){var r=a.user,h=void 0===r?{}:r,f=z.findPublicTeamByMembers(h.id),j=m.a.displayNameShort(h),k=m.a.displayName(h),S=h.image||(h.images?h.images[0]:void 0),D=a.likes&&a.likes.findIndex((function(e){return e.user===_.id}))>-1,P=[],L=0,T=0;a.comments&&(L=a.comments.length,T=(P=n[a.id]?a.comments:a.comments.slice(0,void 0)).length);var A=[];if(a.images){var U=Object(l.i)(a.images);A.push.apply(A,U)}var M=o[a.id]?o[a.id]:0,H=A&&A[M]?A[M]:null,F=z.getCommentTranslations({race:I,commentid:a.id,targetLang:B})||C[a.id],N=F||a.comment;return x[a.id]&&(N=a.comment),Object(c.h)("div",{class:"row"},Object(c.h)("div",{class:"col-11 offset-1 d-flex mb-2 position-relative"},Object(c.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall",style:(S?'background-image: url("'+S.s3SmallLink+'"); background-size: cover;':"")+" border-width: 3px !important;"},!h.image&&Object(c.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},j)),Object(c.h)("div",{class:"flex-grow-1 pl-3 pt-0",style:"line-height: 1.2em;"},Object(c.h)("div",{class:"bg-light p-2 rounded rounded-lg position-relative"},_.id===h.id&&Object(c.h)(e,null,Object(c.h)("span",{class:"float-right font-weight-lighter text-muted"},Object(c.h)("i",{class:"fas fa-ellipsis-h",onClick:t.toggleMenu,"data-id":a.id}))),g[a.id]&&Object(c.h)(e,null,Object(c.h)("div",{class:"position-absolute bg-white p-2 border rounded rounded-lg shadow-sm",style:"top: 30px; right: 10px; width: 60%; z-index: 999999;"},Object(c.h)("button",{class:"btn btn-link btn-block text-left",onClick:t.toggleEdit,"data-id":a.id,"data-comment":a.comment},Object(c.h)("i",{class:"fas fa-edit"})," Edit"),Object(c.h)("hr",null),Object(c.h)("button",{class:"btn btn-link btn-block text-left",onClick:t.toggleDeleteComment,"data-id":a.id},Object(c.h)("i",{class:"fas fa-trash-alt"})," Delete"))),Object(c.h)("div",null,Object(c.h)("span",{style:"font-size: 0.95em;"},Object(c.h)("h5",{class:"font-weight-bold mb-2",style:"font-size: 1.0em;"},h.uuidv4&&h.uuidv4!==_.uuidv4?Object(c.h)(e,null,Object(c.h)("a",{href:"/inbox/"+h.uuidv4},k)):Object(c.h)(e,null,k),f&&f.length>0&&Object(c.h)(e,null,Object(c.h)("span",{class:"font-weight-lighter text-muted ml-1"},f.filter((function(e){return 1===e.public})).slice(0,1).map((function(t){return Object(c.h)(e,null,"- ",Object(c.h)("a",{href:"/teams/public/"+t.uuidv4},t.name))}))))),O[a.id]?Object(c.h)(e,null,Object(c.h)("div",{class:"d-flex bd-highlight"},Object(c.h)("div",{class:"p-0 w-100 bd-highlight"},Object(c.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(c.h)(d.c,{id:"comments.comment"},"Kommentar")),Object(c.h)("div",{class:"border rounded rounded-lg position-relative"},Object(c.h)(d.b,null,Object(c.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(c.h)(d.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(u.a)(t,"commentEditText"),onKeyUp:m.a.resizeTextarea,onFocus:m.a.resizeTextarea,style:"height: 2.3em;",value:y})))),Object(c.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(c.h)("button",{type:"button",class:"btn btn-primary mb-2",onClick:t.saveComment,"data-id":a.id},Object(c.h)("i",{class:"fas fa-paper-plane"}))))):Object(c.h)(e,null,Object(c.h)(b.a,{markdown:m.a.replaceImages(N,a.images,B),markdownOpts:m.a.getMarkdownOptions()})),v[a.id]&&Object(c.h)("div",{class:"clearfix mt-3 mb-3"},Object(c.h)("button",{class:"btn btn-danger float-left",onClick:t.deleteComment,"data-id":a.id},Object(c.h)("i",{class:"fas fa-trash-alt"})," Delete"),Object(c.h)("button",{class:"btn btn-secondary float-right",onClick:t.toggleDeleteComment,"data-id":a.id},Object(c.h)("i",{class:"fas fa-times-circle"})," Cancel")))),Object(c.h)("div",null,Object(c.h)("div",{class:"container-fluid px-3 mt-1"},H&&Object(c.h)("div",{class:"clearfix row position-relative"},Object(c.h)("div",{class:"commentContainer col-12 px-0 overflow-hidden",style:"max-height: 60vh;",onDblclick:t.addLikeComment,"data-id":a.id},Object(c.h)("img",{loading:"lazy",class:"img-fluid",style:"min-width: 100px;",src:H.s3LargeLink})),w[a.id]&&Object(c.h)("span",{class:"likeHeart position-absolute text-white display-1",style:"top: calc(50% - 50px); left: calc(50% - 50px); width: 100px; height: 100px;"},Object(c.h)("i",{class:"fas fa-heart likeStory"}))),A&&A.length>1&&Object(c.h)("div",{class:"clearfix d-flex flex-wrap row"},i.a.isArray(A)&&A.map((function(s,r){return Object(c.h)(e,null,Object(c.h)("div",{class:"col px-0 overflow-hidden",style:"max-height: 100px; min-width: 100px;"},Object(c.h)("img",{loading:"lazy",class:"img-fluid border",style:"min-width: 100px;",src:s.s3SmallLink,onClick:t.viewImage,"data-id":a.id,"data-idx":r})))})))))),Object(c.h)("small",null,Object(c.h)("button",{class:"commentContainer btn btn-sm btn-link py-0 "+(D?"text-primary":""),onClick:t.addLikeComment,"data-id":a.id,disabled:D},D?Object(c.h)(d.c,{id:"comments.has-liked"},"Liked"):Object(c.h)(d.c,{id:"comments.like"},"Lik")),"-",Object(c.h)("button",{class:"btn btn-sm btn-link py-0",onClick:t.replyComment,"data-id":a.id},Object(c.h)(d.c,{id:"comments.comment-add"},"Kommentar")),a.language!==B&&Object(c.h)(e,null,"-",!x[a.id]&&F?Object(c.h)(e,null,Object(c.h)("button",{type:"button",class:"btn btn-sm btn-link","data-commentid":a.id,onClick:t.showOriginal},Object(c.h)("i",{class:"fas fa-cog"}),"  ",Object(c.h)(d.c,{id:"home.translate-show-original"},"Show original"))):Object(c.h)(e,null,Object(c.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:t.translate,"data-commentid":a.id},Object(c.h)("i",{class:"fas fa-cog"})," ",Object(c.h)(d.c,{id:"home.translate-to"},"See translation")))),"-",Object(c.h)("button",{class:"btn btn-sm btn-link py-0 disabled"},i.a.formatDistance(a.createdDate,new Date,{locale:"no-NB"}),a.updatedDate&&Object(c.h)(e,null,Object(c.h)("span",{class:"font-weight-light ml-2"},"(Edited ",i.a.formatDistance(a.updatedDate,new Date,{locale:"no-NB"}),")"))))),a.likes&&a.likes.length>0&&Object(c.h)("small",{class:"position-absolute bg-light shadow-sm rounded-lg py-0 px-1",style:"bottom: 20px; right: 15px;"},Object(c.h)("i",{class:"fas fa-thumbs-up text-primary"})," ",a.likes.length)),Object(c.h)("div",{class:"col-10 offset-2 mb-2"},a&&i.a.isArray(P)&&P.map((function(s){var r=s.user,n=void 0===r?{}:r,o=z.findPublicTeamByMembers(n.id),l=m.a.displayNameShort(n),h=m.a.displayName(n),p=n.image||(n.images?n.images[0]:void 0),f=s.likes&&s.likes.findIndex((function(e){return e.user===_.id}))>-1,j=z.getCommentReplyTranslations({race:I,commentid:a.id,replyid:s.id,targetLang:B})||C[a.id+"-"+s.id],w=j||s.comment;return x[a.id+"-"+s.id]&&(w=s.comment),Object(c.h)("div",{class:"row"},Object(c.h)("div",{class:"col-12 d-flex mb-2 position-relative"},Object(c.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall",style:(p?'background-image: url("'+p.s3SmallLink+'"); background-size: cover;':"")+" border-width: 3px !important;"},!n.image&&Object(c.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},l)),Object(c.h)("div",{class:"flex-grow-1 pl-3 pt-0",style:"line-height: 1.2em;"},Object(c.h)("div",{class:"bg-light p-2 rounded-lg position-relative"},_.id===n.id&&Object(c.h)(e,null,Object(c.h)("span",{class:"float-right font-weight-lighter text-muted"},Object(c.h)("i",{class:"fas fa-ellipsis-h",onClick:t.toggleMenu,"data-id":s.id}))),g[s.id]&&Object(c.h)(e,null,Object(c.h)("div",{class:"position-absolute bg-white p-2 border rounded rounded-lg shadow-sm",style:"top: 30px; right: 10px; width: 60%; z-index: 999999;"},Object(c.h)("button",{class:"btn btn-link btn-block text-left",onClick:t.toggleEdit,"data-id":s.id,"data-comment":s.comment},Object(c.h)("i",{class:"fas fa-edit"})," Edit"),Object(c.h)("hr",null),Object(c.h)("button",{class:"btn btn-link btn-block text-left",onClick:t.toggleDeleteComment,"data-id":s.id},Object(c.h)("i",{class:"fas fa-trash-alt"})," Delete"))),Object(c.h)("span",{style:"font-size: 0.95em;"},Object(c.h)("h5",{class:"font-weight-bold mb-2",style:"font-size: 1.0em;"},h,o&&o.length>0&&Object(c.h)(e,null,Object(c.h)("span",{class:"font-weight-lighter text-muted ml-2"},o.filter((function(e){return 1===e.public})).slice(0,1).map((function(t){return Object(c.h)(e,null,"- ",Object(c.h)("a",{href:"/teams/public/"+t.uuidv4,class:"mr-2"}," ",t.name))}))))),O[s.id]?Object(c.h)(e,null,Object(c.h)("div",{class:"d-flex bd-highlight"},Object(c.h)("div",{class:"p-0 w-100 bd-highlight"},Object(c.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(c.h)(d.c,{id:"comments.comment"},"Kommentar")),Object(c.h)("div",{class:"border rounded rounded-lg position-relative"},Object(c.h)(d.b,null,Object(c.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(c.h)(d.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(u.a)(t,"commentEditText"),onKeyUp:m.a.resizeTextarea,onFocus:m.a.resizeTextarea,style:"height: 2.3em;",value:y})))),Object(c.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(c.h)("button",{type:"button",class:"btn btn-primary mb-2",onClick:t.saveCommentReply,"data-commentid":a.id,"data-id":s.id},Object(c.h)("i",{class:"fas fa-paper-plane"}))))):Object(c.h)(e,null,Object(c.h)(b.a,{markdown:m.a.replaceImages(w,s.images,B),markdownOpts:m.a.getMarkdownOptions()})),v[s.id]&&Object(c.h)("div",{class:"clearfix mt-3 mb-3"},Object(c.h)("button",{class:"btn btn-danger float-left",onClick:t.deleteCommentReply,"data-id":s.id,"data-commentid":a.id},Object(c.h)("i",{class:"fas fa-trash-alt"})," Delete"),Object(c.h)("button",{class:"btn btn-secondary float-right",onClick:t.toggleDeleteComment,"data-id":s.id},Object(c.h)("i",{class:"fas fa-times-circle"})," Cancel")))),Object(c.h)("small",null,Object(c.h)("button",{class:"replyContainer btn btn-sm btn-link py-0 "+(f?"text-primary":""),onClick:t.likeReply,"data-comment":a.id,"data-id":s.id,disabled:f},f?Object(c.h)(d.c,{id:"comments.has-liked"},"Liked"):Object(c.h)(d.c,{id:"comments.like"},"Lik")),"-",Object(c.h)("button",{class:"btn btn-sm btn-link py-0",onClick:t.replyComment,"data-id":a.id},Object(c.h)(d.c,{id:"comments.comment-add"},"Kommentar")),s.language!==B&&Object(c.h)(e,null,"-",!x[a.id+"-"+s.id]&&j?Object(c.h)(e,null,Object(c.h)("button",{type:"button",class:"btn btn-sm btn-link","data-commentid":a.id,"data-replyid":s.id,onClick:t.showOriginal},Object(c.h)("i",{class:"fas fa-cog"}),"  ",Object(c.h)(d.c,{id:"home.translate-show-original"},"Show original"))):Object(c.h)(e,null,Object(c.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:t.translate,"data-commentid":a.id,"data-replyid":s.id},Object(c.h)("i",{class:"fas fa-cog"})," ",Object(c.h)(d.c,{id:"home.translate-to"},"See translation")))),"-",Object(c.h)("button",{class:"btn btn-sm btn-link py-0 disabled"},i.a.formatDistance(s.createdDate,new Date,{locale:"no-NB"}),s.updatedDate&&Object(c.h)(e,null,Object(c.h)("span",{class:"font-weight-light ml-2"},"(Edited ",i.a.formatDistance(s.updatedDate,new Date,{locale:"no-NB"}),")"))))),s.likes&&Object(c.h)("small",{class:"position-absolute bg-light shadow-sm rounded-lg py-0 px-1",style:"bottom: 20px; right: 15px;"},Object(c.h)("i",{class:"fas fa-thumbs-up text-primary"})," ",s.likes.length)))})),L-T>0&&Object(c.h)("div",null,Object(c.h)("button",{class:"btn btn-sm btn-link py-0",onClick:t.toggleReplies,"data-id":a.id},Object(c.h)(d.c,{id:"comments.show-more",fields:{more:L-T}},"Vis ",L-T," flere kommentarer...")))),s[a.id]&&Object(c.h)("div",{class:"col-11 offset-1 d-flex mb-2 position-relative"},Object(c.h)(p.a,{stores:t.props.stores,race:I,initCall:E,callback:R,commentId:a.id,inputRef:function(e){return t.inputRef[a.id]=e},inputRefObject:t.inputRef,key:"race-commentreply-"+a.id})))})),V-Y>0&&Object(c.h)("div",null,Object(c.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.toggleComments},Object(c.h)(d.c,{id:"comments.show-more",fields:{more:V-Y}},"Vis ",V-Y," flere kommentarer..."))),r&&Object(c.h)("div",null,Object(c.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.toggleComments},Object(c.h)(d.c,{id:"comments.hide-all-comments"},"Skjul alle kommentarene."))))},a}(c.Component))||n;t.a=f}).call(this,a("hosL").Fragment)},aGZh:function(e,t,a){"use strict";(function(e){function t(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var r,n=a("hosL"),c=a("/eY4"),i={};Object(c.a)(r=function(a){function r(e){var r;return(r=a.call(this,e)||this).state=function(e){for(var a=1;a<arguments.length;a++){var r=null!=arguments[a]?arguments[a]:{};a%2?t(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},i),r}var c,o;return o=a,(c=r).prototype=Object.create(o.prototype),c.prototype.constructor=c,c.__proto__=o,r.prototype.render=function(){var t=this.props.stores.appState,a=this.props.text,s=t.language,r=void 0===s?"en":s,c=a,i=new RegExp("/<"+r+">(.*?)</"+r+">/");return a.replace(i,"$1")&&(c=a),Object(n.h)(e,null,c)},r}(n.Component))}).call(this,a("hosL").Fragment)},gs45:function(e,t,a){"use strict";(function(e){function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var c,i=a("hosL"),o=a("Utv1"),l=a("/eY4"),d=a("OhSV"),h=a("67HY"),b=a("gbHB"),u=a("B+py"),p=a("ZOvn"),m={isLoading:!1,showSignup:!1},g=Object(l.a)(c=function(t){function a(e){var a;return(a=t.call(this,e)||this).signupToRace=function(){return new Promise((function(e,t){var s,n,c,i,o,l;return o=a.props.raceid,l=r({team:(c=(s=a.props.stores).userStore.user).team,firstname:c.firstname,lastname:c.lastname,sportsClub:c.sportsClub,email:c.email,cellphone:c.cellphone,facebook:c.facebook,instagram:c.instagram},i=(n=s.raceStore).newSignup),Promise.resolve(n.addContestant({id:o,classId:i.class,newContestant:l})).then((function(){try{return n.addSignup(l),a.toggleShowSignup(!1,!0),e()}catch(e){return t(e)}}),t)}))},a.updateSignup=function(e){a.props.stores.raceStore.updateObjectKeyValue("newSignup",e.target.id,e.target.value)},a.editSignup=function(e){var t,s=a.props.raceid,r=a.props.stores.raceStore,n=e.target.id,c=e.target.value,i=e.target.dataset,l=((t={raceClassId:i.classid,contestantId:i.contestantid})["raceClassContestant"+o.a.ucfirst(n)]=c,t);clearTimeout(a.updateTimer[n]),a.updateTimer[n]=setTimeout((function(){return new Promise((function(e){return r.editClass({id:s,data:l}),e()}))}),500)},a.toggleShowSignup=function(e,t){a.setState({showSignup:!t&&!a.state.showSignup})},a.state=r({},m),a.inputRef={},a.updateTimer={},a}var s,n;return n=t,(s=a).prototype=Object.create(n.prototype),s.prototype.constructor=s,s.__proto__=n,a.prototype.render=function(){var t=this,a=this.state.showSignup,s=this.props.stores,r=s.appState,n=s.userStore,c=s.raceStore,l=n.user,m=void 0===l?{}:l,g=n.teams,f=void 0===g?[]:g,O=r.language,j=void 0===O?"en":O,v=this.props,y=v.raceid,w=v.subsection,k=c.race,x=c.signups,S=c.newSignup,C=new Date,D=x&&x.length>0,I=x.map((function(e){return parseInt(e.team,10)}))||[];return Object(i.h)(e,null,Object(i.h)("h2",{class:"mb-0"},Object(i.h)(d.c,{id:"races.signup"},"PÃ¥melding")," ",Object(i.h)("span",{class:"font-weight-lighter",style:"letter-spacing: -1px;"}," - ",k.title)),Object(i.h)("div",{class:"mb-4"},k.signupStartDate&&Object(i.h)(e,null,Object(i.h)(d.c,{id:"races.periode"},"Periode"),": ",o.a.formatDate(k.signupStartDate,{locale:j,hour12:!1,hour:"2-digit",minute:"2-digit"})),k.signupEndDate&&Object(i.h)(e,null," - ",o.a.formatDate(k.signupEndDate,{locale:j,hour12:!1,hour:"2-digit",minute:"2-digit"}))),C>=new Date(k.signupStartDate)&&C<=new Date(k.signupEndDate)?Object(i.h)(e,null,m.email?Object(i.h)(e,null,Object(i.h)("span",{class:"font-weight-lighter"},Object(i.h)(d.c,{id:"races.signed-in-as"},"Logget inn som"),":")," ",m.email,Object(i.h)("br",null),Object(i.h)("br",null),D&&x.map((function(a){var s={};return a.class&&(s=c.getRaceClassById(a.class)),Object(i.h)("div",{class:"mb-5 p-3 bg-light border rounded-lg"},Object(i.h)("div",{class:"font-weight-bold mb-4"},Object(i.h)("i",{class:"fas fa-check text-success"})," ",Object(i.h)(d.c,{id:"races.signed-up"},"Din bruker er pÃ¥meldt!"),Object(i.h)("br",null)),!k.liveRace&&k.signuppayment&&Object(i.h)(e,null,Object(i.h)("div",{class:"form-group row my-0"},Object(i.h)("label",{for:"cellphone",class:"col-2 col-form-label text-right font-weight-lighter"},Object(i.h)(d.c,{id:"races.signup"},"PÃ¥melding")),Object(i.h)("div",{class:"col-10"},a.paidSignupfee?Object(i.h)("div",{class:"py-2"},Object(i.h)(d.c,{id:"races.paid"},"Betalt"),": ",o.a.formatDate(a.paidSignupfee),Object(i.h)("i",{class:"fas fa-check text-success ml-3"})):Object(i.h)(e,null,Object(i.h)("div",{class:"alert alert-danger mb-1",role:"alert"},Object(i.h)("h5",null,Object(i.h)("span",{class:"font-weight-lighter"},Object(i.h)(d.c,{id:"races.payment-info"},"Betaling pÃ¥melding"),":")," ",p.a.replaceImages(k.signuppayment,k.images,j,!1),Object(i.h)("br",null),s.signupfee||k.signupfee," NOK")))))),Object(i.h)("div",{class:"clearfix mt-2"},Object(i.h)("span",{class:"font-weight-lighter float-right"},Object(i.h)(d.c,{id:"races.click-to-change"},"Klikk for Ã¥ endre info i pÃ¥meldingen."))),Object(i.h)("div",{class:"form-group row my-0"},Object(i.h)("label",{for:"cellphone",class:"col-2 col-form-label text-right font-weight-lighter"},Object(i.h)(d.c,{id:"races.cellphone"},"Mobil")),Object(i.h)("div",{class:"col-10"},Object(i.h)(d.b,null,Object(i.h)("input",{type:"text",class:"form-control-plaintext",id:"cellphone","data-classid":a.class,"data-contestantid":a.id,onInput:t.editSignup,value:a.cellphone,placeholder:Object(i.h)(d.c,{id:"races.cellphone-help"},"Hva er mobilnummer ditt?")})))),Object(i.h)("div",{class:"form-group row my-0"},Object(i.h)("label",{for:"firstname",class:"col-2 col-form-label text-right font-weight-lighter"},Object(i.h)(d.c,{id:"races.firstname"},"Fornavn")),Object(i.h)("div",{class:"col-10"},Object(i.h)(d.b,null,Object(i.h)("input",{type:"text",class:"form-control-plaintext",id:"firstname","data-classid":a.class,"data-contestantid":a.id,onInput:t.editSignup,value:a.firstname,placeholder:Object(i.h)(d.c,{id:"races.firstname-help"},"Hva er fornavnet ditt?")})))),Object(i.h)("div",{class:"form-group row my-0"},Object(i.h)("label",{for:"lastname",class:"col-2 col-form-label text-right font-weight-lighter"},Object(i.h)(d.c,{id:"races.lastname"},"Etternavn")),Object(i.h)("div",{class:"col-10"},Object(i.h)(d.b,null,Object(i.h)("input",{type:"text",class:"form-control-plaintext",id:"lastname","data-classid":a.class,"data-contestantid":a.id,onInput:t.editSignup,value:a.lastname,placeholder:Object(i.h)(d.c,{id:"races.lastname-help"},"Hva er etternavnet ditt?")})))),Object(i.h)("div",{class:"form-group row my-0"},Object(i.h)("label",{for:"sportsClub",class:"col-2 col-form-label text-right font-weight-lighter"},Object(i.h)(d.c,{id:"races.sportsclub"},"Klubb")),Object(i.h)("div",{class:"col-10"},Object(i.h)(d.b,null,Object(i.h)("input",{type:"text",class:"form-control-plaintext",id:"sportsClub","data-classid":a.class,"data-contestantid":a.id,onInput:t.editSignup,value:a.sportsClub,placeholder:Object(i.h)(d.c,{id:"races.sportsClub-help"},"Hvilken klubb tilhÃ¸rer du?")})))),Object(i.h)("div",{class:"form-group row my-0"},Object(i.h)("label",{for:"facebook",class:"col-2 col-form-label text-right font-weight-lighter"},Object(i.h)(d.c,{id:"races.facebook"},"Facebook")),Object(i.h)("div",{class:"col-10"},Object(i.h)(d.b,null,Object(i.h)("input",{type:"text",class:"form-control-plaintext",id:"facebook","data-classid":a.class,"data-contestantid":a.id,onInput:t.editSignup,value:a.facebook,placeholder:Object(i.h)(d.c,{id:"races.facebook-help"},"Hva er Facebook brukernavnet ditt?")})))),Object(i.h)("div",{class:"form-group row my-0"},Object(i.h)("label",{for:"instagram",class:"col-2 col-form-label text-right font-weight-lighter"},Object(i.h)(d.c,{id:"races.instagram"},"Instagram")),Object(i.h)("div",{class:"col-10"},Object(i.h)(d.b,null,Object(i.h)("input",{type:"text",class:"form-control-plaintext",id:"instagram","data-classid":a.class,"data-contestantid":a.id,onInput:t.editSignup,value:a.instagram,placeholder:Object(i.h)(d.c,{id:"races.instagram-help"},"Hva er Instagram brukernavnet ditt?")})))),Object(i.h)("div",{class:"form-group row my-0"},Object(i.h)("label",{for:"team",class:"col-2 col-form-label text-right font-weight-lighter"},Object(i.h)(d.c,{id:"races.team"},"Team")),Object(i.h)("div",{class:"col-10"},Object(i.h)("select",{class:"form-control-plaintext",id:"team","aria-describedby":"teamHelp","data-classid":a.class,"data-contestantid":a.id,onInput:t.editSignup,value:a.team},Object(i.h)("option",{value:""},"-- ",Object(i.h)(d.c,{id:"races.choose-team"},"Velg team")," --"),f.map((function(e){return Object(i.h)("option",{value:e.id,disabled:I.indexOf(e.id)>-1},e.name," ",I.indexOf(e.id)>-1&&e.id!==a.team?"(Already signed up!)":"")}))))),Object(i.h)("div",{class:"form-group row my-0"},Object(i.h)("label",{for:"team",class:"col-2 col-form-label text-right font-weight-lighter"},Object(i.h)(d.c,{id:"races.class"},"Klasse")),Object(i.h)("div",{class:"col-10"},Object(i.h)("select",{class:"form-control-plaintext",id:"class","aria-describedby":"classHelp",onInput:t.editSignup,value:a.class,disabled:!0},Object(i.h)("option",{value:""},"-- ",Object(i.h)(d.c,{id:"races.choose-class"},"Velg klasse")," --"),k.classes&&k.classes.sort((function(e,t){return e.distance-t.distance})).map((function(t){return Object(i.h)(e,null,Object(i.h)("option",{value:t.id},t.title,!k.liveRace&&Object(i.h)(e,null,"- ",t.distance," km - PÃ¥melding: ",t.signupfee||k.signupfee," NOK")))}))))))})),1===k.liveRace?Object(i.h)(e,null,"Signup is done at the race normal web pages."):Object(i.h)(e,null,D&&!a?Object(i.h)(e,null,Object(i.h)("button",{type:"button",class:"btn btn-sm float-right btn-outline-info",onClick:this.toggleShowSignup},Object(i.h)(d.c,{id:"races.signup-another-team"},"Meld meg pÃ¥ i flere klasser"))):Object(i.h)(e,null,Object(i.h)("div",{class:"form-group"},Object(i.h)("label",{for:"cellphone"},Object(i.h)(d.c,{id:"races.cellphone"},"Mobil")),Object(i.h)("input",{type:"text",class:"form-control",id:"cellphone","aria-describedby":"cellphoneHelp",placeholder:m.cellphone,onInput:this.updateSignup,value:S.cellphone}),Object(i.h)("small",{id:"cellphoneHelp",class:"form-text text-muted"},Object(i.h)(d.c,{id:"races.cellphone-help"},"'Hva er mobilnummer ditt?'"))),Object(i.h)("div",{class:"row"},Object(i.h)("div",{class:"col"},Object(i.h)("div",{class:"form-group"},Object(i.h)("label",{for:"firstname"},Object(i.h)(d.c,{id:"races.firstname"},"Fornavn")),Object(i.h)("input",{type:"text",class:"form-control",id:"firstname","aria-describedby":"firstnameHelp",placeholder:m.firstname,onInput:this.updateSignup,value:S.firstname}),Object(i.h)("small",{id:"firstnameHelp",class:"form-text text-muted"},Object(i.h)(d.c,{id:"races.firstname-help"},"Hva er fornavnet ditt?")))),Object(i.h)("div",{class:"col"},Object(i.h)("div",{class:"form-group"},Object(i.h)("label",{for:"lastname"},Object(i.h)(d.c,{id:"races.lastname"},"Etternavn")),Object(i.h)("input",{type:"text",class:"form-control",id:"lastname","aria-describedby":"lastnameHelp",placeholder:m.lastname,onInput:this.updateSignup,value:S.lastname}),Object(i.h)("small",{id:"lastnameHelp",class:"form-text text-muted"},Object(i.h)(d.c,{id:"races.lastname-help"},"Hva er etternavnet ditt?"))))),Object(i.h)("div",{class:"form-group"},Object(i.h)("label",{for:"sportsClub"},Object(i.h)(d.c,{id:"races.sportsclub"},"Klubb")),Object(i.h)("input",{type:"text",class:"form-control",id:"sportsClub","aria-describedby":"sportsClubHelp",placeholder:m.sportsClub,onInput:this.updateSignup,value:S.sportsClub}),Object(i.h)("small",{id:"sportsClubHelp",class:"form-text text-muted"},Object(i.h)(d.c,{id:"races.sportsClub-help"},"Hvilken klubb tilhÃ¸rer du?"))),Object(i.h)("div",{class:"row"},Object(i.h)("div",{class:"col"},Object(i.h)("div",{class:"form-group"},Object(i.h)("label",{for:"facebook"},Object(i.h)(d.c,{id:"races.facebook"},"Facebook")),Object(i.h)("input",{type:"text",class:"form-control",id:"facebook","aria-describedby":"facebookHelp",placeholder:m.facebook,onInput:this.updateSignup,value:S.facebook}),Object(i.h)("small",{id:"facebookHelp",class:"form-text text-muted"},Object(i.h)(d.c,{id:"races.facebook-help"},"Hva er Facebook brukernavnet ditt?")))),Object(i.h)("div",{class:"col"},Object(i.h)("div",{class:"form-group"},Object(i.h)("label",{for:"instagram"},Object(i.h)(d.c,{id:"races.instagram"},"Instagram")),Object(i.h)("input",{type:"text",class:"form-control",id:"instagram","aria-describedby":"instagramHelp",placeholder:m.instagram,onInput:this.updateSignup,value:S.instagram}),Object(i.h)("small",{id:"instagramHelp",class:"form-text text-muted"},Object(i.h)(d.c,{id:"races.instagram-help"},"Hva er Instagram brukernavnet ditt?"))))),Object(i.h)("div",{class:"form-group"},Object(i.h)("label",{for:"team"},Object(i.h)(d.c,{id:"races.team"},"Team")),!f||0===f.length&&Object(i.h)(e,null,Object(i.h)("div",{class:"alert alert-danger",role:"alert"},Object(i.h)(d.c,{id:"races.no-teams"},"Du har ingen team i appen din ennÃ¥. GÃ¥ inn i appen for Ã¥ registrer team og forsÃ¸k igjen."))),Object(i.h)("select",{class:"form-control",id:"team","aria-describedby":"teamHelp",onInput:this.updateSignup,value:S.team},Object(i.h)("option",{value:""},"-- ",Object(i.h)(d.c,{id:"races.choose-team"},"Velg team")," --"),f.map((function(e){return Object(i.h)("option",{value:e.id,disabled:I.indexOf(e.id)>-1},e.name," ",I.indexOf(e.id)>-1?"(Already signed up!)":"")}))),Object(i.h)("small",{id:"teamHelp",class:"form-text text-muted"},Object(i.h)(d.c,{id:"races.choose-team-help"},"Velg fra dine team"))),Object(i.h)("div",{class:"form-group"},Object(i.h)("label",{for:"class"},Object(i.h)(d.c,{id:"races.class"},"Klasse")),Object(i.h)("select",{class:"form-control",id:"class","aria-describedby":"classHelp",onInput:this.updateSignup,value:S.class},Object(i.h)("option",{value:""},"-- ",Object(i.h)(d.c,{id:"races.choose-class"},"Velg klasse")," --"),k.classes&&k.classes.map((function(t){return Object(i.h)(e,null,Object(i.h)("option",{value:t.id},t.title," - ",t.distance," km - PÃ¥melding: ",t.signupfee||k.signupfee," NOK"))}))),Object(i.h)("small",{id:"classHelp",class:"form-text text-muted"},Object(i.h)(d.c,{id:"races.choose-class-help"},"Velg Ã¸nsket klasse."))),k.rules&&Object(i.h)("div",{class:"form-group form-check"},Object(i.h)("input",{type:"checkbox",class:"form-check-input",id:"termsAndAgreement",onInput:this.updateSignup,checked:S.termsAndAgreement,value:!0}),Object(i.h)("label",{class:"form-check-label",for:"termsAndAgreement"},Object(i.h)(d.c,{id:"races.agreement-accept"},"Jeg har lest og godtar reglene for lÃ¸pet."))),k.declaration&&Object(i.h)("div",{class:"form-group form-check"},Object(i.h)("input",{type:"checkbox",class:"form-check-input",id:"declaration",onInput:this.updateSignup,checked:S.declaration,value:!0}),Object(i.h)("label",{class:"form-check-label",for:"declaration"},Object(i.h)(d.c,{id:"races.declaration-accept"},"Jeg signerer med dette egenÃ¦rklÃ¦ringen."))),Object(i.h)("button",{type:"button",class:"btn btn-primary",onClick:this.signupToRace},Object(i.h)(d.c,{id:"races.do-signup"},"Meld meg pÃ¥")),D&&Object(i.h)("button",{type:"button",class:"btn btn-danger float-right",onClick:this.toggleShowSignup},Object(i.h)(d.c,{id:"races.hide-signup"},"Avbryt"))))):Object(i.h)(e,null,!w&&Object(i.h)(h.a,{stores:this.props.stores,routeLoginOk:"/race/"+y+"/signup",routeLoginNew:"/race/"+y+"/signup/newUser",routeLoginForgot:"/race/"+y+"/signup/forgotPassword"}),"newUser"===w&&Object(i.h)(b.default,{stores:this.props.stores,routeLogin:"/race/"+y+"/signup",routeLoginForgot:"/race/"+y+"/signup/forgotPassword",skipPubSub:!0}),"forgotPassword"===w&&Object(i.h)(u.default,{stores:this.props.stores,routeLogin:"/race/"+y+"/signup",routeLoginNew:"/race/"+y+"/signup/newUser"}))):Object(i.h)(e,null,C<new Date(k.signupStartDate)?Object(i.h)(e,null,Object(i.h)("h5",{class:"mt-4"},Object(i.h)("i",{class:"fas fa-exclamation-circle"})," ",Object(i.h)(d.c,{id:"races.signup-not-open-yet"},"PÃ¥meldingen har ikke Ã¥pnet ennÃ¥!")),Object(i.h)("p",{class:"mt-4"},Object(i.h)(d.c,{id:"races.signup-opening"},"PÃ¥meldingen Ã¥pner"),":",Object(i.h)("br",null),Object(i.h)("span",{class:"display-4"},o.a.formatDate(k.signupStartDate,{locale:j,hour12:!1,hour:"2-digit",minute:"2-digit"})))):Object(i.h)(e,null,Object(i.h)("h5",{class:"mt-4 mb-4"},Object(i.h)("i",{class:"fas fa-exclamation-circle"})," ",Object(i.h)(d.c,{id:"races.signup-closed"},"PÃ¥meldingen er stengt!")))))},a}(i.Component))||c;t.a=g}).call(this,a("hosL").Fragment)},om2D:function(e,t,a){"use strict";var s,r=a("hosL"),n=a("/eY4"),c=(a("cneo"),a("Utv1"),a("u2zT")),i=Object(n.a)(s=function(e){function t(t){var a;return(a=e.call(this,t)||this).handleAddImage=function(e){var t=a.props.addToImages,s=void 0===t||t,r=a.props,n=r.updateField,c=r.object,i=r.field;if(i&&n({id:c.id,field:i,value:e,skipTimer:!0}),s){var o=[];o.push(e),n({id:c.id,field:"images",value:o,skipTimer:!0})}},a.state={files:[]},a}var a,s;return s=e,(a=t).prototype=Object.create(s.prototype),a.prototype.constructor=a,a.__proto__=s,t.prototype.render=function(){var e=this.props,t=e.uploadStatus,a=void 0===t?function(){}:t,s=e.before,n=void 0===s?function(){}:s,i=e.after,o=void 0===i?function(){}:i,l=e.autoOpen,d=void 0===l||l;return Object(r.h)("div",{class:"row"},Object(r.h)("div",{class:"col-12"},Object(r.h)(c.a,{handleAddImage:this.handleAddImage,uploadStatus:a,apiUrl:"/api/fileupload",before:n,after:o,autoOpen:d},Object(r.h)("div",{style:{height:30,width:"100%"}}))))},t}(r.Component))||s;t.a=i},"p/0L":function(e,t,a){"use strict";a.r(t),function(e){function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var c,i=a("hosL"),o=a("QRet"),l=a("Utv1"),d=a("/eY4"),h=a("OhSV"),b=a("go65"),u=a("fh8t"),p=a.n(u),m=a("RMlE"),g=a("8gML"),f=a("gs45"),O=(a("67HY"),a("gbHB"),a("B+py"),a("Ysxg")),j=a("9lZG"),v=(a("aGZh"),a("om2D")),y=a("ZOvn"),w=y.a.marginTop(!0,!0),k=y.a.marginBottom(),x={isLoading:!1,email:"",submenu:"ads",jwtToken:l.a.getJwtToken(),newRaceArticle:{},newRaceUserImage:{}},S=Object(d.a)(c=function(t){function a(e){var a;return(a=t.call(this,e)||this).likeRace=function(){return new Promise((function(e,t){var s;return s=a.props.stores.raceStore,Promise.resolve(s.likeRace({id:s.race.id})).then((function(a){try{return a,e()}catch(e){return t(e)}}),t)}))},a.toggleAddComment=function(e){var t=e.target.parentElement.dataset.id||e.target.dataset.id;a.setState({showAddComment:!a.state.showAddComment},(function(){a.inputRef[t]&&a.inputRef[t].focus()}))},a.addRaceArticle=function(){return new Promise((function(e,t){return Promise.resolve(a.props.stores.raceStore.addArticle({id:a.props.raceid,newArticle:a.state.newRaceArticle})).then((function(){try{return a.setState({newRaceArticle:{}}),e()}catch(e){return t(e)}}),t)}))},a.addRaceUserImage=function(){return new Promise((function(e,t){return Promise.resolve(a.props.stores.raceStore.addUserImage({id:a.props.raceid,newUserImage:a.state.newRaceUserImage})).then((function(){try{return a.setState({newRaceUserImage:{}}),e()}catch(e){return t(e)}}),t)}))},a.updateUserImageUpload=function(e){var t=a.state.newRaceUserImage;t[e.field]=e.value,a.setState({newRaceUserImage:t})},a.updateArticleUpload=function(e){var t=a.state.newRaceArticle;t[e.field]=e.value,a.setState({newRaceArticle:t})},a.removeRaceArticle=function(e){return new Promise((function(t,s){return Promise.resolve(a.props.stores.raceStore.removeArticle({id:a.props.raceid,articleId:e.target.parentElement.dataset.id||e.target.dataset.id})).then((function(){try{return t()}catch(e){return s(e)}}),s)}))},a.removeRaceUserImage=function(e){return new Promise((function(t,s){return Promise.resolve(a.props.stores.raceStore.removeUserImage({id:a.props.raceid,userImageId:e.target.parentElement.dataset.id||e.target.dataset.id})).then((function(){try{return t()}catch(e){return s(e)}}),s)}))},a.editRaceArticle=function(e){return new Promise((function(t){var s,r=e.target.dataset,n=r.id,c=r.field,i=e.target.value,o=a.props.raceid,d=a.props.stores.raceStore,h=((s={raceArticleId:n})["raceArticle"+l.a.ucfirst(c)]=i,s);return clearTimeout(a.updateTimer[o+"-"+n+"-"+c]),a.updateTimer[o+"-"+n+"-"+c]=setTimeout((function(){return new Promise((function(e){return d.editArticle({id:o,data:h}),e()}))}),1500),a.resizeTextarea(e.target),t()}))},a.editRaceUserImage=function(e){return new Promise((function(t){var s,r=e.target.dataset,n=r.id,c=r.field,i=e.target.value,o=a.props.raceid,d=a.props.stores.raceStore,h=((s={raceUserImageId:n})["raceUserImage"+l.a.ucfirst(c)]=i,s);return clearTimeout(a.updateTimer[o+"-"+n+"-"+c]),a.updateTimer[o+"-"+n+"-"+c]=setTimeout((function(){return new Promise((function(e){return d.editUserImage({id:o,data:h}),e()}))}),1500),a.resizeTextarea(e.target),t()}))},a.resizeAllTextareas=function(){for(var e=document.getElementsByTagName("textarea"),t=0,s=e.length;t<s;t+=1){a.resizeTextarea(e[t])}},a.resizeTextarea=function(e){var t=e;t.target&&(t=e.target),t.style.height=t.scrollHeight+"px"},a.handleImageErrored=function(e){var t=e.target;t.onerror=null,setTimeout((function(){t.src+="?"+new Date}),1e3)},a.state=r({},x),a.inputRef={},a.updateTimer={},a}var s,n;n=t,(s=a).prototype=Object.create(n.prototype),s.prototype.constructor=s,s.__proto__=n;var c=a.prototype;return c.loadRace=function(e){return new Promise(function(t,a){var s,n,c,i,o,l,d,h,b,u;return void 0===e&&(e=this.props),this.setState({isLoading:!0}),n=(s=e.stores).raceStore,i=void 0===(c=s.userStore.user)?{}:c,Promise.resolve(n.load(e.raceid)).then(function(){try{if(n.countAll(),this.setState({isLoading:!1}),o={},n.resetSignup(),(l=n.race).classes&&i&&i.email)for(d=0,h=l.classes.length;d<h;d+=1)(b=l.classes[d]).contestants&&(u=b.contestants.findIndex((function(e){return e.email===i.email})))>-1&&(o=r(r({},b.contestants[u]),{},{class:b.id}),n.addSignup(o));return n.updateKeyValue("signup",o),this.resizeAllTextareas(),t()}catch(e){return a(e)}}.bind(this),a)}.bind(this))},c.componentDidMount=function(){this.loadRace()},c.componentWillReceiveProps=function(e){this.loadRace(e)},c.render=function(){var t,a=this,s=this.state,r=s.showAddComment,n=s.newRaceArticle,c=s.newRaceUserImage,d=this.props.stores,u=d.appState,x=d.userStore,S=d.raceStore,C=x.isAdmin,D=x.user,I=void 0===D?{}:D,P=this.props,R=P.raceid,L=P.path,E=P.section,T=P.subsection,A=P.col,U=void 0===A?12:A,M=P.offset,H=void 0===M?0:M,F=u.darkmode,z=u.language,_=void 0===z?"en":z,N=S.race,B=S.totalClasses,K=S.totalContestants,V=N.likes,Y=void 0===V?[]:V,Z=N.comments,J=void 0===Z?[]:Z,q=N.likes&&N.likes.findIndex((function(e){return e.user===I.id}))>-1,$=new Date,G="";return $>=new Date(N.startDate)&&$<=new Date(N.endDate)?G="race":$>=new Date(N.signupStartDate)&&$<=new Date(N.signupEndDate)?G="signup":$>new Date(N.endDate)&&(G="done"),Object(i.h)(e,null,Object(i.h)(m.a,{stores:this.props.stores}),Object(i.h)("div",{class:"container-fluid position-relative",style:"margin-bottom: "+k+"; margin-top: "+w+";"},Object(i.h)(g.a,{stores:this.props.stores,path:L,raceid:R}),C&&Object(i.h)("span",{class:"float-right position-absolute",style:"top: 10px; right: 10px; z-index:10000;"},Object(i.h)("a",{href:"/race/"+R+"/edit",class:"btn btn-small btn-primary"},Object(i.h)("nobr",null,Object(i.h)("i",{class:"fas fa-chart-line"})," ",Object(i.h)(h.c,{id:"race.edit"},"Endre lÃ¸pet")))),Object(i.h)("div",{class:"row border-bottom "},Object(i.h)("div",{class:"col-12"},Object(i.h)("div",{class:"jumbotron-thumb d-flex align-items-center position-relative"},N.images&&N.images[0]?Object(i.h)("img",{src:N.images[0].s3XXLargeLink,class:"img-fluid border rounded-lg",style:"min-width: 100%"}):""),Object(i.h)("h3",{class:"float-right"},"signup"===G&&!N.liveRace&&Object(i.h)(e,null,Object(i.h)("div",{class:"spinner-grow text-primary",role:"status"}),Object(i.h)("span",{class:"badge badge-primary ml-2"},Object(i.h)(h.c,{id:"races.signup-open"},"PÃ¥melding Ã¥pen"))),"race"===G&&Object(i.h)(e,null,Object(i.h)("div",{class:"spinner-grow text-danger",role:"status"}),Object(i.h)("span",{class:"badge badge-danger ml-2"},Object(i.h)(h.c,{id:"races.race-in-progress"},"LÃ¸p pÃ¥gÃ¥r"))),"done"===G&&Object(i.h)(e,null,Object(i.h)("i",{class:"fas fa-check text-success"}),Object(i.h)("span",{class:"badge badge-success ml-2"},Object(i.h)(h.c,{id:"races.race-finished"},"LÃ¸p avsluttet")))),Object(i.h)("h1",{class:"float-right"},C&&Object(i.h)("i",{class:"fas fa-eye"+(N.active?" text-success":"-slash text-danger")+" float-right"})),(t=N.title,Object(o.d)((function(){document.title="Homerun Race: "+t}),[t]),Object(i.h)("h1",{class:"my-0"},t)),K>10?Object(i.h)("span",{class:"text-muted font-weight-lighter"},Object(i.h)(h.c,{id:"races.starting-teams",fields:{totalContestants:K,totalClasses:B}})):Object(i.h)(e,null),Object(i.h)("div",{class:"text-muted mt-2"},Object(i.h)("span",null,N.startDate&&Object(i.h)(e,null,l.a.formatDate(N.startDate,{locale:_,hour12:!1,hour:"2-digit",minute:"2-digit"})),N.endDate&&Object(i.h)(e,null," - ",l.a.formatDate(N.endDate,{locale:_,hour12:!1,hour:"2-digit",minute:"2-digit"}))),Object(i.h)("span",{class:""},N.tag&&N.tag.split(",").map((function(t){return Object(i.h)(e,null,Object(i.h)("span",{class:"badge badge-pill badge-primary py-1 ml-2"},Object(i.h)("a",{class:"text-white",href:"https://www.facebook.com/hashtag/"+t,target:"_blank",rel:"noreferrer",native:!0},Object(i.h)("i",{class:"fab fa-facebook"})," #",t)),Object(i.h)("span",{class:"badge badge-pill badge-primary py-1 ml-2"},Object(i.h)("a",{class:"text-white",href:"https://www.instagram.com/explore/tags/"+t,target:"_blank",rel:"noreferrer",native:!0},Object(i.h)("i",{class:"fab fa-instagram"})," #",t)))}))),N.contactEmail&&Object(i.h)("span",{class:"ml-2"},Object(i.h)("a",{href:"mailto:"+N.contactEmail+"subject=Regarding "+N.title+"&body=Write your question here :)"},Object(i.h)("i",{class:"fas fa-envelope"})," ",N.contactEmail)),N.facebook&&Object(i.h)("span",{class:"ml-2"},Object(i.h)("a",{href:""+N.facebook,target:"_blank",rel:"noreferrer",native:!0},Object(i.h)("i",{class:"fab fa-facebook"})," Facebook")),N.instagram&&Object(i.h)("span",{class:"ml-2"},Object(i.h)("a",{href:""+N.instagram,target:"_blank",rel:"noreferrer",native:!0},Object(i.h)("i",{class:"fab fa-instagram"})," Instagram")),N.signuppayment&&Object(i.h)("span",{class:"badge badge-pill badge-success py-1 ml-2"},Object(i.h)("span",{class:"font-weight-lighter"},Object(i.h)(h.c,{id:"race.signup-payment"},"Betaling pÃ¥melding"),":")," ",y.a.replaceImages(N.signuppayment,N.images,_,!1))),N.locationCity&&Object(i.h)("div",{class:"text-muted"},Object(i.h)(h.c,{id:"race.location"},"Sted"),": ",N.locationCity,", ",N.locationCountry),Object(i.h)("ul",{class:"nav nav-tabs my-3"},Object(i.h)("li",{class:"nav-item"},Object(i.h)("a",{class:"nav-link "+(E?"":"active"),href:"/race/"+R},Object(i.h)("i",{class:"fas fa-info-circle"})," ",Object(i.h)(h.c,{id:"race.about"},"Om lÃ¸pet"))),Object(i.h)("li",{class:"nav-item"},Object(i.h)("a",{class:"nav-link "+("news"===E?"active":""),href:"/race/"+R+"/news"},Object(i.h)("i",{class:"fas fa-rss"})," ",Object(i.h)(h.c,{id:"race.news"},"Nyheter"))),Object(i.h)("li",{class:"nav-item"},Object(i.h)("a",{class:"nav-link "+("rules"===E?"active":""),href:"/race/"+R+"/rules"},Object(i.h)("i",{class:"fas fa-gavel"})," ",Object(i.h)(h.c,{id:"race.rules"},"Regler"))),N.veterinaryInfo&&Object(i.h)("li",{class:"nav-item"},Object(i.h)("a",{class:"nav-link "+("veterinaryInfo"===E?"active":""),href:"/race/"+R+"/veterinaryInfo"},Object(i.h)("i",{class:"fas fa-stethoscope"})," ",Object(i.h)(h.c,{id:"race.veterinary"},"VeterinÃ¦rinfo"))),N.checkpoints&&Object(i.h)("li",{class:"nav-item"},Object(i.h)("a",{class:"nav-link "+("checkpoints"===E?"active":""),href:"/race/"+R+"/checkpoints"},Object(i.h)("i",{class:"fas fa-map-marker-alt"})," ",Object(i.h)(h.c,{id:"race.checkpoints"},"Sjekkpunkter"))),N.trailDescription&&Object(i.h)("li",{class:"nav-item"},Object(i.h)("a",{class:"nav-link "+("trailDescription"===E?"active":""),href:"/race/"+R+"/trailDescription"},Object(i.h)("i",{class:"fas fa-map-signs"})," ",Object(i.h)(h.c,{id:"race.track-description"},"LÃ¸ypebeskrivelse"))),N.program&&Object(i.h)("li",{class:"nav-item"},Object(i.h)("a",{class:"nav-link "+("program"===E?"active":""),href:"/race/"+R+"/program"},Object(i.h)("i",{class:"fas fa-list-alt"})," ",Object(i.h)(h.c,{id:"race.program"},"Program"))),N.prices&&Object(i.h)("li",{class:"nav-item"},Object(i.h)("a",{class:"nav-link "+("prices"===E?"active":""),href:"/race/"+R+"/prices"},Object(i.h)("i",{class:"fas fa-award"})," ",Object(i.h)(h.c,{id:"race.prices"},"Premier"))),Object(i.h)("li",{class:"nav-item"},Object(i.h)("a",{class:"nav-link "+("classes"===E?"active":""),href:"/race/"+R+"/classes"},Object(i.h)("i",{class:"fas fa-folder-open"})," ",Object(i.h)(h.c,{id:"race.classes"},"Klasser"))),Object(i.h)("li",{class:"nav-item"},Object(i.h)("a",{class:"nav-link "+("signup"===E?"active":""),href:"/race/"+R+"/signup"},Object(i.h)("i",{class:"fas fa-folder-open"})," ",Object(i.h)(h.c,{id:"race.signup"},"PÃ¥melding"))))),Object(i.h)("div",{class:"col-"+U+" offset-"+H+" col-sm-8 col-lg-8 offset-sm-2 offset-lg-2"},!E&&Object(i.h)(e,null,N.articles&&N.articles.length>0&&Object(i.h)("div",{class:"row"},Object(i.h)("div",{class:"col-12 mb-3 py-2 position-relative border-bottom bg-light"},Object(i.h)("small",null,Object(i.h)("div",{class:"font-weight-bold"},Object(i.h)("i",{class:"fas fa-rss"})," ",Object(i.h)(h.c,{id:"race.news"},"Nyheter")),Object(i.h)("div",{class:"row"},N.articles&&N.articles.reverse().slice(0,3).map((function(t){return Object(i.h)(e,null,Object(i.h)("div",{class:"col-12 col-sm-6 col-md-4 col-lg-4 p-3 position-relative"},t.image&&Object(i.h)("img",{src:t.image.s3LargeLink,class:"float-right rounded-lg ml-2",style:"height: 70px;"}),Object(i.h)("span",{class:"text-muted font-weight-light mr-2"},l.a.formatDate(t.date,{locale:_,hour12:!1,hour:"2-digit",minute:"2-digit"})),Object(i.h)("span",{class:"font-weight-bold mr-2",style:"font-size: 1.2em;"},Object(i.h)("a",{href:"/race/"+R+"/news",class:"text-"+(F?"light":"dark")},y.a.replaceImages(t.title,N.images,_,!1))),Object(i.h)("br",null),Object(i.h)("span",{class:"font-weight-normal"},y.a.replaceImages(t.body,N.images,_,!1))))})),N.articles.length>3&&Object(i.h)("div",{class:"col-12 mt-2 text-center",style:"font-size: 1.5em;"},Object(i.h)("a",{href:"/race/"+R+"/news",class:"text-muted"},Object(i.h)(h.c,{id:"race.more-news"},"Flere nyheter")," Â»")))))),Object(i.h)("p",{class:"clearfix"},Object(i.h)("strong",null,Object(i.h)(p.a,{markdown:y.a.replaceImages(N.ingress,N.images,_),markdownOpts:y.a.getMarkdownOptions()}))),Object(i.h)(p.a,{markdown:y.a.replaceImages(N.body,N.images,_),markdownOpts:y.a.getMarkdownOptions()})),"news"===E&&Object(i.h)(e,null,Object(i.h)("div",{class:"row"},Object(i.h)("div",{class:"col-12"},Object(i.h)("h2",null,Object(i.h)(h.c,{id:"race.news"},"Nyheter"))),N.articles&&N.articles.reverse().map((function(t){return Object(i.h)(e,null,Object(i.h)("div",{class:"col-12 col-sm-12 col-md-6 col-lg-4 p-3 position-relative"},Object(i.h)("h5",null,y.a.replaceImages(t.title,N.images,_,!1)),t.image&&Object(i.h)("img",{src:t.image.s3LargeLink,class:"float-right w-50 rounded-lg ml-2"}),Object(i.h)("small",{class:"text-muted"}," ",l.a.formatDate(t.date,{locale:_,hour12:!1,hour:"2-digit",minute:"2-digit"})),Object(i.h)("br",null),Object(i.h)("div",{class:"font-weight-bold"},Object(i.h)(p.a,{markdown:y.a.replaceImages(t.ingress,N.images,_),markdownOpts:y.a.getMarkdownOptions()})),Object(i.h)("div",null,Object(i.h)(p.a,{markdown:y.a.replaceImages(t.body,N.images,_),markdownOpts:y.a.getMarkdownOptions()}))))})))),"rules"===E&&Object(i.h)(e,null,Object(i.h)("h2",null,Object(i.h)(h.c,{id:"race.rules"},"Regler")),Object(i.h)(p.a,{markdown:y.a.replaceImages(N.rules,N.images,_),markdownOpts:y.a.getMarkdownOptions()})),"veterinaryInfo"===E&&Object(i.h)(e,null,Object(i.h)("h2",null,Object(i.h)(h.c,{id:"race.veterinary"},"VeterinÃ¦rinfo")),Object(i.h)(p.a,{markdown:y.a.replaceImages(N.veterinaryInfo,N.images,_),markdownOpts:y.a.getMarkdownOptions()})),"checkpoints"===E&&Object(i.h)(e,null,Object(i.h)("h2",null,Object(i.h)(h.c,{id:"race.checkpoints"},"Sjekkpunkter")),Object(i.h)(p.a,{markdown:y.a.replaceImages(N.checkpoints,N.images,_),markdownOpts:y.a.getMarkdownOptions()})),"trailDescription"===E&&Object(i.h)(e,null,Object(i.h)("h2",null,Object(i.h)(h.c,{id:"race.track-description"},"LÃ¸ypebeskrivelse")),Object(i.h)(p.a,{markdown:y.a.replaceImages(N.trailDescription,N.images,_),markdownOpts:y.a.getMarkdownOptions()})),"program"===E&&Object(i.h)(e,null,Object(i.h)("h2",null,Object(i.h)(h.c,{id:"race.program"},"Program")),Object(i.h)(p.a,{markdown:y.a.replaceImages(N.program,N.images,_),markdownOpts:y.a.getMarkdownOptions()})),"prices"===E&&Object(i.h)(e,null,Object(i.h)("h2",null,Object(i.h)(h.c,{id:"race.prices"},"Premier")),Object(i.h)(p.a,{markdown:y.a.replaceImages(N.prices,N.images,_),markdownOpts:y.a.getMarkdownOptions()})),"classes"===E&&Object(i.h)(e,null,Object(i.h)("h2",null,Object(i.h)(h.c,{id:"race.classes"},"Klasser")),Object(i.h)("div",{class:"row"},N.classes&&N.classes.sort((function(e,t){return e.distance-t.distance})).map((function(t){return Object(i.h)(e,null,Object(i.h)("div",{class:"col-6 col-sm-6 col-lg-4 mb-4"},Object(i.h)("div",{class:"border rounded rounded-lg p-3"},Object(i.h)("h5",null,t.title),Object(i.h)("small",null,t.startDate&&Object(i.h)("div",null,Object(i.h)("span",{class:"font-weight-lighter"},Object(i.h)(h.c,{id:"race.startdate"},"Start"),":")," ",l.a.formatDate(t.startDate+" "+(t.startTime||"00:00:00"),{locale:_,hour12:!1,hour:"2-digit",minute:"2-digit"})),t.endDate&&Object(i.h)("div",null,Object(i.h)("span",{class:"font-weight-lighter"},Object(i.h)(h.c,{id:"race.enddate"},"End"),":")," ",l.a.formatDate(t.endDate+" "+(t.endTime||"00:00:00"),{locale:_,hour12:!1,hour:"2-digit",minute:"2-digit"}))),Object(i.h)("div",null,Object(i.h)("span",{class:"font-weight-lighter"},Object(i.h)(h.c,{id:"race.distance"},"Distanse"),":")," ",t.distance," km"),Object(i.h)("div",null,Object(i.h)("span",{class:"font-weight-lighter"},Object(i.h)(h.c,{id:"race.signup"},"PÃ¥melding"),":")," ",t.signupfee||N.signupfee," NOK"),Object(i.h)("p",{class:"clearfix"},Object(i.h)(p.a,{markdown:y.a.replaceImages(t.ingress,N.images,_),markdownOpts:y.a.getMarkdownOptions()})),Object(i.h)("small",null,Object(i.h)(p.a,{markdown:y.a.replaceImages(t.body,N.images,_),markdownOpts:y.a.getMarkdownOptions()})),t.rules&&Object(i.h)(e,null,Object(i.h)("h5",null,Object(i.h)(h.c,{id:"race.rules"},"Regler")),Object(i.h)(p.a,{markdown:y.a.replaceImages(t.rules,N.images,_),markdownOpts:y.a.getMarkdownOptions()})))))})))),"signup"===E&&Object(i.h)(f.a,{stores:this.props.stores,raceid:R,subsection:T})),Object(i.h)("div",{class:"col-"+U+" offset-"+H+" col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mt-5"},Y&&Y.length>0&&Object(i.h)("small",{class:"bg-light shadow-sm rounded-lg py-0 px-1",style:"bottom: 20px; right: 15px;"},Object(i.h)("i",{class:"fas fa-thumbs-up text-primary"})," ",Y.length),J&&J.length>0&&Object(i.h)("small",{class:"float-right bg-light shadow-sm rounded-lg py-0 px-1",style:"bottom: 20px; right: 15px;"},Object(i.h)("i",{class:"fas fa-comment text-primary"})," ",J.length)),I.email&&Object(i.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-2 mb-3"},Object(i.h)("div",{class:"row"},Object(i.h)("div",{class:"col-6 text-center"},Object(i.h)("button",{type:"button",class:"btn btn-outline-"+(q?"primary":"secondary")+" btn-lg btn-block "+(q?"text-primary":""),onClick:this.likeRace},Object(i.h)("i",{class:(q?"text-primary fas":"far")+" fa-thumbs-up"})," Like")),Object(i.h)("div",{class:"col-6 text-center"},Object(i.h)("button",{type:"button",class:"btn btn-outline-secondary btn-lg btn-block","data-id":N.id,onClick:this.toggleAddComment},Object(i.h)("i",{class:"fas fa-comment"})," Comment")))),Object(i.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-2 mb-3"},r&&I.email&&Object(i.h)(j.a,{stores:this.props.stores,race:N,inputRef:function(e){return a.inputRef[N.id]=e},inputRefObject:this.inputRef})),Object(i.h)("div",{class:"col-12 mt-2"},Object(i.h)(O.a,{stores:this.props.stores,race:N,cols:"12"}))),C&&Object(i.h)(e,null,Object(i.h)("h2",{class:"mt-5"},"Articles"),Object(i.h)("div",{class:"row"},N.articles&&N.articles.map((function(t){return Object(i.h)(e,null,Object(i.h)("div",{class:"col-12 col-sm-6 col-md-4 col-lg-3 border rounded-lg p-3 position-relative"},Object(i.h)("button",{class:"btn btn-danger position-absolute",style:"top:5px; right: 5px;","data-id":t.id,onClick:a.removeRaceArticle},Object(i.h)("i",{class:"fas fa-times"})),t.image&&Object(i.h)("img",{src:t.image.s3LargeLink,class:"float-right w-100"}),["title"].map((function(s){return Object(i.h)(e,null,Object(i.h)("div",{class:"form-group"},Object(i.h)("input",{type:"text",class:"form-control-plaintext font-weight-bold",id:s,"aria-describedby":s+"Help",style:"font-size: 1.5em;","data-id":t.id,"data-field":s,value:t[s],onInput:a.editRaceArticle})))})),["ingress","body"].map((function(s){return Object(i.h)(e,null,Object(i.h)("div",{class:"form-group"},Object(i.h)("textarea",{type:"textarea",class:"form-control-plaintext",id:s,"aria-describedby":s+"Help","data-id":t.id,"data-field":s,value:t[s],onInput:a.editRaceArticle,style:"height: 1em;"})))}))))}))),Object(i.h)("div",{class:"row"},Object(i.h)("div",{class:"col-6 offset-3 border rounded-lg m-2 p-3 bg-light"},Object(i.h)("h5",null,"Add new article"),n&&n.image&&Object(i.h)("img",{src:n.image.s3LargeLink,class:"float-right w-50",onError:this.handleImageErrored}),["title"].map((function(t){return Object(i.h)(e,null,Object(i.h)("div",{class:"form-group"},Object(i.h)("label",{for:t},t),Object(i.h)("input",{type:"text",class:"form-control",id:t,"aria-describedby":t+"Help",onInput:Object(b.a)(a,"newRaceArticle."+t),value:n[t]})))})),["ingress","body"].map((function(t){return Object(i.h)(e,null,Object(i.h)("div",{class:"form-group"},Object(i.h)("label",{for:t},t),Object(i.h)("textarea",{type:"text",class:"form-control",id:t,"aria-describedby":t+"Help",onInput:Object(b.a)(a,"newRaceArticle."+t),onKeyUp:a.resizeTextarea,style:"height: 1em;",value:n[t]})))})),Object(i.h)(v.a,{saved:{},object:{},field:"image",updateField:this.updateArticleUpload,autoOpen:!1}),Object(i.h)("button",{class:"btn btn-info",onClick:this.addRaceArticle},"Add race article"))),Object(i.h)("h2",{class:"mt-5"},"User images"),Object(i.h)("div",{class:"row"},N.userImages&&N.userImages.map((function(t){return Object(i.h)(e,null,Object(i.h)("div",{class:"col-12 col-sm-6 col-md-4 col-lg-3 border rounded-lg p-3 position-relative"},Object(i.h)("button",{class:"btn btn-danger position-absolute",style:"top:5px; right: 5px;","data-id":t.id,onClick:a.removeRaceUserImage},Object(i.h)("i",{class:"fas fa-times"})),Object(i.h)("img",{src:t.image.s3LargeLink,class:"float-right w-100"}),["title"].map((function(s){return Object(i.h)(e,null,Object(i.h)("div",{class:"form-group "},Object(i.h)("input",{type:"text",class:"form-control-plaintext font-weight-bold",id:s,"aria-describedby":s+"Help",style:"font-size: 1.5em;","data-id":t.id,"data-field":s,value:t[s],onInput:a.editRaceUserImage})))})),["body"].map((function(s){return Object(i.h)(e,null,Object(i.h)("div",{class:"form-group"},Object(i.h)("textarea",{type:"textarea",class:"form-control-plaintext",id:s,"aria-describedby":s+"Help","data-id":t.id,"data-field":s,value:t[s],onInput:a.editRaceUserImage,style:"height: 1em;"})))}))))}))),Object(i.h)("div",{class:"row"},Object(i.h)("div",{class:"col-3 offset-3 border rounded-lg m-2 p-3 bg-light"},Object(i.h)("h5",null,"Add new user image"),Object(i.h)("div",{class:"row"},Object(i.h)("div",{class:"col"},c&&c.image&&Object(i.h)("img",{src:c.image.s3LargeLink,class:"float-right w-50",onError:this.handleImageErrored}),["title"].map((function(t){return Object(i.h)(e,null,Object(i.h)("div",{class:"form-group"},Object(i.h)("label",{for:t},t),Object(i.h)("input",{type:"text",class:"form-control",id:t,"aria-describedby":t+"Help",onInput:Object(b.a)(a,"newRaceUserImage."+t),value:c[t]})))})),["body"].map((function(t){return Object(i.h)(e,null,Object(i.h)("div",{class:"form-group"},Object(i.h)("label",{for:t},t),Object(i.h)("textarea",{type:"text",class:"form-control",id:t,"aria-describedby":t+"Help",onInput:Object(b.a)(a,"newRaceUserImage."+t),onKeyUp:a.resizeTextarea,style:"height: 1em;",value:c[t]})))})))),Object(i.h)(v.a,{saved:{},object:{},field:"image",updateField:this.updateUserImageUpload,autoOpen:!1}),Object(i.h)("button",{class:"btn btn-info",onClick:this.addRaceUserImage},"Add race user image"))))))},a}(i.Component))||c;t.default=S}.call(this,a("hosL").Fragment)},u2zT:function(e,t,a){"use strict";var s,r=a("hosL"),n=a("/eY4"),c=a("Utv1"),i=a("OhSV"),o=Object(n.a)(s=function(e){function t(t){var a;return(a=e.call(this,t)||this).dropRef=Object(r.createRef)(),a.handleDrag=function(e){e.preventDefault(),e.stopPropagation()},a.handleDragIn=function(e){e.preventDefault(),e.stopPropagation(),a.dragCounter++,e.dataTransfer.items&&e.dataTransfer.items.length>0&&a.setState({drag:!0})},a.handleDragOut=function(e){e.preventDefault(),e.stopPropagation(),a.dragCounter--,0===a.dragCounter&&a.setState({drag:!1})},a.handleDrop=function(e){if(e.preventDefault(),e.stopPropagation(),a.setState({drag:!1}),e.dataTransfer.files&&e.dataTransfer.files.length>0){for(var t=0,s=e.dataTransfer.files.length;t<s;t+=1){a.readLocalFile(e.dataTransfer.files[t])}a.dragCounter=0}},a.handleAddFiles=function(e){e.preventDefault();var t=e.target;for(var s=0,r=t.files.length;s<r;s+=1){a.readLocalFile(t.files[s])}},a.handleEvent=function(){0},a.handleUpload=function(e){var t=a.props,s=t.uploadStatus,r=t.before,n=void 0===r?function(){}:r,i=t.after,o=void 0===i?function(){}:i;(void 0===s?function(){}:s)(!1),c.a.isFunction(n)&&n();var l=new FormData;l.append("files[]",e);var d={progress:1};d.xhr=new XMLHttpRequest,d.xhr.upload.addEventListener("progress",(function(t){a.updateProgress(t,e)})),d.xhr.addEventListener("loadstart",(function(t){a.handleEvent(t,e)})),d.xhr.addEventListener("load",(function(t){a.handleEvent(t,e)})),d.xhr.addEventListener("loadend",(function(t){var s=e;c.a.isFunction(o)&&o(),a.handleEvent(t,s)})),d.xhr.addEventListener("progress",(function(t){a.handleEvent(t,e)})),d.xhr.addEventListener("error",(function(t){a.handleEvent(t,e)})),d.xhr.addEventListener("abort",(function(t){a.handleEvent(t,e)})),d.xhr.addEventListener("readystatechange",(function(t){a.uploadDone(t,e)})),d.xhr.open("POST",""+c.a.getApiServer()+a.props.apiUrl),d.xhr.setRequestHeader("Authorization","Bearer "+c.a.getJwtToken()),d.xhr.send(l);var h=e.name,b=a.state.uploadedFilesData;b[h]||(b[h]={}),b[h].uploadMeta=d,b[h].imageNum=a.state.imageNum,a.setState({uploadedFilesData:b})},a.readLocalFile=function(e){return new Promise((function(t,s){var r=new FileReader;r.addEventListener("error",(function(e){s(e)})),r.addEventListener("load",(function(s){var r=e,n=r.name,c=a.state.uploadedFilesData;c[n]||(c[n]={}),c[n].event=s,a.setState({uploadedFilesData:c}),a.handleUpload(r),t(s)})),r.readAsDataURL(e)}))},a.updateProgress=function(e,t){if(e.lengthComputable){var s=t.name,r=a.state.uploadedFilesData,n=e.loaded/e.total*100;0,r[s].uploadMeta.progress=n,a.setState({uploadedFilesData:r})}},a.uploadDone=function(e,t){var s=t.name,r=a.state.uploadedFilesData,n=r[s].uploadMeta;if(n&&4===n.xhr.readyState&&201===n.xhr.status)for(var c=JSON.parse(n.xhr.responseText).data.files,i=0;i<c.length;i+=1){a.addFileToUpload(c[i]),a.fileInput.value=""}},a.state={drag:!1,loadingProgress:0,uploadedFiles:[],uploadedFilesData:{}},a}var a,s;s=e,(a=t).prototype=Object.create(s.prototype),a.prototype.constructor=a,a.__proto__=s;var n=t.prototype;return n.addFileToUpload=function(e){var t=this.state.uploadedFilesData,a=this.props,s=a.handleAddImage,r=a.uploadStatus,n=void 0===r?function(){}:r;delete t[e.name],this.setState({uploadedFilesData:t}),s(e),n(!0)},n.componentDidMount=function(){var e=this,t=this.dropRef.current;t.addEventListener("dragenter",this.handleDragIn),t.addEventListener("dragleave",this.handleDragOut),t.addEventListener("dragover",this.handleDrag),t.addEventListener("drop",this.handleDrop),this.props.autoOpen&&setTimeout((function(){e.fileInput.click()}),10)},n.componentWillUnmount=function(){var e=this.dropRef.current;e.removeEventListener("dragenter",this.handleDragIn),e.removeEventListener("dragleave",this.handleDragOut),e.removeEventListener("dragover",this.handleDrag),e.removeEventListener("drop",this.handleDrop)},n.render=function(){var e=this,t=this.state.uploadedFilesData;return Object(r.h)("div",{style:{position:"relative"},ref:this.dropRef},this.state.drag&&Object(r.h)("div",{style:{border:"dashed grey 4px",backgroundColor:"rgba(255,255,255,.8)",position:"absolute",top:0,bottom:0,left:0,right:0,zIndex:9999}},Object(r.h)("div",{style:{position:"absolute",top:"50%",right:0,left:0,textAlign:"center",color:"grey",fontSize:36}},Object(r.h)("div",null,Object(r.h)(i.c,{id:"imageupload.drag-files-here"},"drop your files here :)")))),Object(r.h)("div",null,Object(r.h)("input",{class:"btn btn-info col-sm-12",multiple:!0,type:"file",id:"image-file",onchange:this.handleAddFiles,ref:function(t){e.fileInput=t}})),Object(r.h)("div",null,Object.keys(t).length>0?Object(r.h)("h3",null,Object(r.h)(i.c,{id:"imageupload.upload-images"},"Uploaded images")):"",Object(r.h)("ul",{class:"list-group"},Object.keys(t).map((function(e){var a=t[e].uploadMeta,s=void 0===a?{}:a,n=e.match(/(jpg|jpeg|png|gif|heic|heif|svg|webp|tif)/i);return Object(r.h)("li",{class:"list-group-item list-group-item-action flex-column align-items-start"},Object(r.h)("div",{class:"d-flex w-100 justify-content-between"},n&&Object(r.h)("img",{class:"img-fluid mr-3",src:t[e].event.target.result,style:"max-height: 50px;"}),Object(r.h)("small",null,t[e].event.uploadDone),Object(r.h)(i.c,{id:"imageupload.uploading-image"},"Laster opp bilde..."),Object(r.h)("small",null,c.a.formatBytes(t[e].event.total,2))),Object(r.h)("div",{class:"progress mt-1",style:"height: 4px;"},Object(r.h)("div",{class:"progress-bar progress-bar-striped progress-bar-animated bg-success",role:"progressbar",style:"width: "+s.progress+"%; height: 4px;","aria-valuenow":s.progress,"aria-valuemin":"0","aria-valuemax":"100"})))})))),this.props.children)},t}(r.Component))||s;t.a=o}}]);
//# sourceMappingURL=10.chunk.3da92.js.map