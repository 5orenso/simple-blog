{"version":3,"sources":["webpack:///./components/util/scrollIntoView.js","webpack:///./components/workout/calendar.js","webpack:///./routes/workouts/month.js","webpack:///./components/workout/index.js","webpack:///./components/modal/index.js","webpack:///./components/dog/scroller.js","webpack:///./components/team/teams.js"],"names":["initialState","ScrollIntoView","observer","Component","constructor","props","super","this","state","container","componentDidMount","horizontal","vertical","behavior","inline","block","scrollIntoView","render","ref","c","RED_DAYS","WorkoutCalendar","chooseDay","e","year","yyyy","month","mm","day","dd","chooseDayFunction","target","parentElement","dataset","setState","isLoading","skipLoadSummary","userStore","workoutStore","stores","currentTeam","currentMonth","Date","getMonth","util","getYear","team","dog","id","getWorkoutSummary","getWorkoutSummaryDay","loadWorkoutSummary","componentWillReceiveProps","nextProps","appState","workoutPlanStore","user","language","DAYS","mu","getDays","MONTHS","getMonths","darkmode","currentDay","getDate","currentYear","getFullYear","basehref","hideSummary","hideTable","seasonStart","parseInt","monthNum","yearNum","nextMonth","nextYear","getNextMonth","prevMonth","prevYear","getPrevMonth","weeksInMonth","getDaysInMonth","getWeeksInMonth","daysOfWeek","getDaysInWeek","week","totalDistanceKmMonth","totalCountMonth","totalElevationMonth","totalDurationMonth","totalSpeedavgMonth","totalPlanDistanceKmMonth","class","href","name","map","getDay","weekObj","summaryPlanWeek","findWorkoutPlanSummaryWeek","totalWeek","summary","findWorkoutSummaryWeekDay","summaryPlanDay","findWorkoutPlanSummaryDay","distanceKm","count","elevation","duration","push","speedAvg","distance","isChosen","isToday","isDayOff","indexOf","style","onClick","data-day","data-month","data-year","getTrainingColor","value","colspan","secToHms","avgArr","MARGIN_TOP","marginTop","MARGIN_BOTTOM","marginBottom","SUB_MENU_MARGIN_TOP","subMenuMarginTop","Workouts","loadWorkouts","async","load","query","loadDogs","dogStore","addData","trackStore","workoutsDay","callback","key","fields","workout","showDate","getWorkoutColor","type","getWorkoutIcon","MAX_LOADINDEX","getMaxLoadIndex","showAddComment","viewImageIdx","likeWorkout","Workout","toggleDate","stopPropagation","preventDefault","workoutId","setTimeout","toggleAddComment","inputRef","focus","viewImage","idx","closest","shareLink","url","title","text","shareUrl","onTeamClick","teamid","showTeam","hideTeam","onUserClick","onDogClick","dogid","dogs","showDog","hideDog","updateTimer","forceShowDate","wrapperClasses","wrapperClassesRow","viewmode","hasShareApi","allDogs","intensity","findIntensity","code","findTeam","teamName","teamNames","teams","forEach","likes","comments","hasLikedWorkout","findIndex","gpxInfo","mushers","loadIndex","workoutEquipment","findEquipment","equipment","workoutEquipmentIcon","field","musherImages","length","slice","musher","u","findPublicUser","images","publicUser","image","s3SmallLink","mapImage","imgs","toJS","batteryUsage","battegryLevelStart","battegryLevelEnd","views","getViews","statistics","back","img","temperature","isLocked","isInProgress","role","date","formatDate","locale","hour12","hour","minute","formatDistance","getLoadIndexColor","normalizeBetween","Math","floor","getLoadIndexText","garminId","stravaId","track","dogsLeft","dogsRight","sledWeight","format","kcalBurnedTotal","kcalMeatGramsTotal","kcalSalmonGramsTotal","kcalFatGramsTotal","description","markdown","replaceImages","comment","markdownOpts","getMarkdownOptions","avgGpsMovingSpeed","dblClick","likeRef","data-id","data-url","uuidv4","data-title","rel","data-native","inputRefObject","col","offset","compact","object","isTeamAdmin","isAdmin","Modal","touchStart","startY","touches","pageY","touchEnd","undefined","readyToRefresh","touchMove","close","refreshing","y","appContainer","scrollTop","imagexxl","thumb","src","onTouchstart","onTouchend","onTouchmove","download","DogScroller","scrollImages","scrollLeft","clientWidth","imageIdx","nearestInt","round","diff","abs","Number","isInteger","sortByName","a","b","dogA","find","dogB","size","onScroll","sort","dogId","filter","d","className","showName","showPosition","Teams","toggleTeam","unsetTeamIfSelected","setCurrentTeam","isDefined","showAllTeams","highlight","showAll"],"mappings":"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","file":"57.chunk.e5436.esm.js","sourcesContent":["import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\n\nconst initialState = {};\n\n@observer\nclass ScrollIntoView extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n        this.container = null;\n    }\n\n    componentDidMount() {\n        const { horizontal, vertical = '' } = this.props;\n        const props = {\n            behavior: 'smooth',\n        };\n        if (horizontal) {\n            props.inline = horizontal;\n        }\n        if (vertical) {\n            props.block = vertical;\n        }\n\t\tthis.container.scrollIntoView(props);\n\t}\n\n    render() {\n        return (\n            <div ref={c => this.container = c}>&nbsp;</div>\n        );\n    }\n}\n\nexport default ScrollIntoView;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer, withText } from 'preact-i18n';\n\nimport Speed from '../../components/data/speed';\nimport Elevation from '../../components/data/elevation';\nimport Weight from '../../components/data/weight';\nimport Distance from '../../components/data/distance';\nimport Temperature from '../../components/data/temperature';\n\nimport mu from '../../lib/musher-util';\n\nconst RED_DAYS = [0, 6];\n\n@observer\nclass WorkoutCalendar extends Component {\n\n    async loadWorkoutSummary(props = this.props) {\n        this.setState({ isLoading: true });\n        if (props.skipLoadSummary) {\n            return false;\n        }\n\n\t\tconst { userStore, workoutStore } = this.props.stores;\n\t\tconst { currentTeam } = workoutStore;\n\n        const currentMonth = new Date().getMonth() + 1;\n        const { month = currentMonth, year = util.getYear(), team = currentTeam, dog = {} } = props;\n        if (dog && dog.id) {\n            await userStore.getWorkoutSummary({ dog: dog.id, year });\n            await userStore.getWorkoutSummaryDay({ month, year, dog: dog.id });\n        } else {\n            await userStore.getWorkoutSummary({ team, dog: dog.id, year });\n            await userStore.getWorkoutSummaryDay({ month, year, team, dog: dog.id });\n        }\n\t\t// await workoutStore.load({ query: { team: currentTeam, month, year } });\n        this.setState({ isLoading: false });\n    }\n\n    chooseDay = (e) => {\n        const { year: yyyy, month: mm, day: dd } = this.state;\n        const { chooseDayFunction = () => {} } = this.props;\n\t\tconst day = e.target.parentElement.dataset.day || e.target.dataset.day;\n\t\tconst month = e.target.parentElement.dataset.month || e.target.dataset.month;\n\t\tconst year = e.target.parentElement.dataset.year || e.target.dataset.year;\n\t\t// console.log({ day, month, year });\n\n        if (year === yyyy && month === mm && day === dd) {\n            this.setState({\n                year: null,\n                month: null,\n                day: null,\n            });\n        } else {\n            this.setState({\n                year,\n                month,\n                day,\n            });\n        }\n        chooseDayFunction({ day, month, year });\n    }\n\n    componentDidMount() {\n        this.loadWorkoutSummary();\n    }\n\n    componentWillReceiveProps(nextProps) {\n        // console.log('componentWillReceiveProps', nextProps);\n        if (nextProps.month !== this.props.month\n            || nextProps.year !== this.props.year\n            || nextProps.dog !== this.props.dog\n            || nextProps.team !== this.props.team) {\n            this.loadWorkoutSummary(nextProps);\n        }\n    }\n\n    render() {\n        const { appState, userStore, workoutPlanStore } = this.props.stores;\n        const { user } = userStore;\n        const { language = 'en' } = user;\n        const DAYS = mu.getDays(language);\n        const MONTHS = mu.getMonths(language);\n\n        const { day: dd, month: mm, year: yyyy } = this.state;\n\n\t\tconst { darkmode } = appState;\n        \n        const currentDay = new Date().getDate();\n        const currentMonth = new Date().getMonth() + 1;\n        const currentYear = new Date().getFullYear();\n\n\t\tconst { month = currentMonth, year = currentYear, dog, basehref, hideSummary, hideTable } = this.props;\n\n\t\tconst seasonStart = parseInt(month < 8 ? year - 1 : year, 10);\n\n        const monthNum = parseInt(month, 10);\n        const yearNum = parseInt(year, 10);\n        const { month: nextMonth, year: nextYear } = mu.getNextMonth(monthNum, yearNum);\n        const { month: prevMonth, year: prevYear } = mu.getPrevMonth(monthNum, yearNum);\n\n        const daysOfMonth = util.getDaysInMonth(month, year);\n        const weeksInMonth = util.getWeeksInMonth(month, year);\n        const firstWeek = weeksInMonth[0].week;\n        const daysOfWeek = util.getDaysInWeek(firstWeek, year, month);\n        let totalDistanceKmMonth = 0;\n        let totalCountMonth = 0;\n        let totalElevationMonth = 0;\n        let totalDurationMonth = 0;\n        let totalSpeedavgMonth = [];\n\n        let totalPlanDistanceKmMonth = 0;\n\n        return (\n            <>\n                <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-4 text-center'>\n                    <a href={`${basehref || '/workouts/month/'}${nextMonth}/${nextYear}/skipScroll`} class='float-right btn btn-sm btn-outline-secondary ml-2'><i class='fas fa-arrow-right' /></a>\n                    <a href={`${basehref || '/workouts/month/'}${prevMonth}/${prevYear}/skipScroll`} class='float-left btn btn-sm btn-outline-secondary mr-2'><i class='fas fa-arrow-left' /></a>\n                    <h3><Text id='workout.calendar.month'>Måned</Text> - {MONTHS[month - 1]} {year}</h3>\n                    <h5 class='text-muted font-weight-light'><Text id='workout.plan.season'>Sesongen</Text> {seasonStart} - {seasonStart + 1}</h5>\n                    {dog && <div>{dog.name}</div>}\n                    {/* <small>{util.isoDate(daysOfMonth[0], false, false, true)} - {util.isoDate(daysOfMonth[daysOfMonth.length - 1], false, false, true)}</small> */}\n                </div>\n\n                <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-4'>\n\n                    {!hideTable && <>\n                        <table class='table table-striped table-sm'>\n                            <thead>\n                                <tr>\n                                    <th class='text-muted'><small><Text id='workout.calendar.week'>Uke</Text></small></th>\n                                    {daysOfWeek.map(day => <th><small>{DAYS[day.getDay()]}</small></th>)}\n                                    <th class='text-muted'><small><Text id='workout.calendar.sum'>Sum</Text></small></th>\n                                    {/* <th class='text-muted'>Totalt</th> */}\n                                </tr>\n                            </thead>\n                            <tbody>\n                                {weeksInMonth && weeksInMonth.map(weekObj => {\n                                    const daysOfWeek = util.getDaysInWeek(weekObj.week, year, month);\n                                    const summaryPlanWeek = workoutPlanStore.findWorkoutPlanSummaryWeek(parseInt(year, 10), weekObj.week) || {};\n                                    let totalWeek = 0;\n                                    return (\n                                        <tr>\n                                            <td class='text-right text-muted pt-3'>\n                                                <small>\n                                                    <a href={`/workouts/week/${weekObj.week}/${year}`} class='text-muted'>{weekObj.week}</a>\n                                                </small>\n                                            </td>\n                                            {daysOfWeek.map(day => {\n                                                const summary = userStore.findWorkoutSummaryWeekDay(day.getFullYear(), day.getMonth() + 1, day.getDate(), monthNum) || {};\n                                                const summaryPlanDay = workoutPlanStore.findWorkoutPlanSummaryDay(day.getFullYear(), day.getMonth() + 1, day.getDate(), monthNum) || {};\n                                                if (summary && summary.distanceKm) {\n                                                    totalWeek += summary.distanceKm;\n                                                    totalDistanceKmMonth += summary.distanceKm;\n                                                    totalCountMonth += summary.count;\n                                                    totalElevationMonth += summary.elevation;\n                                                    totalDurationMonth += summary.duration;\n                                                    totalSpeedavgMonth.push(summary.speedAvg);\n                                                }\n                                                if (summaryPlanDay && summaryPlanDay.distance) {\n                                                    totalPlanDistanceKmMonth += summaryPlanDay.distance;\n                                                }\n                                                const isChosen = (dd == day.getDate()) && (mm == day.getMonth() + 1) && (yyyy === day.getFullYear());\n                                                const isToday =  (currentDay == day.getDate()) && (currentMonth == day.getMonth() + 1) && (currentYear == day.getFullYear());\n                                                const isDayOff = RED_DAYS.indexOf(day.getDay()) > -1;\n                                                // console.log(summary);\n                                                // count: 1, day: 5, distanceKm: 10, duration: 3600, elevation: 200, month: 9, speedAvg: 12, year: 2020\n                                                return (\n                                                    <td class={`text-center font-weight-light position-relative pt-3 pb-3 ${isChosen ? 'calendarIsChosen' : ''} ${isToday ? 'calendarIsToday' : ''} ${isDayOff ? 'calendarIsWeekend' : ''}`}\n                                                        style={`font-size: 0.8em;`}\n                                                        onClick={this.chooseDay} data-day={day.getDate()} data-month={day.getMonth() + 1} data-year={year}\n                                                    >\n                                                        <div class='position-absolute text-muted' style='top: 0px; right: 2px; font-size: 0.7em;'>\n                                                            {day.getDate()}\n                                                        </div>\n                                                        {summary && summary.distanceKm ? \n                                                            <div class='rounded-pill w-100 px-1'\n                                                                style={`background-color: ${mu.getTrainingColor(summary, darkmode)};`}\n                                                            >\n                                                                <Distance stores={this.props.stores} value={summary.distanceKm} />\n                                                                {summary.count > 1 && (\n                                                                    <span class='position-absolute text-danger'\n                                                                        style='bottom: 0; right: 0px; font-size: 0.6em;'>\n                                                                        {summary.count}\n                                                                    </span>\n                                                                )}\n\n                                                            </div> : '-'}\n                                                        {summaryPlanDay.distance > 0 && (\n                                                            <span class='position-absolute text-primary'\n                                                                style='bottom: 0; left: 0px; font-size: 0.9em;'>\n                                                                <Distance stores={this.props.stores} value={summaryPlanDay.distance} />\n                                                            </span>\n                                                        )}\n                                                    </td>\n                                                );\n                                            })}\n                                            <td class='text-right pt-3 pb-3 position-relative' style='font-size: 0.8em;'>\n                                                <Distance stores={this.props.stores} value={totalWeek} />\n                                                {summaryPlanWeek.distance > 0 && (\n                                                    <span class='position-absolute text-primary'\n                                                        style='bottom: 0; left: 0px; font-size: 0.9em;'>\n                                                        <Distance stores={this.props.stores} value={summaryPlanWeek.distance} />\n                                                    </span>\n                                                )}    \n                                            </td>\n                                            {/* <td class='text-right text-muted pt-3'>{totalDistanceKmMonth}</td> */}\n                                        </tr>\n                                    );\n                                })}\n                            </tbody>\n                            <tfoot>\n                                <tr>\n                                    <td colspan='8' class='text-right'><Text id='workout.calendar.totalKm'>Totalt km</Text></td>\n                                    <td class='text-right text-muted pb-3 position-relative'>\n                                        <Distance stores={this.props.stores} value={totalDistanceKmMonth} />\n                                        {totalPlanDistanceKmMonth > 0 && (\n                                            <span class='position-absolute text-primary'\n                                                style='bottom: 0; left: 0px; font-size: 0.8em;'>\n                                                <Distance stores={this.props.stores} value={totalPlanDistanceKmMonth} />\n                                            </span>\n                                        )}\n                                    </td>\n                                </tr>\n                            </tfoot>\n                        </table>\n                    </>}\n\n                    {!hideSummary && <>\n                        <h5 class='mt-4'><Text id='workout.calendar.summary'>Oppsummering</Text> - {MONTHS[month - 1]} {year}</h5>\n                        {dog && <div>{dog.name}</div>}\n\n                        <table class='table table-striped table-sm'>\n                            <tbody>\n                                <tr>\n                                    <td class='text-muted'><Text id='workout.calendar.totalWorkouts'>Antall økter</Text></td>\n                                    <td class='text-right'>{totalCountMonth}</td>\n                                </tr>\n                                <tr>\n                                    <td class='text-muted'><Text id='workout.calendar.distance'>Distanse</Text></td>\n                                    <td class='text-right'>\n                                        <Distance stores={this.props.stores} value={totalDistanceKmMonth} />\n                                    </td>\n                                </tr>\n                                <tr>\n                                    <td class='text-muted'><Text id='workout.calendar.ascend'>Høydemeter</Text></td>\n                                    <td class='text-right'>\n                                        <Elevation stores={this.props.stores} value={totalElevationMonth} />\n                                    </td>\n                                </tr>\n                                <tr>\n                                    <td class='text-muted'><Text id='workout.calendar.duration'>Varighet</Text></td>\n                                    <td class='text-right'>\n                                        {util.secToHms(totalDurationMonth)}\n                                    </td>\n                                </tr>\n                                <tr>\n                                    <td class='text-muted'><Text id='workout.calendar.avg-speed'>Gjennomsnittsfart</Text></td>\n                                    <td class='text-right'>\n                                        <Speed stores={this.props.stores} value={mu.avgArr(totalSpeedavgMonth)} />\n                                    </td>\n                                </tr>\n                            </tbody>\n                        </table>\n                    </>}\n                </div>\n            </>\n        );\n    }\n}\n\nexport default WorkoutCalendar;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer, withText } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(true);\nconst MARGIN_BOTTOM = mu.marginBottom();\nconst SUB_MENU_MARGIN_TOP = mu.subMenuMarginTop();\n\nimport Workout from '../../components/workout';\nimport WorkoutCalendar from '../../components/workout/calendar';\nimport Teams from '../../components/team/teams';\n\nconst DAYS = ['Søn', 'Man', 'Tir', 'Ons', 'Tor', 'Fre', 'Lør'];\nconst MONTHS = ['', 'Jan', 'Feb', 'Mar', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Des'];\n\nconst initialState = {\n\tisLoading: false,\n};\n\n@observer\nclass Workouts extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\tloadWorkouts = async () => {\n\t\tthis.setState({ isLoading: true });\n\t\tconst { workoutStore } = this.props.stores;\n\t\tconst { currentTeam } = workoutStore;\n\t\tawait workoutStore.load({ query: { team: currentTeam } });\n        await this.loadWorkoutSummary();\n\t\tthis.setState({ isLoading: false });\n\t}\n\n\tloadDogs = async () => {\n\t\tconst { dogStore } = this.props.stores;\n\t\tconst { currentTeam } = dogStore;\n\n\t\tawait dogStore.load({ query: { team: currentTeam }, addData: ['workoutSummary'] });\n\t}\n\n\tasync loadTracks() {\n\t\tconst { trackStore } = this.props.stores;\n\t\tawait trackStore.load();\n\t}\n\n\tasync loadWorkoutSummary(props = this.props) {\n\t\tconst { userStore, workoutStore } = this.props.stores;\n\t\tconst { currentTeam } = workoutStore;\n        const { month, year } = props;\n        await userStore.getWorkoutSummary({ team: currentTeam });\n        await userStore.getWorkoutSummaryDay({ month, year, team: currentTeam });\n    }\n\n    componentDidMount() {\n        this.loadWorkouts();\n\t\t// this.loadWorkouts();\n\t\t// this.loadDogs();\n\t\t// this.loadTracks();\n    }\n\n    componentWillReceiveProps(nextProps) {\n        // console.log('componentWillReceiveProps', nextProps);\n        if (nextProps.month !== this.props.month) {\n            this.loadWorkoutSummary(nextProps);\n        }\n    }\n\n\trender() {\n\t\tconst { isLoading } = this.state;\n\t\tconst { userStore, workoutStore, appState } = this.props.stores;\n\t\tconst { darkmode } = appState;\n\t\tconst { currentTeam } = workoutStore;\n\n\t\tconst { month, year = util.getYear() } = this.props;\n\t\tconst {\n            workoutsDay,\n\t\t} = userStore;\n\n\t\treturn (\n\t\t\t<div class='container-fluid' style={`margin-bottom: ${MARGIN_BOTTOM}; margin-top: ${MARGIN_TOP};`}>\n\t\t\t\t<div class='row fixed-top' style={`margin-top: ${SUB_MENU_MARGIN_TOP}; background-color: ${darkmode ? '#191d21' : '#f8f9fa'};`}>\n\t\t\t\t\t<div class='col text-center subtopmenu'>\n\t\t\t\t\t\t<a href='/workouts/' class='text-secondary stretched-link'><nobr><i class='fas fa-chart-line' /> <Text id='workout.index.dashboard'>Oversikt</Text></nobr></a>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col text-center subtopmenu'>\n\t\t\t\t\t\t<a href='/workouts/list' class='text-secondary stretched-link'><nobr><i class='fas fa-list' /> <Text id='workout.index.list'>Liste</Text></nobr></a>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col text-center subtopmenu'>\n\t\t\t\t\t\t<a href='/workouts/plan' class='text-secondary stretched-link'><nobr><i class='fas fa-calendar-alt' /> <Text id='workout.index.plan'>Plan</Text></nobr></a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class='row'>\n\t\t\t\t\t<div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 border-bottom'>\n\t\t\t\t\t\t<Teams stores={this.props.stores} callback={this.loadWorkouts} key={`teams-${currentTeam}`} />\n\t\t\t\t\t</div>\n\n                    {/* <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n\t\t\t\t\t\t<WorkoutGraph stores={this.props.stores} isLoading={isLoading} />\n\t\t\t\t\t</div> */}\n\t\t\t\t\t\n                    <WorkoutCalendar stores={this.props.stores} month={month} year={year} team={currentTeam} />\n\n\t\t\t\t\t<div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-4'>\n                        <h5>\n\t\t\t\t\t\t\t<Text id='workouts.month-workouts' fields={{ month: MONTHS[month], year }}>Treningsturene - {MONTHS[month]} {year}</Text>\n\t\t\t\t\t\t</h5>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-4'>\n\t\t\t\t\t\t{workoutsDay && workoutsDay.map(workout => (\n\t\t\t\t\t\t\t<Workout stores={this.props.stores} workout={workout} showDate={true} />\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Workouts;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { toJS } from 'mobx';\nimport { Text, Localizer, withText } from 'preact-i18n';\nimport Markdown from 'preact-markdown';\n\nimport Modal from '../modal';\nimport WorkoutComments from '../../components/workout/comments';\nimport WorkoutAddComment from '../../components/workout/commentAdd';\nimport ImageScroller from '../../components/imageScroller';\nimport DogScroller from '../../components/dog/scroller';\n\nimport Overlay from '../../components/overlay/';\nimport TeamsPublicDetail from '../../routes/teams/publicDetail';\nimport DogPublicDetail from '../../routes/dogs/publicDetail';\n\nimport LikesAndComments from '../../components/feedback/likesAndComments';\nimport Views from '../../components/feedback/views';\n\nimport Speed from '../../components/data/speed';\nimport Elevation from '../../components/data/elevation';\nimport Weight from '../../components/data/weight';\nimport Distance from '../../components/data/distance';\nimport Temperature from '../../components/data/temperature';\n\nimport mu from '../../lib/musher-util';\n\nconst MAX_LOADINDEX = mu.getMaxLoadIndex();\n\nfunction getWorkoutColor(workout) {\n\tswitch (workout.type) {\n\t\tcase 1:\n\t\t\treturn 'border-primary';\n\t\tcase 2:\n\t\t\treturn 'border-danger';\n\t\tcase 3:\n\t\t\treturn 'border-success';\n\t\tcase 4:\n\t\t\treturn 'border-info';\n\t\tdefault:\n\t\t\treturn 'border-warning';\n\t}\n}\n\nfunction getWorkoutIcon(workout) {\n\tswitch (workout.type) {\n\t\tcase 1:\n\t\t\treturn 'fas fa-running';\n\t\tcase 2:\n\t\t\treturn 'fas fa-flag-checkered';\n\t\tcase 3:\n\t\t\treturn 'fas fa-hiking';\n\t\tcase 4:\n\t\t\treturn 'fas fa-futbol';\n\t\tdefault:\n\t\t\treturn 'fas fa-hiking';\n\t}\n}\n\nfunction displayDistance(distanceKm) {\n\tif (distanceKm < 5) {\n\t\treturn util.format(distanceKm, 2);\n\t}\n\tif (distanceKm < 10) {\n\t\treturn util.format(distanceKm, 1);\n\t}\n\treturn util.format(distanceKm, 1);\n}\n\nconst initialState = {\n\tshowAddComment: false,\n    viewImageIdx: {},\n    likeWorkout: {},\n};\n\n@observer\nclass Workout extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n        this.updateTimer = {};\n\t\tthis.inputRef = {};\n    }\n\n    toggleDate = (e) => {\n        e.stopPropagation();\n        e.preventDefault();\n        const { showDate } = this.state;\n        this.setState({ showDate: !showDate });\n    }\n\n\n\tlikeWorkout = async () => {\n\t\tconst { workoutStore } = this.props.stores;\n        const { workout } = this.props;\n        const workoutId = workout.id;\n\n        const { likeWorkout } = this.state;\n        likeWorkout[workoutId] = true;\n        this.setState({ likeWorkout });\n        setTimeout(() => {\n            const { likeWorkout } = this.state;\n            delete likeWorkout[workoutId];\n            this.setState({ likeWorkout });\n        }, 1200);\n\n\t\tconst response = await workoutStore.likeWorkout({ id: workoutId });\n        if (response && response.status === 200) {\n\n\t\t}\n\t}\n\n\ttoggleAddComment = (e) => {\n\t\tconst workoutId = e.target.parentElement.dataset.id || e.target.dataset.id;\n\t\tconst { showAddComment } = this.state;\n\t\tthis.setState({\n\t\t\tshowAddComment: !showAddComment,\n\t\t}, () => {\n\t\t\tif (this.inputRef[workoutId]) {\n\t\t\t\tthis.inputRef[workoutId].focus();\n\t\t\t}\n\t\t});\n\t}\n\n    viewImage = (e) => {\n\t\tconst { id, idx } = e.target.closest('img').dataset;\n        const { viewImageIdx } = this.state;\n        viewImageIdx[id] = idx;\n        this.setState({ viewImageIdx });\n    }\n\n    shareLink = (e) => {\n        const { url, title, text } = e.target.closest('button').dataset;\n        const { appState } = this.props.stores;\n        appState.shareUrl({ url, title, text });\n    }\n\n        // Overlay functions\n    onTeamClick = (e, teamid) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.setState({\n            showTeam: teamid,\n        });\n        return false;\n    }\n\n    hideTeam = () => {\n        this.setState({\n            showTeam: null,\n        });\n    }\n\n    onUserClick = (e, userid) => {\n        e.preventDefault();\n        e.stopPropagation();\n        return false;\n    }\n\n    onDogClick = (e, dogid, dogs) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.setState({\n            showDog: dogid,\n            dogs,\n        });\n        return false;\n    }\n\n    hideDog = () => {\n        this.setState({\n            showDog: null,\n        });\n    }\n\n    render() {\n        const {\n            showDate,\n            showAddComment,\n            viewImageIdx = {},\n            likeWorkout,\n            dogs,\n            showTeam,\n            showDog,\n        } = this.state;\n        const {\n            workout,\n            showDate: forceShowDate,\n            wrapperClasses = 'col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3',\n            wrapperClassesRow = 'row',\n        } = this.props;\n\t\tconst { userStore, appState, workoutStore } = this.props.stores;\n        const { viewmode, hasShareApi } = appState;\n        const { user, dogs: allDogs } = userStore;\n        const { language = 'en' } = user;\n        const intensity = userStore.findIntensity({ code: workout.intensity, language }) || {};\n        // const teamName = userStore.findTeam(workout.team);\n        const team = userStore.findTeam(workout.team, true) || {};\n        const teamName = team.name;\n        // const teamNames = workout.teams ? workout.teams.map(e => userStore.findTeam(e)) : [];\n        const teamNames = [];\n        if (teamName) {\n            teamNames.push(teamName);\n        }\n        if (workout.teams) {\n            workout.teams.forEach((e) => {\n                if (userStore.findTeam(e)) {\n                    teamNames.push(userStore.findTeam(e));\n                }\n            });\n        }\n\n        const { likes = [], comments = [] } = workout;\n\t\tconst hasLikedWorkout = workout.likes && workout.likes.findIndex(e => e.user === user.id) > -1;\n        const { gpxInfo = {}, mushers = [] } = workout;\n\t\tconst { loadIndex = 0 } = gpxInfo;\n        const workoutEquipment = userStore.findEquipment({ equipment: workout.equipment, language });\n        const workoutEquipmentIcon = userStore.findEquipment({ equipment: workout.equipment, field: 'icon' });\n\n        const musherImages = [];\n        if (mushers.length > 1) {\n            mushers.slice(1, 10).map((musher) => {\n                const u = workoutStore.findPublicUser(musher) || {};\n                if (u.images && u.images[0]) {\n                    musherImages.push(u.images[0]);\n                }\n            });\n        }\n\n        const publicUser = workoutStore.findPublicUser(mushers[0]) || {};\n        let image;\n        if (publicUser && publicUser.images && publicUser.images[0]) {\n            image = publicUser.images[0];\n        } else if (team.image && team.image.s3SmallLink) {\n            image = team.image;\n        } else if (team.images && team.images[0] && team.images[0].s3SmallLink) {\n            image = team.images[0];\n        } else if (workout.image && workout.image.s3SmallLink) {\n            image = workout.image;\n        }\n\n        const images = [];\n        if (workout.mapImage) {\n            images.push({\n                ...workout.mapImage,\n                type: 'map',\n            });\n        }\n        if (workout.images) {\n            const imgs = toJS(workout.images);\n            images.push(...imgs);\n        }\n        const imageIdx = viewImageIdx[workout.id] ? viewImageIdx[workout.id] : 0;\n        const currentImage = images && images[imageIdx] ? images[imageIdx] : null;\n\n        let batteryUsage;\n        if (workout && workout.gpxInfo && workout.gpxInfo.battegryLevelStart) {\n            batteryUsage = (workout.gpxInfo.battegryLevelStart - workout.gpxInfo.battegryLevelEnd) * 100;\n        }\n\n        const views = mu.getViews(workout.statistics);\n\n        // let temperature;\n        // let windSpeed;\n        // if (util.checkNested(workout, 'temperature')) {\n        //     const yr = toJS(workout.yr[0].instant.details);\n        //     // displayValue = `Yr.no: 🌡️ ${yr.air_temperature}°C, 💨 ${yr.wind_speed}m/s 🧭 ${mu.windDirection(yr.wind_from_direction)}, ☁️ ${yr.cloud_area_fraction}%, ${yr.air_pressure_at_sea_level}mb, 💦 ${yr.relative_humidity}%`;\n        //     temperature = `${yr.air_temperature}°C`;\n        //     windSpeed = `${yr.wind_speed}m/s`;\n        // }\n\t\t// // const loadMultiplier = loadIndex / 100;\n\n        return (<>\n\n            {showTeam && <Overlay>\n                <TeamsPublicDetail stores={this.props.stores} teamid={showTeam} marginTop={'0px;'} marginBottom={'0px;'} back={this.hideTeam} hideTeam={this.hideTeam} />\n            </Overlay>}\n\n            {showDog && <Overlay>\n                <DogPublicDetail stores={this.props.stores} dogid={showDog} marginTop={'0px;'} marginBottom={'0px;'} back={this.hideDog} dogs={dogs} />\n            </Overlay>}\n\n            <div class='w-100 mb-2'>\n                <div class={wrapperClassesRow}>\n\n                    <div class={`${wrapperClasses} d-flex mb-0 position-relative`}>\n\n                        {/* {workout.gpxInfo && <svg viewBox='0 0 300 300' style='top: 80px; left: 10px; width: 90px; height: 90px;' class='position-absolute'>\n                            <path d={`${workout.gpxInfo.svgMap}`} style='fill: none; stroke: #0063FF; stroke-width: 5; opacity: 0.3;' />\n                        </svg>} */}\n\n                        {/* {JSON.stringify(workout, null, 4)} */}\n                        <div class='text-center'>\n                            <div\n                                class={`position-relative text-center border rounded-circle imageRounded ${getWorkoutColor(workout)}`}\n                                style={`${image ? `background-image: url(\"${image.s3SmallLink}\"); background-size: cover;` : ''} border-width: 3px !important;`}\n                            >\n                                {!image && <i class={`${getWorkoutIcon(workout)} text-${intensity.class ? intensity.class : 'muted'} mt-3`} style='font-size: 40px;' />}\n\n                                {musherImages && musherImages.map((img, idx) => <>\n                                    <div\n                                        class='position-absolute rounded-circle imageRounded border imageRoundedThumb border-white'\n                                        style={`\n                                            background-image: url(\"${img.s3SmallLink}\");\n                                            background-size: cover;\n                                            bottom: -3px;\n                                            left: ${-5 + (idx * 10)}px;\n                                        `}\n                                    />\n                                </>)}\n                            </div>\n                            {workout.temperature !== 0 && <>\n                                <span class='text-muted font-weight-light'>\n                                    <Temperature stores={this.props.stores} value={workout.temperature} />\n                                </span>\n                            </>}\n                        </div>\n                        <div class='flex-grow-1 pl-3' style='line-height: 1.2em;'>\n                            <span class='float-right'>\n                                {workout.isLocked === 1 && <i class='fas fa-lock text-danger ml-3' />}\n                                {workout.isInProgress === 1 && <div class='spinner-grow text-success ml-3' role='status' />}\n                                {workout.isInProgress === 2 && <i class='fas fa-pause-circle text-warning ml-3' />}\n                            </span>\n                            <a class='stretched-link' href={`/workouts/${workout.id}`}>\n                                <h5 class='my-0 mb-1' style='line-height: 1.0em;'>\n                                    {workout.name}\n                                </h5>\n                            </a>\n                            {teamNames && teamNames.length > 0 && <small class='font-weight-lighter'>\n                                {teamNames.map((name, idx) => <>{idx > 0 ? ', ' : ''}{name}</>)}\n                            </small>}\n                            <br />\n                            <small class='text-muted'>\n                                {workout.date && <small onClick={this.toggleDate}>\n                                    {forceShowDate || showDate ? util.formatDate(workout.date, { locale: 'no-NB', hour12: false, hour: '2-digit', minute: '2-digit' }) : util.formatDistance(workout.date, new Date(), { locale: 'no-NB' })}\n                                </small>}\n                                <span class={`badge badge-${intensity.class} ml-2`}>{intensity.name}</span>\n                                {loadIndex > 0 && <span class={`ml-2 text-${mu.getLoadIndexColor(util.normalizeBetween(loadIndex, 0, MAX_LOADINDEX, 0, 100))}`}>\n                                    <i class='fas fa-hand-rock mr-1' />\n                                    {Math.floor(util.normalizeBetween(loadIndex, 0, MAX_LOADINDEX, 0, 100))} -&nbsp;\n                                    {mu.getLoadIndexText(util.normalizeBetween(loadIndex, 0, MAX_LOADINDEX, 0, 100))}\n                                </span>}\n                                <br />\n                            </small>\n                            <small>\n                                <div class='text-muted'>\n                                    {workout.garminId > 0 && <div class={`float-left mr-2 text-center border rounded-circle imageRounded imageRoundedIcon`} style={`background-image: url(\"./assets/garmin-connect.png\");`} />}\n                                    {workout.stravaId > 0&& <div class={`float-left mr-2 text-center border rounded-circle imageRounded imageRoundedIcon`} style={`background-image: url(\"./assets/strava-icon.png\");`} />}\n\n                                    {workout.equipment > 0 && <><i class={`${workoutEquipmentIcon} ml-2`} /> {workoutEquipment}</>}\n                                    {/* {workout.distanceKm > 0 && <><i class='fas fa-road ml-2' /> {displayDistance(workout.distanceKm)}km</>}\n                                    {workout.elevation > 0 && <><i class='fas fa-mountain ml-2' /> {util.format(workout.elevation, 0)}m</>} */}\n                                    {/* {workout.speedAvg > 0 && <><i class='fas fa-tachometer-alt ml-2' /> {util.format(workout.speedAvg, 1)}km/t</>} */}\n                                    {workout.dogs > 0 && <><i class='fas fa-dog ml-2' /> {workout.dogs.length}</>}\n                                    {workout.track > 0 && <><i class={`fas fa-map-marked text-${workout.track > 0 ? 'success' : 'danger'} ml-2`} /></>}\n                                    {workout.dogsLeft > 0 && <><i class={`fas fa-crosshairs text-${workout.dogsLeft && workout.dogsRight ? 'success' : 'danger'} ml-2`} /></>}\n                                    {workout.sledWeight > 0 && <>\n                                        <i class='fas fa-sleigh ml-2' /> <Weight stores={this.props.stores} value={workout.sledWeight} />\n                                    </>}\n                                    {batteryUsage > 0 && <span class='text-muted ml-2'><i class='fas fa-battery-three-quarters' /> {util.format(batteryUsage, 1)}% <Text id='workout.battery-used'>used</Text></span>}\n                                </div>\n                                {['beta', 'advanced'].indexOf(viewmode) > -1 && (\n                                    <span class='text-muted'>\n                                        <i class='fas fa-balance-scale' /> {util.format(workout.kcalBurnedTotal)} <Text id='workout.kcal'>kcal</Text>\n                                        <i class='fas fa-drumstick-bite ml-2' /> <Weight stores={this.props.stores} value={workout.kcalMeatGramsTotal / 1000} />\n                                        <i class='fas fa-fish ml-2' /> <Weight stores={this.props.stores} value={workout.kcalSalmonGramsTotal / 1000} />\n                                        <i class='fas fa-piggy-bank ml-2' /> <Weight stores={this.props.stores} value={workout.kcalFatGramsTotal / 1000} />\n                                    </span>\n                                )}\n                            </small>\n                        </div>\n                    </div>\n                    <div class={`${wrapperClasses} position-relative mt-2`}>\n                        <strong>\n                            {workout.description}\n                        </strong>\n                    </div>\n                    <div class={`${wrapperClasses} position-relative`}>\n                        <Markdown markdown={mu.replaceImages(workout.comment, workout.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                    </div>\n                    <div class={`${wrapperClasses} d-flex mb-0 position-relative`}>\n                        <div class='container-fluid px-0'>\n                            <div class='row mt-1'>\n                                {workout.distanceKm > 0 && <div class='col-3'>\n                                    <div class='text-overflow'>\n                                        <small><i class='fas fa-road' /> <Text id='workout.calendar.distance'>Distanse</Text></small>\n                                    </div>\n                                    <div class='text-overflow font-weight-light' style='font-size: 1.2em;'>\n                                        <Distance stores={this.props.stores} value={workout.distanceKm} />\n                                    </div>\n                                </div>}\n                                {workout.elevation > 0 && <div class='col-3'>\n                                    <div class='text-overflow'>\n                                        <small><i class='fas fa-mountain' /> <Text id='workout.calendar.ascend'>Høydemeter</Text></small>\n                                    </div>\n                                    <div class='text-overflow font-weight-light' style='font-size: 1.2em;'>\n                                        <Elevation stores={this.props.stores} value={workout.elevation} />\n                                    </div>\n                                </div>}\n                                {workout.duration > 0 && <div class='col-3'>\n                                    <div class='text-overflow'>\n                                        <small><i class='fas fa-clock' /> <Text id='workout.calendar.duration'>Varighet</Text></small>\n                                    </div>\n                                    <div class='text-overflow font-weight-light' style='font-size: 1.2em;'>\n                                        {util.secToHms(workout.duration, true)}\n                                    </div>\n                                </div>}\n                                {workout.speedAvg > 0 && <div class='col-3'>\n                                    <div class='text-overflow'>\n                                        <small><i class='fas fa-tachometer-alt' /> <Text id='workout.calendar.avg-speed'>Snittfart</Text></small>\n                                    </div>\n                                    <div class='text-overflow font-weight-light' style='font-size: 1.2em;'>\n\t\t\t\t                        {workout.gpxInfo && workout.gpxInfo.avgGpsMovingSpeed > 0 ? <>\n                                            <Speed stores={this.props.stores} value={workout.gpxInfo.avgGpsMovingSpeed * 3.6} />\n                                        </> : <>\n                                            <Speed stores={this.props.stores} value={workout.speedAvg} />\n                                        </>}\n                                    </div>\n                                </div>}\n                            </div>\n                        </div>\n                    </div>\n\n                    {['beta', 'advanced', 'normal'].indexOf(viewmode) > -1 && (\n                        <div class={`${wrapperClasses}`}>\n                            <div class='container-fluid px-0 mt-1'>\n                                <div class='row'>\n                                    <ImageScroller stores={this.props.stores} images={images} id={workout.id} dblClick={this.likeWorkout} likeRef={likeWorkout} />\n                                </div>\n                            </div>\n                        </div>\n                    )}\n\n                    {['beta', 'advanced', 'normal'].indexOf(viewmode) > -1 && <>\n                        {workout.dogs && workout.dogs.length > 0 && <div class='container-fluid px-0 mt-1'>\n                            <div class='row pt-2'>\n                                <DogScroller stores={this.props.stores} dogs={workout.dogs} allDogs={allDogs} onDogClick={this.onDogClick} />\n                            </div>\n                        </div>}\n\n                        <div class='mt-2'>\n                            <LikesAndComments\n                                stores={this.props.stores}\n                                likes={likes}\n                                comments={comments}\n                                type='workout'\n                                onTeamClick={this.onTeamClick}\n                                onUserClick={this.onUserClick}\n                            />\n                        </div>\n\n                    </>}\n\n                    {['beta', 'advanced', 'normal'].indexOf(viewmode) > -1 && <>\n                        <div class={`${wrapperClasses} mb-0 position-relative mt-2`}>\n                            <div class='row'>\n                                <div class='col text-center'>\n                                    <button type='button' class={`btn btn-sm btn-outline-${hasLikedWorkout ? 'primary' : 'secondary'} btn-lg btn-block ${hasLikedWorkout ? 'text-primary' : ''}`}\n                                        onClick={this.likeWorkout}\n                                        // disabled={hasLikedWorkout}\n                                    >\n                                        <i class={`${hasLikedWorkout ? 'text-primary fas' : 'far'} fa-thumbs-up`} /> <Text id='comments.like'>Lik</Text>\n                                    </button>\n                                </div>\n                                <div class='col text-center'>\n                                    <button type='button' class='btn btn-sm btn-outline-secondary btn-lg btn-block'\n                                        data-id={workout.id}\n                                        onClick={this.toggleAddComment}\n                                    >\n                                        <i class='fas fa-comment' /> <Text id='comments.comment-add'>Kommentar</Text>\n                                    </button>\n                                </div>\n                                {hasShareApi ? <>\n                                    <div class='col text-center'>\n                                        <button class='btn btn-sm btn-outline-secondary btn-lg btn-block text-overflow'\n                                            onClick={this.shareLink}\n                                            data-url={`https://themusher.app/share/workout/${workout.uuidv4}`}\n                                            data-title={`title: ${workout.name}`}\n                                        >\n                                            <i class='fas fa-share' /> <Text id='workout.share'>Del</Text>\n                                        </button>\n                                    </div>\n                                </> : <>\n                                    <div class='col text-center'>\n                                        <a class='btn btn-sm btn-outline-secondary btn-lg btn-block text-overflow'\n                                            href={`https://themusher.app/share/workout/${workout.uuidv4}`}\n                                            target='_blank'\n                                            rel='noreferrer'\n                                            data-native\n                                        >\n                                            <i class='fas fa-share' /> <Text id='workout.share'>Del</Text>\n                                        </a>\n                                    </div>\n                                </>}\n                            </div>\n                        </div>\n\n                        <div class={`${wrapperClasses} mt-2 mb-3`}>\n                            {showAddComment && <WorkoutAddComment\n                                stores={this.props.stores}\n                                workout={workout}\n                                inputRef={c => this.inputRef[workout.id] = c}\n                                inputRefObject={this.inputRef}\n                                col='12'\n                                offset='0'\n                            />}\n                            <WorkoutComments stores={this.props.stores} workout={workout} col='10' offset='2' compact={true} />\n                        </div>\n\n                        {views > 0 && <>\n                            <div class='mt-2'>\n                                <Views\n                                    stores={this.props.stores}\n                                    views={views}\n                                    object={workout}\n                                    type='workout'\n                                    isTeamAdmin={true}\n                                    isAdmin={false}\n                                    onTeamClick={this.onTeamClick}\n                                    onUserClick={this.onUserClick}\n                                />\n                            </div>\n                        </>}\n\n                    </>}\n\n                </div>\n            </div>\n        </>);\n    }\n}\n\nexport default Workout;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer, withText } from 'preact-i18n';\n\n@observer\nclass Modal extends Component {\n    toggleDate = () => {\n        const { showDate } = this.state;\n        this.setState({ showDate: !showDate });\n    }\n\n    touchStart = (e) => {\n        e.stopPropagation();\n        this.setState({\n            startY: e.touches[0].pageY,\n        })\n    }\n\n    touchEnd = (e) => {\n        e.stopPropagation();\n        this.setState({\n            startY: undefined,\n            readyToRefresh: false,\n        })\n    }\n\n    touchMove = (e) => {\n        e.stopPropagation();\n        const { close } = this.props;\n        const { startY, refreshing } = this.state;\n        const scrollDistance = 30;\n        const y = e.touches[0].pageY;\n        if (this.appContainer) {\n            const { scrollTop } = this.appContainer;\n            if (scrollTop === 0 && y > startY + scrollDistance && !refreshing) {\n                close();\n            }\n        }\n    }\n\n    render() {\n        const { showDate } = this.state;\n        const { image, imagexxl, close, thumb, name, title, date } = this.props;\n        return (\n            <div class='fixed-top bg-dark text-center pt-2' style='width: 100vw; height: 100vh;'>\n                <button class='btn btn-secondary float-right mr-2' onClick={close}>X</button>\n\n                    <div class='d-flex mb-2 px-2'>\n                        {/* {JSON.stringify(dog, null, 4)} */}\n                        {thumb && <div class={`text-center border rounded-circle imageRounded imageRoundedSmall`} style={thumb ? `background-image: url(\"${thumb}\");` : ''}>\n                            &nbsp;\n                        </div>}\n                        <div class='flex-grow-1 pl-3 pr-2 text-left' style='line-height: 1.3em;'>\n                            {name && <strong class='mr-2'>{name}:</strong>}\n                            {title}<br />\n                            <small class='text-muted'>\n                                {date && <small onClick={this.toggleDate}>\n                                    {showDate ? util.formatDate(date, { locale: 'no-NB' }) : util.formatDistance(date, new Date(), { locale: 'no-NB' })}\n                                </small>}\n                            </small>\n                        </div>\n                    </div>\n\n\n                <img src={image}\n                    class='img-fluid align-middle mt-2 mb-2'\n                    onClick={close}\n                    onTouchstart={this.touchStart}\n                    onTouchend={this.touchEnd}\n                    onTouchmove={this.touchMove}\n                    ref={c => this.appContainer = c}\n                />\n\n                <a target='_blank' rel='noopener noreferrer' href={imagexxl || image} download={imagexxl || image}>\n                    <i class='fas fa-download' /> <Text id='modal.download'>Last ned bildet</Text>\n                </a>\n            </div>\n        );\n    }\n}\n\nexport default Modal;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport DogSimplePublic from './simplePublic';\n\n@observer\nclass DogScroller extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            imageIdx: 0,\n        };\n    }\n\n    scrollImages = (e) => {\n        const { dogs } = this.props;\n\n        const { scrollLeft, scrollWidth, clientWidth } = e.target;\n        const imageStep = clientWidth;\n        const imageIdx = scrollLeft / imageStep;\n        // console.log({ e, imageStep, imageIdx, scrollLeft, scrollWidth, clientWidth });\n\n        const nearestInt = Math.round(imageIdx);\n        const diff = Math.abs(nearestInt - imageIdx);\n        // console.log({ nearestInt, diff });\n        if (Number.isInteger(imageIdx) || diff < 0.1) {\n            this.setState({\n                imageIdx: nearestInt,\n            });\n        }\n    }\n\n    sortByName = (a, b) => {\n        const { allDogs = [] } = this.props;\n        const dogA = allDogs.find(e => e.id === a);\n        const dogB = allDogs.find(e => e.id === b);\n        if (dogA && dogB) {\n            if (dogA.name > dogB.name) {\n                return 1;\n            }\n        }\n        return -1;\n    }\n\n    render() {\n        const { imageIdx } = this.state;\n        const { dogs, allDogs = [], size = 'medium', onDogClick = () => {} } = this.props;\n\n        return (\n            <div class='w-100'>\n                <div\n                    class='d-flex flex-row flex-nowrap'\n                    style='overflow: auto; scroll-snap-type: x mandatory;'\n                    onScroll={this.scrollImages}\n                >\n                    {dogs && dogs.sort(this.sortByName).map((dogId, idx) => {\n                        const dog = allDogs.find(e => e.id === dogId);\n                        if (!dog) {\n                            return '';\n                        }\n                        return (\n                            <div class='col clearfix position-relative p-0 mx-2'>\n                                <div\n                                    class={`w-100 h-100 text-center rounded-lg imageContainer d-flex justify-content-center align-items-center`}\n                                    style={`\n                                        flex-wrap: wrap;\n                                        overflow-y: hidden;\n                                    `}\n                                    onTouchstart={(e) => { e.stopPropagation(); }}\n                                    onTouchend={(e) => { e.stopPropagation(); }}\n                                    onTouchmove={(e) => { e.stopPropagation(); }}\n                                >\n                                    <DogSimplePublic\n                                        stores={this.props.stores}\n                                        dog={dog}\n                                        dogs={allDogs.filter(d => dogs.indexOf(d.id) > -1).sort((a, b) => a.name > b.name ? 1 : -1)}\n                                        className='mx-auto'\n                                        showName={true}\n                                        showPosition={false}\n                                        size={size}\n                                        onDogClick={onDogClick} \n                                    />\n                                    {/* <xmp>{JSON.stringify(img, null, 4)}</xmp> */}\n                                </div>\n                            </div>\n                        );\n                    })}\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default DogScroller;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport ScrollIntoView from '../../components/util/scrollIntoView';\n\n@observer\nclass Teams extends Component {\n    toggleTeam = (team) => {\n\t\tconst { callback, unsetTeamIfSelected = true } = this.props;\n        const { dogStore, workoutStore } = this.props.stores;\n\t\tconst { currentTeam } = dogStore;\n\t\tif (unsetTeamIfSelected && team === currentTeam) {\n\t\t\tdogStore.setCurrentTeam(undefined);\n\t\t\tworkoutStore.setCurrentTeam(undefined);\n\t\t} else {\n\t\t\tdogStore.setCurrentTeam(team);\n\t\t\tworkoutStore.setCurrentTeam(team);\n\t\t}\n\t\tif (util.isDefined(callback)) {\n\t\t\tcallback();\n\t\t}\n\t}\n\n    showAllTeams = () => {\n\t\tconst { callback } = this.props;\n        const { dogStore, workoutStore } = this.props.stores;\n\t\tdogStore.setCurrentTeam(undefined);\n\t\tworkoutStore.setCurrentTeam(undefined);\n\t\tif (util.isDefined(callback)) {\n\t\t\tcallback();\n\t\t}\n\t}\n\n\t// componentDidMount() {\n\t// \tif (this.container) {\n\t// \t\tthis.container.scrollIntoView({ behavior: 'smooth', block: 'end', inline: 'center' });\n\t// \t}\n\t// }\n\n    render() {\n        const { userStore, dogStore } = this.props.stores;\n        const { teams } = userStore;\n\t\tconst { currentTeam } = dogStore;\n\t\tconst { highlight, showAll = true } = this.props;\n        return (\n\t\t\t<div class='row mt-2'>\n\t\t\t\t<div class='w-100 overflow-hidden'>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass='d-flex flex-row flex-nowrap pb-2 px-1'\n\t\t\t\t\t\tstyle='overflow: auto; scroll-snap-type: x mandatory;'\n\t\t\t\t\t>\n\t\t\t\t\t\t{/* <xmp><br /><br /><br /><br />{JSON.stringify(teams, null, 4)}</xmp> */}\n\t\t\t\t\t\t{teams && teams.map((team, idx) => (\n\t\t\t\t\t\t\t<div class='col mb-0 px-0 clearfix' key={team.id}>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass={`btn btn-sm btn-block \n\t\t\t\t\t\t\t\t\t\trounded-none ${idx === 0 ? 'rounded-pill-left' : (idx + 1 === teams.length ? 'rounded-pill-right': '')}\n\t\t\t\t\t\t\t\t\t\t${currentTeam === team.id ? 'btn-success' : 'btn-outline-success'}\n\t\t\t\t\t\t\t\t\t\ttext-nowrap clearfix`}\n\t\t\t\t\t\t\t\t\tstyle='text-overflow: ellipsis; overflow: hidden;'\n\t\t\t\t\t\t\t\t\tonClick={() => this.toggleTeam(team.id)}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<i class='fas fa-users' /> {team.name}\n\n\t\t\t\t\t\t\t\t\t{highlight && highlight.indexOf(team.id) > -1 && <>\n\t\t\t\t\t\t\t\t\t\t{currentTeam === team.id ? <>\n\t\t\t\t\t\t\t\t\t\t\t<i class='fas fa-check float-right' />\n\t\t\t\t\t\t\t\t\t\t</> : <>\n\t\t\t\t\t\t\t\t\t\t\t<div class='spinner-grow text-warning float-right' role='status'>\n\t\t\t\t\t\t\t\t\t\t\t\t<span class='sr-only'>Loading...</span>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<i class='far fa-hand-point-left float-right' style='font-size: 2.0em;' />   \n\t\t\t\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t{/* {currentTeam === team.id && <ScrollIntoView horizontal={'center'} vertical={'end'} />} */}\n\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t\t{showAll && <div class='row'>\n\t\t\t\t\t\t<div class='col-12 mb-1 px-1 d-flex justify-content-center'>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass={`btn btn-sm rounded-lg btn-link text-nowrap clearfix`}\n\t\t\t\t\t\t\t\tstyle='text-overflow: ellipsis; overflow: hidden;'\n\t\t\t\t\t\t\t\tonClick={this.showAllTeams}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<i class='fas fa-users' /> <Text id='teams.show-all'>Show all</Text>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>}\n\t\t\t\t</div>\n\t\t\t</div>\n        );\n    }\n}\n\nexport default Teams;\n"],"sourceRoot":""}