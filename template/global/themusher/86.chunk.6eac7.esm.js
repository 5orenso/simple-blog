(window.webpackJsonp=window.webpackJsonp||[]).push([[86],{"5OWT":function(e){e.exports={hoverelementonly:"hoverelementonly__4nHll",hoverElement:"hoverElement__rkj2s",hoverelementhide:"hoverelementhide__10QkM"}},Eo9z:function(e,t,s){"use strict";s.r(t),function(e){function a(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function o(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?a(Object(s),!0).forEach((function(t){l(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function l(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function n(e,t){const s=void 0!==e.musher;return(void 0!==t.musher)-s||!0===s&&e.musher.bib-t.musher.bib||0}var c,i,r,d=s("hosL"),h=s("Utv1"),b=s("/eY4"),u=s("OhSV"),m=s("fh8t"),p=s.n(m),O=s("ZOvn"),g=s("ZQlJ");s("q/oJ"),s("gWxU"),s("Nanz"),s("5OWT");const f=O.a.marginTop(!0),j=O.a.marginBottom(),y={isLoading:!1,contentIsNotLoaded:!0,reloadInSec:null,reloadLastEpoch:null,reloadIsActive:!1};Object(b.a)(c=class extends d.Component{constructor(e){super(e),this.initComponent=()=>{const e=Math.floor((new Date).getTime()/1e3);this.setState({reloadIsActive:!0,reloadLastEpoch:e},()=>this.tickReloadTimeer())},this.state=o({},y),this.updateTimer={}}tickReloadTimeer(){const{reloadIsActive:e,reloadLastEpoch:t}=this.state;if(e){const e=Math.floor((new Date).getTime()/1e3);this.setState({reloadInSec:60-(e-t)}),clearTimeout(this.updateTimer.tick),this.updateTimer.tick=setTimeout(()=>this.tickReloadTimeer(),1e3)}return!1}componentDidMount(){this.initComponent()}componentWillUnmount(){clearTimeout(this.updateTimer.tick)}render(){const{reloadInSec:t}=this.state,s=Math.floor(h.a.normalizeBetween(t,0,60,0,100));return Object(d.h)(e,null,Object(d.h)("div",{class:"progress fixed-top",style:"height: 2px; z-index: 999999;"},Object(d.h)("div",{class:"progress-bar",role:"progressbar",style:`width: ${s}%;`,"aria-valuenow":s,"aria-valuemin":"0","aria-valuemax":"100"})))}}),Object(b.a)(i=class extends d.Component{constructor(e){super(e),this.toggleAdminInfo=e=>{e.stopPropagation();const{showAdminInfo:t}=this.state;this.setState({showAdminInfo:!t})},this.toggleInfo=e=>{e.stopPropagation();const{showInfo:t}=this.state;this.setState({showInfo:!t})},this.state={}}render(){const{showAdminInfo:t,showInfo:s}=this.state,{classid:a,bib:o,email:l,onTeamClick:n,onDogClick:c}=this.props,{raceStore:i,userStore:r}=this.props.stores,{isAdmin:b}=r,m=o?i.getMusherByBibId(o):i.getMusherByBibEmail(l),f=i.getTeamById(m.team),j=f.members?f.members.find(e=>e.email===m.email):{},y=i.getClassById(a),w=i.getTotalsByTeamId(m.team),v=O.a.getImage({user:j,team:f,priority:"user"}),x=O.a.displayNameShort(j)||O.a.displayNameShort(m),k=O.a.getRankingColor(m.bib);return Object(d.h)(e,null,Object(d.h)("div",{class:"d-flex position-relative"},Object(d.h)("div",{class:"position-relative text-center border rounded-circle imageRounded imageRoundedMedium",style:v?`background-image: url("${v}"); background-size: cover;`:""},!v&&Object(d.h)("div",{class:"text-muted",style:"font-size: 25px; padding-top: 5px;"},x),Object(d.h)("div",{class:`rounded-pill-both px-2 text-center position-absolute ${k?"":"bg-secondary"} font-weight-bold`,style:"bottom: -20px; right: 0; "+(k?`background-color: ${k};`:"")},m.bib&&"n/a"!==m.bib&&Object(d.h)(e,null,m.bib))),Object(d.h)("div",{class:"flex-grow-1 pl-3 text-overflow mb-3",style:"line-height: 1.2em;"},Object(d.h)("h6",{class:"font-weight-light mb-0"},y.title),Object(d.h)("h3",{class:"mb-0"},m.flag," ",m.firstname," ",m.lastname),Object(d.h)("h6",{class:"mb-0"},m.sportsClub))),f.public>0&&Object(d.h)(e,null,s?Object(d.h)(e,null,Object(d.h)("button",{class:"btn btn-link float-right",onClick:this.toggleInfo},Object(d.h)("i",{class:"fas fa-angle-up"})," ",Object(d.h)(u.c,{id:"races.hide-info"},"Hide info"))):Object(d.h)(e,null,Object(d.h)("button",{class:"btn btn-link float-right",onClick:this.toggleInfo},Object(d.h)("i",{class:"fas fa-angle-down"})," ",Object(d.h)(u.c,{id:"races.show-info"},"Show info"))),Object(d.h)("h3",null,f.public?Object(d.h)(e,null,Object(d.h)("a",{href:"/teams/public/"+f.uuidv4,onClick:e=>n(e,f.uuidv4)},f.name)):Object(d.h)(e,null,f.name)),s&&Object(d.h)(e,null,Object(d.h)(p.a,{markdown:O.a.replaceImages(f.description,f.images),markdownOpts:O.a.getMarkdownOptions()})),f.dogs&&Object(d.h)("div",{class:"w-100 container-fluid"},Object(d.h)("div",{class:"row pt-2"},Object(d.h)(g.a,{stores:this.props.stores,dogs:f.dogs.map(e=>e.id),allDogs:f.dogs,onDogClick:c})))),w&&w.distanceKm&&Object(d.h)(e,null,Object(d.h)("div",{class:"table-responsive-lg"},Object(d.h)("table",{class:"table table-borderless"},Object(d.h)("tbody",null,Object(d.h)("tr",null,Object(d.h)("td",{style:"width: 5%;"},Object(d.h)("i",{class:"fas fa-dog"})),Object(d.h)("td",{style:"width: 60%"},Object(d.h)(u.c,{id:"races.dogs"},"Dogs")),Object(d.h)("td",{style:"width: 5%;"}," "),Object(d.h)("td",{class:"text-right",style:"width: 30%;"},f.dogs.length)),Object(d.h)("tr",null,Object(d.h)("td",null,Object(d.h)("i",{class:"fas fa-road"})),Object(d.h)("td",null,Object(d.h)(u.c,{id:"races.distance"},"Distance")),Object(d.h)("td",null," "),Object(d.h)("td",{class:"text-right"},Object(d.h)("nobr",null,w.distanceKm?h.a.format(w.distanceKm,1)+" km":"n/a"))),Object(d.h)("tr",null,Object(d.h)("td",null,Object(d.h)("i",{class:"fas fa-mountain"})),Object(d.h)("td",null,Object(d.h)(u.c,{id:"races.ascend"},"Ascending")),Object(d.h)("td",null," "),Object(d.h)("td",{class:"text-right"},Object(d.h)("nobr",null,w.elevation?h.a.format(w.elevation,0)+" m":"n/a"))),Object(d.h)("tr",null,Object(d.h)("td",null,Object(d.h)("i",{class:"fas fa-stopwatch"})),Object(d.h)("td",null,Object(d.h)(u.c,{id:"races.race-time"},"Racetime")),Object(d.h)("td",null,Object(d.h)("i",{class:"fas fa-clock"})),Object(d.h)("td",{class:"text-right"},Object(d.h)("nobr",null,h.a.secToHms(w.duration)||"n/a"))),Object(d.h)("tr",null,Object(d.h)("td",null,Object(d.h)("i",{class:"fas fa-bed"})),Object(d.h)("td",null,Object(d.h)(u.c,{id:"races.rest-time"},"Rest")),Object(d.h)("td",null,Object(d.h)("i",{class:"fas fa-clock"})),Object(d.h)("td",{class:"text-right"},Object(d.h)("nobr",null,h.a.secToHms(w.rest)||"n/a"))))))),b&&Object(d.h)("div",{style:"max-height: 200px; max-width: 70vw; overflow: auto;"},Object(d.h)("button",{class:"btn btn-link btn-block",onClick:this.toggleAdminInfo},"Toggle admin info"),t&&Object(d.h)(e,null,Object(d.h)("small",null,Object(d.h)("xmp",null,JSON.stringify(m,null,4),JSON.stringify(j,null,4),JSON.stringify(f,null,4),JSON.stringify(w,null,4))))))}});let w=Object(b.a)(r=class extends d.Component{constructor(e){var t;super(e),t=this,this.loadLiveRaceResults=async function(e=t.props,s,a){const{raceStore:o}=e.stores,{race:l}=o;await o.getRaceTrackerData(l.raceTrackerRace),o.getRaceTrackerActiveTeams(s,a)},this.loadRaceResults=async function(e=t.props,s,a){const{raceStore:o}=e.stores,{raceid:l}=e;await o.loadWorkoutSummary(s,l),o.getWorkoutSummaryActiveTeams(s,a)},this.loadRace=async function(e=t.props){t.setState({isLoading:!0});const{raceStore:s,appState:a}=e.stores,{raceid:o,classid:l}=e;await s.load(o);const{race:n}=s,{focusOnMushers:c}=a,{selectedClassIds:i=[]}=a,r=l||i[0];l&&a.toggleSelectedClassId(l,!0);const d=n.classes.filter(e=>e.id===r).filter(e=>e.contestants&&e.contestants.length>0).map(e=>e.contestants.filter(e=>e.team>0).map(e=>e.team)).flat();d.length>0&&await s.loadTeams(d.join(",")),n.liveRace>0?await t.loadLiveRaceResults(t.props,d,c):await t.loadRaceResults(t.props,d,c),s.getAllClassesSortedBy();const h=s.getClassById(r);h&&h.raceTrackerResults&&s.getRacetrackerResults(h.raceTrackerResults),clearTimeout(t.updateTimer.reload),t.updateTimer.reload=setTimeout((async function(){const s=Math.floor((new Date).getTime()/1e3);t.setState({reloadLastEpoch:s}),t.loadRace(e)}),6e4),t.setState({isLoading:!1})},this.toggleFocusOnMusher=e=>{const t=e.target.parentElement.dataset.musherid||e.target.dataset.musherid,{appState:s,raceStore:a}=this.props.stores;s.toggleFocusOnMusher(t);const{focusOnMushers:o}=s,{race:l}=a;l.liveRace>0?a.getRaceTrackerActiveTeams(null,o):a.getWorkoutSummaryActiveTeams(null,o)},this.handleMusherClick=e=>{const{bib:t}=e.target.closest("tr").dataset,{showModal:s}=this.state;this.setState({showModal:!s,modalBib:t})},this.toggleModal=()=>{const{showModal:e}=this.state;this.setState({showModal:!e})},this.state=o({},y),this.inputRef={},this.updateTimer={}}componentWillUnmount(){clearTimeout(this.updateTimer.reload),clearTimeout(this.updateTimer.tick)}componentDidMount(){this.loadRace()}componentWillReceiveProps(e){this.props.classid!==e.classid&&this.loadRace(e)}render(){const{modalBib:t,modalEmail:s}=this.state,{userStore:a,raceStore:o,appState:l}=this.props.stores,{classid:c,position:i="right",limit:r=100}=this.props,{user:b={},teams:u=[]}=a,{language:m="en"}=b,{selectedClassIds:p=[],focusOnMushers:g=[]}=l,{race:y={},classes:w=[]}=o,{raceTrackerResults:v}=o,x=new Date(y.endDate);x.setHours(x.getHours()+2);const k=y.classes&&y.classes.find(e=>e.id===c)||{},T=t?o.getMusherByBibId(t):o.getMusherByBibEmail(s);o.getTeamById(T.team);let S=[];return v&&v.data?S=v.data.map(e=>{const t=o.raceTrackerMapLine(e),s=parseInt(t.Bib,10);let a={};return w&&w[k.id].contestants&&(a=w[k.id].contestants.find(e=>e.musher.bib===s)||{}),a}):w[k.id]&&w[k.id].contestants&&(S=w[k.id].contestants.sort(n).slice(0,r).map(e=>e)),Object(d.h)(e,null,Object(d.h)("div",{class:"container-fluid",style:`margin-bottom: ${j}; height: calc(100% - ${j} - ${f});`},Object(d.h)("div",{class:"row"},Object(d.h)("div",{class:"col-12 px-0 position-relative",style:"font-size: 1.5em; line-height: 1.0em;"},Object(d.h)("div",{class:"w-100 overflow-hidden"},Object(d.h)("div",{class:"d-flex flex-row flex-nowrap pb-2 px-1",style:"overflow: auto; scroll-snap-type: x mandatory;"},y.classes&&y.classes.sort((e,t)=>e.distance-t.distance).map((t,s)=>Object(d.h)(e,null,Object(d.h)("div",{class:"col px-0 pt-2"},Object(d.h)("a",{type:"button",class:`btn btn-block ${0===s&&"rounded-pill-left"} ${s===y.classes.length-1&&"rounded-pill-right"} rounded-none ${t.id===c?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-id":t.id,href:`/embed/agreement/${y.id}/${t.id}`},t.title)))))),Object(d.h)("table",{class:"table table-striped table-bordered"},Object(d.h)("thead",null,Object(d.h)("tr",null,Object(d.h)("td",{colspan:"2",class:"px-4 py-4 overflow-hidden",style:"border-radius: 10px 0 0 0; font-size: 1.4em;"},Object(d.h)("nobr",null,k.title)),Object(d.h)("td",{class:"px-3 text-center py-4 overflow-hidden",style:"border-radius: 0 10px 0 0 ; font-size: 1.1em;"},"Agreement"))),Object(d.h)("tbody",null,S&&S.map((t,s)=>{const{musher:a={},currentTeam:l={},currentResults:n={}}=t;o.getTotalsByTeamId(l.id);return Object(d.h)(e,null,Object(d.h)("tr",{style:"border-bottom: 1px solid #7B312F;"},Object(d.h)("td",{class:"text-center align-middle ml-0 pl-0",style:"width: 50px; color: #ffffff; font-size: 1.2em; line-height: 1.2em;"},Object(d.h)("div",{class:"d-flex justify-content-start"},Object(d.h)("div",{class:"pl-3 pr-2 w-100 clearfix rounded-pill-right",style:"background-color: "+O.a.getRankingColor(s+1)},a.bib||s+1))),Object(d.h)("td",{class:"px-3 py-3",style:"font-size: 1.2em;"},Object(d.h)("nobr",null,a.flag," ",a.firstname," ",a.lastname,Object(d.h)("br",null)),Object(d.h)("small",null,a.cellphone,Object(d.h)("br",null),a.address,Object(d.h)("br",null),a.postalcode,Object(d.h)("br",null),a.postalplace,Object(d.h)("br",null),a.country,Object(d.h)("br",null))),Object(d.h)("td",{class:"text-center align-middle",style:"width: 150px; font-size: 1.2em;"},a.declaration&&Object(d.h)(e,null,Object(d.h)("nobr",null,Object(d.h)("i",{class:"fas fa-check text-success"})," ",h.a.isoDate(a.declarationDate))))))})))))))}})||r;t.default=w}.call(this,s("hosL").Fragment)},ZQlJ:function(e,t,s){"use strict";var a,o=s("hosL"),l=(s("Utv1"),s("/eY4")),n=(s("OhSV"),s("NDEG"));let c=Object(l.a)(a=class extends o.Component{constructor(e){super(e),this.scrollImages=e=>{const{scrollLeft:t,clientWidth:s}=e.target,a=t/s,o=Math.round(a),l=Math.abs(o-a);(Number.isInteger(a)||l<.1)&&this.setState({imageIdx:o})},this.sortByName=(e,t)=>{const{allDogs:s=[]}=this.props,a=s.find(t=>t.id===e),o=s.find(e=>e.id===t);return a&&o&&a.name>o.name?1:-1},this.state={imageIdx:0}}render(){const{dogs:e,allDogs:t=[],size:s="medium",onDogClick:a=(()=>{})}=this.props;return Object(o.h)("div",{class:"w-100"},Object(o.h)("div",{class:"d-flex flex-row flex-nowrap no-scrollbar",style:"overflow: auto; scroll-snap-type: x mandatory;",onScroll:this.scrollImages},e&&e.sort(this.sortByName).map(l=>{const c=t.find(e=>e.id===l);return c?Object(o.h)("div",{class:"col clearfix position-relative p-0 mx-2"},Object(o.h)("div",{class:"w-100 h-100 text-center rounded-lg imageContainer d-flex justify-content-center align-items-center",style:"\n                                        flex-wrap: wrap;\n                                        overflow-y: hidden;\n                                    ",onTouchstart:e=>{e.stopPropagation()},onTouchend:e=>{e.stopPropagation()},onTouchmove:e=>{e.stopPropagation()}},Object(o.h)(n.a,{stores:this.props.stores,dog:c,dogs:t.filter(t=>e.indexOf(t.id)>-1).sort((e,t)=>e.name>t.name?1:-1),className:"mx-auto",showName:!0,showPosition:!1,size:s,onDogClick:a}))):""})))}})||a;t.a=c}}]);
//# sourceMappingURL=86.chunk.6eac7.esm.js.map