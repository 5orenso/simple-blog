(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{"1OK2":function(t,e,s){"use strict";var o,n=s("hosL"),a=(s("Utv1"),s("/eY4"));Object(a.a)(o=function(t){function e(e){var s;(s=t.call(this,e)||this).touchStart=function(t){t.stopPropagation(),s.setState({startX:t.touches[0].pageX})},s.touchEnd=function(t){t.stopPropagation(),s.setState({startX:void 0,sliding:!1})},s.touchMove=function(t){if(t.stopPropagation(),s.state.totalImages>1){var e=s.state,o=e.startX,n=t.touches[0].pageX;e.sliding||(n>o+50?(s.setState({sliding:!0}),s.prevImage()):n<o-50&&(s.setState({sliding:!0}),s.nextImage()))}};var o=e.images,n=void 0===o?[]:o;return s.state={imageContainer:1,currentImage1:n[0]||{},currentImage2:{},currentIdx:0,totalImages:n.length||0,imageDots:[].concat(Array(n.length||0).fill(1).map((function(t,e){return t+e})))},s}var s,o;o=t,(s=e).prototype=Object.create(o.prototype),s.prototype.constructor=s,s.__proto__=o;var a=e.prototype;return a.nextImage=function(){var t,e=this.state,s=1===e.imageContainer?2:1,o=e.currentIdx+1;o>e.totalImages-1&&(o=0),this.setState(((t={})["currentImage"+s]=this.props.images[o],t.currentIdx=o,t.imageContainer=s,t))},a.prevImage=function(){var t,e=this.state,s=e.imageContainer,o=e.currentIdx-1;o<0&&(o=e.totalImages-1),this.setState(((t={})["currentImage"+(1===s?2:1)]=this.props.images[o],t.currentIdx=o,t.imageContainer=1===s?2:1,t))},a.componentWillReceiveProps=function(t){if(t.images!==this.props.images){var e=t.images,s=void 0===e?[]:e;this.setState({imageContainer:1,currentImage1:s.length>0?s[0]:{},currentImage2:{},currentIdx:0,totalImages:s.length||0,imageDots:[].concat(Array(s.length||0).fill(1).map((function(t,e){return t+e})))})}},a.render=function(){var t,e,s=this,o=this.state,a=o.currentImage1,i=o.currentImage2,r=o.imageContainer,l=o.totalImages,c=o.imageDots,d=o.currentIdx,h=this["image"+r],u=1===r?a:i;if(u.dimensions){var m=u.dimensions,b=m.width,p=m.height,f=m.orientation;f>4&&f<9?(t=b,e=p):(t=p,e=b)}var g=u.dimensions?e/t:h&&h.height?h.width/h.height:4/3;return l<=0?"":Object(n.h)("div",{class:"w-100"},Object(n.h)("div",{class:"border rounded position-relative w-100",style:"height: calc(85vw / "+g+"); overflow: hidden; transition: all .3s ease-in-out;",onTouchstart:this.touchStart,onTouchend:this.touchEnd,onTouchmove:this.touchMove},l>1&&Object(n.h)("span",{class:"position-absolute",style:"top:0px; right: 5px; z-index: 2000;"},Object(n.h)("small",null,d+1,"/",l)),a&&Object(n.h)("div",{class:"position-absolute",style:(1===r?"opacity: 1;":"opacity: 0;")+" transition: all .3s ease-in-out; top: 0; left: 0;"},Object(n.h)("img",{loading:"lazy",src:a.s3LargeLink,class:"img-fluid align-middle",ref:function(t){return s.image1=t}})),i&&Object(n.h)("div",{class:"position-absolute",style:(2===r?"opacity: 1;":"opacity: 0;")+" transition: all .3s ease-in-out; top: 0; left: 0;"},Object(n.h)("img",{loading:"lazy",src:i.s3LargeLink,class:"img-fluid align-middle",ref:function(t){return s.image2=t}}))),c.length>1&&Object(n.h)("div",{class:"w-100 text-center"},c.map((function(t){return Object(n.h)("span",{style:"color: "+(t===d+1?"#ffffff":"#808080")+";"},"•")}))))},e}(n.Component))},"4QWe":function(t,e,s){"use strict";(function(t){var o,n=s("hosL"),a=s("Utv1"),i=s("/eY4"),r=s("OhSV"),l=s("go65"),c=s("om2D"),d=s("ZOvn"),h=Object(i.a)(o=function(e){function s(t){var s;return(s=e.call(this,t)||this).beforeImagesUploaded=function(){s.setState({sendButtonEnabled:!1})},s.afterImagesUploaded=function(){s.setState({sendButtonEnabled:!0})},s.commentStory=function(){return new Promise((function(t,e){var o,n,a,i,r,l,c,h,u,m,b;return s.state.sendButtonEnabled?(a=void 0===(n=(o=s.props).callback)?function(){}:n,r=void 0===(i=o.inputRefObject)?{}:i,l=s.props.story,c=s.props.stores.storyStore,u=(h=s.state).comment,m=h.showAddImage,s.setState({sendButtonEnabled:!1}),Promise.resolve(c.commentStory({id:l.id,comment:u})).then((function(o){try{return(b=o)&&200===b.status&&(s.setState({comment:{body:"",images:[]}},(function(){d.a.resizeTextarea(r[l.id]),m&&s.addImage()})),a({story:l,response:b})),s.setState({sendButtonEnabled:!0}),t()}catch(t){return e(t)}}),e)):t(!1)}))},s.addImages=function(t){var e,o=s.state.comment;(e=o.images).push.apply(e,t.value),s.setState({comment:o})},s.addImage=function(){var t=s.state.showAddImage;s.setState({showAddImage:!(void 0!==t&&t)})},s.handleImageErrored=function(t){var e=t.target;e.onerror=null,setTimeout((function(){e.src+="?"+new Date}),1e3)},s.state={comment:{body:"",images:[]},showAddImage:!1,sendButtonEnabled:!0},s.inputRef={},s}var o,i;return i=e,(o=s).prototype=Object.create(i.prototype),o.prototype.constructor=o,o.__proto__=i,s.prototype.render=function(){var e=this,s=this.props,o=s.inputRef,i=s.story,h=this.state,u=h.comment,m=h.showAddImage,b=h.sendButtonEnabled,p=this.props.stores.userStore.user,f=void 0===p?{}:p,g=d.a.displayNameShort(f),O=(d.a.displayName(f),f.image||(f.images?f.images[0]:void 0));return Object(n.h)("div",null,Object(n.h)("div",{class:"d-flex mb-0 position-relative w-100"},Object(n.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall",style:(O?"background-image: url('"+O.s3SmallLink+"'); background-size: cover;":"")+" border-width: 3px !important;"},!f.image&&Object(n.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},g)),Object(n.h)("div",{class:"col pl-3",style:"line-height: 1.2em;"},Object(n.h)("div",{class:"d-flex bd-highlight"},Object(n.h)("div",{class:"p-0 w-100 bd-highlight"},Object(n.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(n.h)(r.c,{id:"comments.comment"},"Kommentar")),Object(n.h)("div",{class:"border rounded rounded-lg position-relative"},Object(n.h)(r.b,null,Object(n.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(n.h)(r.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(l.a)(this,"comment.body"),onKeyUp:d.a.resizeTextarea,onFocus:d.a.resizeTextarea,style:"height: 2.3em;",value:u.body,ref:o})),Object(n.h)("div",{class:"position-absolute",style:"top: 8px; right: 10px; font-size: 1.2em;"},Object(n.h)("i",{class:"fas fa-image pointerCursor","data-id":i.id,onClick:this.addImage})))),Object(n.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(n.h)("button",{type:"button",class:"btn btn-"+(b?"primary":"secondary")+" mb-2",disabled:!b,onClick:this.commentStory},Object(n.h)("i",{class:"fas fa-paper-plane"})))))),m&&Object(n.h)(t,null,Object(n.h)("div",{class:"col-12 text-center"},Object(n.h)("div",{class:"container-fluid"},Object(n.h)("div",{class:"row"},a.a.isArray(u.images)&&u.images.map((function(t){return Object(n.h)("div",{class:"col-3 p-1"},Object(n.h)("img",{src:t.s3SmallLink,class:"img-fluid",onError:e.handleImageErrored}),Object(n.h)("button",{class:"btn btn-sm btn-link",onClick:e.removeImage,"data-name":t.name},Object(n.h)("i",{class:"fas fa-trash"})," ",Object(n.h)(r.c,{id:"comments.remove-image"},"Remove")))})))),Object(n.h)(c.a,{object:u,updateField:this.addImages,before:this.beforeImagesUploaded,after:this.afterImagesUploaded,autoOpen:!0}))))},s}(n.Component))||o;e.a=h}).call(this,s("hosL").Fragment)},"5uob":function(t,e,s){"use strict";var o,n=s("hosL"),a=(s("Utv1"),s("/eY4")),i=s("OhSV"),r=s("go65"),l=(s("ETxl"),s("ZOvn")),c=Object(a.a)(o=function(t){function e(e){var s;return(s=t.call(this,e)||this).commentStory=function(){return new Promise((function(t,e){var o,n,a,i,r,c,d,h,u,m,b;return s.state.sendButtonEnabled?(a=void 0===(n=(o=s.props).callback)?function(){}:n,i=o.commentId,c=void 0===(r=o.inputRefObject)?{}:r,d=s.props.story,h=s.props.stores.storyStore,m=void 0===(u=s.state.comment)?"":u,s.setState({sendButtonEnabled:!1}),Promise.resolve(h.commentReplyStory({id:d.id,commentId:i,comment:m})).then((function(o){try{return(b=o)&&200===b.status&&(s.setState({comment:""},(function(){l.a.resizeTextarea(c[i])})),a({story:d,response:b,commentId:i})),s.setState({sendButtonEnabled:!0}),t()}catch(t){return e(t)}}),e)):t(!1)}))},s.state={sendButtonEnabled:!0},s.inputRef={},s}var s,o;o=t,(s=e).prototype=Object.create(o.prototype),s.prototype.constructor=s,s.__proto__=o;var a=e.prototype;return a.componentDidMount=function(){var t=this.props.initCall;(void 0===t?function(){}:t)()},a.render=function(){var t=this.props.inputRef,e=this.state,s=e.comment,o=e.sendButtonEnabled,a=this.props.stores.userStore.user,c=void 0===a?{}:a,d=l.a.displayNameShort(c),h=(l.a.displayName(c),c.image||(c.images?c.images[0]:void 0));return Object(n.h)("div",{class:"w-100"},Object(n.h)("div",{class:"d-flex mb-0 position-relative w-100"},Object(n.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedThumb",style:(h?"background-image: url('"+h.s3SmallLink+"'); background-size: cover;":"")+" border-width: 3px !important;"},!h&&Object(n.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},d)),Object(n.h)("div",{class:"col pl-3",style:"line-height: 1.2em;"},Object(n.h)("div",{class:"d-flex bd-highlight"},Object(n.h)("div",{class:"p-0 w-100 bd-highlight"},Object(n.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(n.h)(i.c,{id:"comments.comment"},"Kommentar")),Object(n.h)("div",{class:"border rounded rounded-lg position-relative"},Object(n.h)(i.b,null,Object(n.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(n.h)(i.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(r.a)(this,"comment"),onKeyUp:l.a.resizeTextarea,style:"height: 2.3em;",value:s,ref:t})))),Object(n.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(n.h)("button",{type:"button",class:"btn btn-"+(o?"primary":"secondary")+" mb-2",disabled:!o,onClick:this.commentStory},Object(n.h)("i",{class:"fas fa-paper-plane"})))))))},e}(n.Component))||o;e.a=c},B95u:function(t,e,s){"use strict";(function(t){function o(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,o)}return s}function n(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?o(Object(s),!0).forEach((function(e){a(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function a(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var i,r=s("hosL"),l=s("Utv1"),c=s("/eY4"),d=s("cneo"),h=s("OhSV"),u=s("fh8t"),m=s.n(u),b=s("go65"),p=s("5uob"),f=(s("ETxl"),s("ZOvn")),g={showAddComment:{},showAllComments:!1,showAllReplies:{},viewImageIdx:{},likeComment:{},likeReply:{},showOriginal:{}},O=Object(c.a)(i=function(e){function s(t){var s;return(s=e.call(this,t)||this).addLikeComment=function(t){return new Promise((function(e,o){var n,a,i,r,l,c,d;return a=void 0===(n=s.props.callback)?function(){}:n,i=t.target.closest(".commentContainer").dataset.id,r=s.props.story,l=s.props.stores.storyStore,(c=s.state.likeComment)[i]=!0,s.setState({likeComment:c}),setTimeout((function(){var t=s.state.likeComment;delete t[i],s.setState({likeComment:t})}),1200),Promise.resolve(l.likeStoryComment({id:r.id,commentId:i})).then((function(t){try{return(d=t)&&200===d.status&&a({type:"likeComment",story:r,commentId:i,response:d}),e(!0)}catch(t){return o(t)}}),o)}))},s.likeReply=function(t){return new Promise((function(e,o){var n,a,i,r,l,c,d,h;return a=void 0===(n=s.props.callback)?function(){}:n,i=t.target.closest(".replyContainer").dataset.id,r=t.target.closest(".replyContainer").dataset.comment,l=s.props.story,c=s.props.stores.storyStore,(d=s.state.likeReply)[i]=!0,s.setState({likeReply:d}),setTimeout((function(){var t=s.state.likeReply;delete t[i],s.setState({likeReply:t})}),1200),Promise.resolve(c.likeStoryCommentReply({id:l.id,replyId:i,commentId:r})).then((function(t){try{return(h=t)&&200===h.status&&a({type:"likeReply",story:l,commentId:r,replyId:i,response:h}),e()}catch(t){return o(t)}}),o)}))},s.replyComment=function(t){return new Promise((function(e){var o=t.target.parentElement.dataset.id||t.target.dataset.id,n=s.state.showAddComment;return n[o]=!n[o],s.setState({showAddComment:n},(function(){s.inputRef[o]&&s.inputRef[o].focus()})),e()}))},s.toggleComments=function(){s.setState({showAllComments:!s.state.showAllComments})},s.toggleReplies=function(t){var e=t.target.parentElement.dataset.id||t.target.dataset.id,o=s.state.showAllReplies;o[e]=!o[e],s.setState({showAllReplies:o})},s.toggleMenu=function(t){var e=t.target.closest("i").dataset.id,o=s.state.showMenu,n=void 0===o?{}:o;n[e]=!n[e],s.setState({showDeleteComment:{},showEdit:{},showMenu:n})},s.toggleEdit=function(t){var e=t.target.closest("button").dataset,o=e.id,n=e.comment,a=s.state.showEdit,i=void 0===a?{}:a;i[o]=!i[o],s.setState({showDeleteComment:{},showEdit:i,showMenu:{},commentEditText:n})},s.toggleDeleteComment=function(t){var e=t.target.closest("button").dataset.id,o=s.state.showDeleteComment,n=void 0===o?{}:o;n[e]=!n[e],s.setState({showDeleteComment:n,showEdit:{},showMenu:{}})},s.deleteComment=function(t){return new Promise((function(e,o){var n;return n=t.target.closest("button").dataset.id,Promise.resolve(s.props.stores.storyStore.deleteCommentStory({id:s.props.story.id,commentId:n})).then((function(){try{return s.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}}),e()}catch(t){return o(t)}}),o)}))},s.deleteCommentReply=function(t){return new Promise((function(e,o){var n;return n=t.target.closest("button").dataset,Promise.resolve(s.props.stores.storyStore.deleteCommentReplyStory({id:s.props.story.id,commentId:n.commentid,replyId:n.id})).then((function(){try{return s.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}}),e()}catch(t){return o(t)}}),o)}))},s.saveComment=function(t){return new Promise((function(e,o){var n;return n=t.target.closest("button").dataset.id,Promise.resolve(s.props.stores.storyStore.editCommentStory({id:s.props.story.id,commentId:n,comment:s.state.commentEditText})).then((function(){try{return s.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}}),e()}catch(t){return o(t)}}),o)}))},s.saveCommentReply=function(t){return new Promise((function(e,o){var n;return n=t.target.closest("button").dataset,Promise.resolve(s.props.stores.storyStore.editCommentReplyStory({id:s.props.story.id,commentId:n.commentid,replyId:n.id,comment:s.state.commentEditText})).then((function(){try{return s.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}}),e()}catch(t){return o(t)}}),o)}))},s.viewImage=function(t){var e=t.target.closest("img").dataset,o=s.state.viewImageIdx;o[e.id]=e.idx,s.setState({viewImageIdx:o})},s.translate=function(t){return new Promise((function(e,o){function n(){return s.setState({showOriginal:b,translatedText:f}),e()}var a,i,r,l,c,d,h,u,m,b,p,f,g;return t.preventDefault(),t.stopPropagation(),a=t.target.closest("button").dataset,l=s.props.story,d=(c=s.props.stores).storyStore,h=c.userStore.user,f=void 0===(p=(u=s.state).translatedText)?{}:p,(b=void 0===(m=u.showOriginal)?{}:m)[g=(r=a.commentid)+((i=a.replyid)?"-"+i:"")]=0,i?Promise.resolve(d.translateCommentReply({commentid:r,replyid:i,story:l,user:h})).then(function(t){try{return f[g]=t,n.call(this)}catch(t){return o(t)}}.bind(this),o):Promise.resolve(d.translateComment({commentid:r,story:l,user:h})).then(function(t){try{return f[g]=t,n.call(this)}catch(t){return o(t)}}.bind(this),o)}))},s.showOriginal=function(t){var e=t.target.closest("button").dataset,o=e.replyid,n=e.commentid;t.preventDefault(),t.stopPropagation();var a=s.state.showOriginal,i=void 0===a?{}:a;i[n+(o?"-"+o:"")]=1,s.setState({showOriginal:i})},s.displayTeam=function(t,e){t.preventDefault(),t.stopPropagation(),s.props.stores.appState.openDrawer("publicTeam",{teamId:e,height:"80vh"})},s.openInbox=function(t,e){t.preventDefault(),t.stopPropagation(),s.props.stores.appState.openDrawer("inboxDetail",{fromuser:e,height:"80vh"})},s.state=n(n({},g),{},{showAllComments:t.showAllComments}),s.inputRef={},s}var o,a;return a=e,(o=s).prototype=Object.create(a.prototype),o.prototype.constructor=o,o.__proto__=a,s.prototype.render=function(){var e,s=this,o=this.state,n=o.showAddComment,a=o.showAllComments,i=o.showAllReplies,c=o.viewImageIdx,u=o.showMenu,g=void 0===u?{}:u,O=o.showEdit,j=void 0===O?{}:O,y=o.showDeleteComment,v=void 0===y?{}:y,w=o.commentEditText,k=o.likeComment,x=o.showOriginal,S=void 0===x?{}:x,C=o.translatedText,I=void 0===C?{}:C,D=this.props,T=D.story,P=D.callback,R=void 0===P?function(){}:P,E=D.initCall,A=void 0===E?function(){}:E,F=D.compact,L=this.props.stores,M=L.userStore,z=L.storyStore,B=M.user,U=B.language,_=void 0===U?"en":U,N=[],K=0,V=0;return T.comments&&(K=T.comments.length,a?N=T.comments:(e=void 0!==F&&F?0:2,N=T.comments.slice(Math.max(K-e,0))),V=N.length),Object(r.h)("div",null,T&&l.a.isArray(N)&&N.reverse().map((function(o){var a=o.user,u=void 0===a?{}:a,O=z.findPublicTeamByMembers(u.id),y=f.a.displayNameShort(u),x=f.a.displayName(u),C=u.image||(u.images?u.images[0]:void 0),D=o.likes&&o.likes.findIndex((function(t){return t.user===B.id}))>-1,P=[],E=0,F=0;o.comments&&(E=o.comments.length,F=(P=i[o.id]?o.comments:o.comments.slice(0,e)).length);var L=[];if(o.images){var M=Object(d.i)(o.images);L.push.apply(L,M)}var U=c[o.id]?c[o.id]:0,N=L&&L[U]?L[U]:null,K=z.getCommentTranslations({story:T,commentid:o.id,targetLang:_})||I[o.id],V=K||o.comment;return S[o.id]&&(V=o.comment),Object(r.h)("div",{class:"row"},Object(r.h)("div",{class:"col-11 offset-1 d-flex mb-2 position-relative"},Object(r.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall",style:(C?'background-image: url("'+C.s3SmallLink+'"); background-size: cover;':"")+" border-width: 3px !important;"},!u.image&&Object(r.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},y)),Object(r.h)("div",{class:"flex-grow-1 pl-3 pt-0",style:"line-height: 1.2em;"},Object(r.h)("div",{class:"bg-light p-2 rounded rounded-lg position-relative"},B.id===u.id&&Object(r.h)(t,null,Object(r.h)("span",{class:"float-right font-weight-lighter text-muted"},Object(r.h)("i",{class:"fas fa-ellipsis-h",onClick:s.toggleMenu,"data-id":o.id}))),g[o.id]&&Object(r.h)(t,null,Object(r.h)("div",{class:"position-absolute bg-white p-2 border rounded rounded-lg shadow-sm",style:"top: 30px; right: 10px; width: 60%; z-index: 999999;"},Object(r.h)("button",{class:"btn btn-link btn-block text-left",onClick:s.toggleEdit,"data-id":o.id,"data-comment":o.comment},Object(r.h)("i",{class:"fas fa-edit"})," Edit"),Object(r.h)("hr",null),Object(r.h)("button",{class:"btn btn-link btn-block text-left",onClick:s.toggleDeleteComment,"data-id":o.id},Object(r.h)("i",{class:"fas fa-trash-alt"})," Delete"))),Object(r.h)("div",null,Object(r.h)("span",{style:"font-size: 0.95em;"},Object(r.h)("h5",{class:"font-weight-bold mb-2",style:"font-size: 1.0em;"},u.uuidv4&&u.uuidv4!==B.uuidv4?Object(r.h)(t,null,Object(r.h)("a",{href:"/inbox/"+u.uuidv4,onClick:function(t){return s.openInbox(t,u.uuidv4)}},x)):Object(r.h)(t,null,x),O&&O.length>0&&Object(r.h)(t,null,Object(r.h)("span",{class:"font-weight-lighter text-muted ml-1"},O.filter((function(t){return 1===t.public})).slice(0,1).map((function(e){return Object(r.h)(t,null,"- ",Object(r.h)("a",{href:"/teams/public/"+e.uuidv4,onClick:function(t){return s.displayTeam(t,e.uuidv4)}},e.name))}))))),j[o.id]?Object(r.h)(t,null,Object(r.h)("div",{class:"d-flex bd-highlight"},Object(r.h)("div",{class:"p-0 w-100 bd-highlight"},Object(r.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(r.h)(h.c,{id:"comments.comment"},"Kommentar")),Object(r.h)("div",{class:"border rounded rounded-lg position-relative"},Object(r.h)(h.b,null,Object(r.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(r.h)(h.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(b.a)(s,"commentEditText"),onKeyUp:f.a.resizeTextarea,onFocus:f.a.resizeTextarea,style:"height: 2.3em;",value:w})))),Object(r.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(r.h)("button",{type:"button",class:"btn btn-primary mb-2",onClick:s.saveComment,"data-id":o.id},Object(r.h)("i",{class:"fas fa-paper-plane"}))))):Object(r.h)(t,null,Object(r.h)(m.a,{markdown:f.a.replaceImages(V,o.images,_),markdownOpts:f.a.getMarkdownOptions()})),v[o.id]&&Object(r.h)("div",{class:"clearfix mt-3 mb-3"},Object(r.h)("button",{class:"btn btn-danger float-left",onClick:s.deleteComment,"data-id":o.id},Object(r.h)("i",{class:"fas fa-trash-alt"})," Delete"),Object(r.h)("button",{class:"btn btn-secondary float-right",onClick:s.toggleDeleteComment,"data-id":o.id},Object(r.h)("i",{class:"fas fa-times-circle"})," Cancel")))),Object(r.h)("div",null,Object(r.h)("div",{class:"container-fluid px-3 mt-1"},N&&Object(r.h)("div",{class:"clearfix row position-relative"},Object(r.h)("div",{class:"commentContainer col-12 px-0 overflow-hidden",style:"max-height: 60vh;",onDblclick:s.addLikeComment,"data-id":o.id},Object(r.h)("img",{loading:"lazy",class:"img-fluid",style:"min-width: 100px;",src:N.s3LargeLink})),k[o.id]&&Object(r.h)("span",{class:"likeHeart position-absolute text-white display-1",style:"top: calc(50% - 50px); left: calc(50% - 50px); width: 100px; height: 100px;"},Object(r.h)("i",{class:"fas fa-heart likeStory"}))),L&&L.length>1&&Object(r.h)("div",{class:"clearfix d-flex flex-wrap row"},l.a.isArray(L)&&L.map((function(e,n){return Object(r.h)(t,null,Object(r.h)("div",{class:"col px-0 overflow-hidden",style:"max-height: 100px; min-width: 100px;"},Object(r.h)("img",{loading:"lazy",class:"img-fluid border",style:"min-width: 100px;",src:e.s3SmallLink,onClick:s.viewImage,"data-id":o.id,"data-idx":n})))})))))),Object(r.h)("small",null,Object(r.h)("button",{class:"commentContainer btn btn-sm btn-link py-0 "+(D?"text-primary":""),onClick:s.addLikeComment,"data-id":o.id,disabled:D},D?Object(r.h)(h.c,{id:"comments.has-liked"},"Liked"):Object(r.h)(h.c,{id:"comments.like"},"Lik")),"-",Object(r.h)("button",{class:"btn btn-sm btn-link py-0",onClick:s.replyComment,"data-id":o.id},Object(r.h)(h.c,{id:"comments.comment-add"},"Kommentar")),o.language!==_&&Object(r.h)(t,null,"-",!S[o.id]&&K?Object(r.h)(t,null,Object(r.h)("button",{type:"button",class:"btn btn-sm btn-link","data-commentid":o.id,onClick:s.showOriginal},Object(r.h)("i",{class:"fas fa-cog"}),"  ",Object(r.h)(h.c,{id:"home.translate-show-original"},"Show original"))):Object(r.h)(t,null,Object(r.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:s.translate,"data-commentid":o.id},Object(r.h)("i",{class:"fas fa-cog"})," ",Object(r.h)(h.c,{id:"home.translate-to"},"See translation")))),"-",Object(r.h)("button",{class:"btn btn-sm btn-link py-0 disabled"},l.a.formatDistance(o.createdDate,new Date,{locale:"no-NB"}),o.updatedDate&&Object(r.h)(t,null,Object(r.h)("span",{class:"font-weight-light ml-2"},"(Edited ",l.a.formatDistance(o.updatedDate,new Date,{locale:"no-NB"}),")"))))),o.likes&&o.likes.length>0&&Object(r.h)("small",{class:"position-absolute bg-light shadow-sm rounded-lg py-0 px-1",style:"bottom: 20px; right: 15px;"},Object(r.h)("i",{class:"fas fa-thumbs-up text-primary"})," ",o.likes.length)),Object(r.h)("div",{class:"col-10 offset-2 mb-2"},o&&l.a.isArray(P)&&P.map((function(e){var n=e.user,a=void 0===n?{}:n,i=z.findPublicTeamByMembers(a.id),c=f.a.displayNameShort(a),d=f.a.displayName(a),u=a.image||(a.images?a.images[0]:void 0),p=e.likes&&e.likes.findIndex((function(t){return t.user===B.id}))>-1,O=z.getCommentReplyTranslations({story:T,commentid:o.id,replyid:e.id,targetLang:_})||I[o.id+"-"+e.id],y=O||e.comment;return S[o.id+"-"+e.id]&&(y=e.comment),Object(r.h)("div",{class:"row"},Object(r.h)("div",{class:"col-12 d-flex mb-2 position-relative"},Object(r.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall",style:(u?'background-image: url("'+u.s3SmallLink+'"); background-size: cover;':"")+" border-width: 3px !important;"},!a.image&&Object(r.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},c)),Object(r.h)("div",{class:"flex-grow-1 pl-3 pt-0",style:"line-height: 1.2em;"},Object(r.h)("div",{class:"bg-light p-2 rounded-lg position-relative"},B.id===a.id&&Object(r.h)(t,null,Object(r.h)("span",{class:"float-right font-weight-lighter text-muted"},Object(r.h)("i",{class:"fas fa-ellipsis-h",onClick:s.toggleMenu,"data-id":e.id}))),g[e.id]&&Object(r.h)(t,null,Object(r.h)("div",{class:"position-absolute bg-white p-2 border rounded rounded-lg shadow-sm",style:"top: 30px; right: 10px; width: 60%; z-index: 999999;"},Object(r.h)("button",{class:"btn btn-link btn-block text-left",onClick:s.toggleEdit,"data-id":e.id,"data-comment":e.comment},Object(r.h)("i",{class:"fas fa-edit"})," Edit"),Object(r.h)("hr",null),Object(r.h)("button",{class:"btn btn-link btn-block text-left",onClick:s.toggleDeleteComment,"data-id":e.id},Object(r.h)("i",{class:"fas fa-trash-alt"})," Delete"))),Object(r.h)("span",{style:"font-size: 0.95em;"},Object(r.h)("h5",{class:"font-weight-bold mb-2",style:"font-size: 1.0em;"},a.uuidv4&&a.uuidv4!==B.uuidv4?Object(r.h)(t,null,Object(r.h)("a",{href:"/inbox/"+a.uuidv4,onClick:function(t){return s.openInbox(t,a.uuidv4)}},d)):Object(r.h)(t,null,d),i&&i.length>0&&Object(r.h)(t,null,Object(r.h)("span",{class:"font-weight-lighter text-muted ml-2"},i.filter((function(t){return 1===t.public})).slice(0,1).map((function(e){return Object(r.h)(t,null,"- ",Object(r.h)("a",{href:"/teams/public/"+e.uuidv4,class:"mr-2",onClick:function(t){return s.displayTeam(t,e.uuidv4)}}," ",e.name))}))))),j[e.id]?Object(r.h)(t,null,Object(r.h)("div",{class:"d-flex bd-highlight"},Object(r.h)("div",{class:"p-0 w-100 bd-highlight"},Object(r.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(r.h)(h.c,{id:"comments.comment"},"Kommentar")),Object(r.h)("div",{class:"border rounded rounded-lg position-relative"},Object(r.h)(h.b,null,Object(r.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(r.h)(h.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(b.a)(s,"commentEditText"),onKeyUp:f.a.resizeTextarea,onFocus:f.a.resizeTextarea,style:"height: 2.3em;",value:w})))),Object(r.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(r.h)("button",{type:"button",class:"btn btn-primary mb-2",onClick:s.saveCommentReply,"data-commentid":o.id,"data-id":e.id},Object(r.h)("i",{class:"fas fa-paper-plane"}))))):Object(r.h)(t,null,Object(r.h)(m.a,{markdown:f.a.replaceImages(y,e.images,_),markdownOpts:f.a.getMarkdownOptions()})),v[e.id]&&Object(r.h)("div",{class:"clearfix mt-3 mb-3"},Object(r.h)("button",{class:"btn btn-danger float-left",onClick:s.deleteCommentReply,"data-id":e.id,"data-commentid":o.id},Object(r.h)("i",{class:"fas fa-trash-alt"})," Delete"),Object(r.h)("button",{class:"btn btn-secondary float-right",onClick:s.toggleDeleteComment,"data-id":e.id},Object(r.h)("i",{class:"fas fa-times-circle"})," Cancel")))),Object(r.h)("small",null,Object(r.h)("button",{class:"replyContainer btn btn-sm btn-link py-0 "+(p?"text-primary":""),onClick:s.likeReply,"data-comment":o.id,"data-id":e.id,disabled:p},p?Object(r.h)(h.c,{id:"comments.has-liked"},"Liked"):Object(r.h)(h.c,{id:"comments.like"},"Lik")),"-",Object(r.h)("button",{class:"btn btn-sm btn-link py-0",onClick:s.replyComment,"data-id":o.id},Object(r.h)(h.c,{id:"comments.comment-add"},"Kommentar")),e.language!==_&&Object(r.h)(t,null,"-",!S[o.id+"-"+e.id]&&O?Object(r.h)(t,null,Object(r.h)("button",{type:"button",class:"btn btn-sm btn-link","data-commentid":o.id,"data-replyid":e.id,onClick:s.showOriginal},Object(r.h)("i",{class:"fas fa-cog"}),"  ",Object(r.h)(h.c,{id:"home.translate-show-original"},"Show original"))):Object(r.h)(t,null,Object(r.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:s.translate,"data-commentid":o.id,"data-replyid":e.id},Object(r.h)("i",{class:"fas fa-cog"})," ",Object(r.h)(h.c,{id:"home.translate-to"},"See translation")))),"-",Object(r.h)("button",{class:"btn btn-sm btn-link py-0 disabled"},l.a.formatDistance(e.createdDate,new Date,{locale:"no-NB"}),e.updatedDate&&Object(r.h)(t,null,Object(r.h)("span",{class:"font-weight-light ml-2"},"(Edited ",l.a.formatDistance(e.updatedDate,new Date,{locale:"no-NB"}),")"))))),e.likes&&Object(r.h)("small",{class:"position-absolute bg-light shadow-sm rounded-lg py-0 px-1",style:"bottom: 20px; right: 15px;"},Object(r.h)("i",{class:"fas fa-thumbs-up text-primary"})," ",e.likes.length)))})),E-F>0&&Object(r.h)("div",null,Object(r.h)("button",{class:"btn btn-sm btn-link py-0",onClick:s.toggleReplies,"data-id":o.id},Object(r.h)(h.c,{id:"comments.show-more",fields:{more:E-F}},"Vis ",E-F," flere kommentarer...")))),n[o.id]&&Object(r.h)("div",{class:"col-11 offset-1 d-flex mb-2 position-relative"},Object(r.h)(p.a,{stores:s.props.stores,story:T,initCall:A,callback:R,commentId:o.id,inputRef:function(t){return s.inputRef[o.id]=t},inputRefObject:s.inputRef,key:"story-commentreply-"+o.id})))})),K-V>0&&Object(r.h)("div",null,Object(r.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.toggleComments},Object(r.h)(h.c,{id:"comments.show-more",fields:{more:K-V}},"Vis ",K-V," flere kommentarer..."))),a&&Object(r.h)("div",null,Object(r.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.toggleComments},Object(r.h)(h.c,{id:"comments.hide-all-comments"},"Skjul alle kommentarene."))))},s}(r.Component))||i;e.a=O}).call(this,s("hosL").Fragment)},NMoA:function(t,e,s){"use strict";(function(t){function o(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,o)}return s}function n(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?o(Object(s),!0).forEach((function(e){a(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function a(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function i(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var r,l,c,d,h,u=s("hosL"),m=s("Utv1"),b=s("/eY4"),p=s("cneo"),f=s("OhSV"),g=s("fh8t"),O=s.n(g),j=s("go65"),y=s("Y3FI"),v=(s("1OK2"),s("B95u")),w=s("4QWe"),k=(s("NMoA"),s("P9Fo")),x=s("s4FZ"),S=s("+JSK"),C=s("vY+r"),I=s("eQ6k"),D=s("om2D"),T=s("ZOvn"),P={showAddComment:{},showTeamSetting:{},viewImageIdx:{},likeStory:{}},R=Object(b.a)(r=function(e){function s(t){var s;return(s=e.call(this,t)||this).saveStory=function(t){return new Promise((function(e,o){var n,a,i,r,l;return n=t.target.closest("button").dataset.id,a=s.state.storyBody,i=s.props.stores.storyStore,l=void 0===(r=s.props.callback)?function(){return!0}:r,Promise.resolve(i.saveField(parseInt(n,10),"body",a,!0)).then((function(){try{return i.publicFeedUpdate(parseInt(n,10),"body",a),s.setState({storyBody:"",storyType:0}),l(),e()}catch(t){return o(t)}}),o)}))},s.saveStoryField=function(t){return new Promise((function(e){var o=s.props.story.id,n=t.target,a=n.value,i=n.name,r=t.target.dataset,l=r.subfield,c=r.subvalue;return s.state.sendButtonEnabled?(s.props.stores.storyStore.publicFeedUpdate(o,i,a),clearTimeout(s.updateTimer[i]),s.updateTimer[i]=setTimeout((function(){return new Promise((function(t){var e;return s.doUpdateField(o,i,a,{query:(e={},e[l]=c,e)}),t()}))}),1e3),e()):e(!1)}))},s.updateFieldValue=function(t){var e=t.id,o=t.field,n=t.value,a=t.skipTimer,i=void 0!==a&&a,r=s.props.story,l=s.props.stores.storyStore,c=n,d=n;"images"===o&&Array.isArray(r.images)&&Array.isArray(n)&&(d=[].concat(r.images,n)),l.updateField(e,o,d),l.publicFeedUpdate(e,o,d),i?s.doUpdateField(e,o,c):(clearTimeout(s.updateTimer[o]),s.updateTimer[o]=setTimeout((function(){return new Promise((function(t){return s.doUpdateField(e,o,c),t()}))}),500))},s.beforeImagesUploaded=function(){s.setState({sendButtonEnabled:!1})},s.afterImagesUploaded=function(){s.setState({sendButtonEnabled:!0})},s.removeImage=function(t){return new Promise((function(e){return s.props.stores.storyStore.removeImage({id:s.props.story.id,name:t.target.parentElement.dataset.name||t.target.dataset.name}),e()}))},s.handleImageErrored=function(t){var e=t.target;e.onerror=null,setTimeout((function(){e.src+="?"+new Date}),1e3)},s.updateTimer={},s.textareaRef=Object(u.createRef)(),s.state={sendButtonEnabled:!0,storyBody:t.story.body},s}i(s,e);var o=s.prototype;return o.doUpdateField=function(t,e,s,o){return new Promise(function(a,i){return void 0===o&&(o={}),this.setState({sendButtonEnabled:!1}),Promise.resolve(this.props.stores.storyStore.saveField(parseInt(t,10),e,s,!0,{query:n({},o.query)})).then(function(){try{return this.setState({sendButtonEnabled:!0}),a()}catch(t){return i(t)}}.bind(this),i)}.bind(this))},o.componentDidMount=function(){this.textareaRef.current.focus()},o.render=function(){var e=this,s=this.state,o=s.storyBody,n=s.storyType,a=s.sendButtonEnabled,i=this.props.stores.userStore.isAdmin,r=this.props.story;return Object(u.h)(t,null,Object(u.h)("div",{class:"container-fluid px-0 mt-1"},Object(u.h)("div",{class:"row"},Object(u.h)("div",{class:"col-12 text-center mt-2"},Object(u.h)("div",{class:"container-fluid"},Object(u.h)("div",{class:"row d-flex align-items-end"},m.a.isArray(r.images)&&r.images.map((function(t,s){return Object(u.h)("div",{class:"col-3 p-1"},Object(u.h)("img",{src:t.s3SmallLink,class:"img-fluid",onError:e.handleImageErrored}),Object(u.h)("button",{class:"btn btn-sm btn-link",onClick:e.removeImage,"data-name":t.name},Object(u.h)("i",{class:"fas fa-trash"})," Del"),Object(u.h)("small",null,Object(u.h)("input",{class:"form-control",type:"text",name:"images.title","data-subfield":"name","data-subvalue":r.images[s].name,onInput:e.saveStoryField,value:r.images[s].title})))})))),Object(u.h)(D.a,{object:r,updateField:this.updateFieldValue,before:this.beforeImagesUploaded,after:this.afterImagesUploaded,autoOpen:!1}))),Object(u.h)("div",{class:"row"},Object(u.h)("div",{class:"col-12 mt-2"},Object(u.h)("label",null,Object(u.h)(f.c,{id:"story.content"},"Content")),Object(u.h)("div",{class:"border rounded rounded-lg position-relative"},Object(u.h)(f.b,null,Object(u.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(u.h)(f.c,{id:"story.add-content"},"Add your text here..."),onInput:Object(j.a)(this,"storyBody"),onFocus:T.a.resizeTextarea,style:"height: 2.3em;",value:o||r.body,ref:this.textareaRef}))))),Object(u.h)("div",{class:"row"},Object(u.h)("div",{class:"col-12 mt-2"},i&&Object(u.h)(t,null,Object(u.h)("div",{class:"col-12 mt-2"},Object(u.h)("div",{class:"form-group"},Object(u.h)("small",null,Object(u.h)("input",{type:"checkbox",id:"pinned-"+r.id,name:"pinned",onInput:this.saveStoryField,value:r.pinned?"false":m.a.isoDate(),checked:r.pinned?"checked":""}),Object(u.h)("label",{class:"ml-2",for:"pinned-"+r.id},"Pinned to top."))))),i&&Object(u.h)(t,null,Object(u.h)("label",null,Object(u.h)(f.c,{id:"story.type"},"Type")),Object(u.h)("div",{class:"form-group"},Object(u.h)("small",null,Object(u.h)("select",{class:"custom-select custom-select-sm",id:r.id,name:"type",onInput:this.saveStoryField,value:n||r.type},Object(u.h)("option",{value:""},"-- ",Object(u.h)(f.c,{id:"story.type-choose"},"Velg type")," --"),Object(u.h)("option",{value:1,selected:1==r.type?"selected":""},"✍️ ",Object(u.h)(f.c,{id:"story.type-regular"},"Vanlig")),Object(u.h)("option",{value:2,selected:2==r.type?"selected":""},"🚀 ",Object(u.h)(f.c,{id:"story.type-ad"},"Annonse")),Object(u.h)("option",{value:3,selected:3==r.type?"selected":""},"📄 ",Object(u.h)(f.c,{id:"story.type-article"},"Artikkel")))))),r.type>=2&&Object(u.h)(t,null,Object(u.h)("label",null,Object(u.h)(f.c,{id:"story.url-text"},"URL text")),Object(u.h)("div",{class:"form-group"},Object(u.h)("small",null,Object(u.h)("input",{class:"form-control",type:"text",name:"urlText",onInput:this.saveStoryField,value:r.urlText}))),Object(u.h)("label",null,Object(u.h)(f.c,{id:"story.url"},"URL")),Object(u.h)("div",{class:"form-group"},Object(u.h)("small",null,Object(u.h)("input",{class:"form-control",type:"text",name:"url",onInput:this.saveStoryField,value:r.url})))),2===r.type&&Object(u.h)(t,null,Object(u.h)("label",null,Object(u.h)(f.c,{id:"story.code"},"Code")),Object(u.h)("div",{class:"form-group"},Object(u.h)("small",null,Object(u.h)("input",{class:"form-control",type:"text",name:"code",onInput:this.saveStoryField,value:r.code}))),Object(u.h)("label",null,Object(u.h)(f.c,{id:"story.country"},"Country")),Object(u.h)("div",{class:"form-group"},Object(u.h)("small",null,Object(u.h)("input",{class:"form-control",type:"text",name:"country",onInput:this.saveStoryField,value:r.country}))),Object(u.h)("label",null,Object(u.h)(f.c,{id:"story.region"},"Region")),Object(u.h)("div",{class:"form-group"},Object(u.h)("small",null,Object(u.h)("input",{class:"form-control",type:"text",name:"region",onInput:this.saveStoryField,value:r.region}))),Object(u.h)("label",null,Object(u.h)(f.c,{id:"story.currency"},"Currency")),Object(u.h)("div",{class:"form-group"},Object(u.h)("small",null,Object(u.h)("input",{class:"form-control",type:"text",name:"currency",onInput:this.saveStoryField,value:r.currency}))),Object(u.h)("label",null,Object(u.h)(f.c,{id:"story.price"},"Price")),Object(u.h)("div",{class:"form-group"},Object(u.h)("small",null,Object(u.h)("input",{class:"form-control",type:"text",name:"price",onInput:this.saveStoryField,value:r.price})))))),Object(u.h)("div",{class:"row"},Object(u.h)("div",{class:"col-12 mt-2"},Object(u.h)("button",{type:"button",class:"btn btn-block btn-"+(a?"primary":"secondary")+" mb-2",disabled:!a,onClick:this.saveStory,"data-id":r.id},Object(u.h)("i",{class:"fas fa-paper-plane"})," ",Object(u.h)(f.c,{id:"story.edit-save"},"Save changes"))))))},s}(u.Component))||r,E=Object(b.a)(l=function(e){function s(t){var s;return(s=e.call(this,t)||this).viewImage=function(t){var e=t.target.closest("img").dataset,o=s.state.viewImageIdx;o[e.id]=e.idx,s.setState({viewImageIdx:o})},s.showStoryDetail=function(t){if("a"===t.target.localName)return!1;var e=t.target.closest("#storyDetail").dataset.id;e&&Object(y.route)("/stories/"+e)},s.translate=function(t){return new Promise((function(e,o){var n;return t.preventDefault(),t.stopPropagation(),n=s.props.stores,Promise.resolve(n.storyStore.translate({story:s.props.story,user:n.userStore.user})).then((function(t){try{return s.setState({showOriginal:0,translatedText:t}),e()}catch(t){return o(t)}}),o)}))},s.showOriginal=function(t){t.preventDefault(),t.stopPropagation(),s.setState({showOriginal:1})},s.setSelectedImage=function(t){s.setState({selectedImageIdx:t})},s.state={viewImageIdx:{}},s}return i(s,e),s.prototype.render=function(){var e=this,s=this.state,o=s.showOriginal,n=s.translatedText,a=s.selectedImageIdx,i=void 0===a?0:a,r=this.props.stores,l=this.props,c=l.story,d=l.likeStory,h=l.likeRef,m=r.userStore.user.language,b=void 0===m?"en":m,g=[];if(c.images){var j=Object(p.i)(c.images);g.push.apply(g,j)}var y=T.a.getTranslation({object:c,targetLang:b,field:"body"})||n,v=y||c.body;o&&(v=c.body);var w=T.a.getInlineComponents(v||""),S=w.components,C=void 0===S?[]:S,I=w.finalBody,D=void 0===I?"":I;return Object(u.h)(t,null,Object(u.h)("div",{class:"container-fluid px-0 mt-1"},Object(u.h)("div",{class:"row"},Object(u.h)(x.a,{stores:this.props.stores,images:g,id:c.id,dblClick:d,likeRef:h,callback:this.setSelectedImage}))),Object(u.h)("div",{class:"row mt-2"},Object(u.h)("div",{class:"clearfix col-12 overflow-hidden",style:c.offline?"text-decoration: line-through;":""},Object(u.h)("div",{id:"storyDetail",onClick:this.showStoryDetail,"data-id":c.id},Object(u.h)(O.a,{markdown:T.a.replaceImages(D,c.images,b),markdownOpts:T.a.getMarkdownOptions()}),c.language!==b&&Object(u.h)(t,null,!o&&y?Object(u.h)(t,null,Object(u.h)("button",{type:"button",class:"btn btn-sm btn-link text-muted",onClick:this.showOriginal},Object(u.h)("i",{class:"fas fa-cog"}),"  ",Object(u.h)(f.c,{id:"home.translate-show-original"},"Show original"))):Object(u.h)(t,null,Object(u.h)("button",{type:"button",class:"btn btn-sm btn-link text-muted",onClick:this.translate},Object(u.h)("i",{class:"fas fa-cog"})," ",Object(u.h)(f.c,{id:"home.translate-to"},"See translation"))))),C&&C.map((function(t){if("poll"===t.name)return Object(u.h)(k.a,{stores:e.props.stores,story:c,storyId:c.id,params:t.params,opts:t.opts,content:t.content,selectedImageIdx:i})})))))},s}(u.Component))||l,A=Object(b.a)(c=function(e){function s(t){var s;return(s=e.call(this,t)||this).viewImage=function(t){var e=t.target.closest("img").dataset,o=s.state.viewImageIdx;o[e.id]=e.idx,s.setState({viewImageIdx:o})},s.showStoryDetail=function(t){if("a"===t.target.localName)return!1;var e=t.target.closest("#storyDetail").dataset.id;e&&Object(y.route)("/stories/"+e)},s.translate=function(t){return new Promise((function(e,o){var n,a,i,r;return t.preventDefault(),t.stopPropagation(),n=s.props.story,i=(a=s.props.stores).storyStore,r=a.userStore.user,s.setState({showOriginal:0}),Promise.resolve(i.translate({story:n,user:r})).then((function(){try{return e()}catch(t){return o(t)}}),o)}))},s.showOriginal=function(t){t.preventDefault(),t.stopPropagation(),s.setState({showOriginal:1})},s.getTranslation=function(){var t=s.props.stores,e=t.userStore,o=e.user.language;T.a.getTranslation({object:s.props.story,targetLang:void 0===o?"en":o,field:"body"})&&s.setState({showOriginal:0})},s.state={viewImageIdx:{}},s}i(s,e);var o=s.prototype;return o.componentWillMount=function(){this.getTranslation()},o.render=function(){var e=this.state,s=e.showOriginal,o=this.props.stores,n=this.props,a=n.story,i=n.likeStory,r=n.likeRef,l=o.userStore.user.language,c=void 0===l?"en":l,d=[];if(a.images){var h=Object(p.i)(a.images);d.push.apply(d,h)}var b=T.a.getTranslation({object:a,targetLang:c,field:"body"}),g=b||a.body;return s&&(g=a.body),Object(u.h)(t,null,Object(u.h)("div",{class:"container-fluid px-0 mt-1"},Object(u.h)("div",{class:"row"},Object(u.h)(x.a,{stores:this.props.stores,images:d,id:a.id,dblClick:i,likeRef:r}))),Object(u.h)("div",{class:"row mt-2"},Object(u.h)("div",{class:"clearfix col-12 overflow-hidden",style:a.offline?"text-decoration: line-through;":""},Object(u.h)("div",{id:"storyDetail","data-id":a.id},Object(u.h)(O.a,{markdown:T.a.replaceImages(g,a.images,c),markdownOpts:T.a.getMarkdownOptions()}),a.language!==c&&Object(u.h)(t,null,!s&&b?Object(u.h)(t,null,Object(u.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:this.showOriginal},Object(u.h)("i",{class:"fas fa-cog"}),"  ",Object(u.h)(f.c,{id:"home.translate-show-original"},"Show original"))):Object(u.h)(t,null,Object(u.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:this.translate},Object(u.h)("i",{class:"fas fa-cog"})," ",Object(u.h)(f.c,{id:"home.translate-to"},"See translation")))))),!!(a.url||a.code||a.price>0)&&Object(u.h)(t,null,Object(u.h)("div",{class:"clearfix col-12  py-2",style:a.offline?"text-decoration: line-through;":""},Object(u.h)("div",{class:"row"},a.url&&Object(u.h)(t,null,Object(u.h)("div",{class:"col-12 text-left",style:"font-size: 1.0em;"},Object(u.h)("a",{href:T.a.asUrl(a.url),target:"_blank",rel:"noreferrer"},Object(u.h)("i",{class:"fas fa-link mr-2"}),a.urlText?Object(u.h)(t,null,a.urlText):Object(u.h)(t,null,Object(u.h)(f.c,{id:"story.ad-url-readmore"},"Les mer..."))))),a.code&&Object(u.h)(t,null,Object(u.h)("div",{class:"col text-left",style:"font-size: 1.2em;"},Object(u.h)("nobr",null,Object(u.h)("span",{class:"font-weight-lighter"},Object(u.h)(f.c,{id:"story.ad-campaign-code"},"Kampanjekode"),":")," ",a.code))),a.price>0&&Object(u.h)(t,null,Object(u.h)("div",{class:"col text-right",style:"font-size: 1.2em;"},Object(u.h)("nobr",null,a.currencty&&Object(u.h)("span",{class:"font-weight-lighter"},a.currency)," ",m.a.format(a.price,2)))))))))},s}(u.Component))||c,F=Object(b.a)(d=function(e){function s(t){var s;return(s=e.call(this,t)||this).viewImage=function(t){var e=t.target.closest("img").dataset,o=s.state.viewImageIdx;o[e.id]=e.idx,s.setState({viewImageIdx:o})},s.showStoryDetail=function(t){if("a"===t.target.localName)return!1;var e=t.target.closest("#storyDetail").dataset.id;e&&Object(y.route)("/stories/"+e)},s.translate=function(t){return new Promise((function(e,o){var n,a,i,r;return t.preventDefault(),t.stopPropagation(),n=s.props.story,i=(a=s.props.stores).storyStore,r=a.userStore.user,s.setState({showOriginal:0}),Promise.resolve(i.translate({story:n,user:r})).then((function(){try{return e()}catch(t){return o(t)}}),o)}))},s.showOriginal=function(t){t.preventDefault(),t.stopPropagation(),s.setState({showOriginal:1})},s.getTranslation=function(){var t=s.props.stores,e=t.userStore,o=e.user.language;T.a.getTranslation({object:s.props.story,targetLang:void 0===o?"en":o,field:"body"})&&s.setState({showOriginal:0})},s.state={viewImageIdx:{}},s}i(s,e);var o=s.prototype;return o.componentWillMount=function(){this.getTranslation()},o.render=function(){var e=this.state,s=e.showOriginal,o=this.props.stores,n=this.props,a=n.story,i=n.likeStory,r=n.likeRef,l=o.userStore.user.language,c=void 0===l?"en":l,d=[];if(a.images){var h=Object(p.i)(a.images);d.push.apply(d,h)}var m=T.a.getTranslation({object:a,targetLang:c,field:"body"}),b=m||a.body;return s&&(b=a.body),Object(u.h)(t,null,Object(u.h)("div",{class:"container-fluid px-0 mt-1"},Object(u.h)("div",{class:"row"},Object(u.h)(x.a,{stores:this.props.stores,images:d,id:a.id,dblClick:i,likeRef:r}))),Object(u.h)("div",{class:"row mt-2"},Object(u.h)("div",{class:"clearfix col-12 overflow-hidden",style:a.offline?"text-decoration: line-through;":""},Object(u.h)("div",{id:"storyDetail",onClick:this.showStoryDetail,"data-id":a.id},Object(u.h)(O.a,{markdown:T.a.replaceImages(b,a.images,c),markdownOpts:T.a.getMarkdownOptions()}),a.language!==c&&Object(u.h)(t,null,!s&&m?Object(u.h)(t,null,Object(u.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:this.showOriginal},Object(u.h)("i",{class:"fas fa-cog"}),"  ",Object(u.h)(f.c,{id:"home.translate-show-original"},"Show original"))):Object(u.h)(t,null,Object(u.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:this.translate},Object(u.h)("i",{class:"fas fa-cog"})," ",Object(u.h)(f.c,{id:"home.translate-to"},"See translation")))))),!!(a.url||a.code||a.price)&&Object(u.h)(t,null,Object(u.h)("div",{class:"clearfix col-12  py-2",style:a.offline?"text-decoration: line-through;":""},Object(u.h)("div",{class:"row"},a.url&&Object(u.h)(t,null,Object(u.h)("div",{class:"col-12 text-left",style:"font-size: 1.0em;"},Object(u.h)("a",{href:T.a.asUrl(a.url),target:"_blank",rel:"noreferrer"},Object(u.h)("i",{class:"fas fa-link mr-2"}),a.urlText?Object(u.h)(t,null,a.urlText):Object(u.h)(t,null,Object(u.h)(f.c,{id:"story.ad-url-readmore"},"Les mer..."))))))))))},s}(u.Component))||d,L=Object(b.a)(h=function(e){function s(t){var s;return(s=e.call(this,t)||this).toggleDate=function(t){t.stopPropagation(),t.preventDefault(),s.setState({showDate:!s.state.showDate})},s.likeStory=function(){return new Promise((function(t,e){var o,n,a,i;return n=s.props.stores.storyStore,(a=s.state.likeStory)[o=s.props.story.id]=!0,i=Object.keys(a),s.setState({likeStory:a,likeIds:i}),setTimeout((function(){var t=s.state.likeStory;delete t[o];var e=Object.keys(t);s.setState({likeStory:t,likeIds:e})}),1200),Promise.resolve(n.likeStory({id:o})).then((function(s){try{return s,t()}catch(t){return e(t)}}),e)}))},s.toggleAddComment=function(t){var e=t.target.closest("button").dataset.id,o=s.state.showAddComment;o[e]?delete o[e]:o[e]=!0,s.setState({showAddComment:o},(function(){s.inputRef[e]&&s.inputRef[e].focus()}))},s.closeAllAddComments=function(){s.setState({showAddComment:{}})},s.toggleShowTeamSetting=function(t){var e=t.target.closest("button").dataset.id,o=s.state.showTeamSetting;o[e]?delete o[e]:o[e]=!0,s.setState({showTeamSetting:o})},s.viewImage=function(t){var e=t.target.closest("img").dataset,o=s.state.viewImageIdx;o[e.id]=e.idx,s.setState({viewImageIdx:o})},s.toggleMenu=function(t){var e=t.target.closest("i").dataset.id,o=s.state.showMenu,n=void 0===o?{}:o;n[e]=!n[e],s.setState({showDeleteStory:{},showEdit:{},showMenu:n})},s.toggleEdit=function(t){var e=t.target.closest("button").dataset.id,o=s.state.showEdit,n=void 0===o?{}:o;n[e]=!n[e],s.setState({showDeleteStory:{},showEdit:n,showMenu:{}})},s.toggleDeleteStory=function(t){var e=t.target.closest("button").dataset.id,o=s.state.showDeleteStory,n=void 0===o?{}:o;n[e]=!n[e],s.setState({showDeleteStory:n,showEdit:{},showMenu:{}})},s.toggleAdminDetails=function(){s.setState({showAdminDetails:!s.state.showAdminDetails}),s.setState({showEdit:{},showMenu:{}})},s.reportStory=function(t){return new Promise((function(e,o){var n;return n=t.target.closest("button").dataset.id,Promise.resolve(s.props.stores.storyStore.reportStory({id:n})).then((function(){try{return s.setState({showEdit:{},showMenu:{}}),e()}catch(t){return o(t)}}),o)}))},s.adminRemoveStory=function(t){return new Promise((function(e,o){var n;return n=t.target.closest("button").dataset.id,Promise.resolve(s.props.stores.storyStore.adminHideStory({id:n})).then((function(){try{return s.setState({showEdit:{},showMenu:{}}),e()}catch(t){return o(t)}}),o)}))},s.deleteStory=function(t){return new Promise((function(e,o){var n,a;return n=t.target.closest("button").dataset.id,a=s.props.stores.storyStore,Promise.resolve(a.saveField(parseInt(n,10),"offline",1,!0)).then((function(){try{return a.publicFeedUpdate(parseInt(n,10),"offline",1),s.setState({storyBody:"",showDeleteStory:{},showEdit:{},showMenu:{}}),e()}catch(t){return o(t)}}),o)}))},s.doneEdit=function(){s.setState({showDeleteStory:{},showEdit:{},showMenu:{}})},s.showStoryDetail=function(t){if("a"===t.target.localName)return!1;var e=t.target.closest("#storyDetail").dataset.id;e&&Object(y.route)("/stories/"+e)},s.shareLink=function(t){var e=t.target.closest("button").dataset;s.props.stores.appState.shareUrl({url:e.url,title:e.title,text:e.text})},s.displayTeam=function(t,e){t.preventDefault(),t.stopPropagation(),s.props.stores.appState.openDrawer("publicTeam",{teamId:e,height:"80vh"})},s.openInbox=function(t,e){t.preventDefault(),t.stopPropagation(),s.props.stores.appState.openDrawer("inboxDetail",{fromuser:e,height:"80vh"})},s.state=n({},P),s.inputRef={},s}i(s,e);var o=s.prototype;return o.loadStoriesPublicFeed=function(t){return new Promise(function(e,s){return void 0===t&&(t=this.props),Promise.resolve(t.stores.storyStore.loadPublicFeed({hashtag:t.hashtag})).then((function(){try{return e()}catch(t){return s(t)}}),s)}.bind(this))},o.render=function(){var e,s,o,n,a=this,i=this.state,r=i.showAddComment,l=i.showDate,c=i.showMenu,d=void 0===c?{}:c,h=i.showEdit,b=void 0===h?{}:h,p=i.showDeleteStory,g=void 0===p?{}:p,O=i.showTeamSetting,j=i.likeStory,y=i.likeIds,k=i.showAdminDetails,x=this.props,D=x.story,P=x.showAllComments,L=x.onTeamClick,M=void 0===L?function(){}:L,z=x.onUserClick,B=void 0===z?function(){}:z,U=this.props.stores,_=U.userStore,N=U.storyStore,K=U.appState,V=_.user,Y=void 0===V?{}:V,q=_.isAdmin,Z=K.hasShareApi,W=N.findPublicTeam(D.team)||{},X=N.findPublicUser(D.user)||{},J=T.a.getImage({user:X,team:W,priority:"user",object:D}),Q=!(!W||!W.members)&&W.members.some((function(t){return t===Y.id}));W&&W.name?(e=T.a.displayNameShort(W),s=T.a.displayName(W),o=T.a.displayName(X),X.settings&&Y.uuidv4!==X.uuidv4&&(n=X.settings.hideProfile?null:"/inbox/"+X.uuidv4)):X&&X.id&&(e=T.a.displayNameShort(X),s=T.a.displayName(X));var H=D.likes,G=D.comments,$=D.reports,tt=void 0===$?[]:$,et=D.likes&&D.likes.findIndex((function(t){return t.user===Y.id}))>-1,st=W.followers?W.followers.length:0,ot=W.members&&W.members.indexOf(Y.id)>-1,nt=W.followers&&W.followers.indexOf(Y.id)>-1,at=W.followRequests&&W.followRequests.findIndex((function(t){return t.id===Y.id}))>-1,it=D.currentLocationGeocode,rt=void 0===it?{}:it,lt=T.a.getViews(D.statistics),ct=T.a.getAdminData(D.statistics);return Object(u.h)(t,null,q||Y.id===X.id?Object(u.h)(t,null,Object(u.h)("span",{class:"float-right font-weight-lighter text-muted"},Object(u.h)("i",{class:"fas fa-ellipsis-h",onClick:this.toggleMenu,"data-id":D.id}))):Object(u.h)(t,null,!ot&&!nt&&!at&&W.public>0&&Object(u.h)("span",{class:"float-right"},Object(u.h)(I.a,{stores:this.props.stores,team:W,buttonOnly:!0,simple:!0,classNames:"btn btn-link text-primary"}))),d[D.id]&&Object(u.h)(t,null,Object(u.h)("div",{class:"position-absolute bg-light p-2 border rounded rounded-lg shadow-sm",style:"top: 30px; right: 10px; width: 60%; z-index: 999999;"},Y.id===X.id?Object(u.h)(t,null,Object(u.h)("button",{class:"btn btn-link btn-block text-left",onClick:this.toggleEdit,"data-id":D.id},Object(u.h)("i",{class:"fas fa-edit"})," Edit"),Object(u.h)("hr",null),Object(u.h)("button",{class:"btn btn-link btn-block text-left text-danger",onClick:this.toggleDeleteStory,"data-id":D.id},Object(u.h)("i",{class:"fas fa-trash-alt"})," Delete")):Object(u.h)(t,null,Object(u.h)("button",{class:"btn btn-link btn-block text-left",onClick:this.reportStory,"data-id":D.id},Object(u.h)("i",{class:"fas fa-flag"})," Report"),q&&Object(u.h)(t,null,Object(u.h)("hr",null),Object(u.h)("button",{class:"btn btn-link btn-block text-left text-danger",onClick:this.adminRemoveStory,"data-id":D.id},Object(u.h)("i",{class:"fas fa-eraser"})," Remove from feed"))),Object(u.h)("button",{class:"btn btn-link btn-block text-left",onClick:this.toggleAdminDetails},Object(u.h)("i",{class:"fas fa-user-cog"})," Toggle admin details"))),Object(u.h)("div",{class:"d-flex position-relative"},Object(u.h)("div",{class:"position-relative text-center border rounded-circle imageRounded imageRoundedMedium",style:J?'background-image: url("'+J+'"); background-size: cover;':""},!J&&Object(u.h)("div",{class:"text-muted",style:"font-size: 20px; padding-top: 3px;"},e)),Object(u.h)("div",{class:"flex-grow-1 pl-3 text-overflow",style:"line-height: 1.2em;"},Object(u.h)("h5",{class:"mb-1 position-relative",style:"line-height: 1.0em; "+(D.offline?"text-decoration: line-through;":"")},W.public?Object(u.h)(t,null,Object(u.h)("a",{href:"/teams/public/"+W.uuidv4,onClick:function(t){return a.displayTeam(t,W.uuidv4)},class:"stretched-link"},s)):Object(u.h)(t,null,s),ot&&!W.public&&Object(u.h)("button",{type:"button",class:"btn btn-sm btn-link text-muted","data-id":D.id,onClick:this.toggleShowTeamSetting},Object(u.h)("i",{class:"fas fa-exclamation-triangle"}))),Object(u.h)("div",{class:"mb-2",style:D.offline?"text-decoration: line-through;":""},D.pinned&&Object(u.h)(t,null,Object(u.h)("small",{class:"text-muted mr-2"},Object(u.h)("i",{class:"fas fa-thumbtack"}))),2===D.type?Object(u.h)(t,null,Object(u.h)("small",{class:"text-muted"},Object(u.h)(f.c,{id:"story.sponsored"},"Sponsored")," -")):Object(u.h)(t,null,D.date&&Object(u.h)("small",{class:"text-muted",onClick:this.toggleDate},l?m.a.formatDate(D.date,{locale:"no-NB",hour12:!1,hour:"2-digit",minute:"2-digit"}):m.a.formatDistance(D.date,new Date,{locale:"no-NB"}))),1===D.public?Object(u.h)(t,null,Object(u.h)("small",{class:"ml-2 text-muted"},Object(u.h)("i",{class:"fas fa-globe-europe"}))):Object(u.h)(t,null,Object(u.h)("small",{class:"ml-2 text-muted"},Object(u.h)("i",{class:"fas fa-users"})," (",m.a.format(st),")")),o&&Object(u.h)(t,null,Object(u.h)("small",{class:"ml-2 text-muted"},n?Object(u.h)(t,null,Object(u.h)("i",{class:"fas fa-user"})," ",Object(u.h)("a",{href:n,onClick:function(t){return a.openInbox(t,X.uuidv4)}},o)):Object(u.h)(t,null,Object(u.h)("i",{class:"fas fa-user"})," ",o))),rt&&rt.formattedCounty&&Object(u.h)(t,null,Object(u.h)("small",{class:"ml-2 text-muted"},Object(u.h)("i",{class:"fas fa-map-marker-alt"})," ",rt.formattedCounty))),k&&q&&Object(u.h)("div",{class:"d-flex flex-row flex-nowrap bg-light border-top border-bottom py-2",style:"overflow: auto;"},Object(u.h)("small",{class:"text-muted mr-2"},"Adm:"),tt&&tt.length>0&&Object(u.h)(t,null,Object(u.h)("small",{class:"text-danger mr-2"},Object(u.h)("i",{class:"fas fa-flag"})," ",tt.length)),rt&&rt.formatted_address&&Object(u.h)(t,null,Object(u.h)("small",{class:"text-muted"},Object(u.h)("i",{class:"fas fa-map-marker-alt"})," ",rt.formatted_address)),X.deviceInfo&&Object(u.h)(t,null,Object(u.h)("span",{class:"badge badge-secondary ml-2 float-right font-weight-light"},["platform","manufacturer","model"].map((function(e){return Object(u.h)(t,null,Object(u.h)("span",{class:"ml-2 text-white"},X.deviceInfo[e]))})))),ct&&Object(u.h)(t,null,Object(u.h)("small",{class:"ml-2 text-muted"},"V: ",ct.count),Object(u.h)("small",{class:"ml-2 text-muted"},"R: ",ct.ranking," ",m.a.isNumber(ct.rankingTrend)&&Object(u.h)(t,null,Object(u.h)("i",{class:T.a.getClassForTrend(ct.rankingTrend)}))),Object(u.h)("small",{class:"ml-2 text-muted"},"D: ",m.a.format(ct.durationAvg/1e3,1),"s ",m.a.isNumber(ct.durationAvgTrend)&&Object(u.h)(t,null,Object(u.h)("i",{class:T.a.getClassForTrend(ct.durationAvgTrend)}))),D.statisticsCurrent&&D.statisticsCurrent.totalInteractions>0&&Object(u.h)("small",{class:"ml-2 text-muted"},"S: ",m.a.format(D.statisticsCurrent.totalInteractions,0)),D.shadowTags&&D.shadowTags.map((function(e){return Object(u.h)(t,null,Object(u.h)("span",{class:"badge badge-secondary ml-2 float-right font-weight-light"},e))})))))),b[D.id]||g[D.id]?Object(u.h)(t,null,Object(u.h)("div",{class:"row mt-2"},Object(u.h)("div",{class:"clearfix col-12",style:D.offline?"text-decoration: line-through;":""},b[D.id]&&Object(u.h)(t,null,Object(u.h)(R,{stores:this.props.stores,story:D,key:"story-edit-"+D.id,callback:this.doneEdit})),g[D.id]&&Object(u.h)("div",{class:"clearfix mt-3 mb-3"},Object(u.h)("button",{class:"btn btn-danger float-left",onClick:this.deleteStory,"data-id":D.id},Object(u.h)("i",{class:"fas fa-trash-alt"})," Delete"),Object(u.h)("button",{class:"btn btn-secondary float-right",onClick:this.toggleDeleteStory,"data-id":D.id},Object(u.h)("i",{class:"fas fa-times-circle"})," Cancel"))))):Object(u.h)(t,null,(!D.type||1==D.type)&&Object(u.h)(E,{stores:this.props.stores,story:D,key:"story-regular-view-"+D.id,likeStory:this.likeStory,likeRef:j,keys:y}),2==D.type&&Object(u.h)(A,{stores:this.props.stores,story:D,key:"story-ad-view-"+D.id,likeStory:this.likeStory,likeRef:j,keys:y}),3==D.type&&Object(u.h)(F,{stores:this.props.stores,story:D,key:"story-article-view-"+D.id,likeStory:this.likeStory,likeRef:j,keys:y}),Object(u.h)("div",{class:"d-flex justify-content-between mt-2"},Object(u.h)("div",{class:"mr-2"},Object(u.h)(S.a,{stores:this.props.stores,likes:H,comments:G,type:"story",onTeamClick:M,onUserClick:B})),lt>0&&Object(u.h)(t,null,Object(u.h)("div",null,Object(u.h)(C.a,{stores:this.props.stores,views:lt,object:D,type:"story",isTeamAdmin:Q,isAdmin:q,onTeamClick:M,onUserClick:B})))),O[D.id]&&Object(u.h)(t,null,Object(u.h)("small",null,Object(u.h)("div",{class:"alert alert-info",role:"alert"},Object(u.h)("span",{class:"display-4 float-left"},Object(u.h)("i",{class:"fas fa-exclamation-triangle mr-3 mb-3"})),Object(u.h)("p",null,Object(u.h)(f.c,{id:"story.alert-text-1"},"Your team is not visible and it's not possible to request friendship with your team.")),Object(u.h)("p",null,Object(u.h)(f.c,{id:"story.alert-text-2"},"If you want to make your team visible so other can request to follow your team, you can find the setting here:")),Object(u.h)("p",null,Object(u.h)("a",{href:"/teams/edit/"+W.id},Object(u.h)(f.c,{id:"story.alert-text-3"},"Edit team")))))),Object(u.h)("div",null,Object(u.h)("div",{class:"row"},Object(u.h)("div",{class:"col text-center"},Object(u.h)("button",{type:"button",class:"storyImage btn btn-sm btn-outline-"+(et?"primary":"secondary")+" btn-lg btn-block "+(et?"text-primary":"")+" text-overflow","data-id":D.id,onClick:this.likeStory},Object(u.h)("i",{class:(et?"text-primary fas":"far")+" fa-thumbs-up"})," ",et?Object(u.h)(f.c,{id:"comments.has-liked"},"Liked"):Object(u.h)(f.c,{id:"comments.like"},"Lik"))),Object(u.h)("div",{class:"col text-center"},Object(u.h)("button",{type:"button",class:"btn btn-sm btn-outline-secondary btn-block text-overflow","data-id":D.id,onClick:this.toggleAddComment},Object(u.h)("i",{class:"fas fa-comment"})," ",Object(u.h)(f.c,{id:"comments.comment-add"},"Kommentar"))),Z?Object(u.h)(t,null,Object(u.h)("div",{class:"col text-center"},Object(u.h)("button",{class:"btn btn-sm btn-outline-secondary btn-block text-overflow",onClick:this.shareLink,"data-url":"https://themusher.app/share/story/"+D.uuidv4,"data-title":"title: "+D.title},Object(u.h)("i",{class:"fas fa-share"})," ",Object(u.h)(f.c,{id:"story.share"},"Del")))):Object(u.h)(t,null,Object(u.h)("div",{class:"col text-center"},Object(u.h)("a",{class:"btn btn-sm btn-outline-secondary btn-block text-overflow",href:"https://themusher.app/share/story/"+D.uuidv4,target:"_blank",rel:"noreferrer","data-native":!0},Object(u.h)("i",{class:"fas fa-share"})," ",Object(u.h)(f.c,{id:"story.share"},"Del")))))),Object(u.h)("div",{class:"mt-2"},Object(u.h)(v.a,{stores:this.props.stores,story:D,col:"10",offset:"2",compact:!1,showAllComments:P,initCall:this.closeAllAddComments}),r[D.id]&&Object(u.h)(w.a,{stores:this.props.stores,story:D,inputRef:function(t){return a.inputRef[D.id]=t},inputRefObject:this.inputRef,col:"10",offset:"2",key:"story-comment-"+D.id}))))},s}(u.Component))||h;e.a=L}).call(this,s("hosL").Fragment)},P9Fo:function(t,e,s){"use strict";(function(t){var o,n=s("hosL"),a=s("Utv1"),i=s("/eY4"),r=(s("cneo"),s("OhSV")),l=s("fh8t"),c=s.n(l),d=(s("go65"),s("ZOvn")),h=Object(i.a)(o=function(e){function s(t){var s;return(s=e.call(this,t)||this).pollStory=function(t){return new Promise((function(e,o){var n,a,i;return n=s.props.storyId,a=s.props.stores.storyStore,i=t.target.closest("button").dataset.line,Promise.resolve(a.pollStory({id:n,line:i})).then((function(t){try{return t,e()}catch(t){return o(t)}}),o)}))},s.toggleResult=function(){s.setState({viewResult:!s.state.viewResult})},s.state={},s.inputRef={},s}var o,i;return i=e,(o=s).prototype=Object.create(i.prototype),o.prototype.constructor=o,o.__proto__=i,s.prototype.render=function(){var e=this,s=this.state.viewResult,o=this.props,i=o.story,l=o.opts,h=o.selectedImageIdx,u=this.props.stores,m=u.userStore.user,b=m.language,p=void 0===b?"en":b,f=o.content.split("\n").map((function(t){return t.trim().replace(/^\-\s*/g,"")})),g=i.polls&&i.polls.findIndex((function(t){return t.user===m.id}))>-1,O=i.polls?i.polls.length:0,j=0;f.forEach((function(t){var e=100*(i.polls?i.polls.filter((function(e){return e.line===d.a.md5(t)})).length/O:0);e>j&&(j=e)}));var y=l.days?parseInt(l.days,10):7,v=a.a.addDays(i.date,y),w=v<new Date,k=new RegExp(/{{img\./i);return Object(n.h)(t,null,Object(n.h)("div",{class:"w-100 my-4 storyPoll"},w||g||s?Object(n.h)(t,null,f&&f.map((function(e){var s=i.polls&&i.polls.findIndex((function(t){return t.user===m.id&&t.line===d.a.md5(e)}))>-1,o=(i.polls?i.polls.filter((function(t){return t.line===d.a.md5(e)})).length:0)/O*100;return Object(n.h)(t,null,Object(n.h)("div",{class:"progress position-relative my-2 ",style:"height: 1.5em; font-size: 1.3em;"},Object(n.h)("span",{class:"position-absolute",style:"right: 10px;"}," ",a.a.format(o||0,1),"%"),Object(n.h)("span",{class:"position-absolute",style:"left: 10px;"},Object(n.h)(c.a,{markdown:d.a.replaceImages(e+" "+(s?"<i class='fas fa-check-circle' />":""),i.images,p,!1),markdownOpts:d.a.getMarkdownOptions()})),Object(n.h)("div",{class:"progress-bar "+(j===o?"bg-primary":"bg-secondary"),role:"progressbar",style:"width: "+o+"%;","aria-valuenow":o,"aria-valuemin":"0","aria-valuemax":"100"})))})),Object(n.h)("div",{class:"w-100 mt-3 text-muted d-flex justify-content-start"},Object(n.h)("div",null,Object(n.h)("small",null,a.a.format(O,0)," ",1===O?Object(n.h)(r.c,{id:"story.poll"},"vote"):Object(n.h)(r.c,{id:"story.polls"},"votes"))),w?Object(n.h)(t,null,Object(n.h)("div",{class:"ml-2"},Object(n.h)("small",null,"- ",Object(n.h)(r.c,{id:"story.finished"},"Finished")))):Object(n.h)(t,null,Object(n.h)("div",{class:"ml-2"},Object(n.h)("small",null,"- ",a.a.formatDistance(v,new Date,{},{extended:!0})," ",Object(n.h)(r.c,{id:"story.left"},"left"))),!g&&Object(n.h)("div",{class:"ml-2",onClick:this.toggleResult},Object(n.h)("small",null,"- ",Object(n.h)(r.c,{id:"story.view-vote"},"View vote")))))):Object(n.h)(t,null,f&&f.map((function(s,o){return Object(n.h)(t,null,Object(n.h)("button",{class:"btn btn-block "+(k.test(s)&&o===h?"btn-outline-success":"btn-outline-primary")+" rounded-pill",onClick:e.pollStory,"data-line":d.a.md5(s)},k.test(s)&&o===h&&Object(n.h)("span",{class:"float-right"},Object(n.h)("i",{class:"fas fa-eye"})),Object(n.h)(c.a,{markdown:d.a.replaceImages(s,i.images,p,!1),markdownOpts:d.a.getMarkdownOptions()})))})),Object(n.h)("div",{class:"w-100 mt-3 text-muted d-flex justify-content-start"},Object(n.h)("div",null,Object(n.h)("small",null,a.a.format(O,0)," ",1===O?Object(n.h)(r.c,{id:"story.poll"},"vote"):Object(n.h)(r.c,{id:"story.polls"},"votes"))),w?Object(n.h)(t,null,Object(n.h)("div",{class:"ml-2"},Object(n.h)("small",null,"- ",Object(n.h)(r.c,{id:"story.finished"},"Finished")))):Object(n.h)(t,null,Object(n.h)("div",{class:"ml-2"},Object(n.h)("small",null,"- ",a.a.formatDistance(v,new Date,{},{extended:!0})," ",Object(n.h)(r.c,{id:"story.left"},"left")))),Object(n.h)("div",{class:"ml-2",onClick:this.toggleResult},Object(n.h)("small",null,"- ",Object(n.h)(r.c,{id:"story.view-results"},"View results")))))))},s}(n.Component))||o;e.a=h}).call(this,s("hosL").Fragment)}}]);
//# sourceMappingURL=23.chunk.8ceb1.js.map