(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{LOkn:function(e,t,a){"use strict";function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}a.r(t);var o,d,l,c=a("hosL"),p=(a("Utv1"),a("/eY4")),u=(a("cneo"),a("OhSV")),h=a("Y3FI"),f=(a("go65"),a("ZOvn")),b=a("om2D"),v=a("TiXY"),g=f.a.marginTop(!1),m=f.a.marginTopBack(!1),O=f.a.marginBottom(),j={isLoading:!1},w=Object(p.a)(o=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return(t=e.call.apply(e,[this].concat(n))||this).handleImageErrored=function(e){var t=e.target;t.onerror=null,setTimeout((function(){t.src+="?"+new Date}),1e3)},t.removeImage=function(e){return new Promise((function(a){return t.props.stores.newsStore.removeImage({id:t.props.news.id,name:e.target.parentElement.dataset.name||e.target.dataset.name}),a()}))},t.removeMainImage=function(){var e=t.props;(0,e.updateField)({id:e.news.id,field:e.field,value:{}})},t}return s(t,e),t.prototype.render=function(){var e=this,t=this.props,a=t.saved,n=t.news,i=t.type,r=void 0===i?"text":i,s=t.rows,o=t.field,d=t.title,l=t.icon,p=t.help,h=t.onInput,f=t.updateField,g=n[o];return"image"===r?Object(c.h)("div",{class:"form-group "+(a[o+"."+n.id]?"is-valid":"")},Object(c.h)("label",{for:o+"Input"},l&&Object(c.h)("i",{class:l+" text-muted"})," ",d),Object(c.h)("div",{class:"container-fluid"},Object(c.h)("div",{class:"row"},n.images&&n.images.map((function(t){return Object(c.h)("div",{class:"col-3 p-1"},Object(c.h)("img",{src:t.s3SmallLink,class:"img-fluid",onError:e.handleImageErrored}),Object(c.h)("button",{class:"btn btn-sm btn-link",onClick:e.removeImage,"data-name":t.name},Object(c.h)("i",{class:"fas fa-trash"})," Del"))})))),Object(c.h)(b.a,{saved:a,object:n,field:o,updateField:f,autoOpen:!1}),a[o+"."+n.id]?Object(c.h)("div",{class:"valid-feedback",style:"display: block;"},Object(c.h)(u.c,{id:"news.changes-saved"},"Endringene er lagret")):Object(c.h)("small",{id:o+"Help",class:"form-text text-muted"},p)):"file"===r?Object(c.h)("div",{class:"form-group "+(a[o+"."+n.id]?"is-valid":"")},Object(c.h)("label",{for:o+"Input"},l&&Object(c.h)("i",{class:l+" text-muted"})," ",d),Object(c.h)(v.a,{saved:a,object:n,field:o,updateField:f}),a[o+"."+n.id]?Object(c.h)("div",{class:"valid-feedback",style:"display: block;"},Object(c.h)(u.c,{id:"news.changes-saved"},"Endringene er lagret")):Object(c.h)("small",{id:o+"Help",class:"form-text text-muted"},p)):"textarea"===r?Object(c.h)("div",{class:"form-group "+(a[o+"."+n.id]?"is-valid":"")},Object(c.h)("label",{for:o+"Input"},l&&Object(c.h)("i",{class:l+" text-muted"})," ",d),Object(c.h)("textarea",{type:r,class:"form-control "+(a[o+"."+n.id]?"is-valid":""),id:o+"Input","aria-describedby":o+"Help",value:g,rows:s,"data-id":n.id,"data-field":o,onInput:h}),a[o+"."+n.id]?Object(c.h)("div",{class:"valid-feedback",style:"display: block;"},Object(c.h)(u.c,{id:"news.changes-saved"},"Endringene er lagret")):Object(c.h)("small",{id:o+"Help",class:"form-text text-muted"},p)):Object(c.h)("div",{class:"form-group "+(a[o+"."+n.id]?"is-valid":"")},Object(c.h)("label",{for:o+"Input"},l&&Object(c.h)("i",{class:l+" text-muted"})," ",d),Object(c.h)("input",{type:r,class:"form-control "+(a[o+"."+n.id]?"is-valid":""),id:o+"Input","aria-describedby":o+"Help",value:g,"data-id":n.id,"data-field":o,onInput:h}),a[o+"."+n.id]?Object(c.h)("div",{class:"valid-feedback",style:"display: block;"},Object(c.h)(u.c,{id:"news.changes-saved"},"Endringene er lagret")):Object(c.h)("small",{id:o+"Help",class:"form-text text-muted"},p))},t}(c.Component))||o,y=Object(p.a)(d=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return(t=e.call.apply(e,[this].concat(n))||this).onInput=function(e){t.props.stores.newsStore.updateObjectKeyValue("newNews",t.props.field,e.target.value)},t}return s(t,e),t.prototype.render=function(){var e=this.props,t=e.field,a=e.icon,n=e.title,i=e.help,r=this.props.stores.newsStore.newNews;return Object(c.h)("div",{class:"form-group"},Object(c.h)("label",{for:t+"Input"},a&&Object(c.h)("i",{class:a+" text-muted"})," ",n),Object(c.h)("input",{type:"text",class:"form-control",id:t+"Input","aria-describedby":t+"Help",onInput:this.onInput,value:r[t]}),Object(c.h)("small",{id:t+"Help",class:"form-text text-muted"},i))},t}(c.Component))||d,x=Object(p.a)(l=function(e){function t(t){var a;return(a=e.call(this,t)||this).updateField=function(e){var t=e.target.dataset,n=t.field,i=t.type,r=t.elementtype,s=e.target.value;a.updateFieldValue({id:parseInt(t.id,10),field:n,value:s,type:i,elementtype:r})},a.updateFieldValue=function(e){var t=e.id,n=e.field,i=e.value,r=e.datatype,s=e.elementtype,o=e.skipTimer,d=void 0!==o&&o,l=a.props.stores.newsStore,c=i,p=i,u=l.news;"images"===n&&Array.isArray(u.images)&&Array.isArray(i)&&(p=[].concat(u.images,i)),"array"!==r||Array.isArray(i)||(c="number"===s?i.split(",").map((function(e){return parseFloat(e)||e})):i.split(",")),l.updateField(t,n,p),d?a.doUpdateField(t,n,c):(clearTimeout(a.updateTimer[n]),a.updateTimer[n]=setTimeout((function(){return new Promise((function(e){return a.doUpdateField(t,n,c),e()}))}),500))},a.insertNewNews=function(){return new Promise((function(e){var t=a.props.stores.newsStore;return t.insert(i({},t.newNews)),e()}))},a.back=function(){var e=a.props.stores.newsStore.news;a.props.createNew?Object(h.route)("/news/"):Object(h.route)("/news/"+e.id)},a.state=i({},j),a.updateTimer={},a}s(t,e);var a=t.prototype;return a.loadNews=function(e){return new Promise(function(t,a){return void 0===e&&(e=this.props),this.setState({isLoading:!0}),Promise.resolve(this.props.stores.newsStore.load(e.id)).then((function(){try{return t()}catch(e){return a(e)}}),a)}.bind(this))},a.doUpdateField=function(e,t,a){return new Promise(function(n,i){return Promise.resolve(this.props.stores.newsStore.saveField(e,t,a)).then((function(){try{return n()}catch(e){return i(e)}}),i)}.bind(this))},a.componentDidMount=function(){this.loadNews()},a.render=function(){var e=this.props.createNew,t=this.props.stores,a=t.newsStore;if(!t.userStore.isAdmin)return"";var n=a.news,i=a.saved;return Object(c.h)("div",{class:"container-fluid",style:"margin-bottom: "+O+"; margin-top: "+g+";"},Object(c.h)("div",{class:"d-flex justify-content-between mb-2"},Object(c.h)("div",null,Object(c.h)("button",{class:"btn btn-link pl-0 fixed-top text-primary",style:"top: "+m+"; left: 5px; font-size: 35px; width: 45px;",onClick:this.back},Object(c.h)("i",{class:"fas fa-arrow-circle-left"}))),Object(c.h)("div",null,Object(c.h)("h5",{class:"text-muted"},"News and howto content")),Object(c.h)("div",null,"Â ")),e?Object(c.h)("div",{class:"row"},Object(c.h)("div",{class:"col-12"},Object(c.h)("h5",null,Object(c.h)(u.c,{id:"news.add-new"},"Lag nytt innhold")),Object(c.h)(y,{stores:this.props.stores,field:"title",icon:"fas fa-heading",title:Object(c.h)(u.c,{id:"news.title"},"Tittel"),help:Object(c.h)(u.c,{id:"news.title-help"},"Title of this news story")}),Object(c.h)(y,{stores:this.props.stores,field:"tag",icon:"fas fa-eye",title:Object(c.h)(u.c,{id:"news.tag"},"Tag"),help:Object(c.h)(u.c,{id:"news.tag-help"},"Tag of this news story"),onInput:this.updateField}),Object(c.h)("button",{type:"button",class:"btn btn-primary mb-2",onclick:this.insertNewNews},"Save news"))):Object(c.h)("div",{class:"row"},Object(c.h)("div",{class:"col-12"},Object(c.h)(w,{saved:i,news:n,field:"title",icon:"fas fa-heading",title:Object(c.h)(u.c,{id:"news.title"},"Title"),help:Object(c.h)(u.c,{id:"news.title-help"},"Title of this news story"),onInput:this.updateField}),Object(c.h)(w,{saved:i,news:n,field:"active",icon:"fas fa-heading",title:Object(c.h)(u.c,{id:"news.active"},"Active"),help:Object(c.h)(u.c,{id:"news.active-help"},"Is this active yet?"),onInput:this.updateField}),Object(c.h)(w,{saved:i,news:n,field:"tag",icon:"fas fa-heading",title:Object(c.h)(u.c,{id:"news.tag"},"Tag"),help:Object(c.h)(u.c,{id:"news.tag-help"},"Tag of this news story"),onInput:this.updateField}),Object(c.h)(w,{saved:i,news:n,field:"ingress",icon:"fas fa-quote-right",type:"textarea",title:Object(c.h)(u.c,{id:"news.ingress"},"Ingress"),help:Object(c.h)(u.c,{id:"news.ingress-help"},"Ingress of this news story"),onInput:this.updateField}),Object(c.h)(w,{saved:i,news:n,field:"body",icon:"fas fa-quote-right",type:"textarea",rows:20,title:Object(c.h)(u.c,{id:"news.body"},"Body"),help:Object(c.h)(u.c,{id:"news.body-help"},"Body of this news story"),onInput:this.updateField}),Object(c.h)(w,{saved:i,news:n,field:"image",type:"image",icon:"fas fa-camera",stores:this.props.stores,title:Object(c.h)(u.c,{id:"news.photo"},"Bilder"),help:Object(c.h)(u.c,{id:"news.photo-help"},"Images for this news story."),onInput:this.updateField,updateField:this.updateFieldValue}))))},t}(c.Component))||l;t.default=x},TiXY:function(e,t,a){"use strict";var n,i=a("hosL"),r=a("/eY4"),s=(a("cneo"),a("Utv1"),a("OhSV")),o=a("u2zT"),d=Object(r.a)(n=function(e){function t(t){var a;return(a=e.call(this,t)||this).handleAddImage=function(e){var t=a.props;(0,t.updateField)({id:t.object.id,field:t.field,value:e})},a.state={files:[]},a}var a,n;return n=e,(a=t).prototype=Object.create(n.prototype),a.prototype.constructor=a,a.__proto__=n,t.prototype.render=function(){var e=this.props,t=e.uploadStatus,a=void 0===t?function(){}:t,n=e.before,r=void 0===n?function(){}:n,d=e.after,l=void 0===d?function(){}:d,c=e.autoOpen,p=void 0!==c&&c;return Object(i.h)("div",{class:"row"},Object(i.h)("div",{class:"col-12"},Object(i.h)(s.c,{id:"form.files.upload-file"},"Last opp fil"),":",Object(i.h)("br",null),Object(i.h)(o.a,{handleAddImage:this.handleAddImage,apiUrl:"/api/fileupload",uploadStatus:a,before:r,after:l,autoOpen:p},Object(i.h)("div",{style:{height:30,width:"100%"}}))))},t}(i.Component))||n;t.a=d},om2D:function(e,t,a){"use strict";var n,i=a("hosL"),r=a("/eY4"),s=(a("cneo"),a("Utv1"),a("u2zT")),o=Object(r.a)(n=function(e){function t(t){var a;return(a=e.call(this,t)||this).handleAddImage=function(e){var t=a.props.addToImages,n=void 0===t||t,i=a.props,r=i.updateField,s=i.object,o=i.field;if(o&&r({id:s.id,field:o,value:e,skipTimer:!0}),n){var d=[];d.push(e),r({id:s.id,field:"images",value:d,skipTimer:!0})}},a.state={files:[]},a}var a,n;return n=e,(a=t).prototype=Object.create(n.prototype),a.prototype.constructor=a,a.__proto__=n,t.prototype.render=function(){var e=this.props,t=e.uploadStatus,a=void 0===t?function(){}:t,n=e.before,r=void 0===n?function(){}:n,o=e.after,d=void 0===o?function(){}:o,l=e.autoOpen,c=void 0===l||l;return Object(i.h)("div",{class:"row"},Object(i.h)("div",{class:"col-12"},Object(i.h)(s.a,{handleAddImage:this.handleAddImage,uploadStatus:a,apiUrl:"/api/fileupload",before:r,after:d,autoOpen:c},Object(i.h)("div",{style:{height:30,width:"100%"}}))))},t}(i.Component))||n;t.a=o},u2zT:function(e,t,a){"use strict";var n,i=a("hosL"),r=a("/eY4"),s=a("Utv1"),o=a("OhSV"),d=Object(r.a)(n=function(e){function t(t){var a;return(a=e.call(this,t)||this).dropRef=Object(i.createRef)(),a.handleDrag=function(e){e.preventDefault(),e.stopPropagation()},a.handleDragIn=function(e){e.preventDefault(),e.stopPropagation(),a.dragCounter++,e.dataTransfer.items&&e.dataTransfer.items.length>0&&a.setState({drag:!0})},a.handleDragOut=function(e){e.preventDefault(),e.stopPropagation(),a.dragCounter--,0===a.dragCounter&&a.setState({drag:!1})},a.handleDrop=function(e){if(e.preventDefault(),e.stopPropagation(),a.setState({drag:!1}),e.dataTransfer.files&&e.dataTransfer.files.length>0){for(var t=0,n=e.dataTransfer.files.length;t<n;t+=1){a.readLocalFile(e.dataTransfer.files[t])}a.dragCounter=0}},a.handleAddFiles=function(e){e.preventDefault();var t=e.target;for(var n=0,i=t.files.length;n<i;n+=1){a.readLocalFile(t.files[n])}},a.handleEvent=function(){0},a.handleUpload=function(e){var t=a.props,n=t.uploadStatus,i=t.before,r=void 0===i?function(){}:i,o=t.after,d=void 0===o?function(){}:o;(void 0===n?function(){}:n)(!1),s.a.isFunction(r)&&r();var l=new FormData;l.append("files[]",e);var c={progress:1};c.xhr=new XMLHttpRequest,c.xhr.upload.addEventListener("progress",(function(t){a.updateProgress(t,e)})),c.xhr.addEventListener("loadstart",(function(t){a.handleEvent(t,e)})),c.xhr.addEventListener("load",(function(t){a.handleEvent(t,e)})),c.xhr.addEventListener("loadend",(function(t){var n=e;s.a.isFunction(d)&&d(),a.handleEvent(t,n)})),c.xhr.addEventListener("progress",(function(t){a.handleEvent(t,e)})),c.xhr.addEventListener("error",(function(t){a.handleEvent(t,e)})),c.xhr.addEventListener("abort",(function(t){a.handleEvent(t,e)})),c.xhr.addEventListener("readystatechange",(function(t){a.uploadDone(t,e)})),c.xhr.open("POST",""+s.a.getApiServer()+a.props.apiUrl),c.xhr.setRequestHeader("Authorization","Bearer "+s.a.getJwtToken()),c.xhr.send(l);var p=e.name,u=a.state.uploadedFilesData;u[p]||(u[p]={}),u[p].uploadMeta=c,u[p].imageNum=a.state.imageNum,a.setState({uploadedFilesData:u})},a.readLocalFile=function(e){return new Promise((function(t,n){var i=new FileReader;i.addEventListener("error",(function(e){n(e)})),i.addEventListener("load",(function(n){var i=e,r=i.name,s=a.state.uploadedFilesData;s[r]||(s[r]={}),s[r].event=n,a.setState({uploadedFilesData:s}),a.handleUpload(i),t(n)})),i.readAsDataURL(e)}))},a.updateProgress=function(e,t){if(e.lengthComputable){var n=t.name,i=a.state.uploadedFilesData,r=e.loaded/e.total*100;0,i[n].uploadMeta.progress=r,a.setState({uploadedFilesData:i})}},a.uploadDone=function(e,t){var n=t.name,i=a.state.uploadedFilesData,r=i[n].uploadMeta;if(r&&4===r.xhr.readyState&&201===r.xhr.status)for(var s=JSON.parse(r.xhr.responseText).data.files,o=0;o<s.length;o+=1){a.addFileToUpload(s[o]),a.fileInput.value=""}},a.state={drag:!1,loadingProgress:0,uploadedFiles:[],uploadedFilesData:{}},a}var a,n;n=e,(a=t).prototype=Object.create(n.prototype),a.prototype.constructor=a,a.__proto__=n;var r=t.prototype;return r.addFileToUpload=function(e){var t=this.state.uploadedFilesData,a=this.props,n=a.handleAddImage,i=a.uploadStatus,r=void 0===i?function(){}:i;delete t[e.name],this.setState({uploadedFilesData:t}),n(e),r(!0)},r.componentDidMount=function(){var e=this,t=this.dropRef.current;t.addEventListener("dragenter",this.handleDragIn),t.addEventListener("dragleave",this.handleDragOut),t.addEventListener("dragover",this.handleDrag),t.addEventListener("drop",this.handleDrop),this.props.autoOpen&&setTimeout((function(){e.fileInput.click()}),10)},r.componentWillUnmount=function(){var e=this.dropRef.current;e.removeEventListener("dragenter",this.handleDragIn),e.removeEventListener("dragleave",this.handleDragOut),e.removeEventListener("dragover",this.handleDrag),e.removeEventListener("drop",this.handleDrop)},r.render=function(){var e=this,t=this.state.uploadedFilesData;return Object(i.h)("div",{style:{position:"relative"},ref:this.dropRef},this.state.drag&&Object(i.h)("div",{style:{border:"dashed grey 4px",backgroundColor:"rgba(255,255,255,.8)",position:"absolute",top:0,bottom:0,left:0,right:0,zIndex:9999}},Object(i.h)("div",{style:{position:"absolute",top:"50%",right:0,left:0,textAlign:"center",color:"grey",fontSize:36}},Object(i.h)("div",null,Object(i.h)(o.c,{id:"imageupload.drag-files-here"},"drop your files here :)")))),Object(i.h)("div",null,Object(i.h)("input",{class:"btn btn-info col-sm-12",multiple:!0,type:"file",id:"image-file",onchange:this.handleAddFiles,ref:function(t){e.fileInput=t}})),Object(i.h)("div",null,Object.keys(t).length>0?Object(i.h)("h3",null,Object(i.h)(o.c,{id:"imageupload.upload-images"},"Uploaded images")):"",Object(i.h)("ul",{class:"list-group"},Object.keys(t).map((function(e){var a=t[e].uploadMeta,n=void 0===a?{}:a,r=e.match(/(jpg|jpeg|png|gif|heic|heif|svg|webp|tif)/i);return Object(i.h)("li",{class:"list-group-item list-group-item-action flex-column align-items-start"},Object(i.h)("div",{class:"d-flex w-100 justify-content-between"},r&&Object(i.h)("img",{class:"img-fluid mr-3",src:t[e].event.target.result,style:"max-height: 50px;"}),Object(i.h)("small",null,t[e].event.uploadDone),Object(i.h)(o.c,{id:"imageupload.uploading-image"},"Laster opp bilde..."),Object(i.h)("small",null,s.a.formatBytes(t[e].event.total,2))),Object(i.h)("div",{class:"progress mt-1",style:"height: 4px;"},Object(i.h)("div",{class:"progress-bar progress-bar-striped progress-bar-animated bg-success",role:"progressbar",style:"width: "+n.progress+"%; height: 4px;","aria-valuenow":n.progress,"aria-valuemin":"0","aria-valuemax":"100"})))})))),this.props.children)},t}(i.Component))||n;t.a=d}}]);
//# sourceMappingURL=34.chunk.39a80.js.map