(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{"5OWT":function(t){t.exports={hoverelementonly:"hoverelementonly__4nHll",hoverElement:"hoverElement__rkj2s",hoverelementhide:"hoverelementhide__10QkM"}},Eo9z:function(t,e,n){"use strict";n.r(e),function(t){function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function i(t,e){var n=void 0!==t.musher;return(void 0!==e.musher)-n||!0===n&&t.musher.bib-e.musher.bib||0}var l,c,u,d=n("hosL"),h=n("Utv1"),b=n("/eY4"),f=n("OhSV"),m=n("fh8t"),p=n.n(m),O=n("ZOvn"),g=n("ZQlJ"),j=(n("q/oJ"),n("gWxU"),n("Nanz"),n("5OWT"),O.a.marginTop(!0)),v=O.a.marginBottom(),y={isLoading:!1,contentIsNotLoaded:!0,reloadInSec:null,reloadLastEpoch:null,reloadIsActive:!1},w=(Object(b.a)(l=function(e){function n(t){var n;return(n=e.call(this,t)||this).initComponent=function(){var t=Math.floor((new Date).getTime()/1e3);n.setState({reloadIsActive:!0,reloadLastEpoch:t},(function(){return n.tickReloadTimeer()}))},n.state=o({},y),n.updateTimer={},n}a(n,e);var r=n.prototype;return r.tickReloadTimeer=function(){var t=this,e=this.state,n=e.reloadLastEpoch;if(e.reloadIsActive){var r=Math.floor((new Date).getTime()/1e3);this.setState({reloadInSec:60-(r-n)}),clearTimeout(this.updateTimer.tick),this.updateTimer.tick=setTimeout((function(){return t.tickReloadTimeer()}),1e3)}return!1},r.componentDidMount=function(){this.initComponent()},r.componentWillUnmount=function(){clearTimeout(this.updateTimer.tick)},r.render=function(){var e=Math.floor(h.a.normalizeBetween(this.state.reloadInSec,0,60,0,100));return Object(d.h)(t,null,Object(d.h)("div",{class:"progress fixed-top",style:"height: 2px; z-index: 999999;"},Object(d.h)("div",{class:"progress-bar",role:"progressbar",style:"width: "+e+"%;","aria-valuenow":e,"aria-valuemin":"0","aria-valuemax":"100"})))},n}(d.Component)),Object(b.a)(c=function(e){function n(t){var n;return(n=e.call(this,t)||this).toggleAdminInfo=function(t){t.stopPropagation(),n.setState({showAdminInfo:!n.state.showAdminInfo})},n.toggleInfo=function(t){t.stopPropagation(),n.setState({showInfo:!n.state.showInfo})},n.state={},n}return a(n,e),n.prototype.render=function(){var e=this.state,n=e.showAdminInfo,r=e.showInfo,o=this.props,s=o.classid,a=o.bib,i=o.email,l=o.onTeamClick,c=o.onDogClick,u=this.props.stores,b=u.raceStore,m=u.userStore.isAdmin,j=a?b.getMusherByBibId(a):b.getMusherByBibEmail(i),v=b.getTeamById(j.team),y=v.members?v.members.find((function(t){return t.email===j.email})):{},w=b.getClassById(s),x=b.getTotalsByTeamId(j.team),k=O.a.getImage({user:y,team:v,priority:"user"}),T=O.a.displayNameShort(y)||O.a.displayNameShort(j),S=O.a.getRankingColor(j.bib);return Object(d.h)(t,null,Object(d.h)("div",{class:"d-flex position-relative"},Object(d.h)("div",{class:"position-relative text-center border rounded-circle imageRounded imageRoundedMedium",style:k?'background-image: url("'+k+'"); background-size: cover;':""},!k&&Object(d.h)("div",{class:"text-muted",style:"font-size: 25px; padding-top: 5px;"},T),Object(d.h)("div",{class:"rounded-pill-both px-2 text-center position-absolute "+(S?"":"bg-secondary")+" font-weight-bold",style:"bottom: -20px; right: 0; "+(S?"background-color: "+S+";":"")},j.bib&&"n/a"!==j.bib&&Object(d.h)(t,null,j.bib))),Object(d.h)("div",{class:"flex-grow-1 pl-3 text-overflow mb-3",style:"line-height: 1.2em;"},Object(d.h)("h6",{class:"font-weight-light mb-0"},w.title),Object(d.h)("h3",{class:"mb-0"},j.flag," ",j.firstname," ",j.lastname),Object(d.h)("h6",{class:"mb-0"},j.sportsClub))),v.public>0&&Object(d.h)(t,null,r?Object(d.h)(t,null,Object(d.h)("button",{class:"btn btn-link float-right",onClick:this.toggleInfo},Object(d.h)("i",{class:"fas fa-angle-up"})," ",Object(d.h)(f.c,{id:"races.hide-info"},"Hide info"))):Object(d.h)(t,null,Object(d.h)("button",{class:"btn btn-link float-right",onClick:this.toggleInfo},Object(d.h)("i",{class:"fas fa-angle-down"})," ",Object(d.h)(f.c,{id:"races.show-info"},"Show info"))),Object(d.h)("h3",null,v.public?Object(d.h)(t,null,Object(d.h)("a",{href:"/teams/public/"+v.uuidv4,onClick:function(t){return l(t,v.uuidv4)}},v.name)):Object(d.h)(t,null,v.name)),r&&Object(d.h)(t,null,Object(d.h)(p.a,{markdown:O.a.replaceImages(v.description,v.images),markdownOpts:O.a.getMarkdownOptions()})),v.dogs&&Object(d.h)("div",{class:"w-100 container-fluid"},Object(d.h)("div",{class:"row pt-2"},Object(d.h)(g.a,{stores:this.props.stores,dogs:v.dogs.map((function(t){return t.id})),allDogs:v.dogs,onDogClick:c})))),x&&x.distanceKm&&Object(d.h)(t,null,Object(d.h)("div",{class:"table-responsive-lg"},Object(d.h)("table",{class:"table table-borderless"},Object(d.h)("tbody",null,Object(d.h)("tr",null,Object(d.h)("td",{style:"width: 5%;"},Object(d.h)("i",{class:"fas fa-dog"})),Object(d.h)("td",{style:"width: 60%"},Object(d.h)(f.c,{id:"races.dogs"},"Dogs")),Object(d.h)("td",{style:"width: 5%;"}," "),Object(d.h)("td",{class:"text-right",style:"width: 30%;"},v.dogs.length)),Object(d.h)("tr",null,Object(d.h)("td",null,Object(d.h)("i",{class:"fas fa-road"})),Object(d.h)("td",null,Object(d.h)(f.c,{id:"races.distance"},"Distance")),Object(d.h)("td",null," "),Object(d.h)("td",{class:"text-right"},Object(d.h)("nobr",null,x.distanceKm?h.a.format(x.distanceKm,1)+" km":"n/a"))),Object(d.h)("tr",null,Object(d.h)("td",null,Object(d.h)("i",{class:"fas fa-mountain"})),Object(d.h)("td",null,Object(d.h)(f.c,{id:"races.ascend"},"Ascending")),Object(d.h)("td",null," "),Object(d.h)("td",{class:"text-right"},Object(d.h)("nobr",null,x.elevation?h.a.format(x.elevation,0)+" m":"n/a"))),Object(d.h)("tr",null,Object(d.h)("td",null,Object(d.h)("i",{class:"fas fa-stopwatch"})),Object(d.h)("td",null,Object(d.h)(f.c,{id:"races.race-time"},"Racetime")),Object(d.h)("td",null,Object(d.h)("i",{class:"fas fa-clock"})),Object(d.h)("td",{class:"text-right"},Object(d.h)("nobr",null,h.a.secToHms(x.duration)||"n/a"))),Object(d.h)("tr",null,Object(d.h)("td",null,Object(d.h)("i",{class:"fas fa-bed"})),Object(d.h)("td",null,Object(d.h)(f.c,{id:"races.rest-time"},"Rest")),Object(d.h)("td",null,Object(d.h)("i",{class:"fas fa-clock"})),Object(d.h)("td",{class:"text-right"},Object(d.h)("nobr",null,h.a.secToHms(x.rest)||"n/a"))))))),m&&Object(d.h)("div",{style:"max-height: 200px; max-width: 70vw; overflow: auto;"},Object(d.h)("button",{class:"btn btn-link btn-block",onClick:this.toggleAdminInfo},"Toggle admin info"),n&&Object(d.h)(t,null,Object(d.h)("small",null,Object(d.h)("xmp",null,JSON.stringify(j,null,4),JSON.stringify(y,null,4),JSON.stringify(v,null,4),JSON.stringify(x,null,4))))))},n}(d.Component)),Object(b.a)(u=function(e){function n(t){var n;return(n=e.call(this,t)||this).loadLiveRaceResults=function(t,e,r){return new Promise((function(o,s){var a;return void 0===t&&(t=n.props),a=t.stores.raceStore,Promise.resolve(a.getRaceTrackerData(a.race.raceTrackerRace)).then((function(){try{return a.getRaceTrackerActiveTeams(e,r),o()}catch(t){return s(t)}}),s)}))},n.loadRaceResults=function(t,e,r){return new Promise((function(o,s){var a;return void 0===t&&(t=n.props),a=t.stores.raceStore,Promise.resolve(a.loadWorkoutSummary(e,t.raceid)).then((function(){try{return a.getWorkoutSummaryActiveTeams(e,r),o()}catch(t){return s(t)}}),s)}))},n.loadRace=function(t){return new Promise((function(e,r){var o,s,a,i,l,c,u,d,h,b,f,m;return void 0===t&&(t=n.props),n.setState({isLoading:!0}),s=(o=t.stores).raceStore,a=o.appState,l=(i=t).classid,Promise.resolve(s.load(i.raceid)).then(function(){try{if(c=s.race,u=a.focusOnMushers,h=void 0===(d=a.selectedClassIds)?[]:d,b=l||h[0],l&&a.toggleSelectedClassId(l,!0),(f=c.classes.filter((function(t){return t.id===b})).filter((function(t){return t.contestants&&t.contestants.length>0})).map((function(t){return t.contestants.filter((function(t){return t.team>0})).map((function(t){return t.team}))})).flat()).length>0)return Promise.resolve(s.loadTeams(f.join(","))).then(function(){try{return o.call(this)}catch(t){return r(t)}}.bind(this),r);function o(){function o(){return s.getAllClassesSortedBy(),(m=s.getClassById(b))&&m.raceTrackerResults&&s.getRacetrackerResults(m.raceTrackerResults),clearTimeout(n.updateTimer.reload),n.updateTimer.reload=setTimeout((function(){return new Promise((function(e){var r=Math.floor((new Date).getTime()/1e3);return n.setState({reloadLastEpoch:r}),n.loadRace(t),e()}))}),6e4),n.setState({isLoading:!1}),e()}return c.liveRace>0?Promise.resolve(n.loadLiveRaceResults(n.props,f,u)).then(function(){try{return o.call(this)}catch(t){return r(t)}}.bind(this),r):Promise.resolve(n.loadRaceResults(n.props,f,u)).then(function(){try{return o.call(this)}catch(t){return r(t)}}.bind(this),r)}return o.call(this)}catch(t){return r(t)}}.bind(this),r)}))},n.toggleFocusOnMusher=function(t){var e=n.props.stores,r=e.appState,o=e.raceStore;r.toggleFocusOnMusher(t.target.parentElement.dataset.musherid||t.target.dataset.musherid);var s=r.focusOnMushers;o.race.liveRace>0?o.getRaceTrackerActiveTeams(null,s):o.getWorkoutSummaryActiveTeams(null,s)},n.handleMusherClick=function(t){var e=t.target.closest("tr").dataset.bib;n.setState({showModal:!n.state.showModal,modalBib:e})},n.toggleModal=function(){n.setState({showModal:!n.state.showModal})},n.state=o({},y),n.inputRef={},n.updateTimer={},n}a(n,e);var r=n.prototype;return r.componentWillUnmount=function(){clearTimeout(this.updateTimer.reload),clearTimeout(this.updateTimer.tick)},r.componentDidMount=function(){this.loadRace()},r.componentWillReceiveProps=function(t){this.props.classid!==t.classid&&this.loadRace(t)},r.render=function(){var e=this.state,n=e.modalBib,r=e.modalEmail,o=this.props.stores,s=o.raceStore,a=this.props,l=a.classid,c=a.limit,u=void 0===c?100:c,b=s.race,f=void 0===b?{}:b,m=s.classes,p=void 0===m?[]:m,g=s.raceTrackerResults,y=new Date(f.endDate);y.setHours(y.getHours()+2);var w=f.classes&&f.classes.find((function(t){return t.id===l}))||{},x=n?s.getMusherByBibId(n):s.getMusherByBibEmail(r),k=(s.getTeamById(x.team),[]);return g&&g.data?k=g.data.map((function(t){var e=s.raceTrackerMapLine(t),n=parseInt(e.Bib,10),r={};return p&&p[w.id].contestants&&(r=p[w.id].contestants.find((function(t){return t.musher.bib===n}))||{}),r})):p[w.id]&&p[w.id].contestants&&(k=p[w.id].contestants.sort(i).slice(0,u).map((function(t){return t}))),Object(d.h)(t,null,Object(d.h)("div",{class:"container-fluid",style:"margin-bottom: "+v+"; height: calc(100% - "+v+" - "+j+");"},Object(d.h)("div",{class:"row"},Object(d.h)("div",{class:"col-12 px-0 position-relative",style:"font-size: 1.5em; line-height: 1.0em;"},Object(d.h)("div",{class:"w-100 overflow-hidden"},Object(d.h)("div",{class:"d-flex flex-row flex-nowrap pb-2 px-1",style:"overflow: auto; scroll-snap-type: x mandatory;"},f.classes&&f.classes.sort((function(t,e){return t.distance-e.distance})).map((function(e,n){return Object(d.h)(t,null,Object(d.h)("div",{class:"col px-0 pt-2"},Object(d.h)("a",{type:"button",class:"btn btn-block "+(0===n&&"rounded-pill-left")+" "+(n===f.classes.length-1&&"rounded-pill-right")+" rounded-none "+(e.id===l?"btn-primary":"btn-outline-primary")+" text-nowrap",style:"text-overflow: ellipsis; overflow: hidden;","data-id":e.id,href:"/embed/agreement/"+f.id+"/"+e.id},e.title)))})))),Object(d.h)("table",{class:"table table-striped table-bordered"},Object(d.h)("thead",null,Object(d.h)("tr",null,Object(d.h)("td",{colspan:"2",class:"px-4 py-4 overflow-hidden",style:"border-radius: 10px 0 0 0; font-size: 1.4em;"},Object(d.h)("nobr",null,w.title)),Object(d.h)("td",{class:"px-3 text-center py-4 overflow-hidden",style:"border-radius: 0 10px 0 0 ; font-size: 1.1em;"},"Agreement"))),Object(d.h)("tbody",null,k&&k.map((function(e,n){var r=e.musher,o=void 0===r?{}:r,a=e.currentTeam;s.getTotalsByTeamId((void 0===a?{}:a).id);return Object(d.h)(t,null,Object(d.h)("tr",{style:"border-bottom: 1px solid #7B312F;"},Object(d.h)("td",{class:"text-center align-middle ml-0 pl-0",style:"width: 50px; color: #ffffff; font-size: 1.2em; line-height: 1.2em;"},Object(d.h)("div",{class:"d-flex justify-content-start"},Object(d.h)("div",{class:"pl-3 pr-2 w-100 clearfix rounded-pill-right",style:"background-color: "+O.a.getRankingColor(n+1)},o.bib||n+1))),Object(d.h)("td",{class:"px-3 py-3",style:"font-size: 1.2em;"},Object(d.h)("nobr",null,o.flag," ",o.firstname," ",o.lastname,Object(d.h)("br",null)),Object(d.h)("small",null,o.cellphone,Object(d.h)("br",null),o.address,Object(d.h)("br",null),o.postalcode,Object(d.h)("br",null),o.postalplace,Object(d.h)("br",null),o.country,Object(d.h)("br",null))),Object(d.h)("td",{class:"text-center align-middle",style:"width: 150px; font-size: 1.2em;"},o.declaration&&Object(d.h)(t,null,Object(d.h)("nobr",null,Object(d.h)("i",{class:"fas fa-check text-success"})," ",h.a.isoDate(o.declarationDate))))))}))))))))},n}(d.Component))||u);e.default=w}.call(this,n("hosL").Fragment)},ZQlJ:function(t,e,n){"use strict";var r,o=n("hosL"),s=(n("Utv1"),n("/eY4")),a=(n("OhSV"),n("NDEG")),i=Object(s.a)(r=function(t){function e(e){var n;return(n=t.call(this,e)||this).scrollImages=function(t){var e=t.target,r=e.scrollLeft/e.clientWidth,o=Math.round(r),s=Math.abs(o-r);(Number.isInteger(r)||s<.1)&&n.setState({imageIdx:o})},n.sortByName=function(t,e){var r=n.props.allDogs,o=void 0===r?[]:r,s=o.find((function(e){return e.id===t})),a=o.find((function(t){return t.id===e}));return s&&a&&s.name>a.name?1:-1},n.state={imageIdx:0},n}var n,r;return r=t,(n=e).prototype=Object.create(r.prototype),n.prototype.constructor=n,n.__proto__=r,e.prototype.render=function(){var t=this,e=this.props,n=e.dogs,r=e.allDogs,s=void 0===r?[]:r,i=e.size,l=void 0===i?"medium":i,c=e.onDogClick,u=void 0===c?function(){}:c;return Object(o.h)("div",{class:"w-100"},Object(o.h)("div",{class:"d-flex flex-row flex-nowrap",style:"overflow: auto; scroll-snap-type: x mandatory;",onScroll:this.scrollImages},n&&n.sort(this.sortByName).map((function(e){var r=s.find((function(t){return t.id===e}));return r?Object(o.h)("div",{class:"col clearfix position-relative p-0 mx-2"},Object(o.h)("div",{class:"w-100 h-100 text-center rounded-lg imageContainer d-flex justify-content-center align-items-center",style:"\n                                        flex-wrap: wrap;\n                                        overflow-y: hidden;\n                                    ",onTouchstart:function(t){t.stopPropagation()},onTouchend:function(t){t.stopPropagation()},onTouchmove:function(t){t.stopPropagation()}},Object(o.h)(a.a,{stores:t.props.stores,dog:r,dogs:s.filter((function(t){return n.indexOf(t.id)>-1})).sort((function(t,e){return t.name>e.name?1:-1})),className:"mx-auto",showName:!0,showPosition:!1,size:l,onDogClick:u}))):""}))))},e}(o.Component))||r;e.a=i}}]);
//# sourceMappingURL=80.chunk.4f5ab.js.map