(window.webpackJsonp=window.webpackJsonp||[]).push([[47,12,21],{"/DnB":function(t,e,s){"use strict";function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function i(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var l,c=s("hosL"),o=(s("Utv1"),s("/eY4"));const n={};let r=Object(o.a)(l=class extends c.Component{constructor(t){super(t),this.state=function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){i(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},n),this.container=null}componentDidMount(){const{horizontal:t,vertical:e=""}=this.props,s={behavior:"smooth"};t&&(s.inline=t),e&&(s.block=e),this.container.scrollIntoView(s)}render(){return Object(c.h)("div",{ref:t=>this.container=t}," ")}})||l;e.a=r},"1OK2":function(t,e,s){"use strict";var a,i=s("hosL"),l=(s("Utv1"),s("/eY4"));Object(l.a)(a=class extends i.Component{constructor(t){super(t),this.touchStart=t=>{t.stopPropagation(),this.setState({startX:t.touches[0].pageX})},this.touchEnd=t=>{t.stopPropagation(),this.setState({startX:void 0,sliding:!1})},this.touchMove=t=>{t.stopPropagation();const{totalImages:e}=this.state;if(e>1){const{startX:e,sliding:s}=this.state,a=50,i=t.touches[0].pageX;s||(i>e+a?(this.setState({sliding:!0}),this.prevImage()):i<e-a&&(this.setState({sliding:!0}),this.nextImage()))}};const{images:e=[]}=t;this.state={imageContainer:1,currentImage1:e[0]||{},currentImage2:{},currentIdx:0,totalImages:e.length||0,imageDots:[...Array(e.length||0).fill(1).map((t,e)=>t+e)]}}nextImage(){const{images:t}=this.props,{totalImages:e,currentIdx:s,imageContainer:a}=this.state,i=1===a?2:1;let l=s+1;l>e-1&&(l=0),this.setState({["currentImage"+i]:t[l],currentIdx:l,imageContainer:i})}prevImage(){const{images:t}=this.props,{totalImages:e,currentIdx:s,imageContainer:a}=this.state;let i=s-1;i<0&&(i=e-1),this.setState({["currentImage"+(1===a?2:1)]:t[i],currentIdx:i,imageContainer:1===a?2:1})}componentWillReceiveProps(t){if(t.images!==this.props.images){const{images:e=[]}=t;this.setState({imageContainer:1,currentImage1:e.length>0?e[0]:{},currentImage2:{},currentIdx:0,totalImages:e.length||0,imageDots:[...Array(e.length||0).fill(1).map((t,e)=>t+e)]})}}render(){const{currentImage1:t,currentImage2:e,imageContainer:s,totalImages:a,imageDots:l,currentIdx:c}=this.state,o=this["image"+s],n=1===s?t:e,r=o&&o.height?o.width/o.height:4/3;let d,h;if(n.dimensions){const{width:t,height:e,orientation:s}=n.dimensions;s>4&&s<9?(d=t,h=e):(d=e,h=t)}const b=n.dimensions?h/d:r;return a<=0?"":Object(i.h)("div",{class:"w-100"},Object(i.h)("div",{class:"border rounded position-relative w-100",style:`height: calc(85vw / ${b}); overflow: hidden; transition: all .3s ease-in-out;`,onTouchstart:this.touchStart,onTouchend:this.touchEnd,onTouchmove:this.touchMove},a>1&&Object(i.h)("span",{class:"position-absolute",style:"top:0px; right: 5px; z-index: 2000;"},Object(i.h)("small",null,c+1,"/",a)),t&&Object(i.h)("div",{class:"position-absolute",style:(1===s?"opacity: 1;":"opacity: 0;")+" transition: all .3s ease-in-out; top: 0; left: 0;"},Object(i.h)("img",{loading:"lazy",src:t.s3LargeLink,class:"img-fluid align-middle",ref:t=>this.image1=t})),e&&Object(i.h)("div",{class:"position-absolute",style:(2===s?"opacity: 1;":"opacity: 0;")+" transition: all .3s ease-in-out; top: 0; left: 0;"},Object(i.h)("img",{loading:"lazy",src:e.s3LargeLink,class:"img-fluid align-middle",ref:t=>this.image2=t}))),l.length>1&&Object(i.h)("div",{class:"w-100 text-center"},l.map(t=>Object(i.h)("span",{style:`color: ${t===c+1?"#ffffff":"#808080"};`},"•"))))}})},"4QWe":function(t,e,s){"use strict";(function(t){var a,i=s("hosL"),l=s("Utv1"),c=s("/eY4"),o=s("OhSV"),n=s("go65"),r=s("om2D"),d=s("ZOvn");let h=Object(c.a)(a=class extends i.Component{constructor(t){var e;super(t),e=this,this.beforeImagesUploaded=()=>{this.setState({sendButtonEnabled:!1})},this.afterImagesUploaded=()=>{this.setState({sendButtonEnabled:!0})},this.commentStory=async function(){const{sendButtonEnabled:t}=e.state;if(!t)return!1;const{callback:s=(()=>{}),inputRefObject:a={}}=e.props,{story:i}=e.props,{storyStore:l}=e.props.stores,{comment:c,showAddImage:o}=e.state;e.setState({sendButtonEnabled:!1});const n=await l.commentStory({id:i.id,comment:c});n&&200===n.status&&(e.setState({comment:{body:"",images:[]}},()=>{d.a.resizeTextarea(a[i.id]),o&&e.addImage()}),s({story:i,response:n})),e.setState({sendButtonEnabled:!0})},this.addImages=({value:t})=>{const{comment:e}=this.state;e.images.push(...t),this.setState({comment:e})},this.addImage=()=>{const{showAddImage:t=!1}=this.state;this.setState({showAddImage:!t})},this.handleImageErrored=t=>{const e=t.target;e.onerror=null,setTimeout(()=>{e.src+="?"+new Date},1e3)},this.state={comment:{body:"",images:[]},showAddImage:!1,sendButtonEnabled:!0},this.inputRef={}}render(){const{inputRef:e,story:s}=this.props,{comment:a,showAddImage:c,sendButtonEnabled:h}=this.state,{userStore:b}=this.props.stores,{user:m={}}=b,p=d.a.displayNameShort(m),u=(d.a.displayName(m),m.image||(m.images?m.images[0]:void 0));return Object(i.h)("div",null,Object(i.h)("div",{class:"d-flex mb-0 position-relative w-100"},Object(i.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall",style:(u?`background-image: url('${u.s3SmallLink}'); background-size: cover;`:"")+" border-width: 3px !important;"},!m.image&&Object(i.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},p)),Object(i.h)("div",{class:"col pl-3",style:"line-height: 1.2em;"},Object(i.h)("div",{class:"d-flex bd-highlight"},Object(i.h)("div",{class:"p-0 w-100 bd-highlight"},Object(i.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(i.h)(o.c,{id:"comments.comment"},"Kommentar")),Object(i.h)("div",{class:"border rounded rounded-lg position-relative"},Object(i.h)(o.b,null,Object(i.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(i.h)(o.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(n.a)(this,"comment.body"),onKeyUp:d.a.resizeTextarea,onFocus:d.a.resizeTextarea,style:"height: 2.3em;",value:a.body,ref:e})),Object(i.h)("div",{class:"position-absolute",style:"top: 8px; right: 10px; font-size: 1.2em;"},Object(i.h)("i",{class:"fas fa-image pointerCursor","data-id":s.id,onClick:this.addImage})))),Object(i.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(i.h)("button",{type:"button",class:`btn btn-${h?"primary":"secondary"} mb-2`,disabled:!h,onClick:this.commentStory},Object(i.h)("i",{class:"fas fa-paper-plane"})))))),c&&Object(i.h)(t,null,Object(i.h)("div",{class:"col-12 text-center"},Object(i.h)("div",{class:"container-fluid"},Object(i.h)("div",{class:"row"},l.a.isArray(a.images)&&a.images.map(t=>Object(i.h)("div",{class:"col-3 p-1"},Object(i.h)("img",{src:t.s3SmallLink,class:"img-fluid",onError:this.handleImageErrored}),Object(i.h)("button",{class:"btn btn-sm btn-link",onClick:this.removeImage,"data-name":t.name},Object(i.h)("i",{class:"fas fa-trash"})," ",Object(i.h)(o.c,{id:"comments.remove-image"},"Remove")))))),Object(i.h)(r.a,{object:a,updateField:this.addImages,before:this.beforeImagesUploaded,after:this.afterImagesUploaded,autoOpen:!0}))))}})||a;e.a=h}).call(this,s("hosL").Fragment)},"5uob":function(t,e,s){"use strict";var a,i=s("hosL"),l=(s("Utv1"),s("/eY4")),c=s("OhSV"),o=s("go65"),n=(s("ETxl"),s("ZOvn"));let r=Object(l.a)(a=class extends i.Component{constructor(t){var e;super(t),e=this,this.commentStory=async function(){const{sendButtonEnabled:t}=e.state;if(!t)return!1;const{callback:s=(()=>{}),commentId:a,inputRefObject:i={}}=e.props,{story:l}=e.props,{storyStore:c}=e.props.stores,{comment:o=""}=e.state;e.setState({sendButtonEnabled:!1});const r=await c.commentReplyStory({id:l.id,commentId:a,comment:o});r&&200===r.status&&(e.setState({comment:""},()=>{n.a.resizeTextarea(i[a])}),s({story:l,response:r,commentId:a})),e.setState({sendButtonEnabled:!0})},this.state={sendButtonEnabled:!0},this.inputRef={}}componentDidMount(){const{initCall:t=(()=>{})}=this.props;t()}render(){const{inputRef:t}=this.props,{comment:e,sendButtonEnabled:s}=this.state,{userStore:a}=this.props.stores,{user:l={}}=a,r=n.a.displayNameShort(l),d=(n.a.displayName(l),l.image||(l.images?l.images[0]:void 0));return Object(i.h)("div",{class:"w-100"},Object(i.h)("div",{class:"d-flex mb-0 position-relative w-100"},Object(i.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedThumb",style:(d?`background-image: url('${d.s3SmallLink}'); background-size: cover;`:"")+" border-width: 3px !important;"},!d&&Object(i.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},r)),Object(i.h)("div",{class:"col pl-3",style:"line-height: 1.2em;"},Object(i.h)("div",{class:"d-flex bd-highlight"},Object(i.h)("div",{class:"p-0 w-100 bd-highlight"},Object(i.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(i.h)(c.c,{id:"comments.comment"},"Kommentar")),Object(i.h)("div",{class:"border rounded rounded-lg position-relative"},Object(i.h)(c.b,null,Object(i.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(i.h)(c.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(o.a)(this,"comment"),onKeyUp:n.a.resizeTextarea,style:"height: 2.3em;",value:e,ref:t})))),Object(i.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(i.h)("button",{type:"button",class:`btn btn-${s?"primary":"secondary"} mb-2`,disabled:!s,onClick:this.commentStory},Object(i.h)("i",{class:"fas fa-paper-plane"})))))))}})||a;e.a=r},"6GRK":function(t,e,s){"use strict";(function(t){function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function i(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){l(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function l(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var c,o=s("hosL"),n=s("/eY4"),r=(s("cneo"),s("Utv1")),d=s("OhSV"),h=s("go65");let b=Object(n.a)(c=class extends o.Component{constructor(t){var e;super(t),e=this,this.handleAdd=()=>{const{data:t}=this.state,{updateField:e,object:s,field:a}=this.props;e({id:s.id,field:a,value:i({},t)}),this.setState({data:{name:"",url:""}})},this.removeLink=async function(t){const{dogStore:s}=e.props.stores,{object:a}=e.props,{name:i,id:l}=t.target.closest("button").dataset;s.removeLink({id:a.id,name:i,linkId:l})},this.state={data:{}}}render(){const{showFiles:e=!0,object:s={}}=this.props;return Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col-12 mt-3"},e&&Object(o.h)(t,null,Object(o.h)("div",{class:"container-fluid"},Object(o.h)("div",{class:"row"},(!s.links||0===s.links.length)&&Object(o.h)(t,null,Object(o.h)("div",{class:"text-center text-muted"},Object(o.h)("div",{class:"display-1"},Object(o.h)("i",{class:"fas fa-link"})),Object(o.h)("h3",null,Object(o.h)(d.c,{id:"dogs.no-links-title"},"No links for this dog!")),Object(o.h)(d.c,{id:"dogs.no-links-text"},"You can add links to this dog. Ie. Links to Facebook page, Instagram page, blogg, etc."))),s.links&&s.links.map(t=>Object(o.h)("div",{class:"col-12 p-1"},Object(o.h)("span",{class:"font-weight-lighter mr-2"},r.a.isoDate(t.createdDate,!1,!1,!0)),Object(o.h)("span",{class:"mr-2"},t.name),Object(o.h)("span",{class:"mr-2"},t.url),Object(o.h)("button",{class:"btn btn-sm btn-link float-right p-0",onClick:this.removeLink,"data-name":t.name,"data-id":t.id},Object(o.h)("i",{class:"fas fa-trash-alt"})," Del"))))))),Object(o.h)("div",{class:"col-12 mt-3"},Object(o.h)("details",null,Object(o.h)("summary",null,Object(o.h)(d.c,{id:"dogs.link-add"},"Add new link")),Object(o.h)("div",{class:"form-group"},Object(o.h)("label",{for:"name"},Object(o.h)(d.c,{id:"dogs.link-name"},"Name")),Object(o.h)("input",{type:"text",class:"form-control",id:"name","aria-describedby":"nameHelp",onInput:Object(h.a)(this,"data.name")}),Object(o.h)("small",{id:"nameHelp",class:"form-text text-muted"},Object(o.h)(d.c,{id:"dogs.link-name-help"},"Name of link"))),Object(o.h)("div",{class:"form-group"},Object(o.h)("label",{for:"url"},Object(o.h)(d.c,{id:"dogs.link-url"},"Url")),Object(o.h)("input",{type:"text",class:"form-control",id:"url","aria-describedby":"urlHelp",onInput:Object(h.a)(this,"data.url")}),Object(o.h)("small",{id:"urlHelp",class:"form-text text-muted"},Object(o.h)(d.c,{id:"dogs.link-url-help"},"URL of link"))),Object(o.h)("button",{class:"btn btn-success",onClick:this.handleAdd},Object(o.h)(d.c,{id:"dogs.link-add"},"Add link")))))}})||c;e.a=b}).call(this,s("hosL").Fragment)},"9lZG":function(t,e,s){"use strict";(function(t){var a,i=s("hosL"),l=s("Utv1"),c=s("/eY4"),o=s("OhSV"),n=s("go65"),r=s("om2D"),d=s("ZOvn");let h=Object(c.a)(a=class extends i.Component{constructor(t){var e;super(t),e=this,this.beforeImagesUploaded=()=>{this.setState({sendButtonEnabled:!1})},this.afterImagesUploaded=()=>{this.setState({sendButtonEnabled:!0})},this.commentRace=async function(){const{sendButtonEnabled:t}=e.state;if(!t)return!1;const{callback:s=(()=>{}),inputRefObject:a={}}=e.props,{race:i}=e.props,{raceStore:l}=e.props.stores,{comment:c,showAddImage:o}=e.state;e.setState({sendButtonEnabled:!1});const n=await l.commentRace({id:i.id,comment:c});n&&200===n.status&&(e.setState({comment:{body:"",images:[]}},()=>{d.a.resizeTextarea(a[i.id]),o&&e.addImage()}),s({race:i,response:n})),e.setState({sendButtonEnabled:!0})},this.addImages=({value:t})=>{const{comment:e}=this.state;e.images.push(...t),this.setState({comment:e})},this.addImage=()=>{const{showAddImage:t=!1}=this.state;this.setState({showAddImage:!t})},this.handleImageErrored=t=>{const e=t.target;e.onerror=null,setTimeout(()=>{e.src+="?"+new Date},1e3)},this.state={comment:{body:"",images:[]},showAddImage:!1,sendButtonEnabled:!0},this.inputRef={}}render(){const{inputRef:e,race:s}=this.props,{comment:a,showAddImage:c,sendButtonEnabled:h}=this.state,{userStore:b}=this.props.stores,{user:m={}}=b,p=d.a.displayNameShort(m),u=(d.a.displayName(m),m.image||(m.images?m.images[0]:void 0));return Object(i.h)(t,null,Object(i.h)("div",null,Object(i.h)("div",{class:"d-flex mb-0 position-relative w-100"},Object(i.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall",style:(u?`background-image: url('${u.s3SmallLink}'); background-size: cover;`:"")+" border-width: 3px !important;"},!u&&Object(i.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},p)),Object(i.h)("div",{class:"col pl-3",style:"line-height: 1.2em;"},Object(i.h)("div",{class:"d-flex bd-highlight"},Object(i.h)("div",{class:"p-0 w-100 bd-highlight"},Object(i.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(i.h)(o.c,{id:"comments.comment"},"Kommentar")),Object(i.h)("div",{class:"border rounded rounded-lg position-relative"},Object(i.h)(o.b,null,Object(i.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(i.h)(o.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(n.a)(this,"comment.body"),onKeyUp:d.a.resizeTextarea,onFocus:d.a.resizeTextarea,style:"height: 2.3em;",value:a.body,ref:e})),Object(i.h)("div",{class:"position-absolute",style:"top: 8px; right: 10px; font-size: 1.2em;"},Object(i.h)("i",{class:"fas fa-image pointerCursor","data-id":s.id,onClick:this.addImage})))),Object(i.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(i.h)("button",{type:"button",class:`btn btn-${h?"primary":"secondary"} mb-2`,disabled:!h,onClick:this.commentRace},Object(i.h)("i",{class:"fas fa-paper-plane"})))))),c&&Object(i.h)(t,null,Object(i.h)("div",{class:"col-12 text-center"},Object(i.h)("div",{class:"container-fluid"},Object(i.h)("div",{class:"row"},l.a.isArray(a.images)&&a.images.map(t=>Object(i.h)("div",{class:"col-3 p-1"},Object(i.h)("img",{src:t.s3SmallLink,class:"img-fluid",onError:this.handleImageErrored}),Object(i.h)("button",{class:"btn btn-sm btn-link",onClick:this.removeImage,"data-name":t.name},Object(i.h)("i",{class:"fas fa-trash"})," ",Object(i.h)(o.c,{id:"comments.remove-image"},"Remove")))))),Object(i.h)(r.a,{object:a,updateField:this.addImages,before:this.beforeImagesUploaded,after:this.afterImagesUploaded,autoOpen:!0})))))}})||a;e.a=h}).call(this,s("hosL").Fragment)},"9xg+":function(t,e,s){"use strict";(function(t){function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function i(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var l,c,o,n,r,d,h=s("hosL"),b=s("Utv1"),m=s("/eY4"),p=s("cneo"),u=(s("go65"),s("Y3FI")),O=s("OhSV"),g=(s("fh8t"),s("ZOvn")),j=s("om2D"),f=s("TiXY"),y=s("KOz6"),v=s("6GRK"),w=s("/DnB");g.a.marginTop(!1),g.a.marginTopBack(!1),g.a.marginBottom(!1);let x=Object(m.a)(l=class extends h.Component{constructor(...t){var e;super(...t),e=this,this.handleImageErrored=t=>{const e=t.target;if(e.dataset.retry||(e.dataset.retry=0),e.dataset.retry=parseInt(e.dataset.retry,10)+1,e.dataset.retry>5)return!1;e.onerror=null,setTimeout(()=>{e.src+="?"+new Date},1e3)},this.removeImage=async function(t){const{dogStore:s}=e.props.stores,{dog:a}=e.props;s.removeImage({id:a.id,name:t.target.parentElement.dataset.name||t.target.dataset.name})},this.removeFile=async function(t){const{dogStore:s}=e.props.stores,{dog:a}=e.props;s.removeFile({id:a.id,name:t.target.parentElement.dataset.name||t.target.dataset.name})}}render(){const{saved:e,dog:s,type:a="text",datalist:i=[],min:l,max:c,step:o,field:n,title:r,icon:d,help:m,onInput:p,updateField:u,refName:g,showImages:w=!1,showFiles:x=!0}=this.props;let k=s[n]||"",S=c;return"date"===a&&(k&&(k=b.a.isoDate(s[n],!1,!1,!0)),"today"===c&&(S=b.a.isoDate(void 0,!1,!1,!0))),"file"===a?Object(h.h)("div",{class:"form-group "+(e[`${n}.${s.id}`]?"is-valid":"")},Object(h.h)("label",{for:n+"Input"},d&&Object(h.h)("i",{class:d+" text-muted"})," ",r),x&&Object(h.h)(t,null,Object(h.h)("div",{class:"container-fluid"},Object(h.h)("div",{class:"row"},(!s.files||0===s.files.length)&&Object(h.h)(t,null,Object(h.h)("div",{class:"text-center text-muted"},Object(h.h)("div",{class:"display-1"},Object(h.h)("i",{class:"fas fa-file"})),Object(h.h)("h3",null,Object(h.h)(O.c,{id:"dogs.no-files-title"},"No files attached to this dog!")),Object(h.h)(O.c,{id:"dogs.no-files-text"},"You can upload files to this dog inside edit. These files can be of any type. Ie: Certificates, test, etc."))),s.files&&s.files.map(t=>Object(h.h)("div",{class:"col-12 p-1"},Object(h.h)("span",{class:"font-weight-lighter mr-2"},b.a.isoDate(t.createdDate,!1,!1,!0)),Object(h.h)("span",{class:"mr-2"},t.name),Object(h.h)("span",{class:"font-weight-lighter mr-2"},b.a.formatBytes(t.size,1)),Object(h.h)("button",{class:"btn btn-sm btn-link float-right p-0",onClick:this.removeFile,"data-name":t.name},Object(h.h)("i",{class:"fas fa-trash-alt"})," Del")))))),Object(h.h)(f.a,{saved:e,object:s,field:n,updateField:u}),e[`${n}.${s.id}`]?Object(h.h)("div",{class:"valid-feedback",style:"display: block;"},Object(h.h)(O.c,{id:"dogs.changes-saved"},"Endringene er lagret")):Object(h.h)("small",{id:n+"Help",class:"form-text text-muted"},m)):"textarea"===a?Object(h.h)("div",{class:"form-group "+(e[`${n}.${s.id}`]?"is-valid":"")},Object(h.h)("label",{for:n+"Input"},d&&Object(h.h)("i",{class:d+" text-muted"})," ",r),Object(h.h)("textarea",{type:"text",class:"form-control "+(e[`${n}.${s.id}`]?"is-valid":""),id:n+"Input","aria-describedby":n+"Help",value:k,"data-id":s.id,"data-field":n,onInput:p,rows:10}),e[`${n}.${s.id}`]?Object(h.h)("div",{class:"valid-feedback",style:"display: block;"},Object(h.h)(O.c,{id:"dogs.changes-saved"},"Endringene er lagret")):Object(h.h)("small",{id:n+"Help",class:"form-text text-muted"},m)):"links"===n?Object(h.h)("div",{class:"form-group "+(e[`${n}.${s.id}`]?"is-valid":"")},Object(h.h)("label",{for:n+"Input"},d&&Object(h.h)("i",{class:d+" text-muted"})," ",r),Object(h.h)(v.a,{saved:e,stores:this.props.stores,object:s,field:n,updateField:u}),e[`${n}.${s.id}`]?Object(h.h)("div",{class:"valid-feedback",style:"display: block;"},Object(h.h)(O.c,{id:"dogs.changes-saved"},"Endringene er lagret")):Object(h.h)("small",{id:n+"Help",class:"form-text text-muted"},m)):"achievements"===n?Object(h.h)("div",{class:"form-group "+(e[`${n}.${s.id}`]?"is-valid":"")},Object(h.h)("label",{for:n+"Input"},d&&Object(h.h)("i",{class:d+" text-muted"})," ",r),Object(h.h)(y.a,{saved:e,stores:this.props.stores,object:s,field:n,updateField:u}),e[`${n}.${s.id}`]?Object(h.h)("div",{class:"valid-feedback",style:"display: block;"},Object(h.h)(O.c,{id:"dogs.changes-saved"},"Endringene er lagret")):Object(h.h)("small",{id:n+"Help",class:"form-text text-muted"},m)):"image"===a?Object(h.h)("div",{class:"form-group "+(e[`${n}.${s.id}`]?"is-valid":"")},Object(h.h)("label",{for:n+"Input"},d&&Object(h.h)("i",{class:d})," ",r),w&&Object(h.h)(t,null,Object(h.h)("div",{class:"container-fluid"},Object(h.h)("div",{class:"row"},(!s.images||0===s.images.length)&&Object(h.h)(t,null,Object(h.h)("div",{class:"text-center text-muted mb-3"},Object(h.h)("div",{class:"display-1"},Object(h.h)("i",{class:"fas fa-images"})),Object(h.h)("h3",null,Object(h.h)(O.c,{id:"dogs.no-images-title"},"No images for this dog!")),Object(h.h)(O.c,{id:"dogs.no-images-text"},"You can add more images to this dog. Puppy pictures, workout pictures, lazy summer pictures, etc. All is a nice way to create a better profile for this dog."))),"image"===n?Object(h.h)(t,null,s.image&&s.image.s3SmallLink&&Object(h.h)("div",{class:"col-3 p-1"},Object(h.h)("img",{src:s.image.s3SmallLink,class:"img-fluid border rounded-lg",onError:this.handleImageErrored}),Object(h.h)("button",{class:"btn btn-sm btn-link",onClick:this.removeImage,"data-name":s.image.name},Object(h.h)("i",{class:"fas fa-trash"})," Remove"),Object(h.h)("span",{class:"badge badge-success"},"Main"))):Object(h.h)(t,null,s.images&&s.images.map(t=>Object(h.h)("div",{class:"col-3 p-1"},Object(h.h)("img",{src:t.s3SmallLink,class:"img-fluid",onError:this.handleImageErrored}),Object(h.h)("button",{class:"btn btn-sm btn-link",onClick:this.removeImage,"data-name":t.name},Object(h.h)("i",{class:"fas fa-trash"})," Remove"))))))),"image"===n?Object(h.h)(t,null,Object(h.h)(j.a,{saved:e,object:s,field:n,updateField:u,autoOpen:!1,addToImages:!1})):Object(h.h)(t,null,Object(h.h)(j.a,{saved:e,object:s,field:n,updateField:u,autoOpen:!1})),e[`${n}.${s.id}`]?Object(h.h)("div",{class:"valid-feedback",style:"display: block;"},Object(h.h)(O.c,{id:"dogs.changes-saved"},"Endringene er lagret")):Object(h.h)("small",{id:n+"Help",class:"form-text text-muted"},m)):"datalist"===a?Object(h.h)("div",{class:"form-group "+(e[`${n}.${s.id}`]?"is-valid":"")},Object(h.h)("label",{for:n+"Input"},d&&Object(h.h)("i",{class:d})," ",r),Object(h.h)("input",{list:"list-"+n,class:"form-control "+(e[`${n}.${s.id}`]?"is-valid":""),id:n+"Input","aria-describedby":n+"Help",value:k,"data-id":s.id,"data-field":n,onInput:p}),Object(h.h)("datalist",{id:"list-"+n},i.map(t=>Object(h.h)("option",{value:t[0]},t[1]))),e[`${n}.${s.id}`]?Object(h.h)("div",{class:"valid-feedback",style:"display: block;"},Object(h.h)(O.c,{id:"dogs.changes-saved"},"Endringene er lagret")):Object(h.h)("small",{id:n+"Help",class:"form-text text-muted"},m)):"select"===a?Object(h.h)("div",{class:"form-group "+(e[`${n}.${s.id}`]?"is-valid":"")},Object(h.h)("label",{for:n+"Input"},d&&Object(h.h)("i",{class:d})," ",r),Object(h.h)("select",{type:a,class:"form-control "+(e[`${n}.${s.id}`]?"is-valid":""),id:n+"Input","aria-describedby":n+"Help",value:k,"data-id":s.id,"data-field":n,onInput:p},Object(h.h)("option",{value:""},"-- Velg kjønn --"),i.map(t=>Object(h.h)("option",{value:t[0]},t[1]))),e[`${n}.${s.id}`]?Object(h.h)("div",{class:"valid-feedback",style:"display: block;"},Object(h.h)(O.c,{id:"dogs.changes-saved"},"Endringene er lagret")):Object(h.h)("small",{id:n+"Help",class:"form-text text-muted"},m)):Object(h.h)("div",{class:"form-group "+(e[`${n}.${s.id}`]?"is-valid":"")},Object(h.h)("label",{for:n+"Input"},d&&Object(h.h)("i",{class:d})," ",r)," ",g,Object(h.h)("input",{type:a,class:"form-control "+(e[`${n}.${s.id}`]?"is-valid":""),id:n+"Input","aria-describedby":n+"Help",min:l,max:S,step:o,value:k,"data-id":s.id,"data-field":n,onInput:p}),e[`${n}.${s.id}`]?Object(h.h)("div",{class:"valid-feedback",style:"display: block;"},Object(h.h)(O.c,{id:"dogs.changes-saved"},"Endringene er lagret")):Object(h.h)("small",{id:n+"Help",class:"form-text text-muted"},m))}})||l,k=Object(m.a)(c=class extends h.Component{toggleType(t){const{dogStore:e}=this.props.stores,{object:s,type:a,field:i,updateField:l,isNew:c}=this.props;let o=Object(p.i)(s[i]);o=o===t?null:t,null===o?l({id:s.id,field:i,value:o,type:a,isNew:c}):s.teams.indexOf(o)>-1?e.removeTeam({id:s.id,team:o}):s.team?e.addTeam({id:s.id,team:o}):l({id:s.id,field:i,value:o,type:a,isNew:c})}componentDidMount(){this.container&&this.container.scrollIntoView({behavior:"smooth",block:"center"})}render(){const{userStore:e}=this.props.stores,{teams:s}=e,{saved:a,object:i,field:l,title:c,icon:o,help:n}=this.props,r=Object(p.i)(i[l]),{highlight:d}=this.props;return Object(h.h)("div",{class:"form-group mb-4 pb-1 border-bottom "+(a[`${l}.${i.id}`]?"is-valid":"")},Object(h.h)("label",{for:l+"Input"},o&&Object(h.h)("i",{class:o+" text-muted"})," ",c),Object(h.h)("div",{class:"container-fluid px-0"},Object(h.h)("div",{class:"row"},Object(h.h)("div",{class:"w-100 overflow-hidden"},Object(h.h)("div",{class:"d-flex flex-row flex-nowrap pb-2 px-1",style:"overflow: auto; scroll-snap-type: x mandatory;"},s&&s.map((e,a)=>{const l=r===e.id,c=i&&b.a.isArray(i.teams)&&i.teams.indexOf(e.id)>-1;return Object(h.h)("div",{class:"col mb-0 px-0",ref:l||c?t=>this.container=t:null},Object(h.h)("button",{class:`btn btn-block\n            \t\t\t\t\t\t\t\t\t\trounded-none ${0===a?"rounded-pill-left":a+1===s.length?"rounded-pill-right":""}\n                                                    btn${l||c?"":"-outline"}-${c?"info":"success"}\n                                                    text-nowrap overflow-hidden`,style:"text-overflow: ellipsis;",onClick:()=>this.toggleType(e.id)},i.hintTeam===e.id&&Object(h.h)("span",{class:"float-right text-primary"},Object(h.h)("i",{class:"fas fa-circle"})),Object(h.h)("i",{class:"fas fa-users mr-2"}),e.name,d&&d.indexOf(e.id)>-1&&Object(h.h)(t,null,r===e.id?Object(h.h)(t,null,Object(h.h)("i",{class:"fas fa-check float-right"})):Object(h.h)(t,null,Object(h.h)("div",{class:"spinner-grow text-warning float-right",role:"status"},Object(h.h)("span",{class:"sr-only"},"Loading...")),Object(h.h)("i",{class:"far fa-hand-point-left float-right",style:"font-size: 2.0em;"}))),Object(h.h)("small",null,l&&Object(h.h)("span",{class:"badge badge-pill badge-primary"},"Primary"),c&&Object(h.h)("span",{class:"badge badge-pill badge-secondary"},"Secondary"))))}))))),a[`${l}.${i.id}`]?Object(h.h)("div",{class:"valid-feedback",style:"display: block;"},Object(h.h)(O.c,{id:"workouts.changes-saved"},"Endringene er lagret")):Object(h.h)("small",{id:l+"Help",class:"form-text text-muted"},n))}})||c,S=Object(m.a)(o=class extends h.Component{toggleType(t){const{object:e,type:s,field:a,updateField:i,isNew:l}=this.props;let c=Object(p.i)(e[a]);c=c===t?null:t,i({id:e.id,field:a,value:c,type:s,isNew:l})}render(){const{userStore:t}=this.props.stores,{harnesses:e,user:s}=t,{language:a="en"}=s,{saved:i,object:l,field:c,title:o,icon:n,help:r}=this.props,d=Object(p.i)(l[c]);return Object(h.h)("div",{class:"form-group "+(i[`${c}.${l.id}`]?"is-valid":"")},Object(h.h)("label",{for:c+"Input"},n&&Object(h.h)("i",{class:n})," ",o),Object(h.h)("div",{class:"container-fluid px-0"},Object(h.h)("div",{class:"row"},Object(h.h)("div",{class:"w-100 overflow-hidden"},Object(h.h)("div",{class:"d-flex flex-row flex-nowrap pb-2 px-1",style:"overflow: auto; scroll-snap-type: x mandatory;"},e&&e.map((t,s)=>Object(h.h)("div",{class:"col px-0 mb-2",ref:d===t.id?t=>this.container=t:null},Object(h.h)("div",{class:`border\n                                            rounded-none ${0===s?"rounded-pill-left":s+1===e.length?"rounded-pill-right":""}\n                                            p-2 ${d===t.id?"bg-success":""}`,style:`border-bottom: 3px solid ${t.colorNonstop} !important;`,onClick:()=>this.toggleType(t.id)},t.lang&&t.lang[a]?t.lang[a]:t.name))))))),i[`${c}.${l.id}`]?Object(h.h)("div",{class:"valid-feedback",style:"display: block;"},Object(h.h)(O.c,{id:"dogs.changes-saved"},"Endringene er lagret")):Object(h.h)("small",{id:c+"Help",class:"form-text text-muted"},r))}})||o,C=Object(m.a)(n=class extends h.Component{toggleStatus(t){const{dogStore:e}=this.props.stores,{object:s,type:a,field:i,updateField:l,isNew:c}=this.props;let o=Object(p.i)(s[i]);o=o===t?0:t,0===o?l({id:s.id,field:i,value:o,type:a,isNew:c}):s.statuses.indexOf(o)>-1?e.removeStatus({id:s.id,status:o}):s.status?e.addStatus({id:s.id,status:o}):l({id:s.id,field:i,value:o,type:a,isNew:c})}componentDidMount(){this.container&&this.container.scrollIntoView({behavior:"smooth",block:"center"})}render(){const{userStore:t}=this.props.stores,{dogstatuses:e,user:s}=t,{language:a}=s,{saved:i,object:l,field:c,title:o,icon:n,help:r}=this.props,d=Object(p.i)(l[c]);return Object(h.h)("div",{class:"form-group  mb-4 pb-1 border-bottom "+(i[`${c}.${l.id}`]?"is-valid":"")},Object(h.h)("label",{for:c+"Input"},n&&Object(h.h)("i",{class:n+" text-muted"})," ",o),Object(h.h)("div",{class:"container-fluid px-0"},Object(h.h)("div",{class:"row"},Object(h.h)("div",{class:"w-100 overflow-hidden"},Object(h.h)("div",{class:"d-flex flex-row flex-nowrap pb-2 px-1",style:"overflow: auto; scroll-snap-type: x mandatory;"},e&&e.map((t,s)=>{const i=d===t.id,c=l&&b.a.isArray(l.statuses)&&l.statuses.indexOf(t.id)>-1;return Object(h.h)("div",{class:"col mb-2 px-0",ref:i||c?t=>this.container=t:null},Object(h.h)("button",{class:`btn btn-block\n            \t\t\t\t\t\t\t\t\t\trounded-none ${0===s?"rounded-pill-left":s+1===e.length?"rounded-pill-right":""}\n                                                    btn${i||c?"":"-outline"}-${c?"info":"success"}\n                                                    text-nowrap overflow-hidden`,style:"text-overflow: ellipsis;",onClick:()=>this.toggleStatus(t.id)},a&&t.lang&&t.lang[a]?t.lang[a]:t.name))}))))),i[`${c}.${l.id}`]?Object(h.h)("div",{class:"valid-feedback",style:"display: block;"},Object(h.h)(O.c,{id:"dogs.changes-saved"},"Endringene er lagret")):Object(h.h)("small",{id:c+"Help",class:"form-text text-muted"},r))}})||n,I=Object(m.a)(r=class extends h.Component{toggleStatus(t){const{object:e,type:s,field:a,updateField:i,isNew:l}=this.props;let c=Object(p.i)(e[a]);c=c===t?null:t,i({id:e.id,field:a,value:c,type:s,isNew:l})}render(){const{userStore:t}=this.props.stores,{dogPositions:e}=t,{saved:s,object:a,field:i,title:l,icon:c,help:o}=this.props,n=Object(p.i)(a[i]);return Object(h.h)("div",{class:"form-group  mb-4 pb-1 border-bottom "+(s[`${i}.${a.id}`]?"is-valid":"")},Object(h.h)("label",{for:i+"Input"},c&&Object(h.h)("i",{class:c+" text-muted"})," ",l),Object(h.h)("div",{class:"container-fluid px-0"},Object(h.h)("div",{class:"row"},e&&e.map(t=>Object(h.h)("div",{class:"offset-2 col-8 mb-2"},Object(h.h)("div",{class:"border rounded rounded-pill px-3 py-1 bg-"+(n===t.id?t.class||"success":""),onClick:()=>this.toggleStatus(t.id),style:"line-height: 1.1em; cursor: pointer; pointer-events: inherit;"},Object(h.h)("small",null,t.name)))))),s[`${i}.${a.id}`]?Object(h.h)("div",{class:"valid-feedback",style:"display: block;"},Object(h.h)(O.c,{id:"dogs.changes-saved"},"Endringene er lagret")):Object(h.h)("small",{id:i+"Help",class:"form-text text-muted"},o))}})||r,D=Object(m.a)(d=class extends h.Component{constructor(t){var e;super(t),e=this,this.insertDog=async function(){const{newDog:t}=e.state,{dogStore:s}=e.props.stores;await s.insert(function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){i(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},t)),e.resetDog(),Object(u.route)("/dogs/")},this.updateField=t=>{const{id:e,field:s,type:a,elementtype:i,isNew:l}=t.target.dataset,{value:c,type:o,min:n,max:r}=t.target;"date"===o&&n&&r?c>=n&&c<=r&&this.updateFieldValue({id:parseInt(e,10),field:s,value:c,type:a,elementtype:i,isNew:l}):this.updateFieldValue({id:parseInt(e,10),field:s,value:c,type:a,elementtype:i,isNew:l})},this.updateFieldValue=({id:t,field:s,value:a,datatype:i,elementtype:l,isNew:c=!1,skipTimer:o=!1})=>{const{dogStore:n}=this.props.stores;let r=a,d=a;const{dog:h}=n;"images"===s&&Array.isArray(h.images)&&Array.isArray(a)&&(d=[...h.images,...a]),"files"===s&&Array.isArray(h.files)&&(d=Array.isArray(a)?[...h.files,...a]:[...h.files,a]),"achievements"===s&&Array.isArray(h.achievements)&&(d=Array.isArray(a)?[...h.achievements,...a]:[...h.achievements,a]),"links"===s&&Array.isArray(h.links)&&(d=Array.isArray(a)?[...h.links,...a]:[...h.links,a]),"array"!==i||Array.isArray(a)||(r="number"===l?a.split(",").map(t=>parseFloat(t)||t):a.split(",")),c?n.updateObjectKeyValue("newDog",s,a):(n.updateField(t,s,d),o?this.doUpdateField(t,s,r):(clearTimeout(this.updateTimer[s]),this.updateTimer[s]=setTimeout((async function(){e.doUpdateField(t,s,r)}),500)))},this.chooseMother=t=>{const{dogStore:e}=this.props.stores,{dog:s}=e,a=parseInt(t.target.value,10),i=e.findDog(a);i?(this.updateFieldValue({id:s.id,field:"mother",value:i.id,skipTimer:!0}),this.updateFieldValue({id:s.id,field:"motherName",value:i.name,skipTimer:!0}),this.updateFieldValue({id:s.id,field:"motherChipId",value:i.chipId,skipTimer:!0})):this.updateFieldValue({id:s.id,field:"mother",value:null,skipTimer:!0})},this.chooseFather=t=>{const{dogStore:e}=this.props.stores,{dog:s}=e,a=parseInt(t.target.value,10),i=e.findDog(a);i?(this.updateFieldValue({id:s.id,field:"father",value:i.id,skipTimer:!0}),this.updateFieldValue({id:s.id,field:"fatherName",value:i.name,skipTimer:!0}),this.updateFieldValue({id:s.id,field:"fatherChipId",value:i.chipId,skipTimer:!0})):this.updateFieldValue({id:s.id,field:"father",value:null,skipTimer:!0})},this.chooseSubmenu=t=>{this.setState({submenu:t.target.parentElement.dataset.menu||t.target.dataset.menu})},this.back=()=>{const{history:t}=this.props.stores;t.goBack()},this.state={newDog:{},submenu:t.submenu||"info"},this.updateTimer={}}async loadDog(t=this.props){const{id:e}=t,{dogStore:s}=this.props.stores;s.cleanupMemoryDetail(),await s.load(e,!1,{addData:["team","user","workoutSummary","vaccineStatuses","historyStatuses","vaccineLogStatuses","allDogs"]})}resetDog(){this.setState({newDog:{},createNew:!1})}async doUpdateField(t,e,s){const{dogStore:a}=this.props.stores;await a.saveField(t,e,s)}componentDidMount(){this.loadDog()}componentWillReceiveProps(t){t.id!==this.props.id&&this.loadDog(t)}render(){const{submenu:e}=this.state,{dogStore:s,userStore:a}=this.props.stores,{saved:i,dog:l}=s,c=s.findDogsByGender("female"),o=s.findDogsByGender("male"),n=g.a.hasBirthday(l.birth),r=l.birth?Math.ceil(g.a.daysUntilNextBirthday(l.birth)):365,{name:d}=l;return Object(h.h)(t,null,Object(h.h)("div",{class:"d-flex position-relative"},Object(h.h)("div",{class:"text-center border rounded-circle imageRounded float-right",style:l.image?`background-image: url("${l.image.s3SmallLink}");`:""},!l.image&&Object(h.h)("i",{class:"fas fa-dog text-muted mt-3",style:"font-size: 40px;"})),Object(h.h)("div",{class:"flex-grow-1 pl-3"},Object(h.h)("h5",null,d,n&&Object(h.h)(t,null,Object(h.h)("i",{class:"fas fa-birthday-cake ml-3"}))),Object(h.h)("span",null,r<7&&Object(h.h)(t,null,Object(h.h)("span",{class:"text-muted mr-2"},Object(h.h)("i",{class:"fas fa-birthday-cake"})," in ",r," days")),l.birth&&Object(h.h)("span",{class:"mr-2"},b.a.age(l.birth,l.deceased)),"female"===l.gender?Object(h.h)("i",{class:"fas fa-venus"}):Object(h.h)("i",{class:"fas fa-mars"})))),Object(h.h)("div",{class:"d-flex flex-row flex-nowrap pb-2 px-1",style:"overflow: auto; scroll-snap-type: x mandatory;"},Object(h.h)("div",{class:"col px-0 pt-2"},Object(h.h)("button",{class:`btn btn-block rounded-pill-left rounded-none ${"info"===e?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"info",onClick:this.chooseSubmenu},Object(h.h)("i",{class:"fas fa-info-circle"})," ",Object(h.h)(O.c,{id:"dogs.info"},"Info")),"info"===e&&Object(h.h)(w.a,{horizontal:"center",vertical:"end"})),Object(h.h)("div",{class:"col px-0 pt-2"},Object(h.h)("button",{class:`btn btn-block rounded-none ${"pictures"===e?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"pictures",onClick:this.chooseSubmenu},Object(h.h)("i",{class:"fas fa-images"})," ",Object(h.h)(O.c,{id:"dogs.pictures"},"Pictures")),"pictures"===e&&Object(h.h)(w.a,{horizontal:"center",vertical:"end"})),Object(h.h)("div",{class:"col px-0 pt-2"},Object(h.h)("button",{class:`btn btn-block rounded-none ${"team"===e?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"team",onClick:this.chooseSubmenu},Object(h.h)("i",{class:"fas fa-users"})," ",Object(h.h)(O.c,{id:"dogs.team"},"Team")),"team"===e&&Object(h.h)(w.a,{horizontal:"center",vertical:"end"})),Object(h.h)("div",{class:"col px-0 pt-2"},Object(h.h)("button",{class:`btn btn-block rounded-pill-right rounded-none ${"advanced"===e?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"advanced",onClick:this.chooseSubmenu},Object(h.h)("i",{class:"fas fa-cogs"})," ",Object(h.h)(O.c,{id:"dogs.advanced"},"Advanced")),"advanced"===e&&Object(h.h)(w.a,{horizontal:"center",vertical:"end"}))),Object(h.h)("div",{class:"w-100 overflow-auto position-relative",style:"max-height: 50vh;"},Object(h.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3"},"info"===e&&Object(h.h)(t,null,Object(h.h)(O.b,null,Object(h.h)(x,{saved:i,dog:l,field:"name",title:Object(h.h)(O.c,{id:"dogs.full-name"},"Fullt navn"),help:Object(h.h)(O.c,{id:"dogs.full-name-help"},"Fullt navn på hunden."),onInput:this.updateField}),Object(h.h)(x,{saved:i,dog:l,field:"shortname",title:Object(h.h)(O.c,{id:"dogs.short-name"},"Kallenavn"),help:Object(h.h)(O.c,{id:"dogs.short-name-help"},"Kallenavnet på hunden. Hva roper du på innkalling?"),onInput:this.updateField}),Object(h.h)(x,{saved:i,dog:l,field:"gender",type:"select",datalist:[["male",Object(h.h)(O.c,{id:"dogs.gender-male"},"Male")],["female",Object(h.h)(O.c,{id:"dogs.gender-female"},"Female")]],title:Object(h.h)(O.c,{id:"dogs.gender"},"Kjønn"),help:Object(h.h)(O.c,{id:"dogs.gender-help"},"Kjønn på hunden."),onInput:this.updateField}),Object(h.h)(x,{saved:i,dog:l,field:"chipId",title:Object(h.h)(O.c,{id:"dogs.chip-id"},"Chip ID"),help:Object(h.h)(O.c,{id:"dogs.chip-id-help"},"Chip ID på hunden. Står ofte i vetrinærhåndbok eller passet."),onInput:this.updateField}),Object(h.h)(x,{saved:i,dog:l,field:"birth",type:"date",min:"2000-01-01",max:"today",title:Object(h.h)(O.c,{id:"dogs.birth"},"Fødselsdato"),help:Object(h.h)(O.c,{id:"dogs.birth-help"},"Fødselsdato på hunden."),onInput:this.updateField}),Object(h.h)(S,{stores:this.props.stores,saved:i,object:l,type:"number",field:"harness",title:Object(h.h)(O.c,{id:"dogs.harness-size"},"Selestørrelse"),help:Object(h.h)(O.c,{id:"dogs.harness-size-help"},"Sele til hunden"),updateField:this.updateFieldValue}),Object(h.h)(x,{saved:i,dog:l,field:"description",icon:"fas fa-paragraph",type:"textarea",title:Object(h.h)(O.c,{id:"dogs.description"},"Beskrivelse"),help:Object(h.h)(O.c,{id:"dogs.description-help"},"Beskrivelse av hunden."),onInput:this.updateField}))),"status"===e&&Object(h.h)(t,null,Object(h.h)(O.b,null,Object(h.h)(C,{stores:this.props.stores,saved:i,object:l,type:"number",field:"status",title:Object(h.h)(O.c,{id:"dogs.status"},"Status"),help:Object(h.h)(O.c,{id:"dogs.status-help"},"Status til hunden"),updateField:this.updateFieldValue}),Object(h.h)(x,{saved:i,dog:l,field:"specialNeeds",title:Object(h.h)(O.c,{id:"dogs.special-needs"},"Spesielle behov"),help:Object(h.h)(O.c,{id:"dogs.special-needs-help"},'Har hunden spesielle behov? Trenger ekstra mat, utstyr eller annet? Eks: "Ekstra fett", "Husk ulveklobandasje", etc.'),onInput:this.updateField}))),"pictures"===e&&Object(h.h)(t,null,Object(h.h)(O.b,null,Object(h.h)(x,{saved:i,dog:l,field:"image",type:"image",icon:"fas fa-portrait",stores:this.props.stores,title:Object(h.h)(O.c,{id:"dogs.profile-photo"},"Profilbilde"),help:Object(h.h)(O.c,{id:"dogs.profile-photo-help"},"Profilbilde av hunden."),onInput:this.updateField,updateField:this.updateFieldValue,showImages:!0}))),"team"===e&&Object(h.h)(t,null,Object(h.h)(O.b,null,Object(h.h)(k,{stores:this.props.stores,saved:i,object:l,type:"number",field:"team",title:Object(h.h)(O.c,{id:"dogs.team"},"Team"),help:Object(h.h)(O.c,{id:"dogs.team-help"},"Team som hunden er på."),updateField:this.updateFieldValue}),Object(h.h)(I,{stores:this.props.stores,saved:i,object:l,type:"number",field:"position",title:Object(h.h)(O.c,{id:"dogs.position"},"Plass i spannet"),help:Object(h.h)(O.c,{id:"dogs.position-help"},"Foretrukket plass i spannet."),updateField:this.updateFieldValue}))),"relations"===e&&Object(h.h)(t,null,Object(h.h)("h5",{class:"mt-5"},Object(h.h)(O.c,{id:"dogs.mother"},"Mor")),Object(h.h)("select",{class:"form-control","aria-describedby":"fatherHelp",value:l.mother,onInput:this.chooseMother},Object(h.h)("option",{value:""},"-- ",Object(h.h)(O.c,{id:"dogs.choose-mother"},"Velg blant dine hunder")," --"),c&&c.map(t=>Object(h.h)("option",{value:t.id},t.name," - ",b.a.age(t.birth,t.deceased)))),Object(h.h)(O.b,null,Object(h.h)(x,{saved:i,dog:l,field:"motherName",type:"text",title:Object(h.h)(O.c,{id:"dogs.mother-name"},"Navn på mor"),help:Object(h.h)(O.c,{id:"dogs.mother-name-help"},"Navn på moren til denne hunden."),onInput:this.updateField}),Object(h.h)(x,{saved:i,dog:l,field:"motherChipId",type:"text",title:Object(h.h)(O.c,{id:"dogs.mother-chipid"},"Chip ID på mor"),help:Object(h.h)(O.c,{id:"dogs.mother-chipid-help"},"Chip ID til moren til denne hunden. Dersom hunden finnes blant dine hunder, så vil den bli koblet sammen."),onInput:this.updateField}),Object(h.h)(x,{saved:i,dog:l,field:"motherComment",title:Object(h.h)(O.c,{id:"dogs.mother-comment"},"Kommentar til mor"),help:Object(h.h)(O.c,{id:"dogs.mother-comment-help"},"Kommentar til moren til denne hunden."),onInput:this.updateField})),Object(h.h)("h5",{class:"mt-5"},Object(h.h)(O.c,{id:"dogs.father"},"Far")),Object(h.h)("select",{class:"form-control","aria-describedby":"fatherHelp",value:l.father,onInput:this.chooseFather},Object(h.h)("option",{value:""},"-- ",Object(h.h)(O.c,{id:"dogs.choose-father"},"Velg blant dine hunder")," --"),o&&o.map(t=>Object(h.h)("option",{value:t.id},t.name," - ",b.a.age(t.birth,t.deceased)))),Object(h.h)(O.b,null,Object(h.h)(x,{saved:i,dog:l,field:"fatherName",type:"text",title:Object(h.h)(O.c,{id:"dogs.father-name"},"Navn på far"),help:Object(h.h)(O.c,{id:"dogs.father-name-help"},"Navn på faren til denne hunden."),onInput:this.updateField}),Object(h.h)(x,{saved:i,dog:l,field:"fatherChipId",type:"text",title:Object(h.h)(O.c,{id:"dogs.father-chipid"},"Chip ID på far"),help:Object(h.h)(O.c,{id:"dogs.father-chipid-help"},"Chip ID til faren til denne hunden. Dersom hunden finnes blant dine hunder, så vil den bli koblet sammen."),onInput:this.updateField}),Object(h.h)(x,{saved:i,dog:l,field:"fatherComment",title:Object(h.h)(O.c,{id:"dogs.father-comment"},"Kommentar til far"),help:Object(h.h)(O.c,{id:"dogs.father-comment-help"},"Kommentar til faren til denne hunden."),onInput:this.updateField}))),"links"===e&&Object(h.h)(t,null,Object(h.h)(O.b,null,Object(h.h)(x,{saved:i,dog:l,field:"links",type:"text",icon:"fas fa-link",stores:this.props.stores,title:Object(h.h)(O.c,{id:"dogs.links"},"Linker"),help:Object(h.h)(O.c,{id:"dogs.links-help"},"Linker til denne hunden."),onInput:this.updateField,updateField:this.updateFieldValue}))),"achievements"===e&&Object(h.h)(t,null,Object(h.h)(O.b,null,Object(h.h)(x,{saved:i,dog:l,field:"achievements",type:"text",icon:"fas fa-clock",stores:this.props.stores,title:Object(h.h)(O.c,{id:"dogs.achievements"},"Bragder"),help:Object(h.h)(O.c,{id:"dogs.achievements-help"},"Bragder til denne hunden."),onInput:this.updateField,updateField:this.updateFieldValue}))),"advanced"===e&&Object(h.h)(t,null,Object(h.h)(O.b,null,Object(h.h)(x,{saved:i,dog:l,field:"files",type:"file",icon:"fas fa-file",stores:this.props.stores,title:Object(h.h)(O.c,{id:"dogs.files"},"Files"),help:Object(h.h)(O.c,{id:"dogs.files-help"},"Filer til denne hunden."),onInput:this.updateField,updateField:this.updateFieldValue}))))))}})||d;e.a=D}).call(this,s("hosL").Fragment)},AEg1:function(t,e,s){"use strict";(function(t){function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function i(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var l,c=s("hosL"),o=s("Utv1"),n=s("/eY4"),r=s("OhSV"),d=s("go65"),h=s("om2D"),b=s("ZOvn");const m={showAddImage:!1,showTeamChange:!1,showChangeVisibility:!1,showChangeType:!1,sendButtonEnabled:!0};let p=Object(n.a)(l=class extends c.Component{constructor(t){var e;super(t),e=this,this.beforeImagesUploaded=()=>{this.setState({sendButtonEnabled:!1})},this.afterImagesUploaded=()=>{this.setState({sendButtonEnabled:!0})},this.addStory=async function(){const{story:t={},showAddImage:s,sendButtonEnabled:a}=e.state,{callback:i=(()=>{}),hashTags:l=[],postfix:c,topic:o="team-"+t.team}=e.props,{storyStore:n}=e.props.stores;if(!a)return!1;if(!t.body)return!1;e.setState({sendButtonEnabled:!1});let r=t.body;c&&(r+="\n\n"+c),l&&l.length>0&&(r+="\n\n"+l.map(t=>"#"+t).join(" "));const d=await n.insert({type:t.type,title:t.title,body:r,pinned:t.pinned,images:t.images,public:t.public?1:0,team:t.team,urlText:t.urlText,url:t.url,currency:t.currency,price:t.price,code:t.code,country:t.country,region:t.region,startDate:t.startDate,endDate:t.endDate,topic:o});d&&201===d.status&&(await n.loadPublicFeed({hashtags:l}),e.setState({story:{type:1,title:"",body:"",pinned:null,images:[],public:1,urlText:"",url:"",currency:"",price:null,code:"",country:"",region:"",startDate:null,endDate:null}},()=>{b.a.resizeTextarea(e.inputRef.newStoryBody),s&&e.addImage()}),i(d.data)),e.setState({sendButtonEnabled:!0})},this.addImages=({value:t})=>{const{story:e}=this.state;e.images.push(...t),this.setState({story:e})},this.removeImage=async function(t){const{story:s}=e.state,a=t.target.parentElement.dataset.name||t.target.dataset.name;if(o.a.isArray(s.images)){const t=s.images.findIndex(t=>t.name===a);t>-1&&s.images.splice(t,1)}e.setState({story:s})},this.addImage=()=>{const{showAddImage:t}=this.state;this.setState({showAddImage:!t})},this.changeVisibility=()=>{const{showChangeVisibility:t}=this.state;this.setState({showChangeVisibility:!t})},this.changePinned=()=>{const{showChangeVisibility:t}=this.state;this.setState({showChangeVisibility:!t})},this.changeType=()=>{const{showChangeType:t}=this.state;this.setState({showChangeType:!t})},this.toggleTeamChange=()=>{const{showTeamChange:t}=this.state;this.setState({showTeamChange:!t})},this.handleImageErrored=t=>{const e=t.target;e.onerror=null,setTimeout(()=>{e.src+="?"+new Date},1e3)},this.setPublicTeam=()=>{const{userStore:t}=this.props.stores,e=t.findPublicTeams();if(o.a.isArray(e)&&e.length>0){const{story:t}=this.state;t.team=e[0].id,this.setState({story:t})}},this.setFocus=t=>{this.setState({hasFocus:!0}),b.a.resizeTextarea(t.target)},this.removeFocus=()=>{this.setState({hasFocus:!1})},this.state=function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){i(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({story:{type:1,title:"",body:"",images:[],public:1,urlText:"",url:"",currency:"",price:0,code:"",country:"",region:"",startDate:"",endDate:""}},m),this.inputRef={}}componentDidMount(){this.setPublicTeam()}render(){const{col:e=12,offset:s=0,hashTags:a=[]}=this.props,{story:i={},showAddImage:l,showTeamChange:n,showChangeVisibility:m,showChangeType:p,sendButtonEnabled:u,hasFocus:O}=this.state,{userStore:g,appState:j}=this.props.stores,{user:f={},isAdmin:y}=g,v=f.firstname?`${o.a.ucfirst(f.firstname,!0)}${o.a.ucfirst(f.lastname,!0)}`:""+o.a.ucfirst(f.email||"",!0);let w=f.image||(f.images?f.images[0]:void 0);if(i.team){const t=parseInt(i.team,10),e=g.findTeam(t,!0);w=e.image||(e.images?e.images[0]:void 0)}const{darkmode:x}=j;return Object(c.h)("div",{class:"w-100 px-0"},Object(c.h)("div",{class:"row"},Object(c.h)("div",{class:`col-${e} offset-${s} col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 rounded rounded-lg pt-3 pb-1 bg-${x?"black":"white"} shadow-sm mb-1`},Object(c.h)("div",{class:"d-flex mb-0 position-relative w-100"},Object(c.h)("div",{class:"position-relative"},Object(c.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall pointerCursor",style:(w?`background-image: url('${w.s3SmallLink}'); background-size: cover;`:"")+" border-width: 3px !important;",onClick:this.toggleTeamChange},!w&&Object(c.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},v)),Object(c.h)("div",{class:"position-absolute",style:"top: 16px; right: 0px;"},Object(c.h)("small",{class:"text-white",style:"font-size: 1.5em;"},Object(c.h)("i",{class:"fas fa-caret-down pointerCursor",onClick:this.toggleTeamChange})))),Object(c.h)("div",{class:"col pl-3 pr-0",style:"line-height: 1.2em;"},Object(c.h)("div",{class:"d-flex bd-highlight"},Object(c.h)("div",{class:"p-0 w-100 bd-highlight"},Object(c.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(c.h)(r.c,{id:"story.body"},"Story")),Object(c.h)("div",{class:"border rounded rounded-lg position-relative"},Object(c.h)(r.b,null,Object(c.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(c.h)(r.c,{id:"story.write-body"},"Hva tenker du på?.."),onInput:Object(d.a)(this,"story.body"),onKeyUp:b.a.resizeTextarea,onFocus:this.setFocus,style:"height: 2.3em;",value:i.body,ref:t=>this.inputRef.newStoryBody=t})),O&&Object(c.h)("div",{class:"position-absolute",style:"bottom: 8px; right: 10px; font-size: 1.2em;"},Object(c.h)("i",{class:"fas fa-image pointerCursor","data-id":i.id,onClick:this.addImage}),Object(c.h)("i",{class:`fas fa-${1===i.public?"globe-europe":"users"} pointerCursor ml-2`,"data-id":i.id,onClick:this.changeVisibility}),y&&Object(c.h)("i",{class:"fas fa-cog pointerCursor ml-2","data-id":i.id,onClick:this.changeType}))),a&&a.length>0&&Object(c.h)(t,null,a.map(e=>Object(c.h)(t,null,Object(c.h)("span",{class:"badge badge-secondary mr-2 my-1"},Object(c.h)("a",{href:"/stories/tag/"+e,class:"text-white"},"#",e)))))),Object(c.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight pt-auto"},Object(c.h)("button",{type:"button",class:`btn btn-${u?"primary":"secondary"} ml-1`,disabled:!u,onClick:this.addStory},Object(c.h)("i",{class:"fas fa-paper-plane"})))))),Object(c.h)("div",null,Object(c.h)("div",{class:"row"},n&&Object(c.h)(t,null,Object(c.h)("div",{class:"col-12 text-center mt-2"},Object(c.h)("div",{class:"form-group"},Object(c.h)("small",null,Object(c.h)("select",{class:"custom-select custom-select-sm",id:"team",onInput:Object(d.a)(this,"story.team"),onChange:this.toggleTeamChange},Object(c.h)("option",{value:""},"-- ",Object(c.h)(r.c,{id:"story.team-choose"},"Velg team")," --"),o.a.isArray(f.teams)&&f.teams.map(t=>{const e=g.findTeam(t,!0);return e&&e.public?Object(c.h)("option",{value:e.id,selected:i.team==e.id?"selected":""},e.name):""}),!f.teams&&Object(c.h)(t,null,Object(c.h)("option",{value:""},"No public teams"))))))),m&&Object(c.h)(t,null,y&&Object(c.h)(t,null,Object(c.h)("div",{class:"col-12 text-center mt-2"},Object(c.h)("div",{class:"form-group"},Object(c.h)("small",null,Object(c.h)("label",{for:"pinned"},"Pinned to top:"),Object(c.h)("input",{id:"pinned",type:"checkbox",onInput:Object(d.a)(this,"story.pinned"),value:1,checked:i.pinned?1:0}))))),Object(c.h)("div",{class:"col-12 text-center mt-2"},Object(c.h)("div",{class:"form-group"},Object(c.h)("small",null,Object(c.h)("select",{class:"custom-select custom-select-sm",id:"team",onInput:Object(d.a)(this,"story.public"),value:i.public,onChange:this.changeVisibility},Object(c.h)("option",{value:0,selected:0==i.public?"selected":""},"👥 ",Object(c.h)(r.c,{id:"story.visibility-followers"},"Kun synlig for de som følger deg.")),Object(c.h)("option",{value:1,selected:1==i.public?"selected":""},"🌍 ",Object(c.h)(r.c,{id:"story.visibility-public"},"Synlig for alle som bruker appen."))))))),p&&Object(c.h)(t,null,Object(c.h)("div",{class:"col-12 text-center mt-2"},Object(c.h)("div",{class:"form-group"},Object(c.h)("small",null,Object(c.h)("select",{class:"custom-select custom-select-sm",id:"team",onInput:Object(d.a)(this,"story.type"),value:i.type,onChange:this.changeType},Object(c.h)("option",{value:""},"-- ",Object(c.h)(r.c,{id:"story.type-choose"},"Velg type")," --"),Object(c.h)("option",{value:1,selected:1==i.type?"selected":""},"✍️ ",Object(c.h)(r.c,{id:"story.type-regular"},"Vanlig")),Object(c.h)("option",{value:2,selected:2==i.type?"selected":""},"🚀 ",Object(c.h)(r.c,{id:"story.type-ad"},"Annonse")),Object(c.h)("option",{value:3,selected:3==i.type?"selected":""},"📄 ",Object(c.h)(r.c,{id:"story.type-article"},"Artikkel"))))))),l&&Object(c.h)(t,null,Object(c.h)("div",{class:"col-12 text-center mt-2"},Object(c.h)("div",{class:"container-fluid"},Object(c.h)("div",{class:"row"},o.a.isArray(i.images)&&i.images.map(t=>Object(c.h)("div",{class:"col-3 p-1"},Object(c.h)("img",{src:t.s3SmallLink,class:"img-fluid",onError:this.handleImageErrored}),Object(c.h)("button",{class:"btn btn-sm btn-link",onClick:this.removeImage,"data-name":t.name},Object(c.h)("i",{class:"fas fa-trash"})," Del"))))),Object(c.h)(h.a,{object:i,updateField:this.addImages,before:this.beforeImagesUploaded,after:this.afterImagesUploaded,autoOpen:!0}))),i.type>1&&Object(c.h)(t,null,Object(c.h)("div",{class:"col-12 mt-3"},Object(c.h)("label",null,Object(c.h)(r.c,{id:"story.url-text"},"URL text")),Object(c.h)("div",{class:"form-group"},Object(c.h)("small",null,Object(c.h)("input",{class:"form-control",type:"text",name:"urlText",onInput:Object(d.a)(this,"story.urlText"),value:i.urlText})))),Object(c.h)("div",{class:"col-12 mt-3"},Object(c.h)("label",null,Object(c.h)(r.c,{id:"story.url"},"URL")),Object(c.h)("div",{class:"form-group"},Object(c.h)("small",null,Object(c.h)("input",{class:"form-control",type:"text",name:"url",onInput:Object(d.a)(this,"story.url"),value:i.url}))))),2==i.type&&Object(c.h)(t,null,Object(c.h)("div",{class:"col-12 mt-3"},Object(c.h)("label",null,Object(c.h)(r.c,{id:"story.code"},"Code")),Object(c.h)("div",{class:"form-group"},Object(c.h)("small",null,Object(c.h)("input",{class:"form-control",type:"text",name:"code",onInput:Object(d.a)(this,"story.code"),value:i.code})))),Object(c.h)("div",{class:"col-12"},Object(c.h)("label",null,Object(c.h)(r.c,{id:"story.region"},"Region")),Object(c.h)("div",{class:"form-group"},Object(c.h)("small",null,Object(c.h)("input",{class:"form-control",type:"text",name:"region",onInput:Object(d.a)(this,"story.region"),value:i.region})))),Object(c.h)("div",{class:"col-12"},Object(c.h)("label",null,Object(c.h)(r.c,{id:"story.country"},"Country")),Object(c.h)("div",{class:"form-group"},Object(c.h)("small",null,Object(c.h)("input",{class:"form-control",type:"text",name:"country",onInput:Object(d.a)(this,"story.country"),value:i.country})))),Object(c.h)("div",{class:"col-4"},Object(c.h)("label",null,Object(c.h)(r.c,{id:"story.currency"},"Currency")),Object(c.h)("div",{class:"form-group"},Object(c.h)("small",null,Object(c.h)("input",{class:"form-control",type:"text",name:"currency",onInput:Object(d.a)(this,"story.currency"),value:i.currency})))),Object(c.h)("div",{class:"col-8"},Object(c.h)("label",null,Object(c.h)(r.c,{id:"story.price"},"Price")),Object(c.h)("div",{class:"form-group"},Object(c.h)("small",null,Object(c.h)("input",{class:"form-control",type:"text",name:"price",onInput:Object(d.a)(this,"story.price"),value:i.price}))))))))))}})||l;e.a=p}).call(this,s("hosL").Fragment)},B95u:function(t,e,s){"use strict";(function(t){function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function i(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){l(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function l(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var c,o=s("hosL"),n=s("Utv1"),r=s("/eY4"),d=s("cneo"),h=s("OhSV"),b=s("fh8t"),m=s.n(b),p=s("go65"),u=s("5uob"),O=(s("ETxl"),s("ZOvn"));const g={showAddComment:{},showAllComments:!1,showAllReplies:{},viewImageIdx:{},likeComment:{},likeReply:{},showOriginal:{}};let j=Object(r.a)(c=class extends o.Component{constructor(t){var e;super(t),e=this,this.addLikeComment=async function(t){const{callback:s=(()=>{})}=e.props,a=t.target.closest(".commentContainer").dataset.id,{story:i}=e.props,{storyStore:l}=e.props.stores,{likeComment:c}=e.state;c[a]=!0,e.setState({likeComment:c}),setTimeout(()=>{const{likeComment:t}=e.state;delete t[a],e.setState({likeComment:t})},1200);const o=await l.likeStoryComment({id:i.id,commentId:a});return o&&200===o.status&&s({type:"likeComment",story:i,commentId:a,response:o}),!0},this.likeReply=async function(t){const{callback:s=(()=>{})}=e.props,a=t.target.closest(".replyContainer").dataset.id,i=t.target.closest(".replyContainer").dataset.comment,{story:l}=e.props,{storyStore:c}=e.props.stores,{likeReply:o}=e.state;o[a]=!0,e.setState({likeReply:o}),setTimeout(()=>{const{likeReply:t}=e.state;delete t[a],e.setState({likeReply:t})},1200);const n=await c.likeStoryCommentReply({id:l.id,replyId:a,commentId:i});n&&200===n.status&&s({type:"likeReply",story:l,commentId:i,replyId:a,response:n})},this.replyComment=async function(t){const s=t.target.parentElement.dataset.id||t.target.dataset.id,{showAddComment:a}=e.state;a[s]=!a[s],e.setState({showAddComment:a},()=>{e.inputRef[s]&&e.inputRef[s].focus()})},this.toggleComments=()=>{const{showAllComments:t}=this.state;this.setState({showAllComments:!t})},this.toggleReplies=t=>{const e=t.target.parentElement.dataset.id||t.target.dataset.id,{showAllReplies:s}=this.state;s[e]=!s[e],this.setState({showAllReplies:s})},this.toggleMenu=t=>{const{id:e}=t.target.closest("i").dataset,{showMenu:s={}}=this.state;s[e]=!s[e],this.setState({showDeleteComment:{},showEdit:{},showMenu:s})},this.toggleEdit=t=>{const{id:e,comment:s}=t.target.closest("button").dataset,{showEdit:a={}}=this.state;a[e]=!a[e],this.setState({showDeleteComment:{},showEdit:a,showMenu:{},commentEditText:s})},this.toggleDeleteComment=t=>{const{id:e}=t.target.closest("button").dataset,{showDeleteComment:s={}}=this.state;s[e]=!s[e],this.setState({showDeleteComment:s,showEdit:{},showMenu:{}})},this.deleteComment=async function(t){const{id:s}=t.target.closest("button").dataset,{story:a}=e.props,{storyStore:i}=e.props.stores;await i.deleteCommentStory({id:a.id,commentId:s}),e.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}})},this.deleteCommentReply=async function(t){const{id:s,commentid:a}=t.target.closest("button").dataset,{story:i}=e.props,{storyStore:l}=e.props.stores;await l.deleteCommentReplyStory({id:i.id,commentId:a,replyId:s}),e.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}})},this.saveComment=async function(t){const{id:s}=t.target.closest("button").dataset,{commentEditText:a}=e.state,{story:i}=e.props,{storyStore:l}=e.props.stores;await l.editCommentStory({id:i.id,commentId:s,comment:a}),e.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}})},this.saveCommentReply=async function(t){const{id:s,commentid:a}=t.target.closest("button").dataset,{commentEditText:i}=e.state,{story:l}=e.props,{storyStore:c}=e.props.stores;await c.editCommentReplyStory({id:l.id,commentId:a,replyId:s,comment:i}),e.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}})},this.viewImage=t=>{const{id:e,idx:s}=t.target.closest("img").dataset,{viewImageIdx:a}=this.state;a[e]=s,this.setState({viewImageIdx:a})},this.translate=async function(t){t.preventDefault(),t.stopPropagation();const{replyid:s,commentid:a}=t.target.closest("button").dataset,{story:i}=e.props,{userStore:l,storyStore:c}=e.props.stores,{user:o}=l,{showOriginal:n={},translatedText:r={}}=e.state,d=`${a}${s?"-"+s:""}`;n[d]=0,r[d]=s?await c.translateCommentReply({commentid:a,replyid:s,story:i,user:o}):await c.translateComment({commentid:a,story:i,user:o}),e.setState({showOriginal:n,translatedText:r})},this.showOriginal=t=>{const{replyid:e,commentid:s}=t.target.closest("button").dataset;t.preventDefault(),t.stopPropagation();const{showOriginal:a={}}=this.state;a[`${s}${e?"-"+e:""}`]=1,this.setState({showOriginal:a})},this.displayTeam=(t,e)=>{t.preventDefault(),t.stopPropagation();const{appState:s}=this.props.stores;s.openDrawer("publicTeam",{teamId:e,height:"80vh"})},this.openInbox=(t,e)=>{t.preventDefault(),t.stopPropagation();const{appState:s}=this.props.stores;s.openDrawer("inboxDetail",{fromuser:e,height:"80vh"})},this.state=i(i({},g),{},{showAllComments:t.showAllComments}),this.inputRef={}}render(){const{showAddComment:e,showAllComments:s,showAllReplies:a,viewImageIdx:i,showMenu:l={},showEdit:c={},showDeleteComment:r={},commentEditText:b,likeComment:g,showOriginal:j={},translatedText:f={}}=this.state,{story:y,callback:v=(()=>{}),initCall:w=(()=>{}),compact:x=!1}=this.props,{userStore:k,storyStore:S}=this.props.stores,{user:C}=k,{language:I="en"}=C;let D,T=[],R=0,P=0;return y.comments&&(R=y.comments.length,s?T=y.comments:(D=x?0:2,T=y.comments.slice(Math.max(R-D,0))),P=T.length),Object(o.h)("div",null,y&&n.a.isArray(T)&&T.reverse().map(s=>{const{user:x={}}=s,k=S.findPublicTeamByMembers(x.id),T=O.a.displayNameShort(x),R=O.a.displayName(x),P=x.image||(x.images?x.images[0]:void 0),E=s.likes&&s.likes.findIndex(t=>t.user===C.id)>-1;let F=[],L=0,M=0;s.comments&&(L=s.comments.length,F=a[s.id]?s.comments:s.comments.slice(0,D),M=F.length);const A=[];if(s.images){const t=Object(d.i)(s.images);A.push(...t)}const $=i[s.id]?i[s.id]:0,N=A&&A[$]?A[$]:null,{currentLocationGeocode:B={}}=s,z=S.getCommentTranslations({story:y,commentid:s.id,targetLang:I})||f[s.id];let H=z||s.comment;return j[s.id]&&(H=s.comment),Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col-11 offset-1 d-flex mb-2 position-relative"},Object(o.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall",style:(P?`background-image: url("${P.s3SmallLink}"); background-size: cover;`:"")+" border-width: 3px !important;"},!x.image&&Object(o.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},T)),Object(o.h)("div",{class:"flex-grow-1 pl-3 pt-0",style:"line-height: 1.2em;"},Object(o.h)("div",{class:"bg-light p-2 rounded rounded-lg position-relative"},C.id===x.id&&Object(o.h)(t,null,Object(o.h)("span",{class:"float-right font-weight-lighter text-muted"},Object(o.h)("i",{class:"fas fa-ellipsis-h",onClick:this.toggleMenu,"data-id":s.id}))),l[s.id]&&Object(o.h)(t,null,Object(o.h)("div",{class:"position-absolute bg-white p-2 border rounded rounded-lg shadow-sm",style:"top: 30px; right: 10px; width: 60%; z-index: 999999;"},Object(o.h)("button",{class:"btn btn-link btn-block text-left",onClick:this.toggleEdit,"data-id":s.id,"data-comment":s.comment},Object(o.h)("i",{class:"fas fa-edit"})," Edit"),Object(o.h)("hr",null),Object(o.h)("button",{class:"btn btn-link btn-block text-left",onClick:this.toggleDeleteComment,"data-id":s.id},Object(o.h)("i",{class:"fas fa-trash-alt"})," Delete"))),Object(o.h)("div",null,Object(o.h)("span",{style:"font-size: 0.95em;"},Object(o.h)("h5",{class:"font-weight-bold mb-2",style:"font-size: 1.0em;"},x.uuidv4&&x.uuidv4!==C.uuidv4?Object(o.h)(t,null,Object(o.h)("a",{href:"/inbox/"+x.uuidv4,onClick:t=>this.openInbox(t,x.uuidv4)},R)):Object(o.h)(t,null,R),k&&k.length>0&&Object(o.h)(t,null,Object(o.h)("span",{class:"font-weight-lighter text-muted ml-1"},k.filter(t=>1===t.public).slice(0,1).map(e=>Object(o.h)(t,null,"- ",Object(o.h)("a",{href:"/teams/public/"+e.uuidv4,onClick:t=>this.displayTeam(t,e.uuidv4)},e.name)))))),c[s.id]?Object(o.h)(t,null,Object(o.h)("div",{class:"d-flex bd-highlight"},Object(o.h)("div",{class:"p-0 w-100 bd-highlight"},Object(o.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(o.h)(h.c,{id:"comments.comment"},"Kommentar")),Object(o.h)("div",{class:"border rounded rounded-lg position-relative"},Object(o.h)(h.b,null,Object(o.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(o.h)(h.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(p.a)(this,"commentEditText"),onKeyUp:O.a.resizeTextarea,onFocus:O.a.resizeTextarea,style:"height: 2.3em;",value:b})))),Object(o.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(o.h)("button",{type:"button",class:"btn btn-primary mb-2",onClick:this.saveComment,"data-id":s.id},Object(o.h)("i",{class:"fas fa-paper-plane"}))))):Object(o.h)(t,null,Object(o.h)(m.a,{markdown:O.a.replaceImages(H,s.images,I),markdownOpts:O.a.getMarkdownOptions()})),r[s.id]&&Object(o.h)("div",{class:"clearfix mt-3 mb-3"},Object(o.h)("button",{class:"btn btn-danger float-left",onClick:this.deleteComment,"data-id":s.id},Object(o.h)("i",{class:"fas fa-trash-alt"})," Delete"),Object(o.h)("button",{class:"btn btn-secondary float-right",onClick:this.toggleDeleteComment,"data-id":s.id},Object(o.h)("i",{class:"fas fa-times-circle"})," Cancel")))),Object(o.h)("div",null,Object(o.h)("div",{class:"container-fluid px-3 mt-1"},N&&Object(o.h)("div",{class:"clearfix row position-relative"},Object(o.h)("div",{class:"commentContainer col-12 px-0 overflow-hidden",style:"max-height: 60vh;",onDblclick:this.addLikeComment,"data-id":s.id},Object(o.h)("img",{loading:"lazy",class:"img-fluid",style:"min-width: 100px;",src:N.s3LargeLink})),g[s.id]&&Object(o.h)("span",{class:"likeHeart position-absolute text-white display-1",style:"top: calc(50% - 50px); left: calc(50% - 50px); width: 100px; height: 100px;"},Object(o.h)("i",{class:"fas fa-heart likeStory"}))),A&&A.length>1&&Object(o.h)("div",{class:"clearfix d-flex flex-wrap row"},n.a.isArray(A)&&A.map((e,a)=>Object(o.h)(t,null,Object(o.h)("div",{class:"col px-0 overflow-hidden",style:"max-height: 100px; min-width: 100px;"},Object(o.h)("img",{loading:"lazy",class:"img-fluid border",style:"min-width: 100px;",src:e.s3SmallLink,onClick:this.viewImage,"data-id":s.id,"data-idx":a})))))))),Object(o.h)("small",null,Object(o.h)("button",{class:"commentContainer btn btn-sm btn-link py-0 "+(E?"text-primary":""),onClick:this.addLikeComment,"data-id":s.id,disabled:E},E?Object(o.h)(h.c,{id:"comments.has-liked"},"Liked"):Object(o.h)(h.c,{id:"comments.like"},"Lik")),"-",Object(o.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.replyComment,"data-id":s.id},Object(o.h)(h.c,{id:"comments.comment-add"},"Kommentar")),s.language!==I&&Object(o.h)(t,null,"-",!j[s.id]&&z?Object(o.h)(t,null,Object(o.h)("button",{type:"button",class:"btn btn-sm btn-link","data-commentid":s.id,onClick:this.showOriginal},Object(o.h)("i",{class:"fas fa-cog"}),"  ",Object(o.h)(h.c,{id:"home.translate-show-original"},"Show original"))):Object(o.h)(t,null,Object(o.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:this.translate,"data-commentid":s.id},Object(o.h)("i",{class:"fas fa-cog"})," ",Object(o.h)(h.c,{id:"home.translate-to"},"See translation")))),"-",Object(o.h)("button",{class:"btn btn-sm btn-link py-0 disabled"},n.a.formatDistance(s.createdDate,new Date,{locale:"no-NB"}),s.updatedDate&&Object(o.h)(t,null,Object(o.h)("span",{class:"font-weight-light ml-2"},"(Edited ",n.a.formatDistance(s.updatedDate,new Date,{locale:"no-NB"}),")"))))),s.likes&&s.likes.length>0&&Object(o.h)("small",{class:"position-absolute bg-light shadow-sm rounded-lg py-0 px-1",style:"bottom: 20px; right: 15px;"},Object(o.h)("i",{class:"fas fa-thumbs-up text-primary"})," ",s.likes.length)),Object(o.h)("div",{class:"col-10 offset-2 mb-2"},s&&n.a.isArray(F)&&F.map(e=>{const{user:a={}}=e,i=S.findPublicTeamByMembers(a.id),d=O.a.displayNameShort(a),u=O.a.displayName(a),g=a.image||(a.images?a.images[0]:void 0),v=e.likes&&e.likes.findIndex(t=>t.user===C.id)>-1,{currentLocationGeocode:w={}}=e,x=S.getCommentReplyTranslations({story:y,commentid:s.id,replyid:e.id,targetLang:I})||f[`${s.id}-${e.id}`];let k=x||e.comment;return j[`${s.id}-${e.id}`]&&(k=e.comment),Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col-12 d-flex mb-2 position-relative"},Object(o.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall",style:(g?`background-image: url("${g.s3SmallLink}"); background-size: cover;`:"")+" border-width: 3px !important;"},!a.image&&Object(o.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},d)),Object(o.h)("div",{class:"flex-grow-1 pl-3 pt-0",style:"line-height: 1.2em;"},Object(o.h)("div",{class:"bg-light p-2 rounded-lg position-relative"},C.id===a.id&&Object(o.h)(t,null,Object(o.h)("span",{class:"float-right font-weight-lighter text-muted"},Object(o.h)("i",{class:"fas fa-ellipsis-h",onClick:this.toggleMenu,"data-id":e.id}))),l[e.id]&&Object(o.h)(t,null,Object(o.h)("div",{class:"position-absolute bg-white p-2 border rounded rounded-lg shadow-sm",style:"top: 30px; right: 10px; width: 60%; z-index: 999999;"},Object(o.h)("button",{class:"btn btn-link btn-block text-left",onClick:this.toggleEdit,"data-id":e.id,"data-comment":e.comment},Object(o.h)("i",{class:"fas fa-edit"})," Edit"),Object(o.h)("hr",null),Object(o.h)("button",{class:"btn btn-link btn-block text-left",onClick:this.toggleDeleteComment,"data-id":e.id},Object(o.h)("i",{class:"fas fa-trash-alt"})," Delete"))),Object(o.h)("span",{style:"font-size: 0.95em;"},Object(o.h)("h5",{class:"font-weight-bold mb-2",style:"font-size: 1.0em;"},a.uuidv4&&a.uuidv4!==C.uuidv4?Object(o.h)(t,null,Object(o.h)("a",{href:"/inbox/"+a.uuidv4,onClick:t=>this.openInbox(t,a.uuidv4)},u)):Object(o.h)(t,null,u),i&&i.length>0&&Object(o.h)(t,null,Object(o.h)("span",{class:"font-weight-lighter text-muted ml-2"},i.filter(t=>1===t.public).slice(0,1).map(e=>Object(o.h)(t,null,"- ",Object(o.h)("a",{href:"/teams/public/"+e.uuidv4,class:"mr-2",onClick:t=>this.displayTeam(t,e.uuidv4)}," ",e.name)))))),c[e.id]?Object(o.h)(t,null,Object(o.h)("div",{class:"d-flex bd-highlight"},Object(o.h)("div",{class:"p-0 w-100 bd-highlight"},Object(o.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(o.h)(h.c,{id:"comments.comment"},"Kommentar")),Object(o.h)("div",{class:"border rounded rounded-lg position-relative"},Object(o.h)(h.b,null,Object(o.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(o.h)(h.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(p.a)(this,"commentEditText"),onKeyUp:O.a.resizeTextarea,onFocus:O.a.resizeTextarea,style:"height: 2.3em;",value:b})))),Object(o.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(o.h)("button",{type:"button",class:"btn btn-primary mb-2",onClick:this.saveCommentReply,"data-commentid":s.id,"data-id":e.id},Object(o.h)("i",{class:"fas fa-paper-plane"}))))):Object(o.h)(t,null,Object(o.h)(m.a,{markdown:O.a.replaceImages(k,e.images,I),markdownOpts:O.a.getMarkdownOptions()})),r[e.id]&&Object(o.h)("div",{class:"clearfix mt-3 mb-3"},Object(o.h)("button",{class:"btn btn-danger float-left",onClick:this.deleteCommentReply,"data-id":e.id,"data-commentid":s.id},Object(o.h)("i",{class:"fas fa-trash-alt"})," Delete"),Object(o.h)("button",{class:"btn btn-secondary float-right",onClick:this.toggleDeleteComment,"data-id":e.id},Object(o.h)("i",{class:"fas fa-times-circle"})," Cancel")))),Object(o.h)("small",null,Object(o.h)("button",{class:"replyContainer btn btn-sm btn-link py-0 "+(v?"text-primary":""),onClick:this.likeReply,"data-comment":s.id,"data-id":e.id,disabled:v},v?Object(o.h)(h.c,{id:"comments.has-liked"},"Liked"):Object(o.h)(h.c,{id:"comments.like"},"Lik")),"-",Object(o.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.replyComment,"data-id":s.id},Object(o.h)(h.c,{id:"comments.comment-add"},"Kommentar")),e.language!==I&&Object(o.h)(t,null,"-",!j[`${s.id}-${e.id}`]&&x?Object(o.h)(t,null,Object(o.h)("button",{type:"button",class:"btn btn-sm btn-link","data-commentid":s.id,"data-replyid":e.id,onClick:this.showOriginal},Object(o.h)("i",{class:"fas fa-cog"}),"  ",Object(o.h)(h.c,{id:"home.translate-show-original"},"Show original"))):Object(o.h)(t,null,Object(o.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:this.translate,"data-commentid":s.id,"data-replyid":e.id},Object(o.h)("i",{class:"fas fa-cog"})," ",Object(o.h)(h.c,{id:"home.translate-to"},"See translation")))),"-",Object(o.h)("button",{class:"btn btn-sm btn-link py-0 disabled"},n.a.formatDistance(e.createdDate,new Date,{locale:"no-NB"}),e.updatedDate&&Object(o.h)(t,null,Object(o.h)("span",{class:"font-weight-light ml-2"},"(Edited ",n.a.formatDistance(e.updatedDate,new Date,{locale:"no-NB"}),")"))))),e.likes&&Object(o.h)("small",{class:"position-absolute bg-light shadow-sm rounded-lg py-0 px-1",style:"bottom: 20px; right: 15px;"},Object(o.h)("i",{class:"fas fa-thumbs-up text-primary"})," ",e.likes.length)))}),L-M>0&&Object(o.h)("div",null,Object(o.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.toggleReplies,"data-id":s.id},Object(o.h)(h.c,{id:"comments.show-more",fields:{more:L-M}},"Vis ",L-M," flere kommentarer...")))),e[s.id]&&Object(o.h)("div",{class:"col-11 offset-1 d-flex mb-2 position-relative"},Object(o.h)(u.a,{stores:this.props.stores,story:y,initCall:w,callback:v,commentId:s.id,inputRef:t=>this.inputRef[s.id]=t,inputRefObject:this.inputRef,key:"story-commentreply-"+s.id})))}),R-P>0&&Object(o.h)("div",null,Object(o.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.toggleComments},Object(o.h)(h.c,{id:"comments.show-more",fields:{more:R-P}},"Vis ",R-P," flere kommentarer..."))),s&&Object(o.h)("div",null,Object(o.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.toggleComments},Object(o.h)(h.c,{id:"comments.hide-all-comments"},"Skjul alle kommentarene."))))}})||c;e.a=j}).call(this,s("hosL").Fragment)},HGwV:function(t,e,s){"use strict";(function(t){function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function i(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var l,c=s("hosL"),o=(s("QRet"),s("Utv1"),s("/eY4")),n=(s("OhSV"),s("Y3FI")),r=s("zYNi"),d=s("ZOvn");const h=d.a.marginTop(!0,!1),b=(d.a.marginTopBack(!1),d.a.marginBottom(),d.a.subMenuMarginTop(),{isLoading:!1});let m=Object(o.a)(l=class extends c.Component{constructor(t){super(t),this.back=()=>{const{raceid:t}=this.props;Object(n.route)("/app-races/"+t)},this.state=function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){i(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},b),this.updateTimer={}}render(){const{userStore:e}=this.props.stores,{user:s={},teams:a=[]}=e,{raceid:i}=this.props;return Object(c.h)(t,null,Object(c.h)("div",{class:"container-fluid position-relative p-0",style:`margin-top: 0; height: calc(100vh - ${h}); z-index: 9999;`},Object(c.h)(r.a,{stores:this.props.stores,raceid:i})))}})||l;e.a=m}).call(this,s("hosL").Fragment)},ISGx:function(t,e,s){"use strict";(function(t){function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function i(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){l(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function l(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var c,o=s("hosL"),n=s("Utv1"),r=s("/eY4"),d=s("cneo"),h=s("OhSV"),b=s("fh8t"),m=s.n(b),p=s("Y3FI"),u=s("s4FZ"),O=s("ZQlJ"),g=s("sqi2"),j=s("/922"),f=s("eQ6k"),y=s("+JSK"),v=s("vY+r"),w=s("nHdA"),x=s("irB3"),k=s("UwwE"),S=s("8Lgr"),C=s("QkTp"),I=s("ZOvn");const D={showAddComment:{},likeWorkout:{},idxSuggestion:0,idxAd:4,limit:15,offset:0,hasFollowSugguestions:!1,hasAd:!1,sessionid:(new Date).getTime()};let T=Object(r.a)(c=class extends o.Component{constructor(t){var e;super(t),e=this,this.toggleDate=t=>{t.stopPropagation(),t.preventDefault();const{showDate:e}=this.state;this.setState({showDate:!e})},this.likeWorkout=async function(t){const s=parseInt(t.target.closest(".imageContainer").dataset.id,10),{workoutStore:a}=e.props.stores,{likeWorkout:i}=e.state;i[s]=!0,e.setState({likeWorkout:i}),setTimeout(()=>{const{likeWorkout:t}=e.state;delete t[s],e.setState({likeWorkout:t})},1200);const l=await a.likeWorkout({id:s});l&&200===l.status&&e.addLikeToFeed(s,l.data)},this.addCommentToFeed=({type:t,workout:e,response:s,commentId:a,replyId:i})=>{const{holdingStore:l="team"}=this.props;if("team"===l){const{teamStore:l}=this.props.stores;switch(t){case"likeComment":l.addLikeToComment({id:e.id,data:s.data,commentId:a});break;case"likeReply":l.addLikeToCommentReply({id:e.id,data:s.data,commentId:a,replyId:i});break;default:a?l.addCommentToWorkoutComment({id:e.id,data:s.data,commentId:a}):l.addCommentToWorkout({id:e.id,data:s.data})}}else if("story"===l){const{storyStore:l}=this.props.stores;switch(t){case"likeComment":l.workoutsAddLikeToComment({id:e.id,data:s.data,commentId:a});break;case"likeReply":l.workoutsAddLikeToCommentReply({id:e.id,data:s.data,commentId:a,replyId:i});break;default:a?l.workoutsAddCommentToWorkoutComment({id:e.id,data:s.data,commentId:a}):l.workoutsAddCommentToWorkout({id:e.id,data:s.data})}}},this.addLikeToFeed=(t,e)=>{const{holdingStore:s="team"}=this.props;if("team"===s){const{teamStore:s}=this.props.stores;s.addLikeToWorkout({id:t,data:e})}else if("story"===s){const{storyStore:s}=this.props.stores;s.workoutsAddLikeToWorkout({id:t,data:e})}},this.toggleAddComment=t=>{const e=t.target.closest("button").dataset.id,{showAddComment:s}=this.state;s[e]?delete s[e]:s[e]=!0,this.setState({showAddComment:s},()=>{this.inputRef[e]&&this.inputRef[e].focus()})},this.shareLink=t=>{const{url:e,title:s,text:a}=t.target.closest("button").dataset,{appState:i}=this.props.stores;i.shareUrl({url:e,title:s,text:a})},this.showWorkoutDetail=t=>{if("a"===t.target.localName)return!1;const e=t.target.closest("#workoutDetail");if(e){const{id:t}=e.dataset;t&&(console.log({target:e,id:t}),Object(p.route)("/workouts/public/"+t))}},this.translate=async function(t){t.preventDefault(),t.stopPropagation();const{feed:s={}}=e.props,{userStore:a,teamStore:i}=e.props.stores,{user:l}=a,c=await i.translate({object:s,user:l,field:"name"});let o;s.comment&&(o=await i.translate({object:s,user:l,field:"comment"})),e.setState({showOriginal:0,translatedTextName:c,translatedTextComment:o})},this.showOriginal=t=>{t.preventDefault(),t.stopPropagation(),this.setState({showOriginal:1})},this.displayTeam=(t,e)=>{t.preventDefault(),t.stopPropagation();const{appState:s}=this.props.stores;s.openDrawer("publicTeam",{teamId:e,height:"80vh"})},this.openInbox=(t,e)=>{t.preventDefault(),t.stopPropagation();const{appState:s}=this.props.stores;s.openDrawer("inboxDetail",{fromuser:e,height:"80vh"})},this.state=i({},D),this.inputRef={},this.containerRef=null}render(){const{feed:e,onTeamClick:s=(()=>{}),onUserClick:a=(()=>{}),onDogClick:l=(()=>{}),holdingStore:c="team"}=this.props,{showAddComment:r,showDate:b,likeWorkout:p,showOriginal:D,translatedTextName:T,translatedTextComment:R}=this.state,{teamStore:P,storyStore:E,userStore:F,appState:L}=this.props.stores,{user:M,isAdmin:A}=F,{language:$="en"}=M,{hasShareApi:N}=L;let B,z={},H={};if("team"===c){z=P.findPublicTeam(e.team),H=P.findPublicUser(e.user)||{};const{publicDogs:t}=P;B=t}else if("story"===c){z=E.findPublicTeam(e.team),H=E.findPublicUser(e.user)||{};const{publicDogs:t}=E;B=t}F.findTeamAmbition({ambition:z.ambitions,language:$});const U=F.findTeamType({type:z.type,language:$}),V=!(!z||!z.members)&&z.members.some(t=>t===M.id),q=I.a.getImage({user:H,team:z,object:e,priority:"user"}),{likes:K,comments:W}=e,Y=e.likes&&e.likes.findIndex(t=>t.user===M.id)>-1,G=z&&z.followers?z.followers.length:0,Z=z.members&&z.members.indexOf(M.id)>-1,J=z&&z.followers&&z.followers.indexOf(M.id)>-1,Q=z.followRequests&&z.followRequests.findIndex(t=>t.id===M.id)>-1,X=F.findEquipment({equipment:e.equipment,language:$}),_=F.findEquipment({equipment:e.equipment,field:"icon"}),{gpxInfo:tt={}}=e;let et,st,at,it;H&&(et=I.a.displayNameShort(H),st=I.a.displayName(H),at=I.a.displayName(H),H.settings&&H.uuidv4!==M.uuidv4&&(it=H.settings.hideProfile?null:"/inbox/"+H.uuidv4));const lt=[];if(e.mapImage&&lt.push(i(i({},e.mapImage),{},{type:"map"})),e.images){const t=Object(d.i)(e.images);lt.push(...t)}const{currentLocationGeocode:ct={},yrWeather:ot=[]}=e,nt=I.a.getViews(e.statistics),rt=I.a.getAdminData(e.statistics);if(!z||!z.name)return"";const dt=I.a.getTranslation({object:e,targetLang:$,field:"name"})||T;let ht=dt||e.name;let bt=I.a.getTranslation({object:e,targetLang:$,field:"comment"})||R||e.comment;return D&&(ht=e.name,bt=e.comment),Object(o.h)(t,null,Object(o.h)("div",{class:"d-flex position-relative"},Object(o.h)("div",{class:"text-center"},Object(o.h)("div",{class:"position-relative text-center border rounded-circle imageRounded imageRoundedMedium",style:q?`background-image: url("${q}"); background-size: cover;`:""},!q&&Object(o.h)("i",{class:"fas fa-users text-muted mt-2",style:"font-size: 20px;"}))),Object(o.h)("div",{class:"flex-grow-1 pl-3 text-overflow",style:"line-height: 1.2em;"},Object(o.h)("span",{class:"badge badge-pill badge-secondary float-right"},U),Object(o.h)("h5",{class:"mb-1 position-relative",style:"line-height: 1.0em;"},z.public?Object(o.h)(t,null,Object(o.h)("a",{href:"/teams/public/"+z.uuidv4,onClick:t=>this.displayTeam(t,z.uuidv4),class:"stretched-link"},z.name)):Object(o.h)(t,null,z.name)),Object(o.h)("div",{class:"mb-2"},e.date&&Object(o.h)("small",{class:"text-muted",onClick:this.toggleDate},b?n.a.formatDate(e.date,{locale:"no-NB",hour12:!1,hour:"2-digit",minute:"2-digit"}):n.a.formatDistance(e.date,new Date,{locale:"no-NB"})),1===e.public?Object(o.h)(t,null,Object(o.h)("small",{class:"ml-2 text-muted"},Object(o.h)("i",{class:"fas fa-globe-europe"}))):Object(o.h)(t,null,Object(o.h)("small",{class:"ml-2 text-muted"},Object(o.h)("i",{class:"fas fa-users"})," (",n.a.format(G),")")),at&&Object(o.h)(t,null,Object(o.h)("small",{class:"ml-2 text-muted"},it?Object(o.h)(t,null,Object(o.h)("i",{class:"fas fa-user"})," ",Object(o.h)("a",{href:it,onClick:t=>this.openInbox(t,H.uuidv4)},at)):Object(o.h)(t,null,Object(o.h)("i",{class:"fas fa-user"})," ",at))),Object(o.h)("small",{class:"text-muted"},e.equipment>0&&Object(o.h)(t,null,Object(o.h)("i",{class:_+" ml-2"})," ",X),e.dogs>0&&Object(o.h)(t,null,Object(o.h)("i",{class:"fas fa-dog ml-2"})," ",e.dogs.length),e.track>0&&Object(o.h)(t,null,Object(o.h)("i",{class:`fas fa-map-marked text-${e.track>0?"success":"danger"} ml-2`})),e.sledWeight>0&&Object(o.h)(t,null,Object(o.h)("i",{class:"fas fa-sleigh ml-2"})," ",Object(o.h)(k.a,{stores:this.props.stores,value:e.sledWeight})),0!==e.temperature&&Object(o.h)(t,null,Object(o.h)("i",{class:"fas fa-temperature-low ml-2"})," ",Object(o.h)(C.a,{stores:this.props.stores,value:e.temperature})),e.dogs&&e.dogs.length>0&&Object(o.h)(t,null,Object(o.h)("i",{class:"fas fa-dog ml-2"})," ",n.a.format(e.dogs.length,0)),ct&&ct.formattedCounty&&Object(o.h)(t,null,Object(o.h)("i",{class:"fas fa-map-marker-alt ml-2"})," ",ct.formattedCounty),e.moonIllumination&&e.moonIllumination.phaseIcon&&Object(o.h)("span",{class:"float-right ml-2"},e.moonIllumination.phaseIcon))),A&&Object(o.h)("div",{class:"d-flex flex-row flex-nowrap bg-light border-top border-bottom py-2",style:"overflow: auto;"},Object(o.h)("small",{class:"text-muted mr-2"},"Adm:"),ct&&ct.formatted_address&&Object(o.h)(t,null,Object(o.h)("small",{class:"text-muted"},Object(o.h)("i",{class:"fas fa-map-marker-alt"})," ",ct.formatted_address)),H.deviceInfo&&Object(o.h)(t,null,Object(o.h)("span",{class:"badge badge-secondary ml-1 float-right font-weight-light"},["platform","manufacturer","model"].map(e=>Object(o.h)(t,null,Object(o.h)("span",{class:"ml-1 text-white"},H.deviceInfo[e]))))),rt&&Object(o.h)(t,null,Object(o.h)("small",{class:"ml-2 text-muted"},"V: ",rt.count),Object(o.h)("small",{class:"ml-2 text-muted"},"R: ",rt.ranking," ",n.a.isNumber(rt.rankingTrend)&&Object(o.h)(t,null,Object(o.h)("i",{class:I.a.getClassForTrend(rt.rankingTrend)}))),Object(o.h)("small",{class:"ml-2 text-muted"},"D: ",n.a.format(rt.durationAvg/1e3,1),"s ",n.a.isNumber(rt.durationAvgTrend)&&Object(o.h)(t,null,Object(o.h)("i",{class:I.a.getClassForTrend(rt.durationAvgTrend)}))),e.statisticsCurrent&&e.statisticsCurrent.totalInteractions>0&&Object(o.h)("small",{class:"ml-2 text-muted"},"S: ",n.a.format(e.statisticsCurrent.totalInteractions,0)),e.shadowTags&&e.shadowTags.map(e=>Object(o.h)(t,null,Object(o.h)("span",{class:"badge badge-secondary ml-2 float-right font-weight-light"},e))))))),Object(o.h)("div",{class:"container-fluid px-0 mt-1"},Object(o.h)("div",{class:"row"},Object(o.h)(u.a,{stores:this.props.stores,images:lt,id:e.id,dblClick:this.likeWorkout,likeRef:p}))),e.dogs&&e.dogs.length>0&&Object(o.h)("div",{class:"container-fluid px-0 mt-1"},Object(o.h)("div",{class:"row pt-2"},Object(o.h)(O.a,{stores:this.props.stores,dogs:e.dogs,allDogs:B,onDogClick:l}))),Object(o.h)("div",{class:"d-flex justify-content-between bg-light rounded-lg px-2"},e.distanceKm>0&&Object(o.h)("div",{class:"mr-2 text-center"},Object(o.h)("div",{class:"text-overflow text-muted"},Object(o.h)("small",null,Object(o.h)("i",{class:"fas fa-road"})," ",Object(o.h)(h.c,{id:"workout.calendar.distance"},"Distanse"))),Object(o.h)("div",{class:"text-overflow font-weight-light",style:"font-size: 1.2em;"},Object(o.h)(S.a,{stores:this.props.stores,value:e.distanceKm}))),e.elevation>0&&Object(o.h)("div",{class:"mr-2 text-center"},Object(o.h)("div",{class:"text-overflow text-muted"},Object(o.h)("small",null,Object(o.h)("i",{class:"fas fa-mountain"})," ",Object(o.h)(h.c,{id:"workout.calendar.ascend"},"Høydemeter"))),Object(o.h)("div",{class:"text-overflow font-weight-light",style:"font-size: 1.2em;"},Object(o.h)(x.a,{stores:this.props.stores,value:e.elevation}))),e.duration>0&&Object(o.h)("div",{class:"mr-2 text-center"},Object(o.h)("div",{class:"text-overflow text-muted"},Object(o.h)("small",null,Object(o.h)("i",{class:"fas fa-clock"})," ",Object(o.h)(h.c,{id:"workout.calendar.duration"},"Varighet"))),Object(o.h)("div",{class:"text-overflow font-weight-light",style:"font-size: 1.2em;"},n.a.secToHms(e.duration,!0))),e.speedAvg>0&&Object(o.h)("div",{class:"text-center"},Object(o.h)("div",{class:"text-overflow text-muted"},Object(o.h)("small",null,Object(o.h)("i",{class:"fas fa-tachometer-alt"})," ",Object(o.h)(h.c,{id:"workout.calendar.avg-speed"},"Snittfart"))),Object(o.h)("div",{class:"text-overflow font-weight-light",style:"font-size: 1.2em;"},tt&&tt.avgGpsMovingSpeed>0?Object(o.h)(t,null,Object(o.h)(w.a,{stores:this.props.stores,value:3.6*tt.avgGpsMovingSpeed})):Object(o.h)(t,null,Object(o.h)(w.a,{stores:this.props.stores,value:e.speedAvg}))))),Object(o.h)("div",{class:"row mt-2"},Object(o.h)("div",{id:"workoutDetail",class:"clearfix col-12 font-weight-bold",style:"font-size: 1.2em;",onClick:this.showWorkoutDetail,"data-id":e.uuidv4},Object(o.h)(m.a,{markdown:I.a.replaceImages(ht,e.images,$),markdownOpts:I.a.getMarkdownOptions()})),Object(o.h)("div",{class:"clearfix col-12"},Object(o.h)(m.a,{markdown:I.a.replaceImages(bt,e.images,$),markdownOpts:I.a.getMarkdownOptions()})),e.language!==$&&Object(o.h)(t,null,!D&&dt?Object(o.h)(t,null,Object(o.h)("button",{type:"button",class:"btn btn-sm btn-link text-muted",onClick:this.showOriginal},Object(o.h)("i",{class:"fas fa-cog"}),"  ",Object(o.h)(h.c,{id:"home.translate-show-original"},"Show original"))):Object(o.h)(t,null,Object(o.h)("button",{type:"button",class:"btn btn-sm btn-link text-muted",onClick:this.translate},Object(o.h)("i",{class:"fas fa-cog"})," ",Object(o.h)(h.c,{id:"home.translate-to"},"See translation"))))),Object(o.h)("div",{class:"mt-2"},Object(o.h)(y.a,{stores:this.props.stores,likes:K,comments:W,type:"team",onTeamClick:s,onUserClick:a})),!Z&&!J&&!Q&&Object(o.h)("div",{class:"clearfix mb-2"},Object(o.h)(f.a,{stores:this.props.stores,team:z,buttonOnly:!0})),Object(o.h)("div",null,Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col text-center"},Object(o.h)("button",{type:"button",class:`imageContainer btn btn-sm btn-outline-${Y?"primary":"secondary"} btn-lg btn-block ${Y?"text-primary":""} text-overflow`,"data-id":e.id,onClick:this.likeWorkout},Object(o.h)("i",{class:(Y?"text-primary fas":"far")+" fa-thumbs-up"})," ",Object(o.h)(h.c,{id:"comments.like"},"Lik"))),Object(o.h)("div",{class:"col text-center"},Object(o.h)("button",{type:"button",class:"btn btn-sm btn-outline-secondary btn-lg btn-block text-overflow","data-id":e.id,onClick:this.toggleAddComment},Object(o.h)("i",{class:"fas fa-comment"})," ",Object(o.h)(h.c,{id:"comments.comment-add"},"Kommentar"))),N?Object(o.h)(t,null,Object(o.h)("div",{class:"col text-center"},Object(o.h)("button",{class:"btn btn-sm btn-outline-secondary btn-lg btn-block text-overflow",onClick:this.shareLink,"data-url":"https://themusher.app/share/workout/"+e.uuidv4,"data-title":"title: "+e.title},Object(o.h)("i",{class:"fas fa-share"})," ",Object(o.h)(h.c,{id:"story.share"},"Del")))):Object(o.h)(t,null,Object(o.h)("div",{class:"col text-center"},Object(o.h)("a",{class:"btn btn-sm btn-outline-secondary btn-lg btn-block text-overflow",href:"https://themusher.app/share/workout/"+e.uuidv4,target:"_blank",rel:"noreferrer","data-native":!0},Object(o.h)("i",{class:"fas fa-share"})," ",Object(o.h)(h.c,{id:"story.share"},"Del")))))),nt>0&&Object(o.h)(t,null,Object(o.h)("div",{class:"mt-2"},Object(o.h)(v.a,{stores:this.props.stores,views:nt,object:e,type:"team",isTeamAdmin:V,isAdmin:A,onTeamClick:s,onUserClick:a}))),Object(o.h)("div",{class:"mt-2"},r[e.id]&&Object(o.h)(j.a,{stores:this.props.stores,workout:e,inputRef:t=>this.inputRef[e.id]=t,inputRefObject:this.inputRef,col:"12",offset:"0",showAvatar:!0,extraClass:"px-0",callback:this.addCommentToFeed}),Object(o.h)(g.a,{stores:this.props.stores,workout:e,col:"12",offset:"0",compact:!1,callback:this.addCommentToFeed})))}})||c;e.a=T}).call(this,s("hosL").Fragment)},J9nn:function(t,e,s){"use strict";(function(t){var a,i=s("hosL"),l=(s("Utv1"),s("/eY4")),c=s("OhSV");s("Y3FI"),s("fh8t"),s("go65"),s("ZOvn");let o=Object(l.a)(a=class extends i.Component{constructor(t){var e;super(t),e=this,this.subscribeNotificationTopic=async function(t){const{userStore:s}=e.props.stores,{user:a}=s,{notificationTopics:i={}}=a;await s.setNotificationTopic({field:"notificationTopics."+t,value:1})},this.state={},this.inputRef={},this.updateTimer={}}render(){const{userStore:e}=this.props.stores,{user:s={},teams:a=[]}=e,{language:l="en"}=s,{notificationTopics:o={}}=s,{race:n={}}=this.props,r="race-"+n.id;return o&&o[r]?"":Object(i.h)(t,null,Object(i.h)("div",{class:"row"},Object(i.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2"},Object(i.h)("button",{class:"btn btn-block btn-info btn-lg",onClick:()=>this.subscribeNotificationTopic(r)},Object(i.h)("i",{class:"fas fa-bell"})," ",Object(i.h)(c.c,{id:"race.notifications"},"Subscribe to race notifications")))))}})||a;e.a=o}).call(this,s("hosL").Fragment)},KOz6:function(t,e,s){"use strict";(function(t){function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function i(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){l(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function l(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var c,o=s("hosL"),n=s("/eY4"),r=(s("cneo"),s("Utv1")),d=s("OhSV"),h=s("go65");let b=Object(n.a)(c=class extends o.Component{constructor(t){var e;super(t),e=this,this.handleAdd=()=>{const{data:t}=this.state,{updateField:e,object:s,field:a}=this.props;e({id:s.id,field:a,value:i({},t)}),this.setState({data:{name:"",description:"",url:""}})},this.removeAchievement=async function(t){const{dogStore:s}=e.props.stores,{object:a}=e.props,{name:i,id:l}=t.target.closest("button").dataset;s.removeAchievement({id:a.id,name:i,achievementId:l})},this.state={data:{}}}render(){const{data:e}=this.state,{showFiles:s=!0,object:a={}}=this.props;return Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col-12 mt-3"},s&&Object(o.h)(t,null,Object(o.h)("div",{class:"container-fluid"},Object(o.h)("div",{class:"row"},(!a.achievements||0===a.achievements.length)&&Object(o.h)(t,null,Object(o.h)("div",{class:"text-center text-muted"},Object(o.h)("div",{class:"display-1"},Object(o.h)("i",{class:"fas fa-trophy"})),Object(o.h)("h3",null,Object(o.h)(d.c,{id:"dogs.no-achievements-title"},"No achievements for this dog!")),Object(o.h)(d.c,{id:"dogs.no-achievements-text"},"You can add achievements to this dog. Ie. Memories, trips, tests, prices, races, etc."))),a.achievements&&a.achievements.map(t=>Object(o.h)("div",{class:"col-12 p-1"},Object(o.h)("span",{class:"font-weight-lighter mr-2"},r.a.isoDate(t.date,!1,!1,!0)),Object(o.h)("span",{class:"mr-2"},t.name),Object(o.h)("span",{class:"mr-2"},t.url),Object(o.h)("button",{class:"btn btn-sm btn-link float-right p-0",onClick:this.removeAchievement,"data-name":t.name,"data-id":t.id},Object(o.h)("i",{class:"fas fa-trash-alt"})," Del"))))))),Object(o.h)("div",{class:"col-12 mt-3"},Object(o.h)("details",null,Object(o.h)("summary",null,Object(o.h)(d.c,{id:"dogs.achievement-add"},"Add new achievement")),Object(o.h)("div",{class:"form-group"},Object(o.h)("label",{for:"name"},Object(o.h)(d.c,{id:"dogs.achievement-name"},"Name")),Object(o.h)("input",{type:"text",class:"form-control",id:"name","aria-describedby":"nameHelp",onInput:Object(h.a)(this,"data.name"),value:e.name}),Object(o.h)("small",{id:"nameHelp",class:"form-text text-muted"},Object(o.h)(d.c,{id:"dogs.achievement-name-help"},"Name of achievement"))),Object(o.h)("div",{class:"form-group"},Object(o.h)("label",{for:"date"},Object(o.h)(d.c,{id:"dogs.achievement-date"},"Date")),Object(o.h)("input",{type:"date",class:"form-control",id:"date","aria-describedby":"dateHelp",onInput:Object(h.a)(this,"data.date"),value:e.date}),Object(o.h)("small",{id:"dateHelp",class:"form-text text-muted"},Object(o.h)(d.c,{id:"dogs.achievement-date-help"},"Date of achievement"))),Object(o.h)("div",{class:"form-group"},Object(o.h)("label",{for:"description"},Object(o.h)(d.c,{id:"dogs.achievement-description"},"Description")),Object(o.h)("input",{type:"text",class:"form-control",id:"description","aria-describedby":"descriptionHelp",onInput:Object(h.a)(this,"data.description"),value:e.description}),Object(o.h)("small",{id:"descriptionHelp",class:"form-text text-muted"},Object(o.h)(d.c,{id:"dogs.achievement-description-help"},"Description of achievement"))),Object(o.h)("div",{class:"form-group"},Object(o.h)("label",{for:"url"},Object(o.h)(d.c,{id:"dogs.achievement-url"},"Url")),Object(o.h)("input",{type:"text",class:"form-control",id:"url","aria-describedby":"urlHelp",onInput:Object(h.a)(this,"data.url"),value:e.url}),Object(o.h)("small",{id:"urlHelp",class:"form-text text-muted"},Object(o.h)(d.c,{id:"dogs.achievement-url-help"},"URL of achievement"))),Object(o.h)("button",{class:"btn btn-success",onClick:this.handleAdd},Object(o.h)(d.c,{id:"dogs.achievement-add"},"Add achievement")))))}})||c;e.a=b}).call(this,s("hosL").Fragment)},LbFk:function(t,e,s){"use strict";(function(t){function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function i(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){l(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function l(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var c,o,n=s("hosL"),r=s("Utv1"),d=s("/eY4"),h=(s("OhSV"),s("fh8t"),s("go65")),b=s("cneo");s("ZOvn");const m=t=>(e,s)=>t.map(t=>{let a=1;return"-"===t[0]&&(a=-1,t=t.substring(1)),e[t]>s[t]?a:e[t]<s[t]?-a:0}).reduce((t,e)=>t||e,0);let p=Object(d.a)(c=class extends n.Component{render(){const{lastResults:e=[],currentClass:s={},selectedMusher:a={},selectResult:i=(()=>{})}=this.props,{userStore:l}=this.props.stores,{user:c={}}=l,{language:o="en"}=c;return Object(n.h)(t,null,Object(n.h)("table",{class:"table table-striped"},Object(n.h)("thead",null,Object(n.h)("tr",null,Object(n.h)("th",{style:"width: 10%"},"Time"),Object(n.h)("th",{style:"width: 5%"},"Dir"),Object(n.h)("th",{style:"width: 75%"},"Checkpoint"),Object(n.h)("th",{style:"width: 10%"},"Dogs"))),Object(n.h)("tbody",null,e&&e.length>0&&e.map(e=>{const l=s.checkpoints?s.checkpoints.find(t=>t.id===e.checkpoint):null,c="in"===e.direction&&l.requiredRestMinutes?l.timeEqualization?a.timeEqualization+l.requiredRestMinutes:l.requiredRestMinutes:null;new Date(new Date(e.timestamp).getTime()+6e4*c);return Object(n.h)(t,null,Object(n.h)("tr",{class:"resultLine","data-resultid":e.id,onClick:i},Object(n.h)("td",null,Object(n.h)("nobr",null,Object(n.h)("span",{class:"text-muted"},Object(n.h)("i",{class:"fas fa-clock"}))," ",r.a.formatDate(e.timestamp,{locale:o,year:"2-digit",month:"2-digit",hour12:!1,hour:"2-digit",minute:"2-digit"}))),Object(n.h)("td",null,"in"===e.direction&&Object(n.h)(t,null,Object(n.h)("i",{class:"fas fa-sign-in-alt mr-2 text-success"})),"out"===e.direction&&Object(n.h)(t,null,Object(n.h)("i",{class:"fas fa-sign-out-alt mr-2 text-info"})),"scratched"===e.direction&&Object(n.h)(t,null,Object(n.h)("i",{class:"fas fa-times mr-2 text-danger"}))),Object(n.h)("td",null,Object(n.h)("span",{class:"text-muted"},l.sortOrder,":")," ",l.name),Object(n.h)("td",null,Object(n.h)("nobr",null,Object(n.h)("span",{class:"text-muted"},Object(n.h)("i",{class:"fas fa-dog ml-3"}))," ",e.dogs,Object(n.h)("br",null)))))}))))}})||c,u=Object(d.a)(o=class extends n.Component{constructor(t){var e;super(t),e=this,this.addResult=async function(t){const{raceStore:s,appState:a}=e.props.stores,{direction:l,classid:c}=t.target.closest("button").dataset,{checkpointId:o,selectedClassIds:n=[]}=a,r=s.getClassById(n[0]),d=r.checkpoints?r.checkpoints.find(t=>t.id===o):null,{result:h,showTimestamp:b}=e.state,{race:m}=s,p=m.id;h.timestamp=b&&h.timestamp?h.timestamp:new Date,"scratched"===l&&(await s.addResult({id:p,classId:c,showTimestamp:!1,newResult:i({direction:"in",checkpoint:o},h)}),await s.editContestant({id:p,classId:c,bib:h.bib,field:"raceStatus",value:"DNF"})),await s.addResult({id:p,classId:c,showTimestamp:!1,newResult:i({direction:l,checkpoint:o},h)}),e.setState({result:{bib:"",dogs:"",timestamp:""},selectedMusher:null,lastResults:null,message:`Added ${h.bib} with ${h.dogs} dogs ${l} ${"in"===l?"to":"of"} checkpoint ${d.name}.`}),clearTimeout(e.updateTimer.message),e.updateTimer.message=setTimeout((async function(){e.setState({message:""})}),3e3)},this.editResult=t=>{const{raceStore:e,appState:s}=this.props.stores,{currentResult:a}=this.state,{race:i}=e,l=i.id,c=t.target.id,o=t.target.value,{classid:n,resultid:d}=t.target.dataset;a[c]=o,this.setState({currentResult:a});const{selectedClassIds:h=[]}=s,b=h[0],m={raceClassId:n,resultId:d,["raceClassResult"+r.a.ucfirst(c)]:o};clearTimeout(this.updateTimer[c]),this.updateTimer[c]=setTimeout((async function(){await e.editClass({id:l,data:m}),e.updateClassesResultLocal(n,d,c,o);const t=e.getClassById(b),{checkpoints:s=[],contestants:a=[],results:i=[]}=t;e.sortContestantsByResult({contestants:a,results:i,checkpoints:s})}),500)},this.updateField=t=>{const{raceStore:e,appState:s}=this.props.stores,{race:a}=e,i=t.target.id,l=t.target.value,{selectedClassIds:c=[]}=s,o=e.getClassById(c[0]),{result:n,selectedResult:d,showTimestamp:h}=this.state;n[i]=l;const{checkpointId:p}=s,{sortedContestants:u=[]}=e,O=o.checkpoints?o.checkpoints.find(t=>t.id===p):null,g=u?u.find(t=>t.bib===parseInt(n.bib,10)):null;if(!g)return this.setState({result:n}),!1;let j,f,y,v,w,x,k,S,C;o&&(j=o.results?o.results.slice().sort(m(["-timestamp","-direction"])).filter(t=>parseInt(t.bib,10)===parseInt(n.bib,10)):null,j&&j.length>0&&(f=j.find(t=>t.checkpoint===p&&"in"===t.direction),y=j.find(t=>t.checkpoint===p&&"out"===t.direction),v=j.find(t=>t.checkpoint===p&&"scratched"===t.direction),x=e.getPreviousCheckpoint({currentClass:o,checkpointId:p}),x&&(k=j.find(t=>t.checkpoint===x.id&&"in"===t.direction),S=j.find(t=>t.checkpoint===x.id&&"out"===t.direction),C=j.find(t=>t.checkpoint===x.id&&"scratched"===t.direction))),w=o.results?Object(b.i)(o.results.slice().find(t=>t.id===d)):{});const I=j&&j[0]?j[0]:null;if(I){const t=j&&j[0]?j[0].timestamp:g&&g.startTime?g.startTime:o.startDate;h&&(n.timestamp=r.a.isoDate(t,!1,!1,!1)),n.dogs=I.dogs}this.setState({result:n,selectedCheckpoint:O,selectedMusher:g,isCheckedIn:f,isCheckedOut:y,isScratched:v,isCheckedInPrev:k,isCheckedOutPrev:S,isScratchedPrev:C,prevCheckpoint:x,currentResult:w,lastResults:j})},this.deleteResult=async function(){const{selectedResult:t}=e.state,{appState:s,raceStore:a}=e.props.stores,{race:i}=a,l=i.id,{selectedClassIds:c=[]}=s,o=a.getClassById(c[0]),n={raceClassId:o.id,resultId:t,raceClassResultDelete:1};await a.editClass({id:l,data:n});const{checkpoints:r=[],contestants:d=[],results:h=[]}=o;a.sortContestantsByResult({contestants:d,results:h,checkpoints:r}),e.doneEditResult()},this.selectCheckpoint=t=>{const{result:e}=this.state,s=t.target.closest("button").dataset.id,{appState:a,raceStore:i}=this.props.stores;a.selectCheckpoint(s);const{selectedClassIds:l=[]}=a,c=i.getClassById(l[0]),o=c.checkpoints?c.checkpoints.find(t=>t.id===s):null,{sortedContestants:n=[]}=i,r=n?n.find(t=>t.bib===parseInt(e.bib,10)):null,d=c.results?c.results.slice().sort(m(["-timestamp","-direction"])).filter(t=>parseInt(t.bib,10)===parseInt(e.bib,10)):null,h=d.find(t=>t.checkpoint===s&&"in"===t.direction),b=d.find(t=>t.checkpoint===s&&"out"===t.direction),p=d.find(t=>t.checkpoint===s&&"scratched"===t.direction),u=i.getPreviousCheckpoint({currentClass:c,checkpointId:s}),O=d.find(t=>t.checkpoint===u.id&&"in"===t.direction),g=d.find(t=>t.checkpoint===u.id&&"out"===t.direction),j=d.find(t=>t.checkpoint===u.id&&"scratched"===t.direction);this.setState({selectedCheckpoint:o,selectedMusher:r,isCheckedIn:h,isCheckedOut:b,isScratched:p,isCheckedInPrev:O,isCheckedOutPrev:g,isScratchedPrev:j,lastResults:d})},this.toggleTimestamp=()=>{const{showTimestamp:t,result:e}=this.state,{appState:s,raceStore:a}=this.props.stores,{selectedClassIds:i=[]}=s,l=a.getClassById(i[0]),c=l.contestants?l.contestants.find(t=>t.bib===parseInt(e.bib,10)):null,o=l.results?l.results.slice().sort(m(["timestamp"])).reverse().filter(t=>parseInt(t.bib,10)===parseInt(e.bib,10)):null;let n;n=o&&o[0]?o[0].timestamp:c.startTime?c.startTime:l.startDate?l.startDate:new Date,e.timestamp=r.a.isoDate(n,!1,!1,!1),this.setState({showTimestamp:!t,result:e})},this.doneEditResult=()=>{const{raceStore:t,appState:e}=this.props.stores,{selectedClassIds:s=[]}=e,a=t.getClassById(s[0]),{checkpointId:i}=e,l=a.checkpoints?a.checkpoints.find(t=>t.id===i):null;this.setState({selectedResult:"",selectedCheckpoint:l,currentResult:null,result:{bib:"",dogs:"",timestamp:""}})},this.selectResult=t=>{const e=t.target.closest(".resultLine").dataset.resultid,{appState:s,raceStore:a}=this.props.stores,{selectedClassIds:i=[]}=s,l=a.getClassById(i[0]),c=l.results?Object(b.i)(l.results.slice().find(t=>t.id===e)):{};this.setState({selectedResult:e,currentResult:c})},this.state={result:{},message:""},this.updateTimer={}}componentWillReceiveProps(t){}componentDidMount(){this.doneEditResult()}render(){const{result:e,showTimestamp:s,message:a,selectedCheckpoint:i,selectedMusher:l,isCheckedIn:c,isCheckedOut:o,isScratched:d,isCheckedOutPrev:b,currentResult:m,lastResults:u=[]}=this.state,{appState:O,raceStore:g,userStore:j}=this.props.stores,{checkpointId:f}=O,{selectedClassIds:y=[]}=O,v=g.getClassById(y[0]),w=u&&u[0]?u[0]:{};let x=v.checkpoints?v.checkpoints.find(t=>t.id===w.checkpoint):null;x=x||{};const{user:k={}}=j,{language:S="en"}=k;return Object(n.h)(t,null,Object(n.h)("div",{class:"mt-2 pb-5",style:"height: 70vh;"},Object(n.h)("h3",null,"Admin timing - ",v.title),Object(n.h)("div",{class:"w-100 overflow-hidden"},Object(n.h)("div",{class:"d-flex flex-row flex-nowrap pb-2 px-1",style:"overflow: auto; scroll-snap-type: x mandatory;"},v.checkpoints&&v.checkpoints.map((e,s)=>{let a={},i={},c={};return u&&u.length>0&&(a=u.slice().find(t=>parseInt(t.bib,10)==l.bib&&t.checkpoint===e.id&&"in"===t.direction)||{},i=u.slice().find(t=>parseInt(t.bib,10)==l.bib&&t.checkpoint===e.id&&"out"===t.direction)||{},c=u.slice().find(t=>parseInt(t.bib,10)==l.bib&&t.checkpoint===e.id&&"scratched"===t.direction)||{}),Object(n.h)(t,null,Object(n.h)("div",{class:"col px-0 pt-2"},Object(n.h)("button",{type:"button",class:`btn btn-block ${0===s&&"rounded-pill-left"} ${s===v.checkpoints.length-1&&"rounded-pill-right"} rounded-none ${f===e.id?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;",onClick:this.selectCheckpoint,"data-id":e.id},e.sortOrder,": ",e.name,i&&i.id?Object(n.h)("i",{class:"fas fa-check text-white ml-2"}):"",a&&a.id&&!i.id?Object(n.h)("i",{class:"fas fa-map-marker-alt text-white ml-2"}):"")))}))),Object(n.h)("div",{class:"w-100 overflow-hidden"},i&&Object(n.h)(t,null,Object(n.h)("h3",null,l&&Object(n.h)(t,null,Object(n.h)("i",{class:"fas fa-user text-muted"})," ",l.firstname," ",l.lastname)),m?Object(n.h)(t,null,["bib","dogs"].map(e=>Object(n.h)(t,null,Object(n.h)("div",{class:"form-group"},Object(n.h)("label",{for:e},e),Object(n.h)("input",{type:"text",class:"form-control",id:e,"aria-describedby":e+"Help","data-classid":v.id,"data-resultid":m.id,"data-field":e,value:m[e],onInput:this.editResult})))),["timestamp"].map(e=>Object(n.h)(t,null,Object(n.h)("div",{class:"form-group"},Object(n.h)("label",{for:e},Object(n.h)("i",{class:"fas fa-stopwatch"})," ",e),Object(n.h)("input",{type:"datetime-local",class:"form-control",id:e,"aria-describedby":e+"Help","data-classid":v.id,"data-resultid":m.id,"data-field":e,value:r.a.isoDate(m[e],!1,!1,!1),onInput:this.editResult}),Object(n.h)("button",{class:"btn btn-link",onClick:this.toggleTimestamp},"Hide timestamp")))),Object(n.h)("button",{class:"btn btn-lg btn-danger float-left",onClick:this.deleteResult},"Delete"),Object(n.h)("button",{class:"btn btn-lg btn-info float-right",onClick:this.doneEditResult},"Done")):Object(n.h)(t,null,i.sortOrder>x.sortOrder+1&&Object(n.h)(t,null,Object(n.h)("div",{class:"p-3 mb-2 bg-danger text-white clearfix"},Object(n.h)("span",{class:"float-left",style:"font-size: 2.0em;"},Object(n.h)("i",{class:"fas fa-exclamation-triangle mr-3"})),"Previous checkpoint is not logged yet.")),!b&&i.sortOrder===x.sortOrder+1&&Object(n.h)(t,null,Object(n.h)("div",{class:"p-3 mb-2 bg-danger text-white clearfix"},Object(n.h)("span",{class:"float-left",style:"font-size: 2.0em;"},Object(n.h)("i",{class:"fas fa-exclamation-triangle mr-3"})),"Not checked out of prev.")),["bib"].map(s=>Object(n.h)(t,null,Object(n.h)("div",{class:"form-group"},Object(n.h)("label",{for:s},s),Object(n.h)("input",{type:"text",class:"form-control form-control-lg",id:s,"aria-describedby":s+"Help",onInput:this.updateField,value:e[s]})))),["dogs"].map(s=>Object(n.h)(t,null,Object(n.h)("div",{class:"form-group"},Object(n.h)("label",{for:s},Object(n.h)("i",{class:"fas fa-dog"})," ",s),Object(n.h)("input",{type:"text",class:"form-control form-control-lg",id:s,"aria-describedby":s+"Help",onInput:Object(h.a)(this,"result."+s),value:e[s]})))),s?Object(n.h)(t,null,["timestamp"].map(s=>Object(n.h)(t,null,Object(n.h)("div",{class:"form-group"},Object(n.h)("label",{for:s},Object(n.h)("i",{class:"fas fa-stopwatch"})," ",s),Object(n.h)("input",{type:"datetime-local",class:"form-control",id:s,"aria-describedby":s+"Help",onInput:Object(h.a)(this,"result."+s),value:r.a.isoDate(e[s],!1,!1,!1).replace(/ /g,"T"),min:r.a.isoDate(w.timestamp,!1,!1,!1).replace(/ /g,"T")}),Object(n.h)("button",{class:"btn btn-link",onClick:this.toggleTimestamp},Object(n.h)("i",{class:"fas fa-stopwatch"})," Hide timestamp"))))):Object(n.h)(t,null,Object(n.h)("div",{class:"form-group"},Object(n.h)("button",{class:"btn btn-link",onClick:this.toggleTimestamp},Object(n.h)("i",{class:"fas fa-stopwatch"})," Show timestamp"))),c&&o&&Object(n.h)(t,null,Object(n.h)("div",{class:"alert alert-warning my-2 clearfix",role:"alert"},Object(n.h)("span",{class:"float-left",style:"font-size: 2.0em;"},Object(n.h)("i",{class:"fas fa-exclamation-triangle mr-3"})),l&&Object(n.h)(t,null,l.firstname," ",l.lastname)," Has checked in and out of this checkpoint!")),Object(n.h)("div",{class:"d-flex justify-content-between"},Object(n.h)("div",{class:"text-center"},Object(n.h)("h3",null,Object(n.h)("i",{class:"fas fa-campground text-muted"})," ",i.name))),Object(n.h)("div",{class:"d-flex justify-content-between"},Object(n.h)("button",{class:"btn btn-lg btn-success float-left",onClick:this.addResult,"data-direction":"in","data-classid":v.id,disabled:c?"disabled":""},"CP In ",Object(n.h)("i",{class:"fas fa-sign-in-alt ml-2"})),Object(n.h)("button",{class:"btn btn-lg btn-info float-right",onClick:this.addResult,"data-direction":"out","data-classid":v.id,disabled:o?"disabled":""},Object(n.h)("i",{class:"fas fa-sign-out-alt mr-2"})," CP Out"))))),a&&Object(n.h)("div",{class:"alert alert-success mt-3 clearfix",role:"alert"},a),Object(n.h)("div",{class:"overflow-hidden mb-5 mt-3"},Object(n.h)(p,{stores:this.props.stores,lastResults:u,currentClass:v,selectedMusher:l,selectResult:this.selectResult})),Object(n.h)("div",{class:"d-flex justify-content-center mt-3 mb-5"},Object(n.h)("button",{class:"btn btn-sm btn-block btn-danger",onClick:this.addResult,"data-direction":"scratched","data-classid":v.id,disabled:d?"disabled":""},"Scratch ",Object(n.h)("i",{class:"fas fa-times ml-2"})))))}})||o;e.a=u}).call(this,s("hosL").Fragment)},NMoA:function(t,e,s){"use strict";(function(t){function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function i(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){l(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function l(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var c,o,n,r,d,h=s("hosL"),b=s("Utv1"),m=s("/eY4"),p=s("cneo"),u=s("OhSV"),O=s("fh8t"),g=s.n(O),j=s("go65"),f=s("Y3FI"),y=(s("1OK2"),s("B95u")),v=s("4QWe"),w=(s("NMoA"),s("P9Fo")),x=s("s4FZ"),k=s("+JSK"),S=s("vY+r"),C=s("eQ6k"),I=s("om2D"),D=s("ZOvn");const T={showAddComment:{},showTeamSetting:{},viewImageIdx:{},likeStory:{}};let R=Object(m.a)(c=class extends h.Component{constructor(t){var e;super(t),e=this,this.saveStory=async function(t){const{id:s}=t.target.closest("button").dataset,{storyBody:a}=e.state,{storyStore:i}=e.props.stores,{callback:l=(()=>!0)}=e.props;await i.saveField(parseInt(s,10),"body",a,!0),i.publicFeedUpdate(parseInt(s,10),"body",a),e.setState({storyBody:"",storyType:0}),l()},this.saveStoryField=async function(t){const{story:s}=e.props,{id:a}=s,{value:i,name:l}=t.target,{subfield:c,subvalue:o}=t.target.dataset,{sendButtonEnabled:n}=e.state;if(!n)return!1;const{storyStore:r}=e.props.stores;r.publicFeedUpdate(a,l,i),clearTimeout(e.updateTimer[l]),e.updateTimer[l]=setTimeout((async function(){e.doUpdateField(a,l,i,{query:{[c]:o}})}),1e3)},this.updateFieldValue=({id:t,field:s,value:a,skipTimer:i=!1})=>{const{story:l}=this.props,{storyStore:c}=this.props.stores;let o=a,n=a;"images"===s&&Array.isArray(l.images)&&Array.isArray(a)&&(n=[...l.images,...a]),c.updateField(t,s,n),c.publicFeedUpdate(t,s,n),i?this.doUpdateField(t,s,o):(clearTimeout(this.updateTimer[s]),this.updateTimer[s]=setTimeout((async function(){e.doUpdateField(t,s,o)}),500))},this.beforeImagesUploaded=()=>{this.setState({sendButtonEnabled:!1})},this.afterImagesUploaded=()=>{this.setState({sendButtonEnabled:!0})},this.removeImage=async function(t){const{storyStore:s}=e.props.stores,{story:a}=e.props;s.removeImage({id:a.id,name:t.target.parentElement.dataset.name||t.target.dataset.name})},this.handleImageErrored=t=>{const e=t.target;e.onerror=null,setTimeout(()=>{e.src+="?"+new Date},1e3)},this.updateTimer={},this.textareaRef=Object(h.createRef)(),this.state={sendButtonEnabled:!0,storyBody:t.story.body}}async doUpdateField(t,e,s,a={}){this.setState({sendButtonEnabled:!1});const{storyStore:l}=this.props.stores;await l.saveField(parseInt(t,10),e,s,!0,{query:i({},a.query)}),this.setState({sendButtonEnabled:!0})}componentDidMount(){this.textareaRef.current.focus()}render(){const{storyBody:e,storyType:s,sendButtonEnabled:a}=this.state,{userStore:i}=this.props.stores,{isAdmin:l}=i,{story:c}=this.props;return Object(h.h)(t,null,Object(h.h)("div",{class:"container-fluid px-0 mt-1"},Object(h.h)("div",{class:"row"},Object(h.h)("div",{class:"col-12 text-center mt-2"},Object(h.h)("div",{class:"container-fluid"},Object(h.h)("div",{class:"row d-flex align-items-end"},b.a.isArray(c.images)&&c.images.map((t,e)=>Object(h.h)("div",{class:"col-3 p-1"},Object(h.h)("img",{src:t.s3SmallLink,class:"img-fluid",onError:this.handleImageErrored}),Object(h.h)("button",{class:"btn btn-sm btn-link",onClick:this.removeImage,"data-name":t.name},Object(h.h)("i",{class:"fas fa-trash"})," Del"),Object(h.h)("small",null,Object(h.h)("input",{class:"form-control",type:"text",name:"images.title","data-subfield":"name","data-subvalue":c.images[e].name,onInput:this.saveStoryField,value:c.images[e].title})))))),Object(h.h)(I.a,{object:c,updateField:this.updateFieldValue,before:this.beforeImagesUploaded,after:this.afterImagesUploaded,autoOpen:!1}))),Object(h.h)("div",{class:"row"},Object(h.h)("div",{class:"col-12 mt-2"},Object(h.h)("label",null,Object(h.h)(u.c,{id:"story.content"},"Content")),Object(h.h)("div",{class:"border rounded rounded-lg position-relative"},Object(h.h)(u.b,null,Object(h.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(h.h)(u.c,{id:"story.add-content"},"Add your text here..."),onInput:Object(j.a)(this,"storyBody"),onFocus:D.a.resizeTextarea,style:"height: 2.3em;",value:e||c.body,ref:this.textareaRef}))))),Object(h.h)("div",{class:"row"},Object(h.h)("div",{class:"col-12 mt-2"},l&&Object(h.h)(t,null,Object(h.h)("div",{class:"col-12 mt-2"},Object(h.h)("div",{class:"form-group"},Object(h.h)("small",null,Object(h.h)("input",{type:"checkbox",id:"pinned-"+c.id,name:"pinned",onInput:this.saveStoryField,value:c.pinned?"":b.a.isoDate(),checked:c.pinned?"checked":""}),Object(h.h)("label",{class:"ml-2",for:"pinned-"+c.id},"Pinned to top."))))),l&&Object(h.h)(t,null,Object(h.h)("label",null,Object(h.h)(u.c,{id:"story.type"},"Type")),Object(h.h)("div",{class:"form-group"},Object(h.h)("small",null,Object(h.h)("select",{class:"custom-select custom-select-sm",id:c.id,name:"type",onInput:this.saveStoryField,value:s||c.type},Object(h.h)("option",{value:""},"-- ",Object(h.h)(u.c,{id:"story.type-choose"},"Velg type")," --"),Object(h.h)("option",{value:1,selected:1==c.type?"selected":""},"✍️ ",Object(h.h)(u.c,{id:"story.type-regular"},"Vanlig")),Object(h.h)("option",{value:2,selected:2==c.type?"selected":""},"🚀 ",Object(h.h)(u.c,{id:"story.type-ad"},"Annonse")),Object(h.h)("option",{value:3,selected:3==c.type?"selected":""},"📄 ",Object(h.h)(u.c,{id:"story.type-article"},"Artikkel")))))),c.type>=2&&Object(h.h)(t,null,Object(h.h)("label",null,Object(h.h)(u.c,{id:"story.url-text"},"URL text")),Object(h.h)("div",{class:"form-group"},Object(h.h)("small",null,Object(h.h)("input",{class:"form-control",type:"text",name:"urlText",onInput:this.saveStoryField,value:c.urlText}))),Object(h.h)("label",null,Object(h.h)(u.c,{id:"story.url"},"URL")),Object(h.h)("div",{class:"form-group"},Object(h.h)("small",null,Object(h.h)("input",{class:"form-control",type:"text",name:"url",onInput:this.saveStoryField,value:c.url})))),2===c.type&&Object(h.h)(t,null,Object(h.h)("label",null,Object(h.h)(u.c,{id:"story.code"},"Code")),Object(h.h)("div",{class:"form-group"},Object(h.h)("small",null,Object(h.h)("input",{class:"form-control",type:"text",name:"code",onInput:this.saveStoryField,value:c.code}))),Object(h.h)("label",null,Object(h.h)(u.c,{id:"story.country"},"Country")),Object(h.h)("div",{class:"form-group"},Object(h.h)("small",null,Object(h.h)("input",{class:"form-control",type:"text",name:"country",onInput:this.saveStoryField,value:c.country}))),Object(h.h)("label",null,Object(h.h)(u.c,{id:"story.region"},"Region")),Object(h.h)("div",{class:"form-group"},Object(h.h)("small",null,Object(h.h)("input",{class:"form-control",type:"text",name:"region",onInput:this.saveStoryField,value:c.region}))),Object(h.h)("label",null,Object(h.h)(u.c,{id:"story.currency"},"Currency")),Object(h.h)("div",{class:"form-group"},Object(h.h)("small",null,Object(h.h)("input",{class:"form-control",type:"text",name:"currency",onInput:this.saveStoryField,value:c.currency}))),Object(h.h)("label",null,Object(h.h)(u.c,{id:"story.price"},"Price")),Object(h.h)("div",{class:"form-group"},Object(h.h)("small",null,Object(h.h)("input",{class:"form-control",type:"text",name:"price",onInput:this.saveStoryField,value:c.price})))))),Object(h.h)("div",{class:"row"},Object(h.h)("div",{class:"col-12 mt-2"},Object(h.h)("button",{type:"button",class:`btn btn-block btn-${a?"primary":"secondary"} mb-2`,disabled:!a,onClick:this.saveStory,"data-id":c.id},Object(h.h)("i",{class:"fas fa-paper-plane"})," ",Object(h.h)(u.c,{id:"story.edit-save"},"Save changes"))))))}})||c,P=Object(m.a)(o=class extends h.Component{constructor(t){var e;super(t),e=this,this.viewImage=t=>{const{id:e,idx:s}=t.target.closest("img").dataset,{viewImageIdx:a}=this.state;a[e]=s,this.setState({viewImageIdx:a})},this.showStoryDetail=t=>{if("a"===t.target.localName)return!1;const{id:e}=t.target.closest("#storyDetail").dataset;e&&Object(f.route)("/stories/"+e)},this.translate=async function(t){t.preventDefault(),t.stopPropagation();const{story:s}=e.props,{userStore:a,storyStore:i}=e.props.stores,{user:l}=a,c=await i.translate({story:s,user:l});e.setState({showOriginal:0,translatedText:c})},this.showOriginal=t=>{t.preventDefault(),t.stopPropagation(),this.setState({showOriginal:1})},this.setSelectedImage=t=>{this.setState({selectedImageIdx:t})},this.state={viewImageIdx:{}}}render(){const{viewImageIdx:e,showOriginal:s,translatedText:a,selectedImageIdx:i=0}=this.state,{userStore:l}=this.props.stores,{story:c,likeStory:o,likeRef:n}=this.props,{user:r}=l,{language:d="en"}=r,b=[];if(c.images){const t=Object(p.i)(c.images);b.push(...t)}const m=D.a.getTranslation({object:c,targetLang:d,field:"body"})||a;let O=m||c.body;s&&(O=c.body);const{components:j=[],finalBody:f=""}=D.a.getInlineComponents(O||"");return Object(h.h)(t,null,Object(h.h)("div",{class:"container-fluid px-0 mt-1"},Object(h.h)("div",{class:"row"},Object(h.h)(x.a,{stores:this.props.stores,images:b,id:c.id,dblClick:o,likeRef:n,callback:this.setSelectedImage}))),Object(h.h)("div",{class:"row mt-2"},Object(h.h)("div",{class:"clearfix col-12 overflow-hidden",style:""+(c.offline?"text-decoration: line-through;":"")},Object(h.h)("div",{id:"storyDetail",onClick:this.showStoryDetail,"data-id":c.id},Object(h.h)(g.a,{markdown:D.a.replaceImages(f,c.images,d),markdownOpts:D.a.getMarkdownOptions()}),c.language!==d&&Object(h.h)(t,null,!s&&m?Object(h.h)(t,null,Object(h.h)("button",{type:"button",class:"btn btn-sm btn-link text-muted",onClick:this.showOriginal},Object(h.h)("i",{class:"fas fa-cog"}),"  ",Object(h.h)(u.c,{id:"home.translate-show-original"},"Show original"))):Object(h.h)(t,null,Object(h.h)("button",{type:"button",class:"btn btn-sm btn-link text-muted",onClick:this.translate},Object(h.h)("i",{class:"fas fa-cog"})," ",Object(h.h)(u.c,{id:"home.translate-to"},"See translation"))))),j&&j.map(t=>{if("poll"===t.name)return Object(h.h)(w.a,{stores:this.props.stores,story:c,storyId:c.id,params:t.params,opts:t.opts,content:t.content,selectedImageIdx:i})}))))}})||o,E=Object(m.a)(n=class extends h.Component{constructor(t){var e;super(t),e=this,this.viewImage=t=>{const{id:e,idx:s}=t.target.closest("img").dataset,{viewImageIdx:a}=this.state;a[e]=s,this.setState({viewImageIdx:a})},this.showStoryDetail=t=>{if("a"===t.target.localName)return!1;const{id:e}=t.target.closest("#storyDetail").dataset;e&&Object(f.route)("/stories/"+e)},this.translate=async function(t){t.preventDefault(),t.stopPropagation();const{story:s}=e.props,{userStore:a,storyStore:i}=e.props.stores,{user:l}=a;e.setState({showOriginal:0}),await i.translate({story:s,user:l})},this.showOriginal=t=>{t.preventDefault(),t.stopPropagation(),this.setState({showOriginal:1})},this.getTranslation=()=>{const{story:t}=this.props,{userStore:e}=this.props.stores,{user:s}=e,{language:a="en"}=s;D.a.getTranslation({object:t,targetLang:a,field:"body"})&&this.setState({showOriginal:0})},this.state={viewImageIdx:{}}}componentWillMount(){this.getTranslation()}render(){const{viewImageIdx:e,showOriginal:s}=this.state,{userStore:a}=this.props.stores,{story:i,likeStory:l,likeRef:c}=this.props,{user:o}=a,{language:n="en"}=o,r=[];if(i.images){const t=Object(p.i)(i.images);r.push(...t)}const d=D.a.getTranslation({object:i,targetLang:n,field:"body"});let m=d||i.body;return s&&(m=i.body),Object(h.h)(t,null,Object(h.h)("div",{class:"container-fluid px-0 mt-1"},Object(h.h)("div",{class:"row"},Object(h.h)(x.a,{stores:this.props.stores,images:r,id:i.id,dblClick:l,likeRef:c}))),Object(h.h)("div",{class:"row mt-2"},Object(h.h)("div",{class:"clearfix col-12 overflow-hidden",style:""+(i.offline?"text-decoration: line-through;":"")},Object(h.h)("div",{id:"storyDetail","data-id":i.id},Object(h.h)(g.a,{markdown:D.a.replaceImages(m,i.images,n),markdownOpts:D.a.getMarkdownOptions()}),i.language!==n&&Object(h.h)(t,null,!s&&d?Object(h.h)(t,null,Object(h.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:this.showOriginal},Object(h.h)("i",{class:"fas fa-cog"}),"  ",Object(h.h)(u.c,{id:"home.translate-show-original"},"Show original"))):Object(h.h)(t,null,Object(h.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:this.translate},Object(h.h)("i",{class:"fas fa-cog"})," ",Object(h.h)(u.c,{id:"home.translate-to"},"See translation")))))),!!(i.url||i.code||i.price>0)&&Object(h.h)(t,null,Object(h.h)("div",{class:"clearfix col-12  py-2",style:""+(i.offline?"text-decoration: line-through;":"")},Object(h.h)("div",{class:"row"},i.url&&Object(h.h)(t,null,Object(h.h)("div",{class:"col-12 text-left",style:"font-size: 1.0em;"},Object(h.h)("a",{href:D.a.asUrl(i.url),target:"_blank",rel:"noreferrer"},Object(h.h)("i",{class:"fas fa-link mr-2"}),i.urlText?Object(h.h)(t,null,i.urlText):Object(h.h)(t,null,Object(h.h)(u.c,{id:"story.ad-url-readmore"},"Les mer..."))))),i.code&&Object(h.h)(t,null,Object(h.h)("div",{class:"col text-left",style:"font-size: 1.2em;"},Object(h.h)("nobr",null,Object(h.h)("span",{class:"font-weight-lighter"},Object(h.h)(u.c,{id:"story.ad-campaign-code"},"Kampanjekode"),":")," ",i.code))),i.price>0&&Object(h.h)(t,null,Object(h.h)("div",{class:"col text-right",style:"font-size: 1.2em;"},Object(h.h)("nobr",null,i.currencty&&Object(h.h)("span",{class:"font-weight-lighter"},i.currency)," ",b.a.format(i.price,2)))))))))}})||n,F=Object(m.a)(r=class extends h.Component{constructor(t){var e;super(t),e=this,this.viewImage=t=>{const{id:e,idx:s}=t.target.closest("img").dataset,{viewImageIdx:a}=this.state;a[e]=s,this.setState({viewImageIdx:a})},this.showStoryDetail=t=>{if("a"===t.target.localName)return!1;const{id:e}=t.target.closest("#storyDetail").dataset;e&&Object(f.route)("/stories/"+e)},this.translate=async function(t){t.preventDefault(),t.stopPropagation();const{story:s}=e.props,{userStore:a,storyStore:i}=e.props.stores,{user:l}=a;e.setState({showOriginal:0}),await i.translate({story:s,user:l})},this.showOriginal=t=>{t.preventDefault(),t.stopPropagation(),this.setState({showOriginal:1})},this.getTranslation=()=>{const{story:t}=this.props,{userStore:e}=this.props.stores,{user:s}=e,{language:a="en"}=s;D.a.getTranslation({object:t,targetLang:a,field:"body"})&&this.setState({showOriginal:0})},this.state={viewImageIdx:{}}}componentWillMount(){this.getTranslation()}render(){const{viewImageIdx:e,showOriginal:s}=this.state,{userStore:a}=this.props.stores,{story:i,likeStory:l,likeRef:c}=this.props,{user:o}=a,{language:n="en"}=o,r=[];if(i.images){const t=Object(p.i)(i.images);r.push(...t)}const d=D.a.getTranslation({object:i,targetLang:n,field:"body"});let b=d||i.body;return s&&(b=i.body),Object(h.h)(t,null,Object(h.h)("div",{class:"container-fluid px-0 mt-1"},Object(h.h)("div",{class:"row"},Object(h.h)(x.a,{stores:this.props.stores,images:r,id:i.id,dblClick:l,likeRef:c}))),Object(h.h)("div",{class:"row mt-2"},Object(h.h)("div",{class:"clearfix col-12 overflow-hidden",style:""+(i.offline?"text-decoration: line-through;":"")},Object(h.h)("div",{id:"storyDetail",onClick:this.showStoryDetail,"data-id":i.id},Object(h.h)(g.a,{markdown:D.a.replaceImages(b,i.images,n),markdownOpts:D.a.getMarkdownOptions()}),i.language!==n&&Object(h.h)(t,null,!s&&d?Object(h.h)(t,null,Object(h.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:this.showOriginal},Object(h.h)("i",{class:"fas fa-cog"}),"  ",Object(h.h)(u.c,{id:"home.translate-show-original"},"Show original"))):Object(h.h)(t,null,Object(h.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:this.translate},Object(h.h)("i",{class:"fas fa-cog"})," ",Object(h.h)(u.c,{id:"home.translate-to"},"See translation")))))),!!(i.url||i.code||i.price)&&Object(h.h)(t,null,Object(h.h)("div",{class:"clearfix col-12  py-2",style:""+(i.offline?"text-decoration: line-through;":"")},Object(h.h)("div",{class:"row"},i.url&&Object(h.h)(t,null,Object(h.h)("div",{class:"col-12 text-left",style:"font-size: 1.0em;"},Object(h.h)("a",{href:D.a.asUrl(i.url),target:"_blank",rel:"noreferrer"},Object(h.h)("i",{class:"fas fa-link mr-2"}),i.urlText?Object(h.h)(t,null,i.urlText):Object(h.h)(t,null,Object(h.h)(u.c,{id:"story.ad-url-readmore"},"Les mer..."))))))))))}})||r,L=Object(m.a)(d=class extends h.Component{constructor(t){var e;super(t),e=this,this.toggleDate=t=>{t.stopPropagation(),t.preventDefault();const{showDate:e}=this.state;this.setState({showDate:!e})},this.likeStory=async function(){const{story:t}=e.props,{id:s}=t,a=s,{storyStore:i}=e.props.stores,{likeStory:l}=e.state;l[a]=!0;const c=Object.keys(l);e.setState({likeStory:l,likeIds:c}),setTimeout(()=>{const{likeStory:t}=e.state;delete t[a];const s=Object.keys(t);e.setState({likeStory:t,likeIds:s})},1200);await i.likeStory({id:a})},this.toggleAddComment=t=>{const e=t.target.closest("button").dataset.id,{showAddComment:s}=this.state;s[e]?delete s[e]:s[e]=!0,this.setState({showAddComment:s},()=>{this.inputRef[e]&&this.inputRef[e].focus()})},this.closeAllAddComments=()=>{this.setState({showAddComment:{}})},this.toggleShowTeamSetting=t=>{const e=t.target.closest("button").dataset.id,{showTeamSetting:s}=this.state;s[e]?delete s[e]:s[e]=!0,this.setState({showTeamSetting:s})},this.viewImage=t=>{const{id:e,idx:s}=t.target.closest("img").dataset,{viewImageIdx:a}=this.state;a[e]=s,this.setState({viewImageIdx:a})},this.toggleMenu=t=>{const{id:e}=t.target.closest("i").dataset,{showMenu:s={}}=this.state;s[e]=!s[e],this.setState({showDeleteStory:{},showEdit:{},showMenu:s})},this.toggleEdit=t=>{const{id:e}=t.target.closest("button").dataset,{showEdit:s={}}=this.state;s[e]=!s[e],this.setState({showDeleteStory:{},showEdit:s,showMenu:{}})},this.toggleDeleteStory=t=>{const{id:e}=t.target.closest("button").dataset,{showDeleteStory:s={}}=this.state;s[e]=!s[e],this.setState({showDeleteStory:s,showEdit:{},showMenu:{}})},this.reportStory=async function(t){const{id:s}=t.target.closest("button").dataset,{storyStore:a}=e.props.stores;await a.reportStory({id:s}),e.setState({showEdit:{},showMenu:{}})},this.adminRemoveStory=async function(t){const{id:s}=t.target.closest("button").dataset,{storyStore:a}=e.props.stores;await a.adminHideStory({id:s}),e.setState({showEdit:{},showMenu:{}})},this.deleteStory=async function(t){const{id:s}=t.target.closest("button").dataset,{storyStore:a}=e.props.stores;await a.saveField(parseInt(s,10),"offline",1,!0),a.publicFeedUpdate(parseInt(s,10),"offline",1),e.setState({storyBody:"",showDeleteStory:{},showEdit:{},showMenu:{}})},this.doneEdit=()=>{this.setState({showDeleteStory:{},showEdit:{},showMenu:{}})},this.showStoryDetail=t=>{if("a"===t.target.localName)return!1;const{id:e}=t.target.closest("#storyDetail").dataset;e&&Object(f.route)("/stories/"+e)},this.shareLink=t=>{const{url:e,title:s,text:a}=t.target.closest("button").dataset,{appState:i}=this.props.stores;i.shareUrl({url:e,title:s,text:a})},this.displayTeam=(t,e)=>{t.preventDefault(),t.stopPropagation();const{appState:s}=this.props.stores;s.openDrawer("publicTeam",{teamId:e,height:"80vh"})},this.openInbox=(t,e)=>{t.preventDefault(),t.stopPropagation();const{appState:s}=this.props.stores;s.openDrawer("inboxDetail",{fromuser:e,height:"80vh"})},this.state=i({},T),this.inputRef={}}async loadStoriesPublicFeed(t=this.props){const{hashtag:e}=t,{storyStore:s}=t.stores;await s.loadPublicFeed({hashtag:e})}render(){const{showAddComment:e,showDate:s,showMenu:a={},showEdit:i={},showDeleteStory:l={},showTeamSetting:c,likeStory:o,likeIds:n}=this.state,{story:r,showAllComments:d,onTeamClick:m=(()=>{}),onUserClick:p=(()=>{})}=this.props,{userStore:O,storyStore:g,appState:j}=this.props.stores,{user:f={},isAdmin:w}=O,{hasShareApi:x}=j,I=g.findPublicTeam(r.team)||{},T=g.findPublicUser(r.user)||{},L=D.a.getImage({user:T,team:I,priority:"user",object:r}),M=!(!I||!I.members)&&I.members.some(t=>t===f.id);let A,$,N,B;I&&I.name?(A=D.a.displayNameShort(I),$=D.a.displayName(I),N=D.a.displayName(T),T.settings&&f.uuidv4!==T.uuidv4&&(B=T.settings.hideProfile?null:"/inbox/"+T.uuidv4)):T&&T.id&&(A=D.a.displayNameShort(T),$=D.a.displayName(T));const{likes:z,comments:H,reports:U=[]}=r,V=r.likes&&r.likes.findIndex(t=>t.user===f.id)>-1,q=I.followers?I.followers.length:0,K=I.members&&I.members.indexOf(f.id)>-1,W=I.followers&&I.followers.indexOf(f.id)>-1,Y=I.followRequests&&I.followRequests.findIndex(t=>t.id===f.id)>-1,{currentLocationGeocode:G={},yrWeather:Z=[]}=r,J=D.a.getViews(r.statistics),Q=D.a.getAdminData(r.statistics);return Object(h.h)(t,null,w||f.id===T.id?Object(h.h)(t,null,Object(h.h)("span",{class:"float-right font-weight-lighter text-muted"},Object(h.h)("i",{class:"fas fa-ellipsis-h",onClick:this.toggleMenu,"data-id":r.id}))):Object(h.h)(t,null,!K&&!W&&!Y&&I.public>0&&Object(h.h)("span",{class:"float-right"},Object(h.h)(C.a,{stores:this.props.stores,team:I,buttonOnly:!0,simple:!0,classNames:"btn btn-link text-primary"}))),a[r.id]&&Object(h.h)(t,null,Object(h.h)("div",{class:"position-absolute bg-light p-2 border rounded rounded-lg shadow-sm",style:"top: 30px; right: 10px; width: 60%; z-index: 999999;"},f.id===T.id?Object(h.h)(t,null,Object(h.h)("button",{class:"btn btn-link btn-block text-left",onClick:this.toggleEdit,"data-id":r.id},Object(h.h)("i",{class:"fas fa-edit"})," Edit"),Object(h.h)("hr",null),Object(h.h)("button",{class:"btn btn-link btn-block text-left text-danger",onClick:this.toggleDeleteStory,"data-id":r.id},Object(h.h)("i",{class:"fas fa-trash-alt"})," Delete")):Object(h.h)(t,null,Object(h.h)("button",{class:"btn btn-link btn-block text-left",onClick:this.reportStory,"data-id":r.id},Object(h.h)("i",{class:"fas fa-flag"})," Report"),w&&Object(h.h)(t,null,Object(h.h)("hr",null),Object(h.h)("button",{class:"btn btn-link btn-block text-left text-danger",onClick:this.adminRemoveStory,"data-id":r.id},Object(h.h)("i",{class:"fas fa-eraser"})," Remove from feed"))))),Object(h.h)("div",{class:"d-flex position-relative"},Object(h.h)("div",{class:"position-relative text-center border rounded-circle imageRounded imageRoundedMedium",style:L?`background-image: url("${L}"); background-size: cover;`:""},!L&&Object(h.h)("div",{class:"text-muted",style:"font-size: 20px; padding-top: 3px;"},A)),Object(h.h)("div",{class:"flex-grow-1 pl-3 text-overflow",style:"line-height: 1.2em;"},Object(h.h)("h5",{class:"mb-1 position-relative",style:"line-height: 1.0em; "+(r.offline?"text-decoration: line-through;":"")},I.public?Object(h.h)(t,null,Object(h.h)("a",{href:"/teams/public/"+I.uuidv4,onClick:t=>this.displayTeam(t,I.uuidv4),class:"stretched-link"},$)):Object(h.h)(t,null,$),K&&!I.public&&Object(h.h)("button",{type:"button",class:"btn btn-sm btn-link text-muted","data-id":r.id,onClick:this.toggleShowTeamSetting},Object(h.h)("i",{class:"fas fa-exclamation-triangle"}))),Object(h.h)("div",{class:"mb-2",style:""+(r.offline?"text-decoration: line-through;":"")},r.pinned&&Object(h.h)(t,null,Object(h.h)("small",{class:"text-muted mr-2"},Object(h.h)("i",{class:"fas fa-thumbtack"}))),2===r.type?Object(h.h)(t,null,Object(h.h)("small",{class:"text-muted"},Object(h.h)(u.c,{id:"story.sponsored"},"Sponsored")," -")):Object(h.h)(t,null,r.date&&Object(h.h)("small",{class:"text-muted",onClick:this.toggleDate},s?b.a.formatDate(r.date,{locale:"no-NB",hour12:!1,hour:"2-digit",minute:"2-digit"}):b.a.formatDistance(r.date,new Date,{locale:"no-NB"}))),1===r.public?Object(h.h)(t,null,Object(h.h)("small",{class:"ml-2 text-muted"},Object(h.h)("i",{class:"fas fa-globe-europe"}))):Object(h.h)(t,null,Object(h.h)("small",{class:"ml-2 text-muted"},Object(h.h)("i",{class:"fas fa-users"})," (",b.a.format(q),")")),N&&Object(h.h)(t,null,Object(h.h)("small",{class:"ml-2 text-muted"},B?Object(h.h)(t,null,Object(h.h)("i",{class:"fas fa-user"})," ",Object(h.h)("a",{href:B,onClick:t=>this.openInbox(t,T.uuidv4)},N)):Object(h.h)(t,null,Object(h.h)("i",{class:"fas fa-user"})," ",N))),G&&G.formattedCounty&&Object(h.h)(t,null,Object(h.h)("small",{class:"ml-2 text-muted"},Object(h.h)("i",{class:"fas fa-map-marker-alt"})," ",G.formattedCounty))),w&&Object(h.h)("div",{class:"d-flex flex-row flex-nowrap bg-light border-top border-bottom py-2",style:"overflow: auto;"},Object(h.h)("small",{class:"text-muted mr-2"},"Adm:"),U&&U.length>0&&Object(h.h)(t,null,Object(h.h)("small",{class:"text-danger mr-2"},Object(h.h)("i",{class:"fas fa-flag"})," ",U.length)),G&&G.formatted_address&&Object(h.h)(t,null,Object(h.h)("small",{class:"text-muted"},Object(h.h)("i",{class:"fas fa-map-marker-alt"})," ",G.formatted_address)),T.deviceInfo&&Object(h.h)(t,null,Object(h.h)("span",{class:"badge badge-secondary ml-2 float-right font-weight-light"},["platform","manufacturer","model"].map(e=>Object(h.h)(t,null,Object(h.h)("span",{class:"ml-2 text-white"},T.deviceInfo[e]))))),Q&&Object(h.h)(t,null,Object(h.h)("small",{class:"ml-2 text-muted"},"V: ",Q.count),Object(h.h)("small",{class:"ml-2 text-muted"},"R: ",Q.ranking," ",b.a.isNumber(Q.rankingTrend)&&Object(h.h)(t,null,Object(h.h)("i",{class:D.a.getClassForTrend(Q.rankingTrend)}))),Object(h.h)("small",{class:"ml-2 text-muted"},"D: ",b.a.format(Q.durationAvg/1e3,1),"s ",b.a.isNumber(Q.durationAvgTrend)&&Object(h.h)(t,null,Object(h.h)("i",{class:D.a.getClassForTrend(Q.durationAvgTrend)}))),r.statisticsCurrent&&r.statisticsCurrent.totalInteractions>0&&Object(h.h)("small",{class:"ml-2 text-muted"},"S: ",b.a.format(r.statisticsCurrent.totalInteractions,0)),r.shadowTags&&r.shadowTags.map(e=>Object(h.h)(t,null,Object(h.h)("span",{class:"badge badge-secondary ml-2 float-right font-weight-light"},e))))))),i[r.id]||l[r.id]?Object(h.h)(t,null,Object(h.h)("div",{class:"row mt-2"},Object(h.h)("div",{class:"clearfix col-12",style:""+(r.offline?"text-decoration: line-through;":"")},i[r.id]&&Object(h.h)(t,null,Object(h.h)(R,{stores:this.props.stores,story:r,key:"story-edit-"+r.id,callback:this.doneEdit})),l[r.id]&&Object(h.h)("div",{class:"clearfix mt-3 mb-3"},Object(h.h)("button",{class:"btn btn-danger float-left",onClick:this.deleteStory,"data-id":r.id},Object(h.h)("i",{class:"fas fa-trash-alt"})," Delete"),Object(h.h)("button",{class:"btn btn-secondary float-right",onClick:this.toggleDeleteStory,"data-id":r.id},Object(h.h)("i",{class:"fas fa-times-circle"})," Cancel"))))):Object(h.h)(t,null,(!r.type||1==r.type)&&Object(h.h)(P,{stores:this.props.stores,story:r,key:"story-regular-view-"+r.id,likeStory:this.likeStory,likeRef:o,keys:n}),2==r.type&&Object(h.h)(E,{stores:this.props.stores,story:r,key:"story-ad-view-"+r.id,likeStory:this.likeStory,likeRef:o,keys:n}),3==r.type&&Object(h.h)(F,{stores:this.props.stores,story:r,key:"story-article-view-"+r.id,likeStory:this.likeStory,likeRef:o,keys:n}),Object(h.h)("div",{class:"d-flex justify-content-between mt-2"},Object(h.h)("div",{class:"mr-2"},Object(h.h)(k.a,{stores:this.props.stores,likes:z,comments:H,type:"story",onTeamClick:m,onUserClick:p})),J>0&&Object(h.h)(t,null,Object(h.h)("div",null,Object(h.h)(S.a,{stores:this.props.stores,views:J,object:r,type:"story",isTeamAdmin:M,isAdmin:w,onTeamClick:m,onUserClick:p})))),c[r.id]&&Object(h.h)(t,null,Object(h.h)("small",null,Object(h.h)("div",{class:"alert alert-info",role:"alert"},Object(h.h)("span",{class:"display-4 float-left"},Object(h.h)("i",{class:"fas fa-exclamation-triangle mr-3 mb-3"})),Object(h.h)("p",null,Object(h.h)(u.c,{id:"story.alert-text-1"},"Your team is not visible and it's not possible to request friendship with your team.")),Object(h.h)("p",null,Object(h.h)(u.c,{id:"story.alert-text-2"},"If you want to make your team visible so other can request to follow your team, you can find the setting here:")),Object(h.h)("p",null,Object(h.h)("a",{href:"/teams/edit/"+I.id},Object(h.h)(u.c,{id:"story.alert-text-3"},"Edit team")))))),Object(h.h)("div",null,Object(h.h)("div",{class:"row"},Object(h.h)("div",{class:"col text-center"},Object(h.h)("button",{type:"button",class:`storyImage btn btn-sm btn-outline-${V?"primary":"secondary"} btn-lg btn-block ${V?"text-primary":""} text-overflow`,"data-id":r.id,onClick:this.likeStory},Object(h.h)("i",{class:(V?"text-primary fas":"far")+" fa-thumbs-up"})," ",V?Object(h.h)(u.c,{id:"comments.has-liked"},"Liked"):Object(h.h)(u.c,{id:"comments.like"},"Lik"))),Object(h.h)("div",{class:"col text-center"},Object(h.h)("button",{type:"button",class:"btn btn-sm btn-outline-secondary btn-block text-overflow","data-id":r.id,onClick:this.toggleAddComment},Object(h.h)("i",{class:"fas fa-comment"})," ",Object(h.h)(u.c,{id:"comments.comment-add"},"Kommentar"))),x?Object(h.h)(t,null,Object(h.h)("div",{class:"col text-center"},Object(h.h)("button",{class:"btn btn-sm btn-outline-secondary btn-block text-overflow",onClick:this.shareLink,"data-url":"https://themusher.app/share/story/"+r.uuidv4,"data-title":"title: "+r.title},Object(h.h)("i",{class:"fas fa-share"})," ",Object(h.h)(u.c,{id:"story.share"},"Del")))):Object(h.h)(t,null,Object(h.h)("div",{class:"col text-center"},Object(h.h)("a",{class:"btn btn-sm btn-outline-secondary btn-block text-overflow",href:"https://themusher.app/share/story/"+r.uuidv4,target:"_blank",rel:"noreferrer","data-native":!0},Object(h.h)("i",{class:"fas fa-share"})," ",Object(h.h)(u.c,{id:"story.share"},"Del")))))),Object(h.h)("div",{class:"mt-2"},Object(h.h)(y.a,{stores:this.props.stores,story:r,col:"10",offset:"2",compact:!1,showAllComments:d,initCall:this.closeAllAddComments}),e[r.id]&&Object(h.h)(v.a,{stores:this.props.stores,story:r,inputRef:t=>this.inputRef[r.id]=t,inputRefObject:this.inputRef,col:"10",offset:"2",key:"story-comment-"+r.id}))))}})||d;e.a=L}).call(this,s("hosL").Fragment)},P9Fo:function(t,e,s){"use strict";(function(t){var a,i=s("hosL"),l=s("Utv1"),c=s("/eY4"),o=(s("cneo"),s("OhSV")),n=s("fh8t"),r=s.n(n),d=(s("go65"),s("ZOvn"));let h=Object(c.a)(a=class extends i.Component{constructor(t){var e;super(t),e=this,this.pollStory=async function(t){const{storyId:s}=e.props,{storyStore:a}=e.props.stores,{line:i}=t.target.dataset;await a.pollStory({id:s,line:i})},this.toggleResult=()=>{const{viewResult:t}=this.state;this.setState({viewResult:!t})},this.state={},this.inputRef={}}render(){const{viewResult:e}=this.state,{story:s,opts:a,content:c,selectedImageIdx:n}=this.props,{userStore:h}=this.props.stores,{user:b}=h,{language:m="en"}=b,p=c.split("\n").map(t=>t.trim().replace(/^\-\s*/g,"")),u=s.polls&&s.polls.findIndex(t=>t.user===b.id)>-1,O=s.polls?s.polls.length:0;let g=0;p.forEach(t=>{const e=100*(s.polls?s.polls.filter(e=>e.line===d.a.md5(t)).length/O:0);e>g&&(g=e)});const j=a.days?parseInt(a.days,10):7,f=l.a.addDays(s.date,j),y=f<new Date,v=new RegExp(/{{img\./i);return Object(i.h)(t,null,Object(i.h)("div",{class:"w-100 my-4 storyPoll"},y||u||e?Object(i.h)(t,null,p&&p.map(e=>{const a=s.polls&&s.polls.findIndex(t=>t.user===b.id&&t.line===d.a.md5(e))>-1,c=(s.polls?s.polls.filter(t=>t.line===d.a.md5(e)).length:0)/O*100;return Object(i.h)(t,null,Object(i.h)("div",{class:"progress position-relative my-2 ",style:"height: 1.5em; font-size: 1.3em;"},Object(i.h)("span",{class:"position-absolute",style:"right: 10px;"}," ",l.a.format(c||0,1),"%"),Object(i.h)("span",{class:"position-absolute",style:"left: 10px;"},Object(i.h)(r.a,{markdown:d.a.replaceImages(`${e} ${a&&"<i class='fas fa-check-circle' />"}`,s.images,m,!1),markdownOpts:d.a.getMarkdownOptions()})),Object(i.h)("div",{class:"progress-bar "+(g===c?"bg-primary":"bg-secondary"),role:"progressbar",style:`width: ${c}%;`,"aria-valuenow":c,"aria-valuemin":"0","aria-valuemax":"100"})))}),Object(i.h)("div",{class:"w-100 mt-3 text-muted d-flex justify-content-start"},Object(i.h)("div",null,Object(i.h)("small",null,l.a.format(O,0)," ",1===O?Object(i.h)(o.c,{id:"story.poll"},"vote"):Object(i.h)(o.c,{id:"story.polls"},"votes"))),y?Object(i.h)(t,null,Object(i.h)("div",{class:"ml-2"},Object(i.h)("small",null,"- ",Object(i.h)(o.c,{id:"story.finished"},"Finished")))):Object(i.h)(t,null,Object(i.h)("div",{class:"ml-2"},Object(i.h)("small",null,"- ",l.a.formatDistance(f,new Date,{},{extended:!0})," ",Object(i.h)(o.c,{id:"story.left"},"left"))),!u&&Object(i.h)("div",{class:"ml-2",onClick:this.toggleResult},Object(i.h)("small",null,"- ",Object(i.h)(o.c,{id:"story.view-vote"},"View vote")))))):Object(i.h)(t,null,p&&p.map((e,a)=>Object(i.h)(t,null,Object(i.h)("button",{class:`btn btn-block ${v.test(e)&&a===n?"btn-outline-success":"btn-outline-primary"} rounded-pill`,onClick:this.pollStory,"data-line":d.a.md5(e)},v.test(e)&&a===n&&Object(i.h)("span",{class:"float-right"},Object(i.h)("i",{class:"fas fa-eye"})),Object(i.h)(r.a,{markdown:d.a.replaceImages(e,s.images,m,!1),markdownOpts:d.a.getMarkdownOptions()})))),Object(i.h)("div",{class:"w-100 mt-3 text-muted d-flex justify-content-start"},Object(i.h)("div",null,Object(i.h)("small",null,l.a.format(O,0)," ",1===O?Object(i.h)(o.c,{id:"story.poll"},"vote"):Object(i.h)(o.c,{id:"story.polls"},"votes"))),y?Object(i.h)(t,null,Object(i.h)("div",{class:"ml-2"},Object(i.h)("small",null,"- ",Object(i.h)(o.c,{id:"story.finished"},"Finished")))):Object(i.h)(t,null,Object(i.h)("div",{class:"ml-2"},Object(i.h)("small",null,"- ",l.a.formatDistance(f,new Date,{},{extended:!0})," ",Object(i.h)(o.c,{id:"story.left"},"left")))),Object(i.h)("div",{class:"ml-2",onClick:this.toggleResult},Object(i.h)("small",null,"- ",Object(i.h)(o.c,{id:"story.view-results"},"View results")))))))}})||a;e.a=h}).call(this,s("hosL").Fragment)},Pbyq:function(t,e,s){"use strict";(function(t){var a,i=s("hosL"),l=s("Utv1"),c=s("/eY4"),o=(s("OhSV"),s("Y3FI"),s("fh8t"),s("go65"),s("om2D"),s("AEg1")),n=s("gOLw");s("ZOvn");let r=Object(c.a)(a=class extends i.Component{constructor(t){var e;super(t),e=this,this.addRaceUserImage=async function(){const{race:t={}}=e.props,s=t.id,{raceStore:a}=e.props.stores,{newRaceUserImage:i}=e.state;await a.addUserImage({id:s,newUserImage:i}),e.setState({newRaceUserImage:{}})},this.updateUserImageUpload=({field:t,value:e})=>{const{newRaceUserImage:s}=this.state;s[t]=e,this.setState({newRaceUserImage:s})},this.removeRaceUserImage=async function(t){const s=t.target.parentElement.dataset.id||t.target.dataset.id,{race:a={}}=e.props,i=a.id,{raceStore:l}=e.props.stores;await l.removeUserImage({id:i,userImageId:s})},this.editRaceUserImage=async function(t){const{id:s,field:a}=t.target.dataset,{value:i}=t.target,{race:c={}}=e.props,o=c.id,{raceStore:n}=e.props.stores,r={raceUserImageId:s,["raceUserImage"+l.a.ucfirst(a)]:i};clearTimeout(e.updateTimer[`${o}-${s}-${a}`]),e.updateTimer[`${o}-${s}-${a}`]=setTimeout((async function(){n.editUserImage({id:o,data:r})}),1500),e.resizeTextarea(t.target)},this.resizeTextarea=t=>{let e=t;e.target&&(e=t.target);const{scrollHeight:s}=e;e.style.height=s+"px"},this.handleImageErrored=t=>{const e=t.target;e.onerror=null,setTimeout(()=>{e.src+="?"+new Date},1e3)},this.state={newRaceUserImage:{}},this.inputRef={},this.updateTimer={}}render(){const{newRaceUserImage:e={}}=this.state,{userStore:s}=this.props.stores,{user:a={},teams:l=[]}=s,{language:c="en"}=a,{race:r={}}=this.props,d=["photos"];return r.tag&&r.tag.split(",").forEach(t=>{d.push(t.trim())}),Object(i.h)(t,null,a.id&&Object(i.h)(o.a,{stores:this.props.stores,hashTags:d,postfix:`[🔗 ${r.title}: Images](/app-races/${r.id}/userImages)`,topic:"race-"+r.id}),Object(i.h)(n.a,{stores:this.props.stores,hashtags:d}))}})||a;e.a=r}).call(this,s("hosL").Fragment)},QuNB:function(t,e,s){"use strict";(function(t){var a,i=s("hosL"),l=s("Utv1"),c=s("/eY4"),o=(s("OhSV"),s("fh8t"),s("ZOvn")),n=s("gcyc");let r=Object(c.a)(a=class extends i.Component{render(){const{bib:e,onClickNav:s=(()=>{})}=this.props,{appState:a,raceStore:c,userStore:r}=this.props.stores,{user:d={},teams:h=[]}=r,{language:b="en"}=d,{checkpointId:m}=a,{sortedContestants:p=[]}=c,{selectedClassIds:u=[]}=a,O=c.getClassById(u[0])||{},{checkpoints:g=[],contestants:j=[],results:f=[]}=O;O.checkpoints&&O.checkpoints.find(t=>t.id===m);let y=p?p.find(t=>t.bib===parseInt(e,10)):null;y=y||{};const v=p?p.findIndex(t=>t.bib===parseInt(e,10)):null;O.results&&O.results.slice().sort((w=["-timestamp","-direction"],(t,e)=>w.map(s=>{let a=1;return"-"===s[0]&&(a=-1,s=s.substring(1)),t[s]>e[s]?a:t[s]<e[s]?-a:0}).reduce((t,e)=>t||e,0))).filter(t=>parseInt(t.bib,10)===parseInt(e,10));var w;const x=c.getTeamById(y.team),k=x.members?x.members.find(t=>t.email===y.email):{};o.a.getImage({user:k,team:x,priority:"user"}),o.a.displayNameShort(k)||o.a.displayNameShort(y);let S,C,I=0,D=0,T=0,R=0,P=O.startDate,E=0;const F=v>-1&&p[v+1]?p[v+1].bib:null,L=v>-1&&p[v-1]?p[v-1].bib:null;return Object(i.h)(t,null,F&&Object(i.h)("button",{class:"btn btn-link text-primary float-right mr-2 py-0",style:"font-size: 2.0em; line-height: 1.0em;",onClick:()=>s(F)},Object(i.h)("i",{class:"fas fa-angle-right"})),L&&Object(i.h)("button",{class:"btn btn-link text-primary float-right mr-2 py-0",style:"font-size: 2.0em; line-height: 1.0em;",onClick:()=>s(L)},Object(i.h)("i",{class:"fas fa-angle-left"})),Object(i.h)(n.a,{stores:this.props.stores,contestant:y,onTeamClick:this.onTeamClick,onUserClick:this.onUserClick,onDogClick:this.onDogClick,onClickNav:s,rank:v+1},Object(i.h)("div",{class:"table-responsive"},Object(i.h)("table",{class:"table table-striped table-sm"},Object(i.h)("thead",null,Object(i.h)("tr",null,Object(i.h)("th",null,"Checkpoint"),Object(i.h)("th",{class:"text-center"},"In"),Object(i.h)("th",{class:"text-center"},"Out"),Object(i.h)("th",{class:"text-center"},"Moving time"),Object(i.h)("th",{class:"text-center"},"Avg speed"),Object(i.h)("th",{class:"text-center"},"Total moving time"),Object(i.h)("th",{class:"text-center"},"Rest"),Object(i.h)("th",{class:"text-center"},"Total rest"),Object(i.h)("th",{class:"text-center"},"% rest"),Object(i.h)("th",{class:"text-center"},"Distance"),Object(i.h)("th",{class:"text-center"},"Total distance"))),Object(i.h)("tbody",null,g&&g.map(e=>{const s=Math.floor((new Date).getTime()/1e3,10),a=f.slice().find(t=>parseInt(t.bib,10)==y.bib&&t.checkpoint===e.id&&"in"===t.direction)||{},c=f.slice().find(t=>parseInt(t.bib,10)==y.bib&&t.checkpoint===e.id&&"out"===t.direction)||{},n=f.slice().find(t=>parseInt(t.bib,10)==y.bib&&t.checkpoint===e.id&&"scratched"===t.direction)||{};let r=0;!e.isStartLine&&a&&c&&a.timestamp&&c.timestamp&&(r=o.a.deltaSec(a.timestamp,c.timestamp));let d=0;S&&a&&S.timestamp&&a.timestamp&&(d=o.a.deltaSec(S.timestamp,a.timestamp));let h=!1,b=0;a&&a.timestamp&&(h=!0,b=e.distanceFromPrev/(d/3600)),I+=e.distanceFromPrev?parseInt(e.distanceFromPrev,10):0,T+=d||0,R+=r||0,D+=(d||0)+(r||0);const m=D?R/D*100:0,p=60*O.requiredRestMinutes;let u,g="text-muted font-weight-lighter",j="text-info";if(h){let h,f,v;c&&c.timestamp||(e.isStartLine?f=0:e.timeEqualization?(O.requiredRestMinutes&&R<p&&(f=p-R+60*y.timeEqualization,g="text-warning font-weight-bold"),!f&&e.requiredRestMinutes&&e.timeEqualization&&y.timeEqualization&&(f=60*e.requiredRestMinutes+60*y.timeEqualization)):f=e.requiredRestMinutes>0?60*e.requiredRestMinutes:10800,e.isStartLine?h=o.a.addDeltaSec(y.startTime||O.startDate,0):(h=o.a.addDeltaSec(a.timestamp,f),v=o.a.deltaSec(a.timestamp,s)),P=h,p&&(j=R+v>p+60*y.timeEqualization?"text-success":"text-danger")),u=Object(i.h)(t,null,Object(i.h)("tr",null,Object(i.h)("td",null,Object(i.h)("nobr",null,e.name)),Object(i.h)("td",{class:"text-center"},!e.isStartLine&&Object(i.h)("nobr",null,Object(i.h)("span",{class:"text-muted mr-1"},o.a.formatDate(a.timestamp,{locale:"en-GB",day:"numeric",month:"numeric"})),o.a.formatDate(a.timestamp,{locale:"en-GB",hour12:!1,hour:"2-digit",minute:"2-digit"}),a.dogs>0&&Object(i.h)(t,null,Object(i.h)("i",{class:"fas fa-dog text-muted ml-2"})," ",a.dogs))),Object(i.h)("td",{class:"text-center"},e.isFinishLine?Object(i.h)(t,null," "):Object(i.h)(t,null,c.timestamp&&Object(i.h)("nobr",null,Object(i.h)("span",{class:"text-muted mr-1"},o.a.formatDate(c.timestamp,{locale:"en-GB",day:"numeric",month:"numeric"})),o.a.formatDate(c.timestamp,{locale:"en-GB",hour12:!1,hour:"2-digit",minute:"2-digit"}),c.dogs>0&&Object(i.h)(t,null,Object(i.h)("i",{class:"fas fa-dog text-muted ml-2"})," ",c.dogs)),!n.timestamp&&h&&Object(i.h)("nobr",{class:""+g},Object(i.h)("span",{class:"text-muted mr-1"},o.a.formatDate(h,{locale:"en-GB",day:"numeric",month:"numeric"})),o.a.formatDate(h,{locale:"en-GB",hour12:!1,hour:"2-digit",minute:"2-digit"}))),n.timestamp&&Object(i.h)("nobr",{class:"text-danger"},Object(i.h)("i",{class:"fas fa-times"}),Object(i.h)("span",{class:"text-muted mr-1"},o.a.formatDate(n.timestamp,{locale:"en-GB",day:"numeric",month:"numeric"})),o.a.formatDate(n.timestamp,{locale:"en-GB",hour12:!1,hour:"2-digit",minute:"2-digit"}))),Object(i.h)("td",{class:"text-center"},!e.isStartLine&&Object(i.h)("nobr",null,l.a.secToHms(d,!0))),Object(i.h)("td",{class:"text-center"},!e.isStartLine&&Object(i.h)("nobr",null,l.a.format(b||0,1)," ",Object(i.h)("span",{class:"text-muted font-weight-lighter"},"km/t"))),Object(i.h)("td",{class:"text-center"},!e.isStartLine&&Object(i.h)("nobr",null,l.a.secToHms(T,!0))),Object(i.h)("td",{class:"text-center"},e.isFinishLine||e.isStartLine?Object(i.h)(t,null," "):Object(i.h)(t,null,n.timestamp?Object(i.h)(t,null," "):Object(i.h)(t,null,c&&c.timestamp?Object(i.h)(t,null,!e.isStartLine&&Object(i.h)(t,null,f>0?Object(i.h)(t,null,Object(i.h)("nobr",{class:"text-muted font-weight-lighter"},l.a.secToHms(f,!0))):Object(i.h)(t,null,Object(i.h)("nobr",null,l.a.secToHms(r,!0))))):Object(i.h)(t,null,Object(i.h)("nobr",{class:"text-info"},l.a.secToHms(v,!0)))))),Object(i.h)("td",{class:"text-center"},e.isFinishLine?Object(i.h)(t,null,Object(i.h)("nobr",null,l.a.secToHms(R,!0))):Object(i.h)(t,null,n.timestamp?Object(i.h)(t,null," "):Object(i.h)(t,null,!e.isStartLine&&Object(i.h)(t,null,Object(i.h)("nobr",null,v?Object(i.h)(t,null,Object(i.h)("span",{class:j},l.a.secToHms(R+v,!0))," ",Object(i.h)("span",{class:"text-muted font-weight-lighter"},"/ ",l.a.secToHms(p+60*y.timeEqualization,!0))):Object(i.h)(t,null,l.a.secToHms(R,!0))))))),Object(i.h)("td",{class:"text-center"},e.isStartLine||n.timestamp?Object(i.h)(t,null," "):Object(i.h)(t,null,m>0&&Object(i.h)("nobr",null,l.a.format(m||0,0)," ",Object(i.h)("span",{class:"text-muted font-weight-lighter"},"%")))),Object(i.h)("td",{class:"text-center"},Object(i.h)("nobr",null,e.distanceFromPrev||0," ",Object(i.h)("span",{class:"text-muted font-weight-lighter"},"km"))),Object(i.h)("td",{class:"text-center"},Object(i.h)("nobr",null,I," ",Object(i.h)("span",{class:"text-muted font-weight-lighter"},"km"))))),c&&c.timestamp&&(P=c.timestamp,E=b)}else{let a,c,n,r;const d=1e3*e.distanceFromPrev,h=E/3.6;let m=E?d/h/60:e.estTimeToCpMinutes||0;e.isStartLine?(a=y.startTime||O.startDate,n=0):P&&(a=o.a.addDeltaSec(P,60*m),n=e.isStartLine?0:e.requiredRestMinutes&&e.timeEqualization&&y.timeEqualization?60*e.requiredRestMinutes+60*y.timeEqualization:e.requiredRestMinutes>0?60*e.requiredRestMinutes:60*(e.estRestMinutes||180),c=o.a.addDeltaSec(a,n),P=c),S&&S.timestamp&&(r=o.a.deltaSec(S.timestamp,s)),b=E||e.distanceFromPrev/(60*m/3600),u=Object(i.h)("tr",null,Object(i.h)("td",null,e.name),S&&S.timestamp?Object(i.h)(t,null,Object(i.h)("td",{class:"text-center text-info font-weight-light"},!e.isStartLine&&a&&Object(i.h)("nobr",null,"est:",Object(i.h)("span",{class:"text-muted mr-1 ml-1"},o.a.formatDate(a,{locale:"en-GB",day:"numeric",month:"numeric"})),o.a.formatDate(a,{locale:"en-GB",hour12:!1,hour:"2-digit",minute:"2-digit"})))):Object(i.h)(t,null,Object(i.h)("td",{class:"text-center text-muted font-weight-lighter"},!e.isStartLine&&a&&Object(i.h)("nobr",null,Object(i.h)("span",{class:"text-muted mr-1"},o.a.formatDate(a,{locale:"en-GB",day:"numeric",month:"numeric"})),o.a.formatDate(a,{locale:"en-GB",hour12:!1,hour:"2-digit",minute:"2-digit"})))),Object(i.h)("td",{class:"text-center text-muted font-weight-lighter"},!e.isFinishLine&&c&&Object(i.h)("nobr",null,Object(i.h)("span",{class:"text-muted mr-1"},o.a.formatDate(c,{locale:"en-GB",day:"numeric",month:"numeric"})),o.a.formatDate(c,{locale:"en-GB",hour12:!1,hour:"2-digit",minute:"2-digit"}))),S&&S.timestamp?Object(i.h)(t,null,Object(i.h)("td",{class:"text-center text-info"},Object(i.h)("nobr",null,l.a.secToHms(r,!0)))):Object(i.h)(t,null,Object(i.h)("td",{class:"text-center text-muted font-weight-lighter"},!e.isStartLine&&Object(i.h)("nobr",null,l.a.secToHms(60*e.estTimeToCpMinutes,!0)))),Object(i.h)("td",{class:"text-center text-muted font-weight-lighter"},!e.isStartLine&&Object(i.h)("nobr",null,l.a.format(b||0,1)," ",Object(i.h)("span",{class:"text-muted font-weight-lighter"},"km/t"))),S&&S.timestamp?Object(i.h)(t,null,Object(i.h)("td",{class:"text-center text-info"},Object(i.h)("nobr",null,l.a.secToHms(r+T,!0)))):Object(i.h)(t,null,Object(i.h)("td",{class:"text-center text-muted font-weight-lighter"}," ")),Object(i.h)("td",{class:"text-center text-muted font-weight-lighter"},!e.isStartLine&&!e.isFinishLine&&Object(i.h)("nobr",null,l.a.secToHms(n,!0))),Object(i.h)("td",{class:"text-center text-muted font-weight-lighter"}," "),Object(i.h)("td",{class:"text-center text-muted font-weight-lighter"}," "),Object(i.h)("td",{class:"text-center"},Object(i.h)("nobr",null,e.distanceFromPrev||0," ",Object(i.h)("span",{class:"text-muted font-weight-lighter"},"km"))),Object(i.h)("td",{class:"text-center text-muted font-weight-lighter"}," "),Object(i.h)("td",{class:"text-center text-muted font-weight-lighter"}," "))}return S=c,C=a,u}))))))}})||a;e.a=r}).call(this,s("hosL").Fragment)},TiXY:function(t,e,s){"use strict";var a,i=s("hosL"),l=s("/eY4"),c=(s("cneo"),s("Utv1"),s("OhSV")),o=s("u2zT");let n=Object(l.a)(a=class extends i.Component{constructor(t){super(t),this.handleAddImage=t=>{const{updateField:e,object:s,field:a}=this.props;e({id:s.id,field:a,value:t})},this.state={files:[]}}render(){const{uploadStatus:t=(()=>{}),before:e=(()=>{}),after:s=(()=>{}),autoOpen:a=!1}=this.props;return Object(i.h)("div",{class:"row"},Object(i.h)("div",{class:"col-12"},Object(i.h)(c.c,{id:"form.files.upload-file"},"Last opp fil"),":",Object(i.h)("br",null),Object(i.h)(o.a,{handleAddImage:this.handleAddImage,apiUrl:"/api/fileupload",uploadStatus:t,before:e,after:s,autoOpen:a},Object(i.h)("div",{style:{height:30,width:"100%"}}))))}})||a;e.a=n},ULR1:function(t,e,s){"use strict";(function(t){var a,i=s("hosL"),l=s("Utv1"),c=s("/eY4"),o=(s("OhSV"),s("Y3FI"),s("fh8t"),s("go65"),s("om2D"),s("AEg1")),n=s("gOLw");s("ZOvn");let r=Object(c.a)(a=class extends i.Component{constructor(t){var e;super(t),e=this,this.addRaceArticle=async function(){const{race:t={}}=e.props,s=t.id,{raceStore:a}=e.props.stores,{newRaceArticle:i}=e.state;await a.addArticle({id:s,newArticle:i}),e.setState({newRaceArticle:{}})},this.editRaceArticle=async function(t){const{id:s,field:a}=t.target.dataset,{value:i}=t.target,{race:c={}}=e.props,o=c.id,{raceStore:n}=e.props.stores,r={raceArticleId:s,["raceArticle"+l.a.ucfirst(a)]:i};clearTimeout(e.updateTimer[`${o}-${s}-${a}`]),e.updateTimer[`${o}-${s}-${a}`]=setTimeout((async function(){n.editArticle({id:o,data:r})}),1500),e.resizeTextarea(t.target)},this.removeRaceArticle=async function(t){const s=t.target.parentElement.dataset.id||t.target.dataset.id,{race:a={}}=e.props,i=a.id,{raceStore:l}=e.props.stores;await l.removeArticle({id:i,articleId:s})},this.updateArticleUpload=({field:t,value:e})=>{const{newRaceArticle:s}=this.state;s[t]=e,this.setState({newRaceArticle:s})},this.resizeTextarea=t=>{let e=t;e.target&&(e=t.target);const{scrollHeight:s}=e;e.style.height=s+"px"},this.handleImageErrored=t=>{const e=t.target;e.onerror=null,setTimeout(()=>{e.src+="?"+new Date},1e3)},this.state={newRaceArticle:{}},this.inputRef={},this.updateTimer={}}render(){const{userStore:e}=this.props.stores,{user:s={},teams:a=[]}=e,{language:l="en"}=s,{race:c={}}=this.props,r=["news"];return c.tag&&c.tag.split(",").forEach(t=>{r.push(t.trim())}),Object(i.h)(t,null,s.id&&Object(i.h)(o.a,{stores:this.props.stores,hashTags:r,postfix:`[🔗 ${c.title}: News](/app-races/${c.id}/news)`,topic:"race-"+c.id}),Object(i.h)(n.a,{stores:this.props.stores,hashtags:r}))}})||a;e.a=r}).call(this,s("hosL").Fragment)},UUHd:function(t,e,s){"use strict";var a,i=s("hosL"),l=(s("Utv1"),s("/eY4")),c=s("OhSV"),o=s("go65"),n=s("ZOvn");let r=Object(l.a)(a=class extends i.Component{constructor(...t){var e;super(...t),e=this,this.commentRace=async function(){const{callback:t=(()=>{}),commentId:s}=e.props,{race:a}=e.props,{raceStore:i}=e.props.stores,{comment:l=""}=e.state,c=await i.commentReplyRace({id:a.id,commentId:s,comment:l});c&&200===c.status&&(e.setState({comment:""}),t({race:a,response:c}))}}render(){const{inputRef:t}=this.props,{comment:e}=this.state,{userStore:s}=this.props.stores,{user:a={}}=s,l=n.a.displayNameShort(a),r=(n.a.displayName(a),a.image||(a.images?a.images[0]:void 0));return Object(i.h)("div",{class:"w-100"},Object(i.h)("div",{class:"d-flex mb-0 position-relative w-100"},Object(i.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedThumb",style:(r?`background-image: url('${r.s3SmallLink}'); background-size: cover;`:"")+" border-width: 3px !important;"},!r&&Object(i.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},l)),Object(i.h)("div",{class:"col pl-3",style:"line-height: 1.2em;"},Object(i.h)("div",{class:"d-flex bd-highlight"},Object(i.h)("div",{class:"p-0 w-100 bd-highlight"},Object(i.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(i.h)(c.c,{id:"comments.comment"},"Kommentar")),Object(i.h)(c.b,null,Object(i.h)("textarea",{class:"form-control rounded-lg",type:"text",placeholder:Object(i.h)(c.c,{id:"comments.write-reply"},"Write a reply..."),onInput:Object(o.a)(this,"comment"),onKeyUp:n.a.resizeTextarea,onFocus:n.a.resizeTextarea,style:"height: 2.3em;",value:e,ref:t}))),Object(i.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(i.h)("button",{type:"button",class:"btn btn-sm btn-primary mb-2",onClick:this.commentRace},Object(i.h)("i",{class:"fas fa-paper-plane"})))))))}})||a;e.a=r},VKmm:function(t,e,s){"use strict";function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function i(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var l,c=s("hosL"),o=s("Utv1"),n=s("/eY4"),r=s("OhSV");s("ZOvn"),s("eQ6k");const d={requestSent:{}};let h=Object(n.a)(l=class extends c.Component{constructor(t){super(t),this.requestFollowTeam=t=>{const{teamStore:e,userStore:s}=this.props.stores,{user:a}=s,{team:i}=t.target.closest("button").dataset;e.followRequest(parseInt(i,10),a);const{requestSent:l}=this.state;l[i]=!0,this.setState({requestSent:l})},this.getButton=t=>{const{requestSent:e}=this.state,{userStore:s}=this.props.stores,{user:a}=s,i=t.members&&t.members.findIndex(t=>t.id===a.id)>-1,l=t.followers&&t.followers.indexOf(a.id)>-1,o=t.blockedFollowers&&t.blockedFollowers.indexOf(a.id)>-1,n=e[t.id]||t.followRequests&&t.followRequests.findIndex(t=>t.id===a.id)>-1;return i?Object(c.h)("i",{class:"fas fa-home"}):l?Object(c.h)("button",{class:"btn btn-sm btn-block btn-outline-secondary float-right",onClick:this.unFollowTeam,disabled:"true","data-team":t.id},Object(c.h)("i",{class:"fas fa-link mr-2"}),Object(c.h)(r.c,{id:"teams.connect.is-following"},"Følger")):o?Object(c.h)("button",{class:"btn btn-sm btn-block btn-outline-secondary float-right",disabled:"true"},Object(c.h)("i",{class:"fas fa-hand-paper mr-2"}),Object(c.h)(r.c,{id:"teams.connect.is-blocked"},"Blokkert")):n?Object(c.h)("button",{class:"btn btn-sm btn-block btn-outline-secondary float-right",disabled:"true"},Object(c.h)("i",{class:"fas fa-hourglass-half mr-2"}),Object(c.h)(r.c,{id:"teams.connect.has-requested"},"Venter på godkjenning")):Object(c.h)("button",{class:"btn btn-sm btn-block btn-outline-success float-right",onClick:this.requestFollowTeam,"data-team":t.id},Object(c.h)("i",{class:"far fa-hand-point-right mr-2"}),Object(c.h)(r.c,{id:"teams.connect.follow"},"Følg"))},this.state=function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){i(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},d)}async loadTeams(){this.setState({isLoading:!0});const{teamStore:t}=this.props.stores;await t.loadPublic({query:{notfollowing:1,array:1},limit:15}),this.setState({isLoading:!1})}componentDidMount(){this.loadTeams()}render(){const{teamStore:t,appState:e}=this.props.stores,{publicTeamsToFollow:s}=t,{darkmode:a}=e;return s&&0!==s.length?Object(c.h)("div",{class:"row pb-1 bg-light"},Object(c.h)("div",{class:`col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mb-0 position-relative rounded rounded-lg py-3 bg-${a?"black":"white"} shadow-sm`},Object(c.h)("div",{class:"container-fluid"},Object(c.h)("div",{class:"row"},Object(c.h)("div",{class:"col-12"},Object(c.h)("h5",null,Object(c.h)(r.c,{id:"teams.connect.teams-to-follow"},"Team du kan følge"),":"))),Object(c.h)("div",{class:"row"},Object(c.h)("div",{class:"d-flex flex-row flex-nowrap",style:"overflow: auto;"},o.a.isArray(s)&&s.map(t=>{const e=t.image&&t.image.s3SmallLink?t.image:null;return Object(c.h)("div",{class:"mr-2",style:"width: 110px;"},Object(c.h)("div",{class:"text-center border rounded-lg",style:e?`background-image: url("${e.s3SmallLink}"); background-size: cover; width: 110px; height: 100px;`:"width: 110px; height: 100px;"},!e&&Object(c.h)("i",{class:"fas fa-users text-muted mt-3",style:"font-size: 40px;"})),Object(c.h)("small",null,Object(c.h)("div",{class:"text-overflow"},Object(c.h)("strong",null,t.name)),Object(c.h)("div",{class:"text-overflow"},t.place?t.place+", ":""," ",t.country,"  "),Object(c.h)("div",{class:"text-overflow"},Object(c.h)("small",{class:"text-muted"},t&&t.dogs&&Object(c.h)("span",{class:""},Object(c.h)("i",{class:"fas fa-dog"})," ",t.dogs.length),t&&t.followers&&Object(c.h)("span",{class:"ml-2"},Object(c.h)("i",{class:"fas fa-user"})," ",t.followers.length)))),Object(c.h)("div",null,this.getButton(t)))})))))):""}})||l;e.a=h},Ysxg:function(t,e,s){"use strict";(function(t){function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function i(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var l,c=s("hosL"),o=s("Utv1"),n=s("/eY4"),r=s("cneo"),d=s("OhSV"),h=s("fh8t"),b=s.n(h),m=s("go65"),p=s("UUHd"),u=s("ZOvn");const O={showAddComment:{},showAllComments:!1,showAllReplies:{},viewImageIdx:{},likeComment:{},likeReply:{},showOriginal:{}};let g=Object(n.a)(l=class extends c.Component{constructor(t){var e;super(t),e=this,this.addLikeComment=async function(t){const{callback:s=(()=>{})}=e.props,a=t.target.closest(".commentContainer").dataset.id,{race:i}=e.props,{raceStore:l}=e.props.stores,{likeComment:c}=e.state;c[a]=!0,e.setState({likeComment:c}),setTimeout(()=>{const{likeComment:t}=e.state;delete t[a],e.setState({likeComment:t})},1200);const o=await l.likeRaceComment({id:i.id,commentId:a});return o&&200===o.status&&s({type:"likeComment",race:i,commentId:a,response:o}),!0},this.likeReply=async function(t){const{callback:s=(()=>{})}=e.props,a=t.target.closest(".replyContainer").dataset.id,i=t.target.closest(".replyContainer").dataset.comment,{race:l}=e.props,{raceStore:c}=e.props.stores,{likeReply:o}=e.state;o[a]=!0,e.setState({likeReply:o}),setTimeout(()=>{const{likeReply:t}=e.state;delete t[a],e.setState({likeReply:t})},1200);const n=await c.likeRaceCommentReply({id:l.id,replyId:a,commentId:i});n&&200===n.status&&s({type:"likeReply",race:l,commentId:i,replyId:a,response:n})},this.replyComment=async function(t){const s=t.target.parentElement.dataset.id||t.target.dataset.id,{showAddComment:a}=e.state;a[s]=!a[s],e.setState({showAddComment:a},()=>{e.inputRef[s]&&e.inputRef[s].focus()})},this.toggleComments=()=>{const{showAllComments:t}=this.state;this.setState({showAllComments:!t})},this.toggleReplies=t=>{const e=t.target.parentElement.dataset.id||t.target.dataset.id,{showAllReplies:s}=this.state;s[e]=!s[e],this.setState({showAllReplies:s})},this.toggleMenu=t=>{const{id:e}=t.target.closest("i").dataset,{showMenu:s={}}=this.state;s[e]=!s[e],this.setState({showDeleteComment:{},showEdit:{},showMenu:s})},this.toggleEdit=t=>{const{id:e,comment:s}=t.target.closest("button").dataset,{showEdit:a={}}=this.state;a[e]=!a[e],this.setState({showDeleteComment:{},showEdit:a,showMenu:{},commentEditText:s})},this.toggleDeleteComment=t=>{const{id:e}=t.target.closest("button").dataset,{showDeleteComment:s={}}=this.state;s[e]=!s[e],this.setState({showDeleteComment:s,showEdit:{},showMenu:{}})},this.deleteComment=async function(t){const{id:s}=t.target.closest("button").dataset,{race:a}=e.props,{raceStore:i}=e.props.stores;await i.deleteCommentRace({id:a.id,commentId:s}),e.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}})},this.deleteCommentReply=async function(t){const{id:s,commentid:a}=t.target.closest("button").dataset,{race:i}=e.props,{raceStore:l}=e.props.stores;await l.deleteCommentReplyRace({id:i.id,commentId:a,replyId:s}),e.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}})},this.saveComment=async function(t){const{id:s}=t.target.closest("button").dataset,{commentEditText:a}=e.state,{race:i}=e.props,{raceStore:l}=e.props.stores;await l.editCommentRace({id:i.id,commentId:s,comment:a}),e.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}})},this.saveCommentReply=async function(t){const{id:s,commentid:a}=t.target.closest("button").dataset,{commentEditText:i}=e.state,{race:l}=e.props,{raceStore:c}=e.props.stores;await c.editCommentReplyRace({id:l.id,commentId:a,replyId:s,comment:i}),e.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}})},this.viewImage=t=>{const{id:e,idx:s}=t.target.closest("img").dataset,{viewImageIdx:a}=this.state;a[e]=s,this.setState({viewImageIdx:a})},this.translate=async function(t){t.preventDefault(),t.stopPropagation();const{replyid:s,commentid:a}=t.target.closest("button").dataset,{race:i}=e.props,{userStore:l,raceStore:c}=e.props.stores,{user:o}=l,{showOriginal:n={},translatedText:r={}}=e.state,d=`${a}${s?"-"+s:""}`;n[d]=0,r[d]=s?await c.translateCommentReply({commentid:a,replyid:s,race:i,user:o}):await c.translateComment({commentid:a,race:i,user:o}),e.setState({showOriginal:n,translatedText:r})},this.showOriginal=t=>{const{replyid:e,commentid:s}=t.target.closest("button").dataset;t.preventDefault(),t.stopPropagation();const{showOriginal:a={}}=this.state;a[`${s}${e?"-"+e:""}`]=1,this.setState({showOriginal:a})},this.state=function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){i(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},O),this.inputRef={}}render(){const{showAddComment:e,showAllComments:s,showAllReplies:a,viewImageIdx:i,showMenu:l={},showEdit:n={},showDeleteComment:h={},commentEditText:O,likeComment:g,showOriginal:j={},translatedText:f={}}=this.state,{race:y,callback:v=(()=>{}),initCall:w=(()=>{}),col:x=12,offset:k=0,compact:S=!1}=this.props,{userStore:C,raceStore:I}=this.props.stores,{user:D}=C,{language:T="en"}=D;let R=[],P=0,E=0;if(y.comments){if(P=y.comments.length,s)R=y.comments;else{R=y.comments.slice(Math.max(P-(S?0:2),0))}E=R.length}return Object(c.h)("div",{class:`col-${x} offset-${k} col-sm-8 col-lg-6 offset-sm-2 offset-lg-3`},y&&o.a.isArray(R)&&R.reverse().map(s=>{const{user:x={}}=s,k=I.findPublicTeamByMembers(x.id),S=u.a.displayNameShort(x),C=u.a.displayName(x),R=x.image||(x.images?x.images[0]:void 0),P=s.likes&&s.likes.findIndex(t=>t.user===D.id)>-1;let E=[],F=0,L=0;s.comments&&(F=s.comments.length,E=a[s.id]?s.comments:s.comments.slice(0,void 0),L=E.length);const M=[];if(s.images){const t=Object(r.i)(s.images);M.push(...t)}const A=i[s.id]?i[s.id]:0,$=M&&M[A]?M[A]:null,{currentLocationGeocode:N={}}=s,B=I.getCommentTranslations({race:y,commentid:s.id,targetLang:T})||f[s.id];let z=B||s.comment;return j[s.id]&&(z=s.comment),Object(c.h)("div",{class:"row"},Object(c.h)("div",{class:"col-11 offset-1 d-flex mb-2 position-relative"},Object(c.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall",style:(R?`background-image: url("${R.s3SmallLink}"); background-size: cover;`:"")+" border-width: 3px !important;"},!x.image&&Object(c.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},S)),Object(c.h)("div",{class:"flex-grow-1 pl-3 pt-0",style:"line-height: 1.2em;"},Object(c.h)("div",{class:"bg-light p-2 rounded rounded-lg position-relative"},D.id===x.id&&Object(c.h)(t,null,Object(c.h)("span",{class:"float-right font-weight-lighter text-muted"},Object(c.h)("i",{class:"fas fa-ellipsis-h",onClick:this.toggleMenu,"data-id":s.id}))),l[s.id]&&Object(c.h)(t,null,Object(c.h)("div",{class:"position-absolute bg-white p-2 border rounded rounded-lg shadow-sm",style:"top: 30px; right: 10px; width: 60%; z-index: 999999;"},Object(c.h)("button",{class:"btn btn-link btn-block text-left",onClick:this.toggleEdit,"data-id":s.id,"data-comment":s.comment},Object(c.h)("i",{class:"fas fa-edit"})," Edit"),Object(c.h)("hr",null),Object(c.h)("button",{class:"btn btn-link btn-block text-left",onClick:this.toggleDeleteComment,"data-id":s.id},Object(c.h)("i",{class:"fas fa-trash-alt"})," Delete"))),Object(c.h)("div",null,Object(c.h)("span",{style:"font-size: 0.95em;"},Object(c.h)("h5",{class:"font-weight-bold mb-2",style:"font-size: 1.0em;"},x.uuidv4&&x.uuidv4!==D.uuidv4?Object(c.h)(t,null,Object(c.h)("a",{href:"/inbox/"+x.uuidv4},C)):Object(c.h)(t,null,C),k&&k.length>0&&Object(c.h)(t,null,Object(c.h)("span",{class:"font-weight-lighter text-muted ml-1"},k.filter(t=>1===t.public).slice(0,1).map(e=>Object(c.h)(t,null,"- ",Object(c.h)("a",{href:"/teams/public/"+e.uuidv4},e.name)))))),n[s.id]?Object(c.h)(t,null,Object(c.h)("div",{class:"d-flex bd-highlight"},Object(c.h)("div",{class:"p-0 w-100 bd-highlight"},Object(c.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(c.h)(d.c,{id:"comments.comment"},"Kommentar")),Object(c.h)("div",{class:"border rounded rounded-lg position-relative"},Object(c.h)(d.b,null,Object(c.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(c.h)(d.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(m.a)(this,"commentEditText"),onKeyUp:u.a.resizeTextarea,onFocus:u.a.resizeTextarea,style:"height: 2.3em;",value:O})))),Object(c.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(c.h)("button",{type:"button",class:"btn btn-primary mb-2",onClick:this.saveComment,"data-id":s.id},Object(c.h)("i",{class:"fas fa-paper-plane"}))))):Object(c.h)(t,null,Object(c.h)(b.a,{markdown:u.a.replaceImages(z,s.images,T),markdownOpts:u.a.getMarkdownOptions()})),h[s.id]&&Object(c.h)("div",{class:"clearfix mt-3 mb-3"},Object(c.h)("button",{class:"btn btn-danger float-left",onClick:this.deleteComment,"data-id":s.id},Object(c.h)("i",{class:"fas fa-trash-alt"})," Delete"),Object(c.h)("button",{class:"btn btn-secondary float-right",onClick:this.toggleDeleteComment,"data-id":s.id},Object(c.h)("i",{class:"fas fa-times-circle"})," Cancel")))),Object(c.h)("div",null,Object(c.h)("div",{class:"container-fluid px-3 mt-1"},$&&Object(c.h)("div",{class:"clearfix row position-relative"},Object(c.h)("div",{class:"commentContainer col-12 px-0 overflow-hidden",style:"max-height: 60vh;",onDblclick:this.addLikeComment,"data-id":s.id},Object(c.h)("img",{loading:"lazy",class:"img-fluid",style:"min-width: 100px;",src:$.s3LargeLink})),g[s.id]&&Object(c.h)("span",{class:"likeHeart position-absolute text-white display-1",style:"top: calc(50% - 50px); left: calc(50% - 50px); width: 100px; height: 100px;"},Object(c.h)("i",{class:"fas fa-heart likeStory"}))),M&&M.length>1&&Object(c.h)("div",{class:"clearfix d-flex flex-wrap row"},o.a.isArray(M)&&M.map((e,a)=>Object(c.h)(t,null,Object(c.h)("div",{class:"col px-0 overflow-hidden",style:"max-height: 100px; min-width: 100px;"},Object(c.h)("img",{loading:"lazy",class:"img-fluid border",style:"min-width: 100px;",src:e.s3SmallLink,onClick:this.viewImage,"data-id":s.id,"data-idx":a})))))))),Object(c.h)("small",null,Object(c.h)("button",{class:"commentContainer btn btn-sm btn-link py-0 "+(P?"text-primary":""),onClick:this.addLikeComment,"data-id":s.id,disabled:P},P?Object(c.h)(d.c,{id:"comments.has-liked"},"Liked"):Object(c.h)(d.c,{id:"comments.like"},"Lik")),"-",Object(c.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.replyComment,"data-id":s.id},Object(c.h)(d.c,{id:"comments.comment-add"},"Kommentar")),s.language!==T&&Object(c.h)(t,null,"-",!j[s.id]&&B?Object(c.h)(t,null,Object(c.h)("button",{type:"button",class:"btn btn-sm btn-link","data-commentid":s.id,onClick:this.showOriginal},Object(c.h)("i",{class:"fas fa-cog"}),"  ",Object(c.h)(d.c,{id:"home.translate-show-original"},"Show original"))):Object(c.h)(t,null,Object(c.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:this.translate,"data-commentid":s.id},Object(c.h)("i",{class:"fas fa-cog"})," ",Object(c.h)(d.c,{id:"home.translate-to"},"See translation")))),"-",Object(c.h)("button",{class:"btn btn-sm btn-link py-0 disabled"},o.a.formatDistance(s.createdDate,new Date,{locale:"no-NB"}),s.updatedDate&&Object(c.h)(t,null,Object(c.h)("span",{class:"font-weight-light ml-2"},"(Edited ",o.a.formatDistance(s.updatedDate,new Date,{locale:"no-NB"}),")"))))),s.likes&&s.likes.length>0&&Object(c.h)("small",{class:"position-absolute bg-light shadow-sm rounded-lg py-0 px-1",style:"bottom: 20px; right: 15px;"},Object(c.h)("i",{class:"fas fa-thumbs-up text-primary"})," ",s.likes.length)),Object(c.h)("div",{class:"col-10 offset-2 mb-2"},s&&o.a.isArray(E)&&E.map(e=>{const{user:a={}}=e,i=I.findPublicTeamByMembers(a.id),r=u.a.displayNameShort(a),p=u.a.displayName(a),g=a.image||(a.images?a.images[0]:void 0),v=e.likes&&e.likes.findIndex(t=>t.user===D.id)>-1,{currentLocationGeocode:w={}}=e,x=I.getCommentReplyTranslations({race:y,commentid:s.id,replyid:e.id,targetLang:T})||f[`${s.id}-${e.id}`];let k=x||e.comment;return j[`${s.id}-${e.id}`]&&(k=e.comment),Object(c.h)("div",{class:"row"},Object(c.h)("div",{class:"col-12 d-flex mb-2 position-relative"},Object(c.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall",style:(g?`background-image: url("${g.s3SmallLink}"); background-size: cover;`:"")+" border-width: 3px !important;"},!a.image&&Object(c.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},r)),Object(c.h)("div",{class:"flex-grow-1 pl-3 pt-0",style:"line-height: 1.2em;"},Object(c.h)("div",{class:"bg-light p-2 rounded-lg position-relative"},D.id===a.id&&Object(c.h)(t,null,Object(c.h)("span",{class:"float-right font-weight-lighter text-muted"},Object(c.h)("i",{class:"fas fa-ellipsis-h",onClick:this.toggleMenu,"data-id":e.id}))),l[e.id]&&Object(c.h)(t,null,Object(c.h)("div",{class:"position-absolute bg-white p-2 border rounded rounded-lg shadow-sm",style:"top: 30px; right: 10px; width: 60%; z-index: 999999;"},Object(c.h)("button",{class:"btn btn-link btn-block text-left",onClick:this.toggleEdit,"data-id":e.id,"data-comment":e.comment},Object(c.h)("i",{class:"fas fa-edit"})," Edit"),Object(c.h)("hr",null),Object(c.h)("button",{class:"btn btn-link btn-block text-left",onClick:this.toggleDeleteComment,"data-id":e.id},Object(c.h)("i",{class:"fas fa-trash-alt"})," Delete"))),Object(c.h)("span",{style:"font-size: 0.95em;"},Object(c.h)("h5",{class:"font-weight-bold mb-2",style:"font-size: 1.0em;"},p,i&&i.length>0&&Object(c.h)(t,null,Object(c.h)("span",{class:"font-weight-lighter text-muted ml-2"},i.filter(t=>1===t.public).slice(0,1).map(e=>Object(c.h)(t,null,"- ",Object(c.h)("a",{href:"/teams/public/"+e.uuidv4,class:"mr-2"}," ",e.name)))))),n[e.id]?Object(c.h)(t,null,Object(c.h)("div",{class:"d-flex bd-highlight"},Object(c.h)("div",{class:"p-0 w-100 bd-highlight"},Object(c.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(c.h)(d.c,{id:"comments.comment"},"Kommentar")),Object(c.h)("div",{class:"border rounded rounded-lg position-relative"},Object(c.h)(d.b,null,Object(c.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(c.h)(d.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(m.a)(this,"commentEditText"),onKeyUp:u.a.resizeTextarea,onFocus:u.a.resizeTextarea,style:"height: 2.3em;",value:O})))),Object(c.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(c.h)("button",{type:"button",class:"btn btn-primary mb-2",onClick:this.saveCommentReply,"data-commentid":s.id,"data-id":e.id},Object(c.h)("i",{class:"fas fa-paper-plane"}))))):Object(c.h)(t,null,Object(c.h)(b.a,{markdown:u.a.replaceImages(k,e.images,T),markdownOpts:u.a.getMarkdownOptions()})),h[e.id]&&Object(c.h)("div",{class:"clearfix mt-3 mb-3"},Object(c.h)("button",{class:"btn btn-danger float-left",onClick:this.deleteCommentReply,"data-id":e.id,"data-commentid":s.id},Object(c.h)("i",{class:"fas fa-trash-alt"})," Delete"),Object(c.h)("button",{class:"btn btn-secondary float-right",onClick:this.toggleDeleteComment,"data-id":e.id},Object(c.h)("i",{class:"fas fa-times-circle"})," Cancel")))),Object(c.h)("small",null,Object(c.h)("button",{class:"replyContainer btn btn-sm btn-link py-0 "+(v?"text-primary":""),onClick:this.likeReply,"data-comment":s.id,"data-id":e.id,disabled:v},v?Object(c.h)(d.c,{id:"comments.has-liked"},"Liked"):Object(c.h)(d.c,{id:"comments.like"},"Lik")),"-",Object(c.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.replyComment,"data-id":s.id},Object(c.h)(d.c,{id:"comments.comment-add"},"Kommentar")),e.language!==T&&Object(c.h)(t,null,"-",!j[`${s.id}-${e.id}`]&&x?Object(c.h)(t,null,Object(c.h)("button",{type:"button",class:"btn btn-sm btn-link","data-commentid":s.id,"data-replyid":e.id,onClick:this.showOriginal},Object(c.h)("i",{class:"fas fa-cog"}),"  ",Object(c.h)(d.c,{id:"home.translate-show-original"},"Show original"))):Object(c.h)(t,null,Object(c.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:this.translate,"data-commentid":s.id,"data-replyid":e.id},Object(c.h)("i",{class:"fas fa-cog"})," ",Object(c.h)(d.c,{id:"home.translate-to"},"See translation")))),"-",Object(c.h)("button",{class:"btn btn-sm btn-link py-0 disabled"},o.a.formatDistance(e.createdDate,new Date,{locale:"no-NB"}),e.updatedDate&&Object(c.h)(t,null,Object(c.h)("span",{class:"font-weight-light ml-2"},"(Edited ",o.a.formatDistance(e.updatedDate,new Date,{locale:"no-NB"}),")"))))),e.likes&&Object(c.h)("small",{class:"position-absolute bg-light shadow-sm rounded-lg py-0 px-1",style:"bottom: 20px; right: 15px;"},Object(c.h)("i",{class:"fas fa-thumbs-up text-primary"})," ",e.likes.length)))}),F-L>0&&Object(c.h)("div",null,Object(c.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.toggleReplies,"data-id":s.id},Object(c.h)(d.c,{id:"comments.show-more",fields:{more:F-L}},"Vis ",F-L," flere kommentarer...")))),e[s.id]&&Object(c.h)("div",{class:"col-11 offset-1 d-flex mb-2 position-relative"},Object(c.h)(p.a,{stores:this.props.stores,race:y,initCall:w,callback:v,commentId:s.id,inputRef:t=>this.inputRef[s.id]=t,inputRefObject:this.inputRef,key:"race-commentreply-"+s.id})))}),P-E>0&&Object(c.h)("div",null,Object(c.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.toggleComments},Object(c.h)(d.c,{id:"comments.show-more",fields:{more:P-E}},"Vis ",P-E," flere kommentarer..."))),s&&Object(c.h)("div",null,Object(c.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.toggleComments},Object(c.h)(d.c,{id:"comments.hide-all-comments"},"Skjul alle kommentarene."))))}})||l;e.a=g}).call(this,s("hosL").Fragment)},aGZh:function(t,e,s){"use strict";(function(t){function e(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function a(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var i,l=s("hosL"),c=s("/eY4");const o={};Object(c.a)(i=class extends l.Component{constructor(t){super(t),this.state=function(t){for(var s=1;s<arguments.length;s++){var i=null!=arguments[s]?arguments[s]:{};s%2?e(Object(i),!0).forEach((function(e){a(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},o)}render(){const{appState:e}=this.props.stores,{text:s}=this.props,{language:a="en"}=e;let i=s;const c=new RegExp(`/<${a}>(.*?)</${a}>/`);return s.replace(c,"$1")&&(i=s),Object(l.h)(t,null,i)}})}).call(this,s("hosL").Fragment)},aMCh:function(t,e,s){"use strict";(function(t){var a,i,l,c=s("hosL"),o=s("Utv1"),n=s("/eY4"),r=(s("OhSV"),s("fh8t"),s("ZOvn"));let d=Object(n.a)(a=class extends c.Component{render(){const{checkpoints:e,thClass:s,thStyle:a,selectedCheckpointId:i,width:l,widthCp:o,onClickCheckpoint:n=(()=>{}),dotColor:r}=this.props;return Object(c.h)(t,null,e&&e.map((e,d)=>Object(c.h)(t,null,d>0&&Object(c.h)("th",{class:s,style:a},Object(c.h)("div",{class:"",style:`width: ${l}px;`}," ")),Object(c.h)("th",{class:s,style:a},Object(c.h)("div",{class:"checkpoint position-relative "+(i===e.id?"text-primary":""),style:`width: ${o}px; font-size: 1.1em;`,onClick:n,"data-id":e.id},Object(c.h)("i",{class:"fas fa-campground"}),Object(c.h)("div",{class:`rounded-pill-both px-1 text-center position-absolute ${r?"":"bg-secondary"} font-weight-bold`,style:"bottom: 0px; right: -20px; font-size: 0.6em; "+(r?`background-color: ${r};`:"")},e.sortOrder&&"n/a"!==e.sortOrder&&Object(c.h)(t,null,e.sortOrder)))))))}})||a,h=Object(n.a)(i=class extends c.Component{render(){const{currentClass:e,contestants:s,limit:a,onClickMusher:i,tdClass:l,tdStyle:n,progressStyle:d,progressbarStyle:h}=this.props,{checkpoints:b=[],results:m=[]}=e,p=s&&a?s.slice(0,a):s,{raceStore:u}=this.props.stores,{sortedContestants:O=[]}=u,g=60*e.requiredRestMinutes,j=Math.floor((new Date).getTime()/1e3,10);return Object(c.h)(t,null,p&&p.map((e,s)=>{let a,p,u,f,y=0,v=0,w=O?O.find(t=>t.bib===parseInt(e.bib,10)):null;return w=w||{},Object(c.h)(t,null,Object(c.h)("tr",{class:"musher",onClick:i,"data-bib":e.bib},Object(c.h)("td",{class:l,style:n},e.startTime?o.a.isoTime(e.startTime):""),b&&b.map((s,i)=>{const o=m.slice().filter(t=>t.checkpoint===s.id).sort((b=["timestamp"],(t,e)=>b.map(s=>{let a=1;return"-"===s[0]&&(a=-1,s=s.substring(1)),t[s]>e[s]?a:t[s]<e[s]?-a:0}).reduce((t,e)=>t||e,0)));var b;const O=o.filter(t=>parseInt(t.bib,10)==e.bib),w=O.find(t=>"out"===t.direction),x=O.find(t=>"in"===t.direction),k=O.find(t=>"scratched"===t.direction),S=o.filter(t=>"in"===t.direction||"scratched"===t.direction).findIndex(t=>parseInt(t.bib,10)==e.bib),C=o.filter(t=>"out"===t.direction).findIndex(t=>parseInt(t.bib,10)==e.bib);let I,D=0;if(!s.isStartLine&&x&&w&&x.timestamp&&w.timestamp&&(D=r.a.deltaSec(x.timestamp,w.timestamp)),v+=D||0,!w&&x&&!s.isStartLine&&s.timeEqualization&&g){const t=r.a.deltaSec(x.timestamp,j);I=(v+t)/g*100,I=I>100?100:I}if(f)return"";if(-1===S){if(a){const i=Math.floor((new Date).getTime()/1e3),o=Math.floor(new Date(a.timestamp).getTime()/1e3),r=Math.floor((i-o)/60);let b=r/s.estTimeToCpMinutes*100;b=b>95?95:b;const m=Object(c.h)(t,null,Object(c.h)("td",{class:"text-center align-middle px-0 pr-1 "+l,style:n},Object(c.h)("div",{class:"progress",style:""+d},Object(c.h)("div",{class:"progress-bar progress-bar-striped",role:"progressbar",style:`width: ${b}%; ${h}`,"aria-valuenow":b,"aria-valuemin":"0","aria-valuemax":"100","data-prevtimestamp":a.timestamp,"data-timeUsedOnStage":r,"data-estTimeToCpMinutesPrev":u,"data-nowEpoch":i,"data-prevCpOutEpoch":o},p+1>0?p+1:"")),e.cpId&&O.length>0&&Object(c.h)(t,null)));return p=C,a=w,u=s.estTimeToCpMinutes,m}return""}y=i,p=C,a=w,u=s.estTimeToCpMinutes;const T=Object(c.h)(t,null,(x||k)&&i>0&&Object(c.h)(t,null,Object(c.h)("td",{class:"text-center align-middle px-0 pr-1 "+l,style:n},Object(c.h)("div",{class:"progress",style:""+d},Object(c.h)("div",{class:"progress-bar",role:"progressbar",style:"width: 100%; "+h,"aria-valuenow":"100","aria-valuemin":"0","aria-valuemax":"100"})),e.cpId&&O.length>0&&Object(c.h)(t,null))),Object(c.h)("td",{class:"text-center align-middle px-0 pr-1 "+l,style:n},Object(c.h)("div",{class:"progress",style:""+d},Object(c.h)("div",{class:`progress-bar ${I>0?"progress-bar-striped":""} ${k?"bg-danger":"bg-success"}`,role:"progressbar",style:`width: ${I||100}%; ${h}`,"aria-valuenow":I,"aria-valuemin":"0","aria-valuemax":"100"},k?Object(c.h)("i",{class:"fas fa-times"}):Object(c.h)(t,null,S+1>0?S+1:""))),e.cpId&&O.length>0&&Object(c.h)(t,null)));return f=k,T}),Object(c.h)("td",{colspan:2*b.length-y,class:l,style:n},Object(c.h)("div",{class:"d-flex flex-nowrap"},Object(c.h)("div",{class:"text-white font-weight-bolder pl-2 pr-1 py-0 rounded-pill-left rounded-none mr-2",style:`background-color: ${r.a.getRankingColor(s+1)}; width: 45px;`},e.bib),Object(c.h)("div",null,Object(c.h)("nobr",null,e.flag," ",e.lastname))))))}))}})||i,b=Object(n.a)(l=class extends c.Component{componentWillReceiveProps(t){if(this.props.currentClass.id!==t.currentClass.id||this.props.reloadLastEpoch!==t.reloadLastEpoch){const{currentClass:t}=this.props,{raceStore:e}=this.props.stores,{checkpoints:s=[],contestants:a=[],results:i=[],sortOrderResults:l,startDate:c}=t;e.sortContestantsByResult({contestants:a,results:i,checkpoints:s,sortOrderResults:l,startDate:c})}}componentDidMount(){const{currentClass:t}=this.props,{raceStore:e}=this.props.stores,{checkpoints:s=[],contestants:a=[],results:i=[],sortOrderResults:l,startDate:c}=t;e.sortContestantsByResult({contestants:a,results:i,checkpoints:s,sortOrderResults:l,startDate:c})}render(){const{currentClass:e,onClickMusher:s=(()=>{}),onClickCheckpoint:a=(()=>{}),selectedCheckpointId:i,limit:l=100,tableClass:o="table-striped table-sm",thClass:n,thStyle:r,tdClass:b,tdStyle:m,progressStyle:p="height: 20px;",progressbarStyle:u}=this.props,{checkpoints:O=[]}=e,{raceStore:g}=this.props.stores,{sortedContestants:j=[]}=g;return Object(c.h)(t,null,Object(c.h)("div",{class:"table-responsive"},Object(c.h)("table",{class:"table "+o},Object(c.h)("thead",null,Object(c.h)("tr",null,Object(c.h)("th",{class:n,style:r},Object(c.h)("div",{class:"",style:"width: 40px;"},Object(c.h)("i",{class:"fas fa-flag"}))),Object(c.h)(d,{stores:this.props.stores,checkpoints:O,thClass:n,thStyle:r,selectedCheckpointId:i,width:40,widthCp:20,onClickCheckpoint:a,dotColor:"#808080"}),Object(c.h)("th",{class:n,style:r},Object(c.h)("div",{class:"",style:"width: 20px;"},Object(c.h)("i",{class:"fas fa-flag-checkered"}))))),Object(c.h)("tbody",null,Object(c.h)(h,{stores:this.props.stores,currentClass:e,contestants:j,limit:l,onClickMusher:s,tdClass:b,tdStyle:m,progressStyle:p,progressbarStyle:u})))))}})||l;e.a=b}).call(this,s("hosL").Fragment)},epqT:function(t,e,s){"use strict";(function(t){function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function i(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var l,c=s("hosL"),o=s("Utv1"),n=s("/eY4"),r=s("OhSV");s("ZOvn");const d={showAddComment:!1};let h=Object(r.d)(()=>({subject:Object(c.h)(r.c,{id:"ad.subject"},"Annonseforespørsel"),body:Object(c.h)(r.c,{id:"ad.body"},"Hei, Jeg ønsker å vite mer om annonsering i appen The Musher.")}))(l=Object(n.a)(l=class extends c.Component{constructor(t){var e;super(t),e=this,this.logClick=async function(){const{adStore:t,userStore:s}=e.props.stores,{ads:a=[]}=t;let i=a.length>0?a[0].id:null;const{user:l={}}=s;await t.logClick({id:i,user:l.id})},this.state=function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){i(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},d),this.updateTimer={},this.inputRef={},this.apiServer=o.a.getApiServer()}async loadAd(t=this.props){this.setState({isLoading:!0});const{adStore:e,workoutStore:s,userStore:a,appState:i}=this.props.stores,{section:l}=this.props,{path:c=""}=i,{currentTeam:o}=s,{user:n}=a,{language:r="en"}=n;let d,h,b,m,p,u={};o&&(u=a.findTeam(o,!0),u&&u.id&&(d=a.findTeamAmbition({ambition:u.ambitions,language:r}),h=a.findTeamType({type:u.type,language:r}),b=u.postalcode,m=u.place,p=u.country));let O=c.replace(/\d+$/,"detail");O=c.replace(/\/\d+/,"/detail"),await e.load({query:{page:O,section:l}}),e.setTime(),this.setState({isLoading:!1})}componentDidMount(){this.loadAd()}componentWillReceiveProps(t){t.path!==this.props.path&&this.loadAd(t)}render(){const{adStore:e,userStore:s,appState:a}=this.props.stores,{subject:i,body:l,section:o}=this.props,{path:n}=a,{user:d={}}=s,{ads:h=[],time:b}=e;if(!d||!d.id||!h||0===h.length)return n.match(/\/(home)/i)?Object(c.h)(t,null,Object(c.h)("div",{class:"w-100"},Object(c.h)("div",{class:"row"},Object(c.h)("div",{class:"col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mb-0 position-relative"},Object(c.h)("div",{class:"border rounded-lg p-4 my-3"},Object(c.h)("span",{class:"float-right display-4 text-warning"},Object(c.h)("i",{class:"far fa-smile-wink"})),Object(c.h)("h5",null,Object(c.h)(r.c,{id:"ad.heading"},"Vil du annonsere her?")),Object(c.h)("div",null,Object(c.h)(r.c,{id:"ad.teaser"},"Det er super enkelt :)")),Object(c.h)(r.b,null,Object(c.h)("a",{href:`mailto:post@themusher.no?subject=${i}: ${n}: ${o}&body=${l}`,target:"_blank",rel:"noreferrer"},Object(c.h)("i",{class:"fas fa-paper-plane"})," ",Object(c.h)(r.c,{id:"ad.linktext"},"Ta kontakt med The Musher")))))))):Object(c.h)(t,null);const m=h[0];return Object(c.h)(t,null,Object(c.h)("div",{class:"w-100"},Object(c.h)("div",{class:"row"},Object(c.h)("div",{class:"col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mb-0 position-relative"},Object(c.h)("div",null,Object(c.h)("small",null,Object(c.h)("small",{class:"text-muted"},Object(c.h)(r.c,{id:"ad.ad"},"Annonse"),":",Object(c.h)("img",{src:`${this.apiServer}/api/ads/${m.id}/view?user=${d.id}&time=${b}`,style:"width: 1; height: 1; opacity: 0.1;"})))),m.target?Object(c.h)(t,null,Object(c.h)("a",{class:"stretched-link",href:""+m.url,target:m.target||"_blank",rel:"noopener noreferrer",onClick:this.logClick,native:!0},m.images&&m.images[0]&&Object(c.h)(t,null,Object(c.h)("img",{src:m.images[0].s3LargeLink,class:"img-fluid rounded-lg"})))):Object(c.h)(t,null,Object(c.h)("a",{class:"stretched-link",href:""+m.url,onClick:this.logClick},m.images&&m.images[0]&&Object(c.h)(t,null,Object(c.h)("img",{src:m.images[0].s3LargeLink,class:"img-fluid rounded-lg"}))))))))}})||l)||l;e.a=h}).call(this,s("hosL").Fragment)},gOLw:function(t,e,s){"use strict";(function(t){function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function i(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var l,c=s("hosL"),o=s("Utv1"),n=s("/eY4"),r=(s("X9Km"),s("NMoA")),d=s("VKmm"),h=s("rWES"),b=s("epqT"),m=s("yHBq"),p=s("q/oJ"),u=s("gWxU"),O=s("Nanz"),g=s("ISGx"),j=s("ZOvn");const f=j.a.marginTop(!1),y={loading:!1,limit:10,offset:0,idxConfirm:0,idxSuggestion:1,idxAd:5,sessionid:(new Date).getTime()},v=["id","type","user","team","title"];let w=Object(n.a)(l=class extends c.Component{constructor(e){var s;super(e),s=this,this.reloadStories=async function(){const{appState:t}=s.props.stores;let{limit:e,offset:a}=s.state;a=0,s.setState({offset:a}),await s.loadStoriesPublicFeed({props:s.props,limit:e,offset:a}),t.appContainerScrollTop()},this.setCheckForNewStories=(t=this.props)=>{this.checkForNewStoriesTimer=setInterval(()=>this.checkForNewStories({props:t}),6e4)},this.clearCheckForNewStories=()=>{clearInterval(this.checkForNewStoriesTimer)},this.insertTopRanked=()=>{const{storyStore:t}=this.props.stores,{publicFeed:e,topRankedStories:s}=t,a=o.a.shuffleArray(s),i=[...e];let l=0;const c=new Date;i.forEach((t,e)=>{const s=o.a.parseInputDate(t.date);Math.floor((c.getTime()-s.getTime())/1e3)<86400&&(l=e+1)});const n=i.length;if(n>l+3){for(let t=0,e=3;t<e;t+=1){const e=j.a.randomInt(l,n);o.a.isObject(a[t])&&i.splice(e,0,a[t])}t.localUpdateField("publicFeed",i)}},this.insertAds=()=>{const{idxAd:t}=this.state,{storyStore:e}=this.props.stores,{publicFeed:s}=e,a=[...s];a.splice(t,0,{type:"ad",wrapperClassNames:"row",contentClassNames:"col-12"}),e.localUpdateField("publicFeed",a)},this.insertTeamConfirm=()=>{const{idxConfirm:t}=this.state,{storyStore:e}=this.props.stores,{publicFeed:s}=e,a=[...s];a.splice(t,0,{type:"teamConfirm",wrapperClassNames:"row",contentClassNames:"col-12"}),e.localUpdateField("publicFeed",a)},this.insertTeamSuggestions=()=>{const{idxSuggestion:t}=this.state,{storyStore:e}=this.props.stores,{publicFeed:s}=e,a=[...s];a.splice(t,0,{type:"teamSuggestions",wrapperClassNames:"row",contentClassNames:"col-12"}),e.localUpdateField("publicFeed",a)},this.setLoadMore=()=>{const{storyStore:t}=this.props.stores;t.setLoadMore(()=>{let{limit:t,offset:e}=this.state;e+=t,this.setState({offset:e}),this.loadStoriesPublicFeed({limit:t,offset:e})})},this.unsetLoadMore=()=>{const{storyStore:t}=this.props.stores;t.setLoadMore(()=>{})},this.onTeamClick=(t,e)=>(t.preventDefault(),t.stopPropagation(),this.setState({showTeam:e}),!1),this.hideTeam=()=>{this.setState({showTeam:null})},this.onUserClick=t=>(t.preventDefault(),t.stopPropagation(),!1),this.onDogClick=(t,e,s)=>(t.preventDefault(),t.stopPropagation(),this.setState({showDog:e,dogs:s}),!1),this.hideDog=()=>{this.setState({showDog:null})},this.setupIntersection=()=>{this.setState({handleIntersection:j.a.intersectionObserverCallback});const{storyStore:t}=this.props.stores;this.scrollViewTimer=setInterval(()=>t.postScrollview(j.a.getIntersectionObserverHistory()),3e4)},this.renderContent=({obj:e,idx:s})=>{const{appState:a}=this.props.stores,{path:i}=a,{hashtag:l}=this.props;return"ad"===e.type?Object(c.h)(t,null,Object(c.h)(b.a,{stores:this.props.stores,path:i})):"teamConfirm"===e.type?Object(c.h)(t,null,Object(c.h)(h.a,{stores:this.props.stores})):"teamSuggestions"===e.type?Object(c.h)(t,null,Object(c.h)(d.a,{stores:this.props.stores})):"workout"===e.type?Object(c.h)(t,null,Object(c.h)(g.a,{stores:this.props.stores,feed:e,idx:s,onTeamClick:this.onTeamClick,onUserClick:this.onUserClick,onDogClick:this.onDogClick,holdingStore:"story"})):Object(c.h)(t,null,Object(c.h)(r.a,{stores:this.props.stores,story:e,hashtag:l,key:"story-detail-"+e.id,onTeamClick:this.onTeamClick,onUserClick:this.onUserClick}))},this.state=function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){i(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},y),this.inputRef={},this.ref={}}async loadStoriesPublicFeed({props:t=this.props,limit:e,offset:s}){const{hashtag:a,hashtags:i,teamid:l}=t,{storyStore:c}=t.stores;await c.loadPublicFeed({hashtag:a,hashtags:i,teamid:l,limit:e,offset:s,sort:void 0}),s||(this.insertTopRanked(),this.insertTeamConfirm())}async checkForNewStories({props:t=this.props}){const{hashtag:e,hashtags:s,teamid:a}=t,{storyStore:i}=t.stores;await i.checkForNewStories({hashtag:e,hashtags:s,teamid:a})}componentWillMount(){this.setupIntersection()}componentDidMount(){const{limit:t}=this.state;this.loadStoriesPublicFeed({limit:t,offset:0}),this.setLoadMore(),this.setCheckForNewStories()}componentWillUnmount(){this.unsetLoadMore();const{storyStore:t}=this.props.stores;t.postScrollview(j.a.getIntersectionObserverHistory()),clearInterval(this.scrollViewTimer),this.clearCheckForNewStories()}componentWillReceiveProps(t){if(t.hashtag!==this.props.hashtag||t.path!==this.props.path){const{limit:e}=this.state;this.loadStoriesPublicFeed({props:t,limit:e,offset:0})}}render(){const{loading:e,handleIntersection:s,sessionid:a,showTeam:i,showDog:l}=this.state,{storyStore:o,appState:n}=this.props.stores,{publicFeed:r,hasNewStories:d,publicDogs:h}=o,{darkmode:b}=n;return Object(c.h)(t,null,i&&Object(c.h)(p.a,null,Object(c.h)(u.default,{stores:this.props.stores,teamid:i,marginTop:"0px;",marginBottom:"0px;",back:this.hideTeam})),l&&Object(c.h)(p.a,null,Object(c.h)(O.default,{stores:this.props.stores,dogid:l,marginTop:"0px;",marginBottom:"0px;",back:this.hideDog,dogs:h})),Object(c.h)("div",{class:"w-100"},d&&Object(c.h)(t,null,Object(c.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 d-flex justify-content-center fixed-top",style:`margin-top: ${f};`},Object(c.h)("button",{class:"btn btn-sm btn-primary rounded-pill",onClick:this.reloadStories},"New stories"))),Object(c.h)(m.a,{data:r,wrapperClassNames:"row pb-1",contentClassNames:`col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 my-1 position-relative rounded rounded-lg py-3 bg-${b?"black":"white"} shadow-sm`,renderContent:this.renderContent,dataFields:v,handleIntersection:s,sessionid:a}),e&&Object(c.h)("div",{class:"d-flex justify-content-center"},Object(c.h)("div",{class:"spinner-border text-primary",role:"status"},Object(c.h)("span",{class:"sr-only"},"Loading...")))))}})||l;e.a=w}).call(this,s("hosL").Fragment)},gcyc:function(t,e,s){"use strict";(function(t){var a,i=s("hosL"),l=s("Utv1"),c=s("/eY4"),o=s("OhSV"),n=s("fh8t"),r=s.n(n),d=s("ZOvn"),h=s("ZQlJ"),b=s("s4FZ"),m=s("e0EM");let p=Object(c.a)(a=class extends i.Component{constructor(t){super(t),this.toggleAdminInfo=t=>{t.stopPropagation();const{showAdminInfo:e}=this.state;this.setState({showAdminInfo:!e})},this.toggleInfo=t=>{t.stopPropagation();const{showInfo:e}=this.state;this.setState({showInfo:!e})},this.onDogClick=(t,e,s)=>{t.preventDefault(),t.stopPropagation();const a=s.find(t=>t.uuidv4===e);return this.setState({currentDog:a,showDog:e,dogs:s}),!1},this.chooseSubmenu=t=>{const e=t.target.closest("button").dataset.submenu;this.setState({submenu:e})},this.state={}}render(){const{raceStore:e,userStore:s}=this.props.stores,{showAdminInfo:a,submenu:c="details",showDog:n,currentDog:p={}}=this.state,{totalTrackLength:u}=e,{contestant:O={},onMarkerClick:g=(()=>{}),children:j,rank:f}=this.props,y=e.findWaypointByBib(O.bib),{isAdmin:v}=s,w=(O.bib?e.getMusherByBibId(O.bib):e.getMusherByBibEmail(O.email))||{},x=e.getTeamById(w.team),k=x.members?x.members.find(t=>t.email===w.email):{},S=(e.getClassByBib(O.bib),e.getTotalsByTeamId(w.team));let C=d.a.getImage({user:k,team:x,priority:"user",fallback:w.image1});const I=d.a.displayNameShort(k)||d.a.displayNameShort(w),D=O.color,T=d.a.hasBirthday(p.birth),R=p.birth?Math.ceil(d.a.daysUntilNextBirthday(p.birth)):365,{inFront:P,behind:E}=(l.a.format(y.totalDistanceOnTrack/u*100,0),e.findNearestMushers(O.bib)),F=x&&x.imageHeader&&x.imageHeader.s3XXLargeLink?x.imageHeader:{s3XXLargeLink:w.topImage1||"./assets/homerun-race-logo.png"},L=x&&x.images?[...x.images]:[];for(let t=0,e=3;t<e;t+=1)w["image"+t]&&L.push({s3SmallLink:w["image"+t],s3LargeLink:w["image"+t]});return Object(i.h)(t,null,Object(i.h)("div",{class:"w-100 position-absolute",style:"z-index: -1; height: 18vh; top: 0px; left: 0px; background-size: cover; background-repeat: no-repeat; background-position: 50% 30%; background-color: #a0a0a0; "+(F?`background-image: url("${F.s3XXLargeLink}");`:"")}),Object(i.h)("div",{class:"d-flex position-relative",style:"margin-top: 17vh;"},Object(i.h)("div",{class:"position-relative text-center border rounded-circle imageRounded",style:"margin-top: -50px; "+(C?`background-image: url("${C}"); background-size: cover;`:"background-color: #c0c0c0;")},!C&&Object(i.h)("div",{class:"text-muted",style:"font-size: 35px; padding-top: 10px;"},I),Object(i.h)("div",{class:`rounded-pill-both px-2 text-center position-absolute ${D?"":"bg-secondary"} font-weight-bold`,style:"bottom: -8px; right: 0; font-size: 1.2em; "+(D?`background-color: ${D};`:"")},f&&Object(i.h)(t,null,f))),Object(i.h)("div",{class:"flex-grow-1 pl-3 text-overflow mb-0",style:"line-height: 1.2em;"},Object(i.h)("h5",{class:"mb-0"},Object(i.h)("div",{class:"d-flex flex-nowrap"},Object(i.h)("div",{class:"text-white font-weight-bold pl-2 pr-1 py-0 rounded-pill-left rounded-none mr-2",style:`background-color: ${d.a.getRankingColor(f)}; width: 55px;`},w.bib),Object(i.h)("div",null,Object(i.h)("nobr",null,w.flag," ",w.firstname," ",w.lastname)))),Object(i.h)("span",{class:"mb-0",style:"margin-left: 93px;"},w.sportsClub||x.name||Object(i.h)(t,null," ")))),Object(i.h)("div",{class:"d-flex justify-content-center mb-3"},Object(i.h)("div",{class:"col px-0 pt-2"},Object(i.h)("button",{type:"button",class:`btn btn-block rounded-pill-left rounded-none ${"details"===c?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;",onClick:this.chooseSubmenu,"data-submenu":"details"},"Details")),Object(i.h)("div",{class:"col px-0 pt-2"},Object(i.h)("button",{type:"button",class:`btn btn-block rounded-none ${"gpsdata"===c?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;",onClick:this.chooseSubmenu,"data-submenu":"gpsdata"},"GPS Data")),Object(i.h)("div",{class:"col px-0 pt-2"},Object(i.h)("button",{type:"button",class:`btn btn-block rounded-none ${"team"===c?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;",onClick:this.chooseSubmenu,"data-submenu":"team"},"Team")),Object(i.h)("div",{class:"col px-0 pt-2"},Object(i.h)("button",{type:"button",class:`btn btn-block rounded-pill-right rounded-none ${"dogs"===c?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;",onClick:this.chooseSubmenu,"data-submenu":"dogs"},"Dogs"))),Object(i.h)("div",{class:"w-100 overflow-auto position-relative"},"details"===c&&Object(i.h)(t,null,j),"gpsdata"===c&&Object(i.h)(t,null,Object(i.h)(m.a,{stores:this.props.stores,wp:y,musher:w})),"team"===c&&Object(i.h)(t,null,x.public>0?Object(i.h)(t,null,Object(i.h)("h3",null,x.name),Object(i.h)(r.a,{markdown:d.a.replaceImages(x.description,x.images),markdownOpts:d.a.getMarkdownOptions()}),Object(i.h)(b.a,{stores:this.props.stores,images:L})):Object(i.h)(t,null,Object(i.h)("div",{class:"text-center text-muted"},Object(i.h)("div",{class:"display-1"},Object(i.h)("i",{class:"fas fa-dog"})),Object(i.h)("h3",null,Object(i.h)(o.c,{id:"teams.no-public-team"},"No public team!")),Object(i.h)(o.c,{id:"teams.no-public-team"},"This team is not publicly visible."),L&&Object(i.h)("div",{class:"my-3"},Object(i.h)(b.a,{stores:this.props.stores,images:L}))))),"dogs"===c&&Object(i.h)(t,null,x.public>0?Object(i.h)(t,null,x.dogs&&Object(i.h)("div",{class:"w-100 container-fluid"},Object(i.h)("div",{class:"row pt-2"},Object(i.h)(h.a,{stores:this.props.stores,dogs:x.dogs.map(t=>t.id),allDogs:x.dogs,onDogClick:this.onDogClick}))),n&&Object(i.h)(t,null,Object(i.h)("div",{class:"d-flex mb-0 mt-3 position-relative"},Object(i.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedLarge text-muted pt-2",style:p.image?`background-image: url("${p.image.s3LargeLink}"); background-size: cover;`:""},!p.image&&Object(i.h)("span",{class:"font-weight-lighter",style:"font-size: 35px;"},l.a.ucfirst(p.name,!0))),Object(i.h)("div",{class:"flex-grow-1 pl-3 pr-2",style:`border-right: 4px solid ${s.findHarness(p.harness,"colorNonstop")} !important; line-height: 1.2em;`},Object(i.h)("h5",{class:"mb-1"},p.shortname||p.name," ",p.shortname&&""!==p.shortname&&Object(i.h)(t,null," - ",Object(i.h)("span",{class:"font-weight-lighter"},p.name)),T&&Object(i.h)(t,null,Object(i.h)("i",{class:"fas fa-birthday-cake ml-3"}))),Object(i.h)("div",null,R<7&&Object(i.h)(t,null,Object(i.h)("span",{class:"text-muted mr-2"},Object(i.h)("i",{class:"fas fa-birthday-cake"})," in ",R," days")),p.birth&&Object(i.h)("span",{class:"mr-2"},l.a.age(p.birth,p.deceased)),"female"===p.gender?Object(i.h)("i",{class:"fas fa-venus"}):Object(i.h)("i",{class:"fas fa-mars"})))))):Object(i.h)(t,null,Object(i.h)("div",{class:"text-center text-muted"},Object(i.h)("div",{class:"display-1"},Object(i.h)("i",{class:"fas fa-dog"})),Object(i.h)("h3",null,Object(i.h)(o.c,{id:"teams.no-public-team"},"No public team!")),Object(i.h)(o.c,{id:"teams.no-public-team"},"This team is not publicly visible.")))),v&&Object(i.h)("div",{style:"max-height: 200px; max-width: 70vw; overflow: auto;"},Object(i.h)("button",{class:"btn btn-link btn-block",onClick:this.toggleAdminInfo},"Toggle admin info"),a&&Object(i.h)(t,null,Object(i.h)("small",null,Object(i.h)("xmp",null,"musher: ",JSON.stringify(w,null,4),Object(i.h)("br",null),"user: ",JSON.stringify(k,null,4),Object(i.h)("br",null),"team: ",JSON.stringify(x,null,4),Object(i.h)("br",null),"totals: ",JSON.stringify(S,null,4),Object(i.h)("br",null))))),Object(i.h)("div",{class:"d-flex position-absolute",style:"right: 10px; bottom: 10px;"},P.bib&&Object(i.h)("a",{class:"text-primary mx-2",onClick:()=>g(P),style:"line-height: 1.0em; font-size: 2.3em;"},Object(i.h)("i",{class:"fas fa-angle-left"})),E.bib&&Object(i.h)("a",{class:"text-primary mx-2",onClick:()=>g(E),style:"line-height: 1.0em; font-size: 2.3em;"},Object(i.h)("i",{class:"fas fa-angle-right"})))))}})||a;e.a=p}).call(this,s("hosL").Fragment)},hwiY:function(t,e,s){"use strict";(function(t){function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function i(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){l(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function l(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var c,o,n,r=s("hosL"),d=s("Utv1"),h=s("/eY4"),b=s("OhSV"),m=(s("Y3FI"),s("fh8t")),p=s.n(m),u=(s("go65"),s("ZOvn")),O=s("om2D"),g=s("TiXY"),j=s("cH0S"),f=s("9xg+");let y=Object(h.a)(c=class extends r.Component{constructor(...t){var e;super(...t),e=this,this.handleImageErrored=t=>{const e=t.target;e.onerror=null,setTimeout(()=>{e.src+="?"+new Date},1e3)},this.removeImage=async function(t){const{userStore:s}=e.props.stores,{user:a}=e.props;s.removeImage({id:a.id,name:t.target.parentElement.dataset.name||t.target.dataset.name})},this.removeMainImage=()=>{const{user:t,field:e,updateField:s}=this.props;s({id:t.id,field:e,value:{}})}}render(){const{saved:t,user:e,type:s="text",field:a,title:i,icon:l,help:c,onInput:o,updateField:n}=this.props,d=e[a],h=t=>!e.image||t.md5!==e.image.md5;return"image"===s?Object(r.h)("div",{class:"form-group "+(t[`${a}.${e.id}`]?"is-valid":"")},Object(r.h)("label",{for:a+"Input"},l&&Object(r.h)("i",{class:l+" text-muted"})," ",i),Object(r.h)("div",{class:"container-fluid"},Object(r.h)("div",{class:"row"},e.image&&e.image.s3SmallLink&&Object(r.h)("div",{class:"col-3 p-1"},Object(r.h)("img",{src:e.image.s3SmallLink,class:"img-fluid border rounded-lg",onError:this.handleImageErrored}),Object(r.h)("button",{class:"btn btn-sm btn-link",onClick:this.removeMainImage,"data-name":e.image.name},Object(r.h)("i",{class:"fas fa-trash"})," Del"),Object(r.h)("span",{class:"badge badge-success"},"Main")),e.images&&e.images.filter(h).map(t=>Object(r.h)("div",{class:"col-3 p-1"},Object(r.h)("img",{src:t.s3SmallLink,class:"img-fluid",onError:this.handleImageErrored}),Object(r.h)("button",{class:"btn btn-sm btn-link",onClick:this.removeImage,"data-name":t.name},Object(r.h)("i",{class:"fas fa-trash"})," Del"))))),Object(r.h)(O.a,{saved:t,object:e,field:a,updateField:n,autoOpen:!1}),t[`${a}.${e.id}`]?Object(r.h)("div",{class:"valid-feedback",style:"display: block;"},Object(r.h)(b.c,{id:"users.changes-saved"},"Endringene er lagret")):Object(r.h)("small",{id:a+"Help",class:"form-text text-muted"},c)):"file"===s?Object(r.h)("div",{class:"form-group "+(t[`${a}.${e.id}`]?"is-valid":"")},Object(r.h)("label",{for:a+"Input"},l&&Object(r.h)("i",{class:l+" text-muted"})," ",i),Object(r.h)(g.a,{saved:t,object:e,field:a,updateField:n}),t[`${a}.${e.id}`]?Object(r.h)("div",{class:"valid-feedback",style:"display: block;"},Object(r.h)(b.c,{id:"users.changes-saved"},"Endringene er lagret")):Object(r.h)("small",{id:a+"Help",class:"form-text text-muted"},c)):Object(r.h)("div",{class:"form-group "+(t[`${a}.${e.id}`]?"is-valid":"")},Object(r.h)("label",{for:a+"Input"},l&&Object(r.h)("i",{class:l+" text-muted"})," ",i),Object(r.h)("input",{type:"text",class:"form-control "+(t[`${a}.${e.id}`]?"is-valid":""),id:a+"Input","aria-describedby":a+"Help",value:d,"data-id":e.id,"data-field":a,onInput:o}),t[`${a}.${e.id}`]?Object(r.h)("div",{class:"valid-feedback",style:"display: block;"},Object(r.h)(b.c,{id:"users.changes-saved"},"Endringene er lagret")):Object(r.h)("small",{id:a+"Help",class:"form-text text-muted"},c))}})||c,v=Object(h.a)(o=class extends r.Component{render(){const{dog:e,children:s,onDogClick:a=(()=>{})}=this.props,{userStore:i}=this.props.stores,{vaccineLogStatuses:l}=i;return Object(r.h)("div",{class:"d-flex mb-0 position-relative mb-3 dogInfo","data-id":e.id},Object(r.h)("div",null,Object(r.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedMedium text-muted pt-2",style:e.image?`background-image: url("${e.image.s3SmallLink}"); background-size: cover;`:""},!e.image&&Object(r.h)("span",{class:"font-weight-lighter",style:"font-size: 35px;"},d.a.ucfirst(e.name,!0)))),Object(r.h)("div",{class:"flex-grow-1 pl-3 pr-2",onClick:a},s,Object(r.h)("span",{class:"float-right"},e.birth&&Object(r.h)("span",{class:"mr-2"},d.a.age(e.birth,e.deceased)),"female"===e.gender?Object(r.h)("i",{class:"fas fa-venus"}):Object(r.h)("i",{class:"fas fa-mars"})),Object(r.h)("h6",{class:"mb-1",style:"line-height: 1.0em;"},e.shortname||e.name," ",e.shortname&&""!==e.shortname&&Object(r.h)(t,null," - ",Object(r.h)("span",{class:"font-weight-lighter"},e.name))),e.chipId?Object(r.h)(t,null,Object(r.h)("i",{class:"fas fa-microchip text-muted"})," ",e.chipId):Object(r.h)(t,null,Object(r.h)("div",{class:"alert alert-danger",role:"alert"},Object(r.h)(b.c,{id:"races.missing-chipid"},"Missing chid id"))),Object(r.h)("div",null,l&&l.filter(t=>t.chipId===e.chipId).map(e=>Object(r.h)("span",{class:`badge badge-${e.inKarens?"warning":"success"} mr-2 mb-1`},e.vaccineAgens.name,Object(r.h)("span",{class:"font-weight-lighter ml-2 d-none d-sm-block"},Object(r.h)("i",{class:"fas fa-calendar-check"})," ",d.a.isoDate(e.vaccineAgens.durationEnd,!1,!1,!0),e.inKarens&&Object(r.h)(t,null,Object(r.h)("br",null),"(karens: ",d.a.format(e.karensDaysLeft,0)," days left)")))))))}})||o,w=Object(h.a)(n=class extends r.Component{constructor(t){var e;super(t),e=this,this.updateField=t=>{const{id:e,field:s,type:a,elementtype:i}=t.target.dataset,l=t.target.value;this.updateFieldValue({id:parseInt(e,10),field:s,value:l,type:a,elementtype:i})},this.updateFieldValue=({id:t,field:s,value:a,datatype:i,elementtype:l,skipTimer:c=!1})=>{const{userStore:o}=this.props.stores;let n=a,r=a;const{user:d}=o;"images"===s&&Array.isArray(d.images)&&Array.isArray(a)&&(r=[...d.images,...a]),"array"!==i||Array.isArray(a)||(n="number"===l?a.split(",").map(t=>parseFloat(t)||t):a.split(",")),o.updateField(t,s,r),c?this.doUpdateField(t,s,n):(clearTimeout(this.updateTimer[s]),this.updateTimer[s]=setTimeout((async function(){e.doUpdateField(t,s,n)}),500))},this.signupToRace=async function(){const{raceStore:t,userStore:s}=e.props.stores,{user:a}=s,{signup:l}=t,{race:c={}}=e.props,o=c.id;await t.addContestant({id:o,classId:l.class,newContestant:i({team:a.team,firstname:a.firstname,lastname:a.lastname,sportsClub:a.sportsClub,email:a.email,cellphone:a.cellphone,facebook:a.facebook,instagram:a.instagram},l)})},this.updateSignup=t=>{const e=t.target.id,s=t.target.value,{raceStore:a}=this.props.stores;a.updateObjectKeyValue("signup",e,s)},this.editSignup=t=>{const{race:e={}}=this.props,s=e.id,{raceStore:a}=this.props.stores,i=t.target.id,l=t.target.value,{classid:c,contestantid:o}=t.target.dataset;a.updateObjectKeyValue("signup",i,l);const n={raceClassId:c,contestantId:o,["raceClassContestant"+d.a.ucfirst(i)]:l};clearTimeout(this.updateTimer[i]),this.updateTimer[i]=setTimeout((async function(){a.editClass({id:s,data:n}),a.localUpdateSignup(i,l),"team"===i&&await a.loadTeams(l,!0)}),500)},this.clearSignupValue=async function(t){const{race:s={}}=e.props,a=s.id,{raceStore:i}=e.props.stores,l=t.target.id,{classid:c,contestantid:o}=t.target.dataset;i.updateObjectKeyValue("signup",l,"null");const n={raceClassId:c,contestantId:o,["raceClassContestant"+d.a.ucfirst(l)]:"null"};clearTimeout(e.updateTimer[l]),i.editClass({id:a,data:n}),i.localUpdateSignup(l,"null"),"team"===l&&await i.loadTeams("null",!0)},this.toggleDrawer=()=>{const{showDrawer:t}=this.state;this.setState({showDrawer:!t})},this.onDogClick=t=>{const{id:e}=t.target.closest(".dogInfo").dataset;console.log("onDogClick",e);const{userStore:s,raceStore:a}=this.props.stores,{signup:i}=a,l=s.findDogsByTeam(parseInt(i.team,10)).find(t=>t.id==e);this.setState({showDrawer:!0,currentDog:l})},this.chooseSubmenu=t=>{t.stopPropagation();this.setState({submenu:t.target.parentElement.dataset.menu||t.target.dataset.menu})},this.state={submenu:"info",showDrawer:!1},this.inputRef={},this.updateTimer={}}async doUpdateField(t,e,s){const{userStore:a}=this.props.stores;await a.saveField(t,e,s)}render(){const{submenu:e,showDrawer:s,currentDog:a}=this.state,{userStore:i,raceStore:l}=this.props.stores,{user:c={},teams:o=[],saved:n}=i,{language:h="en"}=c,{race:m={}}=this.props,{signup:O}=l;let g={},w=[];O.class&&(g=l.getRaceClassById(O.class)),O.team&&(w=i.findDogsByTeam(parseInt(O.team,10)));const x=new Date,k=u.a.getAlphabet(g.dogs).filter(t=>O["dog"+t]).map(t=>O["dog"+t]),S=t=>-1===k.indexOf(t.chipId);return Object(r.h)(t,null,Object(r.h)("div",{class:"row"},Object(r.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2"},Object(r.h)("h2",{class:"mb-0"},Object(r.h)(b.c,{id:"races.signup"},"Påmelding"))),Object(r.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2"},x>=new Date(m.signupStartDate)&&x<=new Date(m.signupEndDate)?Object(r.h)(t,null,Object(r.h)("span",{class:"font-weight-lighter"},Object(r.h)(b.c,{id:"races.signed-in-as"},"Logget inn som"),":")," ",c.email,Object(r.h)("br",null),Object(r.h)("br",null),O.id?Object(r.h)(t,null,Object(r.h)("div",{class:"font-weight-bold mb-4"},Object(r.h)("i",{class:"fas fa-check text-success"})," ",Object(r.h)(b.c,{id:"races.signed-up"},"Din bruker er påmeldt!"),Object(r.h)("br",null)),!m.liveRace&&m.signuppayment&&Object(r.h)(t,null,Object(r.h)("div",{class:"form-group row my-2"},Object(r.h)("label",{for:"cellphone",class:"col-2 col-form-label text-right font-weight-lighter"},Object(r.h)(b.c,{id:"races.signup"},"Påmelding")),Object(r.h)("div",{class:"col-10"},O.paidSignupfee?Object(r.h)("div",{class:"py-2"},Object(r.h)(b.c,{id:"races.paid"},"Betalt"),": ",d.a.formatDate(O.paidSignupfee),Object(r.h)("i",{class:"fas fa-check text-success ml-3"})):Object(r.h)(t,null,Object(r.h)("div",{class:"alert alert-danger mb-1",role:"alert"},Object(r.h)("h5",null,Object(r.h)("span",{class:"font-weight-lighter"},Object(r.h)(b.c,{id:"races.payment-info"},"Betaling påmelding"),":"),Object(r.h)("br",null),Object(r.h)(p.a,{markdown:u.a.replaceImages(m.signuppayment,m.images,h),markdownOpts:u.a.getMarkdownOptions()}),g.signupfee||m.signupfee," NOK")))))),Object(r.h)("div",{class:"w-100 overflow-hidden"},Object(r.h)("div",{class:"d-flex flex-row flex-nowrap pb-2 px-1",style:"overflow: auto; scroll-snap-type: x mandatory;"},Object(r.h)("div",{class:"col px-0 pt-2"},Object(r.h)("button",{class:`btn btn-block rounded-pill-left rounded-none ${"info"===e?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"info",onClick:this.chooseSubmenu},Object(r.h)("i",{class:"fas fa-info-circle"})," ",Object(r.h)(b.c,{id:"race.info"},"Info"))),Object(r.h)("div",{class:"col px-0 pt-2"},Object(r.h)("button",{class:`btn btn-block rounded-pill-right rounded-none ${"chiplist"===e?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"chiplist",onClick:this.chooseSubmenu},Object(r.h)("i",{class:"fas fa-list-ol"})," ",Object(r.h)(b.c,{id:"race.chiplist"},"Chiplist"))))),"info"===e&&Object(r.h)(t,null,Object(r.h)("div",{class:"form-group row my-5"},Object(r.h)("label",{for:"team",class:"col-3 col-form-label text-right font-weight-lighter"},Object(r.h)(b.c,{id:"races.team"},"Team")),Object(r.h)("div",{class:"col-9"},Object(r.h)("select",{class:"form-control form-control-lg",id:"team","aria-describedby":"teamHelp","data-classid":O.class,"data-contestantid":O.id,onInput:this.editSignup,value:O.team},Object(r.h)("option",{value:""},"-- ",Object(r.h)(b.c,{id:"races.choose-team"},"Velg team")," --"),o.map(t=>Object(r.h)("option",{value:t.id},t.name))),O.team?Object(r.h)(t,null):Object(r.h)(t,null,Object(r.h)("div",{class:"alert alert-danger clearfix",role:"alert"},Object(r.h)("span",{class:"display-4 float-left mr-3"},Object(r.h)("i",{class:"fas fa-exclamation-triangle"})),Object(r.h)(b.c,{id:"races.choose-race-team",fields:{title:m.title}},"Please choose race team for ",m.title))))),Object(r.h)("div",{class:"form-group row my-2"},Object(r.h)("label",{for:"cellphone",class:"col-3 col-form-label text-right font-weight-lighter"},Object(r.h)(b.c,{id:"races.cellphone"},"Mobil")),Object(r.h)("div",{class:"col-9"},Object(r.h)(b.b,null,Object(r.h)("input",{type:"text",class:"form-control",id:"cellphone","data-classid":O.class,"data-contestantid":O.id,onInput:this.editSignup,value:O.cellphone,placeholder:Object(r.h)(b.c,{id:"races.cellphone-help"},"Hva er mobilnummer ditt?")})))),O.name&&Object(r.h)("div",{class:"form-group row my-2"},Object(r.h)("label",{for:"name",class:"col-3 col-form-label text-right font-weight-lighter"},Object(r.h)(b.c,{id:"races.name"},"Navn")),Object(r.h)("div",{class:"col-9"},O.name)),Object(r.h)("div",{class:"form-group row my-2"},Object(r.h)("label",{for:"firstname",class:"col-3 col-form-label text-right font-weight-lighter"},Object(r.h)(b.c,{id:"races.firstname"},"Fornavn")),Object(r.h)("div",{class:"col-9"},Object(r.h)(b.b,null,Object(r.h)("input",{type:"text",class:"form-control",id:"firstname","data-classid":O.class,"data-contestantid":O.id,onInput:this.editSignup,value:O.firstname,placeholder:Object(r.h)(b.c,{id:"races.firstname-help"},"Hva er fornavnet ditt?")})))),Object(r.h)("div",{class:"form-group row my-2"},Object(r.h)("label",{for:"lastname",class:"col-3 col-form-label text-right font-weight-lighter"},Object(r.h)(b.c,{id:"races.lastname"},"Etternavn")),Object(r.h)("div",{class:"col-9"},Object(r.h)(b.b,null,Object(r.h)("input",{type:"text",class:"form-control",id:"lastname","data-classid":O.class,"data-contestantid":O.id,onInput:this.editSignup,value:O.lastname,placeholder:Object(r.h)(b.c,{id:"races.lastname-help"},"Hva er etternavnet ditt?")})))),Object(r.h)("div",{class:"form-group row my-2"},Object(r.h)("label",{for:"sportsClub",class:"col-3 col-form-label text-right font-weight-lighter"},Object(r.h)(b.c,{id:"races.sportsclub"},"Klubb")),Object(r.h)("div",{class:"col-9"},Object(r.h)(b.b,null,Object(r.h)("input",{type:"text",class:"form-control",id:"sportsClub","data-classid":O.class,"data-contestantid":O.id,onInput:this.editSignup,value:O.sportsClub,placeholder:Object(r.h)(b.c,{id:"races.sportsClub-help"},"Hvilken klubb tilhører du?")})))),Object(r.h)("div",{class:"form-group row my-2"},Object(r.h)("label",{for:"facebook",class:"col-3 col-form-label text-right font-weight-lighter"},Object(r.h)(b.c,{id:"races.facebook"},"Facebook")),Object(r.h)("div",{class:"col-9"},Object(r.h)(b.b,null,Object(r.h)("input",{type:"text",class:"form-control",id:"facebook","data-classid":O.class,"data-contestantid":O.id,onInput:this.editSignup,value:O.facebook,placeholder:Object(r.h)(b.c,{id:"races.facebook-help"},"Hva er Facebook brukernavnet ditt?")})))),Object(r.h)("div",{class:"form-group row my-2"},Object(r.h)("label",{for:"instagram",class:"col-3 col-form-label text-right font-weight-lighter"},Object(r.h)(b.c,{id:"races.instagram"},"Instagram")),Object(r.h)("div",{class:"col-9"},Object(r.h)(b.b,null,Object(r.h)("input",{type:"text",class:"form-control",id:"instagram","data-classid":O.class,"data-contestantid":O.id,onInput:this.editSignup,value:O.instagram,placeholder:Object(r.h)(b.c,{id:"races.instagram-help"},"Hva er Instagram brukernavnet ditt?")})))),Object(r.h)("div",{class:"form-group row my-2"},Object(r.h)("label",{for:"team",class:"col-3 col-form-label text-right font-weight-lighter"},Object(r.h)(b.c,{id:"races.class"},"Klasse")),Object(r.h)("div",{class:"col-9"},Object(r.h)("select",{class:"form-control",id:"class","aria-describedby":"classHelp","data-classid":O.class,"data-contestantid":O.id,onInput:this.editSignup,value:O.class,disabled:!0},Object(r.h)("option",{value:""},"-- ",Object(r.h)(b.c,{id:"races.choose-class"},"Velg klasse")," --"),m.classes&&m.classes.sort((t,e)=>t.distance-e.distance).map(e=>Object(r.h)(t,null,Object(r.h)("option",{value:e.id},e.title,!m.liveRace&&Object(r.h)(t,null,"- ",e.distance," km - Påmelding: ",e.signupfee||m.signupfee," NOK"))))))),m.rules&&Object(r.h)("div",{class:"form-group row my-2"},Object(r.h)("label",{for:"team",class:"col-3 col-form-label text-right font-weight-lighter"}," "),Object(r.h)("div",{class:"col-9 pl-5"},Object(r.h)("input",{type:"checkbox",class:"form-check-input",id:"termsAndAgreement","data-classid":O.class,"data-contestantid":O.id,onInput:this.editSignup,checked:O.termsAndAgreement,value:1}),Object(r.h)("label",{class:"form-check-label",for:"termsAndAgreement"},Object(r.h)(b.c,{id:"races.agreement-accept"},"Jeg har lest og godtar reglene for løpet.")))),m.declaration&&Object(r.h)("div",{class:"form-group row my-4"},Object(r.h)("div",{class:"col-12 text-center border-top"},Object(r.h)("h5",null,Object(r.h)(b.c,{id:"races.declaration"},"Declaration"))),Object(r.h)("details",{class:"col-12"},O.declaration?Object(r.h)(t,null,Object(r.h)("summary",null,Object(r.h)(b.c,{id:"races.see-declaration"},"See declaration")," (",Object(r.h)("span",{class:"text-muted font-weight-light"},Object(r.h)(b.c,{id:"races.declaration-signed"},"Declaration signed"),": ",d.a.isoDate(O.declarationDate)),")")):Object(r.h)(t,null,Object(r.h)("summary",null,Object(r.h)("h5",{class:"btn btn-primary"},Object(r.h)(b.c,{id:"races.see-declaration"},"See declaration")))),Object(r.h)(p.a,{markdown:u.a.replaceImages(m.declaration,m.images,h),markdownOpts:u.a.getMarkdownOptions()}),O.declaration?Object(r.h)(t,null,Object(r.h)("i",null,Object(r.h)(b.c,{id:"races.declaration-signed"},"Declaration signed"),": ",d.a.isoDate(O.declarationDate))):Object(r.h)(t,null,Object(r.h)("div",{class:"pl-5"},Object(r.h)("input",{type:"checkbox",class:"form-check-input",id:"declaration","data-classid":O.class,"data-contestantid":O.id,onInput:this.editSignup,checked:O.declaration,value:1}),Object(r.h)("label",{class:"form-check-label",for:"declaration"},Object(r.h)(b.c,{id:"races.declaration-accept"},"I hereby sign the declaration for the race!")))))),Object(r.h)(y,{saved:n,user:c,field:"image",icon:"fas fa-camera",type:"image",stores:this.props.stores,title:Object(r.h)(b.c,{id:"users.photos"},"Bilder"),help:Object(r.h)(b.c,{id:"users.photos-help"},"Bilder av deg."),onInput:this.updateField,updateField:this.updateFieldValue})),"chiplist"===e&&Object(r.h)(t,null,Object(r.h)("div",{class:"form-group row my-4"},Object(r.h)("div",{class:"col-12 text-center border-top pt-3"},Object(r.h)("h5",null,Object(r.h)(b.c,{id:"races.chiplist"},"Chiplist"))),g&&g.dogs&&u.a.getAlphabet(g.dogs,["R1","R2"]).map(e=>{const s=w&&w.length>0?w.find(t=>t.chipId===O["dog"+e]):null;return Object(r.h)(t,null,Object(r.h)("div",{class:"col-12 center border-top pt-3 d-flex"},Object(r.h)("div",{class:"display-4",style:"width: 50px;"},e),Object(r.h)("div",{class:"flex-grow-1 pl-3 pr-2"},s?Object(r.h)(t,null,Object(r.h)(v,{stores:this.props.stores,dog:s,onDogClick:this.onDogClick},Object(r.h)("button",{class:"btn btn-danger float-right ml-2",onClick:this.clearSignupValue,id:"dog"+e,"data-classid":O.class,"data-contestantid":O.id},Object(r.h)("i",{class:"fas fa-times"})))):Object(r.h)(t,null,Object(r.h)("select",{class:"form-control p-0",id:"dog"+e,"data-classid":O.class,"data-contestantid":O.id,onInput:this.editSignup},Object(r.h)("option",{value:""},"-- Choose dog for this position --"),w.filter(S).map(s=>Object(r.h)(t,null,Object(r.h)("option",{value:s.chipId,selected:s.chipId===O["dog"+e]?"selected":""},s.shortname||s.name," - ",s.birth&&Object(r.h)(t,null,d.a.age(s.birth,s.deceased))," ","female"===s.gender?"♀️":"♂️"))))))))}))),"team"===e&&Object(r.h)(t,null,Object(r.h)("div",{class:"form-group row my-4"},Object(r.h)("div",{class:"col-12 border-top pt-3"},w&&w.length>0?Object(r.h)(t,null,w.map(e=>Object(r.h)(t,null,Object(r.h)(v,{stores:this.props.stores,dog:e})))):Object(r.h)(t,null,Object(r.h)("div",{class:"text-center text-muted"},Object(r.h)("div",{class:"display-1"},Object(r.h)("i",{class:"fas fa-dog"})),Object(r.h)("h3",{class:"font-weight-lighter"},Object(r.h)(b.c,{id:"race.add-dogs"},"Add a team to your race signup to see the dogs.")))))))):Object(r.h)(t,null,m.liveRace?Object(r.h)(t,null,"Signup is done at the race normal web pages."):Object(r.h)(t,null,Object(r.h)("div",{class:"form-group"},Object(r.h)("label",{for:"cellphone"},Object(r.h)(b.c,{id:"races.cellphone"},"Mobil")),Object(r.h)("input",{type:"text",class:"form-control",id:"cellphone","aria-describedby":"cellphoneHelp",placeholder:c.cellphone,onInput:this.updateSignup,value:O.cellphone}),Object(r.h)("small",{id:"cellphoneHelp",class:"form-text text-muted"},Object(r.h)(b.c,{id:"races.cellphone-help"},"'Hva er mobilnummer ditt?'"))),O.name&&Object(r.h)("div",{class:"row"},Object(r.h)("div",{class:"col"},Object(r.h)("div",{class:"form-group"},Object(r.h)("label",{for:"name"},Object(r.h)(b.c,{id:"races.name"},"Name")),Object(r.h)("input",{type:"text",class:"form-control",id:"name","aria-describedby":"nameHelp",placeholder:c.name,onInput:this.updateSignup,value:O.name}),Object(r.h)("small",{id:"nameHelp",class:"form-text text-muted"},Object(r.h)(b.c,{id:"races.name-help"},"Hva er navnet ditt?"))))),Object(r.h)("div",{class:"row"},Object(r.h)("div",{class:"col"},Object(r.h)("div",{class:"form-group"},Object(r.h)("label",{for:"firstname"},Object(r.h)(b.c,{id:"races.firstname"},"Fornavn")),Object(r.h)("input",{type:"text",class:"form-control",id:"firstname","aria-describedby":"firstnameHelp",placeholder:c.firstname,onInput:this.updateSignup,value:O.firstname}),Object(r.h)("small",{id:"firstnameHelp",class:"form-text text-muted"},Object(r.h)(b.c,{id:"races.firstname-help"},"Hva er fornavnet ditt?")))),Object(r.h)("div",{class:"col"},Object(r.h)("div",{class:"form-group"},Object(r.h)("label",{for:"lastname"},Object(r.h)(b.c,{id:"races.lastname"},"Etternavn")),Object(r.h)("input",{type:"text",class:"form-control",id:"lastname","aria-describedby":"lastnameHelp",placeholder:c.lastname,onInput:this.updateSignup,value:O.lastname}),Object(r.h)("small",{id:"lastnameHelp",class:"form-text text-muted"},Object(r.h)(b.c,{id:"races.lastname-help"},"Hva er etternavnet ditt?"))))),Object(r.h)("div",{class:"form-group"},Object(r.h)("label",{for:"sportsClub"},Object(r.h)(b.c,{id:"races.sportsclub"},"Klubb")),Object(r.h)("input",{type:"text",class:"form-control",id:"sportsClub","aria-describedby":"sportsClubHelp",placeholder:c.sportsClub,onInput:this.updateSignup,value:O.sportsClub}),Object(r.h)("small",{id:"sportsClubHelp",class:"form-text text-muted"},Object(r.h)(b.c,{id:"races.sportsClub-help"},"Hvilken klubb tilhører du?"))),Object(r.h)("div",{class:"row"},Object(r.h)("div",{class:"col"},Object(r.h)("div",{class:"form-group"},Object(r.h)("label",{for:"facebook"},Object(r.h)(b.c,{id:"races.facebook"},"Facebook")),Object(r.h)("input",{type:"text",class:"form-control",id:"facebook","aria-describedby":"facebookHelp",placeholder:c.facebook,onInput:this.updateSignup,value:O.facebook}),Object(r.h)("small",{id:"facebookHelp",class:"form-text text-muted"},Object(r.h)(b.c,{id:"races.facebook-help"},"Hva er Facebook brukernavnet ditt?")))),Object(r.h)("div",{class:"col"},Object(r.h)("div",{class:"form-group"},Object(r.h)("label",{for:"instagram"},Object(r.h)(b.c,{id:"races.instagram"},"Instagram")),Object(r.h)("input",{type:"text",class:"form-control",id:"instagram","aria-describedby":"instagramHelp",placeholder:c.instagram,onInput:this.updateSignup,value:O.instagram}),Object(r.h)("small",{id:"instagramHelp",class:"form-text text-muted"},Object(r.h)(b.c,{id:"races.instagram-help"},"Hva er Instagram brukernavnet ditt?"))))),Object(r.h)("div",{class:"form-group"},Object(r.h)("label",{for:"team"},Object(r.h)(b.c,{id:"races.team"},"Team")),Object(r.h)("select",{class:"form-control",id:"team","aria-describedby":"teamHelp",onInput:this.updateSignup,value:O.team},Object(r.h)("option",{value:""},"-- ",Object(r.h)(b.c,{id:"races.choose-team"},"Velg team")," --"),o.map(t=>Object(r.h)("option",{value:t.id},t.name))),Object(r.h)("small",{id:"teamHelp",class:"form-text text-muted"},Object(r.h)(b.c,{id:"races.choose-team-help"},"Velg fra dine team"))),Object(r.h)("div",{class:"form-group"},Object(r.h)("label",{for:"class"},Object(r.h)(b.c,{id:"races.class"},"Klasse")),Object(r.h)("select",{class:"form-control",id:"class","aria-describedby":"classHelp",onInput:this.updateSignup,value:O.class},Object(r.h)("option",{value:""},"-- ",Object(r.h)(b.c,{id:"races.choose-class"},"Velg klasse")," --"),m.classes&&m.classes.map(e=>Object(r.h)(t,null,Object(r.h)("option",{value:e.id},e.title," - ",e.distance," km - Påmelding: ",e.signupfee||m.signupfee," NOK")))),Object(r.h)("small",{id:"classHelp",class:"form-text text-muted"},Object(r.h)(b.c,{id:"races.choose-class-help"},"Velg ønsket klasse."))),Object(r.h)("div",{class:"form-group form-check"},Object(r.h)("input",{type:"checkbox",class:"form-check-input",id:"termsAndAgreement",onInput:this.updateSignup,checked:O.termsAndAgreement,value:!0}),Object(r.h)("label",{class:"form-check-label",for:"termsAndAgreement"},Object(r.h)(b.c,{id:"races.agreement-accept"},"Jeg har lest og godtar reglene for løpet."))),Object(r.h)("button",{type:"button",class:"btn btn-primary",onClick:this.signupToRace},Object(r.h)(b.c,{id:"races.do-signup"},"Meld meg på"))))):Object(r.h)(t,null,x<new Date(m.signupStartDate)?Object(r.h)(t,null,Object(r.h)("h5",{class:"mt-4"},Object(r.h)("i",{class:"fas fa-exclamation-circle"})," ",Object(r.h)(b.c,{id:"races.signup-not-open-yet"},"Påmeldingen har ikke åpnet ennå!")),Object(r.h)("p",{class:"mt-4"},Object(r.h)(b.c,{id:"races.signup-opening"},"Påmeldingen åpner"),":",Object(r.h)("br",null),Object(r.h)("span",{class:"display-4"},d.a.formatDate(m.signupStartDate,{locale:"no-NB",hour12:!1,hour:"2-digit",minute:"2-digit"})))):Object(r.h)(t,null,Object(r.h)("h5",{class:"mt-4 mb-4"},Object(r.h)("i",{class:"fas fa-exclamation-circle"})," ",Object(r.h)(b.c,{id:"races.signup-closed"},"Påmeldingen er stengt!")))))),s&&Object(r.h)(t,null,Object(r.h)(j.a,{stores:this.props.stores,onCloseClick:this.toggleDrawer},Object(r.h)(f.a,{stores:this.props.stores,id:a.id}))))}})||n;e.a=w}).call(this,s("hosL").Fragment)},n7ns:function(t,e,s){"use strict";(function(t){function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function i(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){l(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function l(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function c(t,e){const s=void 0!==t.bib;return(void 0!==e.bib)-s||!0===s&&t.bib-e.bib||0}var o,n=s("hosL"),r=s("Utv1"),d=s("/eY4"),h=s("OhSV"),b=(s("Y3FI"),s("fh8t")),m=s.n(b),p=s("go65"),u=s("ZOvn"),O=s("/DnB");s("s4FZ");let g=Object(d.a)(o=class extends n.Component{constructor(t){var e;super(t),e=this,this.toggleDisplayDetails=t=>{const e=t.target.closest("tr").dataset.id,{appState:s}=this.props.stores,{editUserDetails:a}=s;a[e]||s.toggleDisplayDetails(e)},this.adminToggleEditUser=async function(t){t.stopPropagation();const s=t.target.closest("tr").dataset.id,{appState:a,raceStore:i,adminStore:l}=e.props.stores,{editUserDetails:c}=a;if(!c[s]){const t=i.getMusherById(s);await l.getUserByEmail(t.email)}a.toggleEditUserDetails(s)},this.veterinaryToggleEditUser=t=>{t.stopPropagation();const e=t.target.closest("tr").dataset.id,{appState:s}=this.props.stores;s.toggleVeterinaryUserDetails(e,!0)},this.toggleAdminSendMessage=t=>{const e=t.target.closest("button").dataset.class,{showAdminSendMessage:s}=this.state;s[e]=!s[e],this.setState({showAdminSendMessage:s})},this.toggleAdminSendInboxMessage=t=>{const e=t.target.closest("button").dataset.class,{showAdminSendInboxMessage:s={}}=this.state;s[e]=!s[e],this.setState({showAdminSendInboxMessage:s})},this.toggleAdminImport=t=>{const e=t.target.closest("button").dataset.class,{showAdminImport:s}=this.state;s[e]=!s[e],this.setState({showAdminImport:s})},this.adminSignupEdit=t=>{const{race:e={}}=this.props,s=e.id,{raceStore:a}=this.props.stores,i=t.target.id,l=t.target.value,{classid:c,contestantid:o}=t.target.dataset,n={raceClassId:c,contestantId:o,["raceClassContestant"+r.a.ucfirst(i)]:l};clearTimeout(this.updateTimer[i]),this.updateTimer[i]=setTimeout((async function(){a.editClass({id:s,data:n})}),500)},this.adminSignupSetValue=t=>{const{race:e={}}=this.props,s=e.id,{raceStore:a}=this.props.stores,{field:i,value:l,classid:c,contestantid:o}=t.target.dataset,n={raceClassId:c,contestantId:o,["raceClassContestant"+r.a.ucfirst(i)]:l};clearTimeout(this.updateTimer[i]),this.updateTimer[i]=setTimeout((async function(){a.editClass({id:s,data:n})}),5)},this.sendEmail=async function(t){const{race:s={}}=e.props,a=s.id,i=t.target.closest("button").dataset.to,l=t.target.closest("button").dataset.raceclassid,{appState:c}=e.props.stores,{message:o}=e.state,{subject:n,body:r}=o,d=await c.sendEmail({to:i,subject:n,body:r,raceId:a,raceClassId:l});e.setState({emailResponse:d})},this.resetEmail=()=>{this.setState({emailResponse:null,message:{subject:"",body:""}})},this.sendInboxMessage=async function(t){const{raceStore:s}=e.props.stores,{race:a={}}=e.props,i=a.id,l=t.target.closest("button").dataset.raceclassid,{inboxMessage:c}=e.state,{body:o}=c,n=await s.sendInboxMessage({body:o,raceId:i,raceClassId:l});e.setState({inboxMessageResponse:n})},this.resetInboxMessage=()=>{this.setState({inboxMessage:{body:""}})},this.signupToRace=async function({signup:t}){const{raceStore:s}=e.props.stores,{race:a={}}=e.props,l=a.id;await s.addContestant({id:l,classId:t.class,newContestant:i({},t)})},this.parseInput=async function(t,s){clearTimeout(e.parseInputTimer),e.parseInputTimer=setTimeout(()=>e.doParseInput(t,s),500)},this.doParseInput=async function(t,s){const a=String(t).split("\n");let i=[];const l=[],c=a[0];i=c.match(/\t/)?c.split("\t"):c.match(/;/)?c.split(";"):c.split(",");for(let t=1,e=a.length;t<e;t+=1){const e=a[t];let s;s=e.match(/\t/)?e.split("\t"):e.match(/;/)?e.split(";"):e.split(",");const c={};s.forEach((t,e)=>{let s=t;"email"===i[e]&&(s=t.toLowerCase()),c[i[e]]=s}),l.push(c)}const{raceStore:o}=e.props.stores,{race:n={}}=e.props;return o.addMultipleContestants({id:n.id,classId:s,contestants:l}),!0},this.chooseSubmenu=t=>{t.stopPropagation();this.setState({submenu:t.target.parentElement.dataset.menu||t.target.dataset.menu})},this.filterByClass=t=>{const e=t.target.closest("button").dataset.id,{appState:s}=this.props.stores;s.toggleSelectedClassId(e,!0)},this.clearSearchForBib=()=>{this.setState({searchForBib:""})},this.savePreCheck=async function(t){const{id:s,chipid:a,name:l,shortname:c,team:o}=t.target.closest("button").dataset,{preCheck:n,dogJournals:d}=e.state,{dogJournalStore:h,userStore:b}=e.props.stores,{user:m={}}=b,p={id:m.id,firstname:m.firstname,lastname:m.lastname,email:m.email,image:m.image},u={id:s,chipId:a,name:l,shortname:c,team:o},O=i({checkType:"preCheck"},r.a.getNestedValue(n,s)||{}),g=[{dog:i({},u),journal:i({},O),veterinary:i({},p)}];d[a]||(d[a]=[]),d[a].push(i(i(i({date:new Date},u),O),p)),await h.insert({data:g}),delete n[s],e.setState({preCheck:n})},this.state={displayDetails:{},editUserDetails:{},showAdminSendMessage:{},showAdminImport:{},message:{},inboxMessage:{},submenu:"chiplists",preCheck:{},raceCheck:{},dogJournals:{}},this.inputRef={},this.updateTimer={},this.parseInputTimer=null}render(){const{showAdminSendMessage:e={},showAdminSendInboxMessage:s={},showAdminImport:a={},message:i={},inboxMessage:l={},inboxMessageResponse:o,emailResponse:d,submenu:b,searchForBib:g,preCheck:j={},raceCheck:f={},dogJournals:y={}}=this.state,{userStore:v,raceStore:w,appState:x,adminStore:k}=this.props.stores,{user:S={},teams:C=[],isAdmin:I,isVeterinary:D}=v,{language:T="en"}=S,{displayDetails:R,editUserDetails:P,veterinaryUserDetails:E,selectedClassIds:F=[]}=x,{race:L={}}=this.props,M=t=>{if(g){const e=new RegExp(""+g.replace(/[^a-zA-Z 0-9æøåÆØÅ]/,""),"i");return e.test(t.bib)||e.test(t.firstname)||e.test(t.lastname)}return!0},{user:A={},teams:$}=k;return Object(n.h)(t,null,Object(n.h)("div",{class:"row"},Object(n.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2"},Object(n.h)("h2",{class:"mb-0"},Object(n.h)(h.c,{id:"races.mushers"},"Deltakere"))),Object(n.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2"},Object(n.h)("div",{class:"w-100 overflow-hidden"},Object(n.h)("div",{class:"d-flex flex-row flex-nowrap pb-2 px-1",style:"overflow: auto; scroll-snap-type: x mandatory;"},L.classes&&L.classes.sort((t,e)=>t.distance-e.distance).map((e,s)=>Object(n.h)(t,null,Object(n.h)("div",{class:"col px-0 pt-2"},Object(n.h)("button",{type:"button",class:`btn btn-block ${0===s&&"rounded-pill-left"} ${s===L.classes.length-1&&"rounded-pill-right"} rounded-none ${F.indexOf(e.id)>-1?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;",onClick:this.filterByClass,"data-id":e.id},e.title)))))),Object(n.h)("div",{class:"row mb-3"},Object(n.h)("div",{class:"col-6 offset-3"},Object(n.h)("div",{class:"input-group"},Object(n.h)("input",{class:"form-control form-control-lg",type:"text",placeholder:"Search for bib",value:g,onInput:Object(p.a)(this,"searchForBib")}),g&&Object(n.h)("div",{class:"input-group-append"},Object(n.h)("div",{class:"input-group-text",onClick:this.clearSearchForBib},"x"))))),L.classes&&L.classes.filter(t=>!(F.length>0)||F.indexOf(t.id)>-1).sort((t,e)=>t.distance-e.distance).map(g=>Object(n.h)(t,null,I&&Object(n.h)("span",{class:"float-right"},"Total app users: ",g.contestants&&g.contestants.filter(t=>t.user||t.team).length),Object(n.h)("h5",null,g.title," ",g.startDate&&Object(n.h)(t,null,": ",Object(n.h)("span",{class:"font-weight-lighter"},r.a.formatDate(g.startDate,{locale:T,hour12:!1,hour:"2-digit",minute:"2-digit"})," - ",r.a.formatDate(g.endDate,{locale:T,hour12:!1,hour:"2-digit",minute:"2-digit"})))),I&&Object(n.h)(t,null,Object(n.h)("a",{class:"mx-2",href:`/tv/top10/${L.id}/${g.id}`},"TV Top 10")," -",Object(n.h)("a",{class:"mx-2",href:`/tv/top5/${L.id}/${g.id}`},"TV Top 5")," -",Object(n.h)("a",{class:"mx-2",href:`/tv/top3/${L.id}/${g.id}`},"TV Top 3")," -",Object(n.h)("a",{class:"mx-2",href:`/tv/top10progress/${L.id}/${g.id}`},"TV Top Progress 10")," -",Object(n.h)("a",{class:"mx-2",href:`/tv/top5progress/${L.id}/${g.id}`},"TV Top Progress 5")," -",Object(n.h)("a",{class:"mx-2",href:`/tv/top3progress/${L.id}/${g.id}`},"TV Top Progress 3")," -",Object(n.h)("a",{class:"mx-2",href:`/tv/team/${L.id}/1`},"TV One team")," -",Object(n.h)("a",{class:"mx-2",href:`/tv/tracking/${L.id}/${g.id}`},"TV tracking")," -",Object(n.h)("a",{class:"mx-2",href:"/tv/freetext"},"TV free text")," -",Object(n.h)("a",{class:"mx-2",href:`/embed/top10/${L.id}/${g.id}`},"Embed top10")," -",Object(n.h)("a",{class:"mx-2",href:`/embed/tracking/${L.id}/${g.id}`},"Embed tracking")," -",Object(n.h)("a",{class:"mx-2",href:`/embed/chiplist/${L.id}/${g.id}`},"Embed chiplist")," -",Object(n.h)("a",{class:"mx-2",href:`/embed/agreement/${L.id}/${g.id}`},"Embed agreement")," -"),Object(n.h)("div",{class:"table-responsive"},Object(n.h)("table",{class:"table table-sm table-striped"},Object(n.h)("thead",null,Object(n.h)("tr",null,Object(n.h)("th",{scope:"col"},"#"),Object(n.h)("th",{scope:"col",style:"min-width: 90%;"},Object(n.h)(h.c,{id:"races.name"},"Navn")))),Object(n.h)("tbody",null,g.contestants&&g.contestants.filter(M).sort(c).map((e,s)=>{const a=w.getTeamById(e.team),i=w.hasVaccines(a),l=e.mandatoryCheck;return Object(n.h)(t,null,Object(n.h)("tr",{onClick:this.toggleDisplayDetails,"data-id":e.id},Object(n.h)("th",{scope:"row"},e.bib?Object(n.h)(t,null,e.bib):Object(n.h)(t,null,Object(n.h)("span",{class:"font-weight-lighter text-muted"},s+1))),Object(n.h)("td",{class:""+(R[e.id]?"font-weight-bold":""),style:""+(R[e.id]||E[e.id]?"":"line-height: 0.8em;")},D&&Object(n.h)(t,null,e.team?Object(n.h)(t,null,Object(n.h)("button",{class:"btn btn-primary btn-sm float-right ml-4",onClick:this.veterinaryToggleEditUser},Object(n.h)("i",{class:"fas fa-user-md"}))):Object(n.h)(t,null,Object(n.h)("button",{class:"btn btn-outline-secondary btn-sm float-right ml-4 disabled",onClick:t=>t.stopPropagation()},Object(n.h)("i",{class:"fas fa-user-md"}))),i?Object(n.h)(t,null,Object(n.h)("button",{class:"btn btn-success btn-sm float-right ml-1",onClick:t=>t.stopPropagation()},Object(n.h)("i",{class:"fas fa-syringe"}))):Object(n.h)(t,null,Object(n.h)("button",{class:"btn btn-outline-secondary btn-sm float-right ml-1",onClick:t=>t.stopPropagation()},Object(n.h)("i",{class:"fas fa-syringe"}))),l?Object(n.h)(t,null,Object(n.h)("button",{class:"btn btn-success btn-sm float-right ml-1",onClick:t=>t.stopPropagation()},Object(n.h)("i",{class:"fas fa-stethoscope"}))):Object(n.h)(t,null,Object(n.h)("button",{class:"btn btn-outline-secondary btn-sm float-right ml-1",onClick:t=>t.stopPropagation()},Object(n.h)("i",{class:"fas fa-stethoscope"})))),I&&Object(n.h)(t,null,Object(n.h)("button",{class:"btn btn-outline-warning btn-sm float-right ml-1",onClick:this.adminToggleEditUser},Object(n.h)("i",{class:"fas fa-user-edit"})),e.paidSignupfee&&Object(n.h)(t,null,Object(n.h)("span",{class:"float-right"},Object(n.h)("i",{class:"fas fa-check text-success"}),Object(n.h)("br",null))),Object(n.h)("small",{class:"float-right"},e.raceStatus&&Object(n.h)(t,null,Object(n.h)("span",{class:"text-muted"},"raceStatus:"),Object(n.h)("br",null)," ",e.raceStatus,Object(n.h)("br",null)),e.raceComment&&Object(n.h)(t,null,Object(n.h)("span",{class:"text-muted"},"raceComment:"),Object(n.h)("br",null)," ",e.raceComment,Object(n.h)("br",null)),e.gpxResultsApproved&&Object(n.h)(t,null,Object(n.h)("span",{class:"text-muted"},"gpxResultsApproved:"),Object(n.h)("br",null)," ",e.gpxResultsApproved,Object(n.h)("br",null)))),(I||D)&&L.liveRace>0&&L.declaration&&Object(n.h)(t,null,Object(n.h)("span",{class:"float-right text-success mr-2",style:"font-size: 1.2em;"},(e.user||e.team)&&Object(n.h)("i",{class:"fas fa-mobile-alt ml-2"}),e.declaration&&Object(n.h)("i",{class:"fas fa-handshake ml-2",alt:r.a.isoDate(e.declarationDate)}))),R[e.id]?Object(n.h)(t,null,e.flag&&Object(n.h)("span",{class:"mr-2"},e.flag),e.firstname?Object(n.h)(t,null,e.firstname," ",e.lastname,Object(n.h)("br",null)):Object(n.h)(t,null,e.name),Object(n.h)("span",{class:"text-muted"},a.name),Object(n.h)("br",null),Object(n.h)("small",{class:"text-muted"},e.sportsClub),Object(n.h)("br",null),e.facebook&&Object(n.h)("a",{class:"mr-2",href:u.a.asFacebookLink(e.facebook),native:!0,target:"_blank",rel:"noreferrer"},Object(n.h)("i",{class:"fab fa-facebook"})),e.instagram&&Object(n.h)("a",{class:"mr-2",href:u.a.asInstagramLink(e.instagram),native:!0,target:"_blank",rel:"noreferrer"},Object(n.h)("i",{class:"fab fa-instagram"})),Object(n.h)("br",null),I&&Object(n.h)(t,null,e.bib&&Object(n.h)(t,null,Object(n.h)("i",{class:"fas fa-tshirt ml-2"})," ",e.bib),e.startTime&&Object(n.h)(t,null,Object(n.h)("i",{class:"fas fa-clock ml-2"})," ",r.a.isoDate(e.startTime))),e.price1&&Object(n.h)("div",{class:"font-weight-lighter"},Object(n.h)("i",{class:"fas fa-trophy text-warning"})," ",e.price1,e.priceSent&&Object(n.h)(t,null,Object(n.h)("i",{class:"fas fa-check text-success"}))),e.price2&&Object(n.h)("div",{class:"font-weight-lighter"},Object(n.h)("i",{class:"fas fa-trophy text-warning"})," ",e.price2),e.price3&&Object(n.h)("div",{class:"font-weight-lighter"},Object(n.h)("i",{class:"fas fa-trophy text-warning"})," ",e.price3)):Object(n.h)(t,null,e.price1&&Object(n.h)("span",{class:"float-right text-warning",style:"font-size: 1.2em;"},Object(n.h)("i",{class:"fas fa-trophy"}),e.priceSent&&Object(n.h)(t,null,Object(n.h)("i",{class:"fas fa-check text-success"}))),Object(n.h)("nobr",null,e.flag&&Object(n.h)("span",{class:"mr-2"},e.flag),e.firstname?Object(n.h)(t,null,e.firstname," ",e.lastname,Object(n.h)("br",null)):Object(n.h)(t,null,e.name),Object(n.h)("small",{class:"text-muted"},e.sportsClub),Object(n.h)("br",null))),D&&E[e.id]&&Object(n.h)(t,null,Object(n.h)(O.a,{horizontal:"end",vertical:"center"}),Object(n.h)("div",{class:"w-100 overflow-hidden",style:"max-width: 100%;"},Object(n.h)("div",{class:"d-flex flex-row flex-nowrap pb-2 px-1",style:"overflow: auto; scroll-snap-type: x mandatory;"},Object(n.h)("div",{class:"col px-0 pt-2"},Object(n.h)("button",{class:`btn btn-sm btn-block rounded-pill-left rounded-none ${"chiplists"===b?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"chiplists",onClick:this.chooseSubmenu},Object(n.h)("i",{class:"fas fa-user-md"})," ",Object(n.h)(h.c,{id:"racevet.chiplists"},"Vaccines"))),Object(n.h)("div",{class:"col px-0 pt-2"},Object(n.h)("button",{class:`btn btn-sm btn-block rounded-none ${"precheck"===b?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"precheck",onClick:this.chooseSubmenu},Object(n.h)("i",{class:"fas fa-stethoscope"})," ",Object(n.h)(h.c,{id:"racevet.precheck"},"PreCheck"))),Object(n.h)("div",{class:"col px-0 pt-2"},Object(n.h)("button",{class:`btn btn-sm btn-block rounded-pill-right rounded-none ${"racecheck"===b?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"racecheck",onClick:this.chooseSubmenu},Object(n.h)("i",{class:"fas fa-flag-checkered"})," ",Object(n.h)(h.c,{id:"racevet.racecheck"},"RaceCheck"))))),"chiplists"===b&&Object(n.h)(t,null,Object(n.h)("h5",{class:"mt-4 border-bottom"},"Chiplist & Vaccines"),Object(n.h)("div",{class:"container-fluid"},Object(n.h)("div",{class:"row"},a&&a.dogs?a.dogs.map(e=>{let s;return a&&a.vaccines&&(s=a.vaccines.filter(t=>t.chipId===e.chipId)),Object(n.h)(t,null,Object(n.h)("div",{class:"col-12 d-flex my-3"},Object(n.h)("div",{class:"mx-0 mr-1 px-0 position-relative pt-1"},Object(n.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedMedium text-muted pt-2",style:(e.image?`background-image: url("${e.image.s3SmallLink}"); background-size: cover;`:"")+" border-width: 2px !important;"},!e.image&&Object(n.h)("span",{class:"font-weight-lighter",style:"font-size: 35px;"},r.a.ucfirst(e.name,!0))),Object(n.h)("small",null,Object(n.h)("span",{class:"float-left text-overflow",style:"width: 70px;"},e.name),Object(n.h)("br",null)),(e.birth||e.gender)&&Object(n.h)("small",null,Object(n.h)("small",{class:"font-weight-normal float-right position-absolute text-white bg-info p-1 rounded",style:"top: 0px; right: 0px; line-height: 0.8em;"},e.birth&&Object(n.h)("span",{class:"mr-1 text-white"},r.a.age(e.birth,e.deceased)),e.gender&&Object(n.h)(t,null,"female"===e.gender?Object(n.h)("i",{class:"fas fa-venus"}):Object(n.h)("i",{class:"fas fa-mars"}))))),Object(n.h)("div",{class:"flex-grow-1 row"},Object(n.h)("div",{class:"col-12 font-weight-bold"},Object(n.h)("i",{class:"fas fa-microchip text-muted"})," ",e.chipId),s&&s.map(e=>Object(n.h)("div",{class:"col-4 px-1 overflow-hidden"},Object(n.h)("span",{class:"badge badge-"+(e.inKarens?"warning":"success")},Object(n.h)("span",{class:"font-weight-lighter"},Object(n.h)("i",{class:"fas fa-calendar-check"})," ",r.a.isoDate(e.vaccineAgens.durationEnd,!1,!1,!0),e.inKarens&&Object(n.h)(t,null,Object(n.h)("br",null),"(",Object(n.h)(h.c,{id:"dogs.vaccine-karens"},"karens"),": ",r.a.format(e.karensDaysLeft,0)," ",Object(n.h)(h.c,{id:"dogs.vaccine-karens-days-left"},"days left"),")"))),Object(n.h)("div",{class:"text-overflow"},Object(n.h)("small",{class:"font-weight-light"},e.vaccineAgens.name,Object(n.h)("br",null),Object(n.h)("nobr",null,e.vaccineName),Object(n.h)("br",null))))))))}):Object(n.h)(t,null,Object(n.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 px-0"},Object(n.h)("div",{class:"text-center text-muted"},Object(n.h)("div",{class:"display-1"},Object(n.h)("i",{class:"fas fa-dog"})),Object(n.h)("h3",null,Object(n.h)(h.c,{id:"teams.no-dogs-title"},"No dogs for this team!")))))))),"precheck"===b&&Object(n.h)(t,null,Object(n.h)("h5",{class:"mt-4 border-bottom"},"Precheck"),Object(n.h)("div",{class:"row"},a&&a.dogs?a.dogs.map(e=>{let s;return a&&a.journal&&(s=a.journal.filter(t=>t.chipId===e.chipId)),Object(n.h)(t,null,Object(n.h)("div",{class:"col-12 d-flex my-3"},Object(n.h)("div",{class:"mx-0 mr-1 px-0 position-relative pt-1"},Object(n.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedMedium text-muted pt-2",style:(e.image?`background-image: url("${e.image.s3SmallLink}"); background-size: cover;`:"")+" border-width: 2px !important;"},!e.image&&Object(n.h)("span",{class:"font-weight-lighter",style:"font-size: 35px;"},r.a.ucfirst(e.name,!0))),Object(n.h)("small",null,Object(n.h)("span",{class:"float-left text-overflow",style:"width: 70px;"},e.name),Object(n.h)("br",null)),(e.birth||e.gender)&&Object(n.h)("small",null,Object(n.h)("small",{class:"font-weight-normal float-right position-absolute text-white bg-info p-1 rounded",style:"top: 0px; right: 0px; line-height: 0.8em;"},e.birth&&Object(n.h)("span",{class:"mr-1 text-white"},r.a.age(e.birth,e.deceased)),e.gender&&Object(n.h)(t,null,"female"===e.gender?Object(n.h)("i",{class:"fas fa-venus"}):Object(n.h)("i",{class:"fas fa-mars"}))))),Object(n.h)("div",{class:"flex-grow-1 row"},Object(n.h)("div",{class:"col-12 font-weight-bold"},Object(n.h)("i",{class:"fas fa-microchip text-muted"})," ",e.chipId.slice(-5)),Object(n.h)("div",{class:"col-12"},s&&s.length>0&&s.map(e=>Object(n.h)(t,null,Object(n.h)("div",{class:"row border-bottom"},Object(n.h)("div",{class:"col-12 text-muted"},Object(n.h)("small",null,Object(n.h)("span",{class:"float-right"},e.checkType&&Object(n.h)(t,null,e.checkType)),r.a.isoDate(e.date)," by ",e.veterinaryFirstname," ",e.veterinaryLastname)),Object(n.h)("div",{class:"col-12 d-flex justify-content-between"},e.diagnoseId>0&&Object(n.h)("span",{class:"mx-1"},Object(n.h)("span",{class:"text-muted"},"ID:")," ",e.diagnoseId),e.heartRate>0&&Object(n.h)("span",{class:"mx-1"},Object(n.h)("span",{class:"text-muted"},"HR:")," ",e.heartRate),e.weight>0&&Object(n.h)("span",{class:"mx-1"},Object(n.h)("i",{class:"fas fa-balance-scale text-muted"})," ",e.weight," ",Object(n.h)("span",{class:"text-muted"},"kg")),e.bodyConditionScore>0&&Object(n.h)("span",{class:"mx-1"},Object(n.h)("span",{class:"text-muted"},"BCS:")," ",e.bodyConditionScore)),Object(n.h)("div",{class:"col-12"},e.generalFindings&&Object(n.h)("span",{class:"mr-1"},Object(n.h)("span",{class:"text-muted"},"Other:")," ",e.generalFindings))))),y[e.chipId]&&y[e.chipId].length>0&&y[e.chipId].map(e=>Object(n.h)(t,null,Object(n.h)("div",{class:"row border-bottom"},Object(n.h)("div",{class:"col-12 text-muted"},Object(n.h)("small",null,Object(n.h)("span",{class:"float-right"},e.checkType&&Object(n.h)(t,null,e.checkType)),r.a.isoDate(e.date)," by ",e.veterinaryFirstname," ",e.veterinaryLastname)),Object(n.h)("div",{class:"col-12 d-flex justify-content-between"},e.diagnoseId>0&&Object(n.h)("span",{class:"mx-1"},Object(n.h)("span",{class:"text-muted"},"ID:")," ",e.diagnoseId),e.heartRate>0&&Object(n.h)("span",{class:"mx-1"},Object(n.h)("span",{class:"text-muted"},"HR:")," ",e.heartRate),e.weight>0&&Object(n.h)("span",{class:"mx-1"},Object(n.h)("i",{class:"fas fa-balance-scale text-muted"})," ",e.weight," ",Object(n.h)("span",{class:"text-muted"},"kg")),e.bodyConditionScore>0&&Object(n.h)("span",{class:"mx-1"},Object(n.h)("span",{class:"text-muted"},"BCS:")," ",e.bodyConditionScore)),Object(n.h)("div",{class:"col-12"},e.generalFindings&&Object(n.h)("span",{class:"mr-1"},Object(n.h)("span",{class:"text-muted"},"Other:")," ",e.generalFindings)))))),Object(n.h)("div",{class:"col-12 form-group"},Object(n.h)("small",null,Object(n.h)("label",{class:"text-overflow w-100 mb-0",for:"diagnoseId"},"Diagnostic"),Object(n.h)("select",{class:"form-control",id:"diagnoseId",onInput:Object(p.a)(this,`preCheck.${e.id}.diagnoseId`),value:r.a.getNestedValue(j,e.id+".diagnoseId")},Object(n.h)("option",{value:""},"-- Please choose --"),Object(n.h)("option",{value:"100"},"No findings")))),Object(n.h)("div",{class:"col-4 form-group"},Object(n.h)("small",null,Object(n.h)("label",{class:"text-overflow w-100 mb-0",for:"weight"},"Weight"),Object(n.h)("input",{type:"number",class:"form-control",id:"weight",onInput:Object(p.a)(this,`preCheck.${e.id}.weight`),value:r.a.getNestedValue(j,e.id+".weight")}))),Object(n.h)("div",{class:"col-4 form-group overflow-hidden"},Object(n.h)("small",null,Object(n.h)("label",{class:"text-overflow w-100 mb-0",for:"heartRate"},"Heart Rate"),Object(n.h)("input",{type:"text",class:"form-control",id:"heartRate",onInput:Object(p.a)(this,`preCheck.${e.id}.heartRate`),value:r.a.getNestedValue(j,e.id+".heartRate")}))),Object(n.h)("div",{class:"col-4 form-group"},Object(n.h)("small",null,Object(n.h)("label",{class:"text-overflow w-100 mb-0",for:"bodyConditionScore"},"BCS"),Object(n.h)("input",{type:"number",class:"form-control",id:"bodyConditionScore",onInput:Object(p.a)(this,`preCheck.${e.id}.bodyConditionScore`),value:r.a.getNestedValue(j,e.id+".bodyConditionScore")}))),Object(n.h)("div",{class:"col-12 form-group"},Object(n.h)("small",null,Object(n.h)("label",{class:"text-overflow w-100 mb-0",for:"generalFindings"},"General findings"),Object(n.h)("input",{type:"text",class:"form-control",id:"generalFindings",onInput:Object(p.a)(this,`preCheck.${e.id}.generalFindings`),value:r.a.getNestedValue(j,e.id+".generalFindings")})),Object(n.h)("small",{id:"generalFindingsHelp",class:"form-text text-muted"},"Teeth, mucus membranes, general condition, other findings.")),Object(n.h)("div",{class:"col-12 form-group"},Object(n.h)("button",{class:"btn btn-outline-success",onClick:this.savePreCheck,"data-id":e.id,"data-chipid":e.chipId,"data-team":a.id,"data-name":e.name,"data-shortname":e.shortName}," Save Pre Check")))))}):Object(n.h)(t,null,Object(n.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 px-0"},Object(n.h)("div",{class:"text-center text-muted"},Object(n.h)("div",{class:"display-1"},Object(n.h)("i",{class:"fas fa-dog"})),Object(n.h)("h3",null,Object(n.h)(h.c,{id:"teams.no-dogs-title"},"No dogs for this team!"))))))),"racecheck"===b&&Object(n.h)(t,null,Object(n.h)("h5",{class:"mt-4 border-bottom"},"Racecheck"),Object(n.h)("div",{class:"row"},a&&a.dogs?a.dogs.map(e=>Object(n.h)(t,null,Object(n.h)("div",{class:"col-12 d-flex my-3"},Object(n.h)("div",{class:"mx-0 mr-1 px-0 position-relative pt-1"},Object(n.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedMedium text-muted pt-2",style:(e.image?`background-image: url("${e.image.s3SmallLink}"); background-size: cover;`:"")+" border-width: 2px !important;"},!e.image&&Object(n.h)("span",{class:"font-weight-lighter",style:"font-size: 35px;"},r.a.ucfirst(e.name,!0))),Object(n.h)("small",null,Object(n.h)("span",{class:"float-left text-overflow",style:"width: 70px;"},e.name),Object(n.h)("br",null)),(e.birth||e.gender)&&Object(n.h)("small",null,Object(n.h)("small",{class:"font-weight-normal float-right position-absolute text-white bg-info p-1 rounded",style:"top: 0px; right: 0px; line-height: 0.8em;"},e.birth&&Object(n.h)("span",{class:"mr-1 text-white"},r.a.age(e.birth,e.deceased)),e.gender&&Object(n.h)(t,null,"female"===e.gender?Object(n.h)("i",{class:"fas fa-venus"}):Object(n.h)("i",{class:"fas fa-mars"}))))),Object(n.h)("div",{class:"flex-grow-1 row"},Object(n.h)("div",{class:"col-12 font-weight-bold"},Object(n.h)("i",{class:"fas fa-microchip text-muted"})," ",e.chipId.slice(-5)),Object(n.h)("div",{class:"col-4 form-group"},Object(n.h)("small",null,Object(n.h)("label",{class:"text-overflow w-100",for:"weight"},"Weight"),Object(n.h)("input",{type:"number",class:"form-control",id:"weight"}))),Object(n.h)("div",{class:"col-4 form-group overflow-hidden"},Object(n.h)("small",null,Object(n.h)("label",{class:"text-overflow w-100",for:"hrHeartLungs"},"HR/Heart/Lungs"),Object(n.h)("input",{type:"text",class:"form-control",id:"hrHeartLungs"}))),Object(n.h)("div",{class:"col-4 form-group"},Object(n.h)("small",null,Object(n.h)("label",{class:"text-overflow w-100",for:"bcs"},"BCS"),Object(n.h)("input",{type:"number",class:"form-control",id:"bcs"}))),Object(n.h)("div",{class:"col-12 form-group"},Object(n.h)("small",null,Object(n.h)("label",{class:"text-overflow w-100",for:"general"},"General findings"),Object(n.h)("input",{type:"text",class:"form-control",id:"general"})),Object(n.h)("small",{id:"generalHelp",class:"form-text text-muted"},"Teeth, mucus membranes, general condition, other findings.")))))):Object(n.h)(t,null,Object(n.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 px-0"},Object(n.h)("div",{class:"text-center text-muted"},Object(n.h)("div",{class:"display-1"},Object(n.h)("i",{class:"fas fa-dog"})),Object(n.h)("h3",null,Object(n.h)(h.c,{id:"teams.no-dogs-title"},"No dogs for this team!")))))))),I&&P[e.id]&&Object(n.h)(t,null,Object(n.h)("h5",null,"Admin edit:"),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{class:"col-4 col-form-label text-right"},"Email"),Object(n.h)("div",{class:"col-8"},e.email)),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"bib",class:"col-4 col-form-label text-right"},"bib"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"number",class:"form-control",id:"bib","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.bib}))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"startTime",class:"col-4 col-form-label text-right"},"startTime"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"datetime-local",class:"form-control",id:"startTime","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:r.a.isoDate(e.startTime?e.startTime:g.startDate,!1,!1,!1)}))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"team",class:"col-4 col-form-label text-right"},"team"),Object(n.h)("div",{class:"col-8"},$?Object(n.h)(t,null,Object(n.h)("select",{class:"form-control",id:"team","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.team},Object(n.h)("option",{value:""},"-- Choose race team --"),$&&$.map(e=>Object(n.h)(t,null,Object(n.h)("option",{value:e.id},e.name," ",e.dogs?`(${e.dogs.length})`:""))))):Object(n.h)(t,null,Object(n.h)("input",{type:"number",class:"form-control",id:"team","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.team})))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"user",class:"col-4 col-form-label text-right"},"user"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"number",class:"form-control",id:"user","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.user}))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"team",class:"col-4 col-form-label text-right"},"Race status"),Object(n.h)("div",{class:"col-8"},Object(n.h)("select",{class:"form-control",id:"raceStatus","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.raceStatus},Object(n.h)("option",{value:""},"-- Choose race status --"),Object(n.h)("option",{value:"OK"},"OK - Everything ok"),Object(n.h)("option",{value:"DNS"},"DNS - Did Not Start"),Object(n.h)("option",{value:"DNF"},"DNF - Did Not Finish"),Object(n.h)("option",{value:"DNQ"},"DNQ - Did not qualify"),Object(n.h)("option",{value:"DQ"},"DQ - Disqualified")))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"raceComment",class:"col-4 col-form-label text-right"},"Race comment"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"text",class:"form-control",id:"raceComment","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.raceComment}))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"gpxResultsApproved",class:"col-4 col-form-label text-right"},"GPX Results approved (date)"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"date",class:"form-control",id:"gpxResultsApproved","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.gpxResultsApproved?r.a.isoDate(e.gpxResultsApproved,!1,!1,!0):null}))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"paidSignupfee",class:"col-4 col-form-label text-right"},"paidSignupfee (date)"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"date",class:"form-control",id:"paidSignupfee","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.paidSignupfee?r.a.isoDate(e.paidSignupfee,!1,!1,!0):null}))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"startOrder",class:"col-4 col-form-label text-right"},"startOrder"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"number",class:"form-control",id:"startOrder","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.startOrder}))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"cellphone",class:"col-4 col-form-label text-right"},"Mobil"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"text",class:"form-control",id:"cellphone","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.cellphone}),A&&A.cellphone&&Object(n.h)("small",{id:"cellphoneHelp",class:"form-text text-muted","data-field":"cellphone","data-value":A.cellphone,"data-classid":g.id,"data-contestantid":e.id,onClick:this.adminSignupSetValue},A.cellphone||""))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"name",class:"col-4 col-form-label text-right"},"Navn"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"text",class:"form-control",id:"name","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.name}))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"firstname",class:"col-4 col-form-label text-right"},"Fornavn"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"text",class:"form-control",id:"firstname","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.firstname}),A&&A.firstname&&Object(n.h)("small",{id:"firstnameHelp",class:"form-text text-muted","data-field":"firstname","data-value":A.firstname,"data-classid":g.id,"data-contestantid":e.id,onClick:this.adminSignupSetValue},A.firstname||""))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"lastname",class:"col-4 col-form-label text-right"},"Etternavn"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"text",class:"form-control",id:"lastname","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.lastname}),A&&A.lastname&&Object(n.h)("small",{id:"lastnameHelp",class:"form-text text-muted","data-field":"lastname","data-value":A.lastname,"data-classid":g.id,"data-contestantid":e.id,onClick:this.adminSignupSetValue},A.lastname||""))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"address",class:"col-4 col-form-label text-right"},"Adresse"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"text",class:"form-control",id:"address","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.address}))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"postalcode",class:"col-4 col-form-label text-right"},"Postalcode"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"text",class:"form-control",id:"postalcode","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.postalcode}),A&&A.postalcode&&Object(n.h)("small",{id:"postalcodeHelp",class:"form-text text-muted","data-field":"postalcode","data-value":A.postalcode,"data-classid":g.id,"data-contestantid":e.id,onClick:this.adminSignupSetValue},A.postalcode||""))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"postalplace",class:"col-4 col-form-label text-right"},"Postalplace"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"text",class:"form-control",id:"postalplace","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.postalplace}),A&&A.postalplace&&Object(n.h)("small",{id:"postalplaceHelp",class:"form-text text-muted","data-field":"postalplace","data-value":A.postalplace,"data-classid":g.id,"data-contestantid":e.id,onClick:this.adminSignupSetValue},A.postalplace||""))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"flag",class:"col-4 col-form-label text-right"},"flag (emoji)"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"text",class:"form-control",id:"flag","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.flag}),A&&A.flag&&Object(n.h)("small",{id:"flagHelp",class:"form-text text-muted","data-field":"flag","data-value":A.flag,"data-classid":g.id,"data-contestantid":e.id,onClick:this.adminSignupSetValue},A.flag||""))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"countryCode",class:"col-4 col-form-label text-right"},"countryCode (iso)"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"text",class:"form-control",id:"countryCode","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.countryCode}))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"birthdate",class:"col-4 col-form-label text-right"},"birthdate"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"date",class:"form-control",id:"birthdate","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.birthdate?r.a.isoDate(e.birthdate,!1,!1,!0):null}))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"sportsClub",class:"col-4 col-form-label text-right"},"Klubb"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"text",class:"form-control",id:"sportsClub","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.sportsClub}),A&&A.sportsClub&&Object(n.h)("small",{id:"sportsClubHelp",class:"form-text text-muted","data-field":"sportsClub","data-value":A.sportsClub,"data-classid":g.id,"data-contestantid":e.id,onClick:this.adminSignupSetValue},A.sportsClub||""))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"status",class:"col-4 col-form-label text-right"},"Status"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"text",class:"form-control",id:"status","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.status}))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"facebook",class:"col-4 col-form-label text-right"},"Facebook"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"text",class:"form-control",id:"facebook","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.facebook}),A&&A.facebook&&Object(n.h)("small",{id:"facebookHelp",class:"form-text text-muted","data-field":"facebook","data-value":A.facebook,"data-classid":g.id,"data-contestantid":e.id,onClick:this.adminSignupSetValue},A.facebook||""))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"instagram",class:"col-4 col-form-label text-right"},"Instagram"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"text",class:"form-control",id:"instagram","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.instagram}),A&&A.instagram&&Object(n.h)("small",{id:"instagramHelp",class:"form-text text-muted","data-field":"instagram","data-value":A.instagram,"data-classid":g.id,"data-contestantid":e.id,onClick:this.adminSignupSetValue},A.instagram||""))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"team",class:"col-4 col-form-label text-right"},"Klasse"),Object(n.h)("div",{class:"col-8"},Object(n.h)("select",{class:"form-control",id:"class","aria-describedby":"classHelp","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.class},Object(n.h)("option",{value:""},"-- Choose race class --"),L.classes&&L.classes.sort((t,e)=>t.distance-e.distance).map(e=>Object(n.h)(t,null,Object(n.h)("option",{value:e.id},e.title," - ",e.distance," km - Påmelding: ",e.signupfee||L.signupfee," NOK")))))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"price1",class:"col-4 col-form-label text-right"},"Price 1"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"text",class:"form-control",id:"price1","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.price1}))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"price2",class:"col-4 col-form-label text-right"},"Price 2"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"text",class:"form-control",id:"price2","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.price2}))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"price3",class:"col-4 col-form-label text-right"},"Price 3"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"text",class:"form-control",id:"price3","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.price3}))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"priceSent",class:"col-4 col-form-label text-right"},"Price sent"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"date",class:"form-control",id:"priceSent","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.priceSent?r.a.isoDate(e.priceSent,!1,!1,!0):null}))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"topImage1",class:"col-4 col-form-label text-right"},"topImage1"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"text",class:"form-control",id:"topImage1","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.topImage1}))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"image1",class:"col-4 col-form-label text-right"},"image1"),Object(n.h)("div",{class:"col-8"},Object(n.h)("input",{type:"text",class:"form-control",id:"image1","data-classid":g.id,"data-contestantid":e.id,onInput:this.adminSignupEdit,value:e.image1}))),Object(n.h)("div",{class:"form-group row my-5"},Object(n.h)("div",{class:"col-8"},Object(n.h)("button",{type:"button",class:"btn btn-danger float-right",id:"deleteUser",value:"1",onClick:this.adminSignupEdit,"data-classid":g.id,"data-contestantid":e.id},"Delete user from this class")))))))})))),I&&Object(n.h)(t,null,e[g.id]?Object(n.h)(t,null,Object(n.h)("div",{class:"container"},Object(n.h)("div",{class:"row"},Object(n.h)("div",{class:"col-12"},Object(n.h)("h5",null,"Email to all mushers in ",g.title),Object(n.h)("div",{class:"overflow-auto p-5",style:"max-height: 30vh;"},Object(n.h)("small",null,g.emails&&g.emails.map(t=>{return Object(n.h)("div",{class:"border rounded-lg p-3 mb-3"},Object(n.h)("div",{class:"row bg-light"},Object(n.h)("div",{class:"col-3 text-right"},"Date:"),Object(n.h)("div",{class:"col-9"},r.a.formatDate(t.date,{locale:T,hour12:!1,hour:"2-digit",minute:"2-digit"}))),Object(n.h)("div",{class:"row bg-light"},Object(n.h)("div",{class:"col-3 text-right"},"To:"),Object(n.h)("div",{class:"col-9"},t.to.map(t=>Object(n.h)("span",{class:"badge badge-info px-2 py-1 mr-2"},t)))),Object(n.h)("div",{class:"row bg-light"},Object(n.h)("div",{class:"col-3 text-right"},"Subject:"),Object(n.h)("div",{class:"col-9"},t.subject)),Object(n.h)("div",{class:"row mt-2"},Object(n.h)("div",{class:"col-3 text-right"},"Body:"),Object(n.h)("div",{class:"col-9",dangerouslySetInnerHTML:{__html:(e=t.body,"string"==typeof e?e.replace(/[\n]/g,"<br>"):e)}})));var e}))),Object(n.h)("div",{class:"form-group row"},Object(n.h)("label",{for:"subject",class:"col-2 col-form-label text-right font-weight-lighter"},"To"),Object(n.h)("div",{class:"col-10"},g.contestants&&g.contestants.map(e=>Object(n.h)(t,null,Object(n.h)("span",{class:"badge badge-info px-2 py-1 mr-2"},e.firstname," ",e.lastname," (",e.email,")"))))),Object(n.h)("div",{class:"form-group row"},Object(n.h)("label",{for:"subject",class:"col-2 col-form-label text-right font-weight-lighter"},"Subject"),Object(n.h)("div",{class:"col-10"},Object(n.h)("input",{type:"text",class:"form-control",id:"subject",onInput:Object(p.a)(this,"message.subject"),value:i.subject}))),Object(n.h)("div",{class:"form-group row"},Object(n.h)("label",{for:"body",class:"col-2 col-form-label text-right font-weight-lighter"},"Message"),Object(n.h)("div",{class:"col-10"},Object(n.h)("textarea",{type:"text",class:"form-control",id:"body",rows:"10",onInput:Object(p.a)(this,"message.body"),value:i.body})),Object(n.h)("div",{class:"col-5 contain-images"},i.body&&Object(n.h)(m.a,{markdown:i.body,markdownOpts:u.a.getMarkdownOptions()}))),d&&Object(n.h)(t,null,Object(n.h)("div",{class:"alert alert-"+(d&&d.status>=300?"danger":"success"),role:"alert"},Object(n.h)("small",null,Object(n.h)("xmp",null,JSON.stringify(d,null,4))))),Object(n.h)("button",{class:"btn btn-success float-right",type:"button","data-to":g.contestants&&g.contestants.map(t=>t.email),"data-raceclassid":g.id,onClick:this.sendEmail},Object(n.h)("i",{class:"fas fa-paper-plane"})," Send email to all mushers"),Object(n.h)("button",{class:"btn btn-danger float-right mr-2",type:"button",onClick:this.resetEmail},Object(n.h)("i",{class:"fas fa-times"})," Reset email")),Object(n.h)("div",{class:"col-12 text-center"},Object(n.h)("button",{class:"btn btn-sm btn-link",type:"button",onClick:this.toggleAdminSendMessage,"data-class":g.id},"Hide email form"))))):Object(n.h)(t,null,Object(n.h)("div",{class:"col-12 text-center"},Object(n.h)("button",{class:"btn btn-sm btn-link",type:"button",onClick:this.toggleAdminSendMessage,"data-class":g.id},"Send email to all in this class")),Object(n.h)("div",{class:"col-12 text-center"},Object(n.h)("button",{class:"btn btn-sm btn-link",type:"button",onClick:this.toggleAdminSendInboxMessage,"data-class":g.id},"Send inbox message to all in this class")),Object(n.h)("div",{class:"col-12 text-center"},Object(n.h)("button",{class:"btn btn-sm btn-link",type:"button",onClick:this.toggleAdminImport,"data-class":g.id},"Toggle import form"))),s[g.id]?Object(n.h)(t,null,Object(n.h)("div",{class:"container"},Object(n.h)("div",{class:"row"},Object(n.h)("div",{class:"col-12"},Object(n.h)("h5",null,"Inbox Message to all mushers in ",g.title),Object(n.h)("div",{class:"form-group row"},Object(n.h)("label",{for:"body",class:"col-2 col-form-label text-right font-weight-lighter"},"Inbox message"),Object(n.h)("div",{class:"col-10"},Object(n.h)("textarea",{type:"text",class:"form-control",id:"body",rows:"10",onInput:Object(p.a)(this,"inboxMessage.body"),value:l.body})),Object(n.h)("div",{class:"col-5 contain-images"},l.body&&Object(n.h)(m.a,{markdown:l.body,markdownOpts:u.a.getMarkdownOptions()}))),Object(n.h)("div",{class:"clearfix"},Object(n.h)("button",{class:"btn btn-success float-right",type:"button","data-raceclassid":g.id,onClick:this.sendInboxMessage},Object(n.h)("i",{class:"fas fa-paper-plane"})," Send inbox message to all mushers"),Object(n.h)("button",{class:"btn btn-danger float-right mr-2",type:"button",onClick:this.resetInboxMessage},Object(n.h)("i",{class:"fas fa-times"})," Reset inbox message")),o&&Object(n.h)(t,null,Object(n.h)("div",{class:"alert alert-"+(o&&o.status>=300?"danger":"success"),role:"alert",style:"max-height: 20vh;"},Object(n.h)("small",null,Object(n.h)("xmp",null,JSON.stringify(o,null,4)))))),Object(n.h)("div",{class:"col-12 text-center"},Object(n.h)("button",{class:"btn btn-sm btn-link",type:"button",onClick:this.toggleAdminSendInboxMessage,"data-class":g.id},"Hide inboxmessage form"))))):Object(n.h)(t,null),I&&a[g.id]&&Object(n.h)(t,null,Object(n.h)("div",{class:"form-group"},Object(n.h)("label",{for:"importUsers"},Object(n.h)(h.c,{id:"races.paste-users"},"Paste your user data here to import users"),":"),Object(n.h)("textarea",{class:"form-control",id:"importUsers",rows:"20",oninput:t=>this.parseInput(t.target.value,g.id)})))))))))}})||o;e.a=g}).call(this,s("hosL").Fragment)},rWES:function(t,e,s){"use strict";(function(t){function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function i(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var l,c=s("hosL"),o=s("Utv1"),n=s("/eY4"),r=s("OhSV"),d=s("ZOvn");s("eQ6k");const h={confirmed:{},deleted:{}};let b=Object(n.a)(l=class extends c.Component{constructor(t){super(t),this.confirmRequest=t=>{const{team:e,user:s,follow:a}=t.target.closest("button").dataset,{teamStore:i}=this.props.stores;i.confirmFollowRequest({team:parseInt(e,10),user:parseInt(s,10)});const{confirmed:l}=this.state;l[`${e}-${s}`]=!0,this.setState({confirmed:l}),a&&i.followRequestUser(s)},this.deleteRequest=t=>{const{team:e,user:s}=t.target.closest("button").dataset,{teamStore:a}=this.props.stores;a.deleteFollowRequest({team:parseInt(e,10),user:parseInt(s,10)});const{deleted:i}=this.state;i[`${e}-${s}`]=!0,this.setState({deleted:i})},this.state=function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){i(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},h)}async loadTeams(){const{teamStore:t}=this.props.stores;await t.load({query:{},addData:["followRequests"]})}componentDidMount(){this.loadTeams()}render(){const{deleted:e={},confirmed:s={}}=this.state,{teamStore:a,appState:i}=this.props.stores,{teams:l,hasFollowRequests:n,followRequests:h=[]}=a,{darkmode:b}=i;return n?Object(c.h)("div",{class:"row pb-1"},Object(c.h)("div",{class:`col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mb-0 position-relative rounded rounded-lg py-3 bg-${b?"black":"white"} shadow-sm`},Object(c.h)("div",{class:"container-fluid"},Object(c.h)("div",{class:"row"},Object(c.h)("div",{class:"col-12"},Object(c.h)("h5",null,Object(c.h)(r.c,{id:"teams.connect.teams-follow-requests"},"Forespørsel om å følge"),":"))),Object(c.h)("div",{class:"row"},Object(c.h)("div",{class:"d-flex flex-row flex-nowrap",style:"overflow: auto;"},o.a.isArray(l)&&l.map(a=>Object(c.h)(t,null,a&&o.a.isArray(a.followRequests)&&a.followRequests.map(i=>{const l=i.image&&i.image.s3SmallLink?i.image:null,o=e[`${a.id}-${i.id}`],n=s[`${a.id}-${i.id}`],b=h.find(t=>t.user.id===i.id);return Object(c.h)("div",{class:"mr-2 py-2 border rounded-lg",style:"width: 150px;"},Object(c.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall mx-auto",style:l?`background-image: url("${l.s3SmallLink}");`:""},!l&&Object(c.h)("div",{class:"text-muted font-weight-lighter",style:"font-size: 20px; padding-top: 5px;"},d.a.displayNameShort(i))),Object(c.h)("small",null,Object(c.h)("div",{class:"text-overflow text-center"},Object(c.h)("strong",null,d.a.displayName(i)),Object(c.h)("br",null)),Object(c.h)("div",{class:"text-overflow text-center"},Object(c.h)(r.c,{id:"teams.connect.wants-to-follow"},"wants to follow your team:")),Object(c.h)("div",{class:"text-overflow text-center"},Object(c.h)("strong",null,d.a.displayName(a)))),n||o?Object(c.h)(t,null,Object(c.h)("div",{class:"text-center"},n?Object(c.h)("div",{class:"text-success"},Object(c.h)(r.c,{id:"teams.connect.confirmed"},"Confirmed")," ",Object(c.h)("i",{class:"fas fa-check"})):Object(c.h)("div",{class:"text-danger"},Object(c.h)(r.c,{id:"teams.connect.deleted"},"Deleted")," ",Object(c.h)("i",{class:"fas fa-trash-alt"})))):Object(c.h)(t,null,Object(c.h)("div",null,Object(c.h)("button",{class:"btn btn-sm btn-block btn-success text-overflow mt-1",onClick:this.confirmRequest,"data-team":a.id,"data-user":i.id},Object(c.h)(r.c,{id:"teams.connect.confirm"},"Confirm")),b&&b.public>0&&Object(c.h)("button",{class:"btn btn-sm btn-block btn-outline-success text-overflow mt-1",onClick:this.confirmRequest,"data-team":a.id,"data-user":i.id,"data-follow":!0},Object(c.h)(r.c,{id:"teams.connect.confirm-and-follow"},"Confirm & follow back")),Object(c.h)("div",{class:"mt-3"},Object(c.h)("small",null,Object(c.h)("button",{class:"btn btn-sm btn-block btn-link text-overflow",style:"font-size: 1.0em;",onClick:this.deleteRequest,"data-team":a.id,"data-user":i.id},Object(c.h)(r.c,{id:"teams.connect.delete"},"Del")))))))}))))),Object(c.h)("details",{class:"mt-3"},Object(c.h)("summary",null,Object(c.h)("small",null,Object(c.h)(r.c,{id:"teams.connect.how-summary"},"How does this work?"))),Object(c.h)("p",null,Object(c.h)(r.c,{id:"teams.connect.how-text"},"What can followers see when I grant them access to follow? The answer is very little. They can see main details of the workouts you share and name of the dogs. That's all. Try to follow a team and check out the workout tab.")))))):""}})||l;e.a=b}).call(this,s("hosL").Fragment)},t1gC:function(t,e,s){"use strict";s.r(e),function(t){function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function i(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){l(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function l(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var c,o=s("hosL"),n=s("Utv1"),r=s("/eY4"),d=s("OhSV"),h=s("Y3FI"),b=s("fh8t"),m=s.n(b),p=(s("go65"),s("Ysxg")),u=s("9lZG"),O=(s("aGZh"),s("om2D"),s("+JSK")),g=s("/DnB"),j=s("w5T0"),f=s("ULR1"),y=s("hwiY"),v=s("uAGO"),w=s("n7ns"),x=s("Pbyq"),k=s("HGwV"),S=s("J9nn"),C=s("epqT"),I=s("ZOvn");const D=I.a.marginTop(!1),T=I.a.marginTopBack(!1),R=I.a.marginBottom(),P=(I.a.subMenuMarginTop(),{isLoading:!1,showAdminSendMessage:{},newRaceArticle:{},newRaceUserImage:{},message:{subject:"",body:""}});let E=Object(r.a)(c=class extends o.Component{constructor(t){var e;super(t),e=this,this.likeRace=async function(){const{raceStore:t}=e.props.stores,{race:s}=t;await t.likeRace({id:s.id})},this.toggleAddComment=t=>{const e=t.target.parentElement.dataset.id||t.target.dataset.id,{showAddComment:s}=this.state;this.setState({showAddComment:!s},()=>{this.inputRef[e]&&this.inputRef[e].focus()})},this.chooseSubmenu=t=>{const e=t.target.parentElement.dataset.menu||t.target.dataset.menu;this.setState({submenu:e});const{raceid:s}=this.props;Object(h.route)(`/app-races/${s}/${e}`)},this.resizeTextarea=t=>{let e=t;e.target&&(e=t.target);const{scrollHeight:s}=e;e.style.height=s+"px"},this.resizeAllTextareas=()=>{const t=document.getElementsByTagName("textarea");for(let e=0,s=t.length;e<s;e+=1){this.resizeTextarea(t[e])}},this.addNavigation=t=>{this.setState({submenu:t.submenu})},this.back=()=>{Object(h.route)("/")},this.state=i(i({},P),{},{showAdminSendMessage:{},newRaceArticle:{},newRaceUserImage:{},message:{subject:"",body:""},submenu:t.submenu||"about"}),this.inputRef={},this.updateTimer={}}async loadRace(t=this.props){this.setState({isLoading:!0});const{raceStore:e,userStore:s}=t.stores,{user:a={}}=s,{raceid:l}=t;await e.load(l),this.setState({isLoading:!1});let c={};const{race:o}=e;if(o.classes&&a&&a.email)for(let t=0,e=o.classes.length;t<e;t+=1){const e=o.classes[t];if(e.contestants){const t=e.contestants.findIndex(t=>t.email===a.email);t>-1&&(c=i(i({},e.contestants[t]),{},{class:e.id}))}}e.updateKeyValue("signup",c),c.user&&await s.getDogs({id:c.user});const n=o.classes.filter(t=>t.contestants&&t.contestants.length>0).map(t=>t.contestants.filter(t=>t.team>0).map(t=>t.team)).flat();n.length>0&&l&&await e.loadTeams(n.join(",")),e.getAllClassesSortedBy(),await e.loadPublicInteractions(l)}componentDidMount(){this.loadRace(),this.resizeAllTextareas()}componentWillReceiveProps(t){t.raceid!==this.props.raceid&&this.loadRace(t),t.submenu!==this.props.submenu&&this.addNavigation(t)}render(){const{submenu:e}=this.state,{showAddComment:s}=this.state,{userStore:a,raceStore:i,appState:l}=this.props.stores,{user:c={},teams:r=[],isAdmin:h,isVeterinary:b}=a,{language:P="en"}=c,{raceid:E}=this.props,{race:F,signup:L}=i,{likes:M=[],comments:A=[]}=F,$=F.likes&&F.likes.findIndex(t=>t.user===c.id)>-1,N=new Date;let B="";N>=new Date(F.startDate)&&N<=new Date(F.endDate)?B="race":N>=new Date(F.signupStartDate)&&N<=new Date(F.signupEndDate)&&(B="signup");const z=1===F.liveRace,H=!z||!!L.email;if("tracking"===e)return Object(o.h)(k.a,{stores:this.props.stores,raceid:E});if("results"===e)return Object(o.h)(j.a,{stores:this.props.stores,raceid:E});let U=!0;if(F.countryRegexp&&c&&c.currentLocationGeocode){new RegExp(F.countryRegexp,"i").test(c.currentLocationGeocode.formattedCountry)&&(U=!1)}return Object(o.h)("div",{class:"container-fluid",style:`margin-bottom: ${R}; margin-top: ${D};`},Object(o.h)("button",{class:"btn btn-link pl-0 fixed-top text-primary",style:`top: ${T}; left: 5px; font-size: 35px; width: 45px;`,onClick:this.back},Object(o.h)("i",{class:"fas fa-arrow-circle-left"})),Object(o.h)("div",{class:"row m-0"},Object(o.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-1 mb-2 p-0"},Object(o.h)("div",{class:"row d-flex align-items-center position-relative"},Object(o.h)("h3",{class:"position-absolute",style:"top: 3px; right: 5px;"},"signup"===B&&!z&&Object(o.h)(t,null,Object(o.h)("span",{class:"badge badge-primary badge-lg border border-white ml-2","data-menu":"signup",onClick:this.chooseSubmenu},Object(o.h)(d.c,{id:"races.signup-open"},"Påmelding åpen"))),"race"===B&&Object(o.h)(t,null,Object(o.h)("span",{class:"badge badge-danger border border-white ml-2"},Object(o.h)(d.c,{id:"races.race-in-progress"},"Løp pågår"))),"done"===B&&Object(o.h)(t,null,Object(o.h)("span",{class:"badge badge-success border border-white ml-2"},Object(o.h)(d.c,{id:"races.race-finished"},"Løp avsluttet")))),F.images&&F.images[0]?Object(o.h)("img",{src:F.images[0].s3LargeLink,class:"img-fluid"}):""))),Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3"},h&&Object(o.h)(t,null,Object(o.h)("a",{class:"btn btn-primary float-right",href:`https://homerunrace.no/index#/race/${F.id}/edit`},"Edit")),Object(o.h)("h3",null,F.title),Object(o.h)("div",null,F.startDate&&Object(o.h)(t,null,Object(o.h)(d.c,{id:"races.periode"},"Periode"),": ",n.a.formatDate(F.startDate,{locale:"no-NB",hour12:!1,hour:"2-digit",minute:"2-digit"})),F.endDate&&Object(o.h)(t,null," - ",n.a.formatDate(F.endDate,{locale:"no-NB",hour12:!1,hour:"2-digit",minute:"2-digit"}))))),Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3"},Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"w-100 overflow-hidden"},Object(o.h)("div",{class:"d-flex flex-row flex-nowrap pb-2 px-1",style:"overflow: auto; scroll-snap-type: x mandatory;"},Object(o.h)("div",{class:"col px-0 pt-2"},Object(o.h)("button",{class:`btn btn-block rounded-pill-left rounded-none ${"about"===e?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"about",onClick:this.chooseSubmenu},Object(o.h)("i",{class:"fas fa-info-circle"})," ",Object(o.h)(d.c,{id:"race.about"},"About")),"about"===e&&Object(o.h)(g.a,{horizontal:"center",vertical:"end"})),H&&Object(o.h)("div",{class:"col px-0 pt-2"},Object(o.h)("button",{class:`btn btn-block rounded-none ${"signup"===e?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"signup",onClick:this.chooseSubmenu},Object(o.h)("i",{class:"fas fa-user-edit"})," ",Object(o.h)(d.c,{id:"race.signup"},"Sign up")),"signup"===e&&Object(o.h)(g.a,{horizontal:"center",vertical:"end"})),!F.resultsHide&&Object(o.h)("div",{class:"col px-0 pt-2"},Object(o.h)("button",{class:`btn btn-block rounded-none ${"results"===e?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"results",onClick:this.chooseSubmenu},Object(o.h)("i",{class:"fas fa-list-ol"})," ",Object(o.h)(d.c,{id:"race.results"},"Results")),"results"===e&&Object(o.h)(g.a,{horizontal:"center",vertical:"end"})),U&&Object(o.h)("div",{class:"col px-0 pt-2"},Object(o.h)("button",{class:`btn btn-block rounded-none ${"tracking"===e?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"tracking",onClick:this.chooseSubmenu},Object(o.h)("i",{class:"fas fa-map-marker-alt"})," ",Object(o.h)(d.c,{id:"race.tracking"},"Tracking")),"tracking"===e&&Object(o.h)(g.a,{horizontal:"center",vertical:"end"})),(h||b)&&Object(o.h)("div",{class:"col px-0 pt-2"},Object(o.h)("button",{class:`btn btn-block rounded-none ${"mushers"===e?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"mushers",onClick:this.chooseSubmenu},Object(o.h)("i",{class:"fas fa-users"})," ",Object(o.h)(d.c,{id:"races.mushers"},"Mushers")),"mushers"===e&&Object(o.h)(g.a,{horizontal:"center",vertical:"end"})),F.rules&&Object(o.h)("div",{class:"col px-0 pt-2"},Object(o.h)("button",{class:`btn btn-block rounded-none ${"rules"===e?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"rules",onClick:this.chooseSubmenu},Object(o.h)("i",{class:"fas fa-gavel"})," ",Object(o.h)(d.c,{id:"race.rules"},"Rules")),"rules"===e&&Object(o.h)(g.a,{horizontal:"center",vertical:"end"})),F.veterinaryInfo&&Object(o.h)("div",{class:"col px-0 pt-2"},Object(o.h)("button",{class:`btn btn-block rounded-none ${"veterinary"===e?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"veterinary",onClick:this.chooseSubmenu},Object(o.h)("i",{class:"fas fa-stethoscope"})," ",Object(o.h)(d.c,{id:"race.veterinary"},"Veterinary info")),"veterinary"===e&&Object(o.h)(g.a,{horizontal:"center",vertical:"end"})),F.checkpoints&&Object(o.h)("div",{class:"col px-0 pt-2"},Object(o.h)("button",{class:`btn btn-block rounded-none ${"checkpoints"===e?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"checkpoints",onClick:this.chooseSubmenu},Object(o.h)("i",{class:"fas fa-map-marker-alt"})," ",Object(o.h)(d.c,{id:"race.checkpoints"},"Checkpoints")),"checkpoints"===e&&Object(o.h)(g.a,{horizontal:"center",vertical:"end"})),F.trailDescription&&Object(o.h)("div",{class:"col px-0 pt-2"},Object(o.h)("button",{class:`btn btn-block rounded-none ${"track"===e?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"track",onClick:this.chooseSubmenu},Object(o.h)("i",{class:"fas fa-map-signs"})," ",Object(o.h)(d.c,{id:"race.track-description"},"Track description")),"track"===e&&Object(o.h)(g.a,{horizontal:"center",vertical:"end"})),F.program&&Object(o.h)("div",{class:"col px-0 pt-2"},Object(o.h)("button",{class:`btn btn-block rounded-none ${"program"===e?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"program",onClick:this.chooseSubmenu},Object(o.h)("i",{class:"fas fa-list-alt"})," ",Object(o.h)(d.c,{id:"race.program"},"Program")),"program"===e&&Object(o.h)(g.a,{horizontal:"center",vertical:"end"})),F.prices&&Object(o.h)("div",{class:"col px-0 pt-2"},Object(o.h)("button",{class:`btn btn-block rounded-none ${"prices"===e?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"prices",onClick:this.chooseSubmenu},Object(o.h)("i",{class:"fas fa-award"})," ",Object(o.h)(d.c,{id:"race.prices"},"Premier")),"prices"===e&&Object(o.h)(g.a,{horizontal:"center",vertical:"end"})),!z&&Object(o.h)("div",{class:"col px-0 pt-2"},Object(o.h)("button",{class:`btn btn-block rounded-none ${"classes"===e?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"classes",onClick:this.chooseSubmenu},Object(o.h)("i",{class:"fas fa-folder-open"})," ",Object(o.h)(d.c,{id:"race.classes"},"Classes")),"classes"===e&&Object(o.h)(g.a,{horizontal:"center",vertical:"end"})),Object(o.h)("div",{class:"col px-0 pt-2"},Object(o.h)("button",{class:`btn btn-block rounded-none ${"news"===e?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"news",onClick:this.chooseSubmenu},Object(o.h)("i",{class:"fas fa-rss"})," ",Object(o.h)(d.c,{id:"race.news"},"News")),"news"===e&&Object(o.h)(g.a,{horizontal:"center",vertical:"end"})),Object(o.h)("div",{class:"col px-0 pt-2"},Object(o.h)("button",{class:`btn btn-block rounded-pill-right rounded-none ${"userImages"===e?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;","data-menu":"userImages",onClick:this.chooseSubmenu},Object(o.h)("i",{class:"fas fa-images"})," ",Object(o.h)(d.c,{id:"race.user-images"},"User images")),"userImages"===e&&Object(o.h)(g.a,{horizontal:"center",vertical:"end"}))))))),Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col-12"},Object(o.h)(C.a,{stores:this.props.stores,url:this.props.url,section:e}))),"about"===e&&Object(o.h)(t,null,Object(o.h)(S.a,{stores:this.props.stores,race:F}),Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2"},Object(o.h)("h2",{class:"mb-0"},Object(o.h)(d.c,{id:"race.about"},"Om løpet"))),Object(o.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2"},Object(o.h)("p",{class:"clearfix"},Object(o.h)("strong",null,Object(o.h)(m.a,{markdown:I.a.replaceImages(F.ingress,F.images,P),markdownOpts:I.a.getMarkdownOptions()}))),"signup"===B&&Object(o.h)(t,null,z?Object(o.h)(t,null,Object(o.h)("button",{class:"btn btn-block btn-success mb-3","data-menu":"signup",onClick:this.chooseSubmenu},Object(o.h)("i",{class:"fas fa-user-edit"})," ",F.declaration&&Object(o.h)(t,null,Object(o.h)(d.c,{id:"race.declaration"},"Declaration")," &")," ",Object(o.h)(d.c,{id:"race.chiplist"},"Chiplist"))):Object(o.h)(t,null,Object(o.h)("button",{class:"btn btn-block btn-success mb-3","data-menu":"signup",onClick:this.chooseSubmenu},Object(o.h)("i",{class:"fas fa-user-edit"})," ",Object(o.h)(d.c,{id:"race.signup"},"Sign up")))),Object(o.h)(m.a,{markdown:I.a.replaceImages(F.body,F.images,P),markdownOpts:I.a.getMarkdownOptions()})),Object(o.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2"},F.tag&&F.tag.split(",").map(e=>Object(o.h)(t,null,Object(o.h)("span",{class:"badge badge-pill badge-primary py-1 ml-2"},Object(o.h)("a",{class:"text-white",href:"https://www.facebook.com/hashtag/"+e,target:"_blank",rel:"noreferrer",native:!0},Object(o.h)("i",{class:"fab fa-facebook"})," #",e)),Object(o.h)("span",{class:"badge badge-pill badge-primary py-1 ml-2"},Object(o.h)("a",{class:"text-white",href:"https://www.instagram.com/explore/tags/"+e,target:"_blank",rel:"noreferrer",native:!0},Object(o.h)("i",{class:"fab fa-instagram"})," #",e))))))),"results"===e&&Object(o.h)(t,null,Object(o.h)(S.a,{stores:this.props.stores,race:F}),Object(o.h)(j.a,{stores:this.props.stores,raceid:E})),"tracking"===e&&Object(o.h)(t,null,Object(o.h)(k.a,{stores:this.props.stores,raceid:E})),"news"===e&&Object(o.h)(t,null,Object(o.h)(f.a,{stores:this.props.stores,race:F})),"userImages"===e&&Object(o.h)(t,null,Object(o.h)(x.a,{stores:this.props.stores,race:F})),"rules"===e&&Object(o.h)(t,null,Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2"},Object(o.h)("h2",{class:"mb-0"},Object(o.h)(d.c,{id:"race.rules"},"Regler"))),Object(o.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2"},Object(o.h)(m.a,{markdown:I.a.replaceImages(F.rules,F.images,P),markdownOpts:I.a.getMarkdownOptions()})))),"veterinary"===e&&Object(o.h)(t,null,Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2"},Object(o.h)("h2",{class:"mb-0"},Object(o.h)(d.c,{id:"race.veterinary"},"Veterinærinfo"))),Object(o.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2"},Object(o.h)(m.a,{markdown:I.a.replaceImages(F.veterinaryInfo,F.images,P),markdownOpts:I.a.getMarkdownOptions()})))),"checkpoints"===e&&Object(o.h)(t,null,Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2"},Object(o.h)("h2",{class:"mb-0"},Object(o.h)(d.c,{id:"race.checkpoints"},"Sjekkpunkter"))),Object(o.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2"},Object(o.h)(m.a,{markdown:I.a.replaceImages(F.checkpoints,F.images,P),markdownOpts:I.a.getMarkdownOptions()})))),"track"===e&&Object(o.h)(t,null,Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2"},Object(o.h)("h2",{class:"mb-0"},Object(o.h)(d.c,{id:"race.track-description"},"Løypebeskrivelse"))),Object(o.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2"},Object(o.h)(m.a,{markdown:I.a.replaceImages(F.trailDescription,F.images,P),markdownOpts:I.a.getMarkdownOptions()})))),"program"===e&&Object(o.h)(t,null,Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2"},Object(o.h)("h2",{class:"mb-0"},Object(o.h)(d.c,{id:"race.program"},"Program"))),Object(o.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2"},Object(o.h)(m.a,{markdown:I.a.replaceImages(F.program,F.images,P),markdownOpts:I.a.getMarkdownOptions()})))),"prices"===e&&Object(o.h)(t,null,Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2"},Object(o.h)("h2",{class:"mb-0"},Object(o.h)(d.c,{id:"race.prices"},"Premier"))),Object(o.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2"},Object(o.h)(m.a,{markdown:I.a.replaceImages(F.prices,F.images,P),markdownOpts:I.a.getMarkdownOptions()})))),"mushers"===e&&Object(o.h)(t,null,Object(o.h)(w.a,{stores:this.props.stores,race:F})),"classes"===e&&Object(o.h)(t,null,Object(o.h)(v.a,{stores:this.props.stores,race:F})),"signup"===e&&Object(o.h)(t,null,Object(o.h)(y.a,{stores:this.props.stores,race:F})),["about"].indexOf(e)>-1&&Object(o.h)(t,null,Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2"},Object(o.h)("div",{class:""},Object(o.h)(O.a,{stores:this.props.stores,likes:M,comments:A,type:"race"}))),Object(o.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-2 mb-3"},Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col-6 text-center"},Object(o.h)("button",{type:"button",class:`btn btn-outline-${$?"primary":"secondary"} btn-lg btn-block ${$?"text-primary":""}`,onClick:this.likeRace},Object(o.h)("i",{class:($?"text-primary fas":"far")+" fa-thumbs-up"})," ",$?Object(o.h)(d.c,{id:"comments.has-liked"},"Liked"):Object(o.h)(d.c,{id:"comments.like"},"Lik"))),Object(o.h)("div",{class:"col-6 text-center"},Object(o.h)("button",{type:"button",class:"btn btn-outline-secondary btn-lg btn-block","data-id":F.id,onClick:this.toggleAddComment},Object(o.h)("i",{class:"fas fa-comment"})," ",Object(o.h)(d.c,{id:"comments.comment-add"},"Comment"))))),Object(o.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-2 mb-3"},s&&c.email&&Object(o.h)(u.a,{stores:this.props.stores,race:F,inputRef:t=>this.inputRef[F.id]=t,inputRefObject:this.inputRef})),Object(o.h)("div",{class:"col-12 mt-2"},Object(o.h)(p.a,{stores:this.props.stores,race:F,cols:"12"})))))}})||c;e.default=E}.call(this,s("hosL").Fragment)},uAGO:function(t,e,s){"use strict";(function(t){var a,i=s("hosL"),l=s("Utv1"),c=s("/eY4"),o=s("OhSV"),n=(s("Y3FI"),s("fh8t")),r=s.n(n),d=(s("go65"),s("ZOvn"));let h=Object(c.a)(a=class extends i.Component{constructor(t){super(t),this.state={},this.inputRef={},this.updateTimer={}}render(){const{userStore:e}=this.props.stores,{user:s={},teams:a=[],isAdmin:c}=e,{language:n="en"}=s,{race:h={}}=this.props;return Object(i.h)(t,null,Object(i.h)("div",{class:"row"},Object(i.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2"},Object(i.h)("h2",{class:"mb-0"},Object(i.h)(o.c,{id:"race.classes"},"Klasser"))),Object(i.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2"},Object(i.h)("div",{class:"row"},h.classes&&h.classes.sort((t,e)=>t.distance-e.distance).map(e=>Object(i.h)(t,null,Object(i.h)("div",{class:"col-12 col-sm-6 col-lg-4 mb-4"},Object(i.h)("div",{class:"border rounded rounded-lg p-3"},Object(i.h)("h5",null,e.title),c&&Object(i.h)(t,null,Object(i.h)("a",{href:`/tv/top10/${h.id}/${e.id}`},"TV Top 10"),Object(i.h)("br",null),Object(i.h)("a",{href:`/tv/team/${h.id}/1`},"TV One team"),Object(i.h)("br",null)),Object(i.h)("small",null,e.startDate&&Object(i.h)("div",null,Object(i.h)("span",{class:"font-weight-lighter"},Object(i.h)(o.c,{id:"race.startdate"},"Start"),":")," ",l.a.formatDate(e.startDate,{locale:n,hour12:!1,hour:"2-digit",minute:"2-digit"})),e.endDate&&Object(i.h)("div",null,Object(i.h)("span",{class:"font-weight-lighter"},Object(i.h)(o.c,{id:"race.enddate"},"End"),":")," ",l.a.formatDate(e.endDate,{locale:n,hour12:!1,hour:"2-digit",minute:"2-digit"}))),Object(i.h)("div",null,Object(i.h)("span",{class:"font-weight-lighter"},Object(i.h)(o.c,{id:"race.distance"},"Distanse"),":")," ",e.distance," km"),Object(i.h)("div",null,Object(i.h)("span",{class:"font-weight-lighter"},Object(i.h)(o.c,{id:"race.signup"},"Påmelding"),":")," ",e.signupfee||h.signupfee," NOK"),Object(i.h)("p",{class:"clearfix"},Object(i.h)(r.a,{markdown:d.a.replaceImages(e.ingress,h.images,n),markdownOpts:d.a.getMarkdownOptions()})),Object(i.h)("small",null,Object(i.h)(r.a,{markdown:d.a.replaceImages(e.body,h.images,n),markdownOpts:d.a.getMarkdownOptions()})),e.rules&&Object(i.h)(t,null,Object(i.h)("h5",null,Object(i.h)(o.c,{id:"race.rules"},"Regler")),Object(i.h)(r.a,{markdown:d.a.replaceImages(e.rules,h.images,n),markdownOpts:d.a.getMarkdownOptions()}))))))))))}})||a;e.a=h}).call(this,s("hosL").Fragment)},w5T0:function(t,e,s){"use strict";(function(t){function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function i(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var l,c,o=s("hosL"),n=s("Utv1"),r=s("/eY4"),d=s("OhSV"),h=(s("Y3FI"),s("fh8t")),b=s.n(h),m=(s("go65"),s("/DnB"),s("cH0S")),p=(s("wanP"),s("ZQlJ"),s("fVsX")),u=s("aMCh"),O=(s("gcyc"),s("LbFk")),g=s("QuNB"),j=s("zUny"),f=s("ZOvn");const y={isLoading:!1,contentIsNotLoaded:!0,reloadInSec:null,reloadLastEpoch:null,reloadIsActive:!1},v=f.a.marginTop(!0,!1);let w=Object(r.a)(l=class extends o.Component{constructor(t){super(t),this.initComponent=()=>{this.setState({reloadIsActive:!0},()=>this.tickReloadTimeer())},this.state=function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){i(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},y),this.updateTimer={}}tickReloadTimeer(){const{reloadLastEpoch:t}=this.props,{reloadIsActive:e}=this.state;if(e){const e=Math.floor((new Date).getTime()/1e3);this.setState({reloadInSec:60-(e-t)}),clearTimeout(this.updateTimer.tick),this.updateTimer.tick=setTimeout(()=>this.tickReloadTimeer(),1e3)}return!1}componentDidMount(){this.initComponent()}componentWillUnmount(){clearTimeout(this.updateTimer.tick)}render(){const{reloadInSec:e}=this.state,s=Math.floor(n.a.normalizeBetween(e,0,60,0,100));return Object(o.h)(t,null,Object(o.h)("div",{class:"progress fixed-top",style:"height: 2px; z-index: 999999;"},Object(o.h)("div",{class:"progress-bar",role:"progressbar",style:`width: ${s}%;`,"aria-valuenow":s,"aria-valuemin":"0","aria-valuemax":"100"})))}})||l,x=Object(r.a)(c=class extends o.Component{constructor(t){var e;super(t),e=this,this.loadLiveRaceResults=async function(t=e.props,{teamIds:s,focusOnMushers:a,bibs:i,classid:l,historySteps:c}){const{raceStore:o,userStore:n}=t.stores,{race:r}=o,{replayHistory:d}=e.state,{showDrawerReplay:h}=e.props,b=o.getClassById(l)||{},{isAdmin:m}=n;await o.getRaceTrackerData(r.raceTrackerRace,{historySteps:c,history:d||h,bibs:i,classid:l,startDate:b.startDate,endDate:b.endDate,isAdmin:m}),o.getRaceTrackerActiveTeams(s,a,i,!0)},this.loadRaceResults=async function(t=e.props,s,a){const{raceStore:i}=t.stores,{raceid:l}=t,{timerRunning:c}=e.state;await i.loadWorkoutSummary(s,l),i.getWorkoutSummaryActiveTeams(s,a),c&&(clearTimeout(e.updateTimer.reload),e.updateTimer.reload=setTimeout(()=>{const t=Math.floor((new Date).getTime()/1e3);e.setState({reloadLastEpoch:t}),e.loadRaceResults(e.props,s,a)},6e4))},this.toggleDisplayDetails=t=>{const e=t.target.closest("tr").dataset.email,{appState:s}=this.props.stores;s.toggleDisplayDetails(e)},this.adminToggleEditUser=t=>{t.stopPropagation();const e=t.target.closest("tr").dataset.email,{appState:s}=this.props.stores;s.toggleEditUserDetails(e)},this.adminSignupEdit=t=>{const{raceid:e}=this.props,{raceStore:s}=this.props.stores,a=t.target.id,i=t.target.value,{classid:l,contestantid:c}=t.target.dataset,o={raceClassId:l,contestantId:c,["raceClassContestant"+n.a.ucfirst(a)]:i};clearTimeout(this.updateTimer[a]),this.updateTimer[a]=setTimeout((async function(){s.editClass({id:e,data:o})}),500)},this.lockAllWorkoutsInRace=async function(){const{raceid:t}=e.props,{raceStore:s}=e.props.stores,a=await s.lockAllWorkoutsInRace({id:t});e.setState({lockMessage:a})},this.filterByClass=async function(t){try{const s=t.target.closest("button").dataset.id,{showDrawerReplay:a,historySteps:i,filterByBibs:l}=e.props,{replayHistory:c}=e.state;(c||a)&&e.toggleReplayHistory();const{appState:o,raceStore:n}=e.props.stores;n.cleanupMemoryClass(),o.toggleSelectedClassId(s,!0);const{race:r}=n,{focusOnMushers:d}=o,h=r.classes.filter(t=>t.id===s).filter(t=>t.contestants&&t.contestants.length>0).map(t=>t.contestants.filter(t=>t.team>0).map(t=>t.team)).flat(),b=l||r.classes.filter(t=>t.id===s).filter(t=>t.contestants&&t.contestants.length>0).map(t=>t.contestants.filter(t=>t.bib>0).map(t=>t.bib)).flat();e.setState({allTeamIds:h,bibs:b,selectedMusherBib:"",showDrawerCheckpoint:!1,showDrawerMusher:!1,showDrawer:!1}),h.length>0&&await n.loadTeams(h.join(","),!1,!0,!0),r.liveRace>0?await e.loadLiveRaceResults(e.props,{teamIds:h,focusOnMushers:d,bibs:b,classid:s,historySteps:i}):await e.loadRaceResults(e.props,h,d)}catch(t){console.log(t)}},this.toggleDrawer=()=>{const{showDrawer:t}=this.state;this.setState({showDrawer:!t,showDrawerCheckpoint:!1,showDrawerMusher:!1})},this.toggleDrawerMusher=t=>{const e=t.target.closest(".musher").dataset.bib;this.selectMusher(e)},this.selectMusher=t=>{this.setState({selectedMusherBib:t,showDrawerMusher:!0,showDrawerCheckpoint:!1,showDrawer:!1})},this.closeDrawerMusher=()=>{this.setState({selectedMusherBib:"",showDrawerMusher:!1})},this.toggleDrawerCheckpoint=t=>{const e=t.target.closest(".checkpoint").dataset.id;this.selectCheckpoint(e)},this.selectCheckpoint=t=>{this.setState({selectedCheckpointId:t,showDrawerCheckpoint:!0,showDrawerMusher:!1,showDrawer:!1})},this.closeDrawerCheckpoint=()=>{this.setState({selectedCheckpointId:"",showDrawerCheckpoint:!1})},this.state={showDrawer:!1,timerRunning:!0},this.inputRef={},this.updateTimer={}}async loadRace(t=this.props){var e=this;const{loadTimes:s=0}=this.state;this.setState({isLoading:!0});const{raceStore:a,appState:i}=t.stores,{raceid:l,classid:c,filterByBibs:o,historySteps:n}=t;await a.load(l),a.getAllClassesSortedBy();const{race:r}=a,{focusOnMushers:d}=i,{selectedClassIds:h=[]}=i,b=null==r?void 0:r.classes.map(t=>t.id);let m=h[0];-1===b.indexOf(m)&&(m=b[0],i.setSelectedClassId(m)),c&&i.toggleSelectedClassId(c,!0);const p=r.classes.filter(t=>t.id===m).filter(t=>t.contestants&&t.contestants.length>0).map(t=>t.contestants.filter(t=>t.team>0).map(t=>t.team)).flat(),u=o||r.classes.filter(t=>t.id===m).filter(t=>t.contestants&&t.contestants.length>0).map(t=>t.contestants.filter(t=>t.bib>0).map(t=>t.bib)).flat();p.length>0&&await a.loadTeams(p.join(","),!1,!0,!0),r.liveRace>0?(await this.loadLiveRaceResults(this.props,{teamIds:p,focusOnMushers:d,bibs:u,classid:m,historySteps:n}),clearTimeout(this.updateTimer.reload),this.updateTimer.reload=setTimeout((async function(){const t=Math.floor((new Date).getTime()/1e3);e.setState({reloadLastEpoch:t}),e.loadRace()}),6e4)):await this.loadRaceResults(this.props,p,d),this.setState({isLoading:!1,contentIsNotLoaded:!1,loadTimes:s+1})}componentWillUnmount(){clearTimeout(this.updateTimer.reload),clearTimeout(this.updateTimer.tick)}componentDidMount(){this.loadRace()}render(){const{contentIsNotLoaded:e,lockMessage:s,showDrawer:a,reloadLastEpoch:i,selectedMusherBib:l,selectedCheckpointId:c,showDrawerCheckpoint:r,showDrawerMusher:h}=this.state,{userStore:y,raceStore:x,appState:k}=this.props.stores,{user:S={},teams:C=[],isAdmin:I,currentEmail:D}=y,{language:T="en"}=S,{displayDetails:R,editUserDetails:P,selectedClassIds:E=[]}=k,{race:F={},classes:L=[]}=x,M=new Date(F.endDate);M.setHours(M.getHours()+2);const A=1===F.liveRace,$=F&&F.raceAdmins?F.raceAdmins.split(","):[],N=I||$.indexOf(D)>-1;return Object(o.h)(t,null,Object(o.h)(p.a,{height:v},Object(o.h)("div",{class:"d-flex justify-content-between align-items-center w-100"},Object(o.h)("div",{class:"d-flex align-items-center"},Object(o.h)("span",{class:"",style:"font-size: 2.3em;"},Object(o.h)("a",{href:"/app-races/"+F.id},Object(o.h)("i",{class:"fas fa-angle-left"}))),Object(o.h)("span",{class:"ml-4 text-primary",style:"font-size: 1.4em;"},Object(o.h)("a",{href:`/app-races/${F.id}/tracking`},Object(o.h)("i",{class:"fas fa-map-marked"})))),Object(o.h)("div",null,Object(o.h)("a",{href:"/app-races/"+F.id},Object(o.h)("span",{class:"font-weight-normal text-white",style:"font-size: 1.2em;"},F.title))),Object(o.h)("div",{class:"d-flex align-items-center"},N&&Object(o.h)(t,null,Object(o.h)("button",{class:"btn btn-lg btn-block btn-success my-3",onClick:this.toggleDrawer},Object(o.h)("i",{class:"fas fa-clock"}))))),Object(o.h)("div",{class:"w-100 overflow-hidden"},Object(o.h)("div",{class:"d-flex flex-row flex-nowrap pb-2 px-1",style:"overflow: auto; scroll-snap-type: x mandatory;"},F.classes&&F.classes.map((e,s)=>Object(o.h)(t,null,Object(o.h)("div",{class:"col px-0 pt-0"},Object(o.h)("button",{type:"button",class:`btn btn-block ${f.a.getPillClass(F.classes.length,s)} rounded-none ${E.indexOf(e.id)>-1?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;",onClick:this.filterByClass,"data-id":e.id},e.title))))))),Object(o.h)("div",{class:"container-fluid position-relative p-0 overflow-auto bg-light",style:`margin-top: ${v}; height: calc(100vh - ${v}); z-index: 9999;`},Object(o.h)("div",{class:"col-12"},Object(o.h)(w,{stores:this.props.stores,reloadLastEpoch:i}),A?Object(o.h)(t,null):Object(o.h)(t,null,S.email&&Object(o.h)("div",{class:"alert alert-primary",role:"alert"},"no"===T&&Object(o.h)(t,null,"Resultatene hentes direkte fra treningsøktene i QPaws appen.",Object(o.h)("br",null),Object(o.h)("strong",null,"For at treningsøktene skal bli registrert må øktene:"),Object(o.h)("ul",null,Object(o.h)("li",null,"Ha riktig dato som er innenfor løpsperioden."),Object(o.h)("li",null,"Være markert som 'Konkurranse'."),Object(o.h)("li",null,"Være registrert på teamet som er påmeldt."))),"en"===T&&Object(o.h)(t,null,"The results are imported directly from the workouts inside QPaws app.",Object(o.h)("br",null),Object(o.h)("strong",null,"To make sure your workouts are registered check the following:"),Object(o.h)("ul",null,Object(o.h)("li",null,"Use the correct date on your workout. Has to be inside the race period."),Object(o.h)("li",null,"Mark the workout as 'Race'."),Object(o.h)("li",null,"Workout has to be on the same team as you signed up with."))))),F.resultsUrl&&Object(o.h)("div",{class:"p-3 my-2 bg-light"},Object(o.h)("a",{href:F.resultsUrl,target:"_blank",rel:"noreferrer",native:!0},F.resultsText?F.resultsText:Object(o.h)(t,null,Object(o.h)(d.c,{id:"races.results-here"},"Se resultater her")," ")," ",Object(o.h)("i",{class:"fas fa-chevron-circle-right"}))),(e||!L||0===L.length)&&Object(o.h)("div",{class:"d-flex justify-content-center my-5 py-5"},Object(o.h)("div",{class:"spinner-border text-primary",role:"status"},Object(o.h)("span",{class:"sr-only"},"Loading...")))),Object(o.h)("div",{class:"col-12"},F.classes&&F.classes.filter(t=>!(E.length>0)||E.indexOf(t.id)>-1).map(e=>Object(o.h)(t,null,Object(o.h)("div",{class:"mt-2 mb-5"},F.resultDanger&&Object(o.h)("div",{class:"alert alert-danger",role:"alert"},Object(o.h)("div",{class:"spinner-grow text-danger float-left",role:"status"},Object(o.h)("span",{class:"sr-only"},"Loading...")),Object(o.h)("i",{class:"fas fa-exclamation-triangle float-left mr-4",style:"font-size: 2.0em;"}),Object(o.h)(b.a,{markdown:f.a.replaceImages(F.resultDanger,F.images,T),markdownOpts:f.a.getMarkdownOptions()})),F.resultWarning&&Object(o.h)("div",{class:"alert alert-warning",role:"alert"},Object(o.h)("i",{class:"fas fa-exclamation float-left mr-4",style:"font-size: 2.0em;"}),Object(o.h)(b.a,{markdown:f.a.replaceImages(F.resultWarning,F.images,T),markdownOpts:f.a.getMarkdownOptions()})),F.resultSuccess&&Object(o.h)("div",{class:"alert alert-success",role:"alert"},Object(o.h)("i",{class:"fas fa-check float-left mr-4",style:"font-size: 2.0em;"}),Object(o.h)(b.a,{markdown:f.a.replaceImages(F.resultSuccess,F.images,T),markdownOpts:f.a.getMarkdownOptions()})),F.liveRace?Object(o.h)(t,null,!a&&Object(o.h)(t,null,Object(o.h)(u.a,{stores:this.props.stores,race:F,currentClass:e,reloadLastEpoch:i,key:"raceclass-"+e.id,onClickMusher:this.toggleDrawerMusher,onClickCheckpoint:this.toggleDrawerCheckpoint,selectedCheckpointId:c}))):Object(o.h)(t,null,Object(o.h)("span",{class:"float-right"},Object(o.h)("span",{class:"text-muted"},Object(o.h)(d.c,{id:"races.mushers"},"Mushers"),": ",e.totalMushers||0),Object(o.h)("span",{class:"text-muted ml-4"},Object(o.h)(d.c,{id:"races.finished-mushers"},"Finished mushers"),": ",e.totalFinished||0," ")),Object(o.h)("div",{class:"table-responsive-md"},Object(o.h)("table",{class:"table table-sm table-striped"},Object(o.h)("thead",null,Object(o.h)("tr",null,Object(o.h)("th",{scope:"col"},"#"),Object(o.h)("th",{scope:"col",style:"min-width: 200px;"},Object(o.h)(d.c,{id:"races.name"},"Navn")),I&&Object(o.h)(t,null,Object(o.h)("th",{class:"d-none d-lg-table-cell",scope:"col"},Object(o.h)("i",{class:"fas fa-user-shield"})," Cellphone"),Object(o.h)("th",{class:"d-none d-lg-table-cell",scope:"col"},Object(o.h)("i",{class:"fas fa-user-shield"})," Email")),I&&Object(o.h)("th",{scope:"col",class:"d-none d-lg-table-cell",style:"min-width: 400px;"},Object(o.h)(d.c,{id:"races.stages"},"Etapper")),Object(o.h)("th",{scope:"col"},Object(o.h)(d.c,{id:"races.result"},"Resultat")))),Object(o.h)("tbody",null,L[e.id]&&L[e.id].contestants&&L[e.id].contestants.map((s,a)=>{const{musher:i,currentTeam:l,currentStages:c,currentResults:r,completed:d,normalizedDuration:h,weightedNormalizedDuration:m,isDone:p,finishedDate:u,totalWorkoutTimeUsedSec:O}=s,g=x.getTotalsByTeamId(l.id);return Object(o.h)(t,null,Object(o.h)("tr",{onClick:this.toggleDisplayDetails,"data-email":i.email},Object(o.h)("th",{scope:"row"},a+1,I&&r&&Object(o.h)(t,null,Object(o.h)("br",null),r.isLocked?Object(o.h)("i",{class:"fas fa-lock text-danger mr-2"}):Object(o.h)("i",{class:"fas fa-lock-open text-success mr-2"}))),Object(o.h)("td",{class:""+(R[i.email]?"font-weight-bold":""),style:""+(R[i.email]?"":"line-height: 0.8em;")},R[i.email]?Object(o.h)(t,null,i.firstname," ",i.lastname,Object(o.h)("br",null),Object(o.h)("span",{class:"text-muted"},l.name),Object(o.h)("br",null),Object(o.h)("small",{class:"text-muted"},i.sportsClub),Object(o.h)("br",null),i.facebook&&Object(o.h)("a",{class:"mr-2",href:f.a.asFacebookLink(i.facebook),native:!0,target:"_blank",rel:"noreferrer"},Object(o.h)("i",{class:"fab fa-facebook"})),i.instagram&&Object(o.h)("a",{class:"mr-2",href:f.a.asInstagramLink(i.instagram),native:!0,target:"_blank",rel:"noreferrer"},Object(o.h)("i",{class:"fab fa-instagram"})),i.price1&&Object(o.h)("div",{class:"font-weight-lighter"},Object(o.h)("i",{class:"fas fa-trophy text-warning"})," ",i.price1,i.priceSent&&Object(o.h)(t,null,Object(o.h)("i",{class:"fas fa-check text-success"}))),i.price2&&Object(o.h)("div",{class:"font-weight-lighter"},Object(o.h)("i",{class:"fas fa-trophy text-warning"})," ",i.price2),i.price3&&Object(o.h)("div",{class:"font-weight-lighter"},Object(o.h)("i",{class:"fas fa-trophy text-warning"})," ",i.price3)):Object(o.h)(t,null,i.price1&&Object(o.h)("span",{class:"float-right text-warning",style:"font-size: 1.2em;"},Object(o.h)("i",{class:"fas fa-trophy"}),i.priceSent&&Object(o.h)(t,null,Object(o.h)("i",{class:"fas fa-check text-success"}))),Object(o.h)("nobr",null,i.firstname," ",i.lastname,Object(o.h)("br",null),Object(o.h)("small",{class:"text-muted"},i.sportsClub),Object(o.h)("br",null)))),I&&Object(o.h)(t,null,Object(o.h)("td",{class:"d-none d-lg-table-cell"},i.cellphone),Object(o.h)("td",{class:"d-none d-lg-table-cell"},i.email)),I&&Object(o.h)("td",{class:"d-none d-lg-table-cell"},I&&Object(o.h)(t,null,Object(o.h)("button",{class:"btn btn-primary btn-sm float-right",onClick:this.adminToggleEditUser},Object(o.h)("i",{class:"fas fa-user-edit"}))),I&&P[i.email]&&Object(o.h)(t,null,Object(o.h)("h5",null,"Admin edit:"),Object(o.h)("div",{class:"form-group row my-0"},Object(o.h)("label",{class:"col-sm-2 col-form-label text-right"},"Email"),Object(o.h)("div",{class:"col-sm-10"},i.email)),Object(o.h)("div",{class:"form-group row my-0"},Object(o.h)("label",{class:"col-sm-2 col-form-label text-right"},"Cellphone"),Object(o.h)("div",{class:"col-sm-10"},i.cellphone)),Object(o.h)("div",{class:"form-group row my-0"},Object(o.h)("label",{for:"team",class:"col-sm-2 col-form-label text-right"},"Race status"),Object(o.h)("div",{class:"col-sm-10"},Object(o.h)("select",{class:"form-control-plaintext",id:"raceStatus","data-classid":i.class,"data-contestantid":i.id,onInput:this.adminSignupEdit,value:i.raceStatus},Object(o.h)("option",{value:""},"-- Choose race status --"),Object(o.h)("option",{value:"OK"},"OK - Everything ok"),Object(o.h)("option",{value:"DNS"},"DNS - Did Not Start"),Object(o.h)("option",{value:"DNF"},"DNF - Did Not Finish"),Object(o.h)("option",{value:"DNQ"},"DNQ - Did not qualify"),Object(o.h)("option",{value:"DQ"},"DQ - Disqualified"),Object(o.h)("option",{value:"DC"},"DC - Data changed by user")))),Object(o.h)("div",{class:"form-group row my-0"},Object(o.h)("label",{for:"raceComment",class:"col-sm-2 col-form-label text-right"},"Race comment"),Object(o.h)("div",{class:"col-sm-10"},Object(o.h)("input",{type:"text",class:"form-control-plaintext",id:"raceComment","data-classid":i.class,"data-contestantid":i.id,onInput:this.adminSignupEdit,value:i.raceComment}))),Object(o.h)("div",{class:"form-group row my-0"},Object(o.h)("label",{for:"gpxResultsApproved",class:"col-sm-2 col-form-label text-right"},"GPX Results approved (date)"),Object(o.h)("div",{class:"col-sm-10"},Object(o.h)("input",{type:"date",class:"form-control-plaintext",id:"gpxResultsApproved","data-classid":i.class,"data-contestantid":i.id,onInput:this.adminSignupEdit,value:i.gpxResultsApproved?n.a.isoDate(i.gpxResultsApproved,!1,!1,!0):null}))),Object(o.h)("div",{class:"form-group row my-0"},Object(o.h)("label",{for:"price1",class:"col-sm-2 col-form-label text-right"},"Price 1"),Object(o.h)("div",{class:"col-sm-10"},Object(o.h)("input",{type:"text",class:"form-control-plaintext",id:"price1","data-classid":i.class,"data-contestantid":i.id,onInput:this.adminSignupEdit,value:i.price1}))),Object(o.h)("div",{class:"form-group row my-0"},Object(o.h)("label",{for:"price2",class:"col-sm-2 col-form-label text-right"},"Price 2"),Object(o.h)("div",{class:"col-sm-10"},Object(o.h)("input",{type:"text",class:"form-control-plaintext",id:"price2","data-classid":i.class,"data-contestantid":i.id,onInput:this.adminSignupEdit,value:i.price2}))),Object(o.h)("div",{class:"form-group row my-0"},Object(o.h)("label",{for:"price3",class:"col-sm-2 col-form-label text-right"},"Price 3"),Object(o.h)("div",{class:"col-sm-10"},Object(o.h)("input",{type:"text",class:"form-control-plaintext",id:"price3","data-classid":i.class,"data-contestantid":i.id,onInput:this.adminSignupEdit,value:i.price3}))),Object(o.h)("div",{class:"form-group row my-0"},Object(o.h)("label",{for:"priceSent",class:"col-sm-2 col-form-label text-right"},"Price sent"),Object(o.h)("div",{class:"col-sm-10"},Object(o.h)("input",{type:"date",class:"form-control-plaintext",id:"priceSent","data-classid":i.class,"data-contestantid":i.id,onInput:this.adminSignupEdit,value:i.priceSent?n.a.isoDate(i.priceSent,!1,!1,!0):null})))),I&&Object(o.h)("div",{class:"d-flex flex-wrap"},c&&c.map((s,a)=>{const l=s.distanceKm/e.distance*100,c=(l>100||parseInt(l,10),Math.floor(new Date(s.date).getTime()/1e3)),r=new Date(0);r.setUTCSeconds(c+parseInt(s.duration,10));s.images.flat();return R[i.email]?Object(o.h)(t,null,Object(o.h)("div",{class:"bg-light border rounded-lg  text-right position-relative mr-1 mb-1",style:"width: 350px; min-width: 320px;"},Object(o.h)("svg",{viewBox:"0 0 300 100",class:"position-absolute",style:"width: 100%; height: 95%; bottom: 0px; left: 0px; z-index: 0;"},Object(o.h)("path",{d:""+s.svgElevation,style:"fill: #0063FF; stroke: #0063FF; stroke-width: 2; opacity: 0.2;"})),Object(o.h)("div",{class:"position-relative px-3"},Object(o.h)("span",{class:"position-absolute",style:"top: 3px; left: 3px; font-size: 1.3em;"},a+1),Object(o.h)("small",null,I&&Object(o.h)("span",{class:"position-absolute",style:"top: 0px; right: -5px;"},s.isLocked?Object(o.h)("i",{class:"fas fa-lock text-danger"}):Object(o.h)("i",{class:"fas fa-lock-open text-success"})),Object(o.h)("span",{class:"float-left"},Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-sign-out-alt text-muted"})," ",n.a.formatDate(s.date,{locale:T,hour12:!1,hour:"2-digit",minute:"2-digit"})),Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-sign-in-alt text-muted"})," ",n.a.formatDate(r,{locale:T,hour12:!1,hour:"2-digit",minute:"2-digit"}))),Object(o.h)("span",{class:"float-right"},Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-road text-muted"})," ",n.a.format(s.distanceKm,1)||"n/a"," ",Object(o.h)("span",{class:"font-weight-lighter"},"km")),Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-mountain text-muted"})," ",n.a.format(s.elevation,0)||"n/a"," ",Object(o.h)("span",{class:"font-weight-lighter"},"m")),Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-tachometer-alt text-muted"})," ",n.a.format(s.speedAvg,1)||"n/a"," ",Object(o.h)("span",{class:"font-weight-lighter"},"km/t")),Object(o.h)("br",null),Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-clock text-muted"})," ",n.a.secToHms(s.duration)||"n/a"),Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-moon text-muted"})," ",n.a.secToHms(s.rest)||"n/a"),Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-running text-muted"})," ",n.a.secToHms(s.duration-s.rest)||"n/a"),Object(o.h)("br",null),Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-dog text-muted"})," ",n.a.format(s.avgDogs,0)||"n/a")))))):Object(o.h)(t,null,Object(o.h)("div",{class:"bg-light border rounded-lg text-right position-relative px-3 mr-1 mb-1",style:"width: 300px; min-width: 300px;"},Object(o.h)("small",null,I&&Object(o.h)("span",{class:"position-absolute",style:"top: 2px; right: -5px;"},s.isLocked?Object(o.h)("i",{class:"fas fa-lock text-danger"}):Object(o.h)("i",{class:"fas fa-lock-open text-sucess"})),Object(o.h)("span",{class:"float-left"},a+1),Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-road text-muted"})," ",n.a.format(s.distanceKm,1)||"n/a"," ",Object(o.h)("span",{class:"font-weight-lighter"},"km")),Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-tachometer-alt text-muted"})," ",n.a.format(s.speedAvg,1)||"n/a"," ",Object(o.h)("span",{class:"font-weight-lighter"},"km/t")),Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-clock text-muted"})," ",n.a.secToHms(s.duration)||"n/a"))))}))),Object(o.h)("td",{class:"text-right position-relative pl-4"},function(e){switch(e.raceStatus){case"OK":return Object(o.h)(t,null,Object(o.h)("span",{class:"position-absolute rounded-lg",style:"top: 10px; left: 0px;"},Object(o.h)("i",{class:"fas fa-check text-success"})));case"DNS":case"DNF":case"DNQ":case"DQ":return Object(o.h)(t,null,Object(o.h)("span",{class:"position-absolute bg-danger text-white text-center px-2 rounded-lg border",style:"top: 5px; left: -100px; width: 80px"},Object(o.h)("i",{class:"fas fa-info-circle"})," ",e.raceStatus));case"DC":return Object(o.h)(t,null,Object(o.h)("span",{class:"position-absolute bg-warning text-white text-center px-2 rounded-lg border",style:"top: 5px; left: -150px; width: 80px"},Object(o.h)("i",{class:"fas fa-info-circle"})," ",e.raceStatus));default:return""}}(i),i.raceComment&&Object(o.h)(t,null,Object(o.h)("div",{class:"alert alert-warning text-left",role:"alert"},Object(o.h)("i",{class:"fas fa-exclamation-triangle float-left mr-4",style:"font-size: 2.0em;"}),Object(o.h)(b.a,{markdown:f.a.replaceImages(i.raceComment,F.images,T),markdownOpts:f.a.getMarkdownOptions()}))),I&&r.lastUpdated>M&&Object(o.h)(t,null,Object(o.h)("div",{class:"alert alert-danger text-left d-none d-md-block",role:"alert"},Object(o.h)("i",{class:"fas fa-exclamation-triangle float-left mr-4",style:"font-size: 2.0em;"}),Object(o.h)("i",{class:"fas fa-user-shield"})," Last changed: ",n.a.formatDate(r.lastUpdated,{locale:T,hour12:!1,hour:"2-digit",minute:"2-digit"}))),d>=99?Object(o.h)("span",{class:"position-absolute",style:"top: 10px; left: 0px;"},Object(o.h)("i",{class:"fas fa-flag-checkered text-success"})):"",Object(o.h)("small",null,R[i.email]?Object(o.h)(t,null,Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-road text-muted"})," ",n.a.format(r.distanceKm,1)||"n/a"," ",Object(o.h)("span",{class:"font-weight-lighter"},"km")),Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-mountain text-muted"})," ",n.a.format(r.elevation,0)||"n/a"," ",Object(o.h)("span",{class:"font-weight-lighter"},"m")),Object(o.h)("div",{class:"progress mb-1",style:"height: 3px;"},Object(o.h)("div",{class:"progress-bar "+(d>=99?"bg-success":""),role:"progressbar",style:`width: ${d}%`,"aria-valuenow":""+d,"aria-valuemin":"0","aria-valuemax":"100"})),F.nonstop?Object(o.h)(t,null,Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-clock text-muted"})," ",n.a.secToHms(O)||"n/a"),Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-moon text-muted"})," ",n.a.secToHms(g.totalRest)||"n/a"),Object(o.h)("br",null),Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-calendar text-muted"})," ",n.a.isoDate(g.firstEpoch)," - ",Object(o.h)("i",{style:"width: 20px;",class:"fas fa-calendar text-muted"})," ",n.a.isoDate(u)),I&&Object(o.h)(t,null,Object(o.h)("br",null),Object(o.h)("div",{class:"text-danger"},g.firstGpxStartEpoch&&Object(o.h)(t,null,Object(o.h)("nobr",null,"firstGpxStartEpoch: ",n.a.isoDate(g.firstGpxStartEpoch)),Object(o.h)("br",null)),g.lastGpxStartEpoch&&Object(o.h)(t,null,Object(o.h)("nobr",null,"lastGpxStartEpoch: ",n.a.isoDate(g.lastGpxStartEpoch)),Object(o.h)("br",null))))):Object(o.h)(t,null,Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-clock text-muted"})," ",n.a.secToHms(r.duration)||"n/a"),Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-moon text-muted"})," ",n.a.secToHms(r.rest)||"n/a"),Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-running text-muted"})," ",n.a.secToHms(r.duration-r.rest)||"n/a"),Object(o.h)("br",null),1===p&&Object(o.h)(t,null,Object(o.h)("nobr",{class:"font-weight-bold"},Object(o.h)("span",{class:"font-weight-lighter text-muted"},"Normalized to race distance:")," ",Object(o.h)("i",{style:"width: 20px;",class:"fas fa-clock text-muted"})," ",n.a.secToHms(h)||"n/a"),Object(o.h)("br",null)),1===p&&Object(o.h)(t,null,Object(o.h)("nobr",{class:"font-weight-bold"},Object(o.h)("span",{class:"font-weight-lighter text-muted"},"Normalized:")," ",Object(o.h)("i",{style:"width: 20px;",class:"fas fa-clock text-muted"})," ",n.a.secToHms(m)||"n/a"),Object(o.h)("br",null)))):Object(o.h)(t,null,Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-road text-muted"})," ",n.a.format(r.distanceKm,1)||"n/a"," ",Object(o.h)("span",{class:"font-weight-lighter"},"km")),Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-mountain text-muted"})," ",n.a.format(r.elevation,0)||"n/a"," ",Object(o.h)("span",{class:"font-weight-lighter"},"m")),Object(o.h)("div",{class:"progress mb-1",style:"height: 3px;"},Object(o.h)("div",{class:"progress-bar "+(d>=99?"bg-success":""),role:"progressbar",style:`width: ${d}%`,"aria-valuenow":""+d,"aria-valuemin":"0","aria-valuemax":"100"})),F.nonstop?Object(o.h)(t,null,Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-clock text-muted"})," ",n.a.secToHms(O)||"n/a"),Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-moon text-muted"})," ",n.a.secToHms(g.totalRest)||"n/a")):Object(o.h)(t,null,1===p?Object(o.h)(t,null,Object(o.h)("nobr",{class:"font-weight-bold"},Object(o.h)("i",{style:"width: 20px;",class:"fas fa-clock text-muted"})," ",n.a.secToHms(m)||"n/a"),Object(o.h)("br",null)):Object(o.h)(t,null,Object(o.h)("nobr",null,Object(o.h)("i",{style:"width: 20px;",class:"fas fa-clock text-muted"})," ",n.a.secToHms(r.duration)||"n/a"),Object(o.h)("br",null))))))))})))),Object(o.h)("div",{class:"text-center text-muted"},Object(o.h)("small",null,"no"===T&&Object(o.h)(t,null,"OBS! Ref reglene så er det ikke lov til å endre treningsøktene som er med i konkurransen etter at løpet er ferdig.",Object(o.h)("br",null),"Forsøk på dette vil resultere i automatisk deplassering på listene."),"en"===T&&Object(o.h)(t,null,"IMPORTANT! According to the rules: It is NOT allowed to try alter the workouts related to the competition after the race has ended.",Object(o.h)("br",null),"Attempts will result in automatic deplacement on the resultlists."))),I&&Object(o.h)(t,null,Object(o.h)("button",{class:"btn btn-danger btn-lg float-right m-4",onClick:this.lockAllWorkoutsInRace},"Lock all workouts in this race"),Object(o.h)("xmp",{class:"m-5"},JSON.stringify(s,null,4))),Object(o.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2"},Object(o.h)("a",{class:"btn btn-lg btn-block btn-primary",href:`https://homerunrace.no/index#/race/${F.id}/results`},"All results")))))))),a&&Object(o.h)(t,null,Object(o.h)(m.a,{stores:this.props.stores,onCloseClick:this.toggleDrawer},Object(o.h)(O.a,{stores:this.props.stores}))),r&&Object(o.h)(t,null,Object(o.h)(m.a,{stores:this.props.stores,onCloseClick:this.closeDrawerCheckpoint},Object(o.h)(j.a,{stores:this.props.stores,id:c,onClickNav:this.selectCheckpoint}))),h&&Object(o.h)(t,null,Object(o.h)(m.a,{stores:this.props.stores,onCloseClick:this.closeDrawerMusher},Object(o.h)(g.a,{stores:this.props.stores,bib:l,onClickNav:this.selectMusher}))))}})||c;e.a=x}).call(this,s("hosL").Fragment)},yHBq:function(t,e,s){"use strict";(function(t){function a(){return(a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(t[a]=s[a])}return t}).apply(this,arguments)}var i,l,c=s("hosL"),o=s("/eY4"),n=s("Utv1");let r=Object(o.a)(i=class extends c.Component{constructor(t){super(t),this.state={},this.containerRef=null}componentWillUnmount(){const{removeIntersectionObserver:t}=this.props;t&&t(this.containerRef)}componentDidMount(){const{addIntersectionObserver:t}=this.props;t&&t(this.containerRef)}render(){const{wrapperClassNames:t="",contentClassNames:e="",renderContent:s,obj:i={},idx:l,dataFields:o,dataValues:n,sessionid:r}=this.props,d={};return r&&(d.sessionid=r),o.forEach(t=>d["data-"+t]=encodeURI(n[t]||i[t])),Object(c.h)("div",a({class:""+t,ref:t=>this.containerRef=t,"data-idx":l},d),Object(c.h)("div",{class:""+e,style:"display: block;"},s({obj:i,idx:l})))}})||i,d=Object(o.a)(l=class extends c.Component{constructor(t){super(t),this.deleteIntersectionObserver=()=>{this.intersectionObserver=null},this.handleIntersection=t=>{const{handleIntersection:e}=this.props;"function"==typeof e&&e(t),t.forEach(t=>{const{isIntersecting:e}=t,{height:s=0}=t.target.dataset,a=Math.max(t.target.childNodes[0].offsetHeight,t.target.offsetHeight,t.target.scrollHeight);e?(t.target.childNodes[0].style.display="block",t.target.style.minHeight=(a>s?a:s)+"px"):t.target.style.minHeight&&(t.target.style.minHeight=(a>s?a:s)+"px",t.target.childNodes[0].style.display="none")})},this.setupIntersectionObserver=()=>{if(!("IntersectionObserver"in window)||!("IntersectionObserverEntry"in window)||!("intersectionRatio"in window.IntersectionObserverEntry.prototype))return!1;this.intersectionObserver=new IntersectionObserver(this.handleIntersection,{root:null,rootMargin:"100px",threshold:.1})},this.addIntersectionObserver=t=>{this.intersectionObserver&&t&&this.intersectionObserver.observe(t)},this.removeIntersectionObserver=t=>{this.intersectionObserver&&t&&this.intersectionObserver.unobserve(t)},this.state={}}componentWillMount(){this.setupIntersectionObserver()}componentWillUnmount(){this.deleteIntersectionObserver()}render(){const{data:e=[],wrapperClassNames:s="row pb-4 bg-light",contentClassNames:a="col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mb-0 position-relative rounded rounded-lg py-3 shadow-sm",renderContent:i=(()=>Object(c.h)(t,null,"Missing render function!")),dataFields:l=[],dataValues:o={}}=this.props;return Object(c.h)("div",{class:"w-100"},e&&e.filter(t=>n.a.isObject(t)).map((e,n)=>{const d=e.hasOwnProperty("wrapperClassNames")?e.wrapperClassNames:s,h=e.hasOwnProperty("contentClassNames")?e.contentClassNames:a;return Object(c.h)(t,null,Object(c.h)(r,{key:`fastline-${n}-${e.id}`,obj:e,idx:n,addIntersectionObserver:this.addIntersectionObserver,removeIntersectionObserver:this.removeIntersectionObserver,wrapperClassNames:d,contentClassNames:h,renderContent:i,dataFields:l,dataValues:o}))}))}})||l;e.a=d}).call(this,s("hosL").Fragment)},zYNi:function(t,e,s){"use strict";(function(t){function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function i(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){l(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function l(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var c,o,n,r,d=s("hosL"),h=(s("QRet"),s("Utv1")),b=s("/eY4"),m=s("OhSV"),p=(s("Y3FI"),s("fh8t")),u=s.n(p),O=(s("go65"),s("HQo+")),g=s("wanP"),j=s("ZQlJ"),f=s("s4FZ"),y=s("q/oJ"),v=s("cH0S"),w=s("fVsX"),x=s("8n2v"),k=s("gWxU"),S=s("Nanz"),C=s("zUny"),I=(s("bbv7"),s("ukv5")),D=(s("eQ6k"),s("e0EM")),T=s("ZOvn");const R=T.a.marginTop(!0,!1),P=(T.a.marginTopBack(!1),T.a.marginBottom(),T.a.subMenuMarginTop(),{isLoading:!1,email:"",submenu:"ads",jwtToken:h.a.getJwtToken(),reloadInSec:null,reloadIsActive:!1,leaderboardMode:"mushers",filterByraceClass:"",showLeaderBoard:!0,showNews:!0});let E=Object(b.a)(c=class extends d.Component{constructor(t){super(t),this.initComponent=()=>{this.setState({reloadIsActive:!0},()=>this.tickReloadTimeer())},this.tickReloadTimeer=()=>{const{reloadLastEpoch:t}=this.props,{reloadIsActive:e}=this.state;if(e){const e=Math.floor((new Date).getTime()/1e3);this.setState({reloadInSec:60-(e-t)}),clearTimeout(this.updateTimer.tick),this.updateTimer.tick=setTimeout(()=>this.tickReloadTimeer(),1e3)}return!1},this.state=i({},P),this.updateTimer={}}componentDidMount(){this.initComponent()}componentWillUnmount(){clearTimeout(this.updateTimer.tick)}render(){const{reloadInSec:e}=this.state,{radius:s=13,fontSize:a=11,classNames:i=""}=this.props,l=Math.floor(h.a.normalizeBetween(e,0,60,0,100));return Object(d.h)(t,null,Object(d.h)("span",{class:i},Object(d.h)(g.a,{key:"gauge-reload-page",color:"primary",radius:s,showPercentText:!1,percent:l,showCenterText:!0,centerText:e,centerTextSize:a,centerTextY:"55%"})))}})||c,F=Object(b.a)(o=class extends d.Component{constructor(t){super(t),this.chooseSubmenu=t=>{const e=t.target.closest("button").dataset.submenu;this.setState({submenu:e})},this.state={}}render(){const{raceStore:e,userStore:s}=this.props.stores,{submenu:a="details"}=this.state,{waypoints:i}=e,{raceClass:l={},race:c={},onMarkerClick:o=(()=>{})}=this.props;return Object(d.h)(t,null,Object(d.h)("div",{class:"d-flex justify-content-center align-items-center mb-2"},Object(d.h)("span",{style:"font-size: 1.3em;"},Object(d.h)(m.c,{id:"races.gps-ranking"},"GPS Ranking"),": ",c.title," - ",l.title)),Object(d.h)("div",{class:"w-100 overflow-auto",style:"max-height: 60vh;"},!i||0===i.length&&Object(d.h)(t,null,Object(d.h)("div",{class:"text-center text-muted"},Object(d.h)("div",{class:"display-1"},Object(d.h)("i",{class:"fas fa-dog"})),Object(d.h)("div",{class:"w-100"},Object(d.h)("h3",null,Object(d.h)(m.c,{id:"races.no-teams-found"},"No teams found!")),Object(d.h)(m.c,{id:"races.loading-teams"},"Loading teams...")),Object(d.h)("div",{class:"spinner-border text-primary",style:"width: 3rem; height: 3rem;",role:"status"},Object(d.h)("span",{class:"sr-only"},"Loading...")))),Object(d.h)("table",{class:"table table-sm table-striped"},i&&i.map((e,s)=>{const a=h.a.format(e.restTime/e.raceTime*100,0);T.a.displayNameShort(e);return Object(d.h)(t,null,Object(d.h)("tr",{onClick:()=>o(e)},Object(d.h)("td",{style:"width: 15px;",class:"text-center"},e.rank),Object(d.h)("td",null,Object(d.h)("div",{class:"d-flex justify-content-between align-items-start w-100"},Object(d.h)("div",{class:"flex-grow-1"},Object(d.h)("div",{class:"float-right ml-2"},Object(d.h)("div",{class:"text-center"},Object(d.h)(g.a,{key:"gauge-reload-page",color:a<40?a<30?"danger":"warning":"success",radius:30,showPercentText:!1,percent:a,showCenterText:!0,centerText:a+"%",centerTextSize:15,centerTextY:"55%"}))),Object(d.h)("div",{class:"float-right"},e.finishTime<9999999999?Object(d.h)(t,null,Object(d.h)("i",{class:"fas fa-flag-checkered text-success"})):Object(d.h)(t,null,"rest"===e.currentState?Object(d.h)(t,null,Object(d.h)("i",{class:"fas fa-bed text-warning"})):Object(d.h)(t,null,Object(d.h)("i",{class:"fas fa-running text-primary"})))),Object(d.h)("span",{class:"text-white rounded-pill-left px-2 mr-2",style:`background-color: ${T.a.getRankingColor(e.rank||s+1)};`},e.bib),e.flag,"  ",e.title,Object(d.h)("div",null,Object(d.h)("small",null,e.finishTime<9999999999?Object(d.h)(t,null,e.diffToFirstFinishTime>0?Object(d.h)(t,null,Object(d.h)("span",{class:"text-muted"},Object(d.h)("i",{class:"fas fa-arrow-up"}))," ",h.a.secToHms(e.diffToFirstFinishTime)):Object(d.h)(t,null,Object(d.h)("span",{class:"text-muted"},Object(d.h)("i",{class:"fas fa-flag-checkered"}))," ",h.a.formatDate(h.a.parseInputDate(e.finishTime),{locale:"no-NB",hour12:!1,hour:"2-digit",minute:"2-digit"})),Object(d.h)("nobr",null,Object(d.h)("i",{class:"fas fa-running text-muted"})," ",h.a.secToHms(e.raceTime)),Object(d.h)("nobr",null,Object(d.h)("i",{class:"fas fa-bed ml-2 text-muted"})," ",h.a.format(e.restTime/e.raceTime*100,0),"%")):Object(d.h)(t,null,Object(d.h)("nobr",null,Object(d.h)("span",{class:"text-muted"},Object(d.h)("i",{class:"fas fa-flag-checkered"}))," ",h.a.format(e.distanceToFinish,1)," km"),e.distanceToFinish!==e.distanceToFirst&&e.distanceToFirst>0&&Object(d.h)(t,null,Object(d.h)("nobr",null,Object(d.h)("span",{class:"text-muted font-weight-light ml-2"},"1st:")," ",h.a.format(e.distanceToFirst,1)," km")),e.distanceToFinish!==e.distanceToForward&&e.distanceToForward>0&&Object(d.h)(t,null,Object(d.h)("nobr",null,Object(d.h)("span",{class:"text-muted ml-2"},Object(d.h)("i",{class:"fas fa-arrow-up"}))," ",h.a.format(e.distanceToForward,1)," km")),e.distanceToBehind>0&&Object(d.h)(t,null,Object(d.h)("nobr",null,Object(d.h)("span",{class:"text-muted ml-2"},Object(d.h)("i",{class:"fas fa-arrow-down"}))," ",h.a.format(e.distanceToBehind,1)," km")),Object(d.h)("br",null),Object(d.h)("nobr",null,Object(d.h)("span",{class:"text-muted"},Object(d.h)("i",{class:"fas fa-tachometer-alt"}))," ",h.a.format((e.currentAvgSpeed?3.6*e.currentAvgSpeed:e.speed)||0,1)," km/h"),Object(d.h)("nobr",null,Object(d.h)("i",{class:"fas fa-running ml-2 text-muted"})," ",h.a.secToHms(e.raceTime)),Object(d.h)("nobr",null,Object(d.h)("i",{class:"fas fa-bed ml-2 text-muted"})," ",h.a.format(e.restTime/e.raceTime*100,0),"%")))))),Object(d.h)("div",{class:"mt-1 container-fluid"},Object(d.h)(I.a,{stores:this.props.stores,states:e.states,duration:e.raceTime,key:"state-"+e.bib,height:"6px",showText:!1})))))}))))}})||o,L=Object(b.a)(n=class extends d.Component{constructor(t){super(t),this.toggleAdminInfo=t=>{t.stopPropagation();const{showAdminInfo:e}=this.state;this.setState({showAdminInfo:!e})},this.toggleInfo=t=>{t.stopPropagation();const{showInfo:e}=this.state;this.setState({showInfo:!e})},this.onDogClick=(t,e,s)=>{t.preventDefault(),t.stopPropagation();const a=s.find(t=>t.uuidv4===e);return this.setState({currentDog:a,showDog:e,dogs:s}),!1},this.chooseSubmenu=t=>{const e=t.target.closest("button").dataset.submenu;this.setState({submenu:e})},this.state={}}render(){const{raceStore:e,userStore:s}=this.props.stores,{showAdminInfo:a,submenu:i="details",showDog:l,currentDog:c={}}=this.state,{wpData:o={},onMarkerClick:n=(()=>{})}=this.props,r=e.findWaypointByBib(o.bib),{isAdmin:b}=s,{user:p={}}=s,O=(o.bib?e.getMusherByBibId(o.bib):e.getMusherByBibEmail(o.email))||{},g=e.getTeamById(O.team),y=g.members?g.members.find(t=>t.email===O.email):{},v=(e.getClassByBib(o.bib),e.getTotalsByTeamId(O.team)),w=T.a.getImage({user:y,team:g,priority:"user",fallback:O.image1}),x=T.a.displayNameShort(y)||T.a.displayNameShort(O),k=T.a.getRankingColor(r.rank),S=T.a.hasBirthday(c.birth),C=c.birth?Math.ceil(T.a.daysUntilNextBirthday(c.birth)):365,{inFront:I,behind:R}=e.findNearestMushers(o.bib),P=(h.a.format(r.restTime/r.raceTime*100,0),g&&g.imageHeader&&g.imageHeader.s3XXLargeLink?g.imageHeader:{s3XXLargeLink:O.topImage1||"./assets/homerun-race-logo.png"}),E=g&&g.images?[...g.images]:[];for(let t=0,e=3;t<e;t+=1)O["image"+t]&&E.push({s3SmallLink:O["image"+t],s3LargeLink:O["image"+t]});g.members&&g.members.indexOf(p.id),g.followers&&g.followers.indexOf(p.id),g.followRequests&&g.followRequests.findIndex(t=>t.id===p.id),Math.floor((new Date).getTime()/1e3);return Object(d.h)(t,null,R.bib&&Object(d.h)("button",{class:"btn btn-link text-primary mx-2 py-0 float-right",onClick:()=>n(R),style:"line-height: 1.0em; font-size: 2.0em;"},Object(d.h)("i",{class:"fas fa-angle-right"})),I.bib&&Object(d.h)("button",{class:"btn btn-link text-primary mx-2 py-0 float-right",onClick:()=>n(I),style:"line-height: 1.0em; font-size: 2.0em;"},Object(d.h)("i",{class:"fas fa-angle-left"})),Object(d.h)("div",{class:"d-flex justify-content-center align-items-center mb-2"},Object(d.h)("span",{style:"font-size: 1.3em; height: 16vh;"}," ")),Object(d.h)("div",{class:"w-100 overflow-auto",style:"max-height: 55vh;"},Object(d.h)("div",{class:"w-100 position-absolute",style:"z-index: -1; height: 18vh; top: 0px; left: 0px; background-size: cover; background-repeat: no-repeat; background-position: 50% 30%; background-color: #a0a0a0; "+(P?`background-image: url("${P.s3XXLargeLink}");`:"")}),Object(d.h)("div",{class:"d-flex position-relative"},Object(d.h)("div",{class:"position-relative text-center border rounded-circle imageRounded imageRoundedMedium",style:w?`background-image: url("${w}"); background-size: cover;`:""},!w&&Object(d.h)("div",{class:"text-muted",style:"font-size: 25px; padding-top: 5px;"},x),Object(d.h)("div",{class:`rounded-pill-both px-2 text-center position-absolute ${k?"":"bg-secondary"} font-weight-bold`,style:"bottom: -20px; right: 0; "+(k?`background-color: ${k};`:"")},O.bib&&"n/a"!==O.bib&&Object(d.h)(t,null,O.bib))),Object(d.h)("div",{class:"flex-grow-1 pl-3 text-overflow mb-3",style:"line-height: 1.8em;"},Object(d.h)("div",{class:"float-right",style:"font-size: 1.2em;"},r.finishTime<9999999999?Object(d.h)(t,null,Object(d.h)("i",{class:"fas fa-flag-checkered text-success"})):Object(d.h)(t,null,"rest"===r.currentState?Object(d.h)(t,null,Object(d.h)("i",{class:"fas fa-bed text-warning"})):Object(d.h)(t,null,Object(d.h)("i",{class:"fas fa-running text-primary"})))),Object(d.h)("h3",{class:"mb-0"},O.flag," ",O.firstname," ",O.lastname),Object(d.h)("h6",{class:"mb-0"},O.sportsClub||Object(d.h)(t,null," ")))),Object(d.h)("div",{class:"d-flex justify-content-center mb-3"},Object(d.h)("div",{class:"col px-0 pt-2"},Object(d.h)("button",{type:"button",class:`btn btn-block rounded-pill-left rounded-none ${"details"===i?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;",onClick:this.chooseSubmenu,"data-submenu":"details"},"Details")),Object(d.h)("div",{class:"col px-0 pt-2"},Object(d.h)("button",{type:"button",class:`btn btn-block rounded-none ${"team"===i?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;",onClick:this.chooseSubmenu,"data-submenu":"team"},"Team")),Object(d.h)("div",{class:"col px-0 pt-2"},Object(d.h)("button",{type:"button",class:`btn btn-block rounded-pill-right rounded-none ${"dogs"===i?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;",onClick:this.chooseSubmenu,"data-submenu":"dogs"},"Dogs"))),Object(d.h)("div",{class:"w-100 overflow-auto position-relative"},"details"===i&&Object(d.h)(t,null,Object(d.h)(D.a,{stores:this.props.stores,wp:r,musher:O})),"team"===i&&Object(d.h)(t,null,g.public>0?Object(d.h)(t,null,Object(d.h)("h3",null,g.name),Object(d.h)(u.a,{markdown:T.a.replaceImages(g.description,g.images),markdownOpts:T.a.getMarkdownOptions()}),Object(d.h)(f.a,{stores:this.props.stores,images:E})):Object(d.h)(t,null,Object(d.h)("div",{class:"text-center text-muted"},Object(d.h)("div",{class:"display-1"},Object(d.h)("i",{class:"fas fa-dog"})),Object(d.h)("h3",null,Object(d.h)(m.c,{id:"teams.no-public-team"},"No public team!")),Object(d.h)(m.c,{id:"teams.no-public-team"},"This team is not publicly visible."),E&&Object(d.h)("div",{class:"my-3"},Object(d.h)(f.a,{stores:this.props.stores,images:E}))))),"dogs"===i&&Object(d.h)(t,null,g.public>0?Object(d.h)(t,null,g.dogs&&Object(d.h)("div",{class:"w-100 container-fluid"},Object(d.h)("div",{class:"row pt-2"},Object(d.h)(j.a,{stores:this.props.stores,dogs:g.dogs.map(t=>t.id),allDogs:g.dogs,onDogClick:this.onDogClick}))),l&&Object(d.h)(t,null,Object(d.h)("div",{class:"d-flex mb-0 mt-3 position-relative"},Object(d.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedLarge text-muted pt-2",style:c.image?`background-image: url("${c.image.s3LargeLink}"); background-size: cover;`:""},!c.image&&Object(d.h)("span",{class:"font-weight-lighter",style:"font-size: 35px;"},h.a.ucfirst(c.name,!0))),Object(d.h)("div",{class:"flex-grow-1 pl-3 pr-2",style:`border-right: 4px solid ${s.findHarness(c.harness,"colorNonstop")} !important; line-height: 1.2em;`},Object(d.h)("h5",{class:"mb-1"},c.shortname||c.name," ",c.shortname&&""!==c.shortname&&Object(d.h)(t,null," - ",Object(d.h)("span",{class:"font-weight-lighter"},c.name)),S&&Object(d.h)(t,null,Object(d.h)("i",{class:"fas fa-birthday-cake ml-3"}))),Object(d.h)("div",null,C<7&&Object(d.h)(t,null,Object(d.h)("span",{class:"text-muted mr-2"},Object(d.h)("i",{class:"fas fa-birthday-cake"})," in ",C," days")),c.birth&&Object(d.h)("span",{class:"mr-2"},h.a.age(c.birth,c.deceased)),"female"===c.gender?Object(d.h)("i",{class:"fas fa-venus"}):Object(d.h)("i",{class:"fas fa-mars"})))))):Object(d.h)(t,null,Object(d.h)("div",{class:"text-center text-muted"},Object(d.h)("div",{class:"display-1"},Object(d.h)("i",{class:"fas fa-dog"})),Object(d.h)("h3",null,Object(d.h)(m.c,{id:"teams.no-public-team"},"No public team!")),Object(d.h)(m.c,{id:"teams.no-public-team"},"This team is not publicly visible.")))),b&&Object(d.h)("div",{style:"max-height: 200px; max-width: 70vw; overflow: auto;"},Object(d.h)("button",{class:"btn btn-link btn-block",onClick:this.toggleAdminInfo},"Toggle admin info"),a&&Object(d.h)(t,null,Object(d.h)("small",null,Object(d.h)("xmp",null,"musher: ",JSON.stringify(O,null,4),Object(d.h)("br",null),"user: ",JSON.stringify(y,null,4),Object(d.h)("br",null),"team: ",JSON.stringify(g,null,4),Object(d.h)("br",null),"totals: ",JSON.stringify(v,null,4),Object(d.h)("br",null))))))))}})||n,M=Object(b.a)(r=class extends d.Component{constructor(t){var e;super(t),e=this,this.handleHistoryPointIndex=t=>{const e=parseInt(t.target.value,10);clearTimeout(this.updateTimer.reload),this.setState({historyPointIndex:e,timerRunning:!1},()=>{const{historyPointIndex:t}=this.state,{raceStore:e}=this.props.stores;e.updateWaypointPosition(Math.abs(t))})},this.playHistory=()=>{clearTimeout(this.updateTimer.reload);const{historyPointIndex:t,replaySpeed:e}=this.state,{raceStore:s}=this.props.stores,a=s.getRaceTrackerTimestamp(t+1),l={historyPointIndex:t+1,timerRunning:!1,playingHistory:!0};a&&(l.raceTrackerPointTimestamp=a),this.setState(i({},l),()=>{s.updateWaypointPosition(Math.abs(t+1))}),clearTimeout(this.updateTimer.history),this.updateTimer.history=setTimeout(()=>{this.playHistory()},1e3*e)},this.pauseHistory=()=>{clearTimeout(this.updateTimer.history),this.setState({playingHistory:!1})},this.loadLiveRaceResults=async function(t=e.props,{teamIds:s,focusOnMushers:a,bibs:i,classid:l,historySteps:c}){const{raceStore:o,userStore:n}=t.stores,{race:r}=o,{replayHistory:d,timerRunning:h}=e.state,{showDrawerReplay:b}=e.props,m=o.getClassById(l)||{},{isAdmin:p}=n;await o.getRaceTrackerData(r.raceTrackerRace,{historySteps:c,history:d||b,bibs:i,classid:l,startDate:m.startDate,endDate:m.endDate,isAdmin:p}),o.getRaceTrackerActiveTeams(s,a,i),h&&(clearTimeout(e.updateTimer.reload),e.updateTimer.reload=setTimeout(()=>{console.log("loadLiveRaceResults.reloading...");const t=Math.floor((new Date).getTime()/1e3);e.setState({reloadLastEpoch:t}),e.loadLiveRaceResults(e.props,{teamIds:s,focusOnMushers:a,bibs:i,classid:l,historySteps:c})},6e4))},this.loadRaceResults=async function(t=e.props,s,a){const{raceStore:i}=t.stores,{raceid:l}=t,{timerRunning:c}=e.state;await i.loadWorkoutSummary(s,l),i.getWorkoutSummaryActiveTeams(s,a),c&&(clearTimeout(e.updateTimer.reload),e.updateTimer.reload=setTimeout(()=>{const t=Math.floor((new Date).getTime()/1e3);e.setState({reloadLastEpoch:t}),e.loadRaceResults(e.props,s,a)},6e4))},this.loadRace=async function(t=e.props){try{e.setState({isLoading:!0});const{raceStore:s,appState:a}=t.stores,{raceid:i,classid:l,filterByBibs:c,historySteps:o}=t;await s.load(i),s.getAllClassesSortedBy();const{race:n}=s,{focusOnMushers:r}=a,{selectedClassIds:d=[]}=a,h=null==n?void 0:n.classes.map(t=>t.id);let b=l||d[0];-1===h.indexOf(b)&&(b=h[0],a.setSelectedClassId(b)),l&&a.toggleSelectedClassId(l,!0);const m=n.classes.filter(t=>t.id===b).filter(t=>t.contestants&&t.contestants.length>0).map(t=>t.contestants.filter(t=>t.team>0).map(t=>t.team)).flat(),p=c||n.classes.filter(t=>t.id===b).filter(t=>t.contestants&&t.contestants.length>0).map(t=>t.contestants.filter(t=>t.bib>0).map(t=>t.bib)).flat();m.length>0&&await s.loadTeams(m.join(","),!1,!0,!0),n.liveRace>0?await e.loadLiveRaceResults(e.props,{teamIds:m,focusOnMushers:r,bibs:p,classid:b,historySteps:o}):await e.loadRaceResults(e.props,m,r),e.setState({isLoading:!1})}catch(t){console.log(t)}},this.setLeaderboardMode=t=>{this.setState({leaderboardMode:t.target.parentElement.dataset.mode||t.target.dataset.mode})},this.chooseRaceClass=t=>{this.setState({filterByraceClass:t.target.value})},this.toggleShowLeaderBoard=t=>{const{showLeaderBoard:e}=this.state;this.setState(!0===t?{showLeaderBoard:!1}:{showLeaderBoard:!e})},this.toggleShowNews=t=>{const{showNews:e}=this.state;this.setState(!0===t?{showNews:!1}:{showNews:!e})},this.closeAllDrawers=()=>{this.setState({showResults:!1,showDrawerCheckpoint:!1,showDrawerMusher:!1})},this.onMarkerClick=t=>{this.closeAllDrawers(),this.setState({showDrawerMusher:!0,wpData:t})},this.onMusherClick=t=>{this.setState({showDrawerMusher:!0,wpData:t})},this.onCpMarkerClick=t=>{if(!t||!t.id)return null;this.closeAllDrawers(),this.setState({selectedCheckpointId:t.id,showDrawerCheckpoint:!0,cpData:t})},this.toggleDrawerMusher=()=>{const{showDrawerMusher:t}=this.state;this.setState({showDrawerMusher:!t})},this.toggleDrawerCheckpoint=()=>{const{showDrawerCheckpoint:t}=this.state;this.setState({showDrawerCheckpoint:!t})},this.toggleResults=()=>{const{showResults:t}=this.state;this.closeAllDrawers(),this.setState({showResults:!t})},this.selectCheckpoint=t=>{this.closeAllDrawers(),this.setState({selectedCheckpointId:t,showDrawerCheckpoint:!0,showDrawerMusher:!1,showDrawer:!1})},this.onTeamClick=(t,e)=>(t.preventDefault(),t.stopPropagation(),this.setState({showTeam:e}),!1),this.hideTeam=()=>{this.setState({showTeam:null})},this.onUserClick=t=>(t.preventDefault(),t.stopPropagation(),!1),this.onDogClick=(t,e,s)=>(t.preventDefault(),t.stopPropagation(),this.setState({showDog:e,dogs:s}),!1),this.hideDog=()=>{this.setState({showDog:null})},this.setReplaySpeed=t=>{const e=t.target.closest("button").dataset.speed;this.setState({replaySpeed:parseFloat(e)})},this.filterByClass=async function(t){try{const s=t.target.closest("button").dataset.id,{showDrawerReplay:a,historySteps:i,filterByBibs:l}=e.props,{replayHistory:c}=e.state;(c||a)&&e.toggleReplayHistory();const{appState:o,raceStore:n}=e.props.stores;n.cleanupMemoryClass(),o.toggleSelectedClassId(s,!0);const{race:r}=n,{focusOnMushers:d}=o,h=r.classes.filter(t=>t.id===s).filter(t=>t.contestants&&t.contestants.length>0).map(t=>t.contestants.filter(t=>t.team>0).map(t=>t.team)).flat(),b=l||r.classes.filter(t=>t.id===s).filter(t=>t.contestants&&t.contestants.length>0).map(t=>t.contestants.filter(t=>t.bib>0).map(t=>t.bib)).flat();e.setState({allTeamIds:h,bibs:b,selectedMusherBib:"",showDrawerCheckpoint:!1,showDrawerMusher:!1,showDrawer:!1}),h.length>0&&await n.loadTeams(h.join(","),!1,!0,!0),r.liveRace>0?await e.loadLiveRaceResults(e.props,{teamIds:h,focusOnMushers:d,bibs:b,classid:s,historySteps:i}):await e.loadRaceResults(e.props,h,d)}catch(t){console.log(t)}},this.toggleFocusOnMusher=t=>{try{const e=t.target.parentElement.dataset.musherid||t.target.dataset.musherid,{appState:s,raceStore:a}=this.props.stores;s.toggleFocusOnMusher(e);const{focusOnMushers:i=[],selectedClassIds:l=[]}=s,c=l[0],{race:o}=a,n=o.classes.filter(t=>t.id===c).filter(t=>t.contestants&&t.contestants.length>0).map(t=>t.contestants.filter(t=>t.bib>0).map(t=>t.bib)).flat();o.liveRace>0?a.getRaceTrackerActiveTeams(null,i,n):a.getWorkoutSummaryActiveTeams(null,i,n)}catch(t){console.log(t)}},this.toggleBib=()=>{try{const{bib:t}=this.state,{appState:e,raceStore:s}=this.props.stores,a=s.getMusherByBibId(t);e.toggleFocusOnMusher(a.id)}catch(t){console.log(t)}},this.checkForEnter=t=>{"Enter"===t.key&&this.toggleBib()},this.toggleReplayHistory=()=>{const{replayHistory:t}=this.state;clearTimeout(this.updateTimer.reload),this.setState({showDrawer:!1,historyPointIndex:0,replayHistory:!t,timerRunning:t},(async function(){await e.loadRace();const{historyPointIndex:s}=e.state,{raceStore:a}=e.props.stores,{maxPoints:i}=a;if(t)console.log("toggleReplayHistory: setting to maxPoints",i),a.updateWaypointPosition(Math.abs(i-1));else{console.log("toggleReplayHistory: setting to first points");for(let t=0,e=10;t<e;t+=1)a.updateWaypointPosition(Math.abs(s+t))}}))},this.toggleLines=()=>{const{showLines:t}=this.state;this.setState({showLines:!t})},this.state=i(i({},P),{},{reloadLastEpoch:Math.floor((new Date).getTime()/1e3),historyPointIndex:0,timerRunning:!0,replayHistory:!1,replaySpeed:1}),this.updateTimer={}}componentWillUnmount(){clearTimeout(this.updateTimer.reload),clearTimeout(this.updateTimer.history),clearTimeout(this.updateTimer.tick)}componentDidMount(){this.loadRace();try{const{width:t}=function(){const{innerWidth:t,innerHeight:e}=window;return{width:t,height:e}}();t<800&&(this.toggleShowLeaderBoard(!0),this.toggleShowNews(!0))}catch(t){console.log(t)}}componentWillReceiveProps(t){this.props.classid===t.classid&&this.props.showDrawerReplay===t.showDrawerReplay||this.loadRace(t)}render(){const{historyPointIndex:e,timerRunning:s,playingHistory:a,replaySpeed:i,raceTrackerPointTimestamp:l,showLines:c,allTeamIds:o}=this.state,{userStore:n,raceStore:r,appState:b}=this.props.stores,{user:m={},teams:p=[],isAdmin:g}=n,{language:j="en"}=m,{raceid:f,showHeader:I=!0,drawerClassNames:D,drawerWidth:P,showDrawerReplay:M,largeMarkers:A,isAnimatedMarkers:$,linkBase:N="/app-races/"}=this.props,{focusOnMushers:B=[],infoOnMushers:z=[],selectedClassIds:H=[]}=b,{reloadLastEpoch:U,showDrawerMusher:V,showDrawerCheckpoint:q,wpData:K={},cpData:W={},showResults:Y,showTeam:G,showDog:Z,replayHistory:J,selectedCheckpointId:Q}=this.state,{waypoints:X,geoJSONs:_,zoomToMarkers:tt,race:et,maxPoints:st}=r,at=K.bib?r.getMusherByBibId(K.bib):r.getMusherByBibEmail(K.email),it=r.getTeamById(at.team),lt=r.getClassById(H[0])||{};let ct=[];lt.waypoints&&lt.waypoints.length>0?ct=lt.waypoints:lt.checkpoints&&lt.checkpoints.length>0&&(ct=lt.checkpoints.slice().filter(t=>t.position&&t.position[0]).map(t=>({id:t.id,title:t.name,lat:t.position[0],lng:t.position[1]})));let ot=!0;if(et.countryRegexp&&m&&m.currentLocationGeocode){new RegExp(et.countryRegexp,"i").test(m.currentLocationGeocode.formattedCountry)&&(ot=!1)}return Object(d.h)(t,null,G&&Object(d.h)(y.a,null,Object(d.h)(k.default,{stores:this.props.stores,teamid:G,marginTop:"0px;",marginBottom:"0px;",back:this.hideTeam,hideTeam:this.hideTeam})),Z&&Object(d.h)(y.a,null,Object(d.h)(S.default,{stores:this.props.stores,dogid:Z,marginTop:"0px;",marginBottom:"0px;",back:this.hideDog,dogs:it.dogs})),I&&Object(d.h)(w.a,{height:R},Object(d.h)("div",{class:"d-flex justify-content-between align-items-center w-100"},Object(d.h)("div",{class:"d-flex align-items-center"},Object(d.h)("span",{class:"",style:"font-size: 2.3em;"},Object(d.h)("a",{href:`${N}${et.id}`},Object(d.h)("i",{class:"fas fa-angle-left"}))),Object(d.h)("span",{class:"ml-4 text-primary",style:"font-size: 1.4em;",onClick:this.toggleResults},Object(d.h)("i",{class:"fas fa-list-ol"})),Object(d.h)("span",{class:"ml-4 text-primary",style:"font-size: 1.4em;"},!et.resultsHide&&Object(d.h)("a",{href:`${N}${et.id}/results`},Object(d.h)("i",{class:"fas fa-stopwatch"})))),Object(d.h)("div",null,Object(d.h)("span",{class:"font-weight-normal text-white",style:"font-size: 1.2em;"},et.title)),et.liveRace>0?Object(d.h)(t,null,Object(d.h)("div",{class:"d-flex align-items-center text-primary",onClick:this.toggleReplayHistory},Object(d.h)("span",{class:""},"Replay"),Object(d.h)("span",{class:"ml-2",style:"font-size: 1.4em;"},Object(d.h)("i",{class:"fas fa-play"})))):Object(d.h)(t,null,Object(d.h)("div",{class:"d-flex align-items-center"}," "))),Object(d.h)("div",{class:"w-100 overflow-hidden"},Object(d.h)("div",{class:"d-flex flex-row flex-nowrap pb-2 px-1",style:"overflow: auto; scroll-snap-type: x mandatory;"},et.classes&&et.classes.map((e,s)=>Object(d.h)(t,null,Object(d.h)("div",{class:"col px-0 pt-0"},Object(d.h)("button",{type:"button",class:`btn btn-block ${T.a.getPillClass(et.classes.length,s)} rounded-none ${H.indexOf(e.id)>-1?"btn-primary":"btn-outline-primary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;",onClick:this.filterByClass,"data-id":e.id},e.title))))))),ot?Object(d.h)(t,null,Object(d.h)("div",{class:"container-fluid position-relative p-0 w-100 h-100",style:`margin-top: ${I?R:0};`},et.id?Object(d.h)(t,null,Object(d.h)(O.a,{marginTop:R,stores:this.props.stores,raceid:f,waypoints:X,geoJSONs:c?_:null,waypoints2:ct,zoomToMarkers:tt,fullscreenMap:!0,onMarkerClick:this.onMarkerClick,onMarker2Click:this.onCpMarkerClick,showHeatmap:et.liveRace<1,allTeamIds:o,showTracks:et.liveRace>=1,selectedClassIds:H,showDistanceMarkers:!1,groupWaypoints:!1,focusOnMushers:B,largeMarkers:A,isAnimatedMarkers:$,replaySpeed:1e3*i})):Object(d.h)(t,null,Object(d.h)(x.a,{stores:this.props.stores})),s&&Object(d.h)("div",{class:"position-absolute",style:"top: 125px; left: 5px; z-index: 9999; width: 30px; height: 30px;"},Object(d.h)(E,{stores:this.props.stores,classNames:"float-right ml-2",reloadLastEpoch:U})),B&&B.length>0&&Object(d.h)(t,null,Object(d.h)("div",{class:"row mb-2",style:' background-color: #1C1F4C; background-image: url("https://themusher.app/assets/tv-single-background.jpg"); background-size: cover !important; background-position: 0 0; border-radius: 10px; '},Object(d.h)("div",{class:"col-12 text-white",style:"font-size: 1.3em;"},B&&B.map(e=>{const s=r.getMusherById(e);return Object(d.h)(t,null,Object(d.h)("div",null,Object(d.h)("nobr",null,Object(d.h)("span",{class:"mr-2",onClick:this.toggleFocusOnMusher,"data-musherid":s.id},B.indexOf(s.id)>-1?Object(d.h)("i",{class:"fas fa-times text-warning"}):Object(d.h)("i",{class:"far fa-star"})),Object(d.h)("span",{class:"text-right",style:"width: 50px; display: inline-block;"},s.bib)," ",s.flag," ",s.firstname," ",s.lastname,Object(d.h)("br",null))))})))),et.mapCredits&&Object(d.h)(t,null,Object(d.h)("div",{class:"position-absolute",style:"bottom: 30px; left: 7px; z-index: 9999; width: 100px; height: 40px;"},Object(d.h)(u.a,{markdown:T.a.replaceImages(et.mapCredits,et.images),markdownOpts:T.a.getMarkdownOptions()}))),(M||J)&&Object(d.h)(t,null,Object(d.h)(v.a,{stores:this.props.stores,onCloseClick:this.toggleReplayHistory,classNames:D,width:P},st>0?Object(d.h)(t,null,Object(d.h)("div",{class:"d-flex justify-content-center mx-3"},a?Object(d.h)(t,null,Object(d.h)("div",{class:"pl-1"},Object(d.h)("button",{class:"btn btn-warning",onClick:this.pauseHistory},Object(d.h)("i",{class:"fas fa-pause"})))):Object(d.h)(t,null,Object(d.h)("div",{class:"pl-1"},Object(d.h)("button",{class:"btn btn-success",onClick:this.playHistory},Object(d.h)("i",{class:"fas fa-play"})))),Object(d.h)("div",{class:"pl-2 pt-2 flex-grow-1"},Object(d.h)("input",{type:"range",class:"custom-range w-100",min:0,max:st,value:e,onInput:this.handleHistoryPointIndex}))),Object(d.h)("div",{class:"d-flex justify-content-center"},Object(d.h)("div",{class:"col px-0 pt-2"},Object(d.h)("button",{type:"button",class:`btn btn-block rounded-pill-left rounded-none ${1===i?"btn-secondary":"btn-outline-secondary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;",onClick:this.setReplaySpeed,"data-speed":1},"60x")),Object(d.h)("div",{class:"col px-0 pt-2"},Object(d.h)("button",{type:"button",class:`btn btn-block rounded-none ${.5===i?"btn-secondary":"btn-outline-secondary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;",onClick:this.setReplaySpeed,"data-speed":.5},"120x")),Object(d.h)("div",{class:"col px-0 pt-2"},Object(d.h)("button",{type:"button",class:`btn btn-block rounded-none ${.25===i?"btn-secondary":"btn-outline-secondary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;",onClick:this.setReplaySpeed,"data-speed":.25},"240x")),Object(d.h)("div",{class:"col px-0 pt-2"},Object(d.h)("button",{type:"button",class:`btn btn-block right rounded-none ${.12===i?"btn-secondary":"btn-outline-secondary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;",onClick:this.setReplaySpeed,"data-speed":.12},"480x")),Object(d.h)("div",{class:"col px-0 pt-2"},Object(d.h)("button",{type:"button",class:`btn btn-block rounded-pill-right rounded-none ${.05===i?"btn-secondary":"btn-outline-secondary"} text-nowrap`,style:"text-overflow: ellipsis; overflow: hidden;",onClick:this.setReplaySpeed,"data-speed":.05},"1000x"))),Object(d.h)("div",{class:"d-flex justify-content-center"},Object(d.h)("div",{class:"flex-grow-1 pt-0 font-weight-bolder text-center",style:"font-size: 1.1em;"},l&&Object(d.h)(t,null,h.a.formatDate(h.a.parseInputDate(l),{locale:"no-NB",hour12:!1,hour:"2-digit",minute:"2-digit"})),g&&Object(d.h)(t,null,"/ ",e)),g&&Object(d.h)(t,null,Object(d.h)("button",{class:"btn btn-danger mt-2 mr-4 rounded-pill-both rounded-none",onClick:this.toggleLines},Object(d.h)("i",{class:"fas fa-wave-square"})," Show lines")))):Object(d.h)(t,null,Object(d.h)("div",{class:"spinner-border text-primary",role:"status"},Object(d.h)("span",{class:"sr-only"},"Loading..."))))),Y&&Object(d.h)(t,null,Object(d.h)(v.a,{stores:this.props.stores,onCloseClick:this.toggleResults,classNames:D,width:P},Object(d.h)(F,{stores:this.props.stores,raceClass:lt,race:et,onMarkerClick:this.onMusherClick}))),V&&Object(d.h)(t,null,Object(d.h)(v.a,{stores:this.props.stores,onCloseClick:this.toggleDrawerMusher,classNames:D,width:P},Object(d.h)(L,{stores:this.props.stores,wpData:K,onMarkerClick:this.onMarkerClick,onTeamClick:this.onTeamClick,onUserClick:this.onUserClick,onDogClick:this.onDogClick}))),q&&Object(d.h)(t,null,Object(d.h)(v.a,{stores:this.props.stores,onCloseClick:this.toggleDrawerCheckpoint},Object(d.h)(C.a,{stores:this.props.stores,id:Q,onClickNav:this.selectCheckpoint}))))):Object(d.h)(t,null,Object(d.h)("div",{class:"container-fluid position-relative p-0 w-100 h-100",style:`margin-top: ${I?R:0};`},Object(d.h)("div",{class:"text-center text-muted"},Object(d.h)("div",{class:"display-1"},Object(d.h)("i",{class:"fas fa-hand-paper"})),Object(d.h)("h3",null,"Not allowed to view tracking"),et.countryRegexpMessage))))}})||r;e.a=M}).call(this,s("hosL").Fragment)}}]);
//# sourceMappingURL=route-app-races.chunk.4fd09.esm.js.map