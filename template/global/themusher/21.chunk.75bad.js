(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{ISGx:function(t,e,s){"use strict";(function(t){function o(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,o)}return s}function a(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?o(Object(s),!0).forEach((function(e){n(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function n(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var i,r=s("hosL"),l=s("Utv1"),c=s("/eY4"),d=s("cneo"),u=s("OhSV"),h=s("fh8t"),m=s.n(h),b=s("Y3FI"),f=s("s4FZ"),p=s("ZQlJ"),O=s("sqi2"),g=s("/922"),j=s("eQ6k"),v=s("+JSK"),k=s("vY+r"),w=s("nHdA"),x=s("irB3"),y=s("UwwE"),C=s("8Lgr"),T=s("QkTp"),S=s("ZOvn"),D={showAddComment:{},likeWorkout:{},idxSuggestion:0,idxAd:4,limit:15,offset:0,hasFollowSugguestions:!1,hasAd:!1,sessionid:(new Date).getTime()},I=Object(c.a)(i=function(e){function s(t){var s;return(s=e.call(this,t)||this).toggleDate=function(t){t.stopPropagation(),t.preventDefault(),s.setState({showDate:!s.state.showDate})},s.likeWorkout=function(t){return new Promise((function(e,o){var a,n,i,r;return a=parseInt(t.target.closest(".imageContainer").dataset.id,10),n=s.props.stores.workoutStore,(i=s.state.likeWorkout)[a]=!0,s.setState({likeWorkout:i}),setTimeout((function(){var t=s.state.likeWorkout;delete t[a],s.setState({likeWorkout:t})}),1200),Promise.resolve(n.likeWorkout({id:a})).then((function(t){try{return(r=t)&&200===r.status&&s.addLikeToFeed(a,r.data),e()}catch(t){return o(t)}}),o)}))},s.addCommentToFeed=function(t){var e=t.type,o=t.workout,a=t.response,n=t.commentId,i=t.replyId,r=s.props.holdingStore,l=void 0===r?"team":r;if("team"===l){var c=s.props.stores.teamStore;switch(e){case"likeComment":c.addLikeToComment({id:o.id,data:a.data,commentId:n});break;case"likeReply":c.addLikeToCommentReply({id:o.id,data:a.data,commentId:n,replyId:i});break;default:n?c.addCommentToWorkoutComment({id:o.id,data:a.data,commentId:n}):c.addCommentToWorkout({id:o.id,data:a.data})}}else if("story"===l){var d=s.props.stores.storyStore;switch(e){case"likeComment":d.workoutsAddLikeToComment({id:o.id,data:a.data,commentId:n});break;case"likeReply":d.workoutsAddLikeToCommentReply({id:o.id,data:a.data,commentId:n,replyId:i});break;default:n?d.workoutsAddCommentToWorkoutComment({id:o.id,data:a.data,commentId:n}):d.workoutsAddCommentToWorkout({id:o.id,data:a.data})}}},s.addLikeToFeed=function(t,e){var o=s.props.holdingStore,a=void 0===o?"team":o;if("team"===a)s.props.stores.teamStore.addLikeToWorkout({id:t,data:e});else if("story"===a){s.props.stores.storyStore.workoutsAddLikeToWorkout({id:t,data:e})}},s.toggleAddComment=function(t){var e=t.target.closest("button").dataset.id,o=s.state.showAddComment;o[e]?delete o[e]:o[e]=!0,s.setState({showAddComment:o},(function(){s.inputRef[e]&&s.inputRef[e].focus()}))},s.toggleMenu=function(t){var e=t.target.closest("i").dataset.id,o=s.state.showMenu,a=void 0===o?{}:o;a[e]=!a[e],s.setState({showMenu:a})},s.toggleAdminDetails=function(){s.setState({showAdminDetails:!s.state.showAdminDetails}),s.setState({showEdit:{},showMenu:{}})},s.reportWorkout=function(t){return new Promise((function(e,o){var a;return a=t.target.closest("button").dataset.id,Promise.resolve(s.props.stores.teamStore.reportWorkout({id:a})).then((function(){try{return s.setState({showEdit:{},showMenu:{}}),e()}catch(t){return o(t)}}),o)}))},s.adminRemoveWorkout=function(t){return new Promise((function(e,o){var a;return a=t.target.closest("button").dataset.id,Promise.resolve(s.props.stores.teamStore.adminHideWorkout({id:a})).then((function(){try{return s.setState({showEdit:{},showMenu:{}}),e()}catch(t){return o(t)}}),o)}))},s.shareLink=function(t){var e=t.target.closest("button").dataset;s.props.stores.appState.shareUrl({url:e.url,title:e.title,text:e.text})},s.showWorkoutDetail=function(t){if("a"===t.target.localName)return!1;var e=t.target.closest("#workoutDetail");if(e){var s=e.dataset.id;s&&(console.log({target:e,id:s}),Object(b.route)("/workouts/public/"+s))}},s.translate=function(t){return new Promise((function(e,o){var a,n,i,r,l,c,d;return t.preventDefault(),t.stopPropagation(),n=void 0===(a=s.props.feed)?{}:a,r=(i=s.props.stores).teamStore,l=i.userStore.user,Promise.resolve(r.translate({object:n,user:l,field:"name"})).then(function(t){try{if(c=t,n.comment)return Promise.resolve(r.translate({object:n,user:l,field:"comment"})).then(function(t){try{return d=t,a.call(this)}catch(t){return o(t)}}.bind(this),o);function a(){return s.setState({showOriginal:0,translatedTextName:c,translatedTextComment:d}),e()}return a.call(this)}catch(t){return o(t)}}.bind(this),o)}))},s.showOriginal=function(t){t.preventDefault(),t.stopPropagation(),s.setState({showOriginal:1})},s.displayTeam=function(t,e){t.preventDefault(),t.stopPropagation(),s.props.stores.appState.openDrawer("publicTeam",{teamId:e,height:"80vh"})},s.openInbox=function(t,e){t.preventDefault(),t.stopPropagation(),s.props.stores.appState.openDrawer("inboxDetail",{fromuser:e,height:"80vh"})},s.state=a({},D),s.inputRef={},s.containerRef=null,s}var o,n;return n=e,(o=s).prototype=Object.create(n.prototype),o.prototype.constructor=o,o.__proto__=n,s.prototype.render=function(){var e,s=this,o=this.state,n=o.showAddComment,i=o.showDate,c=o.likeWorkout,h=o.showOriginal,b=o.translatedTextName,D=o.translatedTextComment,I=o.showAdminDetails,A=o.showMenu,P=void 0===A?{}:A,W=this.props,R=W.feed,L=W.onTeamClick,M=void 0===L?function(){}:L,F=W.onUserClick,N=void 0===F?function(){}:F,q=W.onDogClick,z=void 0===q?function(){}:q,E=W.holdingStore,U=void 0===E?"team":E,_=this.props.stores,G=_.teamStore,H=_.storyStore,J=_.userStore,K=_.appState,V=J.user,B=J.isAdmin,Q=V.language,Y=void 0===Q?"en":Q,Z=K.hasShareApi,X={},$={};if("team"===U)X=G.findPublicTeam(R.team),$=G.findPublicUser(R.user)||{},e=G.publicDogs;else if("story"===U){X=H.findPublicTeam(R.team),$=H.findPublicUser(R.user)||{},e=H.publicDogs}J.findTeamAmbition({ambition:X.ambitions,language:Y}),J.findTeamType({type:X.type,language:Y});var tt,et,st=!(!X||!X.members)&&X.members.some((function(t){return t===V.id})),ot=S.a.getImage({user:$,team:X,object:R,priority:"user"}),at=R.likes,nt=R.comments,it=R.reports,rt=void 0===it?[]:it,lt=R.likes&&R.likes.findIndex((function(t){return t.user===V.id}))>-1,ct=X.members&&X.members.indexOf(V.id)>-1,dt=X&&X.followers&&X.followers.indexOf(V.id)>-1,ut=X.followRequests&&X.followRequests.findIndex((function(t){return t.id===V.id}))>-1,ht=J.findEquipment({equipment:R.equipment,language:Y}),mt=J.findEquipment({equipment:R.equipment,field:"icon"}),bt=R.gpxInfo,ft=void 0===bt?{}:bt;$&&(S.a.displayNameShort($),S.a.displayName($),tt=S.a.displayName($),$.settings&&$.uuidv4!==V.uuidv4&&(et=$.settings.hideProfile?null:"/inbox/"+$.uuidv4));var pt=[];if(R.mapImage&&pt.push(a(a({},R.mapImage),{},{type:"map"})),R.images){var Ot=Object(d.i)(R.images);pt.push.apply(pt,Ot)}var gt=R.currentLocationGeocode,jt=void 0===gt?{}:gt,vt=S.a.getViews(R.statistics),kt=S.a.getAdminData(R.statistics);if(!X||!X.name)return"";var wt=S.a.getTranslation({object:R,targetLang:Y,field:"name"})||b,xt=wt||R.name,yt=S.a.getTranslation({object:R,targetLang:Y,field:"comment"})||D||R.comment;return h&&(xt=R.name,yt=R.comment),Object(r.h)(t,null,B||V.id===R.user?Object(r.h)(t,null,Object(r.h)("span",{class:"float-right font-weight-lighter text-muted"},Object(r.h)("i",{class:"fas fa-ellipsis-h",onClick:this.toggleMenu,"data-id":R.uuidv4}))):Object(r.h)(t,null,!ct&&!dt&&!ut&&X.public>0&&Object(r.h)("span",{class:"float-right"},Object(r.h)(j.a,{stores:this.props.stores,team:X,buttonOnly:!0,simple:!0,classNames:"btn btn-link text-primary"}))),P[R.uuidv4]&&Object(r.h)(t,null,Object(r.h)("div",{class:"position-absolute bg-light p-2 border rounded rounded-lg shadow-sm",style:"top: 30px; right: 10px; width: 60%; z-index: 999999;"},Object(r.h)("button",{class:"btn btn-link btn-block text-left",onClick:this.reportWorkout,"data-id":R.uuidv4},Object(r.h)("i",{class:"fas fa-flag"})," Report"),B&&Object(r.h)(t,null,Object(r.h)("hr",null),Object(r.h)("button",{class:"btn btn-link btn-block text-left text-danger",onClick:this.adminRemoveWorkout,"data-id":R.id},Object(r.h)("i",{class:"fas fa-eraser"})," Remove from feed")),Object(r.h)("button",{class:"btn btn-link btn-block text-left",onClick:this.toggleAdminDetails},Object(r.h)("i",{class:"fas fa-user-cog"})," Toggle admin details"))),Object(r.h)("div",{class:"d-flex position-relative"},Object(r.h)("div",{class:"text-center"},Object(r.h)("div",{class:"position-relative text-center border rounded-circle imageRounded imageRoundedMedium",style:ot?'background-image: url("'+ot+'"); background-size: cover;':""},!ot&&Object(r.h)("i",{class:"fas fa-users text-muted mt-2",style:"font-size: 20px;"}))),Object(r.h)("div",{class:"flex-grow-1 pl-3 text-overflow",style:"line-height: 1.2em;"},Object(r.h)("h5",{class:"mb-1 position-relative",style:"line-height: 1.0em;"},X.public?Object(r.h)(t,null,Object(r.h)("a",{href:"/teams/public/"+X.uuidv4,onClick:function(t){return s.displayTeam(t,X.uuidv4)},class:"stretched-link"},X.name)):Object(r.h)(t,null,X.name)),Object(r.h)("div",{class:"d-flex flex-row flex-nowrap",style:"overflow: auto;"},R.date&&Object(r.h)("small",{class:"text-muted",onClick:this.toggleDate},i?l.a.formatDate(R.date,{locale:"no-NB",hour12:!1,hour:"2-digit",minute:"2-digit"}):l.a.formatDistance(R.date,new Date,{locale:"no-NB"})),tt&&Object(r.h)(t,null,Object(r.h)("small",{class:"ml-2 text-muted"},et?Object(r.h)(t,null,Object(r.h)("i",{class:"fas fa-user"})," ",Object(r.h)("a",{href:et,onClick:function(t){return s.openInbox(t,$.uuidv4)}},tt)):Object(r.h)(t,null,Object(r.h)("i",{class:"fas fa-user"})," ",tt))),Object(r.h)("small",{class:"text-muted"},R.equipment>0&&Object(r.h)(t,null,Object(r.h)("i",{class:mt+" ml-2"})," ",ht),R.dogs>0&&Object(r.h)(t,null,Object(r.h)("i",{class:"fas fa-dog ml-2"})," ",R.dogs.length),R.track>0&&Object(r.h)(t,null,Object(r.h)("i",{class:"fas fa-map-marked text-"+(R.track>0?"success":"danger")+" ml-2"})),R.sledWeight>0&&Object(r.h)(t,null,Object(r.h)("i",{class:"fas fa-sleigh ml-2"})," ",Object(r.h)(y.a,{stores:this.props.stores,value:R.sledWeight})),0!==R.temperature&&Object(r.h)(t,null,Object(r.h)("i",{class:"fas fa-temperature-low ml-2"})," ",Object(r.h)(T.a,{stores:this.props.stores,value:R.temperature})),R.dogs&&R.dogs.length>0&&Object(r.h)(t,null,Object(r.h)("i",{class:"fas fa-dog ml-2"})," ",l.a.format(R.dogs.length,0)),jt&&jt.formattedCounty&&Object(r.h)(t,null,Object(r.h)("i",{class:"fas fa-map-marker-alt ml-2"})," ",jt.formattedCounty),R.moonIllumination&&R.moonIllumination.phaseIcon&&Object(r.h)("span",{class:"ml-2"},R.moonIllumination.phaseIcon))),I&&B&&Object(r.h)("div",{class:"d-flex flex-row flex-nowrap bg-light border-top border-bottom py-2",style:"overflow: auto;"},Object(r.h)("small",{class:"text-muted mr-2"},"Adm:"),rt&&rt.length>0&&Object(r.h)(t,null,Object(r.h)("small",{class:"text-danger mr-2"},Object(r.h)("i",{class:"fas fa-flag"})," ",rt.length)),jt&&jt.formatted_address&&Object(r.h)(t,null,Object(r.h)("small",{class:"text-muted"},Object(r.h)("i",{class:"fas fa-map-marker-alt"})," ",jt.formatted_address)),$.deviceInfo&&Object(r.h)(t,null,Object(r.h)("span",{class:"badge badge-secondary ml-1 float-right font-weight-light"},["platform","manufacturer","model"].map((function(e){return Object(r.h)(t,null,Object(r.h)("span",{class:"ml-1 text-white"},$.deviceInfo[e]))})))),kt&&Object(r.h)(t,null,Object(r.h)("small",{class:"ml-2 text-muted"},"V: ",kt.count),Object(r.h)("small",{class:"ml-2 text-muted"},"R: ",kt.ranking," ",l.a.isNumber(kt.rankingTrend)&&Object(r.h)(t,null,Object(r.h)("i",{class:S.a.getClassForTrend(kt.rankingTrend)}))),Object(r.h)("small",{class:"ml-2 text-muted"},"D: ",l.a.format(kt.durationAvg/1e3,1),"s ",l.a.isNumber(kt.durationAvgTrend)&&Object(r.h)(t,null,Object(r.h)("i",{class:S.a.getClassForTrend(kt.durationAvgTrend)}))),R.statisticsCurrent&&R.statisticsCurrent.totalInteractions>0&&Object(r.h)("small",{class:"ml-2 text-muted"},"S: ",l.a.format(R.statisticsCurrent.totalInteractions,0)),R.shadowTags&&R.shadowTags.map((function(e){return Object(r.h)(t,null,Object(r.h)("span",{class:"badge badge-secondary ml-2 float-right font-weight-light"},e))})))))),Object(r.h)("div",{class:"container-fluid px-0 mt-1"},Object(r.h)("div",{class:"row"},Object(r.h)(f.a,{stores:this.props.stores,images:pt,id:R.id,dblClick:this.likeWorkout,likeRef:c}))),R.dogs&&R.dogs.length>0&&Object(r.h)("div",{class:"container-fluid px-0 mt-1"},Object(r.h)("div",{class:"row pt-2"},Object(r.h)(p.a,{stores:this.props.stores,dogs:R.dogs,allDogs:e,onDogClick:z}))),Object(r.h)("div",{class:"d-flex justify-content-between bg-light rounded-lg px-2"},R.distanceKm>0&&Object(r.h)("div",{class:"mr-2 text-center"},Object(r.h)("div",{class:"text-overflow text-muted"},Object(r.h)("small",null,Object(r.h)("i",{class:"fas fa-road"})," ",Object(r.h)(u.c,{id:"workout.calendar.distance"},"Distanse"))),Object(r.h)("div",{class:"text-overflow font-weight-light",style:"font-size: 1.2em;"},Object(r.h)(C.a,{stores:this.props.stores,value:R.distanceKm}))),R.elevation>0&&Object(r.h)("div",{class:"mr-2 text-center"},Object(r.h)("div",{class:"text-overflow text-muted"},Object(r.h)("small",null,Object(r.h)("i",{class:"fas fa-mountain"})," ",Object(r.h)(u.c,{id:"workout.calendar.ascend"},"HÃ¸ydemeter"))),Object(r.h)("div",{class:"text-overflow font-weight-light",style:"font-size: 1.2em;"},Object(r.h)(x.a,{stores:this.props.stores,value:R.elevation}))),R.duration>0&&Object(r.h)("div",{class:"mr-2 text-center"},Object(r.h)("div",{class:"text-overflow text-muted"},Object(r.h)("small",null,Object(r.h)("i",{class:"fas fa-clock"})," ",Object(r.h)(u.c,{id:"workout.calendar.duration"},"Varighet"))),Object(r.h)("div",{class:"text-overflow font-weight-light",style:"font-size: 1.2em;"},l.a.secToHms(R.duration,!0))),R.speedAvg>0&&Object(r.h)("div",{class:"text-center"},Object(r.h)("div",{class:"text-overflow text-muted"},Object(r.h)("small",null,Object(r.h)("i",{class:"fas fa-tachometer-alt"})," ",Object(r.h)(u.c,{id:"workout.calendar.avg-speed"},"Snittfart"))),Object(r.h)("div",{class:"text-overflow font-weight-light",style:"font-size: 1.2em;"},ft&&ft.avgGpsMovingSpeed>0?Object(r.h)(t,null,Object(r.h)(w.a,{stores:this.props.stores,value:3.6*ft.avgGpsMovingSpeed})):Object(r.h)(t,null,Object(r.h)(w.a,{stores:this.props.stores,value:R.speedAvg}))))),Object(r.h)("div",{class:"row mt-2"},Object(r.h)("div",{id:"workoutDetail",class:"clearfix col-12 font-weight-bold",style:"font-size: 1.2em;",onClick:this.showWorkoutDetail,"data-id":R.uuidv4},Object(r.h)(m.a,{markdown:S.a.replaceImages(xt,R.images,Y),markdownOpts:S.a.getMarkdownOptions()})),Object(r.h)("div",{class:"clearfix col-12"},Object(r.h)(m.a,{markdown:S.a.replaceImages(yt,R.images,Y),markdownOpts:S.a.getMarkdownOptions()})),R.language!==Y&&Object(r.h)(t,null,!h&&wt?Object(r.h)(t,null,Object(r.h)("button",{type:"button",class:"btn btn-sm btn-link text-muted",onClick:this.showOriginal},Object(r.h)("i",{class:"fas fa-cog"}),"  ",Object(r.h)(u.c,{id:"home.translate-show-original"},"Show original"))):Object(r.h)(t,null,Object(r.h)("button",{type:"button",class:"btn btn-sm btn-link text-muted",onClick:this.translate},Object(r.h)("i",{class:"fas fa-cog"})," ",Object(r.h)(u.c,{id:"home.translate-to"},"See translation"))))),Object(r.h)("div",{class:"mt-2"},Object(r.h)(v.a,{stores:this.props.stores,likes:at,comments:nt,type:"team",onTeamClick:M,onUserClick:N})),!ct&&!dt&&!ut&&Object(r.h)("div",{class:"clearfix mb-2"},Object(r.h)(j.a,{stores:this.props.stores,team:X,buttonOnly:!0})),Object(r.h)("div",null,Object(r.h)("div",{class:"row"},Object(r.h)("div",{class:"col text-center"},Object(r.h)("button",{type:"button",class:"imageContainer btn btn-sm btn-outline-"+(lt?"primary":"secondary")+" btn-lg btn-block "+(lt?"text-primary":"")+" text-overflow","data-id":R.id,onClick:this.likeWorkout},Object(r.h)("i",{class:(lt?"text-primary fas":"far")+" fa-thumbs-up"})," ",Object(r.h)(u.c,{id:"comments.like"},"Lik"))),Object(r.h)("div",{class:"col text-center"},Object(r.h)("button",{type:"button",class:"btn btn-sm btn-outline-secondary btn-lg btn-block text-overflow","data-id":R.id,onClick:this.toggleAddComment},Object(r.h)("i",{class:"fas fa-comment"})," ",Object(r.h)(u.c,{id:"comments.comment-add"},"Kommentar"))),Z?Object(r.h)(t,null,Object(r.h)("div",{class:"col text-center"},Object(r.h)("button",{class:"btn btn-sm btn-outline-secondary btn-lg btn-block text-overflow",onClick:this.shareLink,"data-url":"https://themusher.app/share/workout/"+R.uuidv4,"data-title":"title: "+R.title},Object(r.h)("i",{class:"fas fa-share"})," ",Object(r.h)(u.c,{id:"story.share"},"Del")))):Object(r.h)(t,null,Object(r.h)("div",{class:"col text-center"},Object(r.h)("a",{class:"btn btn-sm btn-outline-secondary btn-lg btn-block text-overflow",href:"https://themusher.app/share/workout/"+R.uuidv4,target:"_blank",rel:"noreferrer","data-native":!0},Object(r.h)("i",{class:"fas fa-share"})," ",Object(r.h)(u.c,{id:"story.share"},"Del")))))),vt>0&&Object(r.h)(t,null,Object(r.h)("div",{class:"mt-2"},Object(r.h)(k.a,{stores:this.props.stores,views:vt,object:R,type:"team",isTeamAdmin:st,isAdmin:B,onTeamClick:M,onUserClick:N}))),Object(r.h)("div",{class:"mt-2"},n[R.id]&&Object(r.h)(g.a,{stores:this.props.stores,workout:R,inputRef:function(t){return s.inputRef[R.id]=t},inputRefObject:this.inputRef,col:"12",offset:"0",showAvatar:!0,extraClass:"px-0",callback:this.addCommentToFeed}),Object(r.h)(O.a,{stores:this.props.stores,workout:R,col:"12",offset:"0",compact:!1,callback:this.addCommentToFeed})))},s}(r.Component))||i;e.a=I}).call(this,s("hosL").Fragment)}}]);
//# sourceMappingURL=21.chunk.75bad.js.map