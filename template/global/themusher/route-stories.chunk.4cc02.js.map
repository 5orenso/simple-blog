{"version":3,"sources":["webpack:///./routes/stories/index.js"],"names":["MARGIN_TOP","mu","marginTop","MARGIN_BOTTOM","marginBottom","initialState","isLoading","submenu","viewmenu","Home","observer","props","reloadFeeds","e","preventDefault","setState","loadStoriesPublicFeed","state","loadAll","appState","this","stores","userStore","getFingerprint","getInfo","getNotifications","user","currentLocationInfo","coords","getWeatherUser","lat","latitude","lon","longitude","altitude","storyStore","loadPublicFeed","story","componentDidMount","render","yrWeather","currentLocationGeocode","place","formatted_address","class","style","url","data","role","href","onClick","id","Component"],"mappings":"8kBAOMA,EAAaC,IAAGC,WAAU,GAC1BC,EAAgBF,IAAGG,eAQnBC,EAAe,CACpBC,WAAW,EACXC,QAAS,eACTC,SAAU,QAILC,EADLC,Y,cAEG,WAAYC,GAAO,aACf,cAAMA,IAAN,MAqBPC,YAAc,SAAOC,GAAP,kCAGb,OAFAA,EAAEC,iBACF,EAAKC,SAAS,CAAET,WAAW,IAC3B,gBAAM,EAAKU,yBAAX,MAAkC,sBAClC,EAAKD,SAAS,CAAET,WAAW,IADO,mCAvB5B,EAAKW,M,+VAAL,IACOZ,GAHQ,E,0HAOhBa,QAAN,0DAGO,OAFEC,GADT,EACiCC,KAAKT,MAAMU,QAAnCF,SAAUG,EADnB,EACmBA,UAClBF,KAAKL,SAAS,CAAET,WAAW,IACrB,gBAAMa,EAASI,kBAAf,KAA+B,eAC/B,uBAAMD,EAAUE,WAAhB,KAAyB,eAC/B,uBAAMF,EAAUG,oBAAhB,KAAkC,sBAE1BC,EAASJ,EAATI,MACCC,qBAAuBD,EAAKC,oBAAoBC,QAExDN,EAAUO,eAAe,CAAEC,KAFqC,EACZJ,EAAKC,oBAAoBC,QAArEG,SACwBC,IAFgC,EACzCC,UACcC,SAF2B,EACzBA,WAGxCd,KAAKL,SAAS,CAAET,WAAW,IAPO,yCADH,qCADM,sCAHtC,a,EAsBMU,sBAAN,SAA4BL,GAA5B,iCAGC,YAHD,IAA4BA,MAAQS,KAAKT,OAGxC,gBAFuBA,EAAMU,OAArBc,WAESC,eADOzB,EAAV0B,QACd,MAAsC,sDAHvC,a,EAMAC,kBAAA,WACClB,KAAKF,W,EAGNqB,OAAA,WAAS,IACAjC,EAAcc,KAAKH,MAAnBX,UACM+B,EAAUjB,KAAKT,MAAf0B,MAENX,EADcN,KAAKT,MAAMU,OAAzBC,UACAI,KACAc,EAA2Cd,EAA3Cc,UALA,EAK2Cd,EAAhCe,uBACQC,QANnB,MAKoC,GALpC,GAMAC,kBAER,OACC,mBAAKC,MAAM,kBAAkBC,MAAK,kBAAoB1C,EAApB,iBAAkDH,EAAlD,KACrB,YAAC,IAAD,CAAIqB,OAAQD,KAAKT,MAAMU,OAAQyB,IAAK1B,KAAKT,MAAMmC,MAC/C,mBAAKF,MAAM,YACP,YAAC,IAAD,CAAWvB,OAAQD,KAAKT,MAAMU,OAAQ0B,KAAMP,EAAWE,MAAOA,KAGlE,YAAC,IAAD,CAAUrB,OAAQD,KAAKT,MAAMU,SAE7B,mBAAKuB,MAAM,gBACP,mBAAKA,MAAM,2EACP,yBACI,yBACI,mBAAKA,MAAM,eACNtC,EAAY,mBACT,mBAAKsC,MAAM,8BAA8BI,KAAK,UAC1C,oBAAMJ,MAAM,WAAZ,gBAEF,mBACF,iBAAGK,KAAK,IAAIJ,MAAM,oBAAoBK,QAAS9B,KAAKR,aAAa,iBAAGgC,MAAM,wBAItF,oBAAMA,MAAM,cACR,iBAAGA,MAAM,eADb,IAC6B,YAAC,IAAD,CAAMO,GAAG,aAAT,cAKzC,YAAC,IAAD,CAAiB9B,OAAQD,KAAKT,MAAMU,OAAQgB,MAAOA,M,GA7EhDe,e,EAmFJ3C,a","file":"route-stories.chunk.4cc02.js","sourcesContent":["import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport { route } from 'preact-router';\n\nimport mu from '../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(false);\nconst MARGIN_BOTTOM = mu.marginBottom();\n\nimport StoryAdd from '../../components/story/add';\nimport StoryPublicFeed from '../../components/story/publicFeed';\nimport StoryPublicDetail from '../../components/story/publicDetail';\nimport Ad from '../../components/ad/';\nimport YrWeather from '../../components/yrweather/';\n\nconst initialState = {\n\tisLoading: false,\n\tsubmenu: 'lastWorkouts',\n\tviewmenu: 'wall',\n};\n\n@observer\nclass Home extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\tasync loadAll() {\n\t\tconst { appState, userStore } = this.props.stores;\n\t\tthis.setState({ isLoading: true });\n        await appState.getFingerprint();\n        await userStore.getInfo();\n\t\tawait userStore.getNotifications();\n\n\t\tconst { user } = userStore;\n\t\tif (user.currentLocationInfo && user.currentLocationInfo.coords) {\n\t\t\tconst { latitude: lat, longitude: lon, altitude } = user.currentLocationInfo.coords;\n\t\t\tuserStore.getWeatherUser({ lat, lon, altitude });\n\t\t}\n\t\tthis.setState({ isLoading: false });\n    }\n\n\treloadFeeds = async (e) => {\n\t\te.preventDefault();\n\t\tthis.setState({ isLoading: true });\n\t\tawait this.loadStoriesPublicFeed();\n\t\tthis.setState({ isLoading: false });\n\t}\n\n\tasync loadStoriesPublicFeed(props = this.props) {\n\t\tconst { storyStore } = props.stores;\n        const { story } = props;\n\t\tawait storyStore.loadPublicFeed(story);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.loadAll();\n\t}\n\n\trender() {\n\t\tconst { isLoading } = this.state;\n        const { story } = this.props;\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { yrWeather, currentLocationGeocode = {} } = user;\n\t\tconst { formatted_address: place } = currentLocationGeocode;\n\n\t\treturn (\n\t\t\t<div class='container-fluid' style={`margin-bottom: ${MARGIN_BOTTOM}; margin-top: ${MARGIN_TOP};`}>\n                <Ad stores={this.props.stores} url={this.props.url} />\n                <div class='bg-light'>\n                    <YrWeather stores={this.props.stores} data={yrWeather} place={place} />\n                </div>\n\n                <StoryAdd stores={this.props.stores} />\n\n                <div class='row bg-light'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 border-bottom'>\n                        <small>\n                            <small>\n                                <div class='float-right'>\n                                    {isLoading ? <>\n                                        <div class='spinner-border text-primary' role='status'>\n                                            <span class='sr-only'>Loading...</span>\n                                        </div>\n                                    </> : <>\n                                        <a href='#' style='font-size: 1.8em;' onClick={this.reloadFeeds}><i class='fas fa-sync-alt' /></a>\n                                    </>}\n                                </div>\n                            </small>\n                            <span class='text-muted'>\n                                <i class='fas fa-rss' /> <Text id='home.wall'>Veggen</Text>\n                            </span>\n                        </small>\n                    </div>\n                </div>\n                <StoryPublicFeed stores={this.props.stores} story={story} />\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Home;\n"],"sourceRoot":""}