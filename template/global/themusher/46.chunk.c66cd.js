(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{LOkn:function(e,t,i){"use strict";function s(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function n(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(Object(i),!0).forEach((function(t){a(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}i.r(t);var o,c,d,l=i("hosL"),p=i("Utv1"),u=i("/eY4"),h=(i("cneo"),i("OhSV")),b=i("Y3FI"),f=(i("go65"),i("ZOvn")),O=i("om2D"),m=i("TiXY"),j=f.a.marginTop(!1),v=f.a.marginTopBack(!1),w=f.a.marginBottom(),y={isLoading:!1},g=Object(u.a)(o=function(e){function t(){for(var t,i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return(t=e.call.apply(e,[this].concat(s))||this).handleImageErrored=function(e){var t=e.target;t.onerror=null,setTimeout((function(){t.src+="?"+new Date}),1e3)},t.removeImage=function(e){return new Promise((function(i){return t.props.stores.newsStore.removeImage({id:t.props.news.id,name:e.target.parentElement.dataset.name||e.target.dataset.name}),i()}))},t.removeMainImage=function(){var e=t.props;(0,e.updateField)({id:e.news.id,field:e.field,value:{}})},t}return r(t,e),t.prototype.render=function(){var e=this,t=this.props,i=t.saved,s=t.news,n=t.type,a=void 0===n?"text":n,r=t.rows,o=t.field,c=t.title,d=t.icon,u=t.help,b=t.onInput,f=t.updateField,j=t.max,v=t.min,w=t.step,y=s[o],g=j;return"date"===a&&(y&&(y=p.a.isoDate(s[o],!1,!1,!0)),"today"===j&&(g=p.a.isoDate(void 0,!1,!1,!0))),"image"===a?Object(l.h)("div",{class:"form-group "+(i[o+"."+s.id]?"is-valid":"")},Object(l.h)("label",{for:o+"Input"},d&&Object(l.h)("i",{class:d+" text-muted"})," ",c),Object(l.h)("div",{class:"container-fluid"},Object(l.h)("div",{class:"row"},s.images&&s.images.map((function(t){return Object(l.h)("div",{class:"col-3 p-1"},Object(l.h)("img",{src:t.s3SmallLink,class:"img-fluid",onError:e.handleImageErrored}),Object(l.h)("button",{class:"btn btn-sm btn-link",onClick:e.removeImage,"data-name":t.name},Object(l.h)("i",{class:"fas fa-trash"})," Del"))})))),Object(l.h)(O.a,{saved:i,object:s,field:o,updateField:f,autoOpen:!1}),i[o+"."+s.id]?Object(l.h)("div",{class:"valid-feedback",style:"display: block;"},Object(l.h)(h.c,{id:"news.changes-saved"},"Endringene er lagret")):Object(l.h)("small",{id:o+"Help",class:"form-text text-muted"},u)):"file"===a?Object(l.h)("div",{class:"form-group "+(i[o+"."+s.id]?"is-valid":"")},Object(l.h)("label",{for:o+"Input"},d&&Object(l.h)("i",{class:d+" text-muted"})," ",c),Object(l.h)(m.a,{saved:i,object:s,field:o,updateField:f}),i[o+"."+s.id]?Object(l.h)("div",{class:"valid-feedback",style:"display: block;"},Object(l.h)(h.c,{id:"news.changes-saved"},"Endringene er lagret")):Object(l.h)("small",{id:o+"Help",class:"form-text text-muted"},u)):"textarea"===a?Object(l.h)("div",{class:"form-group "+(i[o+"."+s.id]?"is-valid":"")},Object(l.h)("label",{for:o+"Input"},d&&Object(l.h)("i",{class:d+" text-muted"})," ",c),Object(l.h)("textarea",{type:a,class:"form-control "+(i[o+"."+s.id]?"is-valid":""),id:o+"Input","aria-describedby":o+"Help",value:y,rows:r,"data-id":s.id,"data-field":o,onInput:b}),i[o+"."+s.id]?Object(l.h)("div",{class:"valid-feedback",style:"display: block;"},Object(l.h)(h.c,{id:"news.changes-saved"},"Endringene er lagret")):Object(l.h)("small",{id:o+"Help",class:"form-text text-muted"},u)):Object(l.h)("div",{class:"form-group "+(i[o+"."+s.id]?"is-valid":"")},Object(l.h)("label",{for:o+"Input"},d&&Object(l.h)("i",{class:d+" text-muted"})," ",c),Object(l.h)("input",{type:a,class:"form-control "+(i[o+"."+s.id]?"is-valid":""),id:o+"Input","aria-describedby":o+"Help",value:y,min:v,max:g,step:w,"data-id":s.id,"data-field":o,onInput:b}),i[o+"."+s.id]?Object(l.h)("div",{class:"valid-feedback",style:"display: block;"},Object(l.h)(h.c,{id:"news.changes-saved"},"Endringene er lagret")):Object(l.h)("small",{id:o+"Help",class:"form-text text-muted"},u))},t}(l.Component))||o,I=Object(u.a)(c=function(e){function t(){for(var t,i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return(t=e.call.apply(e,[this].concat(s))||this).onInput=function(e){t.props.stores.newsStore.updateObjectKeyValue("newNews",t.props.field,e.target.value)},t}return r(t,e),t.prototype.render=function(){var e=this.props,t=e.field,i=e.icon,s=e.title,n=e.help,a=this.props.stores.newsStore.newNews;return Object(l.h)("div",{class:"form-group"},Object(l.h)("label",{for:t+"Input"},i&&Object(l.h)("i",{class:i+" text-muted"})," ",s),Object(l.h)("input",{type:"text",class:"form-control",id:t+"Input","aria-describedby":t+"Help",onInput:this.onInput,value:a[t]}),Object(l.h)("small",{id:t+"Help",class:"form-text text-muted"},n))},t}(l.Component))||c,x=Object(u.a)(d=function(e){function t(t){var i;return(i=e.call(this,t)||this).updateField=function(e){var t=e.target.dataset,s=t.id,n=t.field,a=t.type,r=t.elementtype,o=e.target,c=o.value,d=o.min,l=o.max;"date"===o.type&&d&&l?c>=d&&c<=l&&i.updateFieldValue({id:parseInt(s,10),field:n,value:c,type:a,elementtype:r}):i.updateFieldValue({id:parseInt(s,10),field:n,value:c,type:a,elementtype:r})},i.updateFieldValue=function(e){var t=e.id,s=e.field,n=e.value,a=e.datatype,r=e.elementtype,o=e.skipTimer,c=void 0!==o&&o,d=i.props.stores.newsStore,l=n,p=n,u=d.news;"images"===s&&Array.isArray(u.images)&&Array.isArray(n)&&(p=[].concat(u.images,n)),"array"!==a||Array.isArray(n)||(l="number"===r?n.split(",").map((function(e){return parseFloat(e)||e})):n.split(",")),d.updateField(t,s,p),c?i.doUpdateField(t,s,l):(clearTimeout(i.updateTimer[s]),i.updateTimer[s]=setTimeout((function(){return new Promise((function(e){return i.doUpdateField(t,s,l),e()}))}),500))},i.insertNewNews=function(){return new Promise((function(e,t){var s,a,r;return s=i.props.stores.newsStore,Promise.resolve(s.insert(n({},s.newNews))).then((function(i){try{return a=i,console.log({result:a}),(r=a.data)&&r.id&&Object(b.route)("/news/edit/"+r.id),e()}catch(e){return t(e)}}),t)}))},i.back=function(){var e=i.props.stores.newsStore.news;i.props.createNew?Object(b.route)("/news/"):Object(b.route)("/news/"+e.id)},i.state=n({},y),i.updateTimer={},i}r(t,e);var i=t.prototype;return i.loadNews=function(e){return new Promise(function(t,i){return void 0===e&&(e=this.props),this.setState({isLoading:!0}),Promise.resolve(this.props.stores.newsStore.load(e.id)).then((function(){try{return t()}catch(e){return i(e)}}),i)}.bind(this))},i.doUpdateField=function(e,t,i){return new Promise(function(s,n){return Promise.resolve(this.props.stores.newsStore.saveField(e,t,i)).then((function(){try{return s()}catch(e){return n(e)}}),n)}.bind(this))},i.componentDidMount=function(){this.loadNews()},i.render=function(){var e=this.props.createNew,t=this.props.stores,i=t.newsStore;if(!t.userStore.isAdmin)return"";var s=i.news,n=i.saved;return Object(l.h)("div",{class:"container-fluid",style:"margin-bottom: "+w+"; margin-top: "+j+";"},Object(l.h)("div",{class:"d-flex justify-content-between mb-2"},Object(l.h)("div",null,Object(l.h)("button",{class:"btn btn-link pl-0 fixed-top text-primary",style:"top: "+v+"; left: 5px; font-size: 35px; width: 45px;",onClick:this.back},Object(l.h)("i",{class:"fas fa-arrow-circle-left"}))),Object(l.h)("div",null,Object(l.h)("h5",{class:"text-muted"},"News and howto content")),Object(l.h)("div",null,"Â ")),e?Object(l.h)("div",{class:"row"},Object(l.h)("div",{class:"col-12"},Object(l.h)("h5",null,Object(l.h)(h.c,{id:"news.add-new"},"Lag nytt innhold")),Object(l.h)(I,{stores:this.props.stores,field:"title",icon:"fas fa-heading",title:Object(l.h)(h.c,{id:"news.title"},"Tittel"),help:Object(l.h)(h.c,{id:"news.title-help"},"Title of this news story")}),Object(l.h)(I,{stores:this.props.stores,field:"tag",icon:"fas fa-eye",title:Object(l.h)(h.c,{id:"news.tag"},"Tag"),help:Object(l.h)(h.c,{id:"news.tag-help"},"Tag of this news story"),onInput:this.updateField}),Object(l.h)("button",{type:"button",class:"btn btn-primary mb-2",onclick:this.insertNewNews},"Save news"))):Object(l.h)("div",{class:"row"},Object(l.h)("div",{class:"col-12"},Object(l.h)(g,{saved:n,news:s,field:"title",icon:"fas fa-heading",title:Object(l.h)(h.c,{id:"news.title"},"Title"),help:Object(l.h)(h.c,{id:"news.title-help"},"Title of this news story"),onInput:this.updateField}),Object(l.h)(g,{stores:this.props.stores,saved:n,news:s,field:"date",icon:"fas fa-calendar",type:"date",min:"2010-01-01",max:"today",title:Object(l.h)(h.c,{id:"news.date"},"Dato"),help:Object(l.h)(h.c,{id:"news.date-help"},"Date for this news article. Format is: 'YYYY-MM-DD'."),onInput:this.updateField,updateField:this.updateFieldValue}),Object(l.h)(g,{saved:n,news:s,field:"active",icon:"fas fa-heading",title:Object(l.h)(h.c,{id:"news.active"},"Active"),help:Object(l.h)(h.c,{id:"news.active-help"},"Is this active yet?"),onInput:this.updateField}),Object(l.h)(g,{saved:n,news:s,field:"sort",icon:"fas fa-sort-amount-down",title:Object(l.h)(h.c,{id:"news.sort"},"Sort order"),help:Object(l.h)(h.c,{id:"news.sort-help"},"Highest number on top."),onInput:this.updateField}),Object(l.h)(g,{saved:n,news:s,field:"tag",icon:"fas fa-heading",title:Object(l.h)(h.c,{id:"news.tag"},"Tag"),help:Object(l.h)(h.c,{id:"news.tag-help"},"Tag of this news story"),onInput:this.updateField}),Object(l.h)(g,{saved:n,news:s,field:"ingress",icon:"fas fa-quote-right",type:"textarea",title:Object(l.h)(h.c,{id:"news.ingress"},"Ingress"),help:Object(l.h)(h.c,{id:"news.ingress-help"},"Ingress of this news story"),onInput:this.updateField}),Object(l.h)(g,{saved:n,news:s,field:"body",icon:"fas fa-quote-right",type:"textarea",rows:20,title:Object(l.h)(h.c,{id:"news.body"},"Body"),help:Object(l.h)(h.c,{id:"news.body-help"},"Body of this news story"),onInput:this.updateField}),Object(l.h)(g,{saved:n,news:s,field:"image",type:"image",icon:"fas fa-camera",stores:this.props.stores,title:Object(l.h)(h.c,{id:"news.photo"},"Bilder"),help:Object(l.h)(h.c,{id:"news.photo-help"},"Images for this news story."),onInput:this.updateField,updateField:this.updateFieldValue}))))},t}(l.Component))||d;t.default=x},TiXY:function(e,t,i){"use strict";var s,n=i("hosL"),a=i("/eY4"),r=(i("cneo"),i("Utv1"),i("OhSV")),o=i("u2zT"),c=Object(a.a)(s=function(e){function t(t){var i;return(i=e.call(this,t)||this).handleAddImage=function(e){var t=i.props;(0,t.updateField)({id:t.object.id,field:t.field,value:e})},i.state={files:[]},i}var i,s;return s=e,(i=t).prototype=Object.create(s.prototype),i.prototype.constructor=i,i.__proto__=s,t.prototype.render=function(){var e=this.props,t=e.uploadStatus,i=void 0===t?function(){}:t,s=e.before,a=void 0===s?function(){}:s,c=e.after,d=void 0===c?function(){}:c,l=e.autoOpen,p=void 0!==l&&l;return Object(n.h)("div",{class:"row"},Object(n.h)("div",{class:"col-12"},Object(n.h)(r.c,{id:"form.files.upload-file"},"Last opp fil"),":",Object(n.h)("br",null),Object(n.h)(o.a,{handleAddImage:this.handleAddImage,apiUrl:"/api/fileupload",uploadStatus:i,before:a,after:d,autoOpen:p},Object(n.h)("div",{style:{height:30,width:"100%"}}))))},t}(n.Component))||s;t.a=c}}]);
//# sourceMappingURL=46.chunk.c66cd.js.map