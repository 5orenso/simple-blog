(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"+JSK":function(e,t,s){"use strict";(function(e){function a(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var i,l=s("hosL"),o=s("Utv1"),r=s("/eY4"),c=s("OhSV"),d=s("ZOvn");const h={};let m=Object(r.a)(i=class extends l.Component{constructor(e){super(e),this.toggleLikes=()=>{const{showLikesList:e}=this.state;this.setState({showLikesList:!e})},this.state=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?a(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},h)}render(){const{showLikesList:t}=this.state,{storyStore:s,teamStore:a,workoutStore:n,raceStore:i}=this.props.stores,{likes:r,comments:h,type:m="story",onTeamClick:u=(()=>{}),onUserClick:b=(()=>{})}=this.props;return Object(l.h)(e,null,Object(l.h)("div",{class:"d-flex justify-content-between mb-2"},r&&r.length>0&&Object(l.h)(e,null,Object(l.h)("div",{class:"d-flex flex-row flex-nowrap position-relative mr-3",style:"overflow: auto;"},Object(l.h)("span",{class:"text-muted mr-2",onClick:this.toggleLikes},Object(l.h)("i",{class:"fas fa-thumbs-up text-primary"})," ",r.length),r.slice(0,1).map(t=>{let r,c,h;"story"===m?(r=s.findPublicUser(t.user),c=s.findPublicTeamByMembers(t.user)):"team"===m?(r=a.findPublicUser(t.user),c=a.findPublicTeamByMembers(t.user)):"workout"===m?(r=n.findPublicUser(t.user),c=n.findPublicTeamByMembers(t.user)):"race"===m&&(r=i.findPublicUser(t.user),c=i.findPublicTeamByMembers(t.user)),o.a.isArray(c)&&(h=c.find(e=>1===e.public));d.a.getImage({user:r,team:h,priority:"user"}),d.a.displayNameShort(r);const b=d.a.displayName(r);return Object(l.h)(e,null,Object(l.h)("span",{class:"font-weight-lighter"},h?Object(l.h)(e,null,Object(l.h)("a",{href:"/teams/public/"+h.uuidv4,title:h.name,onClick:e=>u(e,h.uuidv4)},b)):Object(l.h)(e,null,b)))}),r.length>1&&Object(l.h)(e,null,Object(l.h)("span",{class:"text-muted font-weight-lighter ml-2",onClick:this.toggleLikes},Object(l.h)(c.c,{id:"likes-comments.and",fields:{total:r.length-1}},"and ",r.length-1," others."))))),h&&h.length>0&&Object(l.h)("span",{class:"float-right text-muted"},Object(l.h)("i",{class:"fas fa-comment text-primary"})," ",h.length)),t&&Object(l.h)("div",{class:"mt-3 mb-3"},r&&r.map(t=>{let r,c,h;"story"===m?(r=s.findPublicUser(t.user),c=s.findPublicTeamByMembers(t.user)):"team"===m?(r=a.findPublicUser(t.user),c=a.findPublicTeamByMembers(t.user)):"workout"===m?(r=n.findPublicUser(t.user),c=n.findPublicTeamByMembers(t.user)):"race"===m&&(r=i.findPublicUser(t.user),c=i.findPublicTeamByMembers(t.user)),o.a.isArray(c)&&(h=c.find(e=>1===e.public));const b=d.a.getImage({user:r,team:h,priority:"user"}),p=d.a.displayNameShort(r),g=d.a.displayName(r,!0);return Object(l.h)("div",{class:"d-flex flex-row position-relative font-weight-light mb-1"},h?Object(l.h)(e,null,Object(l.h)("a",{href:"/teams/public/"+h.uuidv4,title:h.name,onClick:e=>u(e,h.uuidv4),class:"stretched-link"},Object(l.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedThumb",style:""+(b?`background-image: url("${b}"); background-size: cover;`:"")},!b&&Object(l.h)("div",{class:"",style:"font-size: 12px; padding-top: 3px;"},p))),Object(l.h)("div",{class:"ml-2 "},g," ",Object(l.h)("span",{class:"font-weight-lighter"},"- ",h.name))):Object(l.h)(e,null,Object(l.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedThumb",style:(b?`background-image: url("${b}"); background-size: cover;`:"")+" opacity: 0.5;"},!b&&Object(l.h)("div",{class:"text-muted",style:"font-size: 12px; padding-top: 3px;"},p)),Object(l.h)("div",{class:"ml-2"},g)))})))}})||i;t.a=m}).call(this,s("hosL").Fragment)},"/922":function(e,t,s){"use strict";(function(e){var a,n=s("hosL"),i=s("Utv1"),l=s("/eY4"),o=s("OhSV"),r=s("go65"),c=s("om2D"),d=(s("ETxl"),s("ZOvn"));let h=Object(l.a)(a=class extends n.Component{constructor(e){var t;super(e),t=this,this.beforeImagesUploaded=()=>{this.setState({sendButtonEnabled:!1})},this.afterImagesUploaded=()=>{this.setState({sendButtonEnabled:!0})},this.commentWorkout=async function(){const{sendButtonEnabled:e}=t.state;if(!e)return!1;const{callback:s=(()=>{}),inputRefObject:a={}}=t.props,{workout:n}=t.props,{workoutStore:i}=t.props.stores,{comment:l,showAddImage:o}=t.state;t.setState({sendButtonEnabled:!1});const r=await i.commentWorkout({id:n.id,comment:l});r&&200===r.status&&(t.setState({comment:{body:"",images:[]}},()=>{d.a.resizeTextarea(a[n.id]),o&&t.addImage()}),s({workout:n,response:r})),t.setState({sendButtonEnabled:!0})},this.addImages=({value:e})=>{const{comment:t}=this.state;t.images.push(...e),this.setState({comment:t})},this.addImage=()=>{const{showAddImage:e=!1}=this.state;this.setState({showAddImage:!e})},this.handleImageErrored=e=>{const t=e.target;t.onerror=null,setTimeout(()=>{t.src+="?"+new Date},1e3)},this.state={comment:{body:"",images:[]},showAddImage:!1,sendButtonEnabled:!0},this.inputRef={}}render(){const{inputRef:t,col:s=12,offset:a=0,showAvatar:l=!0,extraClass:h="",workout:m}=this.props,{comment:u,showAddImage:b,sendButtonEnabled:p}=this.state,{userStore:g}=this.props.stores,{user:O={}}=g,f=O.firstname?`${i.a.ucfirst(O.firstname,!0)}${i.a.ucfirst(O.lastname,!0)}`:""+i.a.ucfirst(O.email||"",!0),j=O.image||(O.images?O.images[0]:void 0);return Object(n.h)("div",{class:`col-${s} offset-${a} ${h}`},Object(n.h)("div",{class:"d-flex mb-0 position-relative w-100"},l&&Object(n.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall",style:(j?`background-image: url('${j.s3SmallLink}'); background-size: cover;`:"")+" border-width: 3px !important;"},!O.image&&Object(n.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},f)),Object(n.h)("div",{class:"col pl-3",style:"line-height: 1.2em;"},Object(n.h)("div",{class:"d-flex bd-highlight"},Object(n.h)("div",{class:"p-0 w-100 bd-highlight"},Object(n.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(n.h)(o.c,{id:"comments.comment"},"Kommentar")),Object(n.h)("div",{class:"border rounded rounded-lg position-relative"},Object(n.h)(o.b,null,Object(n.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(n.h)(o.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(r.a)(this,"comment.body"),onKeyUp:d.a.resizeTextarea,onFocus:d.a.resizeTextarea,style:"height: 2.3em;",value:u.body,ref:t})),Object(n.h)("div",{class:"position-absolute",style:"top: 8px; right: 10px; font-size: 1.2em;"},Object(n.h)("i",{class:"fas fa-image pointerCursor","data-id":m.id,onClick:this.addImage})))),Object(n.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(n.h)("button",{type:"button",class:`btn btn-${p?"primary":"secondary"} mb-2`,disabled:!p,onClick:this.commentWorkout},Object(n.h)("i",{class:"fas fa-paper-plane"})))))),b&&Object(n.h)(e,null,Object(n.h)("div",{class:"col-12 text-center"},Object(n.h)("div",{class:"container-fluid"},Object(n.h)("div",{class:"row"},u.images&&u.images.map(e=>Object(n.h)("div",{class:"col-3 p-1"},Object(n.h)("img",{src:e.s3SmallLink,class:"img-fluid",onError:this.handleImageErrored}),Object(n.h)("button",{class:"btn btn-sm btn-link",onClick:this.removeImage,"data-name":e.name},Object(n.h)("i",{class:"fas fa-trash"}),"  ",Object(n.h)(o.c,{id:"comments.remove-image"},"Remove")))))),Object(n.h)(c.a,{object:u,updateField:this.addImages,before:this.beforeImagesUploaded,after:this.afterImagesUploaded,autoOpen:!0}))))}})||a;t.a=h}).call(this,s("hosL").Fragment)},"3wGD":function(e,t,s){"use strict";var a,n=s("hosL"),i=s("Utv1"),l=s("/eY4"),o=s("OhSV"),r=s("go65"),c=(s("ETxl"),s("ZOvn"));let d=Object(l.a)(a=class extends n.Component{constructor(e){var t;super(e),t=this,this.commentWorkout=async function(){const{sendButtonEnabled:e}=t.state;if(!e)return!1;const{callback:s=(()=>{}),commentId:a,inputRefObject:n={}}=t.props,{workout:i}=t.props,{workoutStore:l}=t.props.stores,{comment:o=""}=t.state;t.setState({sendButtonEnabled:!1});const r=await l.commentReplyWorkout({id:i.id,commentId:a,comment:o});r&&200===r.status&&(t.setState({comment:""},()=>{c.a.resizeTextarea(n[a])}),s({workout:i,response:r,commentId:a})),t.setState({sendButtonEnabled:!0})},this.state={sendButtonEnabled:!0},this.inputRef={}}render(){const{inputRef:e}=this.props,{comment:t,sendButtonEnabled:s}=this.state,{userStore:a}=this.props.stores,{user:l={}}=a,d=l.firstname?`${i.a.ucfirst(l.firstname,!0)}${i.a.ucfirst(l.lastname,!0)}`:""+i.a.ucfirst(l.email||"",!0),h=l.image||(l.images?l.images[0]:void 0);return Object(n.h)("div",{class:"w-100"},Object(n.h)("div",{class:"d-flex mb-0 position-relative w-100"},Object(n.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedThumb",style:(h?`background-image: url('${h.s3SmallLink}'); background-size: cover;`:"")+" border-width: 3px !important;"},!h&&Object(n.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},d)),Object(n.h)("div",{class:"col pl-3",style:"line-height: 1.2em;"},Object(n.h)("div",{class:"d-flex bd-highlight"},Object(n.h)("div",{class:"p-0 w-100 bd-highlight"},Object(n.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(n.h)(o.c,{id:"comments.comment"},"Kommentar")),Object(n.h)("div",{class:"border rounded rounded-lg position-relative"},Object(n.h)(o.b,null,Object(n.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(n.h)(o.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(r.a)(this,"comment"),onKeyUp:c.a.resizeTextarea,style:"height: 2.3em;",value:t,ref:e})))),Object(n.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(n.h)("button",{type:"button",class:`btn btn-${s?"primary":"secondary"} mb-2`,disabled:!s,onClick:this.commentWorkout},Object(n.h)("i",{class:"fas fa-paper-plane"})))))))}})||a;t.a=d},"8Lgr":function(e,t,s){"use strict";(function(e){function a(e){return l.a.format(e,e<5?2:1)}var n,i=s("hosL"),l=s("Utv1"),o=s("/eY4");s("OhSV"),s("ZOvn");let r=Object(o.a)(n=class extends i.Component{render(){const{value:t=0,smallUnit:s}=this.props,{userStore:n}=this.props.stores,{user:l}=n,{settings:o={}}=l;return o.imperial?Object(i.h)(e,null,Object(i.h)("nobr",null,a(function(e){return.621371*e}(t))," ",s?Object(i.h)(e,null,Object(i.h)("small",null,Object(i.h)("small",null,Object(i.h)("small",{class:"ml-0 text-muted"},"mi")))):Object(i.h)(e,null,"mi"))):Object(i.h)(e,null,Object(i.h)("nobr",null,a(t)," ",s?Object(i.h)(e,null,Object(i.h)("small",null,Object(i.h)("small",null,Object(i.h)("small",{class:"ml-0 text-muted"},"km")))):Object(i.h)(e,null,"km")))}})||n;t.a=r}).call(this,s("hosL").Fragment)},ETxl:function(e){e.exports={hoverelementonly:"hoverelementonly__1mJGJ",hoverElement:"hoverElement__axh3O",hoverelementhide:"hoverelementhide__1k_qH","progress-bar-vertical":"progress-bar-vertical__1B2sC","progress-bar":"progress-bar__pnsVj",dragged:"dragged__QXO46",over:"over__1re3x",list:"list__q_emZ"}},QkTp:function(e,t,s){"use strict";(function(e){var a,n=s("hosL"),i=s("Utv1"),l=s("/eY4");s("OhSV"),s("ZOvn");let o=Object(l.a)(a=class extends n.Component{render(){const{value:t=0}=this.props,{userStore:s}=this.props.stores,{user:a}=s,{settings:l={}}=a;return l.imperial?Object(n.h)(e,null,Object(n.h)("nobr",null,i.a.format(function(e){return 9*e/5+32}(t),0),"°F")):Object(n.h)(e,null,Object(n.h)("nobr",null,i.a.format(t,1),"°C"))}})||a;t.a=o}).call(this,s("hosL").Fragment)},UwwE:function(e,t,s){"use strict";(function(e){var a,n=s("hosL"),i=s("Utv1"),l=s("/eY4");s("OhSV"),s("ZOvn");let o=Object(l.a)(a=class extends n.Component{render(){const{value:t=0}=this.props,{userStore:s}=this.props.stores,{user:a}=s,{settings:l={}}=a;return l.imperial?Object(n.h)(e,null,Object(n.h)("nobr",null,i.a.format(function(e){return 2.20462*e}(t),0)," lb")):Object(n.h)(e,null,Object(n.h)("nobr",null,i.a.format(t,0)," kg"))}})||a;t.a=o}).call(this,s("hosL").Fragment)},irB3:function(e,t,s){"use strict";(function(e){var a,n=s("hosL"),i=s("Utv1"),l=s("/eY4");s("OhSV"),s("ZOvn");let o=Object(l.a)(a=class extends n.Component{render(){const{value:t=0,smallUnit:s}=this.props,{userStore:a}=this.props.stores,{user:l}=a,{settings:o={}}=l;return o.imperial?Object(n.h)(e,null,Object(n.h)("nobr",null,i.a.format(function(e){return 3.28084*e}(t),0)," ",s?Object(n.h)(e,null,Object(n.h)("small",null,Object(n.h)("small",null,Object(n.h)("small",{class:"ml-0 text-muted"},"ft")))):Object(n.h)(e,null,"ft"))):Object(n.h)(e,null,Object(n.h)("nobr",null,i.a.format(t,0)," ",s?Object(n.h)(e,null,Object(n.h)("small",null,Object(n.h)("small",null,Object(n.h)("small",{class:"ml-0 text-muted"},"m")))):Object(n.h)(e,null,"m")))}})||a;t.a=o}).call(this,s("hosL").Fragment)},nHdA:function(e,t,s){"use strict";(function(e){var a,n=s("hosL"),i=s("Utv1"),l=s("/eY4"),o=s("OhSV");s("ZOvn");let r=Object(l.a)(a=class extends n.Component{render(){const{value:t=0,smallUnit:s}=this.props,{userStore:a}=this.props.stores,{user:l}=a,{settings:r={}}=l;return r.imperial?Object(n.h)(e,null,Object(n.h)("nobr",null,i.a.format(function(e){return.621371*e}(t),1)," ",s?Object(n.h)(e,null,Object(n.h)("small",null,Object(n.h)("small",null,Object(n.h)("small",{class:"ml-0 text-muted"},Object(n.h)(o.c,{id:"workouts.mph"},"mph"))))):Object(n.h)(e,null,Object(n.h)(o.c,{id:"workouts.mph"},"mph")))):Object(n.h)(e,null,Object(n.h)("nobr",null,i.a.format(t,1)," ",s?Object(n.h)(e,null,Object(n.h)("small",null,Object(n.h)("small",null,Object(n.h)("small",{class:"ml-0 text-muted"},Object(n.h)(o.c,{id:"workouts.kmt"},"km/t"))))):Object(n.h)(e,null,Object(n.h)(o.c,{id:"workouts.kmt"},"km/t"))))}})||a;t.a=r}).call(this,s("hosL").Fragment)},om2D:function(e,t,s){"use strict";var a,n=s("hosL"),i=s("/eY4"),l=(s("cneo"),s("Utv1"),s("u2zT"));let o=Object(i.a)(a=class extends n.Component{constructor(e){super(e),this.handleAddImage=e=>{const{addToImages:t=!0}=this.props,{updateField:s,object:a,field:n}=this.props;if(n&&s({id:a.id,field:n,value:e,skipTimer:!0}),t){const t=[];t.push(e),s({id:a.id,field:"images",value:t,skipTimer:!0})}},this.state={files:[]}}render(){const{uploadStatus:e=(()=>{}),before:t=(()=>{}),after:s=(()=>{}),autoOpen:a=!0}=this.props;return Object(n.h)("div",{class:"row"},Object(n.h)("div",{class:"col-12"},Object(n.h)(l.a,{handleAddImage:this.handleAddImage,uploadStatus:e,apiUrl:"/api/fileupload",before:t,after:s,autoOpen:a},Object(n.h)("div",{style:{height:30,width:"100%"}}))))}})||a;t.a=o},sqi2:function(e,t,s){"use strict";(function(e){function a(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var i,l=s("hosL"),o=s("Utv1"),r=s("/eY4"),c=s("cneo"),d=s("OhSV"),h=s("fh8t"),m=s.n(h),u=s("3wGD"),b=(s("ETxl"),s("ZOvn"));const p={showAddComment:{},showAllComments:!1,showAllReplies:{},viewImageIdx:{}};let g=Object(r.a)(i=class extends l.Component{constructor(e){var t;super(e),t=this,this.likeComment=async function(e){const{callback:s=(()=>{})}=t.props,a=e.target.parentElement.dataset.id||e.target.dataset.id,{workout:n}=t.props,{workoutStore:i}=t.props.stores,l=await i.likeWorkoutComment({id:n.id,commentId:a});return l&&200===l.status&&s({type:"likeComment",workout:n,commentId:a,response:l}),!0},this.likeReply=async function(e){const{callback:s=(()=>{})}=t.props,a=e.target.parentElement.dataset.id||e.target.dataset.id,n=e.target.parentElement.dataset.comment||e.target.dataset.comment,{workout:i}=t.props,{workoutStore:l}=t.props.stores,o=await l.likeWorkoutCommentReply({id:i.id,replyId:a,commentId:n});o&&200===o.status&&s({type:"likeReply",workout:i,commentId:n,replyId:a,response:o})},this.replyComment=async function(e){const s=e.target.parentElement.dataset.id||e.target.dataset.id,{showAddComment:a}=t.state;a[s]=!a[s],t.setState({showAddComment:a},()=>{t.inputRef[s]&&t.inputRef[s].focus()})},this.toggleComments=()=>{const{showAllComments:e}=this.state;this.setState({showAllComments:!e})},this.toggleReplies=e=>{const t=e.target.parentElement.dataset.id||e.target.dataset.id,{showAllReplies:s}=this.state;s[t]=!s[t],this.setState({showAllReplies:s})},this.viewImage=e=>{const{id:t,idx:s}=e.target.closest("img").dataset,{viewImageIdx:a}=this.state;a[t]=s,this.setState({viewImageIdx:a})},this.translate=async function(e){e.preventDefault(),e.stopPropagation();const{replyid:s,commentid:a}=e.target.closest("button").dataset,{workout:n}=t.props,{userStore:i,teamStore:l}=t.props.stores,{user:o}=i,{showOriginal:r={},translatedText:c={}}=t.state,d=`${a}${s?"-"+s:""}`;r[d]=0,c[d]=s?await l.translateCommentReply({commentid:a,replyid:s,object:n,user:o}):await l.translateComment({commentid:a,object:n,user:o}),t.setState({showOriginal:r,translatedText:c})},this.showOriginal=e=>{const{replyid:t,commentid:s}=e.target.closest("button").dataset;e.preventDefault(),e.stopPropagation();const{showOriginal:a={}}=this.state;a[`${s}${t?"-"+t:""}`]=1,this.setState({showOriginal:a})},this.state=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?a(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},p),this.inputRef={}}render(){const{showAddComment:t,showAllComments:s,showAllReplies:a,viewImageIdx:n,showOriginal:i={},translatedText:r={}}=this.state,{workout:h,callback:p=(()=>{}),col:g=12,offset:O=0,compact:f=!1}=this.props,{userStore:j,teamStore:v}=this.props.stores,{user:y,isAdmin:w}=j,{language:k="en"}=y;let x,S=[],L=0,C=0;return h.comments&&(L=h.comments.length,s?S=h.comments:(x=f?0:1,S=h.comments.slice(Math.max(L-x,0))),C=S.length),Object(l.h)("div",null,h&&S&&S.reverse().map(s=>{const{user:g={}}=s,O=v.findPublicTeamByMembers(g.id),f=b.a.displayNameShort(g),j=b.a.displayName(g),S=g.image||(g.images?g.images[0]:void 0),L=s.likes&&s.likes.findIndex(e=>e.user===y.id)>-1;let C=[],D=0,P=0;s.comments&&(D=s.comments.length,C=a[s.id]?s.comments:s.comments.slice(0,x),P=C.length);const E=[];if(s.images){const e=Object(c.i)(s.images);E.push(...e)}const I=n[s.id]?n[s.id]:0,T=E&&E[I]?E[I]:null,{currentLocationGeocode:R={}}=s,U=v.getCommentTranslations({object:h,commentid:s.id,targetLang:k})||r[s.id];let F=U||s.comment;return i[s.id]&&(F=s.comment),Object(l.h)("div",{class:"row"},Object(l.h)("div",{class:"col-12 d-flex mb-2 position-relative"},Object(l.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall",style:(S?`background-image: url("${S.s3SmallLink}"); background-size: cover;`:"")+" border-width: 3px !important;"},!g.image&&Object(l.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},f)),Object(l.h)("div",{class:"flex-grow-1 pl-3 pt-0",style:"line-height: 1.2em;"},Object(l.h)("div",{class:"bg-light p-2 rounded rounded-lg"},Object(l.h)("div",null,Object(l.h)("span",{style:"font-size: 0.95em;"},Object(l.h)("h5",{class:"font-weight-bold mb-0",style:"font-size: 1.0em;"},j),O&&O.length>0&&Object(l.h)("div",{class:"mb-2"},Object(l.h)("small",{class:"font-weight-lighter text-muted"},O.filter(e=>1===e.public).slice(0,2).map(t=>Object(l.h)(e,null,Object(l.h)("a",{href:"/teams/public/"+t.uuidv4,class:"mr-2"},Object(l.h)("i",{class:"fas fa-users text-muted"})," ",t.name))))),Object(l.h)(m.a,{markdown:b.a.replaceImages(F,s.images,k),markdownOpts:b.a.getMarkdownOptions()}))),Object(l.h)("div",{class:"container-fluid px-3 mt-1"},T&&Object(l.h)("div",{class:"clearfix row"},Object(l.h)("div",{class:"col-12 px-0 overflow-hidden",style:"max-height: 30vh;"},Object(l.h)("img",{loading:"lazy",class:"img-fluid",style:"min-width: 100px;",src:T.s3LargeLink}))),E&&E.length>1&&Object(l.h)("div",{class:"clearfix d-flex flex-wrap row"},E.map((t,a)=>Object(l.h)(e,null,Object(l.h)("div",{class:"col px-0 overflow-hidden",style:"max-height: 100px; min-width: 100px;"},Object(l.h)("img",{loading:"lazy",class:"img-fluid border",style:"min-width: 100px;",src:t.s3SmallLink,onClick:this.viewImage,"data-id":s.id,"data-idx":a}))))))),Object(l.h)("small",null,Object(l.h)("button",{class:"btn btn-sm btn-link py-0 "+(L?"text-primary":""),onClick:this.likeComment,"data-id":s.id},Object(l.h)(d.c,{id:"comments.like"},"Lik")),"-",Object(l.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.replyComment,"data-id":s.id},Object(l.h)(d.c,{id:"comments.comment-add"},"Kommentar")),s.language!==k&&Object(l.h)(e,null,"-",!i[s.id]&&U?Object(l.h)(e,null,Object(l.h)("button",{type:"button",class:"btn btn-sm btn-link","data-commentid":s.id,onClick:this.showOriginal},Object(l.h)("i",{class:"fas fa-cog"}),"  ",Object(l.h)(d.c,{id:"home.translate-show-original"},"Show original"))):Object(l.h)(e,null,Object(l.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:this.translate,"data-commentid":s.id},Object(l.h)("i",{class:"fas fa-cog"})," ",Object(l.h)(d.c,{id:"home.translate-to"},"See translation")))),"-",Object(l.h)("button",{class:"btn btn-sm btn-link py-0 disabled"},o.a.formatDistance(s.createdDate,new Date,{locale:"no-NB"}),s.updatedDate&&Object(l.h)(e,null,Object(l.h)("span",{class:"font-weight-light ml-2"},"(Edited ",o.a.formatDistance(s.updatedDate,new Date,{locale:"no-NB"}),")"))),w&&R&&R.formatted_address&&Object(l.h)(e,null,Object(l.h)("span",{class:"ml-2 text-muted"},Object(l.h)("i",{class:"fas fa-map-marker-alt"})," ",R.formatted_address)))),s.likes&&s.likes.length>0&&Object(l.h)("small",{class:"position-absolute bg-light shadow-sm rounded-lg py-0 px-1",style:"bottom: 20px; right: 15px;"},Object(l.h)("i",{class:"fas fa-thumbs-up text-primary"})," ",s.likes.length)),Object(l.h)("div",{class:"col-11 offset-1 mb-2"},s&&C&&C.map(t=>{const{user:a={}}=t,n=v.findPublicTeamByMembers(a.id),c=a.firstname?`${o.a.ucfirst(a.firstname,!0)}${o.a.ucfirst(a.lastname,!0)}`:""+o.a.ucfirst(a.email||"",!0),u=a.firstname?`${a.firstname} ${a.lastname}`:""+a.email,p=a.image||(a.images?a.images[0]:void 0),g=t.likes&&t.likes.findIndex(e=>e.user===y.id)>-1,O=v.getCommentReplyTranslations({object:h,commentid:s.id,replyid:t.id,targetLang:k})||r[`${s.id}-${t.id}`];let f=O||t.comment;return i[`${s.id}-${t.id}`]&&(f=t.comment),Object(l.h)("div",{class:"row"},Object(l.h)("div",{class:"col-12 d-flex mb-2 position-relative"},Object(l.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedThumb",style:(p?`background-image: url("${p.s3SmallLink}"); background-size: cover;`:"")+" border-width: 3px !important;"},!a.image&&Object(l.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},c)),Object(l.h)("div",{class:"flex-grow-1 pl-3 pt-0",style:"line-height: 1.2em;"},Object(l.h)("div",{class:"bg-light p-2 rounded-lg"},Object(l.h)("span",{style:"font-size: 0.95em;"},Object(l.h)("h5",{class:"font-weight-bold mb-0",style:"font-size: 1.0em;"},u),n&&n.length>0&&Object(l.h)("div",{class:"mb-2"},Object(l.h)("small",{class:"font-weight-lighter text-muted"},n.filter(e=>1===e.public).slice(0,2).map(t=>Object(l.h)(e,null,Object(l.h)("a",{href:"/teams/public/"+t.uuidv4,class:"mr-2"},Object(l.h)("i",{class:"fas fa-users text-muted"})," ",t.name))))),Object(l.h)(m.a,{markdown:b.a.replaceImages(f,t.images,k),markdownOpts:b.a.getMarkdownOptions()}))),Object(l.h)("small",null,Object(l.h)("button",{class:"btn btn-sm btn-link py-0 "+(g?"text-primary":""),onClick:this.likeReply,"data-comment":s.id,"data-id":t.id},Object(l.h)(d.c,{id:"comments.like"},"Lik")),"-",Object(l.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.replyComment,"data-id":s.id},Object(l.h)(d.c,{id:"comments.comment-add"},"Kommentar")),t.language!==k&&Object(l.h)(e,null,"-",!i[`${s.id}-${t.id}`]&&O?Object(l.h)(e,null,Object(l.h)("button",{type:"button",class:"btn btn-sm btn-link","data-commentid":s.id,"data-replyid":t.id,onClick:this.showOriginal},Object(l.h)("i",{class:"fas fa-cog"}),"  ",Object(l.h)(d.c,{id:"home.translate-show-original"},"Show original"))):Object(l.h)(e,null,Object(l.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:this.translate,"data-commentid":s.id,"data-replyid":t.id},Object(l.h)("i",{class:"fas fa-cog"})," ",Object(l.h)(d.c,{id:"home.translate-to"},"See translation")))),"-",Object(l.h)("button",{class:"btn btn-sm btn-link py-0 disabled"},o.a.formatDistance(t.createdDate,new Date,{locale:"no-NB"})))),t.likes&&Object(l.h)("small",{class:"position-absolute bg-light shadow-sm rounded-lg py-0 px-1",style:"bottom: 20px; right: 15px;"},Object(l.h)("i",{class:"fas fa-thumbs-up text-primary"})," ",t.likes.length)))}),D-P>0&&Object(l.h)("div",null,Object(l.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.toggleReplies,"data-id":s.id},Object(l.h)(d.c,{id:"comments.show-more",fields:{more:D-P}},"Vis ",D-P," flere kommentarer...")))),t[s.id]&&Object(l.h)("div",{class:"col-11 offset-1 d-flex mb-2 position-relative"},Object(l.h)(u.a,{stores:this.props.stores,workout:h,callback:p,commentId:s.id,inputRef:e=>this.inputRef[s.id]=e,inputRefObject:this.inputRef})))}),L-C>0&&Object(l.h)("div",null,Object(l.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.toggleComments},Object(l.h)(d.c,{id:"comments.show-more",fields:{more:L-C}},"Vis ",L-C," flere kommentarer..."))),s&&Object(l.h)("div",null,Object(l.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.toggleComments},Object(l.h)(d.c,{id:"comments.hide-all-comments"},"Skjul alle kommentarene."))))}})||i;t.a=g}).call(this,s("hosL").Fragment)},u2zT:function(e,t,s){"use strict";var a,n=s("hosL"),i=s("/eY4"),l=s("Utv1"),o=s("OhSV");let r=Object(i.a)(a=class extends n.Component{constructor(e){super(e),this.dropRef=Object(n.createRef)(),this.handleDrag=e=>{e.preventDefault(),e.stopPropagation()},this.handleDragIn=e=>{e.preventDefault(),e.stopPropagation(),this.dragCounter++,e.dataTransfer.items&&e.dataTransfer.items.length>0&&this.setState({drag:!0})},this.handleDragOut=e=>{e.preventDefault(),e.stopPropagation(),this.dragCounter--,0===this.dragCounter&&this.setState({drag:!1})},this.handleDrop=e=>{if(e.preventDefault(),e.stopPropagation(),this.setState({drag:!1}),e.dataTransfer.files&&e.dataTransfer.files.length>0){for(let t=0,s=e.dataTransfer.files.length;t<s;t+=1){this.readLocalFile(e.dataTransfer.files[t])}this.dragCounter=0}},this.handleAddFiles=e=>{e.preventDefault();const t=e.target;for(let e=0,s=t.files.length;e<s;e+=1){this.readLocalFile(t.files[e])}},this.handleEvent=()=>{0},this.handleUpload=e=>{const{uploadStatus:t=(()=>{}),before:s=(()=>{}),after:a=(()=>{})}=this.props;t(!1),l.a.isFunction(s)&&s();const n=new FormData;n.append("files[]",e);const i={progress:1};i.xhr=new XMLHttpRequest,i.xhr.upload.addEventListener("progress",t=>{this.updateProgress(t,e)}),i.xhr.addEventListener("loadstart",t=>{this.handleEvent(t,e)}),i.xhr.addEventListener("load",t=>{this.handleEvent(t,e)}),i.xhr.addEventListener("loadend",t=>{const s=e;l.a.isFunction(a)&&a(),this.handleEvent(t,s)}),i.xhr.addEventListener("progress",t=>{this.handleEvent(t,e)}),i.xhr.addEventListener("error",t=>{this.handleEvent(t,e)}),i.xhr.addEventListener("abort",t=>{this.handleEvent(t,e)}),i.xhr.addEventListener("readystatechange",t=>{this.uploadDone(t,e)}),i.xhr.open("POST",`${l.a.getApiServer()}${this.props.apiUrl}`),i.xhr.setRequestHeader("Authorization","Bearer "+l.a.getJwtToken()),i.xhr.send(n);const o=e.name,r=this.state.uploadedFilesData;r[o]||(r[o]={}),r[o].uploadMeta=i,r[o].imageNum=this.state.imageNum,this.setState({uploadedFilesData:r})},this.readLocalFile=e=>new Promise((t,s)=>{const a=new FileReader;a.addEventListener("error",e=>{s(e)}),a.addEventListener("load",s=>{const a=e,n=a.name,i=this.state.uploadedFilesData;i[n]||(i[n]={}),i[n].event=s,this.setState({uploadedFilesData:i}),this.handleUpload(a),t(s)}),a.readAsDataURL(e)}),this.updateProgress=(e,t)=>{if(e.lengthComputable){const s=t.name,a=this.state.uploadedFilesData,n=e.loaded/e.total*100;0,a[s].uploadMeta.progress=n,this.setState({uploadedFilesData:a})}},this.uploadDone=(e,t)=>{const s=t.name,a=this.state.uploadedFilesData,n=a[s].uploadMeta;if(n&&4===n.xhr.readyState&&201===n.xhr.status){const e=JSON.parse(n.xhr.responseText).data.files;for(let t=0;t<e.length;t+=1){this.addFileToUpload(e[t]),this.fileInput.value=""}}},this.state={drag:!1,loadingProgress:0,uploadedFiles:[],uploadedFilesData:{}}}addFileToUpload(e){const{uploadedFilesData:t}=this.state,{handleAddImage:s,uploadStatus:a=(()=>{})}=this.props;delete t[e.name],this.setState({uploadedFilesData:t}),s(e),a(!0)}componentDidMount(){const e=this.dropRef.current;e.addEventListener("dragenter",this.handleDragIn),e.addEventListener("dragleave",this.handleDragOut),e.addEventListener("dragover",this.handleDrag),e.addEventListener("drop",this.handleDrop);const{autoOpen:t}=this.props;t&&setTimeout(()=>{this.fileInput.click()},10)}componentWillUnmount(){const e=this.dropRef.current;e.removeEventListener("dragenter",this.handleDragIn),e.removeEventListener("dragleave",this.handleDragOut),e.removeEventListener("dragover",this.handleDrag),e.removeEventListener("drop",this.handleDrop)}render(){const{uploadedFilesData:e}=this.state;return Object(n.h)("div",{style:{position:"relative"},ref:this.dropRef},this.state.drag&&Object(n.h)("div",{style:{border:"dashed grey 4px",backgroundColor:"rgba(255,255,255,.8)",position:"absolute",top:0,bottom:0,left:0,right:0,zIndex:9999}},Object(n.h)("div",{style:{position:"absolute",top:"50%",right:0,left:0,textAlign:"center",color:"grey",fontSize:36}},Object(n.h)("div",null,Object(n.h)(o.c,{id:"imageupload.drag-files-here"},"drop your files here :)")))),Object(n.h)("div",null,Object(n.h)("input",{class:"btn btn-info col-sm-12",multiple:!0,type:"file",id:"image-file",onchange:this.handleAddFiles,ref:e=>{this.fileInput=e}})),Object(n.h)("div",null,Object.keys(e).length>0?Object(n.h)("h3",null,Object(n.h)(o.c,{id:"imageupload.upload-images"},"Uploaded images")):"",Object(n.h)("ul",{class:"list-group"},Object.keys(e).map(t=>{const{uploadMeta:s={}}=e[t],a=t.match(/(jpg|jpeg|png|gif|heic|heif|svg|webp|tif)/i);return Object(n.h)("li",{class:"list-group-item list-group-item-action flex-column align-items-start"},Object(n.h)("div",{class:"d-flex w-100 justify-content-between"},a&&Object(n.h)("img",{class:"img-fluid mr-3",src:e[t].event.target.result,style:"max-height: 50px;"}),Object(n.h)("small",null,e[t].event.uploadDone),Object(n.h)(o.c,{id:"imageupload.uploading-image"},"Laster opp bilde..."),Object(n.h)("small",null,l.a.formatBytes(e[t].event.total,2))),Object(n.h)("div",{class:"progress mt-1",style:"height: 4px;"},Object(n.h)("div",{class:"progress-bar progress-bar-striped progress-bar-animated bg-success",role:"progressbar",style:`width: ${s.progress}%; height: 4px;`,"aria-valuenow":s.progress,"aria-valuemin":"0","aria-valuemax":"100"})))}))),this.props.children)}})||a;t.a=r},"vY+r":function(e,t,s){"use strict";(function(e){function a(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var i,l=s("hosL"),o=s("Utv1"),r=s("/eY4"),c=s("OhSV"),d=s("ZOvn");const h={};let m=Object(r.a)(i=class extends l.Component{constructor(e){super(e),this.toggleViews=()=>{const{showViewList:e}=this.state,{isTeamAdmin:t,isAdmin:s}=this.props;(t||s)&&this.setState({showViewList:!e})},this.state=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?a(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},h)}render(){const{showViewList:t}=this.state,{storyStore:s,teamStore:a,workoutStore:n}=this.props.stores,{views:i,object:r,type:h="story",onTeamClick:m=(()=>{}),onUserClick:u=(()=>{})}=this.props,b=[];Object.entries(r.statistics).forEach(([e,t])=>{Object.entries(t).forEach(([e,t])=>{t.viewUsers&&b.push(t.viewUsers)})});const p=b.flat().slice(0,50);return Object(l.h)(e,null,Object(l.h)("div",{class:"d-flex justify-content-end mb-2"},Object(l.h)("span",{class:"ml-2 text-muted font-weight-lighter",onClick:this.toggleViews},i," ",Object(l.h)(c.c,{id:"story.views"},"views"))),t&&Object(l.h)("div",{class:"mt-3 mb-3"},p&&p.map(t=>{let i,r,c;if("story"===h?(i=s.findPublicUser(t),r=s.findPublicTeamByMembers(t)):"team"===h?(i=a.findPublicUser(t),r=a.findPublicTeamByMembers(t)):"workout"===h&&(i=n.findPublicUser(t),r=n.findPublicTeamByMembers(t)),!i)return"";o.a.isArray(r)&&(c=r.find(e=>1===e.public));const u=d.a.getImage({user:i,team:c,priority:"user"}),b=d.a.displayNameShort(i),p=d.a.displayName(i,!0);return Object(l.h)("div",{class:"d-flex flex-row position-relative font-weight-light mb-1"},c?Object(l.h)(e,null,Object(l.h)("a",{href:"/teams/public/"+c.uuidv4,title:c.name,onClick:e=>m(e,c.uuidv4),class:"stretched-link"},Object(l.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedThumb",style:""+(u?`background-image: url("${u}"); background-size: cover;`:"")},!u&&Object(l.h)("div",{class:"",style:"font-size: 12px; padding-top: 3px;"},b))),Object(l.h)("div",{class:"ml-2 "},p," ",Object(l.h)("span",{class:"font-weight-lighter"},"- ",c.name))):Object(l.h)(e,null,Object(l.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedThumb",style:(u?`background-image: url("${u}"); background-size: cover;`:"")+" opacity: 0.5;"},!u&&Object(l.h)("div",{class:"text-muted",style:"font-size: 12px; padding-top: 3px;"},b)),Object(l.h)("div",{class:"ml-2"},p)))}),i>p.length&&Object(l.h)(e,null,Object(l.h)("small",{class:"text-muted"},Object(l.h)(c.c,{id:"story.limited-to"},"Limited to max 50 users.")))))}})||i;t.a=m}).call(this,s("hosL").Fragment)}}]);
//# sourceMappingURL=12.chunk.00d63.esm.js.map