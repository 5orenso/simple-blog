{"version":3,"sources":["webpack:///./routes/app-races/index.js"],"names":["MARGIN_TOP","mu","marginTop","MARGIN_TOP_BACK","marginTopBack","MARGIN_BOTTOM","marginBottom","initialState","subMenuMarginTop","isLoading","AppRaceDetailSignup","observer","props","signupToRace","user","stores","userStore","signup","raceStore","addContestant","id","raceid","classId","class","newContestant","team","firstname","lastname","sportsClub","email","cellphone","facebook","instagram","updateSignup","e","updateObjectKeyValue","target","value","editSignup","field","dataset","classid","contestantid","data","raceClassId","contestantId","util","ucfirst","clearTimeout","updateTimer","setTimeout","editClass","likeRace","race","toggleAddComment","raceId","parentElement","setState","showAddComment","state","inputRef","focus","back","route","loadRace","i","l","currentClass","idx","this","load","classes","length","contestants","findIndex","updateKeyValue","componentDidMount","componentWillReceiveProps","nextProps","render","appState","teams","language","signupClass","getRaceClassById","today","Date","style","onClick","title","startDate","formatDate","locale","hour12","hour","minute","endDate","signupStartDate","signupEndDate","signuppayment","for","paidSignupfee","role","line","images","isString","text","match","RegExp","exec","parsedLanguageText","replace","p1","p2","isObject","s3XXLargeLink","replaceImages","signupfee","type","data-classid","data-contestantid","onInput","placeholder","aria-describedby","map","name","disabled","sort","a","b","distance","checked","termsAndAgreement","Component"],"mappings":"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","file":"route-app-races.chunk.c0512.js","sourcesContent":["import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport { route } from 'preact-router';\n\nimport mu from '../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(false);\nconst MARGIN_TOP_BACK = mu.marginTopBack(false);\nconst MARGIN_BOTTOM = mu.marginBottom();\nconst SUB_MENU_MARGIN_TOP = mu.subMenuMarginTop();\n\nfunction replaceImages(line = '', images, language = 'no') {\n    function imageReplacer(match, p1, p2, p3, offset, string) {\n        // console.log({ match, p1, p2, p3, offset, string })\n        if (util.isObject(images[p1])) {\n            return `<img src=${images[p1].s3XXLargeLink} class='img-fluid float-right' style='width: ${p2 || 40}%;' />`;\n        }\n        return '';\n    }\n\n    if (util.isString(line)) {\n\t\tlet text = line;\n        const regex = new RegExp(`<${language}>(.*?)</${language}>`, 's');\n\t\tconst match = regex.exec(text);\n\t\tif (match) {\n\t\t\tconst parsedLanguageText = match[0];\n\t\t\tif (parsedLanguageText) {\n\t\t\t\ttext = parsedLanguageText;\n\t\t\t}\n\t\t}\n        return text.replace(/\\{\\{img\\.(\\d+)\\s*(\\d*)\\}\\}/g, imageReplacer);\n    }\n    return line;\n}\n\nconst initialState = {\n\tisLoading: false,\n};\n\n@observer\nclass AppRaceDetailSignup extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n\t\tthis.inputRef = {};\n        this.updateTimer = {};\n    }\n\n\tasync loadRace(props = this.props) {\n\t\tthis.setState({ isLoading: true });\n\t\tconst { raceStore, userStore } = props.stores;\n\t\tconst { user = {} } = userStore;\n\t\tconst { raceid } = props;\n\t\tawait raceStore.load(raceid);\n\t\tthis.setState({ isLoading: false });\n\n\t\tlet signup = {};\n\t\tconst { race } = raceStore;\n\t\tif (race.classes && user && user.email) {\n\t\t\tfor (let i = 0, l = race.classes.length; i < l; i += 1) {\n\t\t\t\tconst currentClass = race.classes[i];\n\t\t\t\tif (currentClass.contestants) {\n\t\t\t\t\tconst idx = currentClass.contestants.findIndex(e => e.email === user.email);\n\t\t\t\t\tif (idx > -1) {\n\t\t\t\t\t\tsignup = { ...currentClass.contestants[idx] };\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\traceStore.updateKeyValue('signup', signup);\n\t}\n\n\tsignupToRace = async () => {\n\t\tconst { raceStore, userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n        const { signup } = raceStore;\n\t\tconst { raceid } = this.props;\n\n\t\tawait raceStore.addContestant({\n\t\t\tid: raceid,\n\t\t\tclassId: signup.class,\n\t\t\tnewContestant: {\n\t\t\t\tteam: user.team,\n\t\t\t\tfirstname: user.firstname,\n\t\t\t\tlastname: user.lastname,\n\t\t\t\tsportsClub: user.sportsClub,\n\t\t\t\temail: user.email,\n\t\t\t\tcellphone: user.cellphone,\n\t\t\t\tfacebook: user.facebook,\n\t\t\t\tinstagram: user.instagram,\n\t\t\t\t ...signup\n\t\t\t} });\n\t}\n\n    updateSignup = (e) => {\n        const key = e.target.id;\n        const value = e.target.value;\n        const { raceStore } = this.props.stores;\n        raceStore.updateObjectKeyValue('signup', key, value);\n    }\n\n    editSignup = (e) => {\n        const { raceid } = this.props;\n        const { raceStore } = this.props.stores;\n        const field = e.target.id;\n        const value = e.target.value;\n        const { classid, contestantid } = e.target.dataset;\n        raceStore.updateObjectKeyValue('signup', field, value);\n\n        // console.log({ raceid, field, value, classid });\n        // const { raceStore } = this.props.stores;\n        // raceStore.updateObjectKeyValue('signup', key, value);\n\n        const data = {\n\t\t\traceClassId: classid,\n            contestantId: contestantid,\n\t\t\t[`raceClassContestant${util.ucfirst(field)}`]: value,\n\t\t};\n\t\tclearTimeout(this.updateTimer[field]);\n\t\tthis.updateTimer[field] = setTimeout(async () => {\n\t\t\traceStore.editClass({\n\t\t\t\tid: raceid,\n\t\t\t\tdata,\n\t\t\t});\n\t\t}, 500);\n    }\n\n\t// editRaceClass = async (e) => {\n\t// \tconst { id, field } = e.target.dataset;\n\t// \tconst { value } = e.target;\n\t// \tconst { raceid } = this.props;\n\t// \tconst { raceStore } = this.props.stores;\n\t// \tconst data = {\n\t// \t\traceClassId: id,\n\t// \t\t[`raceClass${util.ucfirst(field)}`]: value,\n\t// \t};\n\t// \tclearTimeout(this.updateTimer[field]);\n\t// \tthis.updateTimer[field] = setTimeout(async () => {\n\t// \t\traceStore.editClass({\n\t// \t\t\tid: raceid,\n\t// \t\t\tdata,\n\t// \t\t});\n\t// \t}, 500);\n\t// }\n\n\t// editSignupToRaceasync = async () => {\n\t// \tconst { raceStore, userStore } = this.props.stores;\n\t// \tconst { user } = userStore;\n    //     const { signup } = raceStore;\n\t// \tconst { raceid } = this.props;\n\n\t// \tawait raceStore.editContestant({\n\t// \t\tid: raceid,\n\t// \t\tclassId: signup.class,\n\t// \t\tnewContestant: {\n\t// \t\t\tteam: user.team,\n\t// \t\t\tfirstname: user.firstname,\n\t// \t\t\tlastname: user.lastname,\n\t// \t\t\tsportsClub: user.sportsClub,\n\t// \t\t\temail: user.email,\n\t// \t\t\tcellphone: user.cellphone,\n\t// \t\t\tfacebook: user.facebook,\n\t// \t\t\tinstagram: user.instagram,\n\t// \t\t\t ...signup\n\t// \t\t} });\n\t// }\n\n    likeRace = async () => {\n\t\tconst { raceStore } = this.props.stores;\n\t\tconst { race } = raceStore;\n\t\tconst response = await raceStore.likeRace({ id: race.id });\n\n        if (response && response.status === 200) {\n\t\t\t// this.loadRaceDetail({ race });\n\t\t}\n\t}\n\n\ttoggleAddComment = (e) => {\n\t\tconst raceId = e.target.parentElement.dataset.id || e.target.dataset.id;\n\t\tconst { showAddComment } = this.state;\n\t\tthis.setState({\n\t\t\tshowAddComment: !showAddComment,\n\t\t}, () => {\n\t\t\tif (this.inputRef[raceId]) {\n\t\t\t\tthis.inputRef[raceId].focus();\n\t\t\t}\n\t\t});\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.loadRace();\n\t}\n\n    componentWillReceiveProps(nextProps) {\n        if (nextProps.raceid !== this.props.raceid) {\n            this.loadRace(nextProps);\n        }\n\t}\n\n    back = () => {\n        route(`/`, true);\n    }\n\n\trender() {\n\t\tconst { userStore, raceStore, appState } = this.props.stores;\n\t\tconst { user = {}, teams = [] } = userStore;\n\t\tconst { raceid, subsection } = this.props;\n\t\tconst { race, signup } = raceStore;\n        const { darkmode, language = 'no' } = appState;\n\n        let signupClass = {};\n        if (signup.class) {\n            signupClass = raceStore.getRaceClassById(signup.class);\n        }\n\t\tconst today = new Date();\n\n\t\treturn (\n\t\t\t<div class='container-fluid' style={`margin-bottom: ${MARGIN_BOTTOM}; margin-top: ${MARGIN_TOP};`}>\n\n                <div class='d-flex justify-content-between mb-2'>\n                    <div>\n                        <button class='btn btn-link pl-0 fixed-top'\n                            style={`top: ${MARGIN_TOP_BACK}; left: 5px; font-size: 25px; width: 40px;`}\n                            onClick={this.back}>\n                            <i class='fas fa-arrow-circle-left' />\n                        </button>\n                    </div>\n                    <div>\n                        <h5 class='text-muted'>&nbsp;</h5>\n                    </div>\n                </div>\n\n                <h2 class='mb-0'><Text id='races.signup'>Påmelding</Text> <span class='font-weight-lighter' style='letter-spacing: -1px;'> - {race.title}</span></h2>\n\t            <div class='mb-4'>\n                    {race.startDate && <><Text id='races.periode'>Periode</Text>: {util.formatDate(race.startDate, { locale: 'no-NB', hour12: false, hour: '2-digit', minute: '2-digit' })}</>}\n                    {race.endDate && <> - {util.formatDate(race.endDate, { locale: 'no-NB', hour12: false, hour: '2-digit', minute: '2-digit' })}</>}\n                </div>\n\n                {today >= new Date(race.signupStartDate) && today <= new Date(race.signupEndDate) ? <>\n\n                    <span class='font-weight-lighter'><Text id='races.signed-in-as'>Logget inn som</Text>:</span> {user.email}<br /><br />\n\n                    {signup.id ? <>\n\n                        <div class='font-weight-bold mb-4'>\n                            <i class='fas fa-check text-success' /> <Text id='races.signed-up'>Din bruker er påmeldt!</Text><br />\n                            {/* {JSON.stringify(signup)} */}\n                        </div>\n\n\n                        {race.signuppayment && <>\n                            <div class='form-group row my-0'>\n                                <label for='cellphone' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.signup'>Påmelding</Text></label>\n                                <div class='col-10'>\n                                    {signup.paidSignupfee ? <div class='py-2'>\n                                        <Text id='races.paid'>Betalt</Text>: {util.formatDate(signup.paidSignupfee)}\n                                        <i class='fas fa-check text-success ml-3' />\n                                    </div> : <>\n                                        <div class='alert alert-danger mb-1' role='alert'>\n                                            <h5>\n                                                <span class='font-weight-lighter'><Text id='races.payment-info'>Betaling påmelding</Text>:</span> {replaceImages(race.signuppayment, race.images, language)}<br />\n                                                {signupClass.signupfee || race.signupfee} NOK\n                                            </h5>\n                                        </div>\n                                    </>}\n                                </div>\n                            </div>\n                        </>}\n\n                        <div class='clearfix mt-2'>\n                            <span class='font-weight-lighter float-right'><Text id='races.click-to-change'>Klikk for å endre info i påmeldingen.</Text></span>\n                        </div>\n\n                        <div class='form-group row my-0'>\n                            <label for='cellphone' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.cellphone'>Mobil</Text></label>\n                            <div class='col-10'>\n                                <Localizer>\n                                    <input type='text' class='form-control-plaintext' id='cellphone'\n                                        data-classid={signup.class}\n                                        data-contestantid={signup.id}\n                                        onInput={this.editSignup}\n                                        value={signup.cellphone}\n                                        placeholder={<Text id='races.cellphone-help'>Hva er mobilnummer ditt?</Text>}\n                                    />\n                                </Localizer>\n                            </div>\n                        </div>\n                        <div class='form-group row my-0'>\n                            <label for='firstname' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.firstname'>Fornavn</Text></label>\n                            <div class='col-10'>\n                                <Localizer>\n                                    <input type='text' class='form-control-plaintext' id='firstname'\n                                        data-classid={signup.class}\n                                        data-contestantid={signup.id}\n                                        onInput={this.editSignup}\n                                        value={signup.firstname}\n                                        placeholder={<Text id='races.firstname-help'>Hva er fornavnet ditt?</Text>}\n                                    />\n                                </Localizer>\n                            </div>\n                        </div>\n                        <div class='form-group row my-0'>\n                            <label for='lastname' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.lastname'>Etternavn</Text></label>\n                            <div class='col-10'>\n                                <Localizer>\n                                    <input type='text' class='form-control-plaintext' id='lastname'\n                                        data-classid={signup.class}\n                                        data-contestantid={signup.id}\n                                        onInput={this.editSignup}\n                                        value={signup.lastname}\n                                        placeholder={<Text id='races.lastname-help'>Hva er etternavnet ditt?</Text>}\n                                    />\n                                </Localizer>\n                            </div>\n                        </div>\n                        <div class='form-group row my-0'>\n                            <label for='sportsClub' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.sportsclub'>Klubb</Text></label>\n                            <div class='col-10'>\n                                <Localizer>\n                                    <input type='text' class='form-control-plaintext' id='sportsClub'\n                                        data-classid={signup.class}\n                                        data-contestantid={signup.id}\n                                        onInput={this.editSignup}\n                                        value={signup.sportsClub}\n                                        placeholder={<Text id='races.sportsClub-help'>Hvilken klubb tilhører du?</Text>}\n                                    />\n                                </Localizer>\n                            </div>\n                        </div>\n                        <div class='form-group row my-0'>\n                            <label for='facebook' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.facebook'>Facebook</Text></label>\n                            <div class='col-10'>\n                                <Localizer>\n                                    <input type='text' class='form-control-plaintext' id='facebook'\n                                        data-classid={signup.class}\n                                        data-contestantid={signup.id}\n                                        onInput={this.editSignup}\n                                        value={signup.facebook}\n                                        placeholder={<Text id='races.facebook-help'>Hva er Facebook brukernavnet ditt?</Text>}\n                                    />\n                                </Localizer>\n                            </div>\n                        </div>\n                        <div class='form-group row my-0'>\n                            <label for='instagram' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.instagram'>Instagram</Text></label>\n                            <div class='col-10'>\n                                <Localizer>\n                                    <input type='text' class='form-control-plaintext' id='instagram'\n                                        data-classid={signup.class}\n                                        data-contestantid={signup.id}\n                                        onInput={this.editSignup}\n                                        value={signup.instagram}\n                                        placeholder={<Text id='races.instagram-help'>Hva er Instagram brukernavnet ditt?</Text>}\n                                    />\n                                </Localizer>\n                            </div>\n                        </div>\n                        <div class='form-group row my-0'>\n                            <label for='team' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.team'>Team</Text></label>\n                            <div class='col-10'>\n                                <select class='form-control-plaintext' id='team' aria-describedby='teamHelp'\n                                    data-classid={signup.class}\n                                    data-contestantid={signup.id}\n                                    onInput={this.editSignup}\n                                    value={signup.team}\n                                >\n                                    <option value=''>-- <Text id='races.choose-team'>Velg team</Text> --</option>\n                                    {teams.map(team => \n                                        <option value={team.id}>{team.name}</option>\n                                    )}\n                                </select>\n                            </div>\n                        </div>\n                        <div class='form-group row my-0'>\n                            <label for='team' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.class'>Klasse</Text></label>\n                            <div class='col-10'>\n                                <select class='form-control-plaintext' id='class' aria-describedby='classHelp'\n                                    onInput={this.editSignup}\n                                    value={signup.class}\n                                    disabled\n                                >\n                                    <option value=''>-- <Text id='races.choose-class'>Velg klasse</Text> --</option>\n                                    {race.classes && race.classes.sort((a, b) => a.distance - b.distance).map(currentClass => <>\n                                        <option value={currentClass.id}>{currentClass.title} - {currentClass.distance} km - Påmelding: {currentClass.signupfee || race.signupfee} NOK</option>\n                                    </>)}\n                                </select>\n                            </div>\n                        </div>\n\n                    </> : <>\n\n                        <div class='form-group'>\n                            <label for='cellphone'><Text id='races.cellphone'>Mobil</Text></label>\n                            <input type='text' class='form-control' id='cellphone' aria-describedby='cellphoneHelp'\n                                placeholder={user.cellphone}\n                                onInput={this.updateSignup}\n                                value={signup.cellphone}\n                            />\n                            <small id='cellphoneHelp' class='form-text text-muted'><Text id='races.cellphone-help'>'Hva er mobilnummer ditt?'</Text></small>\n                        </div>\n\n                        <div class='row'>\n                            <div class='col'>\n                                <div class='form-group'>\n                                    <label for='firstname'><Text id='races.firstname'>Fornavn</Text></label>\n                                    <input type='text' class='form-control' id='firstname' aria-describedby='firstnameHelp'\n                                        placeholder={user.firstname}\n                                        onInput={this.updateSignup}\n                                        value={signup.firstname}\n                                    />\n                                    <small id='firstnameHelp' class='form-text text-muted'><Text id='races.firstname-help'>Hva er fornavnet ditt?</Text></small>\n                                </div>\n                            </div>\n                            <div class='col'>\n                                <div class='form-group'>\n                                    <label for='lastname'><Text id='races.lastname'>Etternavn</Text></label>\n                                    <input type='text' class='form-control' id='lastname' aria-describedby='lastnameHelp'\n                                        placeholder={user.lastname}\n                                        onInput={this.updateSignup}\n                                        value={signup.lastname}\n                                    />\n                                    <small id='lastnameHelp' class='form-text text-muted'><Text id='races.lastname-help'>Hva er etternavnet ditt?</Text></small>\n                                </div>\n                            </div>\n                        </div>\n\n                        <div class='form-group'>\n                            <label for='sportsClub'><Text id='races.sportsclub'>Klubb</Text></label>\n                            <input type='text' class='form-control' id='sportsClub' aria-describedby='sportsClubHelp'\n                                placeholder={user.sportsClub}\n                                onInput={this.updateSignup}\n                                value={signup.sportsClub}\n                            />\n                            <small id='sportsClubHelp' class='form-text text-muted'><Text id='races.sportsClub-help'>Hvilken klubb tilhører du?</Text></small>\n                        </div>\n\n                        <div class='row'>\n                            <div class='col'>\n                                <div class='form-group'>\n                                    <label for='facebook'><Text id='races.facebook'>Facebook</Text></label>\n                                    <input type='text' class='form-control' id='facebook' aria-describedby='facebookHelp'\n                                        placeholder={user.facebook}\n                                        onInput={this.updateSignup}\n                                        value={signup.facebook}\n                                    />\n                                    <small id='facebookHelp' class='form-text text-muted'><Text id='races.facebook-help'>Hva er Facebook brukernavnet ditt?</Text></small>\n                                </div>\n                            </div>\n                            <div class='col'>\n                                <div class='form-group'>\n                                    <label for='instagram'><Text id='races.instagram'>Instagram</Text></label>\n                                    <input type='text' class='form-control' id='instagram' aria-describedby='instagramHelp'\n                                        placeholder={user.instagram}\n                                        onInput={this.updateSignup}\n                                        value={signup.instagram}\n                                    />\n                                    <small id='instagramHelp' class='form-text text-muted'><Text id='races.instagram-help'>Hva er Instagram brukernavnet ditt?</Text></small>\n                                </div>\n                            </div>\n                        </div>\n\n                        <div class='form-group'>\n                            <label for='team'><Text id='races.team'>Team</Text></label>\n                            <select class='form-control' id='team' aria-describedby='teamHelp'\n                                onInput={this.updateSignup}\n                                value={signup.team}\n                            >\n                                <option value=''>-- <Text id='races.choose-team'>Velg team</Text> --</option>\n                                {teams.map(team => \n                                    <option value={team.id}>{team.name}</option>\n                                )}\n                            </select>\n                            <small id='teamHelp' class='form-text text-muted'><Text id='races.choose-team-help'>Velg fra dine team</Text></small>\n                        </div>\n\n                        <div class='form-group'>\n                            <label for='class'><Text id='races.class'>Klasse</Text></label>\n                            <select class='form-control' id='class' aria-describedby='classHelp'\n                                onInput={this.updateSignup}\n                                value={signup.class}\n                            >\n                                <option value=''>-- <Text id='races.choose-class'>Velg klasse</Text> --</option>\n                                {race.classes && race.classes.map(currentClass => <>\n                                    <option value={currentClass.id}>{currentClass.title} - {currentClass.distance} km - Påmelding: {currentClass.signupfee || race.signupfee} NOK</option>\n                                </>)}\n                            </select>\n                            <small id='classHelp' class='form-text text-muted'><Text id='races.choose-class-help'>Velg ønsket klasse.</Text></small>\n                        </div>\n\n                        <div class='form-group form-check'>\n                            <input type='checkbox' class='form-check-input' id='termsAndAgreement'\n                                onInput={this.updateSignup}\n                                checked={signup.termsAndAgreement}\n                                value={true}\n                            />\n                            <label class='form-check-label' for='termsAndAgreement'><Text id='races.agreement-accept'>Jeg har lest og godtar reglene for løpet.</Text></label>\n                        </div>\n                        <button type='button' class='btn btn-primary' onClick={this.signupToRace}><Text id='races.do-signup'>Meld meg på</Text></button>\n                    </>}\n\n                </> : <>\n                    {today < new Date(race.signupStartDate) ? <>\n                        <h5 class='mt-4'>\n                            <i class='fas fa-exclamation-circle' /> <Text id='races.signup-not-open-yet'>Påmeldingen har ikke åpnet ennå!</Text>\n                        </h5>\n                        <p class='mt-4'>\n                            <Text id='races.signup-opening'>Påmeldingen åpner</Text>:<br />\n                            <span class='display-4'>{util.formatDate(race.signupStartDate, { locale: 'no-NB', hour12: false, hour: '2-digit', minute: '2-digit' })}</span>\n                        </p>\n                    </> : <>\n                        <h5 class='mt-4 mb-4'>\n                            <i class='fas fa-exclamation-circle' /> <Text id='races.signup-closed'>Påmeldingen er stengt!</Text>\n                        </h5>\n                    </>}\n                </>}\n            </div>\n\t\t);\n\t}\n}\n\nexport default AppRaceDetailSignup;\n"],"sourceRoot":""}