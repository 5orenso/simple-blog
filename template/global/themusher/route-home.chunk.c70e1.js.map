{"version":3,"sources":["webpack:///./routes/home/index.js","webpack:///./components/team/publicFeed.js","webpack:///./components/user/updateSettings.js","webpack:///./components/races/index.js"],"names":["MARGIN_TOP","mu","marginTop","MARGIN_BOTTOM","marginBottom","initialState","subMenuMarginTop","isLoading","submenu","Home","observer","props","chooseSubmenu","e","setState","target","parentElement","dataset","menu","addNavigation","viewmenu","appState","stores","setSwipeRight","setSwipeLeft","route","getState","workoutStore","cordovaGetState","cordovaProviderState","cordovaIsPowerSaveMode","cordovaGetLog","destroyLog","cordovaDestroyLog","state","loadAll","this","userStore","messageStore","getFingerprint","getInfo","getNotifications","getUnReadMessages","componentDidMount","componentWillUnmount","componentWillReceiveProps","render","path","teamid","user","currentLocationGeocode","yrWeatherKeys","place","formatted_address","currentTeam","cordovaActiveTrackingParams","isRunning","totalDistance","currentSpeed","totalTime","class","style","role","util","secToHms","format","href","id","yrWeather","join","data-menu","Component","showAddComment","likeWorkout","idxSuggestion","idxAd","limit","offset","hasFollowSugguestions","hasAd","sessionid","Date","getTime","dataFields","TeamPublicFeed","setLoadMore","teamStore","loadTeamsPublicFeed","unsetLoadMore","insertTopRanked","publicTeamsFeed","topRankedRandomized","shuffleArray","topRankedWorkouts","feed","i","randomPlace","randomInt","isObject","splice","localUpdateField","insertAds","type","wrapperClassNames","contentClassNames","insertTeamConfirm","idxConfirm","insertTeamSuggestions","onTeamClick","preventDefault","stopPropagation","showTeam","hideTeam","onUserClick","onDogClick","dogid","dogs","showDog","hideDog","setupIntersection","handleIntersection","intersectionObserverCallback","scrollViewTimer","setInterval","postScrollview","getIntersectionObserverHistory","renderContent","obj","idx","loadPublicFeed","sort","componentWillMount","clearInterval","cleanupMemory","nextProps","shortname","name","darkmode","team","findPublicTeamByUuidv4","image","getImage","displayNameShort","displayName","back","public","uuidv4","length","data","dataValues","toggleSetting","field","settings","updateSetting","hideSettings","forceShow","summaryEmails","infoEmails","partnerEmails","onInput","checked","for","onClick","replaceImages","line","images","language","isString","text","match","RegExp","exec","parsedLanguageText","replace","p1","p2","s3XXLargeLink","MARKDOWN_OPTIONS","pedantic","gfm","breaks","sanitize","smartLists","smartypants","xhtml","Races","toggleRaces","value","hideRaces","toggleFeature","racesFrontpage","setToggleFeature","loadRace","raceStore","load","query","isAdmin","races","a","b","startDate","reverse","map","race","today","status","endDate","signupStartDate","signupEndDate","src","s3LargeLink","active","title","markdown","ingress","markdownOpts","classes","distance","currentClass","formatDate","locale"],"mappings":"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","file":"route-home.chunk.c70e1.js","sourcesContent":["import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport { route } from 'preact-router';\n\nimport PubSub, { topics } from '../../lib/pubsub';\n\nimport mu from '../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(false);\nconst MARGIN_BOTTOM = mu.marginBottom();\nconst SUB_MENU_MARGIN_TOP = mu.subMenuMarginTop();\n\nimport InviteFriend from '../../components/user/invite';\nimport UserUpdate from '../../components/user/updateSettings';\nimport Install from '../../components/install';\nimport WorkoutTotals from '../../components/workout/totals';\nimport WorkoutStatus from '../../components/workout/status';\nimport Teams from '../../components/team/teams';\nimport TeamPublicFeed from '../../components/team/publicFeed';\nimport StoryAdd from '../../components/story/add';\nimport StoryPublicFeed from '../../components/story/publicFeed';\nimport YrWeather from '../../components/yrweather/';\nimport Races from '../../components/races/';\n\nconst initialState = {\n\tisLoading: false,\n\tsubmenu: 'lastWorkouts',\n};\n\n@observer\nclass Home extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\tasync loadAll() {\n\t\tconst { appState, userStore, messageStore } = this.props.stores;\n\t\tthis.setState({ isLoading: true });\n        await appState.getFingerprint();\n        await userStore.getInfo();\n\t\tawait userStore.getNotifications();\n\t\tawait messageStore.getUnReadMessages();\n\n\t\tthis.setState({ isLoading: false });\n    }\n\n\tchooseSubmenu = (e) => {\n\t\tconst submenu = e.target.parentElement.dataset.menu || e.target.dataset.menu;\n\t\tthis.setState({ submenu });\n\t}\n\n\tcomponentDidMount() {\n\t\t// this.addNavigation();\n\t\tthis.loadAll();\n\t}\n\n\t// Swipe navigation\n\taddNavigation = (props = this.props) => {\n        const { viewmenu } = props;\n        const { appState } = this.props.stores;\n\t\tif (viewmenu === 'wall') {\n\t\t\tappState.setSwipeRight();\n\t\t\tappState.setSwipeLeft(() => {\n\t\t\t\tappState.setSwipeLeft();\n\t\t\t\troute(`/home-workout`);\n\t\t\t});\n\t\t}\n\t\tif (viewmenu === 'workout') {\n\t\t\tappState.setSwipeLeft();\n\t\t\tappState.setSwipeRight(() => {\n\t\t\t\tappState.setSwipeRight();\n\t\t\t\troute(`/`);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetState = async () => {\n\t\tconst { workoutStore } = this.props.stores;\n\t\tawait workoutStore.cordovaGetState();\n\t\tawait workoutStore.cordovaProviderState();\n\t\tawait workoutStore.cordovaIsPowerSaveMode();\n\t\tawait workoutStore.cordovaGetLog();\n\t}\n\n\tdestroyLog = async () => {\n\t\tconst { workoutStore } = this.props.stores;\n\t\tworkoutStore.cordovaDestroyLog();\n\t}\n\n\tcomponentWillUnmount() {\n\t\tconst { appState } = this.props.stores;\n\t\tappState.setSwipeRight();\n\t\tappState.setSwipeLeft();\n\t}\n\t// /Swipe navigation\n\n\tcomponentWillReceiveProps(nextProps) {\n        // console.log('componentWillReceiveProps', nextProps.viewmenu, this.props.viewmenu);\n        if (nextProps.viewmenu !== this.props.viewmenu) {\n            // this.addNavigation(nextProps);\n        }\n    }\n\n\trender() {\n\t\tconst { isLoading, submenu } = this.state;\n\t\tconst { viewmenu, path, teamid } = this.props;\n\t\tconst { userStore, appState, workoutStore } = this.props.stores;\n\t\t// const { workoutPlan, workoutPlans } = workoutPlanStore;\n\t\tconst { darkmode, viewmode, apiServer } = appState;\n\t\tconst { isAdmin, user } = userStore;\n\t\tconst { currentLocationGeocode = {}, yrWeatherKeys = [] } = user;\n\t\tconst { formatted_address: place } = currentLocationGeocode;\n\n\t\tconst { currentTeam, cordovaActiveTrackingParams, cordovaAuthorizationStatus, powerSaveStatus,\n\t\t\tproviderState, log, isRunning, totalDistance, geoLocationState, bgGeo, currentSpeed, totalTime, workouts } = workoutStore;\n\n\t\treturn (\n\t\t\t<div class='container-fluid' style={`margin-bottom: ${MARGIN_BOTTOM}; margin-top: ${MARGIN_TOP};`}>\n\n{/* <xmp>bgGeo: {JSON.stringify(bgGeo, null, 4)}</xmp> */}\n{/* <button class='btn btn-success btn-block' onClick={this.getState}>Get State</button>\n<button class='btn btn-success btn-block' onClick={this.destroyLog}>Destroy log</button>\n<xmp>cordovaAuthorizationStatus: {JSON.stringify(cordovaAuthorizationStatus, null, 4)}</xmp>\n<xmp>cordovaActiveTrackingParams: {JSON.stringify(cordovaActiveTrackingParams, null, 4)}</xmp>\n<xmp>geoLocationState: {JSON.stringify(geoLocationState, null, 4)}</xmp>\n<xmp>powerSaveStatus: {JSON.stringify(powerSaveStatus, null, 4)}</xmp>\n<xmp>providerState: {JSON.stringify(providerState, null, 4)}</xmp>\n<xmp>isRunning: {JSON.stringify(isRunning, null, 4)}</xmp>\n<xmp>totalDistance: {JSON.stringify(totalDistance, null, 4)}</xmp>\n<xmp>currentSpeed: {JSON.stringify(currentSpeed, null, 4)}</xmp>\n<xmp>totalTime: {JSON.stringify(totalTime, null, 4)}</xmp>\n<xmp>workoutStore.workouts: {JSON.stringify(workouts.length, null, 4)}</xmp>\n\n{log && <>{JSON.stringify(log.split('\\n').map(e => `${e}\\n`), null, 4)}</>} */}\n\n\n\t\t\t\t{isRunning && cordovaActiveTrackingParams && <>\n\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t<div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 border-bottom bg-light py-4'>\n\t\t\t\t\t\t\t<h1 class='text-success font-weight-bold'>\n\t\t\t\t\t\t\t\tTracking\n\t\t\t\t\t\t\t\t<div class='spinner-grow ml-3' role='status' />\n\t\t\t\t\t\t\t</h1>\n\t\t\t\t\t\t\t<div class='row mb-3'>\n\t\t\t\t\t\t\t\t<div class='col-4 text-center font-weight-bold' style='font-size: 1.3em;'>{util.secToHms(totalTime)}</div>\n\t\t\t\t\t\t\t\t<div class='col-4 text-center font-weight-bold' style='font-size: 1.3em;'>{util.format(currentSpeed * 3.6, 1)} km/t</div>\n\t\t\t\t\t\t\t\t<div class='col-4 text-center font-weight-bold' style='font-size: 1.3em;'>{util.format(totalDistance / 1000, 2)} km</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<a class='btn btn-block btn-danger' href='/workouts/tracking'><Text id='workouts.go-to-tracking'>Go to tracking</Text></a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</>}\n\n\t\t\t\t<div class=''>\n\t\t\t\t\t{user.id && <YrWeather stores={this.props.stores} place={place} yrWeather={yrWeatherKeys.join(',')} />}\n\t\t\t\t</div>\n\n\t\t\t\t{user.id && <StoryAdd stores={this.props.stores} />}\n\n\t\t\t\t<div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2'>\n\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t<div class='w-100 overflow-hidden'>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass='d-flex flex-row flex-nowrap pb-2 px-1'\n\t\t\t\t\t\t\t\tstyle='overflow: auto; scroll-snap-type: x mandatory;'\n\t\t\t\t\t\t\t>\t\t\t\t\t\n\t\t\t\t\t\t\t\t<div class='col px-0 pt-2'>\n\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\tclass={`btn btn-block rounded-pill-left rounded-none ${viewmenu === 'wall' ? 'btn-primary' : 'btn-outline-primary'} text-nowrap`}\n\t\t\t\t\t\t\t\t\t\tstyle='text-overflow: ellipsis; overflow: hidden;'\n\t\t\t\t\t\t\t\t\t\tdata-menu='wall'\n\t\t\t\t\t\t\t\t\t\thref='/home-wall'\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<i class='fas fa-comments' /> <Text id='home.wall'>Veggen</Text>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class='col px-0 pt-2'>\n\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\tclass={`btn btn-block rounded-pill-right rounded-none ${viewmenu === 'workout' ? 'btn-primary' : 'btn-outline-primary'} text-nowrap`}\n\t\t\t\t\t\t\t\t\t\tstyle='text-overflow: ellipsis; overflow: hidden;'\n\t\t\t\t\t\t\t\t\t\tdata-menu='workout'\n\t\t\t\t\t\t\t\t\t\thref='/home-workout'\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<i class='fas fa-running' />  <Text id='home.workouts'>Treninger</Text>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{/* <div class='col px-0 pt-2'>\n\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\tclass={`btn btn-block ${viewmenu === 'totals' ? 'btn-primary' : 'btn-outline-primary'} text-nowrap`}\n\t\t\t\t\t\t\t\t\t\tstyle='text-overflow: ellipsis; overflow: hidden;'\n\t\t\t\t\t\t\t\t\t\tdata-menu='totals'\n\t\t\t\t\t\t\t\t\t\thref='/home-totals'\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<i class='fas fa-tachometer-alt' /> <Text id='home.totals'>Totaler</Text>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</div> */}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\n\t\t\t\t{viewmenu === 'wall' && <>\n\t\t\t\t\t<Races stores={this.props.stores} />\n\t\t\t\t\t<StoryPublicFeed stores={this.props.stores} path={path} />\n\t\t\t\t</>}\n\t\t\t\t{viewmenu === 'workout' && <>\n\t\t\t\t\t<TeamPublicFeed stores={this.props.stores} teamid={teamid} />\n\t\t\t\t</>}\n\t\t\t\t{viewmenu === 'totals' && <>\n\t\t\t\t\t<div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 border-bottom'>\n\t\t\t\t\t\t<Teams stores={this.props.stores} />\n\t\t\t\t\t\t<WorkoutTotals stores={this.props.stores} currentTeam={currentTeam} />\n\t\t\t\t\t\t<WorkoutStatus stores={this.props.stores} currentTeam={currentTeam} />\n\t\t\t\t\t</div>\n\t\t\t\t</>}\n\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Home;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport TeamConnectBoxes from './connect-boxes';\nimport TeamConnectConfirm from './connect-confirm';\n\nimport Ad from '../ad/';\n\nimport FastList from './fastList';\n\nimport Overlay from '../overlay/';\nimport TeamsPublicDetail from '../../routes/teams/publicDetail';\nimport DogPublicDetail from '../../routes/dogs/publicDetail';\n\nimport TeamPublicFeedLine from './publicFeedLine';\n\nimport mu from '../../lib/musher-util';\n\nconst initialState = {\n\tshowAddComment: {},\n    // viewImageIdx: {},\n    likeWorkout: {},\n    idxSuggestion: 0,\n    idxAd: 4,\n    limit: 10,\n    offset: 0,\n    hasFollowSugguestions: false, \n    hasAd: false,\n    sessionid: new Date().getTime(),\n};\n\nconst dataFields = ['id', 'type', 'user', 'team', 'title'];\n\n@observer\nclass TeamPublicFeed extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n    async loadTeamsPublicFeed({ props = this.props, limit, offset }) {\n\t\tconst { teamStore } = props.stores;\n        const { teamid } = props;\n\t\tawait teamStore.loadPublicFeed({ limit, offset, sort: '-createdDate', teamid });\n\t}\n\n    setLoadMore = () => {\n        const { teamStore } = this.props.stores;\n        teamStore.setLoadMore(() => {\n            const { teamid } = this.props;\n            let { limit, offset } = this.state;\n            offset += limit;\n            this.setState({ offset });\n            this.loadTeamsPublicFeed({ limit, offset, teamid });\n        });\n    }\n\n    unsetLoadMore = () => {\n        const { teamStore } = this.props.stores;\n        teamStore.setLoadMore(() => {});\n    }\n\n    async loadAll(props = this.props) {\n        const { limit } = this.state;\n        const { teamid } = props;\n\t\tawait this.loadTeamsPublicFeed({ props, limit, offset: 0, teamid });\n        // this.insertTopRanked();\n        // this.insertAds();\n        // this.insertTeamConfirm();\n        // this.insertTeamSuggestions();\n    }\n\n    insertTopRanked = () => {\n        const { teamStore } = this.props.stores;\n        const { publicTeamsFeed, topRankedWorkouts } = teamStore;\n        const topRankedRandomized = util.shuffleArray(topRankedWorkouts);\n        const feed = [...publicTeamsFeed];\n        for (let i = 0, l = 3; i < l; i += 1) {\n            const randomPlace = mu.randomInt(0, 7);\n            if (util.isObject(topRankedRandomized[i])) {\n                feed.splice(randomPlace, 0, topRankedRandomized[i]);\n            }\n        }\n        teamStore.localUpdateField('publicTeamsFeed', feed);\n    }\n\n    insertAds = () => {\n        const { idxAd } = this.state;\n        const { teamStore } = this.props.stores;\n        const { publicTeamsFeed } = teamStore;\n        const feed = [...publicTeamsFeed];\n        feed.splice(idxAd, 0, { type: 'ad', wrapperClassNames: '', contentClassNames: '' });\n        teamStore.localUpdateField('publicTeamsFeed', feed);\n    }\n\n    insertTeamConfirm = () => {\n        const { idxConfirm } = this.state;\n        const { teamStore } = this.props.stores;\n        const { publicTeamsFeed } = teamStore;\n        const feed = [...publicTeamsFeed];\n        feed.splice(idxConfirm, 0, { type: 'teamConfirm', wrapperClassNames: '', contentClassNames: '' });\n        teamStore.localUpdateField('publicTeamsFeed', feed);\n    }\n\n    insertTeamSuggestions = () => {\n        const { idxSuggestion } = this.state;\n        const { teamStore } = this.props.stores;\n        const { publicTeamsFeed } = teamStore;\n        const feed = [...publicTeamsFeed];\n        feed.splice(idxSuggestion, 0, { type: 'teamSuggestions', wrapperClassNames: '', contentClassNames: '' });\n        teamStore.localUpdateField('publicTeamsFeed', feed);\n    }\n\n    // Overlay functions\n    onTeamClick = (e, teamid) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.setState({\n            showTeam: teamid,\n        });\n        return false;\n    }\n\n    hideTeam = () => {\n        this.setState({\n            showTeam: null,\n        });\n    }\n\n    onUserClick = (e, userid) => {\n        e.preventDefault();\n        e.stopPropagation();\n        return false;\n    }\n\n    onDogClick = (e, dogid, dogs) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.setState({\n            showDog: dogid,\n            dogs,\n        });\n        return false;\n    }\n\n    hideDog = () => {\n        this.setState({\n            showDog: null,\n        });\n    }\n\n    // /Overlay functions\n\n    // Scroll views timer\n    setupIntersection = () => {\n        this.setState({\n            handleIntersection: mu.intersectionObserverCallback,\n        });\n        const { teamStore } = this.props.stores;\n        this.scrollViewTimer = setInterval(() => teamStore.postScrollview(mu.getIntersectionObserverHistory()), 30 * 1000);\n    }\n\n    componentWillMount() {\n        this.setupIntersection();\n    }\n\n    componentWillUnmount() {\n        this.unsetLoadMore();\n        const { teamStore } = this.props.stores;\n        teamStore.postScrollview(mu.getIntersectionObserverHistory());\n        clearInterval(this.scrollViewTimer);\n        teamStore.cleanupMemory();\n    }\n\n\tcomponentDidMount() {\n        this.loadAll();\n        this.setLoadMore();\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {\n        // console.log('componentWillReceiveProps', nextProps.viewmenu, this.props.viewmenu);\n        if (nextProps.teamid !== this.props.teamid) {\n            this.loadAll(nextProps);\n        }\n    }\n\n    renderContent = ({ obj, idx }) => {\n        const { appState } = this.props.stores;\n        const { path } = appState;\n\n        if (obj.type === 'ad') {\n            return(<>\n                <Ad stores={this.props.stores} path={path} />\n            </>);\n        }\n        if (obj.type === 'teamConfirm') {\n            return(<>\n                <TeamConnectConfirm stores={this.props.stores} />\n            </>);\n        }\n        if (obj.type === 'teamSuggestions') {\n            return(<>\n                <TeamConnectBoxes stores={this.props.stores} />\n            </>);\n        }\n        return (<>\n            <TeamPublicFeedLine\n                stores={this.props.stores}\n                feed={obj}\n                idx={idx}\n                onTeamClick={this.onTeamClick}\n                onUserClick={this.onUserClick}\n                onDogClick={this.onDogClick}\n            />\n        </>);\n    }\n\n    render() {\n        const { showTeam, showDog, handleIntersection, sessionid, dogs } = this.state;\n        const { teamStore, appState } = this.props.stores;\n        const { publicTeamsFeed } = teamStore;\n        const { path, darkmode } = appState;\n        const { teamid } = this.props;\n        const team = teamStore.findPublicTeamByUuidv4(teamid);\n        \n        const image = mu.getImage({ team });\n        let shortname;\n        let name;\n        let username;\n        if (team && team.name) {\n            shortname = mu.displayNameShort(team);\n            name = mu.displayName(team);\n        }\n\n\n        return (<>\n            {showTeam && <Overlay>\n                <TeamsPublicDetail stores={this.props.stores} teamid={showTeam} marginTop={'0px;'} marginBottom={'0px;'} back={this.hideTeam} hideTeam={this.hideTeam} />\n            </Overlay>}\n\n            {showDog && <Overlay>\n                <DogPublicDetail stores={this.props.stores} dogid={showDog} marginTop={'0px;'} marginBottom={'0px;'} back={this.hideDog} dogs={dogs} />\n            </Overlay>}\n\n            <div class='w-100'>\n                {team ? <>\n                    <div class='row pb-3 pt-3'>\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 border-bottom'>\n                            <div class='row'>\n                                <h3>\n                                    <div class='d-flex position-relative'>\n                                        <div\n                                            class={`text-center border rounded-circle imageRounded imageRoundedSmall`}\n                                            style={image ? `background-image: url(\"${image}\"); background-size: cover;` : ''}\n                                        >\n                                            {!image && <div class='text-muted' style='font-size: 20px; padding-top: 3px;'>{shortname}</div>}\n                                        </div>\n                                        <div class='flex-grow-1 pl-3 text-overflow' style='line-height: 1.2em;'>\n                                            <h3 class='mb-1'>\n                                                {team.public ? <>\n                                                    <a href={`/teams/public/${team.uuidv4}`} class='stretched-link'>{name}</a>\n                                                </> : <>\n                                                    {name}\n                                                </>}\n                                            </h3>\n                                        </div>\n                                    </div>\n                                </h3>\n                            </div>\n                        </div>\n                    </div>\n                </> : <>\n                    <TeamConnectConfirm stores={this.props.stores} />\n                </>}\n\n                {(!publicTeamsFeed || publicTeamsFeed.length === 0) && <>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 px-0'>\n                        <div class='text-center text-muted'>\n                            <div class='display-1'><i class='fas fa-chart-area' /></div>\n                            <h3><Text id='search.no-workouts-found'>No workouts found.</Text></h3>\n                            <Text id='teams.no-public-workouts-text'>Please follow more teams to see their workout activity on this page. This is a great way to get updates from all your favorite mushers.</Text>\n                        </div>\n                        <div class='text-center mt-3'>\n                            <a href='/teams/connect' class='btn btn-primary'>\n                                <i class='fas fa-users' /> <Text id='header.connect-team'>Follow teams</Text>\n                            </a>\n                        </div>\n                    </div>\n                </>}\n\n                <FastList\n                    data={publicTeamsFeed}\n                    wrapperClassNames={'row pb-4'}\n                    contentClassNames={`col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 my-1 position-relative rounded rounded-lg py-3 bg-${darkmode ? 'black' : 'white'} shadow-sm`}\n                    renderContent={this.renderContent}\n                    dataFields={dataFields}\n                    dataValues={{ type: '10' }}\n                    handleIntersection={handleIntersection}\n                    sessionid={sessionid}\n                />\n\n            </div>\n        </>);\n    }\n}\n\nexport default TeamPublicFeed;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport linkState from 'linkstate';\n\n@observer\nclass UserSettings extends Component {\n    toggleSetting= async (field) => {\n        const { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { settings = {} } = user;\n        await userStore.updateSetting({ [`settings.${field}`]: settings[field] === 1 ? 0 : 1 });\n    }\n\n    hideSettings = async () => {\n        const { userStore } = this.props.stores;\n        await userStore.updateSetting({ 'settings.hideSettings': 1 });\n        this.setState({\n            hideSettings: true,\n        });\n    }\n\n    render() {\n        const { hideSettings } = this.state;\n\t\tconst { userStore } = this.props.stores;\n        const { forceShow } = this.props;\n        const { user } = userStore;\n        const { settings = {} } = user;\n        if (hideSettings || settings.hideSettings) {\n            return '';\n        }\n        if (!forceShow && settings.summaryEmails && settings.infoEmails && settings.partnerEmails) {\n            return '';\n        }\n        return (\n           <div class='col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mt-4 mb-4 pt-4 pb-4 border-bottom border-top'>\n                <h5><Text id='users.settings'>Brukerinnstillinger</Text></h5>\n\n                {!settings.summaryEmails && <div class='row mt-4'>\n\t\t\t\t\t<div class='col-4 text-muted text-right'>\n\t\t\t\t\t\t<Text id='users.settings-summary-email'>Oppsummeringer</Text>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col-8'>\n\t\t\t\t\t\t<div class='custom-control custom-switch'>\n\t\t\t\t\t\t\t<input type='checkbox' class='custom-control-input' id='settingsSummaryEmails' onInput={() => this.toggleSetting('summaryEmails')} checked={settings.summaryEmails} />\n\t\t\t\t\t\t\t<label class='custom-control-label' for='settingsSummaryEmails' />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<small class='text-muted'><Text id='users.settings-receive-summary-email'>Motta oppsummeringer via e-post</Text></small>\n\t\t\t\t\t</div>\n\t\t\t\t</div>}\n\n\t\t\t\t{!settings.infoEmails && <div class='row mt-4'>\n\t\t\t\t\t<div class='col-4 text-muted text-right'>\n\t\t\t\t\t\t<Text id='users.settings-info-email'>Info</Text>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col-8'>\n\t\t\t\t\t\t<div class='custom-control custom-switch'>\n\t\t\t\t\t\t\t<input type='checkbox' class='custom-control-input' id='settingsInfoEmails' onInput={() => this.toggleSetting('infoEmails')} checked={settings.infoEmails} />\n\t\t\t\t\t\t\t<label class='custom-control-label' for='settingsInfoEmails' />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<small class='text-muted'><Text id='users.settings-receive-info-email'>Motta info via e-post</Text></small>\n\t\t\t\t\t</div>\n\t\t\t\t</div>}\n\n\t\t\t\t{!settings.partnerEmails && <div class='row mt-4'>\n\t\t\t\t\t<div class='col-4 text-muted text-right'>\n\t\t\t\t\t\t<Text id='users.settings-partner-email'>Partners</Text>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col-8'>\n\t\t\t\t\t\t<div class='custom-control custom-switch'>\n\t\t\t\t\t\t\t<input type='checkbox' class='custom-control-input' id='settingsPartnerEmails' onInput={() => this.toggleSetting('partnerEmails')} checked={settings.partnerEmails} />\n\t\t\t\t\t\t\t<label class='custom-control-label' for='settingsPartnerEmails' />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<small class='text-muted'><Text id='users.settings-receive-partner-email'>Motta tilbud fra våre partnere via e-post</Text></small>\n\t\t\t\t\t</div>\n\t\t\t\t</div>}\n\n                <div class='row mt-4'>\n                    <div class='col-12 text-muted'>\n                        <small>\n                            <a href='/users'>\n                                <i class='fas fa-sliders-h' /> <Text id='users.settings-text-info'>Innstillingene finner du inne på profilen din.</Text>\n                            </a>\n                        </small>\n                    </div>\n                </div>\n\n                <div class='row mt-4'>\n                    <div class='col-12 text-muted text-right'>\n                        <small>\n                            <button type='button' class='btn btn-sm btn-link mb-2' onClick={this.hideSettings}>\n                                <i class='fas fa-eye-slash' /> <Text id='users.hide-settings'>Skjul innstillingene</Text>\n                            </button>\n                        </small>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default UserSettings;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport Markdown from 'preact-markdown';\n\nconst MARKDOWN_OPTIONS = {\n\tpedantic: false,\n\tgfm: true,\n\tbreaks: true,\n\tsanitize: false,\n\tsmartLists: true,\n\tsmartypants: true,\n\txhtml: true,\n};\n\nimport mu from '../../lib/musher-util';\n\nfunction replaceImages(line = '', images, language = 'en') {\n    function imageReplacer(match, p1, p2, p3, offset, string) {\n        // console.log({ match, p1, p2, p3, offset, string })\n        if (util.isObject(images[p1])) {\n            return `<img src=${images[p1].s3XXLargeLink} class='img-fluid float-right' style='width: ${p2 || 40}%;' />`;\n        }\n        return '';\n    }\n\n    if (util.isString(line)) {\n\t\tlet text = line;\n        const regex = new RegExp(`<${language}>(.*?)</${language}>`, 's');\n\t\tconst match = regex.exec(text);\n\t\tif (match) {\n\t\t\tconst parsedLanguageText = match[0];\n\t\t\tif (parsedLanguageText) {\n\t\t\t\ttext = parsedLanguageText;\n\t\t\t}\n\t\t}\n        return text.replace(/\\{\\{img\\.(\\d+)\\s*(\\d*)\\}\\}/g, imageReplacer);\n    }\n    return line;\n}\n\nconst initialState = {\n\tisLoading: false,\n};\n\n@observer\nclass Races extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n    async loadRace(props = this.props) {\n\t\tthis.setState({ isLoading: true });\n\t\tconst { raceStore } = props.stores;\n\t\tconst query = {};\n\t\tawait raceStore.load({ query });\n\t\tthis.setState({ isLoading: false });\n\t}\n\n    toggleRaces = async () => {\n\t\tconst { userStore } = this.props.stores;\n        const { user } = userStore;\n        const { toggleFeature = {} } = user;\n        const value = toggleFeature.racesFrontpage ? 0 : 1;\n        this.setState({ hideRaces: value });\n        await userStore.setToggleFeature({\n            field: 'toggleFeature.racesFrontpage',\n            value,\n        });\n    }\n\n    componentDidMount() {\n\t\tthis.loadRace();\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {\n\t\tthis.loadRace(nextProps);\n\t}\n\n    render() {\n        const { appState, userStore, raceStore, newsStore } = this.props.stores;\n\t\tconst { allUsers, isAdmin, user, notifications = [] } = userStore;\n\t\tconst { races } = raceStore;\n\t\tconst { newsList } = newsStore;\n\t\tconst news = newsList && newsList[0] ? newsList[0] : null;\n\t\tconst { darkmode, language = 'en' } = appState;\n\t\tconst { showNews, hideRaces } = this.state;\n        const { toggleFeature = {} } = user;\n\n        return (\n            <div class='row'>\n                {hideRaces || toggleFeature.racesFrontpage ? <>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-1'>\n                        <div class='row'>\n                            <div class={`col-12 bg-${darkmode ? 'black' : 'white'} rounded-lg position-relative`}>\n                                <div class='w-100 d-flex justify-content-center'>\n                                    <button class='btn btn-block btn-link' onClick={this.toggleRaces}>\n                                        <i class='fas fa-angle-down' /> <Text id='races.show-races'>Show Races</Text>\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </> : <>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-3'>\n                        <div class='row'>\n                            {races && races.sort((a, b) => a.startDate - b.startDate).reverse().map(race =>  {\n                                const today = new Date();\n                                let status = '';\n                                if (today >= new Date(race.startDate) && today <= new Date(race.endDate)) {\n                                    status = 'race';\n                                } else if (today >= new Date(race.signupStartDate) && today <= new Date(race.signupEndDate)) {\n                                    status = 'signup';\n                                } else if (today > new Date(race.endDate)) {\n                                    return (<></>);\n                                }\n\n                                return (<>\n                                    <div class={`col-12 mb-0 bg-${darkmode ? 'black' : 'white'} rounded-lg position-relative`}>\n                                        <div class='row d-flex align-items-center position-relative'>\n                                            <h5 class='position-absolute' style='top: 3px; right: 5px;'>\n                                                {status === 'signup' && <>\n                                                    <span class='badge badge-primary border border-white ml-2'><Text id='races.signup-open'>Påmelding åpen</Text></span>\n                                                </>}\n                                                {status === 'race' && <>\n                                                    <span class='badge badge-danger border border-white ml-2'><Text id='races.race-in-progress'>Løp pågår</Text></span>\n                                                </>}\n                                                {status === 'done' && <>\n                                                    <span class='badge badge-success border border-white ml-2'><Text id='races.race-finished'>Løp avsluttet</Text></span>\n                                                </>}\n                                            </h5>\n                                            {(race.images && race.images[0]) ? <img src={race.images[0].s3LargeLink} class='img-fluid' /> : ''}\n                                        </div>\n                                        <div class='position-relative'>\n                                            <h5 class='position-absolute' style='top: 10px; right: 10px;'>\n                                                {status === 'signup' && <>\n                                                    <div class='spinner-grow text-primary' role='status' />\n                                                </>}\n                                                {status === 'race' && <>\n                                                    <div class='spinner-grow text-danger' role='status' />\n                                                </>}\n                                                {status === 'done' && <>\n                                                    <span><i class='fas fa-check text-success' /></span>\n                                                </>}\n                                            </h5>\n                                            <h5 class='pt-2'>\n                                                {isAdmin && <i class={`fas fa-eye${race.active ? ' text-success' : '-slash text-danger'} float-right`} />}\n                                                {race.title}\n                                            </h5>\n                                        </div>\n                                        <div class='w-100'>\n                                            <Markdown markdown={replaceImages(race.ingress, race.images, language)} markdownOpts={MARKDOWN_OPTIONS} />\n                                        </div>\n                                        <div class='w-100 d-flex justify-content-left mt-2'>\n                                            {race.classes && <>\n                                                <div class='mb-3'>\n                                                    <small class='font-weight-lighter mr-2'><Text id='races.classes'>Klasser</Text>: </small><br />\n                                                    {race.classes.sort((a, b) => a.distance - b.distance).map(currentClass => <>\n                                                        <span class='badge badge-pill badge-light mr-2 font-weight-light'>\n                                                            {currentClass.title}\n                                                            {/* <span class='badge badge-info ml-2 font-weight-light'>{currentClass.contestants.length}</span> */}\n                                                        </span>\n                                                    </>)}\n                                                </div>\n                                            </>}\n                                        </div>\n                                        <div class='w-100 d-flex justify-content-end'>\n                                            <a href={`/app-races/${race.id}`} class='btn btn-primary stretched-link'>\n                                                <Text id='races.read-more'>Les mer</Text>\n                                                <i class='fas fa-angle-double-right ml-2' />\n                                            </a>\n                                        </div>\n                                        <div class='w-100 d-flex justify-content-center'>\n                                            <small class='text-muted'>\n                                                <Text id='races.race-days'>Løpsdager</Text>: {race.startDate && <>{util.formatDate(race.startDate, { locale: language })}</>}\n                                                {race.endDate && <> - {util.formatDate(race.endDate, { locale: language })}</>}\n                                            </small>\n                                        </div>\n                                    </div>\n                                </>);\n                            })}\n                            <div class={`col-12 mb-3 bg-${darkmode ? 'black' : 'white'} rounded-lg position-relative`}>\n                                <div class='w-100 d-flex justify-content-center'>\n                                    <button class='btn btn-link' onClick={this.toggleRaces}>\n                                        <i class='fas fa-angle-up' /> <Text id='races.hide'>Hide</Text>\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </>}\n            </div>\n        );\n    }\n}\n\nexport default Races;\n"],"sourceRoot":""}