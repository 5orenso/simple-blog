{"version":3,"sources":["webpack:///./components/public/heatmap.js","webpack:///./routes/public/race/submenu.js","webpack:///./routes/public/race/commentAdd.js","webpack:///./routes/public/race/style.css","webpack:///./routes/public/race/header.js","webpack:///./routes/public/race/commentReply.js","webpack:///./routes/public/race/comments.js","webpack:///./routes/public/race/raceText.js","webpack:///./routes/public/race/detail-signup.js","webpack:///./routes/public/race/detail.js"],"names":["initialState","showAddComment","Heatmap","observer","Component","constructor","props","super","this","state","updateTimer","inputRef","setState","isLoading","adminStore","stores","raceid","getPublicHeatmap","componentDidMount","loadHeatmap","render","waypoints","zoomToMarkers","mapid","fullscreenMap","publicHeatmap","heatmap","mapId","length","minZoom","maxZoom","height","key","mu","marginTop","marginBottom","subMenuMarginTop","email","submenu","jwtToken","util","getJwtToken","PublicRaceDetail","appState","path","darkmode","currentMenu","match","class","style","href","id","RaceAdd","beforeImagesUploaded","sendButtonEnabled","afterImagesUploaded","commentRace","async","callback","inputRefObject","race","raceStore","comment","showAddImage","response","status","body","images","resizeTextarea","addImage","addImages","value","push","handleImageErrored","e","image","target","onerror","setTimeout","src","Date","userStore","user","displayNameShort","userImage","displayName","undefined","s3SmallLink","for","type","placeholder","onInput","linkState","onKeyUp","onFocus","ref","data-id","onClick","disabled","isArray","map","img","onError","removeImage","data-name","name","object","updateField","before","after","autoOpen","module","exports","menu","profile","main","searchText","Navigation","toggleDropdown","menuName","dataset","parentNode","toggleDarkmode","toggleViewmode","mode","reloadApp","window","location","reload","adminLoadAll","getInfo","changeLanguage","lang","console","log","setLanguage","language","search","route","notifications","filter","read","className","activeClassName","selected","RaceCommentReply","commentId","commentReplyRace","showAllComments","showAllReplies","viewImageIdx","likeComment","likeReply","showOriginal","RaceComments","addLikeComment","closest","likeRaceComment","replyId","likeRaceCommentReply","replyComment","parentElement","focus","toggleComments","toggleReplies","toggleMenu","showMenu","showDeleteComment","showEdit","toggleEdit","commentEditText","toggleDeleteComment","deleteComment","deleteCommentRace","deleteCommentReply","commentid","deleteCommentReplyRace","saveComment","editCommentRace","saveCommentReply","editCommentReplyRace","viewImage","idx","translate","preventDefault","stopPropagation","replyid","translatedText","translateCommentReply","translateComment","initCall","col","offset","compact","currentUser","filteredComments","totalComments","diplayedComments","comments","slice","Math","max","reverse","teams","findPublicTeamByMembers","hasLikedComment","likes","findIndex","filteredReplises","totalReplies","diplayedReplies","max_comments","imgs","toJS","imageIdx","currentImage","currentLocationGeocode","translation","getCommentTranslations","targetLang","data-comment","uuidv4","public","t","markdown","replaceImages","markdownOpts","getMarkdownOptions","onDblclick","loading","s3LargeLink","data-idx","data-commentid","formatDistance","createdDate","locale","updatedDate","reply","hasLikedReply","replyTranslation","getCommentReplyTranslations","replyBody","data-replyid","fields","more","c","text","finalText","regex","RegExp","replace","showSignup","PublicRaceDetailSignup","signupToRace","newSignup","signup","team","firstname","lastname","sportsClub","cellphone","facebook","instagram","addContestant","classId","newContestant","addSignup","toggleShowSignup","updateSignup","updateObjectKeyValue","editSignup","field","classid","contestantid","data","raceClassId","contestantId","ucfirst","clearTimeout","editClass","hide","subsection","signups","today","hasSignedup","skipTeams","parseInt","title","signupStartDate","formatDate","hour12","hour","minute","signupEndDate","signupClass","getRaceClassById","liveRace","signuppayment","paidSignupfee","role","signupfee","data-classid","data-contestantid","aria-describedby","indexOf","classes","sort","a","b","distance","currentClass","rules","checked","termsAndAgreement","declaration","routeLoginOk","routeLoginNew","routeLoginForgot","routeLogin","skipPubSub","MARGIN_TOP","MARGIN_BOTTOM","newRaceArticle","newRaceUserImage","likeRace","toggleAddComment","raceId","addRaceArticle","addArticle","newArticle","addRaceUserImage","addUserImage","newUserImage","updateUserImageUpload","updateArticleUpload","removeRaceArticle","removeArticle","articleId","removeRaceUserImage","removeUserImage","userImageId","editRaceArticle","raceArticleId","editArticle","editRaceUserImage","raceUserImageId","editUserImage","resizeAllTextareas","textareaList","document","getElementsByTagName","i","l","el","element","scrollHeight","load","countAll","resetSignup","contestants","updateKeyValue","loadRace","componentWillReceiveProps","nextProps","isAdmin","section","totalClasses","totalContestants","hasLikedRace","startDate","endDate","s3XXLargeLink","active","useEffect","tag","split","rel","native","contactEmail","locationCity","locationCountry","veterinaryInfo","checkpoints","trailDescription","program","prices","articles","currentArticle","date","ingress","startTime","endTime","cols","data-field","linkstate","saved","userImages","currentUserImage"],"mappings":"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","file":"11.chunk.10773.esm.js","sourcesContent":["import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport { toJS } from 'mobx'\n\nimport Map from '../../components/map';\n\nimport mu from '../../lib/musher-util';\n\nconst initialState = {\n\tshowAddComment: false,\n};\n\n@observer\nclass Heatmap extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n        this.updateTimer = {};\n\t\tthis.inputRef = {};\n    }\n\n\tasync loadHeatmap() {\n\t\tthis.setState({ isLoading: true });\n\t\tconst { adminStore } = this.props.stores;\n        const { raceid } = this.props;\n        await adminStore.getPublicHeatmap(raceid);\n\t\tthis.setState({ isLoading: false });\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.loadHeatmap();\n\t}\n\n    // componentWillReceiveProps() {\n\t// \tthis.loadHeatmap();\n\t// }\n\n    render() {\n        const { adminStore } = this.props.stores;\n        const { waypoints, zoomToMarkers, mapid, fullscreenMap } = this.props;\n        const { publicHeatmap: heatmap } = adminStore;\n        // const heatmap = publicHeatmap.slice(0, 10);\n        // const heatmap = [[60.4433,8.8996,14],[61.384,9.1152,14],[60.42,8.9422,15]];\n\n        return (\n            <>\n                {/* heatmap: {`map-${mapid}`}<br /> */}\n                {/* {JSON.stringify(heatmap)} */}\n                <Map\n                    stores={this.props.stores}\n                    mapId={heatmap.length}\n                    heatmap={heatmap}\n                    minZoom={2}\n                    maxZoom={18}\n                    height={600}\n                    waypoints={waypoints}\n                    zoomToMarkers={zoomToMarkers}\n                    fullscreenMap={fullscreenMap}\n                    key={`map-${mapid}`}\n                />\n            </>\n        );\n    }\n}\n\nexport default Heatmap;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport linkstate from 'linkstate';\n\nimport Header from './header';\nimport Heatmap from '../../../components/public/heatmap';\n\nimport mu from '../../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(true);\nconst MARGIN_BOTTOM = mu.marginBottom();\nconst SUB_MENU_MARGIN_TOP = mu.subMenuMarginTop();\n\nconst initialState = {\n\tisLoading: false,\n\temail: '',\n\tsubmenu: 'ads',\n\tjwtToken: util.getJwtToken(),\n};\n\n@observer\nclass PublicRaceDetail extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\trender() {\n\t\tconst { appState } = this.props.stores;\n\t\tconst { raceid, path } = this.props;\n\t\tconst { darkmode } = appState;\n\n        let currentMenu = 'default';\n        if (path.match(/\\/race\\/:raceid$/)) {\n            currentMenu = 'default';\n        } else if (path.match(/\\/race\\/:raceid\\/mushers$/)) {\n            currentMenu = 'mushers';\n        } else if (path.match(/\\/race\\/:raceid\\/results$/)) {\n            currentMenu = 'results';\n        } else if (path.match(/\\/race\\/:raceid\\/media$/)) {\n            currentMenu = 'media';\n        } else if (path.match(/\\/race\\/:raceid\\/tracking$/)) {\n            currentMenu = 'tracking';\n        }\n\n\t\treturn (\n\t\t\t<>\t\t\t\t\n                <div class='row fixed-top pr-3' style={`margin-top: 40px; background-color: ${darkmode ? '#191d21' : '#f8f9fa'};`}>\n\n                    <div class='col-12 my-2 mx-2'>\n                        <ul class='nav nav-pills nav-fill flex-nowrap'>\n                            <li class='nav-item' style='max-width: 20%;'>\n                                <a href={`/race/${raceid}`} class={`text-overflow nav-link ${currentMenu === 'default' ? 'active' : ''}`}>\n                                    <nobr><i class='fas fa-info-circle' /> <Text id='race.therace'>Løpet</Text></nobr>\n                                </a>\n                            </li>\n                            <li class='nav-item' style='max-width: 20%;'>\n                                <a href={`/race/${raceid}/mushers`} class={`text-overflow nav-link ${currentMenu === 'mushers' ? 'active' : ''}`}>\n                                    <nobr><i class='fas fa-users' /> <Text id='race.mushers'>Deltakere</Text></nobr>\n                                </a>\n                            </li>\n                            <li class='nav-item' style='max-width: 20%;'>\n                                <a href={`/race/${raceid}/results`} class={`text-overflow nav-link ${currentMenu === 'results' ? 'active' : ''}`}>\n                                    <nobr><i class='fas fa-poll' /> <Text id='race.results'>Resultater</Text></nobr>\n                                </a>\n                            </li>\n                            <li class='nav-item' style='max-width: 20%;'>\n                                <a href={`/race/${raceid}/media`} class={`text-overflow nav-link ${currentMenu === 'media' ? 'active' : ''}`}>\n                                    <nobr><i class='fas fa-images' /> <Text id='race.media'>Bilder</Text></nobr>\n                                </a>\n                            </li>\n                            <li class='nav-item' style='max-width: 20%;'>\n                                <a href={`/race/${raceid}/tracking`} class={`text-overflow nav-link ${currentMenu === 'tracking' ? 'active' : ''}`}>\n                                    <nobr><i class='fas fa-map-marked-alt' /> <Text id='race.tracking'>Tracking</Text></nobr>\n                                </a>\n                            </li>\n                        </ul>\n                    </div>\n\n\n                    {/* <div class={`col text-center subtopmenu ${path.match(/\\/race\\/:raceid$/) ? 'border-bottom border-primary' : ''}`}>\n                        <a href={`/race/${raceid}`} class={`text-${path.match(/\\/race\\/:raceid$/) ? 'primary' : 'secondary'} stretched-link`}>\n                            <nobr><i class='fas fa-chart-line' /> <Text id='race.therace'>Løpet</Text></nobr>\n                        </a>\n                    </div>\n                    <div class={`col text-center subtopmenu ${path.match(/\\/race\\/:raceid\\/mushers$/) ? 'border-bottom border-primary' : ''}`}>\n                        <a href={`/race/${raceid}/mushers`} class={`text-${path.match(/\\/race\\/:raceid\\/mushers$/) ? 'primary' : 'secondary'} stretched-link`}>\n                            <nobr><i class='fas fa-chart-line' /> <Text id='race.mushers'>Deltakere</Text></nobr>\n                        </a>\n                    </div>\n                    <div class={`col text-center subtopmenu ${path.match(/\\/race\\/:raceid\\/results$/) ? 'border-bottom border-primary' : ''}`}>\n                        <a href={`/race/${raceid}/results`} class={`text-${path.match(/\\/race\\/:raceid\\/results$/) ? 'primary' : 'secondary'} stretched-link`}>\n                            <nobr><i class='fas fa-chart-line' /> <Text id='race.results'>Resultater</Text></nobr>\n                        </a>\n                    </div>\n                    <div class={`col text-center subtopmenu ${path.match(/\\/race\\/:raceid\\/tracking$/) ? 'border-bottom border-primary' : ''}`}>\n                        <a href={`/race/${raceid}/tracking`} class={`text-${path.match(/\\/race\\/:raceid\\/tracking$/) ? 'primary' : 'secondary'} stretched-link`}>\n                            <nobr><i class='fas fa-chart-line' /> <Text id='race.tracking'>Tracking</Text></nobr>\n                        </a>\n                    </div> */}\n                </div>\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default PublicRaceDetail;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer, withText } from 'preact-i18n';\nimport linkState from 'linkstate';\n\nimport Images from '../../../components/form/images';\n\nimport mu from '../../../lib/musher-util';\n\n@observer\nclass RaceAdd extends Component {\n     constructor(props) {\n        super(props);\n        this.state = {\n            comment: {\n                body: '',\n                images: [],\n            },\n            showAddImage: false,\n            sendButtonEnabled: true,\n        };\n        this.inputRef = {};\n    }\n\n    beforeImagesUploaded = () => {\n        this.setState({ sendButtonEnabled: false });\n    }\n\n    afterImagesUploaded = () => {\n        this.setState({ sendButtonEnabled: true });\n    }\n\n    commentRace = async () => {\n        const { sendButtonEnabled } = this.state;\n        if (!sendButtonEnabled) {\n            return false;\n        }\n        const { callback = () => {}, inputRefObject = {} } = this.props;\n        const { race } = this.props;\n\t\tconst { raceStore } = this.props.stores;\n        const { comment, showAddImage } = this.state;\n        this.setState({ sendButtonEnabled: false });\n\t\tconst response = await raceStore.commentRace({ id: race.id, comment });\n\t\tif (response && response.status === 200) {\n            this.setState({\n                comment: {\n                    body: '',\n                    images: [],\n                },\n            }, () => {\n                mu.resizeTextarea(inputRefObject[race.id]);\n                if (showAddImage) {\n                    this.addImage();\n                }\n            });\n            callback({ race, response });\n\t\t}\n        this.setState({ sendButtonEnabled: true });\n\t}\n\n    addImages = ({ value }) => {\n        // updateField({ id: object.id, field: 'images', value: images, skipTimer: true });\n        const { comment } = this.state;\n        comment.images.push(...value);\n        this.setState({ comment });\n    }\n\n    addImage = () => {\n        const { showAddImage = false } = this.state;\n        this.setState({\n            showAddImage: !showAddImage,\n        });\n    }\n\n    handleImageErrored = (e) => {\n        const image = e.target;\n        image.onerror = null;\n        setTimeout(() => {\n            image.src += `?${new Date()}`;\n        }, 1000);\n    }\n\n    render() {\n        const { inputRef, race } = this.props;\n        const { comment, showAddImage, sendButtonEnabled } = this.state;\n        const { userStore } = this.props.stores;\n        const { user = {} } = userStore;\n        const displayNameShort = mu.displayNameShort(user);\n        const displayName = mu.displayName(user);\n        const userImage = user.image || (user.images ? user.images[0] : undefined);\n\n        return (<>\n            <div>\n                <div class='d-flex mb-0 position-relative w-100'>\n                    <div \n                        class={`text-center border rounded-circle imageRounded imageRoundedSmall`}\n                        style={`${userImage ? `background-image: url('${userImage.s3SmallLink}'); background-size: cover;` : ''} border-width: 3px !important;`}\n                    >\n                        {!userImage && <span class='font-weight-lighter' style='font-size: 15px;'>{displayNameShort}</span>}\n                    </div>\n                    <div class='col pl-3' style='line-height: 1.2em;'>\n\n                        <div class='d-flex bd-highlight'>\n                            <div class='p-0 w-100 bd-highlight'>\n                                <label class='sr-only' for='inlineFormInput'><Text id='comments.comment'>Kommentar</Text></label>\n                                <div class='border rounded rounded-lg position-relative'>\n                                    <Localizer>\n                                        <textarea\n                                            class='form-control-plaintext px-2'\n                                            type='text'\n                                            placeholder={<Text id='comments.write-comment'>Skriv en kommentar...</Text>}\n                                            onInput={linkState(this, 'comment.body')}\n                                            onKeyUp={mu.resizeTextarea}\n                                            onFocus={mu.resizeTextarea}\n                                            style='height: 2.3em;'\n                                            value={comment.body}\n                                            ref={inputRef}\n                                        />\n                                    </Localizer>\n\n                                    <div class='position-absolute' style='top: 8px; right: 10px; font-size: 1.2em;'>\n                                        <i class='fas fa-image pointerCursor'\n                                            data-id={race.id}\n                                            onClick={this.addImage}\n                                        />\n                                    </div>\n                                </div>\n                            </div>\n                            <div class='p-0 pl-2 flex-shrink-1 bd-highlight'>\n                                <button type='button' class={`btn btn-${sendButtonEnabled ? 'primary' : 'secondary'} mb-2`} disabled={!sendButtonEnabled}\n                                    onClick={this.commentRace}\n                                ><i class='fas fa-paper-plane' /></button>\n                            </div>\n                        </div>\n\n                    </div>\n                </div>\n                {showAddImage && <>\n                    <div class='col-12 text-center'>\n                        <div class='container-fluid'>\n                            <div class='row'>\n                                {util.isArray(comment.images) && comment.images.map(img => (\n                                    <div class='col-3 p-1'>\n                                        <img src={img.s3SmallLink} class='img-fluid' onError={this.handleImageErrored} />\n                                        <button class='btn btn-sm btn-link'\n                                            onClick={this.removeImage}\n                                            data-name={img.name}\n                                        ><i class='fas fa-trash' /> <Text id='comments.remove-image'>Remove</Text></button>\n                                    </div>\n                                ))}\n                            </div>\n                        </div>\n                        <Images object={comment} updateField={this.addImages} before={this.beforeImagesUploaded} after={this.afterImagesUploaded} autoOpen={true} />\n                    </div>\n                </>}\n            </div>\n        </>);\n    }\n}\n\nexport default RaceAdd;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"pointerCursor\":\"pointerCursor__1W6mM\"};","import { h, Component } from 'preact';\nimport { Link } from 'preact-router/match';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport linkState from 'linkstate';\nimport { route } from 'preact-router';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport style from './style.css';\n\n\nconst initialState = {\n    menu: {\n\t\tprofile: false,\n\t\tmain: false,\n\t},\n\tsearchText: '',\n};\n\n@observer\nclass Navigation extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\ttoggleDropdown = (e) => {\n\t\tconst { menu } = this.state;\n\t\tlet menuName = e.target.dataset.name;\n\t\tif (!menuName && e.target.parentNode) {\n\t\t\tmenuName = e.target.parentNode.dataset.name;\n\t\t}\n\t\tif (menuName) {\n\t\t\tmenu[menuName] = !menu[menuName];\n\t\t}\n\t\tthis.setState({ menu });\n\t}\n\n\ttoggleDarkmode = (e) => {\n        const { appState } = this.props.stores;\n\t\tappState.toggleDarkmode();\n\t\tthis.toggleDropdown(e);\n\t}\n\n\ttoggleViewmode = (e) => {\n        const { appState } = this.props.stores;\n\t\tlet mode = e.target.dataset.mode;\n\t\tif (!mode && e.target.parentNode) {\n\t\t\tmode = e.target.parentNode.dataset.mode;\n\t\t}\n\t\tappState.toggleViewmode(mode);\n\t\tthis.toggleDropdown(e);\n\t}\n\n\treloadApp = () => {\n\t\twindow.location.reload(true);\n\t}\n\n\tadminLoadAll = async (e) => {\n        const { userStore } = this.props.stores;\n        await userStore.getInfo(true);\n\t}\n\n\tchangeLanguage = (e) => {\n\t\tconst lang = e.target.value;\n\t\tconsole.log('changeLanguage', lang);\n\t\tconst { appState, userStore } = this.props.stores;\n\t\tconst { user = {} } = userStore;\n\t\tif (user.email) {\n\t\t\tuserStore.setLanguage({ email: user.email, language: lang });\n\t\t}\n\t\tappState.setLanguage(lang);\n\t}\n\n\tsearch = () => {\n\t\tconst { searchText } = this.state;\n\t\troute(`/search/${searchText}`);\n\t}\n\n    render() {\n\t\tconst { menu, searchText } = this.state;\n        const { appState, userStore } = this.props.stores;\n        const { darkmode, viewmode, isCordova } = appState;\n\t\tconst { allUsers, isAdmin, user, notifications = [] } = userStore;\n\t\tconst unreadNotificatins = notifications.filter(e => !e.read);\n\t\tconst unread = unreadNotificatins.length || 0;\n\t\tconst { language = 'en' } = user;\n\n\t\treturn (\n\t\t\t<nav class='navbar navbar-expand-lg navbar-themed fixed-top py-1' style='z-index: 99999;'>\n\t\t\t\t<a class='navbar-brand' href='/race/'>\n\t\t\t\t\t{/* <img src={`./assets/logo-jul-2020-v2-${darkmode ? 'black' : 'white'}.png`} height='30' class='position-absolute' style='top: 8px; left: 6px' /> */}\n\t\t\t\t\t<img src={`./assets/homerun-race-logo-2-${darkmode ? 'white-' : ''}small.png`} height='37' class='position-absolute' style='top: 5px; left: 6px' />\n\t\t\t\t\t<span class='font-weight-normal' style='margin-left: 30px; font-size: 20px;'>Homerun Race</span>\n\t\t\t\t</a>\n\n\t\t\t\t<button class='navbar-toggler' type='button'\n\t\t\t\t\tdata-name='main'\n\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t>\n\t\t\t\t\t<span class='navbar-toggler-icon' />\n\t\t\t\t</button>\n\n\t\t\t\t<div class={`collapse navbar-collapse ${menu.main ? 'show' : ''}`} id='navbarSupportedContent'>\n\t\t\t\t\t<ul class='navbar-nav mr-auto ml-5'>\n\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/race'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tstyle='font-size: 1.0em !important;'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='fas fa-flag-checkered' /> <Text id='header.races'>Løpene</Text></Link>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/race/support'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tstyle='font-size: 1.0em !important;'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='far fa-question-circle' /> <Text id='header.support'>Support</Text></Link>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/race/news'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tstyle='font-size: 1.0em !important;'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='fas fa-quote-right' /> <Text id='header.news'>Nyheter</Text></Link>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t{/* <li class='nav-item'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='fas fa-dog' /> <Text id='header.backtoapp'>The Musher</Text></Link>\n\t\t\t\t\t\t</li> */}\n\t\t\t\t\t\t{/* <li class='nav-item'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/news'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='fas fa-quote-right' /> <Text id='header.news'>Nyheter</Text></Link>\n\t\t\t\t\t\t</li> */}\n\t\t\t\t\t\t{/* <li class='nav-item d-block d-lg-none'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/howto'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='fas fa-quote-right' /> <Text id='header.howto'>Hvordan gjør man det?</Text></Link>\n\t\t\t\t\t\t</li> */}\n\t\t\t\t\t</ul>\n\n\t\t\t\t\t<ul class='navbar-nav ml-auto '>\n\t\t\t\t\t\t{/* <li class='nav-item mr-2'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'}\n\t\t\t\t\t\t\t\thref='/users/notifications'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<i class='fas fa-bell mr-1' />\n\t\t\t\t\t\t\t\t{unread > 0 && <>\n\t\t\t\t\t\t\t\t\t<span class='badge badge-pill badge-danger'>{unread > 9 ? '9+' : unread}</span>\n\t\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</li> */}\n\t\t\t\t\t\t<li class='nav-item mr-2'>\n\t\t\t\t\t\t\t<div class='form-row align-items-center'>\n\t\t\t\t\t\t\t\t<div class='col-auto my-1' style='width: 80px;'>\n\t\t\t\t\t\t\t\t\t<select class='custom-select'\n\t\t\t\t\t\t\t\t\t\tstyle='background-color: inherit; border: none; padding: 0; height: 1.1em; font-size: 0.9em;'\n\t\t\t\t\t\t\t\t\t\tonInput={this.changeLanguage}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<option value='no' selected={language === 'no'}>🇳🇴 NO</option>\n\t\t\t\t\t\t\t\t\t\t<option value='en' selected={language === 'en'}>🇬🇧 EN</option>\n\t\t\t\t\t\t\t\t\t\t<option value='es' selected={language === 'es'}>🇪🇸 ES</option>\n\t\t\t\t\t\t\t\t\t\t<option value='de' selected={language === 'de'}>🇩🇪 DE</option>\n\t                                    <option value='fr' selected={language === 'fr'}>🇫🇷 FR</option>\n\t                                    <option value='ru' selected={language === 'ru'}>🇷🇺 RU</option>\n\t                                    <option value='se' selected={language === 'se'}>🇸🇪 SE</option>\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class='nav-item d-block d-lg-none'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'}\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tonClick={this.toggleDarkmode}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<i class={`${darkmode ? 'fas text-warning' : 'far'} fa-moon`} /> <Text id='header.darkmode'>Nattmodus</Text>\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class='nav-item mr-2 d-none d-lg-block'>\n\t\t\t\t\t\t\t<button class='btn btn-link'\n\t\t\t\t\t\t\t\tdata-name='profile'\n\t\t\t\t\t\t\t\tonClick={this.toggleDarkmode}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<i class={`${darkmode ? 'fas text-warning' : 'far'} fa-moon`} />\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t{/* <li class='nav-item ml-auto d-none d-lg-block'>\n\t\t\t\t\t\t\t<form class='form-inline my-2 my-lg-0'>\n\t\t\t\t\t\t\t\t<Localizer>\n\t\t\t\t\t\t\t\t\t<input class='form-control form-control-sm mr-sm-2' type='search' placeholder={<Text id='header.search-placeholder'>Søk etter det meste...</Text>}\n\t\t\t\t\t\t\t\t\t\tvalue={searchText}\n\t\t\t\t\t\t\t\t\t\tonInput={linkState(this, 'searchText')}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Localizer>\n\t\t\t\t\t\t\t\t<button class='btn btn-sm btn-outline-success my-2 my-sm-0' type='button'\t\n\t\t\t\t\t\t\t\t\tonClick={this.search}\n\t\t\t\t\t\t\t\t><Text id='header.search'>Søk</Text></button>\n\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t</li> */}\n\t\t\t\t\t</ul>\n\n\t\t\t\t    \n\n\t\t\t\t</div>\n\t\t\t</nav>\n\t\t);\n\t}\n}\n\nexport default Navigation;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer, withText } from 'preact-i18n';\nimport linkState from 'linkstate';\n\nimport mu from '../../../lib/musher-util';\n\n@observer\nclass RaceCommentReply extends Component {\n    commentRace = async () => {\n        const { callback = () => {}, commentId } = this.props;\n        const { race } = this.props;\n\t\tconst { raceStore } = this.props.stores;\n        const { comment = '' } = this.state;\n\t\tconst response = await raceStore.commentReplyRace({ id: race.id, commentId, comment });\n\t\tif (response && response.status === 200) {\n            this.setState({\n                comment: '',\n            });\n            callback({ race, response });\n\t\t}\n\t}\n\n    render() {\n        const { inputRef } = this.props;\n        const { comment } = this.state;\n        const { userStore } = this.props.stores;\n        const { user = {} } = userStore;\n        const displayNameShort = mu.displayNameShort(user);\n        const displayName = mu.displayName(user);\n        const userImage = user.image || (user.images ? user.images[0] : undefined);\n\n        return (\n            <div class='w-100'>\n                <div class='d-flex mb-0 position-relative w-100'>\n                    <div \n                        class={`text-center border rounded-circle imageRounded imageRoundedThumb`}\n                        style={`${userImage ? `background-image: url('${userImage.s3SmallLink}'); background-size: cover;` : ''} border-width: 3px !important;`}\n                    >\n                        {!userImage && <span class='font-weight-lighter' style='font-size: 15px;'>{displayNameShort}</span>}\n                    </div>\n                    <div class='col pl-3' style='line-height: 1.2em;'>\n\n                        <div class='d-flex bd-highlight'>\n                            <div class='p-0 w-100 bd-highlight'>\n                                <label class='sr-only' for='inlineFormInput'><Text id='comments.comment'>Kommentar</Text></label>\n                                <Localizer>\n                                    <textarea\n                                        class='form-control rounded-lg'\n                                        type='text'\n                                        placeholder={<Text id='comments.write-reply'>Write a reply...</Text>}\n                                        onInput={linkState(this, 'comment')}\n                                        onKeyUp={mu.resizeTextarea}\n                                        onFocus={mu.resizeTextarea}\n                                        style='height: 2.3em;'\n                                        value={comment}\n                                        ref={inputRef}\n                                    />\n                                </Localizer>\n                            </div>\n                            <div class='p-0 pl-2 flex-shrink-1 bd-highlight'>\n                                <button type='button' class='btn btn-sm btn-primary mb-2'\n                                    onClick={this.commentRace}\n                                ><i class='fas fa-paper-plane' /></button>\n                            </div>\n                        </div>\n\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default RaceCommentReply;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { toJS } from 'mobx';\nimport { Text, Localizer, withText } from 'preact-i18n';\nimport Markdown from 'preact-markdown';\nimport linkState from 'linkstate';\n\nimport RaceReplyComment from './commentReply';\n\nimport mu from '../../../lib/musher-util';\n\nconst initialState = {\n    showAddComment: {},\n    showAllComments: false,\n    showAllReplies: {},\n    viewImageIdx: {},\n    likeComment: {},\n    likeReply: {},\n    showOriginal: {},\n};\n\nconst MAX_COMMENTS = 2;\n\n@observer\nclass RaceComments extends Component {\n     constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n        this.inputRef = {};\n    }\n\n    addLikeComment = async (e) => {\n        const { callback = () => {} } = this.props;\n        const commentId = e.target.closest('.commentContainer').dataset.id;\n        const { race } = this.props;\n\t\tconst { raceStore } = this.props.stores;\n\n        const { likeComment } = this.state;\n        likeComment[commentId] = true;\n        this.setState({ likeComment });\n        setTimeout(() => {\n            const { likeComment } = this.state;\n            delete likeComment[commentId];\n            this.setState({ likeComment });\n        }, 1200);\n\n\t\tconst response = await raceStore.likeRaceComment({ id: race.id, commentId });\n\t\tif (response && response.status === 200) {\n            callback({ type: 'likeComment', race, commentId, response });\n\t\t}\n        return true;\n    }\n\n    likeReply = async (e) => {\n        const { callback = () => {} } = this.props;\n        const replyId = e.target.closest('.replyContainer').dataset.id;\n        const commentId = e.target.closest('.replyContainer').dataset.comment;\n        const { race } = this.props;\n\t\tconst { raceStore } = this.props.stores;\n\n        const { likeReply } = this.state;\n        likeReply[replyId] = true;\n        this.setState({ likeReply });\n        setTimeout(() => {\n            const { likeReply } = this.state;\n            delete likeReply[replyId];\n            this.setState({ likeReply });\n        }, 1200);\n\n\t\tconst response = await raceStore.likeRaceCommentReply({ id: race.id, replyId, commentId });\n        if (response && response.status === 200) {\n            callback({ type: 'likeReply', race, commentId, replyId, response });\n\t\t}\n    }\n\n    replyComment = async (e) => {\n        const commentId = e.target.parentElement.dataset.id || e.target.dataset.id;\n\n        const { showAddComment } = this.state;\n        showAddComment[commentId] = !showAddComment[commentId];\n\t\tthis.setState({\n\t\t\tshowAddComment,\n\t\t}, () => {\n            if (this.inputRef[commentId]) {\n                this.inputRef[commentId].focus();\n            }\n\t\t});\n    }\n\n    toggleComments = () => {\n\t\tconst { showAllComments } = this.state;\n\t\tthis.setState({\n\t\t\tshowAllComments: !showAllComments,\n\t\t});\n\t}\n\n    toggleReplies = (e) => {\n        const commentId = e.target.parentElement.dataset.id || e.target.dataset.id;\n\t\tconst { showAllReplies } = this.state;\n        showAllReplies[commentId] = !showAllReplies[commentId];\n\t\tthis.setState({\n\t\t\tshowAllReplies,\n\t\t});\n\t}\n\n    toggleMenu = (e) => {\n        const { id } = e.target.closest('i').dataset;\n\t\tconst { showMenu = {} } = this.state;\n        showMenu[id] = !showMenu[id];\n\t\tthis.setState({\n            showDeleteComment: {},\n            showEdit: {},\n\t\t\tshowMenu,\n\t\t});\n\t}\n\n    toggleEdit = (e) => {\n        const { id, comment: commentEditText } = e.target.closest('button').dataset;\n\t\tconst { showEdit = {} } = this.state;\n        showEdit[id] = !showEdit[id];\n\t\tthis.setState({\n            showDeleteComment: {},\n\t\t\tshowEdit,\n            showMenu: {},\n            commentEditText,\n\t\t});\n\t}\n\n    toggleDeleteComment = (e) => {\n        const { id } = e.target.closest('button').dataset;\n\t\tconst { showDeleteComment = {} } = this.state;\n        showDeleteComment[id] = !showDeleteComment[id];\n\t\tthis.setState({\n\t\t\tshowDeleteComment,\n            showEdit: {},\n            showMenu: {},\n\t\t});\n\t}\n\n    deleteComment = async (e) => {\n        const { id: commentId } = e.target.closest('button').dataset;\n        const { race } = this.props;\n        const { raceStore } = this.props.stores;\n        await raceStore.deleteCommentRace({ id: race.id, commentId });\n        this.setState({\n            commentEditText: '',\n\t\t\tshowDeleteComment: {},\n            showEdit: {},\n            showMenu: {},\n\t\t});\n    }\n\n    deleteCommentReply = async (e) => {\n        const { id: replyId, commentid: commentId } = e.target.closest('button').dataset;\n        const { race } = this.props;\n        const { raceStore } = this.props.stores;\n        await raceStore.deleteCommentReplyRace({ id: race.id, commentId, replyId });\n        this.setState({\n            commentEditText: '',\n\t\t\tshowDeleteComment: {},\n            showEdit: {},\n            showMenu: {},\n\t\t});\n\n    }\n\n    saveComment = async (e) => {\n        const { id: commentId } = e.target.closest('button').dataset;\n        const { commentEditText: comment } = this.state;\n        const { race } = this.props;\n        const { raceStore } = this.props.stores;\n        await raceStore.editCommentRace({ id: race.id, commentId, comment });\n        this.setState({\n            commentEditText: '',\n\t\t\tshowDeleteComment: {},\n            showEdit: {},\n            showMenu: {},\n\t\t});\n    }\n\n    saveCommentReply = async (e) => {\n        const { id: replyId, commentid: commentId } = e.target.closest('button').dataset;\n        const { commentEditText: comment } = this.state;\n        const { race } = this.props;\n        const { raceStore } = this.props.stores;\n        await raceStore.editCommentReplyRace({ id: race.id, commentId, replyId, comment });\n        this.setState({\n            commentEditText: '',\n\t\t\tshowDeleteComment: {},\n            showEdit: {},\n            showMenu: {},\n\t\t});\n    }\n\n    viewImage = (e) => {\n\t\tconst { id, idx } = e.target.closest('img').dataset;\n        const { viewImageIdx } = this.state;\n        viewImageIdx[id] = idx;\n        this.setState({ viewImageIdx });\n    }\n\n    translate = async (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        const { replyid, commentid } = e.target.closest('button').dataset;\n        const { race } = this.props;\n        const { userStore, raceStore } = this.props.stores;\n        const { user } = userStore;\n        const { showOriginal = {}, translatedText = {} } = this.state;\n        const key = `${commentid}${replyid ? `-${replyid}`: ''}`;\n        showOriginal[key] = 0;\n        if (replyid) {\n            translatedText[key] = await raceStore.translateCommentReply({ commentid, replyid, race, user });\n        } else {\n            translatedText[key] = await raceStore.translateComment({ commentid, race, user });\n        }\n        this.setState({ showOriginal, translatedText });\n    }\n\n    showOriginal = (e) => {\n        const { replyid, commentid } = e.target.closest('button').dataset;\n        e.preventDefault();\n        e.stopPropagation();\n        const { showOriginal = {} } = this.state;\n        showOriginal[`${commentid}${replyid ? `-${replyid}`: ''}`] = 1;\n        this.setState({ showOriginal });\n    }\n\n    render() {\n        const { showAddComment, showAllComments, showAllReplies, viewImageIdx, showMenu = {}, showEdit = {},\n            showDeleteComment = {}, commentEditText, likeComment, showOriginal = {}, translatedText = {} } = this.state;\n\t\tconst { race, callback = () => {}, initCall = () => {}, col = 12, offset = 0, compact = false  } = this.props;\n        const { userStore, raceStore } = this.props.stores;\n        const { user: currentUser } = userStore;\n        const { language = 'en' } = currentUser;\n\n        let filteredComments = [];\n        let totalComments = 0;\n        let diplayedComments = 0;\n        let max_comments;\n        if (race.comments) {\n            totalComments = race.comments.length;\n            if (showAllComments) {\n                filteredComments = race.comments;\n            } else {\n                // filteredComments = race.comments.slice(0, MAX_COMMENTS);\n                const max_comments = compact ? 0 : MAX_COMMENTS;\n                filteredComments = race.comments.slice(Math.max(totalComments - max_comments, 0));\n            }\n            diplayedComments = filteredComments.length;\n        }\n\n\n        return (\n            <div class={`col-${col} offset-${offset} col-sm-8 col-lg-6 offset-sm-2 offset-lg-3`}>\n                {race && util.isArray(filteredComments) && filteredComments.reverse().map((comment) => {\n                    const { user = {} } = comment;\n                    const teams = raceStore.findPublicTeamByMembers(user.id);\n                    const displayNameShort = mu.displayNameShort(user);\n                    const displayName = mu.displayName(user);\n                    const userImage = user.image || (user.images ? user.images[0] : undefined);\n                    const hasLikedComment = comment.likes && comment.likes.findIndex(e => e.user === currentUser.id) > -1;\n\n                    let filteredReplises = [];\n                    let totalReplies = 0;\n                    let diplayedReplies = 0;\n                    if (comment.comments) {\n                        totalReplies = comment.comments.length;\n                        if (showAllReplies[comment.id]) {\n                            filteredReplises = comment.comments;\n                        } else {\n                            filteredReplises = comment.comments.slice(0, max_comments);\n                        }\n                        diplayedReplies = filteredReplises.length;\n                    }\n\n                    const images = [];\n                    if (comment.images) {\n                        const imgs = toJS(comment.images);\n                        images.push(...imgs);\n                    }\n                    const imageIdx = viewImageIdx[comment.id] ? viewImageIdx[comment.id] : 0;\n                    const currentImage = images && images[imageIdx] ? images[imageIdx] : null;\n\n                    const { currentLocationGeocode = {} } = comment;\n\n                    const translation = raceStore.getCommentTranslations({\n                        race,\n                        commentid: comment.id,\n                        targetLang: language,\n                    }) || translatedText[comment.id];\n                    let body = translation || comment.comment;\n                    if (showOriginal[comment.id]) {\n                        body = comment.comment;\n                    }\n\n                    return (\n                        <div class='row'>\n                            <div class='col-11 offset-1 d-flex mb-2 position-relative'>\n                                <div\n                                    class={`text-center border rounded-circle imageRounded imageRoundedSmall`}\n                                    style={`${userImage ? `background-image: url(\"${userImage.s3SmallLink}\"); background-size: cover;` : ''} border-width: 3px !important;`}\n                                >\n                                    {!user.image && <span class='font-weight-lighter' style='font-size: 15px;'>{displayNameShort}</span>}\n                                </div>\n                                <div class='flex-grow-1 pl-3 pt-0' style='line-height: 1.2em;'>\n                                    <div class='bg-light p-2 rounded rounded-lg position-relative'>\n\n                                        {currentUser.id === user.id && <>\n                                            <span class='float-right font-weight-lighter text-muted'>\n                                                <i class='fas fa-ellipsis-h' onClick={this.toggleMenu} data-id={comment.id} />\n                                            </span>\n                                        </>}\n                                        {showMenu[comment.id] && <>\n                                            <div class='position-absolute bg-white p-2 border rounded rounded-lg shadow-sm' style='top: 30px; right: 10px; width: 60%; z-index: 999999;'>\n                                                <button class='btn btn-link btn-block text-left' onClick={this.toggleEdit} data-id={comment.id} data-comment={comment.comment}><i class='fas fa-edit' /> Edit</button>\n                                                <hr />\n                                                <button class='btn btn-link btn-block text-left' onClick={this.toggleDeleteComment} data-id={comment.id}><i class='fas fa-trash-alt' /> Delete</button>\n                                            </div>\n                                        </>}\n\n                                        <div>\n                                            <span style='font-size: 0.95em;'>\n                                                <h5 class='font-weight-bold mb-2' style='font-size: 1.0em;'>\n                                                    {user.uuidv4 && user.uuidv4 !== currentUser.uuidv4 ? <>\n                                                        <a href={`/inbox/${user.uuidv4}`}>{displayName}</a>\n                                                    </> : <>\n                                                        {displayName}\n                                                    </>}\n                                                    {teams && teams.length > 0 && <>\n                                                        <span class='font-weight-lighter text-muted ml-1'>\n                                                            {teams.filter(e => e.public === 1).slice(0, 1).map(t => <>\n                                                                - <a href={`/teams/public/${t.uuidv4}`}>{t.name}</a>\n                                                            </>)}\n                                                        </span>\n                                                    </>}\n                                                </h5>\n\n\n                                                {showEdit[comment.id] ? <>\n                                                    <div class='d-flex bd-highlight'>\n                                                        <div class='p-0 w-100 bd-highlight'>\n                                                            <label class='sr-only' for='inlineFormInput'><Text id='comments.comment'>Kommentar</Text></label>\n                                                            <div class='border rounded rounded-lg position-relative'>\n                                                                <Localizer>\n                                                                    <textarea\n                                                                        class='form-control-plaintext px-2'\n                                                                        type='text'\n                                                                        placeholder={<Text id='comments.write-comment'>Skriv en kommentar...</Text>}\n                                                                        onInput={linkState(this, 'commentEditText')}\n                                                                        onKeyUp={mu.resizeTextarea}\n                                                                        onFocus={mu.resizeTextarea}\n                                                                        style='height: 2.3em;'\n                                                                        value={commentEditText}\n                                                                    />\n                                                                </Localizer>\n                                                           </div>\n                                                        </div>\n                                                        <div class='p-0 pl-2 flex-shrink-1 bd-highlight'>\n                                                            <button type='button' class='btn btn-primary mb-2'\n                                                                onClick={this.saveComment}\n                                                                data-id={comment.id}\n                                                            ><i class='fas fa-paper-plane' /></button>\n                                                        </div>\n                                                    </div>\n                                                </> : <>\n                                                    <Markdown markdown={mu.replaceImages(body, comment.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                                                </>}\n                                                {showDeleteComment[comment.id] && <div class='clearfix mt-3 mb-3'>\n                                                    <button class='btn btn-danger float-left' onClick={this.deleteComment} data-id={comment.id}><i class='fas fa-trash-alt' /> Delete</button>\n                                                    <button class='btn btn-secondary float-right' onClick={this.toggleDeleteComment} data-id={comment.id}><i class='fas fa-times-circle' /> Cancel</button>\n                                                </div>}\n\n                                            </span>\n                                        </div>\n                                        <div>\n                                            <div class='container-fluid px-3 mt-1'>\n                                                {currentImage && <div class='clearfix row position-relative'>\n                                                    <div\n                                                        class={`commentContainer col-12 px-0 overflow-hidden`}\n                                                        style={`max-height: 60vh;`}\n                                                        onDblclick={this.addLikeComment}\n                                                        data-id={comment.id}\n                                                    >\n                                                        <img loading='lazy' class={`img-fluid`} style='min-width: 100px;' src={currentImage.s3LargeLink} />\n                                                    </div>\n                                                    {likeComment[comment.id] && <span class='likeHeart position-absolute text-white display-1' style='top: calc(50% - 50px); left: calc(50% - 50px); width: 100px; height: 100px;'>\n                                                        <i class='fas fa-heart likeStory' />\n                                                    </span>}\n                                                </div>}\n                                                {images && images.length > 1 && <div class='clearfix d-flex flex-wrap row'>\n                                                    {util.isArray(images) && images.map((img, idx) => {\n                                                        return (<>\n                                                            <div\n                                                                class={`col px-0 overflow-hidden`}\n                                                                style={`max-height: 100px; min-width: 100px;`}\n                                                            >\n                                                                <img loading='lazy' class={`img-fluid border`} style='min-width: 100px;' src={img.s3SmallLink} onClick={this.viewImage} data-id={comment.id} data-idx={idx} />\n                                                            </div>\n                                                        </>);\n                                                    })}\n                                                </div>}\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <small>\n                                        <button class={`commentContainer btn btn-sm btn-link py-0 ${hasLikedComment ? 'text-primary' : ''}`}\n                                            onClick={this.addLikeComment}\n                                            data-id={comment.id}\n                                            disabled={hasLikedComment}\n                                        >\n                                            {hasLikedComment ? <Text id='comments.has-liked'>Liked</Text> : <Text id='comments.like'>Lik</Text>}\n                                        </button>\n                                        -\n                                        <button class='btn btn-sm btn-link py-0'\n                                            onClick={this.replyComment}\n                                            data-id={comment.id}\n                                        >\n                                            <Text id='comments.comment-add'>Kommentar</Text>\n                                        </button>\n                                        {comment.language !== language && <>\n                                            -\n                                            {!showOriginal[comment.id] && translation ? <>\n                                                <button\n                                                    type='button'\n                                                    class='btn btn-sm btn-link'\n                                                    data-commentid={comment.id}\n                                                    onClick={this.showOriginal}\n                                                >\n                                                    <i class='fas fa-cog' />  <Text id='home.translate-show-original'>Show original</Text>\n                                                </button>\n                                            </> : <>\n                                                <button\n                                                    type='button'\n                                                    class='btn btn-sm btn-link'\n                                                    onClick={this.translate}\n                                                    data-commentid={comment.id}\n                                                >\n                                                    <i class='fas fa-cog' /> <Text id='home.translate-to'>See translation</Text>\n                                                </button>\n                                            </>}\n                                        </>}\n                                        -\n                                        <button class='btn btn-sm btn-link py-0 disabled'>\n                                            {util.formatDistance(comment.createdDate, new Date(), { locale: 'no-NB' })}\n                                            {comment.updatedDate && <>\n                                                <span class='font-weight-light ml-2'>(Edited {util.formatDistance(comment.updatedDate, new Date(), { locale: 'no-NB' })})</span>\n                                            </>}\n                                        </button>\n                                    </small>\n                                </div>\n                                {comment.likes && comment.likes.length > 0 && <small class='position-absolute bg-light shadow-sm rounded-lg py-0 px-1' style='bottom: 20px; right: 15px;'>\n                                    <i class='fas fa-thumbs-up text-primary' /> {comment.likes.length}\n                                </small>}\n                            </div>\n                            <div class='col-10 offset-2 mb-2'>\n                                {comment && util.isArray(filteredReplises) && filteredReplises.map((reply) => {\n                                    const { user = {} } = reply;\n                                    const teams = raceStore.findPublicTeamByMembers(user.id);\n                                    const displayNameShort = mu.displayNameShort(user);\n                                    const displayName = mu.displayName(user);\n                                    const userImage = user.image || (user.images ? user.images[0] : undefined);\n                                    const hasLikedReply = reply.likes && reply.likes.findIndex(e => e.user === currentUser.id) > -1;\n                                    const { currentLocationGeocode = {} } = reply;\n\n                                    const replyTranslation = raceStore.getCommentReplyTranslations({\n                                        race,\n                                        commentid: comment.id,\n                                        replyid: reply.id,\n                                        targetLang: language,\n                                    }) || translatedText[`${comment.id}-${reply.id}`];\n                                    let replyBody = replyTranslation || reply.comment;\n                                    if (showOriginal[`${comment.id}-${reply.id}`]) {\n                                        replyBody = reply.comment;\n                                    }\n\n                                    return (\n                                        <div class='row'>\n                                            <div class='col-12 d-flex mb-2 position-relative'>\n                                                <div\n                                                    class={`text-center border rounded-circle imageRounded imageRoundedSmall`}\n                                                    style={`${userImage ? `background-image: url(\"${userImage.s3SmallLink}\"); background-size: cover;` : ''} border-width: 3px !important;`}\n                                                >\n                                                    {!user.image && <span class='font-weight-lighter' style='font-size: 15px;'>{displayNameShort}</span>}\n                                                </div>\n                                                <div class='flex-grow-1 pl-3 pt-0' style='line-height: 1.2em;'>\n                                                    <div class='bg-light p-2 rounded-lg position-relative'>\n                                                    {currentUser.id === user.id && <>\n                                                            <span class='float-right font-weight-lighter text-muted'>\n                                                                <i class='fas fa-ellipsis-h' onClick={this.toggleMenu} data-id={reply.id} />\n                                                            </span>\n                                                        </>}\n                                                        {showMenu[reply.id] && <>\n                                                            <div class='position-absolute bg-white p-2 border rounded rounded-lg shadow-sm' style='top: 30px; right: 10px; width: 60%; z-index: 999999;'>\n                                                                <button class='btn btn-link btn-block text-left' onClick={this.toggleEdit} data-id={reply.id} data-comment={reply.comment}><i class='fas fa-edit' /> Edit</button>\n                                                                <hr />\n                                                                <button class='btn btn-link btn-block text-left' onClick={this.toggleDeleteComment} data-id={reply.id}><i class='fas fa-trash-alt' /> Delete</button>\n                                                            </div>\n                                                        </>}\n\n                                                        <span style='font-size: 0.95em;'>\n                                                            <h5 class='font-weight-bold mb-2' style='font-size: 1.0em;'>\n                                                                {displayName}\n                                                                {teams && teams.length > 0 && <>\n                                                                    <span class='font-weight-lighter text-muted ml-2'>\n                                                                        {teams.filter(e => e.public === 1).slice(0, 1).map(t => <>\n                                                                            - <a href={`/teams/public/${t.uuidv4}`} class='mr-2'> {t.name}</a>\n                                                                        </>)}\n                                                                    </span>\n                                                                </>}\n                                                            </h5>\n\n\n                                                            {showEdit[reply.id] ? <>\n                                                                <div class='d-flex bd-highlight'>\n                                                                    <div class='p-0 w-100 bd-highlight'>\n                                                                        <label class='sr-only' for='inlineFormInput'><Text id='comments.comment'>Kommentar</Text></label>\n                                                                        <div class='border rounded rounded-lg position-relative'>\n                                                                            <Localizer>\n                                                                                <textarea\n                                                                                    class='form-control-plaintext px-2'\n                                                                                    type='text'\n                                                                                    placeholder={<Text id='comments.write-comment'>Skriv en kommentar...</Text>}\n                                                                                    onInput={linkState(this, 'commentEditText')}\n                                                                                    onKeyUp={mu.resizeTextarea}\n                                                                                    onFocus={mu.resizeTextarea}\n                                                                                    style='height: 2.3em;'\n                                                                                    value={commentEditText}\n                                                                                />\n                                                                            </Localizer>\n                                                                    </div>\n                                                                    </div>\n                                                                    <div class='p-0 pl-2 flex-shrink-1 bd-highlight'>\n                                                                        <button type='button' class='btn btn-primary mb-2'\n                                                                            onClick={this.saveCommentReply}\n                                                                            data-commentid={comment.id}\n                                                                            data-id={reply.id}\n                                                                        ><i class='fas fa-paper-plane' /></button>\n                                                                    </div>\n                                                                </div>\n                                                            </> : <>\n                                                                <Markdown markdown={mu.replaceImages(replyBody, reply.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                                                            </>}\n                                                            {showDeleteComment[reply.id] && <div class='clearfix mt-3 mb-3'>\n                                                                <button class='btn btn-danger float-left' onClick={this.deleteCommentReply} data-id={reply.id} data-commentid={comment.id}><i class='fas fa-trash-alt' /> Delete</button>\n                                                                <button class='btn btn-secondary float-right' onClick={this.toggleDeleteComment} data-id={reply.id}><i class='fas fa-times-circle' /> Cancel</button>\n                                                            </div>}\n\n                                                        </span>\n                                                    </div>\n                                                    <small>\n                                                        <button class={`replyContainer btn btn-sm btn-link py-0 ${hasLikedReply ? 'text-primary' : ''}`}\n                                                            onClick={this.likeReply}\n                                                            data-comment={comment.id}\n                                                            data-id={reply.id}\n                                                            disabled={hasLikedReply}\n                                                        >\n                                                            {hasLikedReply ? <Text id='comments.has-liked'>Liked</Text> : <Text id='comments.like'>Lik</Text>}\n                                                        </button>\n                                                        -\n                                                        <button class='btn btn-sm btn-link py-0'\n                                                            onClick={this.replyComment}\n                                                            data-id={comment.id}\n                                                        >\n                                                            <Text id='comments.comment-add'>Kommentar</Text>\n                                                        </button>\n                                                        {reply.language !== language && <>\n                                                            -\n                                                            {!showOriginal[`${comment.id}-${reply.id}`] && replyTranslation ? <>\n                                                                <button\n                                                                    type='button'\n                                                                    class='btn btn-sm btn-link'\n                                                                    data-commentid={comment.id}\n                                                                    data-replyid={reply.id}\n                                                                    onClick={this.showOriginal}\n                                                                >\n                                                                    <i class='fas fa-cog' />  <Text id='home.translate-show-original'>Show original</Text>\n                                                                </button>\n                                                            </> : <>\n                                                                <button\n                                                                    type='button'\n                                                                    class='btn btn-sm btn-link'\n                                                                    onClick={this.translate}\n                                                                    data-commentid={comment.id}\n                                                                    data-replyid={reply.id}\n                                                                >\n                                                                    <i class='fas fa-cog' /> <Text id='home.translate-to'>See translation</Text>\n                                                                </button>\n                                                            </>}\n                                                        </>}\n                                                        -\n                                                        <button class='btn btn-sm btn-link py-0 disabled'>\n                                                            {util.formatDistance(reply.createdDate, new Date(), { locale: 'no-NB' })}\n                                                            {reply.updatedDate && <>\n                                                                <span class='font-weight-light ml-2'>(Edited {util.formatDistance(reply.updatedDate, new Date(), { locale: 'no-NB' })})</span>\n                                                            </>}\n                                                        </button>\n                                                    </small>\n                                                </div>\n                                                {reply.likes && <small class='position-absolute bg-light shadow-sm rounded-lg py-0 px-1' style='bottom: 20px; right: 15px;'>\n                                                    <i class='fas fa-thumbs-up text-primary' /> {reply.likes.length}\n                                                </small>}\n                                            </div>\n                                        </div>\n                                    );\n                                })}\n                                {totalReplies - diplayedReplies > 0 && <div>\n                                    <button class='btn btn-sm btn-link py-0'\n                                        onClick={this.toggleReplies}\n                                        data-id={comment.id}\n                                    >\n                                        <Text id='comments.show-more' fields={{ more: totalReplies - diplayedReplies }}>\n                                            Vis {totalReplies - diplayedReplies} flere kommentarer...\n                                        </Text>\n                                    </button>\n                                </div>}\n\n                            </div>\n                            {showAddComment[comment.id] && <div class='col-11 offset-1 d-flex mb-2 position-relative'>\n                                <RaceReplyComment stores={this.props.stores} race={race}\n                                    initCall={initCall}\n                                    callback={callback}\n                                    commentId={comment.id}\n                                    inputRef={c => this.inputRef[comment.id] = c}\n                                    inputRefObject={this.inputRef}\n                                    key={`race-commentreply-${comment.id}`}\n                                />\n                            </div>}\n                        </div>\n                    );\n                })}\n                {totalComments - diplayedComments > 0 && <div>\n                    <button class='btn btn-sm btn-link py-0'\n                        onClick={this.toggleComments}\n                    >\n                        <Text id='comments.show-more' fields={{ more: totalComments - diplayedComments }}>\n                            Vis {totalComments - diplayedComments} flere kommentarer...\n                        </Text>\n                    </button>\n                </div>}\n                {showAllComments && <div>\n                    <button class='btn btn-sm btn-link py-0'\n                        onClick={this.toggleComments}\n                    >\n                        <Text id='comments.hide-all-comments'>Skjul alle kommentarene.</Text>\n                    </button>\n                </div>}\n            </div>\n        );\n    }\n}\n\nexport default RaceComments;\n","import { h, Component } from 'preact';\nimport { observer } from 'mobx-preact';\n\nconst initialState = {\n};\n\n@observer\nclass RaceText extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n    render() {\n\t\tconst { appState } = this.props.stores;\n\t\tconst { text } = this.props;\n\t\tconst { darkmode, language = 'en' } = appState;\n\n        let finalText = text;\n\n        const regex = new RegExp(`/<${language}>(.*?)<\\/${language}>/`);\n        const parsedText = text.replace(regex, '$1');\n        if (parsedText) {\n            finalText = text;\n        }\n\n\t\treturn (\n\t\t\t<>\n                {finalText}\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default RaceText;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport LoginForm from '../../../components/login/loginForm';\nimport LoginRegister from '../../../components/register';\nimport LoginForgot from '../../../components/forgotten';\n\nimport mu from '../../../lib/musher-util';\n\nconst initialState = {\n\tisLoading: false,\n    showSignup: false,\n};\n\n@observer\nclass PublicRaceDetailSignup extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n\t\tthis.inputRef = {};\n        this.updateTimer = {};\n    }\n\n\tsignupToRace = async () => {\n\t\tconst { raceStore, userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n        const { newSignup } = raceStore;\n\t\tconst { raceid } = this.props;\n\n        const signup = {\n            team: user.team,\n            firstname: user.firstname,\n            lastname: user.lastname,\n            sportsClub: user.sportsClub,\n            email: user.email,\n            cellphone: user.cellphone,\n            facebook: user.facebook,\n            instagram: user.instagram,\n            ...newSignup\n        };\n\n\t\tawait raceStore.addContestant({\n\t\t\tid: raceid,\n\t\t\tclassId: newSignup.class,\n\t\t\tnewContestant: signup,\n        });\n        raceStore.addSignup(signup);\n        this.toggleShowSignup(false, true);\n\t}\n\n    updateSignup = (e) => {\n        const key = e.target.id;\n        const value = e.target.value;\n        const { raceStore } = this.props.stores;\n        raceStore.updateObjectKeyValue('newSignup', key, value);\n    }\n\n    editSignup = (e) => {\n        const { raceid } = this.props;\n        const { raceStore } = this.props.stores;\n        const field = e.target.id;\n        const value = e.target.value;\n        const { classid, contestantid } = e.target.dataset;\n\n        // console.log({ raceid, field, value, classid });\n        // const { raceStore } = this.props.stores;\n        // raceStore.updateObjectKeyValue('signup', key, value);\n\n        const data = {\n\t\t\traceClassId: classid,\n            contestantId: contestantid,\n\t\t\t[`raceClassContestant${util.ucfirst(field)}`]: value,\n\t\t};\n\t\tclearTimeout(this.updateTimer[field]);\n\t\tthis.updateTimer[field] = setTimeout(async () => {\n\t\t\traceStore.editClass({\n\t\t\t\tid: raceid,\n\t\t\t\tdata,\n\t\t\t});\n\t\t}, 500);\n    }\n\n    toggleShowSignup = (e, hide) => {\n        const { showSignup } = this.state;\n        this.setState({\n            showSignup: hide ? false : !showSignup,\n        });\n    }\n\n\t// editRaceClass = async (e) => {\n\t// \tconst { id, field } = e.target.dataset;\n\t// \tconst { value } = e.target;\n\t// \tconst { raceid } = this.props;\n\t// \tconst { raceStore } = this.props.stores;\n\t// \tconst data = {\n\t// \t\traceClassId: id,\n\t// \t\t[`raceClass${util.ucfirst(field)}`]: value,\n\t// \t};\n\t// \tclearTimeout(this.updateTimer[field]);\n\t// \tthis.updateTimer[field] = setTimeout(async () => {\n\t// \t\traceStore.editClass({\n\t// \t\t\tid: raceid,\n\t// \t\t\tdata,\n\t// \t\t});\n\t// \t}, 500);\n\t// }\n\n\t// editSignupToRaceasync = async () => {\n\t// \tconst { raceStore, userStore } = this.props.stores;\n\t// \tconst { user } = userStore;\n    //     const { signup } = raceStore;\n\t// \tconst { raceid } = this.props;\n\n\t// \tawait raceStore.editContestant({\n\t// \t\tid: raceid,\n\t// \t\tclassId: signup.class,\n\t// \t\tnewContestant: {\n\t// \t\t\tteam: user.team,\n\t// \t\t\tfirstname: user.firstname,\n\t// \t\t\tlastname: user.lastname,\n\t// \t\t\tsportsClub: user.sportsClub,\n\t// \t\t\temail: user.email,\n\t// \t\t\tcellphone: user.cellphone,\n\t// \t\t\tfacebook: user.facebook,\n\t// \t\t\tinstagram: user.instagram,\n\t// \t\t\t ...signup\n\t// \t\t} });\n\t// }\n\n\trender() {\n        const { showSignup } = this.state;\n\t\tconst { appState, userStore, raceStore } = this.props.stores;\n\t\tconst { user = {}, teams = [], isAdmin } = userStore;\n        const { darkmode, language = 'en' } = appState;\n\t\tconst { raceid, subsection } = this.props;\n\t\tconst { race, signups, newSignup } = raceStore;\n\t\tconst today = new Date();\n        const hasSignedup = signups && signups.length > 0;\n        const skipTeams = signups.map(e => parseInt(e.team, 10)) || [];\n\n\t\treturn (\n\t\t\t<>\n                <h2 class='mb-0'><Text id='races.signup'>Påmelding</Text> <span class='font-weight-lighter' style='letter-spacing: -1px;'> - {race.title}</span></h2>\n\t            <div class='mb-4'>\n                    {race.signupStartDate && <><Text id='races.periode'>Periode</Text>: {util.formatDate(race.signupStartDate, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</>}\n                    {race.signupEndDate && <> - {util.formatDate(race.signupEndDate, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</>}\n                </div>\n\n                {today >= new Date(race.signupStartDate) && today <= new Date(race.signupEndDate) ? <>\n\n                    {user.email ? <>\n\n                        <span class='font-weight-lighter'><Text id='races.signed-in-as'>Logget inn som</Text>:</span> {user.email}<br /><br />\n\n                        {hasSignedup && signups.map((signup) => {\n                            let signupClass = {};\n                            if (signup.class) {\n                                signupClass = raceStore.getRaceClassById(signup.class);\n                            }\n\n                            return (<div class='mb-5 p-3 bg-light border rounded-lg'>\n                                <div class='font-weight-bold mb-4'>\n                                    <i class='fas fa-check text-success' /> <Text id='races.signed-up'>Din bruker er påmeldt!</Text><br />\n                                    {/* {JSON.stringify(signup)} */}\n                                </div>\n\n                                {!race.liveRace && race.signuppayment && <>\n                                    <div class='form-group row my-0'>\n                                        <label for='cellphone' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.signup'>Påmelding</Text></label>\n                                        <div class='col-10'>\n                                            {signup.paidSignupfee ? <div class='py-2'>\n                                                <Text id='races.paid'>Betalt</Text>: {util.formatDate(signup.paidSignupfee)}\n                                                <i class='fas fa-check text-success ml-3' />\n                                            </div> : <>\n                                                <div class='alert alert-danger mb-1' role='alert'>\n                                                    <h5>\n                                                        <span class='font-weight-lighter'><Text id='races.payment-info'>Betaling påmelding</Text>:</span> {mu.replaceImages(race.signuppayment, race.images, language, false)}<br />\n                                                        {signupClass.signupfee || race.signupfee} NOK\n                                                    </h5>\n                                                </div>\n                                            </>}\n                                        </div>\n                                    </div>\n                                </>}\n\n                                <div class='clearfix mt-2'>\n                                    <span class='font-weight-lighter float-right'><Text id='races.click-to-change'>Klikk for å endre info i påmeldingen.</Text></span>\n                                </div>\n\n                                <div class='form-group row my-0'>\n                                    <label for='cellphone' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.cellphone'>Mobil</Text></label>\n                                    <div class='col-10'>\n                                        <Localizer>\n                                            <input type='text' class='form-control-plaintext' id='cellphone'\n                                                data-classid={signup.class}\n                                                data-contestantid={signup.id}\n                                                onInput={this.editSignup}\n                                                value={signup.cellphone}\n                                                placeholder={<Text id='races.cellphone-help'>Hva er mobilnummer ditt?</Text>}\n                                            />\n                                        </Localizer>\n                                    </div>\n                                </div>\n                                <div class='form-group row my-0'>\n                                    <label for='firstname' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.firstname'>Fornavn</Text></label>\n                                    <div class='col-10'>\n                                        <Localizer>\n                                            <input type='text' class='form-control-plaintext' id='firstname'\n                                                data-classid={signup.class}\n                                                data-contestantid={signup.id}\n                                                onInput={this.editSignup}\n                                                value={signup.firstname}\n                                                placeholder={<Text id='races.firstname-help'>Hva er fornavnet ditt?</Text>}\n                                            />\n                                        </Localizer>\n                                    </div>\n                                </div>\n                                <div class='form-group row my-0'>\n                                    <label for='lastname' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.lastname'>Etternavn</Text></label>\n                                    <div class='col-10'>\n                                        <Localizer>\n                                            <input type='text' class='form-control-plaintext' id='lastname'\n                                                data-classid={signup.class}\n                                                data-contestantid={signup.id}\n                                                onInput={this.editSignup}\n                                                value={signup.lastname}\n                                                placeholder={<Text id='races.lastname-help'>Hva er etternavnet ditt?</Text>}\n                                            />\n                                        </Localizer>\n                                    </div>\n                                </div>\n                                <div class='form-group row my-0'>\n                                    <label for='sportsClub' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.sportsclub'>Klubb</Text></label>\n                                    <div class='col-10'>\n                                        <Localizer>\n                                            <input type='text' class='form-control-plaintext' id='sportsClub'\n                                                data-classid={signup.class}\n                                                data-contestantid={signup.id}\n                                                onInput={this.editSignup}\n                                                value={signup.sportsClub}\n                                                placeholder={<Text id='races.sportsClub-help'>Hvilken klubb tilhører du?</Text>}\n                                            />\n                                        </Localizer>\n                                    </div>\n                                </div>\n                                <div class='form-group row my-0'>\n                                    <label for='facebook' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.facebook'>Facebook</Text></label>\n                                    <div class='col-10'>\n                                        <Localizer>\n                                            <input type='text' class='form-control-plaintext' id='facebook'\n                                                data-classid={signup.class}\n                                                data-contestantid={signup.id}\n                                                onInput={this.editSignup}\n                                                value={signup.facebook}\n                                                placeholder={<Text id='races.facebook-help'>Hva er Facebook brukernavnet ditt?</Text>}\n                                            />\n                                        </Localizer>\n                                    </div>\n                                </div>\n                                <div class='form-group row my-0'>\n                                    <label for='instagram' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.instagram'>Instagram</Text></label>\n                                    <div class='col-10'>\n                                        <Localizer>\n                                            <input type='text' class='form-control-plaintext' id='instagram'\n                                                data-classid={signup.class}\n                                                data-contestantid={signup.id}\n                                                onInput={this.editSignup}\n                                                value={signup.instagram}\n                                                placeholder={<Text id='races.instagram-help'>Hva er Instagram brukernavnet ditt?</Text>}\n                                            />\n                                        </Localizer>\n                                    </div>\n                                </div>\n                                <div class='form-group row my-0'>\n                                    <label for='team' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.team'>Team</Text></label>\n                                    <div class='col-10'>\n                                        <select class='form-control-plaintext' id='team' aria-describedby='teamHelp'\n                                            data-classid={signup.class}\n                                            data-contestantid={signup.id}\n                                            onInput={this.editSignup}\n                                            value={signup.team}\n                                        >\n                                            <option value=''>-- <Text id='races.choose-team'>Velg team</Text> --</option>\n                                            {teams.map(team => \n                                                <option value={team.id}\n                                                    disabled={skipTeams.indexOf(team.id) > -1}\n                                                >{team.name} {skipTeams.indexOf(team.id) > -1 && team.id !== signup.team ? '(Already signed up!)' : ''}</option>\n                                            )}\n                                        </select>\n                                    </div>\n                                </div>\n                                <div class='form-group row my-0'>\n                                    <label for='team' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.class'>Klasse</Text></label>\n                                    <div class='col-10'>\n                                        <select class='form-control-plaintext' id='class' aria-describedby='classHelp'\n                                            onInput={this.editSignup}\n                                            value={signup.class}\n                                            disabled\n                                        >\n                                            <option value=''>-- <Text id='races.choose-class'>Velg klasse</Text> --</option>\n                                            {race.classes && race.classes.sort((a, b) => a.distance - b.distance).map(currentClass => <>\n                                                <option value={currentClass.id}>\n                                                    {currentClass.title}{!race.liveRace && <>\n                                                        - {currentClass.distance} km - Påmelding: {currentClass.signupfee || race.signupfee} NOK\n                                                    </>}\n                                                </option>\n                                            </>)}\n                                        </select>\n                                    </div>\n                                </div>\n\n                            </div>);\n                        })}\n                        \n                        {race.liveRace === 1 ? <>\n                            Signup is done at the race normal web pages.\n                        </> : <> \n                            {(hasSignedup && !showSignup) ? <>\n                                <button type='button' class='btn btn-sm float-right btn-outline-info' onClick={this.toggleShowSignup}><Text id='races.signup-another-team'>Meld meg på i flere klasser</Text></button>\n                            </> : <>\n\n                                <div class='form-group'>\n                                    <label for='cellphone'><Text id='races.cellphone'>Mobil</Text></label>\n                                    <input type='text' class='form-control' id='cellphone' aria-describedby='cellphoneHelp'\n                                        placeholder={user.cellphone}\n                                        onInput={this.updateSignup}\n                                        value={newSignup.cellphone}\n                                    />\n                                    <small id='cellphoneHelp' class='form-text text-muted'><Text id='races.cellphone-help'>'Hva er mobilnummer ditt?'</Text></small>\n                                </div>\n\n                                <div class='row'>\n                                    <div class='col'>\n                                        <div class='form-group'>\n                                            <label for='firstname'><Text id='races.firstname'>Fornavn</Text></label>\n                                            <input type='text' class='form-control' id='firstname' aria-describedby='firstnameHelp'\n                                                placeholder={user.firstname}\n                                                onInput={this.updateSignup}\n                                                value={newSignup.firstname}\n                                            />\n                                            <small id='firstnameHelp' class='form-text text-muted'><Text id='races.firstname-help'>Hva er fornavnet ditt?</Text></small>\n                                        </div>\n                                    </div>\n                                    <div class='col'>\n                                        <div class='form-group'>\n                                            <label for='lastname'><Text id='races.lastname'>Etternavn</Text></label>\n                                            <input type='text' class='form-control' id='lastname' aria-describedby='lastnameHelp'\n                                                placeholder={user.lastname}\n                                                onInput={this.updateSignup}\n                                                value={newSignup.lastname}\n                                            />\n                                            <small id='lastnameHelp' class='form-text text-muted'><Text id='races.lastname-help'>Hva er etternavnet ditt?</Text></small>\n                                        </div>\n                                    </div>\n                                </div>\n\n                                <div class='form-group'>\n                                    <label for='sportsClub'><Text id='races.sportsclub'>Klubb</Text></label>\n                                    <input type='text' class='form-control' id='sportsClub' aria-describedby='sportsClubHelp'\n                                        placeholder={user.sportsClub}\n                                        onInput={this.updateSignup}\n                                        value={newSignup.sportsClub}\n                                    />\n                                    <small id='sportsClubHelp' class='form-text text-muted'><Text id='races.sportsClub-help'>Hvilken klubb tilhører du?</Text></small>\n                                </div>\n\n                                <div class='row'>\n                                    <div class='col'>\n                                        <div class='form-group'>\n                                            <label for='facebook'><Text id='races.facebook'>Facebook</Text></label>\n                                            <input type='text' class='form-control' id='facebook' aria-describedby='facebookHelp'\n                                                placeholder={user.facebook}\n                                                onInput={this.updateSignup}\n                                                value={newSignup.facebook}\n                                            />\n                                            <small id='facebookHelp' class='form-text text-muted'><Text id='races.facebook-help'>Hva er Facebook brukernavnet ditt?</Text></small>\n                                        </div>\n                                    </div>\n                                    <div class='col'>\n                                        <div class='form-group'>\n                                            <label for='instagram'><Text id='races.instagram'>Instagram</Text></label>\n                                            <input type='text' class='form-control' id='instagram' aria-describedby='instagramHelp'\n                                                placeholder={user.instagram}\n                                                onInput={this.updateSignup}\n                                                value={newSignup.instagram}\n                                            />\n                                            <small id='instagramHelp' class='form-text text-muted'><Text id='races.instagram-help'>Hva er Instagram brukernavnet ditt?</Text></small>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class='form-group'>\n                                    <label for='team'><Text id='races.team'>Team</Text></label>\n                                    {!teams || teams.length === 0 && <>\n                                        <div class='alert alert-danger' role='alert'>\n                                            <Text id='races.no-teams'>Du har ingen team i appen din ennå. Gå inn i appen for å registrer team og forsøk igjen.</Text>\n                                        </div>\n                                    </>}\n                                    <select class='form-control' id='team' aria-describedby='teamHelp'\n                                        onInput={this.updateSignup}\n                                        value={newSignup.team}\n                                    >\n                                        <option value=''>-- <Text id='races.choose-team'>Velg team</Text> --</option>\n                                        {teams.map(team => \n                                            <option value={team.id}\n                                                disabled={skipTeams.indexOf(team.id) > -1}\n                                            >{team.name} {skipTeams.indexOf(team.id) > -1 ? '(Already signed up!)' : ''}</option>\n                                        )}\n                                    </select>\n                                    <small id='teamHelp' class='form-text text-muted'><Text id='races.choose-team-help'>Velg fra dine team</Text></small>\n                                </div>\n\n                                <div class='form-group'>\n                                    <label for='class'><Text id='races.class'>Klasse</Text></label>\n                                    <select class='form-control' id='class' aria-describedby='classHelp'\n                                        onInput={this.updateSignup}\n                                        value={newSignup.class}\n                                    >\n                                        <option value=''>-- <Text id='races.choose-class'>Velg klasse</Text> --</option>\n                                        {race.classes && race.classes.map(currentClass => <>\n                                            <option value={currentClass.id}>{currentClass.title} - {currentClass.distance} km - Påmelding: {currentClass.signupfee || race.signupfee} NOK</option>\n                                        </>)}\n                                    </select>\n                                    <small id='classHelp' class='form-text text-muted'><Text id='races.choose-class-help'>Velg ønsket klasse.</Text></small>\n                                </div>\n\n                                {race.rules && <div class='form-group form-check'>\n                                    <input type='checkbox' class='form-check-input' id='termsAndAgreement'\n                                        onInput={this.updateSignup}\n                                        checked={newSignup.termsAndAgreement}\n                                        value={true}\n                                    />\n                                    <label class='form-check-label' for='termsAndAgreement'><Text id='races.agreement-accept'>Jeg har lest og godtar reglene for løpet.</Text></label>\n                                </div>}\n\n                                {race.declaration && <div class='form-group form-check'>\n                                    <input type='checkbox' class='form-check-input' id='declaration'\n                                        onInput={this.updateSignup}\n                                        checked={newSignup.declaration}\n                                        value={true}\n                                    />\n                                    <label class='form-check-label' for='declaration'><Text id='races.declaration-accept'>Jeg signerer med dette egenærklæringen.</Text></label>\n                                </div>}\n\n                                <button type='button' class='btn btn-primary' onClick={this.signupToRace}><Text id='races.do-signup'>Meld meg på</Text></button>\n\n                                {hasSignedup && <button type='button' class='btn btn-danger float-right' onClick={this.toggleShowSignup}><Text id='races.hide-signup'>Avbryt</Text></button>}\n                            </>}\n                        </>}\n\n                    </> : <>\n\n                        {!subsection && <LoginForm stores={this.props.stores}\n                            routeLoginOk={`/race/${raceid}/signup`}\n                            routeLoginNew={`/race/${raceid}/signup/newUser`}\n                            routeLoginForgot={`/race/${raceid}/signup/forgotPassword`}\n                        />}\n\n                        {subsection === 'newUser' && <LoginRegister stores={this.props.stores}\n                            routeLogin={`/race/${raceid}/signup`}\n                            routeLoginForgot={`/race/${raceid}/signup/forgotPassword`}\n                            skipPubSub={true}\n                        />}\n\n                        {subsection === 'forgotPassword' && <LoginForgot stores={this.props.stores}\n                            routeLogin={`/race/${raceid}/signup`}\n                            routeLoginNew={`/race/${raceid}/signup/newUser`}\n                        />}\n                    </>}\n\n                </> : <>\n                    {today < new Date(race.signupStartDate) ? <>\n                        <h5 class='mt-4'>\n                            <i class='fas fa-exclamation-circle' /> <Text id='races.signup-not-open-yet'>Påmeldingen har ikke åpnet ennå!</Text>\n                        </h5>\n                        <p class='mt-4'>\n                            <Text id='races.signup-opening'>Påmeldingen åpner</Text>:<br />\n                            <span class='display-4'>{util.formatDate(race.signupStartDate, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</span>\n                        </p>\n                    </> : <>\n                        <h5 class='mt-4 mb-4'>\n                            <i class='fas fa-exclamation-circle' /> <Text id='races.signup-closed'>Påmeldingen er stengt!</Text>\n                        </h5>\n                    </>}\n                </>}\n            </>\n\t\t);\n\t}\n}\n\nexport default PublicRaceDetailSignup;\n","import { h, Component } from 'preact';\nimport { useEffect } from \"preact/hooks\";\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport linkstate from 'linkstate';\nimport Markdown from 'preact-markdown';\n\nimport Header from './header';\nimport Submenu from './submenu';\nimport DetailSignup from './detail-signup.js';\n\nimport LoginForm from '../../../components/login/loginForm';\nimport LoginRegister from '../../../components/register';\nimport LoginForgot from '../../../components/forgotten';\nimport RaceComments from './comments';\nimport RaceAddComment from './commentAdd';\nimport RaceText from './raceText';\nimport Images from '../../../components/form/images';\n\nimport mu from '../../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(true, true);\nconst MARGIN_BOTTOM = mu.marginBottom();\n\nfunction PageTitle(title) {\n  useEffect(() => {\n    document.title = `Homerun Race: ${title}`;\n  }, [title]);\n  return <h1 class='my-0'>{title}</h1>;\n}\n\nconst initialState = {\n\tisLoading: false,\n\temail: '',\n\tsubmenu: 'ads',\n\tjwtToken: util.getJwtToken(),\n\tnewRaceArticle: {},\n\tnewRaceUserImage: {},\n};\n\n@observer\nclass PublicRaceDetail extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n\t\tthis.inputRef = {};\n\t\tthis.updateTimer = {};\n    }\n\n\tasync loadRace(props = this.props) {\n\t\tthis.setState({ isLoading: true });\n\t\tconst { raceStore, userStore } = props.stores;\n\t\tconst { user = {} } = userStore;\n\t\tconst { raceid } = props;\n\t\tawait raceStore.load(raceid);\n\t\traceStore.countAll();\n\t\tthis.setState({ isLoading: false });\n\n\t\tlet signup = {};\n\t\traceStore.resetSignup();\n\t\tconst { race } = raceStore;\n\t\tif (race.classes && user && user.email) {\n\t\t\tfor (let i = 0, l = race.classes.length; i < l; i += 1) {\n\t\t\t\tconst currentClass = race.classes[i];\n\t\t\t\tif (currentClass.contestants) {\n\t\t\t\t\tconst idx = currentClass.contestants.findIndex(e => e.email === user.email);\n\t\t\t\t\tif (idx > -1) {\n\t\t\t\t\t\tsignup = { ...currentClass.contestants[idx], class: currentClass.id };\n\t\t\t\t\t\traceStore.addSignup(signup);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\traceStore.updateKeyValue('signup', signup);\n\n\t\tthis.resizeAllTextareas();\n\t}\n\n\tlikeRace = async () => {\n\t\tconst { raceStore } = this.props.stores;\n\t\tconst { race } = raceStore;\n\t\tconst response = await raceStore.likeRace({ id: race.id });\n\n        if (response && response.status === 200) {\n\t\t\t// this.loadRaceDetail({ race });\n\t\t}\n\t}\n\n\ttoggleAddComment = (e) => {\n\t\tconst raceId = e.target.parentElement.dataset.id || e.target.dataset.id;\n\t\tconst { showAddComment } = this.state;\n\t\tthis.setState({\n\t\t\tshowAddComment: !showAddComment,\n\t\t}, () => {\n\t\t\tif (this.inputRef[raceId]) {\n\t\t\t\tthis.inputRef[raceId].focus();\n\t\t\t}\n\t\t});\n\t}\n\n\taddRaceArticle = async () => {\n\t\tconst { raceid } = this.props;\n        const { raceStore } = this.props.stores;\n\t\tconst { newRaceArticle } = this.state;\n\t\tawait raceStore.addArticle({ id: raceid, newArticle: newRaceArticle });\n\t\tthis.setState({\n\t\t\tnewRaceArticle: {},\n\t\t});\n\t}\n\n\taddRaceUserImage = async () => {\n\t\tconst { raceid } = this.props;\n        const { raceStore } = this.props.stores;\n\t\tconst { newRaceUserImage } = this.state;\n\t\tawait raceStore.addUserImage({ id: raceid, newUserImage: newRaceUserImage });\n\t\tthis.setState({\n\t\t\tnewRaceUserImage: {},\n\t\t});\n\t}\n\n\tupdateUserImageUpload = ({ field, value }) => {\n\t\t// updateField({ id: object.id, field: 'images', value: images, skipTimer: true });\n\t\tconst { newRaceUserImage } = this.state;\n\t\tnewRaceUserImage[field] = value;\n\t\tthis.setState({ newRaceUserImage });\n\t}\n\n\tupdateArticleUpload = ({ field, value }) => {\n\t\t// updateField({ id: object.id, field: 'images', value: images, skipTimer: true });\n\t\tconst { newRaceArticle } = this.state;\n\t\tnewRaceArticle[field] = value;\n\t\tthis.setState({ newRaceArticle });\n\t}\n\n\tremoveRaceArticle = async (e) => {\n\t\tconst id = e.target.parentElement.dataset.id || e.target.dataset.id;\n\t\tconst { raceid } = this.props;\n        const { raceStore } = this.props.stores;\n\t\tawait raceStore.removeArticle({\n\t\t\tid: raceid,\n\t\t\tarticleId: id,\n\t\t});\n\t}\n\n\tremoveRaceUserImage = async (e) => {\n\t\tconst id = e.target.parentElement.dataset.id || e.target.dataset.id;\n\t\tconst { raceid } = this.props;\n        const { raceStore } = this.props.stores;\n\t\tawait raceStore.removeUserImage({\n\t\t\tid: raceid,\n\t\t\tuserImageId: id,\n\t\t});\n\t}\n\n\teditRaceArticle = async (e) => {\n\t\tconst { id, field } = e.target.dataset;\n\t\tconst { value } = e.target;\n\t\tconst { raceid } = this.props;\n\t\tconst { raceStore } = this.props.stores;\n\t\tconst data = {\n\t\t\traceArticleId: id,\n\t\t\t[`raceArticle${util.ucfirst(field)}`]: value,\n\t\t};\n\t\tclearTimeout(this.updateTimer[`${raceid}-${id}-${field}`]);\n\t\tthis.updateTimer[`${raceid}-${id}-${field}`] = setTimeout(async () => {\n\t\t\traceStore.editArticle({\n\t\t\t\tid: raceid,\n\t\t\t\tdata,\n\t\t\t});\n\t\t}, 1500);\n\n\t\tthis.resizeTextarea(e.target);\n\t}\n\n\teditRaceUserImage = async (e) => {\n\t\tconst { id, field } = e.target.dataset;\n\t\tconst { value } = e.target;\n\t\tconst { raceid } = this.props;\n\t\tconst { raceStore } = this.props.stores;\n\t\tconst data = {\n\t\t\traceUserImageId: id,\n\t\t\t[`raceUserImage${util.ucfirst(field)}`]: value,\n\t\t};\n\t\tclearTimeout(this.updateTimer[`${raceid}-${id}-${field}`]);\n\t\tthis.updateTimer[`${raceid}-${id}-${field}`] = setTimeout(async () => {\n\t\t\traceStore.editUserImage({\n\t\t\t\tid: raceid,\n\t\t\t\tdata,\n\t\t\t});\n\t\t}, 1500);\n\n\t\tthis.resizeTextarea(e.target);\n\t}\n\n\tresizeAllTextareas = () => {\n\t\tconst textareaList = document.getElementsByTagName('textarea');\n\t\tfor(let i = 0, l = textareaList.length; i < l; i += 1){\n\t\t\tconst textarea = textareaList[i];\n\t\t\tthis.resizeTextarea(textarea);\n\t\t}\n\t}\n\n\tresizeTextarea = (el) => {\n\t\tlet element = el;\n\t\tif (element.target) {\n\t\t\telement = el.target;\n\t\t}\n\t\tconst { scrollHeight } = element;\n\t\telement.style.height = `${scrollHeight}px`;\n\t}\n\n\thandleImageErrored = (e) => {\n        const image = e.target;\n        image.onerror = null;\n        setTimeout(() => {\n            image.src += `?${new Date()}`;\n        }, 1000);\n    }\n\n\tcomponentDidMount() {\n\t\tthis.loadRace();\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {\n\t\tthis.loadRace(nextProps);\n\t}\n\n\trender() {\n\t\tconst { showAddComment, newRaceArticle, newRaceUserImage } = this.state;\n\t\tconst { appState, userStore, raceStore } = this.props.stores;\n\t\tconst { allUsers, isAdmin, user = {}, notifications = [], teams = [] } = userStore;\n\t\tconst { raceid, path, section, subsection, col = 12, offset = 0 } = this.props;\n\t\tconst { darkmode, language = 'en' } = appState;\n\t\tconst { race, totalClasses, totalContestants } = raceStore;\n\n\t\tconst { likes = [], comments = [] } = race;\n\t\tconst hasLikedRace = race.likes && race.likes.findIndex(e => e.user === user.id) > -1;\n\n\t\tconst today = new Date();\n\t\tlet status = '';\n\t\tif (today >= new Date(race.startDate) && today <= new Date(race.endDate)) {\n\t\t\tstatus = 'race';\n\t\t} else if (today >= new Date(race.signupStartDate) && today <= new Date(race.signupEndDate)) {\n\t\t\tstatus = 'signup';\n\t\t} else if (today > new Date(race.endDate)) {\n\t\t\tstatus = 'done';\n\t\t}\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<Header stores={this.props.stores} />\n\n\t\t\t\t<div class='container-fluid position-relative' style={`margin-bottom: ${MARGIN_BOTTOM}; margin-top: ${MARGIN_TOP};`}>\n\t\t\t\t\t<Submenu stores={this.props.stores} path={path} raceid={raceid} />\n\n\t\t\t\t\t{isAdmin && <span class='float-right position-absolute' style='top: 10px; right: 10px; z-index:10000;'>\n\t\t\t\t\t\t<a href={`/race/${raceid}/edit`} class='btn btn-small btn-primary'>\n\t\t\t\t\t\t\t<nobr><i class='fas fa-chart-line' /> <Text id='race.edit'>Endre løpet</Text></nobr>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</span>}\n\n\t\t\t\t\t<div class='row border-bottom '>\n\t\t\t\t\t\t<div class='col-12'>\n\t\t\t\t\t\t\t{/* <span class='position-absolute d-none d-lg-block' style='top: 0px; right: 0px;'>\n\t\t\t\t\t\t\t\t<iframe width='350' height='450' src='https://www.spleis.no/project/164024/embed' frameborder='0' />\n\t\t\t\t\t\t\t</span> */}\n\n\t\t\t\t\t\t\t<div class='jumbotron-thumb d-flex align-items-center position-relative'>\n\t\t\t\t\t\t\t\t{(race.images && race.images[0]) ? <img src={race.images[0].s3XXLargeLink} class='img-fluid border rounded-lg' style='min-width: 100%' /> : ''}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<h3 class='float-right'>\n\t\t\t\t\t\t\t\t{status === 'signup' && !race.liveRace && <>\n\t\t\t\t\t\t\t\t\t<div class='spinner-grow text-primary' role='status' />\n\t\t\t\t\t\t\t\t\t<span class='badge badge-primary ml-2'><Text id='races.signup-open'>Påmelding åpen</Text></span>\n\t\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t\t\t{status === 'race' && <>\n\t\t\t\t\t\t\t\t\t<div class='spinner-grow text-danger' role='status' />\n\t\t\t\t\t\t\t\t\t<span class='badge badge-danger ml-2'><Text id='races.race-in-progress'>Løp pågår</Text></span>\n\t\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t\t\t{status === 'done' && <>\n\t\t\t\t\t\t\t\t\t<i class='fas fa-check text-success' />\n\t\t\t\t\t\t\t\t\t<span class='badge badge-success ml-2'><Text id='races.race-finished'>Løp avsluttet</Text></span>\n\t\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t<h1 class='float-right'>\n\t\t\t\t\t\t\t\t{isAdmin && <i class={`fas fa-eye${race.active ? ' text-success' : '-slash text-danger'} float-right`} />}\n\t\t\t\t\t\t\t</h1>\n\t\t\t\t\t\t\t{PageTitle(race.title)}\n\t\t\t\t\t\t\t{totalContestants > 10 ? <span class='text-muted font-weight-lighter'><Text id='races.starting-teams' fields={{ totalContestants, totalClasses }} /></span> : <></>}\n\t\t\t\t\t\t\t<div class='text-muted mt-2'>\n\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t{race.startDate && <>{util.formatDate(race.startDate, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</>}\n\t\t\t\t\t\t\t\t\t{race.endDate && <> - {util.formatDate(race.endDate, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</>}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=''>\n\t\t\t\t\t\t\t\t\t{race.tag && race.tag.split(',').map(tag => <>\n\t\t\t\t\t\t\t\t\t\t<span class='badge badge-pill badge-primary py-1 ml-2'>\n\t\t\t\t\t\t\t\t\t\t\t<a class='text-white' href={`https://www.facebook.com/hashtag/${tag}`} target='_blank' rel='noreferrer' native>\n\t\t\t\t\t\t\t\t\t\t\t\t<i class='fab fa-facebook' /> #{tag}\n\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t<span class='badge badge-pill badge-primary py-1 ml-2'>\n\t\t\t\t\t\t\t\t\t\t\t<a class='text-white' href={`https://www.instagram.com/explore/tags/${tag}`} target='_blank' rel='noreferrer' native>\n\t\t\t\t\t\t\t\t\t\t\t\t<i class='fab fa-instagram' /> #{tag}\n\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t{race.contactEmail && <span class='ml-2'>\n\t\t\t\t\t\t\t\t\t<a href={`mailto:${race.contactEmail}subject=Regarding ${race.title}&body=Write your question here :)`}><i class='fas fa-envelope' /> {race.contactEmail}</a>\n\t\t\t\t\t\t\t\t</span>}\n\t\t\t\t\t\t\t\t{race.facebook && <span class='ml-2'>\n\t\t\t\t\t\t\t\t\t<a href={`${race.facebook}`} target='_blank' rel='noreferrer' native><i class='fab fa-facebook' /> Facebook</a>\n\t\t\t\t\t\t\t\t</span>}\n\t\t\t\t\t\t\t\t{race.instagram && <span class='ml-2'>\n\t\t\t\t\t\t\t\t\t<a href={`${race.instagram}`} target='_blank' rel='noreferrer' native><i class='fab fa-instagram' /> Instagram</a>\n\t\t\t\t\t\t\t\t</span>}\n\t\t\t\t\t\t\t\t{race.signuppayment && <span class='badge badge-pill badge-success py-1 ml-2'>\n\t\t\t\t\t\t\t\t\t<span class='font-weight-lighter'><Text id='race.signup-payment'>Betaling påmelding</Text>:</span> {mu.replaceImages(race.signuppayment, race.images, language, false)}\n\t\t\t\t\t\t\t\t</span>}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{race.locationCity && <div class='text-muted'>\n\t\t\t\t\t\t\t\t<Text id='race.location'>Sted</Text>: {race.locationCity}, {race.locationCountry}\n\t\t\t\t\t\t\t</div>}\n\n\t\t\t\t\t\t\t{/* contactEmail\n\t\t\t\t\t\t\tcontactCellphone\n\t\t\t\t\t\t\tfacebook\n\t\t\t\t\t\t\tinstagram */}\n\n\t\t\t\t\t\t\t<ul class='nav nav-tabs my-3'>\n\t\t\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t\t\t<a class={`nav-link ${!section ? 'active' :''}`} href={`/race/${raceid}`}><i class='fas fa-info-circle' /> <Text id='race.about'>Om løpet</Text></a>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t\t\t<a class={`nav-link ${section === 'news' ? 'active' :''}`} href={`/race/${raceid}/news`}><i class='fas fa-rss' /> <Text id='race.news'>Nyheter</Text></a>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t\t\t<a class={`nav-link ${section === 'rules' ? 'active' :''}`} href={`/race/${raceid}/rules`}><i class='fas fa-gavel' /> <Text id='race.rules'>Regler</Text></a>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t{race.veterinaryInfo && <li class='nav-item'>\n\t\t\t\t\t\t\t\t\t<a class={`nav-link ${section === 'veterinaryInfo' ? 'active' :''}`} href={`/race/${raceid}/veterinaryInfo`}><i class='fas fa-stethoscope' /> <Text id='race.veterinary'>Veterinærinfo</Text></a>\n\t\t\t\t\t\t\t\t</li>}\n\t\t\t\t\t\t\t\t{race.checkpoints && <li class='nav-item'>\n\t\t\t\t\t\t\t\t\t<a class={`nav-link ${section === 'checkpoints' ? 'active' :''}`} href={`/race/${raceid}/checkpoints`}><i class='fas fa-map-marker-alt' /> <Text id='race.checkpoints'>Sjekkpunkter</Text></a>\n\t\t\t\t\t\t\t\t</li>}\n\t\t\t\t\t\t\t\t{race.trailDescription && <li class='nav-item'>\n\t\t\t\t\t\t\t\t\t<a class={`nav-link ${section === 'trailDescription' ? 'active' :''}`} href={`/race/${raceid}/trailDescription`}><i class='fas fa-map-signs' /> <Text id='race.track-description'>Løypebeskrivelse</Text></a>\n\t\t\t\t\t\t\t\t</li>}\n\t\t\t\t\t\t\t\t{race.program && <li class='nav-item'>\n\t\t\t\t\t\t\t\t\t<a class={`nav-link ${section === 'program' ? 'active' :''}`} href={`/race/${raceid}/program`}><i class='fas fa-list-alt' /> <Text id='race.program'>Program</Text></a>\n\t\t\t\t\t\t\t\t</li>}\n\t\t\t\t\t\t\t\t{race.prices && <li class='nav-item'>\n\t\t\t\t\t\t\t\t\t<a class={`nav-link ${section === 'prices' ? 'active' :''}`} href={`/race/${raceid}/prices`}><i class='fas fa-award' /> <Text id='race.prices'>Premier</Text></a>\n\t\t\t\t\t\t\t\t</li>}\n\t\t\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t\t\t<a class={`nav-link ${section === 'classes' ? 'active' :''}`} href={`/race/${raceid}/classes`}><i class='fas fa-folder-open' /> <Text id='race.classes'>Klasser</Text></a>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t\t\t<a class={`nav-link ${section === 'signup' ? 'active' :''}`} href={`/race/${raceid}/signup`}><i class='fas fa-folder-open' /> <Text id='race.signup'>Påmelding</Text></a>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t</ul>\n\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class={`col-${col} offset-${offset} col-sm-8 col-lg-8 offset-sm-2 offset-lg-2`}>\n\t\t\t\t\t\t\t{!section && <>\n\n\t\t\t\t\t\t\t\t{race.articles && race.articles.length > 0 && <div class='row'>\n\t\t\t\t\t\t\t\t\t<div class='col-12 mb-3 py-2 position-relative border-bottom bg-light'>\n\t\t\t\t\t\t\t\t\t\t<small>\n\t\t\t\t\t\t\t\t\t\t\t<div class='font-weight-bold'>\n\t\t\t\t\t\t\t\t\t\t\t\t<i class='fas fa-rss' /> <Text id='race.news'>Nyheter</Text>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t\t\t\t\t\t{race.articles && race.articles.reverse().slice(0, 3).map(currentArticle => <>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class='col-12 col-sm-6 col-md-4 col-lg-4 p-3 position-relative'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{currentArticle.image && <img src={currentArticle.image.s3LargeLink} class='float-right rounded-lg ml-2' style='height: 70px;' />}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class='text-muted font-weight-light mr-2'>{util.formatDate(currentArticle.date, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class='font-weight-bold mr-2' style='font-size: 1.2em;'><a href={`/race/${raceid}/news`} class={`text-${darkmode ? 'light' : 'dark'}`}>{mu.replaceImages(currentArticle.title, race.images, language, false)}</a></span><br />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class='font-weight-normal'>{mu.replaceImages(currentArticle.body, race.images, language, false)}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t\t\t\t\t{race.articles.length > 3 && <div class='col-12 mt-2 text-center' style='font-size: 1.5em;'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a href={`/race/${raceid}/news`} class='text-muted'><Text id='race.more-news'>Flere nyheter</Text> &raquo;</a>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</small>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>}\n\n\t\t\t\t\t\t\t\t<p class='clearfix'>\n\t\t\t\t\t\t\t\t\t<strong>\n\t\t\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(race.ingress, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t\t\t</strong>\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(race.body, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t\t{section === 'news' && <>\n\t\t\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t\t\t<div class='col-12'>\n\t\t\t\t\t\t\t\t\t\t<h2><Text id='race.news'>Nyheter</Text></h2>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t{race.articles && race.articles.reverse().map(currentArticle => <>\n\t\t\t\t\t\t\t\t\t\t<div class='col-12 col-sm-12 col-md-6 col-lg-4 p-3 position-relative'>\n\t\t\t\t\t\t\t\t\t\t\t<h5>{mu.replaceImages(currentArticle.title, race.images, language, false)}</h5>\n\t\t\t\t\t\t\t\t\t\t\t{currentArticle.image && <img src={currentArticle.image.s3LargeLink} class='float-right w-50 rounded-lg ml-2' />}\n\t\t\t\t\t\t\t\t\t\t\t<small class='text-muted'> {util.formatDate(currentArticle.date, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</small><br />\n\t\t\t\t\t\t\t\t\t\t\t<div class='font-weight-bold'>\n\t\t\t\t\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(currentArticle.ingress, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(currentArticle.body, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t\t{section === 'rules' && <>\n\t\t\t\t\t\t\t\t<h2><Text id='race.rules'>Regler</Text></h2>\n\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(race.rules, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t\t{section === 'veterinaryInfo' && <>\n\t\t\t\t\t\t\t\t<h2><Text id='race.veterinary'>Veterinærinfo</Text></h2>\n\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(race.veterinaryInfo, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t\t{section === 'checkpoints' && <>\n\t\t\t\t\t\t\t\t<h2><Text id='race.checkpoints'>Sjekkpunkter</Text></h2>\n\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(race.checkpoints, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t\t{section === 'trailDescription' && <>\n\t\t\t\t\t\t\t\t<h2><Text id='race.track-description'>Løypebeskrivelse</Text></h2>\n\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(race.trailDescription, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t\t{section === 'program' && <>\n\t\t\t\t\t\t\t\t<h2><Text id='race.program'>Program</Text></h2>\n\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(race.program, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t\t{section === 'prices' && <>\n\t\t\t\t\t\t\t\t<h2><Text id='race.prices'>Premier</Text></h2>\n\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(race.prices, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t\t{section === 'classes' && <>\n\t\t\t\t\t\t\t\t<h2><Text id='race.classes'>Klasser</Text></h2>\n\t\t\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t\t\t{race.classes && race.classes.sort((a, b) => a.distance - b.distance).map(currentClass => <>\n\t\t\t\t\t\t\t\t\t\t<div class='col-6 col-sm-6 col-lg-4 mb-4'>\n\t\t\t\t\t\t\t\t\t\t\t<div class='border rounded rounded-lg p-3'>\n\t\t\t\t\t\t\t\t\t\t\t\t<h5>{currentClass.title}</h5>\n\n\t\t\t\t\t\t\t\t\t\t\t\t<small>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{currentClass.startDate && <div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class='font-weight-lighter'><Text id='race.startdate'>Start</Text>:</span> {util.formatDate(`${currentClass.startDate} ${currentClass.startTime || '00:00:00'}`, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>}\n\t\t\t\t\t\t\t\t\t\t\t\t\t{currentClass.endDate && <div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class='font-weight-lighter'><Text id='race.enddate'>End</Text>:</span> {util.formatDate(`${currentClass.endDate} ${currentClass.endTime || '00:00:00'}`, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>}\n\t\t\t\t\t\t\t\t\t\t\t\t</small>\n\n\t\t\t\t\t\t\t\t\t\t\t\t<div><span class='font-weight-lighter'><Text id='race.distance'>Distanse</Text>:</span> {currentClass.distance} km</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div><span class='font-weight-lighter'><Text id='race.signup'>Påmelding</Text>:</span> {currentClass.signupfee || race.signupfee} NOK</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<p class='clearfix'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(currentClass.ingress, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t<small>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(currentClass.body, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t\t\t\t\t\t</small>\n\t\t\t\t\t\t\t\t\t\t\t\t{currentClass.rules && <>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<h5><Text id='race.rules'>Regler</Text></h5>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(currentClass.rules, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t\t{section === 'signup' && <DetailSignup stores={this.props.stores} raceid={raceid} subsection={subsection} />}\n\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/* <div class='row'>\n\t\t\t\t\t\t\t<div class='col-12'>\n\t\t\t\t\t\t\t\t{race.images && race.images.map(image => <>\n\t\t\t\t\t\t\t\t\t<div class='d-flex mx-0'>\n\t\t\t\t\t\t\t\t\t\t<img src={image.s3LargeLink} class='img-fluid align-middle' />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div> */}\n\n\t\t\t\t\t\t<div class={`col-${col} offset-${offset} col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mt-5`}>\n\t\t\t\t\t\t\t{likes && likes.length > 0 && <small class='bg-light shadow-sm rounded-lg py-0 px-1' style='bottom: 20px; right: 15px;'>\n\t\t\t\t\t\t\t\t<i class='fas fa-thumbs-up text-primary' /> {likes.length}\n\t\t\t\t\t\t\t</small>}\n\t\t\t\t\t\t\t{comments && comments.length > 0 && <small class='float-right bg-light shadow-sm rounded-lg py-0 px-1' style='bottom: 20px; right: 15px;'>\n\t\t\t\t\t\t\t\t<i class='fas fa-comment text-primary' /> {comments.length}\n\t\t\t\t\t\t\t</small>}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{user.email && <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-2 mb-3'>\n\t\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t\t<div class='col-6 text-center'>\n\t\t\t\t\t\t\t\t\t<button type='button' class={`btn btn-outline-${hasLikedRace ? 'primary' : 'secondary'} btn-lg btn-block ${hasLikedRace ? 'text-primary' : ''}`}\n\t\t\t\t\t\t\t\t\t\tonClick={this.likeRace}\n\t\t\t\t\t\t\t\t\t\t// disabled={hasLikedRace}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<i class={`${hasLikedRace ? 'text-primary fas' : 'far'} fa-thumbs-up`} /> Like\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class='col-6 text-center'>\n\t\t\t\t\t\t\t\t\t<button type='button' class='btn btn-outline-secondary btn-lg btn-block'\n\t\t\t\t\t\t\t\t\t\tdata-id={race.id}\n\t\t\t\t\t\t\t\t\t\tonClick={this.toggleAddComment}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<i class='fas fa-comment' /> Comment\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>}\n\t\t\t\t\t\t<div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-2 mb-3'>\n\t\t\t\t\t\t\t{showAddComment && user.email && <RaceAddComment\n\t\t\t\t\t\t\t\tstores={this.props.stores}\n\t\t\t\t\t\t\t\trace={race}\n\t\t\t\t\t\t\t\t// callback={this.loadRaceDetail}\n\t\t\t\t\t\t\t\tinputRef={c => this.inputRef[race.id] = c}\n\t\t\t\t\t\t\t\tinputRefObject={this.inputRef}\n\t\t\t\t\t\t\t/>}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class='col-12 mt-2'>\n\t\t\t\t\t\t\t<RaceComments\n\t\t\t\t\t\t\t\tstores={this.props.stores}\n\t\t\t\t\t\t\t\trace={race}\n\t\t\t\t\t\t\t\tcols='12'\n\t\t\t\t\t\t\t\t// callback={this.loadRaceDetail}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{isAdmin && <>\n\t\t\t\t\t\n\t\t\t\t\t\t\t\t<h2 class='mt-5'>Articles</h2>\n\t\t\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t\t\t{race.articles && race.articles.map(currentArticle => <>\n\t\t\t\t\t\t\t\t\t\t<div class='col-12 col-sm-6 col-md-4 col-lg-3 border rounded-lg p-3 position-relative'>\n\t\t\t\t\t\t\t\t\t\t\t<button class='btn btn-danger position-absolute' style='top:5px; right: 5px;' data-id={currentArticle.id} onClick={this.removeRaceArticle}>\n\t\t\t\t\t\t\t\t\t\t\t\t<i class='fas fa-times' />\n\t\t\t\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t\t\t\t{currentArticle.image && <img src={currentArticle.image.s3LargeLink} class='float-right w-100' />}\n\n\t\t\t\t\t\t\t\t\t\t\t{['title'].map(field => <>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type='text' class='form-control-plaintext font-weight-bold' id={field} aria-describedby={`${field}Help`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle='font-size: 1.5em;'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-id={currentArticle.id}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-field={field}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={currentArticle[field]}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonInput={this.editRaceArticle}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t\t\t\t{['ingress', 'body'].map(field => <>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<textarea type='textarea' class='form-control-plaintext' id={field} aria-describedby={`${field}Help`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-id={currentArticle.id}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-field={field}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={currentArticle[field]}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonInput={this.editRaceArticle}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle='height: 1em;'\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t\t\t<div class='col-6 offset-3 border rounded-lg m-2 p-3 bg-light'>\n\t\t\t\t\t\t\t\t\t\t<h5>Add new article</h5>\n\t\t\t\t\t\t\t\t\t\t{newRaceArticle && newRaceArticle.image && <img src={newRaceArticle.image.s3LargeLink} class='float-right w-50'  onError={this.handleImageErrored} />}\n\n\t\t\t\t\t\t\t\t\t\t{['title'].map(field => <>\n\t\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\n\t\t\t\t\t\t\t\t\t\t\t\t<label for={field}>{field}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t<input type='text' class='form-control' id={field} aria-describedby={`${field}Help`}\n\t\t\t\t\t\t\t\t\t\t\t\t\tonInput={linkstate(this, `newRaceArticle.${field}`)}\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={newRaceArticle[field]}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t\t\t{['ingress', 'body'].map(field => <>\n\t\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\n\t\t\t\t\t\t\t\t\t\t\t\t<label for={field}>{field}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t<textarea type='text' class='form-control' id={field} aria-describedby={`${field}Help`}\n\t\t\t\t\t\t\t\t\t\t\t\t\tonInput={linkstate(this, `newRaceArticle.${field}`)}\n\t\t\t\t\t\t\t\t\t\t\t\t\tonKeyUp={this.resizeTextarea}\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle='height: 1em;'\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={newRaceArticle[field]}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t</>)}\n\n\t\t\t\t\t\t\t\t\t\t<Images saved={{}} object={{}} field={'image'} updateField={this.updateArticleUpload} autoOpen={false} />\n\n\t\t\t\t\t\t\t\t\t\t<button class='btn btn-info' onClick={this.addRaceArticle}>Add race article</button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t\t\t<h2 class='mt-5'>User images</h2>\n\t\t\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t\t\t{race.userImages && race.userImages.map(currentUserImage => <>\n\t\t\t\t\t\t\t\t\t\t<div class='col-12 col-sm-6 col-md-4 col-lg-3 border rounded-lg p-3 position-relative'>\n\t\t\t\t\t\t\t\t\t\t\t<button class='btn btn-danger position-absolute' style='top:5px; right: 5px;' data-id={currentUserImage.id} onClick={this.removeRaceUserImage}>\n\t\t\t\t\t\t\t\t\t\t\t\t<i class='fas fa-times' />\n\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t<img src={currentUserImage.image.s3LargeLink} class='float-right w-100' />\n\n\t\t\t\t\t\t\t\t\t\t\t{['title'].map(field => <>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class='form-group '>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type='text' class='form-control-plaintext font-weight-bold' id={field} aria-describedby={`${field}Help`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle='font-size: 1.5em;'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-id={currentUserImage.id}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-field={field}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={currentUserImage[field]}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonInput={this.editRaceUserImage}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t\t\t\t{['body'].map(field => <>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<textarea type='textarea' class='form-control-plaintext' id={field} aria-describedby={`${field}Help`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-id={currentUserImage.id}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-field={field}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={currentUserImage[field]}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonInput={this.editRaceUserImage}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle='height: 1em;'\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t\t\t<div class='col-3 offset-3 border rounded-lg m-2 p-3 bg-light'>\n\t\t\t\t\t\t\t\t\t\t<h5>Add new user image</h5>\n\t\t\t\t\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t\t\t\t\t<div class='col'>\n\t\t\t\t\t\t\t\t\t\t\t\t{newRaceUserImage && newRaceUserImage.image && <img src={newRaceUserImage.image.s3LargeLink} class='float-right w-50'  onError={this.handleImageErrored} />}\n\t\t\t\t\t\t\t\t\t\t\t\t{['title'].map(field => <>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<label for={field}>{field}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type='text' class='form-control' id={field} aria-describedby={`${field}Help`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonInput={linkstate(this, `newRaceUserImage.${field}`)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={newRaceUserImage[field]}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t\t\t\t\t{['body'].map(field => <>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<label for={field}>{field}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<textarea type='text' class='form-control' id={field} aria-describedby={`${field}Help`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonInput={linkstate(this, `newRaceUserImage.${field}`)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonKeyUp={this.resizeTextarea}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle='height: 1em;'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={newRaceUserImage[field]}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t                    <Images saved={{}} object={{}} field={'image'} updateField={this.updateUserImageUpload} autoOpen={false} />\n\n\t\t\t\t\t\t\t\t\t\t<button class='btn btn-info' onClick={this.addRaceUserImage}>Add race user image</button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\n\t\t\t\t\t</>}\n\t\t\t\t</div>\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default PublicRaceDetail;\n"],"sourceRoot":""}