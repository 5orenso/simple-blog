{"version":3,"sources":["webpack:///./components/feedback/likesAndComments.js","webpack:///./components/workout/commentAdd.js","webpack:///./components/workout/commentReply.js","webpack:///./components/data/distance.js","webpack:///./components/style.css","webpack:///./components/data/temperature.js","webpack:///./components/data/weight.js","webpack:///./components/data/elevation.js","webpack:///./components/data/speed.js","webpack:///./components/workout/comments.js","webpack:///./components/feedback/views.js"],"names":["initialState","DisplayLikesAndComments","observer","Component","constructor","props","super","toggleLikes","showLikesList","this","state","setState","displayTeam","e","teamId","preventDefault","stopPropagation","appState","stores","openDrawer","height","openInbox","fromuser","render","storyStore","teamStore","workoutStore","raceStore","likes","comments","type","onTeamClick","onUserClick","class","length","style","onClick","slice","map","like","user","teams","publicTeam","findPublicUser","findPublicTeamByMembers","util","isArray","find","public","mu","getImage","team","priority","displayNameShort","name","displayName","href","uuidv4","title","id","fields","total","image","shortname","WorkoutAdd","beforeImagesUploaded","sendButtonEnabled","afterImagesUploaded","commentWorkout","async","callback","inputRefObject","workout","comment","showAddImage","response","status","body","images","resizeTextarea","addImage","addImages","value","push","handleImageErrored","target","onerror","setTimeout","src","Date","inputRef","col","offset","showAvatar","extraClass","userStore","firstname","ucfirst","lastname","email","userImage","undefined","s3SmallLink","for","placeholder","onInput","linkState","onKeyUp","onFocus","ref","data-id","disabled","img","onError","removeImage","data-name","object","updateField","before","after","autoOpen","WorkoutCommentReply","commentId","commentReplyWorkout","displayDistance","distance","format","Distance","smallUnit","settings","imperial","kmToMiles","module","exports","Temperature","celciusToFahrenheit","Weight","kgToPounds","Elevation","meterToFeet","Speed","kmtToMph","showAddComment","showAllComments","showAllReplies","viewImageIdx","WorkoutComments","likeComment","parentElement","dataset","likeWorkoutComment","likeReply","replyId","likeWorkoutCommentReply","replyComment","focus","toggleComments","toggleReplies","viewImage","idx","closest","translate","replyid","commentid","showOriginal","translatedText","key","translateCommentReply","translateComment","compact","currentUser","isAdmin","language","max_comments","filteredComments","totalComments","diplayedComments","Math","max","reverse","hasLikedComment","findIndex","filteredReplises","totalReplies","diplayedReplies","imgs","toJS","imageIdx","currentImage","currentLocationGeocode","translation","getCommentTranslations","targetLang","filter","t","markdown","replaceImages","markdownOpts","getMarkdownOptions","loading","s3LargeLink","data-idx","data-commentid","formatDistance","createdDate","locale","updatedDate","formatted_address","reply","hasLikedReply","replyTranslation","getCommentReplyTranslations","replyBody","data-comment","data-replyid","more","c","toggleViews","showViewList","isTeamAdmin","views","viewUsersArrays","Object","entries","statistics","forEach","year","yearObject","week","weekObject","viewUsers","flat","userId"],"mappings":"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","file":"4.chunk.d4cb8.esm.js","sourcesContent":["import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nconst initialState = {};\n\nconst MAX_USERS_TO_DISPLAY = 1;\n\n@observer\nclass DisplayLikesAndComments extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n    toggleLikes = () => {\n        const { showLikesList } = this.state;\n        this.setState({\n            showLikesList: !showLikesList,\n        });\n    }\n\n    displayTeam = (e, teamId) => {\n        e.preventDefault();\n        e.stopPropagation();\n        const { appState } = this.props.stores;\n        appState.openDrawer('publicTeam', { teamId, height: '80vh' });\n\t}\n\n    openInbox = (e, fromuser) => {\n        e.preventDefault();\n        e.stopPropagation();\n        const { appState } = this.props.stores;\n        appState.openDrawer('inboxDetail', { fromuser, height: '80vh' });\n    }\n\n    render() {\n        const { showLikesList } = this.state;\n        const { storyStore, teamStore, workoutStore, raceStore } = this.props.stores;\n        const { likes, comments, type = 'story', onTeamClick = () => {}, onUserClick = () => {} } = this.props;\n\t\treturn (<>\n            <div class='d-flex justify-content-between mb-2'>\n                {likes && likes.length > 0 && <>\n                    <div class='d-flex flex-row flex-nowrap position-relative mr-3' style='overflow: auto;'>\n                        <span\n                            class='text-muted mr-2'\n                            onClick={this.toggleLikes}\n                        >\n                            <small>\n                                <i class='fas fa-thumbs-up text-primary' /> {likes.length}\n                            </small>\n                        </span>\n                        {likes.slice(0, MAX_USERS_TO_DISPLAY).map((like) => {\n                            let user;\n                            let teams;\n                            if (type === 'story') {\n                                user = storyStore.findPublicUser(like.user);\n                                teams = storyStore.findPublicTeamByMembers(like.user);\n                            } else if (type === 'team') {\n                                user = teamStore.findPublicUser(like.user);\n                                teams = teamStore.findPublicTeamByMembers(like.user);\n                            } else if (type === 'workout') {\n                                user = workoutStore.findPublicUser(like.user);\n                                teams = workoutStore.findPublicTeamByMembers(like.user);\n                            } else if (type === 'race') {\n                                user = raceStore.findPublicUser(like.user);\n                                teams = raceStore.findPublicTeamByMembers(like.user);\n                            }\n                            let publicTeam;\n                            if (util.isArray(teams)) {\n                                publicTeam = teams.find(e => e.public === 1);\n                            }\n                            const image = mu.getImage({ user, team: publicTeam, priority: 'user' });\n                            const shortname = mu.displayNameShort(user);\n                            const name = mu.displayName(user);\n                            return (<>\n                                <span class='font-weight-normal'>\n                                    <small>\n                                        {publicTeam ? <>\n                                            <a href={`/teams/public/${publicTeam.uuidv4}`} title={publicTeam.name} onClick={(e) => this.displayTeam(e, publicTeam.uuidv4)}>\n                                                {name}\n                                            </a>\n                                        </> : <>\n                                            {name}\n                                        </>}\n                                    </small>\n                                </span>\n                            </>);\n                            // return (<>\n                            //     {publicTeam ? <>\n                            //         <a href={`/teams/public/${publicTeam.uuidv4}`} title={publicTeam.name} onClick={(e) => onTeamClick(e, publicTeam.uuidv4)}>\n                            //             <div\n                            //                 class={`text-center border rounded-circle imageRounded imageRoundedThumb`}\n                            //                 style={`${image ? `background-image: url(\"${image}\"); background-size: cover;` : ''}`}\n                            //             >\n                            //                 {!image && <div class='' style='font-size: 12px; padding-top: 3px;'>{shortname}</div>}\n                            //             </div>\n                            //         </a>\n                            //     </> : <>\n                            //         <div\n                            //             class={`text-center border rounded-circle imageRounded imageRoundedThumb`}\n                            //             style={`${image ? `background-image: url(\"${image}\"); background-size: cover;` : ''} opacity: 0.5;`}\n                            //         >\n                            //             {!image && <div class='text-muted' style='font-size: 12px; padding-top: 3px;'>{shortname}</div>}\n                            //         </div>\n                            //     </>}\n                            // </>);\n                        })}\n                        {likes.length > MAX_USERS_TO_DISPLAY && <>\n                            <span class='text-muted font-weight-normal ml-2' onClick={this.toggleLikes}>\n                                <small>\n                                    <Text id='likes-comments.and' fields={{ total: likes.length - MAX_USERS_TO_DISPLAY }}>and {likes.length - MAX_USERS_TO_DISPLAY} others.</Text>\n                                </small>\n                            </span>\n                        </>}\n                    </div>\n                </>}\n\n                {comments && comments.length > 0 && <span class='float-right text-muted'>\n                    <small>\n                        <i class='fas fa-comment text-primary' /> {comments.length}\n                    </small>\n                </span>}\n            </div>\n            {showLikesList && <div class='mt-3 mb-3'>\n                {likes && likes.map((like) => {\n                    let user;\n                    let teams;\n                    if (type === 'story') {\n                        user = storyStore.findPublicUser(like.user);\n                        teams = storyStore.findPublicTeamByMembers(like.user);\n                    } else if (type === 'team') {\n                        user = teamStore.findPublicUser(like.user);\n                        teams = teamStore.findPublicTeamByMembers(like.user);\n                    } else if (type === 'workout') {\n                        user = workoutStore.findPublicUser(like.user);\n                        teams = workoutStore.findPublicTeamByMembers(like.user);\n                    } else if (type === 'race') {\n                        user = raceStore.findPublicUser(like.user);\n                        teams = raceStore.findPublicTeamByMembers(like.user);\n                    }\n                    let publicTeam;\n                    if (util.isArray(teams)) {\n                        publicTeam = teams.find(e => e.public === 1);\n                    }\n                    const image = mu.getImage({ user, team: publicTeam, priority: 'user' });\n                    const shortname = mu.displayNameShort(user);\n                    const name = mu.displayName(user, true);\n                    return (<div class='d-flex flex-row position-relative font-weight-normal mb-1'>\n                        {publicTeam ? <>\n                            <a href={`/teams/public/${publicTeam.uuidv4}`} title={publicTeam.name} onClick={(e) => this.displayTeam(e, publicTeam.uuidv4)} class='stretched-link'>\n                                <div\n                                    class={`text-center border rounded-circle imageRounded imageRoundedThumb`}\n                                    style={`${image ? `background-image: url(\"${image}\"); background-size: cover;` : ''}`}\n                                >\n                                    {!image && <div class='' style='font-size: 12px; padding-top: 3px;'>{shortname}</div>}\n                                </div>\n                            </a>\n                            <div class='ml-2 '>\n                                <small>\n                                    {name} <span class='font-weight-lighter'>- {publicTeam.name}</span>\n                                </small>\n                            </div>\n                        </> : <>\n                            <div\n                                class={`text-center border rounded-circle imageRounded imageRoundedThumb`}\n                                style={`${image ? `background-image: url(\"${image}\"); background-size: cover;` : ''} opacity: 0.5;`}\n                            >\n                                {!image && <div class='text-muted' style='font-size: 12px; padding-top: 3px;'>{shortname}</div>}\n                            </div>\n                            <div class='ml-2'>\n                                <small>\n                                    {name}\n                                </small>\n                            </div>\n                        </>}\n                    </div>);\n                })}\n            </div>}\n\t\t</>);\n\t}\n}\n\nexport default DisplayLikesAndComments;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer, withText } from 'preact-i18n';\nimport linkState from 'linkstate';\n\nimport Images from '../form/images';\n\nimport style from '../style.css';\nimport mu from '../../lib/musher-util';\n\n@observer\nclass WorkoutAdd extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            comment: {\n                body: '',\n                images: [],\n            },\n            showAddImage: false,\n            sendButtonEnabled: true,\n        };\n        this.inputRef = {};\n    }\n\n    beforeImagesUploaded = () => {\n        this.setState({ sendButtonEnabled: false });\n    }\n\n    afterImagesUploaded = () => {\n        this.setState({ sendButtonEnabled: true });\n    }\n    \n    commentWorkout = async () => {\n        const { sendButtonEnabled } = this.state;\n        if (!sendButtonEnabled) {\n            return false;\n        }\n        const { callback = () => {}, inputRefObject = {} } = this.props;\n        const { workout } = this.props;\n\t\tconst { workoutStore } = this.props.stores;\n        const { comment, showAddImage } = this.state;\n        this.setState({ sendButtonEnabled: false });\n\t\tconst response = await workoutStore.commentWorkout({ id: workout.id, comment });\n\t\tif (response && response.status === 200) {\n            this.setState({\n                comment: {\n                    body: '',\n                    images: [],\n                },\n            }, () => {\n                mu.resizeTextarea(inputRefObject[workout.id]);\n                if (showAddImage) {\n                    this.addImage();\n                }\n            });\n            callback({ workout, response });\n\t\t}\n        this.setState({ sendButtonEnabled: true });\n\t}\n\n    addImages = ({ value }) => {\n        // updateField({ id: object.id, field: 'images', value: images, skipTimer: true });\n        const { comment } = this.state;\n        comment.images.push(...value);\n        this.setState({ comment });\n    }\n\n    addImage = () => {\n        const { showAddImage = false } = this.state;\n        this.setState({\n            showAddImage: !showAddImage,\n        });\n    }\n\n    handleImageErrored = (e) => {\n        const image = e.target;\n        image.onerror = null;\n        setTimeout(() => {\n            image.src += `?${new Date()}`;\n        }, 1000);\n    }\n\n    render() {\n        const { inputRef, col = 12, offset = 0, showAvatar = true, extraClass = '', workout } = this.props;\n        const { comment, showAddImage, sendButtonEnabled } = this.state;\n        const { userStore } = this.props.stores;\n        const { user = {} } = userStore;\n        const displayNameShort = user.firstname ? `${util.ucfirst(user.firstname, true)}${util.ucfirst(user.lastname, true)}` : `${util.ucfirst(user.email || '', true)}`;\n        // const displayName = user.firstname ? `${user.firstname} ${user.lastname}` : `${user.email}`;\n        const userImage = user.image || (user.images ? user.images[0] : undefined);\n\n        return (\n            <div class={`col-${col} offset-${offset} ${extraClass}`}>\n                <div class='d-flex mb-0 position-relative w-100'>\n                    {showAvatar && <div \n                        class={`text-center border rounded-circle imageRounded imageRoundedSmall`}\n                        style={`${userImage ? `background-image: url('${userImage.s3SmallLink}'); background-size: cover;` : ''} border-width: 3px !important;`}\n                    >\n                        {!user.image && <span class='font-weight-lighter' style='font-size: 15px;'>{displayNameShort}</span>}\n                    </div>}\n                    <div class='col pl-3' style='line-height: 1.2em;'>\n\n                        <div class='d-flex bd-highlight'>\n                            <div class='p-0 w-100 bd-highlight'>\n                                <label class='sr-only' for='inlineFormInput'><Text id='comments.comment'>Kommentar</Text></label>\n                                <div class='border rounded rounded-lg position-relative'>\n                                    <Localizer>\n                                        <textarea\n                                            class='form-control-plaintext px-2'\n                                            type='text'\n                                            placeholder={<Text id='comments.write-comment'>Skriv en kommentar...</Text>}\n                                            onInput={linkState(this, 'comment.body')}\n                                            onKeyUp={mu.resizeTextarea}\n                                            onFocus={mu.resizeTextarea}\n                                            style='height: 2.3em;'\n                                            value={comment.body}\n                                            ref={inputRef}\n                                        />\n                                    </Localizer>\n                                    <div class='position-absolute' style='top: 8px; right: 10px; font-size: 1.2em;'>\n                                        <i class='fas fa-image pointerCursor'\n                                            data-id={workout.id}\n                                            onClick={this.addImage}\n                                        />\n                                    </div>\n                                </div>\n                            </div>\n                            <div class='p-0 pl-2 flex-shrink-1 bd-highlight'>\n                                <button type='button' class={`btn btn-${sendButtonEnabled ? 'primary' : 'secondary'} mb-2`} disabled={!sendButtonEnabled}\n                                    onClick={this.commentWorkout}\n                                ><i class='fas fa-paper-plane' /></button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                {showAddImage && <>\n                    <div class='col-12 text-center'>\n                        <div class='container-fluid'>\n                            <div class='row'>\n                                {comment.images && comment.images.map(img => (\n                                    <div class='col-3 p-1'>\n                                        <img src={img.s3SmallLink} class='img-fluid' onError={this.handleImageErrored} />\n                                        <button class='btn btn-sm btn-link'\n                                            onClick={this.removeImage}\n                                            data-name={img.name}\n                                        ><i class='fas fa-trash' />  <Text id='comments.remove-image'>Remove</Text></button>\n                                    </div>\n                                ))}\n                            </div>\n                        </div>\n                        <Images object={comment} updateField={this.addImages} before={this.beforeImagesUploaded} after={this.afterImagesUploaded} autoOpen={true} />\n                    </div>\n                </>}\n            </div>\n        );\n    }\n}\n\nexport default WorkoutAdd;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer, withText } from 'preact-i18n';\nimport linkState from 'linkstate';\n\nimport style from '../style.css';\nimport mu from '../../lib/musher-util';\n\n@observer\nclass WorkoutCommentReply extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            sendButtonEnabled: true,\n        };\n        this.inputRef = {};\n    }\n\n    commentWorkout = async () => {\n        const { sendButtonEnabled } = this.state;\n        if (!sendButtonEnabled) {\n            return false;\n        }\n        const { callback = () => {}, commentId, inputRefObject = {} } = this.props;\n        const { workout } = this.props;\n\t\tconst { workoutStore } = this.props.stores;\n        const { comment = '' } = this.state;\n        this.setState({ sendButtonEnabled: false });\n\t\tconst response = await workoutStore.commentReplyWorkout({ id: workout.id, commentId, comment });\n\t\tif (response && response.status === 200) {\n            this.setState({\n                comment: '',\n            }, () => {\n                mu.resizeTextarea(inputRefObject[commentId]);\n            });\n            callback({ workout, response, commentId });\n\t\t}\n        this.setState({ sendButtonEnabled: true });\n\t}\n\n    render() {\n        const { inputRef } = this.props;\n        const { comment, sendButtonEnabled } = this.state;\n        const { userStore } = this.props.stores;\n        const { user = {} } = userStore;\n        const displayNameShort = user.firstname ? `${util.ucfirst(user.firstname, true)}${util.ucfirst(user.lastname, true)}` : `${util.ucfirst(user.email || '', true)}`;\n        // const displayName = user.firstname ? `${user.firstname} ${user.lastname}` : `${user.email}`;\n        const userImage = user.image || (user.images ? user.images[0] : undefined);\n\n        return (\n            <div class='w-100'>\n                <div class='d-flex mb-0 position-relative w-100'>\n                    <div \n                        class={`text-center border rounded-circle imageRounded imageRoundedThumb`}\n                        style={`${userImage ? `background-image: url('${userImage.s3SmallLink}'); background-size: cover;` : ''} border-width: 3px !important;`}\n                    >\n                        {!userImage && <span class='font-weight-lighter' style='font-size: 15px;'>{displayNameShort}</span>}\n                    </div>\n                    <div class='col pl-3' style='line-height: 1.2em;'>\n\n                        <div class='d-flex bd-highlight'>\n                            <div class='p-0 w-100 bd-highlight'>\n                                <label class='sr-only' for='inlineFormInput'><Text id='comments.comment'>Kommentar</Text></label>\n                                <div class='border rounded rounded-lg position-relative'>\n                                    <Localizer>\n                                        <textarea\n                                            class='form-control-plaintext px-2'\n                                            type='text'\n                                            placeholder={<Text id='comments.write-comment'>Skriv en kommentar...</Text>}\n                                            onInput={linkState(this, 'comment')}\n                                            onKeyUp={mu.resizeTextarea}\n                                            style='height: 2.3em;'\n                                            value={comment}\n                                            ref={inputRef}\n                                        />\n                                    </Localizer>\n                                </div>\n                            </div>\n                            <div class='p-0 pl-2 flex-shrink-1 bd-highlight'>\n                                <button type='button' class={`btn btn-${sendButtonEnabled ? 'primary' : 'secondary'} mb-2`} disabled={!sendButtonEnabled}\n                                    onClick={this.commentWorkout}\n                                ><i class='fas fa-paper-plane' /></button>\n                            </div>\n                        </div>\n\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default WorkoutCommentReply;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nfunction displayDistance(distance) {\n\tif (distance < 5) {\n\t\treturn util.format(distance, 2);\n\t}\n\tif (distance < 10) {\n\t\treturn util.format(distance, 1);\n\t}\n\treturn util.format(distance, 1);\n}\n\nfunction kmToMiles(value) {\n    return 0.621371 * value;\n}\n\n@observer\nclass Distance extends Component {\n    render() {\n\t\tconst { value = 0, smallUnit } = this.props;\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { settings = {} } = user;\n\n        if (settings.imperial) {\n            return (<>\n                <nobr>\n\t\t\t\t\t{displayDistance(kmToMiles(value))} {smallUnit ? <><small><small><small class='ml-0 text-muted'>mi</small></small></small></> : <>mi</>}\n\t\t\t\t</nobr>\n            </>);\n        }\n\n\t\treturn (<>\n\t\t\t<nobr>\n\t            {displayDistance(value)} {smallUnit ? <><small><small><small class='ml-0 text-muted'>km</small></small></small></> : <>km</>}\n\t\t\t</nobr>\n\t    </>);\n    }\n}\n\nexport default Distance;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"hoverelementonly\":\"hoverelementonly__1mJGJ\",\"hoverElement\":\"hoverElement__axh3O\",\"hoverelementhide\":\"hoverelementhide__1k_qH\",\"progress-bar-vertical\":\"progress-bar-vertical__1B2sC\",\"progress-bar\":\"progress-bar__pnsVj\",\"dragged\":\"dragged__QXO46\",\"over\":\"over__1re3x\",\"list\":\"list__q_emZ\"};","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nfunction celciusToFahrenheit(value) {\n    return ((value * 9/5) + 32);\n}\n\n@observer\nclass Temperature extends Component {\n    render() {\n\t\tconst { value = 0, smallUnit } = this.props;\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { settings = {} } = user;\n\n        if (settings.imperial) {\n            return (<>\n                <nobr>\n                    {util.format(celciusToFahrenheit(value), 0)}°F\n                </nobr>\n            </>);\n        }\n\n\t\treturn (<>\n            <nobr>\n                {util.format(value, 1)}°C\n            </nobr>\n        </>);\n    }\n}\n\nexport default Temperature;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nfunction kgToPounds(value) {\n    return 2.20462 * value;\n}\n\n@observer\nclass Weight extends Component {\n    render() {\n\t\tconst { value = 0, smallUnit } = this.props;\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { settings = {} } = user;\n\n        if (settings.imperial) {\n            return (<>\n                <nobr>\n                    {util.format(kgToPounds(value), 0)} lb\n                </nobr>\n            </>);\n        }\n\n\t\treturn (<>\n            <nobr>\n                {util.format(value, 0)} kg\n            </nobr>\n        </>);\n    }\n}\n\nexport default Weight;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nfunction meterToFeet(value) {\n    return 3.28084 * value;\n}\n\n@observer\nclass Elevation extends Component {\n    render() {\n\t\tconst { value = 0, smallUnit } = this.props;\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { settings = {} } = user;\n\n        if (settings.imperial) {\n            return (<>\n                <nobr>\n                    {util.format(meterToFeet(value), 0)} {smallUnit ? <><small><small><small class='ml-0 text-muted'>ft</small></small></small></> : <>ft</>}\n                </nobr>\n            </>);\n        }\n\n\t\treturn (<>\n            <nobr>\n                {util.format(value, 0)} {smallUnit ? <><small><small><small class='ml-0 text-muted'>m</small></small></small></> : <>m</>}\n            </nobr>\n        </>);\n    }\n}\n\nexport default Elevation;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nfunction kmtToMph(value) {\n    return 0.621371 * value;\n}\n\n@observer\nclass Speed extends Component {\n    render() {\n\t\tconst { value = 0, smallUnit } = this.props;\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { settings = {} } = user;\n\n        if (settings.imperial) {\n            return (<>\n                <nobr>\n                    {util.format(kmtToMph(value), 1)} {smallUnit ? <><small><small><small class='ml-0 text-muted'><Text id='workouts.mph'>mph</Text></small></small></small></> : <><Text id='workouts.mph'>mph</Text></>}\n                </nobr>\n            </>);\n        }\n\n\t\treturn (<>\n            <nobr>\n                {util.format(value, 1)} {smallUnit ? <><small><small><small class='ml-0 text-muted'><Text id='workouts.kmt'>km/t</Text></small></small></small></> : <><Text id='workouts.kmt'>km/t</Text></>}\n            </nobr>\n        </>);\n    }\n}\n\nexport default Speed;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { toJS } from 'mobx';\nimport { Text, Localizer, withText } from 'preact-i18n';\nimport Markdown from 'preact-markdown';\n\nimport WorkoutReplyComment from '../../components/workout/commentReply';\n\nimport style from '../style.css';\nimport mu from '../../lib/musher-util';\n\nconst initialState = {\n    showAddComment: {},\n    showAllComments: false,\n    showAllReplies: {},\n    viewImageIdx: {},\n};\n\nconst MAX_COMMENTS = 1;\n\n@observer\nclass WorkoutComments extends Component {\n     constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n        this.inputRef = {};\n    }\n\n    likeComment = async (e) => {\n        const { callback = () => {} } = this.props;\n        const commentId = e.target.parentElement.dataset.id || e.target.dataset.id;\n\n        const { workout } = this.props;\n\t\tconst { workoutStore } = this.props.stores;\n\t\tconst response = await workoutStore.likeWorkoutComment({ id: workout.id, commentId });\n\n\t\tif (response && response.status === 200) {\n            callback({ type: 'likeComment', workout, commentId, response });\n\t\t}\n        return true;\n    }\n\n    likeReply = async (e) => {\n        const { callback = () => {} } = this.props;\n\n        const replyId = e.target.parentElement.dataset.id || e.target.dataset.id;\n        const commentId = e.target.parentElement.dataset.comment || e.target.dataset.comment;\n\n        const { workout } = this.props;\n\t\tconst { workoutStore } = this.props.stores;\n\t\tconst response = await workoutStore.likeWorkoutCommentReply({ id: workout.id, replyId, commentId });\n\n        if (response && response.status === 200) {\n            callback({ type: 'likeReply', workout, commentId, replyId, response });\n\t\t}\n    }\n\n    replyComment = async (e) => {\n        const commentId = e.target.parentElement.dataset.id || e.target.dataset.id;\n\n        const { showAddComment } = this.state;\n        showAddComment[commentId] = !showAddComment[commentId];\n\t\tthis.setState({\n\t\t\tshowAddComment,\n\t\t}, () => {\n            if (this.inputRef[commentId]) {\n                this.inputRef[commentId].focus();\n            }\n\t\t});\n    }\n\n    toggleComments = () => {\n\t\tconst { showAllComments } = this.state;\n\t\tthis.setState({\n\t\t\tshowAllComments: !showAllComments,\n\t\t});\n\t}\n\n    toggleReplies = (e) => {\n        const commentId = e.target.parentElement.dataset.id || e.target.dataset.id;\n\t\tconst { showAllReplies } = this.state;\n        showAllReplies[commentId] = !showAllReplies[commentId];\n\t\tthis.setState({\n\t\t\tshowAllReplies,\n\t\t});\n\t}\n\n    viewImage = (e) => {\n\t\tconst { id, idx } = e.target.closest('img').dataset;\n        const { viewImageIdx } = this.state;\n        viewImageIdx[id] = idx;\n        this.setState({ viewImageIdx });\n    }\n\n    translate = async (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        const { replyid, commentid } = e.target.closest('button').dataset;\n        const { workout } = this.props;\n        const { userStore, teamStore } = this.props.stores;\n        const { user } = userStore;\n        const { showOriginal = {}, translatedText = {} } = this.state;\n        const key = `${commentid}${replyid ? `-${replyid}`: ''}`;\n        showOriginal[key] = 0;\n        if (replyid) {\n            translatedText[key] = await teamStore.translateCommentReply({ commentid, replyid, object: workout, user });\n        } else {\n            translatedText[key] = await teamStore.translateComment({ commentid, object: workout, user });\n        }\n        this.setState({ showOriginal, translatedText });\n    }\n\n    showOriginal = (e) => {\n        const { replyid, commentid } = e.target.closest('button').dataset;\n        e.preventDefault();\n        e.stopPropagation();\n        const { showOriginal = {} } = this.state;\n        showOriginal[`${commentid}${replyid ? `-${replyid}`: ''}`] = 1;\n        this.setState({ showOriginal });\n    }\n\n    displayTeam = (e, teamId) => {\n        e.preventDefault();\n        e.stopPropagation();\n        const { appState } = this.props.stores;\n        appState.openDrawer('publicTeam', { teamId, height: '80vh' });\n\t}\n\n    openInbox = (e, fromuser) => {\n        e.preventDefault();\n        e.stopPropagation();\n        const { appState } = this.props.stores;\n        appState.openDrawer('inboxDetail', { fromuser, height: '80vh' });\n    }\n\n    render() {\n        const { showAddComment, showAllComments, showAllReplies, viewImageIdx, showOriginal = {}, translatedText = {} } = this.state;\n\t\tconst { workout, callback = () => {}, col = 12, offset = 0, compact = false } = this.props;\n        const { userStore, teamStore } = this.props.stores;\n        const { user: currentUser, isAdmin } = userStore;\n        const { language = 'en' } = currentUser;\n\n        let filteredComments = [];\n        let totalComments = 0;\n        let diplayedComments = 0;\n        let max_comments;\n        if (workout.comments) {\n            totalComments = workout.comments.length;\n            if (showAllComments) {\n                filteredComments = workout.comments;\n            } else {\n                // filteredComments = workout.comments.slice(0, MAX_COMMENTS);\n                max_comments = compact ? 0 : MAX_COMMENTS;\n                filteredComments = workout.comments.slice(Math.max(totalComments - max_comments, 0));\n            }\n            diplayedComments = filteredComments.length;\n        }\n\n        return (\n            <div>\n                {/* {showAllComments && <div>\n                    <button class='btn btn-sm btn-link py-0 mb-2'\n                        onClick={this.toggleComments}\n                    >\n                        <Text id='comments.hide-all-comments'>Skjul alle kommentarene.</Text>\n                    </button>\n                </div>} */}\n                {workout && filteredComments && filteredComments.reverse().map((comment) => {\n                    const { user = {} } = comment;\n                    const teams = teamStore.findPublicTeamByMembers(user.id);\n                    const displayNameShort = mu.displayNameShort(user);\n                    const displayName = mu.displayName(user);\n                    const userImage = user.image || (user.images ? user.images[0] : undefined);\n                    const hasLikedComment = comment.likes && comment.likes.findIndex(e => e.user === currentUser.id) > -1;\n\n                    let filteredReplises = [];\n                    let totalReplies = 0;\n                    let diplayedReplies = 0;\n                    if (comment.comments) {\n                        totalReplies = comment.comments.length;\n                        if (showAllReplies[comment.id]) {\n                            filteredReplises = comment.comments;\n                        } else {\n                            filteredReplises = comment.comments.slice(0, max_comments);\n                        }\n                        diplayedReplies = filteredReplises.length;\n                    }\n\n                    const images = [];\n                    if (comment.images) {\n                        const imgs = toJS(comment.images);\n                        images.push(...imgs);\n                    }\n                    const imageIdx = viewImageIdx[comment.id] ? viewImageIdx[comment.id] : 0;\n                    const currentImage = images && images[imageIdx] ? images[imageIdx] : null;\n\n                    const { currentLocationGeocode = {} } = comment;\n\n                   const translation = teamStore.getCommentTranslations({\n                        object: workout,\n                        commentid: comment.id,\n                        targetLang: language,\n                    }) || translatedText[comment.id];\n                    let body = translation || comment.comment;\n                    if (showOriginal[comment.id]) {\n                        body = comment.comment;\n                    }\n\n                    return (\n                        <div class='row'>\n                            <div class='col-12 d-flex mb-2 position-relative'>\n                                <div \n                                    class={`text-center border rounded-circle imageRounded imageRoundedSmall`}\n                                    style={`${userImage ? `background-image: url(\"${userImage.s3SmallLink}\"); background-size: cover;` : ''} border-width: 3px !important;`}\n                                >\n                                    {!user.image && <span class='font-weight-lighter' style='font-size: 15px;'>{displayNameShort}</span>}\n                                </div>\n                                <div class='flex-grow-1 pl-3 pt-0' style='line-height: 1.2em;'>\n                                    <div class='bg-light p-2 rounded rounded-lg'>\n                                        <div>\n                                            <span style='font-size: 0.95em;'>\n                                                <h5 class='font-weight-bold mb-0' style='font-size: 1.0em;'>\n                                                    {user.uuidv4 && user.uuidv4 !== currentUser.uuidv4 ? <>\n                                                        <a href={`/inbox/${user.uuidv4}`} onClick={(e) => this.openInbox(e, user.uuidv4)}>{displayName}</a>\n                                                    </> : <>\n                                                        {displayName}\n                                                    </>}\n                                                </h5>\n\n                                                {teams && teams.length > 0 && <div class='mb-2'>\n                                                    <small class='font-weight-lighter text-muted'>\n                                                        {teams.filter(e => e.public === 1).slice(0, 2).map(t => <>\n                                                            <a href={`/teams/public/${t.uuidv4}`} class='mr-2'><i class='fas fa-users text-muted' /> {t.name}</a>\n                                                        </>)}\n                                                    </small>\n                                                </div>}\n\n                                                <Markdown markdown={mu.replaceImages(body, comment.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                                            </span>\n                                        </div>\n                                        <div class='container-fluid px-3 mt-1'>\n                                            {currentImage && <div class='clearfix row'>\n                                                <div\n                                                    class={`col-12 px-0 overflow-hidden`}\n                                                    style={`max-height: 30vh;`}                                                    \n                                                >\n                                                    <img loading='lazy' class={`img-fluid`} style='min-width: 100px;' src={currentImage.s3LargeLink} />\n                                                </div>\n                                            </div>}\n                                            {images && images.length > 1 && <div class='clearfix d-flex flex-wrap row'>\n                                                {images.map((img, idx) => {\n                                                    return (<>\n                                                        <div\n                                                            class={`col px-0 overflow-hidden`}\n                                                            style={`max-height: 100px; min-width: 100px;`}\n                                                        >\n                                                            <img loading='lazy' class={`img-fluid border`} style='min-width: 100px;' src={img.s3SmallLink} onClick={this.viewImage} data-id={comment.id} data-idx={idx} />\n                                                        </div>\n                                                    </>);\n                                                })}\n                                            </div>}\n                                        </div>\n                                    </div>\n                                    <small>\n                                        <button class={`btn btn-sm btn-link py-0 ${hasLikedComment ? 'text-primary' : ''}`}\n                                            onClick={this.likeComment}\n                                            data-id={comment.id}\n                                        >\n                                            <Text id='comments.like'>Lik</Text>\n                                        </button>\n                                        -\n                                        <button class='btn btn-sm btn-link py-0'\n                                            onClick={this.replyComment}\n                                            data-id={comment.id}\n                                        >\n                                            <Text id='comments.comment-add'>Kommentar</Text>\n                                        </button>\n                                        {comment.language !== language && <>\n                                            -\n                                            {!showOriginal[comment.id] && translation ? <>\n                                                <button\n                                                    type='button'\n                                                    class='btn btn-sm btn-link'\n                                                    data-commentid={comment.id}\n                                                    onClick={this.showOriginal}\n                                                >\n                                                    <i class='fas fa-cog' />  <Text id='home.translate-show-original'>Show original</Text>\n                                                </button>\n                                            </> : <>\n                                                <button\n                                                    type='button'\n                                                    class='btn btn-sm btn-link'\n                                                    onClick={this.translate}\n                                                    data-commentid={comment.id}\n                                                >\n                                                    <i class='fas fa-cog' /> <Text id='home.translate-to'>See translation</Text>\n                                                </button>\n                                            </>}\n                                        </>}\n                                        -\n                                        <button class='btn btn-sm btn-link py-0 disabled'>\n                                            {util.formatDistance(comment.createdDate, new Date(), { locale: 'no-NB' })}\n                                            {comment.updatedDate && <>\n                                                <span class='font-weight-light ml-2'>(Edited {util.formatDistance(comment.updatedDate, new Date(), { locale: 'no-NB' })})</span>\n                                            </>}\n                                        </button>\n                                        {isAdmin && currentLocationGeocode && currentLocationGeocode.formatted_address && <>\n                                            <span class='ml-2 text-muted'>\n                                                <i class='fas fa-map-marker-alt' /> {currentLocationGeocode.formatted_address}\n                                            </span>\n                                        </>}\n                                    </small>\n                                </div>\n                                {comment.likes && comment.likes.length > 0 && <small class='position-absolute bg-light shadow-sm rounded-lg py-0 px-1' style='bottom: 20px; right: 15px;'>\n                                    <i class='fas fa-thumbs-up text-primary' /> {comment.likes.length}\n                                </small>}\n                            </div>\n                            <div class='col-11 offset-1 mb-2'>\n\n                                {comment && filteredReplises && filteredReplises.map((reply) => {\n                                    const { user = {} } = reply;\n                                    const teams = teamStore.findPublicTeamByMembers(user.id);\n                                    const displayNameShort = user.firstname ? `${util.ucfirst(user.firstname, true)}${util.ucfirst(user.lastname, true)}` : `${util.ucfirst(user.email || '', true)}`;\n                                    const displayName = user.firstname ? `${user.firstname} ${user.lastname}` : `${user.email}`;\n                                    const userImage = user.image || (user.images ? user.images[0] : undefined);\n                                    const hasLikedReply = reply.likes && reply.likes.findIndex(e => e.user === currentUser.id) > -1;\n\n                                    const replyTranslation = teamStore.getCommentReplyTranslations({\n                                        object: workout,\n                                        commentid: comment.id,\n                                        replyid: reply.id,\n                                        targetLang: language,\n                                    }) || translatedText[`${comment.id}-${reply.id}`];\n                                    let replyBody = replyTranslation || reply.comment;\n                                    if (showOriginal[`${comment.id}-${reply.id}`]) {\n                                        replyBody = reply.comment;\n                                    }\n\n                                    return (\n                                        <div class='row'>\n                                            <div class='col-12 d-flex mb-2 position-relative'>\n                                                <div \n                                                    class={`text-center border rounded-circle imageRounded imageRoundedThumb`}\n                                                    style={`${userImage ? `background-image: url(\"${userImage.s3SmallLink}\"); background-size: cover;` : ''} border-width: 3px !important;`}\n                                                >\n                                                    {!user.image && <span class='font-weight-lighter' style='font-size: 15px;'>{displayNameShort}</span>}\n                                                </div>\n                                                <div class='flex-grow-1 pl-3 pt-0' style='line-height: 1.2em;'>\n                                                    <div class='bg-light p-2 rounded-lg'>\n                                                        <span style='font-size: 0.95em;'>\n                                                            <h5 class='font-weight-bold mb-0' style='font-size: 1.0em;'>\n                                                                {user.uuidv4 && user.uuidv4 !== currentUser.uuidv4 ? <>\n                                                                    <a href={`/inbox/${user.uuidv4}`} onClick={(e) => this.openInbox(e, user.uuidv4)}>{displayName}</a>\n                                                                </> : <>\n                                                                    {displayName}\n                                                                </>}\n                                                            </h5>\n\n                                                            {teams && teams.length > 0 && <div class='mb-2'>\n                                                                <small class='font-weight-lighter text-muted'>\n                                                                    {teams.filter(e => e.public === 1).slice(0, 2).map(t => <>\n                                                                        <a href={`/teams/public/${t.uuidv4}`} class='mr-2'>\n                                                                            <i class='fas fa-users text-muted' /> {t.name}\n                                                                        </a>\n                                                                    </>)}\n                                                                </small>\n                                                            </div>}\n\n                                                            <Markdown markdown={mu.replaceImages(replyBody, reply.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                                                        </span>\n                                                    </div>\n                                                    <small>\n                                                        <button class={`btn btn-sm btn-link py-0 ${hasLikedReply ? 'text-primary' : ''}`}\n                                                            onClick={this.likeReply}\n                                                            data-comment={comment.id}\n                                                            data-id={reply.id}\n                                                        >\n                                                            <Text id='comments.like'>Lik</Text>\n                                                        </button>\n                                                        -\n                                                        <button class='btn btn-sm btn-link py-0'\n                                                            onClick={this.replyComment}\n                                                            data-id={comment.id}\n                                                        >\n                                                            <Text id='comments.comment-add'>Kommentar</Text>\n                                                        </button>\n                                                        {reply.language !== language && <>\n                                                            -\n                                                            {!showOriginal[`${comment.id}-${reply.id}`] && replyTranslation ? <>\n                                                                <button\n                                                                    type='button'\n                                                                    class='btn btn-sm btn-link'\n                                                                    data-commentid={comment.id}\n                                                                    data-replyid={reply.id}\n                                                                    onClick={this.showOriginal}\n                                                                >\n                                                                    <i class='fas fa-cog' />  <Text id='home.translate-show-original'>Show original</Text>\n                                                                </button>\n                                                            </> : <>\n                                                                <button\n                                                                    type='button'\n                                                                    class='btn btn-sm btn-link'\n                                                                    onClick={this.translate}\n                                                                    data-commentid={comment.id}\n                                                                    data-replyid={reply.id}\n                                                                >\n                                                                    <i class='fas fa-cog' /> <Text id='home.translate-to'>See translation</Text>\n                                                                </button>\n                                                            </>}\n                                                        </>}\n                                                        -\n                                                        <button class='btn btn-sm btn-link py-0 disabled'>\n                                                            {util.formatDistance(reply.createdDate, new Date(), { locale: 'no-NB' })}\n                                                        </button>\n                                                    </small>\n                                                </div>\n                                                {reply.likes && <small class='position-absolute bg-light shadow-sm rounded-lg py-0 px-1' style='bottom: 20px; right: 15px;'>\n                                                    <i class='fas fa-thumbs-up text-primary' /> {reply.likes.length}\n                                                </small>}\n                                            </div>\n                                        </div>\n                                    );\n                                })}\n                                {totalReplies - diplayedReplies > 0 && <div>\n                                    <button class='btn btn-sm btn-link py-0'\n                                        onClick={this.toggleReplies}\n                                        data-id={comment.id}\n                                    >\n                                        <Text id='comments.show-more' fields={{ more: totalReplies - diplayedReplies }}>\n                                            Vis {totalReplies - diplayedReplies} flere kommentarer...\n                                        </Text>\n                                    </button>\n                                </div>}\n\n                            </div>\n                            {showAddComment[comment.id] && <div class='col-11 offset-1 d-flex mb-2 position-relative'>\n                                <WorkoutReplyComment stores={this.props.stores} workout={workout}\n                                    callback={callback}\n                                    commentId={comment.id}\n                                    inputRef={c => this.inputRef[comment.id] = c}\n                                    inputRefObject={this.inputRef}\n                                />\n                            </div>}\n                        </div>\n                    );\n                })}\n                {totalComments - diplayedComments > 0 && <div>\n                    <button class='btn btn-sm btn-link py-0'\n                        onClick={this.toggleComments}\n                    >\n                        <Text id='comments.show-more' fields={{ more: totalComments - diplayedComments }}>\n                            Vis {totalComments - diplayedComments} flere kommentarer...\n                        </Text>\n                    </button>\n                </div>}\n                {showAllComments && <div>\n                    <button class='btn btn-sm btn-link py-0'\n                        onClick={this.toggleComments}\n                    >\n                        <Text id='comments.hide-all-comments'>Skjul alle kommentarene.</Text>\n                    </button>\n                </div>}\n            </div>\n        );\n    }\n}\n\nexport default WorkoutComments;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nconst initialState = {};\n\n@observer\nclass DisplayLikesAndComments extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n    toggleViews = () => {\n        const { showViewList } = this.state;\n        const { isTeamAdmin, isAdmin } = this.props;\n        if (isTeamAdmin || isAdmin) {\n            this.setState({\n                showViewList: !showViewList,\n            });\n        }\n    }\n\n    render() {\n        const { showViewList } = this.state;\n        const { storyStore, teamStore, workoutStore } = this.props.stores;\n        const { views, object, isTeamAdmin, isAdmin,\n            type = 'story', onTeamClick = () => {}, onUserClick = () => {} } = this.props;\n\n        const viewUsersArrays = [];\n        Object.entries(object.statistics).forEach(([year, yearObject]) => {\n            // console.log({ year, yearObject });\n            Object.entries(yearObject).forEach(([week, weekObject]) => {\n                // console.log({ week, weekObject });\n                if (weekObject.viewUsers) {\n                    viewUsersArrays.push(weekObject.viewUsers);\n                }\n            });\n        });\n        const viewUsers = viewUsersArrays.flat().slice(0, 50);\n\n\t\treturn (<>\n            <div class='d-flex justify-content-end mb-2'>\n                <span class='ml-2 text-muted font-weight-normal'\n                    onClick={this.toggleViews}\n                >\n                    <small>\n                        {views} <Text id='story.views'>views</Text>\n                    </small>\n                </span>\n            </div>\n            {showViewList && <div class='mt-3 mb-3'>\n                {viewUsers && viewUsers.map((userId) => {\n                    let user;\n                    let teams;\n                    if (type === 'story') {\n                        user = storyStore.findPublicUser(userId);\n                        teams = storyStore.findPublicTeamByMembers(userId);\n                    } else if (type === 'team') {\n                        user = teamStore.findPublicUser(userId);\n                        teams = teamStore.findPublicTeamByMembers(userId);\n                    } else if (type === 'workout') {\n                        user = workoutStore.findPublicUser(userId);\n                        teams = workoutStore.findPublicTeamByMembers(userId);\n                    }\n                    if (!user) {\n                        return '';\n                    }\n                    let publicTeam;\n                    if (util.isArray(teams)) {\n                        publicTeam = teams.find(e => e.public === 1);\n                    }\n                    const image = mu.getImage({ user, team: publicTeam, priority: 'user' });\n                    const shortname = mu.displayNameShort(user);\n                    const name = mu.displayName(user, true);\n                    return (<div class='d-flex flex-row position-relative font-weight-normal mb-1'>\n                        {publicTeam ? <>\n                            <a href={`/teams/public/${publicTeam.uuidv4}`} title={publicTeam.name} onClick={(e) => onTeamClick(e, publicTeam.uuidv4)} class='stretched-link'>\n                                <div\n                                    class={`text-center border rounded-circle imageRounded imageRoundedThumb`}\n                                    style={`${image ? `background-image: url(\"${image}\"); background-size: cover;` : ''}`}\n                                    >\n                                    {!image && <div class='' style='font-size: 12px; padding-top: 3px;'>{shortname}</div>}\n                                </div>\n                            </a>\n                            <div class='ml-2 '>\n                                <small>\n                                    {name} <span class='font-weight-normal'>- {publicTeam.name}</span>\n                                </small>\n                            </div>\n                        </> : <>\n                            <div\n                                class={`text-center border rounded-circle imageRounded imageRoundedThumb`}\n                                style={`${image ? `background-image: url(\"${image}\"); background-size: cover;` : ''} opacity: 0.5;`}\n                            >\n                                {!image && <div class='text-muted' style='font-size: 12px; padding-top: 3px;'>{shortname}</div>}\n                            </div>\n                            <div class='ml-2'>\n                                <small>\n                                    {name}\n                                </small>\n                            </div>\n                        </>}\n                    </div>);\n                })}\n                {views > viewUsers.length && <>\n                    <small class='text-muted'>\n                        <Text id='story.limited-to'>Limited to max 50 users.</Text>\n                    </small>\n                </>}\n            </div>}\n\t\t</>);\n\t}\n}\n\nexport default DisplayLikesAndComments;\n"],"sourceRoot":""}