{"version":3,"sources":["webpack:///./components/dog/miniViewGraph.js","webpack:///./components/dog/simplePublic.js","webpack:///./routes/dogs/publicDetail.js","webpack:///./components/team/public.js","webpack:///./routes/teams/publicDetail.js","webpack:///./components/team/publicLine.js","webpack:///./components/overlay/index.js","webpack:///./components/imageScroller/index.js"],"names":["MiniViewGraph","observer","Component","render","legendLeft","legendRight","dataLeft","dataRight","showDebug","xTicksVal","val","util","isoDate","xTicksCnt","yTicksLeftVal","yTicksRightVal","this","props","firstData","xTicks","length","partSize","Math","ceil","parts","floor","console","log","i","l","push","epoch","class","stores","width","height","showXTicks","paddingTop","lineFromXzero","lineFromXmax","showYTicksLeft","avgWindowLeft","smoothLeft","showYTicksRight","avgWindowRight","smoothRight","scrollToRight","Dog","dog","dogs","showTeam","showInfo","showName","showPosition","showAge","className","size","onDogClick","userStore","user","language","dogPosition","findDogposition","position","hasBirthday","mu","birth","daysUntilNextBirthday","containerWidth","imageClasses","fontSize","style","onTouchstart","e","stopPropagation","onTouchend","onTouchmove","icon","name","image","s3SmallLink","ucfirst","href","uuidv4","onClick","shortname","age","deceased","gender","findTeam","team","weight","format","bodyScore","MARGIN_TOP","marginTop","MARGIN_TOP_BACK","marginTopBack","MARGIN_BOTTOM","marginBottom","initialState","newTeam","DogsDetail","constructor","super","back","history","goBack","nextDog","nextDogIdx","state","loadPublicDog","dogid","prevDog","prevDogIdx","updateTimer","time","Date","getTime","apiServer","getApiServer","setState","isLoading","dogStore","getPublicViews","loadPublicView","loadPublicDetail","id","publicDog","currentDogIdx","findIndex","prevDogName","nextDogName","hasPrevDog","hasNextDog","componentDidMount","appState","setSwipeRight","loadAll","componentWillReceiveProps","nextProps","teamStore","isAdmin","publicTeam","dogPublicTeam","publicViewsGraphData","isTeamAdmin","members","some","m","users","imageHeader","headerImage","s3XXLargeLink","teamImage","s3LargeLink","findTeamAmbition","ambition","ambitions","findTeamType","type","daysUntilBirthday","markdown","replaceImages","description","images","markdownOpts","getMarkdownOptions","fields","total","achievements","map","file","date","url","asUrl","target","rel","native","trophys","reverse","img","getTrophyImage","textHeader","descriptionHeader","text","src","key","Team","requestFollowTeam","teamId","parseInt","parentElement","dataset","followRequest","requestSent","unFollowTeam","unollowTeam","unfollowed","getButton","skipHome","simple","classNames","isYourTeam","indexOf","isFollowing","followers","isBlocked","blockedFollowers","hasRequestedFollow","followRequests","disabled","data-team","public","buttonOnly","teamAmbition","teamType","place","country","TeamsDetail","preventDefault","showDog","hideDog","onUserClick","subscribeNotificationTopic","async","field","notificationTopics","setNotificationTopic","value","teamid","loadPublicTeam","hideTeam","publicTrophys","publicMemories","publicDogs","topic","facebook","asFacebookLink","instagram","asInstagramLink","snapchat","asSnapchatLink","imagesSponsor","sponsors","descriptionWorkoutplan","confirmed","deleted","submenu","TeamLine","confirmRequest","callback","closest","confirmFollowRequest","deleteRequest","deleteFollowRequest","getUnblockButton","userId","myTeamId","isConfirmed","data-user","showBlockButton","storyStore","findPublicUser","username","displayNameShort","displayName","isDeleted","s3MediumLink","Overlay","children","hasImage","isObject","ImageScroller","scrollImages","scrollLeft","clientWidth","imageIdx","nearestInt","round","diff","abs","Number","isInteger","distance","event","hypot","touches","pageX","pageY","pinchZoomOnTouchStart","start","x","y","pinchZoomOnTouchMove","imageElementScale","imageElementMaxScale","scale","min","max","transform","transition","WebkitTransform","zIndex","pinchZoomOnTouchEnd","dblClick","likeRef","noimagestext","minHeight","onScroll","filter","onDblclick","data-id","updatedDate","loading","idx"],"mappings":"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","file":"3.chunk.b7265.esm.js","sourcesContent":["import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer, withText } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nimport LineGraph from '../../components/lineGraph';\n\n@observer\nclass MiniViewGraph extends Component {\n    render() {\n        const {\n            legendLeft = [],\n            legendRight = [],\n            dataLeft = [],\n            dataRight = [],\n            showDebug,\n            xTicksVal = val => util.isoDate(val, false, false, true),\n            xTicksCnt = 5,\n            yTicksLeftVal = val => val,\n            yTicksRightVal = val => val,\n        } = this.props;\n\n        const firstData = dataLeft && dataLeft[0] ? dataLeft[0] : [];\n        const xTicks = [];\n        if (firstData.length) {\n            const partSize = Math.ceil(firstData.length / (xTicksCnt - 1));\n            const parts = Math.floor(firstData.length / partSize);\n            if (showDebug) {\n                console.log({ firstData, parts, partSize });\n            }\n            for (let i = 0, l = firstData.length; i < l; i += partSize) {\n                xTicks.push(firstData[i].epoch);\n            }\n            xTicks.push(firstData[firstData.length - 1].epoch);\n        }\n        return (\n            <>\n                <div class='w-100 mt-3 mb-4'>\n                    {/* <xmp>graphWorkoutSummaryWeekDistanceCurrent: {JSON.stringify(graphWorkoutSummaryWeekDistanceCurrent, null, 4)}</xmp>\n                    <xmp>graphWorkoutSummaryWeekDistancePrev: {JSON.stringify(graphWorkoutSummaryWeekDistancePrev, null, 4)}</xmp> */}\n                    <LineGraph\n                        stores={this.props.stores}\n                        width={1000}\n                        height={300}\n                        showXTicks={1}\n                        xTicksVal={xTicksVal}\n                        xTicks={xTicks}\n                        paddingTop={30}\n                        lineFromXzero={false}\n                        lineFromXmax={false}\n                        // xTicksLink={'/workouts/week/'}\n\n                        dataLeft={dataLeft}\n                        legendLeft={legendLeft}\n                        // yMaxLeft={30}\n                        // yMinLeft={0}\n                        showYTicksLeft={1}\n                        // yTicksLeftPostfix={'km'}\n                        // unitLeft={['km', 'km', 'km']}\n                        yTicksLeftVal={yTicksLeftVal}\n                        avgWindowLeft={[0, 0, 0, 0, 0, 0, 0]}\n                        smoothLeft={[0, 0, 0, 0, 0, 0, 0]}\n\n\n                        dataRight={dataRight}\n                        legendRight={legendRight}\n                        // dataRight={[graphWorkoutSummaryWeekElevationCurrent, graphWorkoutSummaryWeekElevationPrev]}\n                        // legendRight={[`${seasonStart} ${ascend}`, `${seasonStart - 1} ${ascend}`]}\n                        showYTicksRight={dataRight.length > 0 ? 1 : 0}\n                        // yTicksRightPostfix={'m'}\n                        // unitRight={['m', 'm']}\n                        yTicksRightVal={yTicksRightVal}\n                        avgWindowRight={[0, 0, 0, 0, 0, 0, 0]}\n                        smoothRight={[0, 0, 0, 0, 0, 0, 0]}\n\n                        scrollToRight={true}\n                        // marker={week}\n                    />\n                </div>\n\n            </>\n        );\n    }\n}\n\nexport default MiniViewGraph;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\n\nimport mu from '../../lib/musher-util';\n\nconst STOP_STATUSES = [2, 9];\nconst WARN_STATUSES = [4, 8];\n\n\nfunction getFatigueLevel(wo, dog) {\n    if (dog) {\n        if (STOP_STATUSES.indexOf(dog.status) > -1) {\n            return 'danger';\n        } else if (WARN_STATUSES.indexOf(dog.status) > -1) {\n            return 'warning';\n        }\n    }\n    if (wo) {\n        if (wo.distanceKm > 50) {\n            return 'danger';\n        } else if (wo.distanceKm > 30) {\n            return 'warning';\n        }\n    }\n    return 'success';\n}\n\n@observer\nclass Dog extends Component {\n    render() {\n        const { \n            dog = {},\n            dogs = [],\n            showTeam,\n            showInfo,\n            showName = true,\n            showPosition = true,\n            showAge = false,\n            className,\n            size,\n            onDogClick = () => {},\n        } = this.props;\n\t\tconst { userStore } = this.props.stores;\n        const { isAdmin, user } = userStore;\n        const { language = 'en' } = user;\n\n        const dogPosition = userStore.findDogposition({ position: dog.position, language });\n        const hasBirthday = mu.hasBirthday(dog.birth);\n        const daysUntilBirthday = Math.ceil(mu.daysUntilNextBirthday(dog.birth));\n\n        let containerWidth = '92px';\n        let imageClasses = '';\n        let fontSize = '35px';\n        if (size === 'small') {\n            containerWidth = '50px';\n            imageClasses = 'imageRoundedSmall';\n            fontSize = '20px';\n        } else if (size === 'medium') {\n            containerWidth = '60px';\n            imageClasses = 'imageRoundedMedium';\n            fontSize = '25px';\n        }\n\n        return (\n            <div class={`mb-2 position-relative ${className} clearfix`} style={`width: ${containerWidth}`}\n                onTouchstart={(e) => { e.stopPropagation(); }}\n                onTouchend={(e) => { e.stopPropagation(); }}\n                onTouchmove={(e) => { e.stopPropagation(); }}\n            >\n                {/* {JSON.stringify(dog, null, 4)} */}\n                {showPosition && dogPosition && <small class='position-absolute' style='left:0px; top: 50px;'>\n                    <span class={`badge badge-${dogPosition.class || 'primary'} mr-3`}>{dogPosition.icon && <i class={dogPosition.icon} />} {dogPosition.name}</span>\n                </small>}\n                <div\n                    class={`text-center border rounded-circle imageRounded ${imageClasses} mx-auto text-muted pt-2`}\n                    style={`${dog.image ? `background-image: url(\"${dog.image.s3SmallLink}\"); background-size: cover;` : ''} border-width: 2px !important;`}\n                >\n                    {/* {!dog.image && <i class='fas fa-dog mt-3' style='font-size: 40px;' />} */}\n                    {!dog.image && <span class='font-weight-lighter' style={`font-size: ${fontSize};`}>{util.ucfirst(dog.name, true)}</span>}\n                </div>\n                <div class='text-center text-overflow' style='line-height: 1.0em;'>\n                    <small>\n                        {/* <span class='float-right'>\n                            {dog.birth && <span class='mr-2'>{util.age(dog.birth, dog.deceased)}</span>}\n                            {dog.gender === 'female' ? <i class='fas fa-venus' /> : <i class='fas fa-mars' />}\n                        </span> */}\n                        <a href={`/dogs/public/${dog.uuidv4}`} onClick={(e) => onDogClick(e, dog.uuidv4, dogs)} class='stretched-link'>\n                            {showName && <>\n                                <span class='mb-1 font-weight-light'>\n                                    <nobr>\n                                        {dog.shortname || dog.name}\n                                        {hasBirthday && <>\n                                            <i class='fas fa-birthday-cake ml-3' />\n                                        </>}\n                                    </nobr>\n                                </span>\n                            </>}\n                        </a>\n                    </small>\n                </div>\n                <div class='text-center text-overflow' style='line-height: 1.0em;'>\n                    <small>\n                        {dog.birth && showAge && <>\n                            <span class='float-right'>\n                                {/* {daysUntilBirthday < 7 && <>\n                                    <span class='text-muted mr-2'>\n                                        <i class='fas fa-birthday-cake' /> in {daysUntilBirthday} days\n                                    </span>\n                                </>}                                 */}\n                                {dog.birth && <span class='mr-2'>{util.age(dog.birth, dog.deceased)}</span>}\n                                {dog.gender === 'female' ? <i class='fas fa-venus' /> : <i class='fas fa-mars' />}\n                            </span>\n                        </>}\n\n                        {showTeam && <><span class='font-weight-light'>{userStore.findTeam(dog.team)}</span><br /></>}\n\n                        {showInfo && <small class='text-muted'>\n                            {dog.weight && <><i class='fas fa-balance-scale ml-2' /> {util.format(dog.weight, 1)} kg</>}\n                            {dog.bodyScore && <><i class='fas fa-dog ml-2' /> {util.format(dog.bodyScore, 1)}</>}\n                        </small>}\n\n                    </small>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default Dog;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { route, Router } from 'preact-router';\nimport { Text, Localizer } from 'preact-i18n';\nimport Markdown from 'preact-markdown';\n\nimport PubSub, { topics } from '../../lib/pubsub';\nimport mu from '../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(false);\nconst MARGIN_TOP_BACK = mu.marginTopBack(false);\nconst MARGIN_BOTTOM = mu.marginBottom();\n\nimport ImageScroller from '../../components/imageScroller';\nimport MiniViewGraph from '../../components/dog/miniViewGraph';\n\nconst initialState = {\n    newTeam: {},\n};\n\n@observer\nclass DogsDetail extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n        this.updateTimer = {};\n        this.time = new Date().getTime();\n        this.apiServer = util.getApiServer();\n    }\n\n    async loadPublicView(props) {\n\t\tthis.setState({ isLoading: true });\n        const { dogid } = props;\n\t\tconst { dogStore } = this.props.stores;\n        await dogStore.getPublicViews(dogid);\n\t\tthis.setState({ isLoading: false });\n\t}\n\n    async loadAll(props = this.props) {\n        await this.loadPublicDog(props);\n        await this.loadPublicView(props);\n    }\n\n    async loadPublicDog(props = this.props) {\n\t\tconst { dogStore } = props.stores;\n        const { dogid, dogs = [] } = props;\n        await dogStore.loadPublicDetail({ id: dogid });\n\n\t\tconst { publicDog } = dogStore;\n        const currentDogIdx = dogs.findIndex(e => e.id === publicDog.id);\n        let prevDogIdx = null;\n        let nextDogIdx = null;\n        let prevDogName = null;\n        let nextDogName = null;\n        let hasPrevDog = false;\n        let hasNextDog = false;\n        if (currentDogIdx > 0) {\n            prevDogIdx = currentDogIdx - 1;\n            prevDogName = dogs[prevDogIdx].shortname || dogs[prevDogIdx].name;\n            hasPrevDog = true;\n        }\n        if (currentDogIdx < dogs.length - 1) {\n            nextDogIdx = currentDogIdx + 1;\n            nextDogName = dogs[nextDogIdx].shortname || dogs[nextDogIdx].name;\n            hasNextDog = true;\n        }\n        this.setState({\n            prevDogIdx,\n            prevDogName,\n            nextDogIdx,\n            nextDogName,\n            hasPrevDog,\n            hasNextDog,\n            currentDogIdx,\n        });\n        // console.log({ prevDogIdx, nextDogIdx, hasPrevDog, hasNextDog, currentDogIdx });\n    }\n\n    back = () => {\n        const { history } = this.props.stores;\n        history.goBack();\n    }\n\n    nextDog = () => {\n        const { nextDogIdx } = this.state;\n        const { dogs = [], stores } = this.props;\n\n        const nextDog = dogs[nextDogIdx];\n        if (nextDog && nextDog.uuidv4) {\n            this.loadPublicDog({\n                stores,\n                dogs,\n                dogid: nextDog.uuidv4, \n            });\n        }\n    }\n\n    prevDog = () => {\n        const { prevDogIdx } = this.state;\n        const { dogs = [], stores } = this.props;\n\n        const prevDog = dogs[prevDogIdx];\n        if (prevDog && prevDog.uuidv4) {\n            this.loadPublicDog({\n                stores,\n                dogs,\n                dogid: prevDog.uuidv4, \n            });\n        }\n    }\n    \n\tcomponentDidMount() {\n        const { back = this.back } = this.props;\n        const { appState } = this.props.stores;\n        appState.setSwipeRight(() => {\n            appState.setSwipeRight();\n            back();\n        });\n        this.loadAll();\n    }\n\n    componentWillReceiveProps(nextProps) {\n        // console.log('componentWillReceiveProps', nextProps);\n        if (nextProps.dogid !== this.props.dogid) {\n            this.loadAll(nextProps);\n        }\n    }\n\n\trender() {\n        const { hasPrevDog, hasNextDog, prevDogName, nextDogName } = this.state;\n\t\tconst { teamStore, dogStore, userStore } = this.props.stores;\n        const { user, isAdmin } = userStore;\n        const { language = 'en' } = user;\n\t\tconst { publicTeam: teamPublicTeam } = teamStore;\n\t\tconst { publicDog, publicTeam: dogPublicTeam, publicViewsGraphData, publicViewsGraphLegend } = dogStore;\n        const isTeamAdmin = (dogPublicTeam && dogPublicTeam.members) ? dogPublicTeam.members.some(m => m.id === user.id) : false;\n\n        // const publicTeam = dogPublicTeam || teamPublicTeam;\n        const publicTeam = dogPublicTeam || {};\n        const { marginTop, marginBottom, back = this.back, dogs } = this.props;\n        const defaultImage = {\n            s3XXLargeLink: './assets/homerun-race-logo.png',\n        };\n\n        const { users = [], imageHeader } = publicTeam;\n        const { image } = publicDog;\n\n        const headerImage = imageHeader && imageHeader.s3XXLargeLink ? imageHeader : defaultImage;\n        const teamImage = image && image.s3LargeLink ? image : null;\n        const teamAmbition = userStore.findTeamAmbition({ ambition: publicTeam.ambitions, language });\n        const teamType = userStore.findTeamType({ type: publicTeam.type, language });\n\n        const dogPosition = userStore.findDogposition({ position: publicDog.position, language });\n        const hasBirthday = mu.hasBirthday(publicDog.birth);\n        const daysUntilBirthday = Math.ceil(mu.daysUntilNextBirthday(publicDog.birth));\n\n\t\treturn (<>\n\t\t\t<div class='container-fluid pb-5' style={`margin-bottom: ${marginBottom || MARGIN_BOTTOM}; margin-top: ${marginTop || MARGIN_TOP};`}>\n                <button class='btn btn-link pl-0 fixed-top text-primary'\n                    style={`top: ${MARGIN_TOP_BACK}; left: 5px; font-size: 2.0em; width: 43px;`}\n                    onClick={back}>\n                    <i class='fas fa-arrow-circle-left' />\n                </button>\n                <div class='row mb-0'>\n                    <div class='w-100 position-relative'\n                        style={`height: 25vh; background-size: cover; background-repeat: no-repeat; background-position: 50% 50%; background-color: #a0a0a0; ${headerImage ? `background-image: url(\"${headerImage.s3XXLargeLink}\");` : ''}`}\n                    />\n\t\t\t\t\t<div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3'>\n                        <div class='row'>\n                            <div class='col-3 col-sm-4 col-md-3 col-lg-4 position-relative'>\n                                <div\n                                    class={`text-center border border-white rounded-circle position-absolute imageRoundedXLarge imageRoundedResponsive imageRoundedResponsivePosition`}\n                                    style={`left: 20px; ${teamImage ? `background-image: url(\"${teamImage.s3LargeLink}\"); background-size: cover; background-repeat: no-repeat; background-position: 50% 50%;` : ''}`}\n                                >\n                                    {!teamImage && <i class='fas fa-users text-muted mt-3' style='font-size: 40px;' />}\n                                </div>\n                                &nbsp;\n                            </div>\n                            <div class='col-9 col-sm-8 col-md-9 col-lg-8' style='line-height: 1.2em;'>\n                                <small class='font-weight-light'>\n                                    {publicTeam.name}\n                                </small><br />\n                                {publicDog.birth && <>\n                                    <h5 class='float-right'>\n                                        {daysUntilBirthday < 7 && <>\n                                            <span class='text-muted mr-2'>\n                                                <i class='fas fa-birthday-cake' /> in {daysUntilBirthday} days\n                                            </span>\n                                        </>}                                \n                                        {publicDog.birth && <span class='mr-2'>{util.age(publicDog.birth, publicDog.deceased)}</span>}\n                                        {publicDog.gender === 'female' ? <i class='fas fa-venus' /> : <i class='fas fa-mars' />}\n                                    </h5>\n                                </>}\n                                <h5 class='my-0'>\n                                    {publicDog.shortname || publicDog.name} \n                                    {hasBirthday && <>\n                                        <i class='fas fa-birthday-cake ml-3' />\n                                    </>}\n                                </h5>\n                                {publicDog.shortname && <div>\n                                    {publicDog.name}\n                                </div>}\n                                {dogPosition && dogPosition.class && <>\n                                    <span class={`badge badge-${dogPosition.class || 'primary'} mt-2`}>{dogPosition.icon && <i class={dogPosition.icon} />} {dogPosition.name}</span>\n                                </>}\n                                {publicDog.weight > 0 && <small class='text-muted'>\n                                    {publicDog.weight && <><i class='fas fa-balance-scale ml-2' /> {util.format(publicDog.weight, 1)} kg</>}\n                                </small>}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n\t\t\t\t<div class='row mt-5'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        <h5 class='font-weight-lighter text-muted border-bottom'><Text id='dogs.description'>Beskrivelse</Text></h5>\n                    </div>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        <Markdown markdown={mu.replaceImages(publicDog.description, publicDog.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                    </div>\n                </div>\n\n\t\t\t\t{publicDog.images && <div class='row mt-5'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        <h5 class='font-weight-lighter text-muted border-bottom'><Text id='dogs.public-photos' fields={{ total: publicDog.images.length }}>Bilder av hunden - {publicDog.images.length} stk</Text></h5>\n                    </div>\n                    <div class={`col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mb-0 position-relative px-0`}>\n                        <ImageScroller stores={this.props.stores} images={publicDog.images} />\n                    </div>\n\t\t\t\t</div>}\n\n                {publicDog.achievements && <div class='row mt-5'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        <h5 class='font-weight-lighter text-muted border-bottom'><Text id='dogs.achievements'>Achievements</Text></h5>\n                    </div>\n                    <div class={`col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mb-0 position-relative`}>\n                        <div class='row'>\n                            {publicDog.achievements && publicDog.achievements.map(file => {\n                                return (\n                                    <div class='col-12'>\n                                        {file.date && <span class='font-weight-lighter mr-2'>{util.isoDate(file.date, false, false, true)}</span>}\n                                        <span class='mr-2 font-weight-bold'>{file.name}</span>\n                                        <span class='mr-2 font-weight-light'>{file.description}</span>\n                                        {file.url && <span class='mr-2'><a href={mu.asUrl(file.url)} target='_blank' rel='noreferrer' native><i class='fas fa-link' /></a></span>}\n                                    </div>\n                                );\n                            })}\n                        </div>\n                    </div>\n\t\t\t\t</div>}\n\n\t\t\t\t{publicDog.trophys && <div class='row mt-5'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        <h5 class='font-weight-lighter text-muted border-bottom'><Text id='dogs.trophy'>Trophys</Text></h5>\n                    </div>\n                    <div class={`col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mb-0 position-relative`}>\n                        <div class='row'>\n                            {publicDog.trophys && publicDog.trophys.reverse().map(file => {\n                                const img = mu.getTrophyImage(file.name);\n                                if (!img) {\n                                    return '';\n                                }\n                                const textHeader = file.descriptionHeader && file.descriptionHeader[language] ? file.descriptionHeader[language] : '';\n                                const text = file.description && file.description[language] ? file.description[language] : '';\n                                return (\n                                    <div class='col-4 mt-3'>\n                                        <div class='mb-2'>\n                                            <img src={img} class='img-fluid' />\n                                        </div>\n                                        <strong>{textHeader}</strong>\n                                        {/* <small class='font-weight-lighter mr-2'>\n                                            {util.isoDate(file.createdDate, false, false, true)}\n                                        </small> */}\n                                        <small>\n                                            <details>\n                                                <summary><Text id='dogs.trophy-details'>Details</Text></summary>\n                                                <Markdown markdown={mu.replaceImages(text, publicDog.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                                            </details>\n                                        </small>\n                                    </div>\n                                );\n                            })}\n                        </div>\n                    </div>\n\t\t\t\t</div>}\n\n\t\t\t\t<div class='row mt-5 mb-5'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        <div class='text-center text-muted'>\n                            <div class='display-1'>\n                                <i class='fas fa-ellipsis-h' />\n                            </div>\n                            <div style='line-height: 0.9em;'>\n                                <small>\n                                    <Text id='dogs.something-missing'>Er det noe du savner på denne siden? Send oss en melding på Facebook.</Text>\n                                </small>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                {(isAdmin || isTeamAdmin) && <>\n                    <h5 class='font-weight-lighter text-muted border-bottom'><Text id='dogs.visits'>Dog page visits</Text></h5>\n                    <MiniViewGraph stores={this.props.stores}\n                        dataLeft={publicViewsGraphData}\n                        legendLeft={['dog']}\n                        key={`minigraph-dog-${publicDog.uuidv4}`}\n                    />\n                </>}\n\n                {hasNextDog && <span class='fixed-bottom text-primary' style='bottom: 60px; left: auto; right: 12px; width: 43px; font-size: 3.0em; z-index: 10;'>\n                    <i class='fas fa-arrow-circle-right' onClick={this.nextDog} />\n                </span>}\n                {hasPrevDog && <span class='fixed-bottom text-primary' style='bottom: 60px; left: 5px; width: 43px; font-size: 3.0em; z-index: 10;'>\n                    <i class='fas fa-arrow-circle-left' onClick={this.prevDog} />\n                </span>}\n\n                {publicDog.uuidv4 && <img src={`${this.apiServer}/api/dogs/${publicDog.uuidv4}/view?user=${user.id}&time=${this.time}`} style='width: 1; height: 1; opacity: 0.1;' />}\n\t\t\t</div>\n\t\t</>);\n\t}\n}\n\nexport default DogsDetail;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\n@observer\nclass Team extends Component {\n    requestFollowTeam = (e) => {\n        const { teamStore, userStore } = this.props.stores;\n        const { user } = userStore;\n        const teamId = parseInt(e.target.parentElement.dataset.team || e.target.dataset.team, 10);\n        teamStore.followRequest(teamId, user);\n        this.setState({ requestSent: true });\n    }\n\n    unFollowTeam = (e) => {\n        const { teamStore, userStore } = this.props.stores;\n        const { user } = userStore;\n        const teamId = parseInt(e.target.parentElement.dataset.team || e.target.dataset.team, 10);\n        teamStore.unollowTeam(teamId);\n        this.setState({ unfollowed: true });\n    }\n\n    getButton = (text = '') => {\n        const { requestSent } = this.state;\n        const { userStore } = this.props.stores;\n        const { user } = userStore;\n        const { team, skipHome, simple, classNames } = this.props;\n        const isYourTeam = team.members && team.members.indexOf(user.id) > -1;\n        const isFollowing = team.followers && team.followers.indexOf(user.id) > -1;\n        const isBlocked = team.blockedFollowers && team.blockedFollowers.indexOf(user.id) > -1;\n        const hasRequestedFollow = requestSent || team.followRequests && team.followRequests.findIndex(e => e.id === user.id) > -1;\n\n        if (isYourTeam) {\n            if (skipHome) {\n                return '';\n            }\n            return (\n                <i class='fas fa-home' />\n            );\n        }\n        if (isFollowing) {\n            return (<>\n                <button\n                    class={classNames || `btn btn-block btn-outline-secondary float-right`}\n                    onClick={this.unFollowTeam}\n                    disabled='true'\n                    data-team={team.id}\n                >\n                    <i class='fas fa-link mr-2' />\n                    <Text id='teams.connect.is-following'>Følger</Text> {!simple && <>{text}</>}\n                </button>\n                <button\n                    class={classNames || `btn btn-sm btn-block btn-danger float-right`}\n                    onClick={this.unFollowTeam}\n                    data-team={team.id}\n                >\n                    <i class='fas fa-unlink mr-2' />\n                    <Text id='teams.connect.unfollow'>Unfollow</Text>\n                </button>\n            </>);\n        }\n        if (isBlocked) {\n            return '';\n            // return (\n            //     <button\n            //         class={`btn btn-block btn-outline-secondary float-right`}\n            //         disabled='true'\n            //     >\n            //         <i class='fas fa-hand-paper mr-2' />\n            //         <Text id='teams.connect.is-blocked'>Blokkert</Text> {text}\n            //     </button>\n            // );\n        }\n        if (hasRequestedFollow) {\n            return (\n                <button\n                    class={classNames || `btn btn-block btn-outline-secondary float-right`}\n                    disabled='true'\n                >\n                    <i class='fas fa-hourglass-half mr-2' />\n                    <Text id='teams.connect.has-requested'>Venter på godkjenning</Text> {!simple && <>{text}</>}\n                </button>\n            );\n        }\n        if (team.public) {\n            return (\n                <button\n                    class={classNames || `btn btn-block btn-outline-success float-right`}\n                    onClick={this.requestFollowTeam}\n                    data-team={team.id}\n                >\n                    <i class='fas fa-plus mr-2' />\n                    <Text id='teams.connect.follow'>Følg</Text> {!simple && <>{text}</>}\n                </button>\n            );\n        }\n    }\n\n    render() {\n        const { unfollowed } = this.state;\n        const { team, buttonOnly } = this.props;\n        const { userStore } = this.props.stores;\n        const { user } = userStore;\n        const { language = 'en' } = user;\n        const teamAmbition = userStore.findTeamAmbition({ ambition: team.ambitions, language });\n        const teamType = userStore.findTeamType({ type: team.type, language });\n        const image = team.image && team.image.s3SmallLink ? team.image : null;\n\n        if (buttonOnly) {\n            return (<>\n                {this.getButton(`${team.name}`)}\n            </>);\n        }\n\n        return (\n            <div class='w-100 mb-3'>\n                <div class='row'>\n                    <div class='col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 d-flex mb-0 position-relative border-top pt-3'\n                        style={`${unfollowed ? 'text-decoration: line-through; opacity: 0.3;' : ''}`}\n                    >\n                        {/* {JSON.stringify(team, null, 4)} */}\n                        <a href={`/teams/public/${team.uuidv4}`}>\n                        <div class={`text-center border rounded-circle imageRounded`} style={image ? `background-image: url(\"${image.s3SmallLink}\");  background-size: cover;` : ''}>\n                            {!image && <i class='fas fa-users text-muted mt-3' style='font-size: 40px;' />}\n                        </div>\n                        </a>\n                        <div class='flex-grow-1 pl-3' style='line-height: 1.2em;'>\n                            <h5 class='mb-1' style='line-height: 1.0em;'>\n                                {team.public ? <>\n                                    <a href={`/teams/public/${team.uuidv4}`}>{team.name}</a>\n                                </> : <>\n                                    {team.name}\n                                </>}\n                            </h5>\n                            <div>\n                                {team.place} {team.country}\n                            </div>\n                            <div>\n                                {teamType && <span class='badge badge-pill badge-secondary'>{teamType}</span>}\n                                {teamAmbition && <span class='badge badge-pill badge-secondary ml-2'>{teamAmbition}</span>}\n                            </div>\n                            <small class='text-muted'>\n                                {team && team.dogs && <span class=''><i class='fas fa-dog' /> {team.dogs.length}</span>} \n                                {team && team.followers && <span class='ml-2'><i class='fas fa-user' /> {team.followers.length}</span>}\n                            </small>\n                        </div>\n                        <div>\n                            {this.getButton()}\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default Team;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { route, Router } from 'preact-router';\nimport { Text, Localizer } from 'preact-i18n';\nimport Markdown from 'preact-markdown';\n\nimport PubSub, { topics } from '../../lib/pubsub';\nimport mu from '../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(false);\nconst MARGIN_TOP_BACK = mu.marginTopBack(false);\nconst MARGIN_BOTTOM = mu.marginBottom();\n\nimport DogSimplePublic from '../../components/dog/simplePublic';\nimport ImageScroller from '../../components/imageScroller';\n// import TeamConnectConfirm from '../../components/team/connect-confirm';\nimport TeamLine from '../../components/team/publicLine';\nimport PublicTeam from '../../components/team/public';\n\nimport Overlay from '../../components/overlay/';\nimport DogPublicDetail from '../dogs/publicDetail';\n\nimport MiniViewGraph from '../../components/dog/miniViewGraph';\n\nconst initialState = {\n    newTeam: {},\n};\n\n@observer\nclass TeamsDetail extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n        this.updateTimer = {};\n        this.time = new Date().getTime();\n        this.apiServer = util.getApiServer();\n    }\n\n    async loadPublicView(props) {\n\t\tthis.setState({ isLoading: true });\n        const { teamid } = props;\n\t\tconst { teamStore } = this.props.stores;\n        await teamStore.getPublicViews(teamid);\n\t\tthis.setState({ isLoading: false });\n\t}\n\n    async loadAll(props = this.props) {\n        await this.loadPublicTeam(props);\n        await this.loadPublicView(props);\n    }\n\n    async loadPublicTeam(props = this.props) {\n\t\tconst { teamStore } = props.stores;\n        const { teamid } = props;\n        await teamStore.loadPublicDetail({ id: teamid });\n    }\n\n    // Overlay functions\n    onDogClick = (e, dogid) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.setState({\n            showDog: dogid,\n        });\n        return false;\n    }\n\n    hideDog = () => {\n        this.setState({\n            showDog: null,\n        });\n    }\n\n    onUserClick = (e, userid) => {\n        e.preventDefault();\n        e.stopPropagation();\n        return false;\n    }\n    // /Overlay functions\n\n    subscribeNotificationTopic = async (field) => {\n\t\tconst { userStore } = this.props.stores;\n        const { user } = userStore;\n        const { notificationTopics = {} } = user;\n        const value = 1;\n        await userStore.setNotificationTopic({\n            field: `notificationTopics.${field}`,\n            value,\n        });\n    }\n\n    back = () => {\n        const { history } = this.props.stores;\n        history.goBack();\n    }\n    \n\tcomponentDidMount() {\n        const { back = this.back } = this.props;\n        const { appState } = this.props.stores;\n        appState.setSwipeRight(() => {\n            appState.setSwipeRight();\n            back();\n        });\n        this.loadAll();\n    }\n\n    componentWillReceiveProps(nextProps) {\n        // console.log('componentWillReceiveProps', nextProps);\n        if (nextProps.teamid !== this.props.teamid) {\n            this.loadAll(nextProps);\n        }\n    }\n\n\trender() {\n        const { showDog } = this.state;\n\t\tconst { teamStore, userStore } = this.props.stores;\n        const { user, isAdmin } = userStore;\n        const { language = 'en' } = user;\n\t\tconst { publicTeam, publicTeamFollowers, publicViewsGraphData, publicViewsGraphLegend } = teamStore;\n        const isTeamAdmin = (publicTeam && publicTeam.members) ? publicTeam.members.some(m => m.id === user.id) : false;\n\n        const { marginTop, marginBottom, back = this.back, hideTeam = () => {} } = this.props;\n\n        const defaultImage = {\n            s3XXLargeLink: './assets/homerun-race-logo.png',\n        };\n\n        const {\n            dogs = [],\n            users = [],\n            image,\n            imageHeader,\n            publicWorkouts,\n            publicWorkoutDetails,\n            publicWorkoutSummary,\n            publicTrophys,\n            publicMemories,\n            publicDogs,\n        } = publicTeam;\n\n        const headerImage = imageHeader && imageHeader.s3XXLargeLink ? imageHeader : defaultImage;\n        const teamImage = image && image.s3LargeLink ? image : null;\n        const teamAmbition = userStore.findTeamAmbition({ ambition: publicTeam.ambitions, language });\n        const teamType = userStore.findTeamType({ type: publicTeam.type, language });\n        const isYourTeam = publicTeam.members && publicTeam.members.findIndex(e => e.id === user.id) > -1;\n        const isFollowing = publicTeam && publicTeam.followers && publicTeam.followers.indexOf(user.id) > -1;\n        const hasRequestedFollow = publicTeam.followRequests && publicTeam.followRequests.findIndex(e => e.id === user.id) > -1;\n\n        const { notificationTopics = {} } = user;\n        const topic = `team-${publicTeam.id}`;\n\n\t\treturn (<>\n            {showDog && <Overlay>\n                <DogPublicDetail stores={this.props.stores} dogid={showDog} marginTop={'0px;'} marginBottom={'0px;'} back={this.hideDog} dogs={dogs} />\n            </Overlay>}\n\n\t\t\t<div class='container-fluid pb-5' style={`margin-bottom: ${marginBottom || MARGIN_BOTTOM}; margin-top: ${marginTop || MARGIN_TOP};`}>\n                <button class='btn btn-link pl-0 fixed-top text-primary'\n                    style={`top: ${MARGIN_TOP_BACK}; left: 5px; font-size: 35px; width: 45px;`}\n                    onClick={back}>\n                    <i class='fas fa-arrow-circle-left' />\n                </button>\n\n                <div class='row mb-0'>\n                    <div class='w-100 position-relative'\n                        style={`height: 25vh; background-size: cover; background-repeat: no-repeat; background-position: 50% 50%; background-color: #a0a0a0; ${headerImage ? `background-image: url(\"${headerImage.s3XXLargeLink}\");` : ''}`}\n                    >\n                        {isYourTeam && <>\n                            <a class='btn btn-sm btn-primary position-absolute'\n                                style={`top: 5px; right: 10px;`}\n                                href={`/teams/edit/${publicTeam.id}`}\n                            >\n                                <i class='fas fa-edit' /> <Text id='teams.edit'>Endre</Text>\n                            </a>\n                        </>}                    \n                    </div>\n\t\t\t\t\t<div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3'>\n                        <div class='row'>\n                            <div class='col-3 col-sm-4 col-md-3 col-lg-4 position-relative'>\n                                <div\n                                    class={`text-center border border-white rounded-circle position-absolute imageRounded imageRoundedResponsive imageRoundedResponsivePosition`}\n                                    style={`left: 20px; ${teamImage ? `background-image: url(\"${teamImage.s3LargeLink}\"); background-size: cover; background-repeat: no-repeat; background-position: 50% 50%;` : ''}`}\n                                >\n                                    {!teamImage && <i class='fas fa-users text-muted mt-3' style='font-size: 40px;' />}\n                                </div>\n                                &nbsp;\n                            </div>\n                            <div class='col-9 col-sm-8 col-md-9 col-lg-8' style='line-height: 1.2em;'>\n                                <h5 class='my-0'>{publicTeam.name}</h5>\n                                <small class='text-muted'>\n                                    {publicTeam.place ? `${publicTeam.place}, ` : ''}{publicTeam.country}\n                                </small><br />\n                                {teamType && <span class='badge badge-pill badge-secondary mt-2'>{teamType}</span>}\n                                {teamAmbition && <span class='badge badge-pill badge-secondary mt-2 ml-2'>{teamAmbition}</span>}\n                                <h6 class='mt-2'>\n                                    <span class='mr-3'><span class='font-weight-bolder'>{publicTeam.followers ? publicTeam.followers.length : 0}</span> <Text id='teams.followers'>followers</Text></span>\n                                    <span class='mr-3'><span class='font-weight-bolder'>{publicTeam.dogs ? publicTeam.dogs.length : 0}</span> <Text id='teams.dogs-menu'>dogs</Text></span>\n                                </h6>\n                            </div>\n                        </div>\n                    </div>\n                    {(!notificationTopics || !notificationTopics[topic]) && <>\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3'>\n                            <button class='btn btn-block btn-primary btn-sm' onClick={() => this.subscribeNotificationTopic(topic)}>\n                                <Text id='team.notifications'>Subscribe to team notifications</Text>\n                            </button>                    \n                        </div>\n                    </>}\n                </div>\n\n\t\t\t\t<div class='row mt-5'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        {!isYourTeam && !isFollowing && !hasRequestedFollow && publicTeam.public > 0 && <div class='clearfix mb-2'>\n                            <PublicTeam stores={this.props.stores} team={publicTeam} buttonOnly={true} skipHome={true} />\n                        </div>}\n                    </div>\n                </div>\n\n                {/* <TeamConnectConfirm stores={this.props.stores} /> */}\n\n\t\t\t\t<div class='row mt-5'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        <h5 class='font-weight-lighter text-muted border-bottom'><Text id='teams.socialmedia'>Sosialemedier</Text></h5>\n                    </div>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        <div class='d-flex justify-content-center'>\n\n                            {isYourTeam && !publicTeam.facebook && <>\n                                <div class='text-center text-muted'>\n                                    <div class='display-1'>\n                                        <i class='fab fa-facebook' />\n                                    </div>\n                                    <h3 class='font-weight-lighter'>\n                                        <Text id='teams.add-sosialmedia'>Gå inn på endring av teamet for å legge inn en sosialemedier.</Text>\n                                    </h3>\n                                </div>\n                            </>}\n\n                            {publicTeam.url && <div class='mx-2'><h3><a href={mu.asUrl(publicTeam.url)} target='_blank' rel='noreferrer'><i class='fas fa-link' /></a></h3></div>}\n                            {publicTeam.facebook && <div class='mx-2'><h3><a href={mu.asFacebookLink(publicTeam.facebook)} target='_blank' rel='noreferrer'><i class='fab fa-facebook' /></a></h3></div>}\n                            {publicTeam.instagram && <div class='mx-2'><h3><a href={mu.asInstagramLink(publicTeam.instagram)} target='_blank' rel='noreferrer'><i class='fab fa-instagram' /></a></h3></div>}\n                            {publicTeam.snapchat && <div class='mx-2'><h3><a href={mu.asSnapchatLink(publicTeam.snapchat)} target='_blank' rel='noreferrer'><i class='fab fa-snapchat' /></a></h3></div>}\n                        </div>\n                        <div class='d-flex justify-content-center mt-3'>\n                            <div class='mx-2'><h3><a class='btn btn-outline-success' href={`/stories/team/${publicTeam.uuidv4}`}><i class='fas fa-rss' /> <Text id='story.all-stories'>Stories</Text></a></h3></div>\n                            <div class='mx-2'><h3><a class='btn btn-outline-primary' href={`/teams/workouts/team/${publicTeam.uuidv4}`} onClick={hideTeam}><i class='fas fa-running' /> <Text id='story.all-workouts'>All workouts</Text></a></h3></div>\n                        </div>\n                    </div>\n                </div>\n\n                {publicTeam.imagesSponsor && <div class='row mt-5'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        <h5 class='font-weight-lighter text-muted border-bottom'><Text id='teams.public-sponsor-images' fields={{ total: publicTeam.imagesSponsor.length }}>Sponsorer - {publicTeam.imagesSponsor.length} stk</Text></h5>\n                    </div>\n                    <div class={`col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mb-0 position-relative px-0`}>\n                        <ImageScroller stores={this.props.stores} images={publicTeam.imagesSponsor} />\n                    </div>\n                </div>}\n\n                {publicTeam.sponsors && <div class='row mt-5'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        <h5 class='font-weight-lighter text-muted border-bottom'><Text id='teams.sponsors'>Sponsors</Text></h5>\n                    </div>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        {isYourTeam && !publicTeam.sponsors && <>\n                            <div class='text-center text-muted'>\n                                <div class='display-1'>\n                                    <i class='fas fa-pen-nib' />\n                                </div>\n                                <h3 class='font-weight-lighter'>\n                                    <Text id='teams.add-sponsors'>Gå inn på endring av teamet for å legge inn sponsorer.</Text>\n                                </h3>\n                            </div>\n                        </>}\n                        <Markdown markdown={mu.replaceImages(publicTeam.sponsors, publicTeam.imagesSponsor, language)} markdownOpts={mu.getMarkdownOptions()} />\n                    </div>\n                </div>}\n\n\n\t\t\t\t<div class='row mt-5'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        <h5 class='font-weight-lighter text-muted border-bottom'><Text id='teams.description'>Beskrivelse</Text></h5>\n                    </div>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        {isYourTeam && !publicTeam.description && <>\n                            <div class='text-center text-muted'>\n                                <div class='display-1'>\n                                    <i class='fas fa-pen-nib' />\n                                </div>\n                                <h3 class='font-weight-lighter'>\n                                    <Text id='teams.add-description'>Gå inn på endring av teamet for å legge inn en beskrivelse.</Text>\n                                </h3>\n                            </div>\n                        </>}\n                        <Markdown markdown={mu.replaceImages(publicTeam.description, publicTeam.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                    </div>\n                </div>\n\n\t\t\t\t{publicTeam.descriptionWorkoutplan && <div class='row mt-5'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        <h5 class='font-weight-lighter text-muted border-bottom'><Text id='teams.description-workoutplan'>Workoutplan</Text></h5>\n                    </div>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        {isYourTeam && !publicTeam.descriptionWorkoutplan && <>\n                            <div class='text-center text-muted'>\n                                <div class='display-1'>\n                                    <i class='fas fa-pen-nib' />\n                                </div>\n                                <h3 class='font-weight-lighter'>\n                                    <Text id='teams.add-description-workoutplan'>Gå inn på endring av teamet for å legge inn en treningsplan.</Text>\n                                </h3>\n                            </div>\n                        </>}\n                        <Markdown markdown={mu.replaceImages(publicTeam.descriptionWorkoutplan, publicTeam.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                    </div>\n                </div>}\n\n\t\t\t\t{publicDogs && <div class='row mt-5'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        <h5 class='font-weight-lighter text-muted border-bottom'><Text id='teams.dogs' fields={{ total: dogs.length }}>Hundene - {dogs.length} stk</Text></h5>\n                    </div>\n\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        <div class='row'>\n                            {dogs && dogs.map(dog => (\n                                <DogSimplePublic stores={this.props.stores} dog={dog} showAge={true} className={'col'}\n                                    onDogClick={this.onDogClick} \n                                />\n                            ))}\n                        </div>\n                    </div>\n                </div>}\n\n\t\t\t\t{publicTeam.images && <div class='row mt-5'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        <h5 class='font-weight-lighter text-muted border-bottom'><Text id='teams.public-photos' fields={{ total: publicTeam.images.length }}>Teambilder - {publicTeam.images.length} stk</Text></h5>\n                    </div>\n                    <div class={`col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mb-0 position-relative px-0`}>\n                        <ImageScroller stores={this.props.stores} images={publicTeam.images} />\n                    </div>\n\t\t\t\t</div>}\n\n                {publicMemories && publicTeam.achievements && <div class='row mt-5'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        <h5 class='font-weight-lighter text-muted border-bottom'><Text id='teams.achievements'>Achievements</Text></h5>\n                    </div>\n                    <div class={`col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mb-0 position-relative`}>\n                        <div class='row'>\n                            {publicTeam.achievements && publicTeam.achievements.map(file => {\n                                return (\n                                    <div class='col-12'>\n                                        {file.date && <span class='font-weight-lighter mr-2'>{util.isoDate(file.date, false, false, true)}</span>}\n                                        <span class='mr-2 font-weight-bold'>{file.name}</span>\n                                        <span class='mr-2 font-weight-light'>{file.description}</span>\n                                        {file.url && <span class='mr-2'><a href={mu.asUrl(file.url)} target='_blank' rel='noreferrer' native><i class='fas fa-link' /></a></span>}\n                                    </div>\n                                );\n                            })}\n                        </div>\n                    </div>\n\t\t\t\t</div>}\n\n\t\t\t\t{publicTrophys && publicTeam.trophys && <div class='row mt-5'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        <h5 class='font-weight-lighter text-muted border-bottom'><Text id='teams.trophy'>Trophys</Text></h5>\n                    </div>\n                    <div class={`col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mb-0 position-relative`}>\n                        <div class='row'>\n                            {publicTeam.trophys && publicTeam.trophys.reverse().map(file => {\n                                const img = mu.getTrophyImage(file.name);\n                                if (!img) {\n                                    return '';\n                                }\n                                const textHeader = file.descriptionHeader && file.descriptionHeader[language] ? file.descriptionHeader[language] : '';\n                                const text = file.description && file.description[language] ? file.description[language] : '';\n                                return (\n                                    <div class='col-4 mt-3'>\n                                        <div class='mb-2'>\n                                            <img src={img} class='img-fluid' />\n                                        </div>\n                                        <strong>{textHeader}</strong>\n                                        {/* <small class='font-weight-lighter mr-2'>\n                                            {util.isoDate(file.createdDate, false, false, true)}\n                                        </small> */}\n                                        <small>\n                                            <details>\n                                                <summary><Text id='teams.trophy-details'>Details</Text></summary>\n                                                <Markdown markdown={mu.replaceImages(text, publicTeam.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                                            </details>\n                                        </small>\n                                    </div>\n                                );\n                            })}\n                        </div>\n                    </div>\n\t\t\t\t</div>}\n\n                {/* {util.isArray(publicTeamFollowers) && <div class='row mt-5'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        <h5 class='font-weight-lighter text-muted border-bottom'><Text id='teams.followers'>Followers</Text></h5>\n                    </div>\n                    <div class={`col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mb-0 position-relative`}>\n                        {util.isArray(publicTeamFollowers) && publicTeamFollowers.map(t => \n                            <TeamLine stores={this.props.stores} team={t} myTeamId={publicTeam.id} showBlockButton={false} callback={this.loadTeam} />\n                        )}\n                    </div>\n                </div>} */}\n\n\t\t\t\t<div class='row mt-5 mb-5'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        <div class='text-center text-muted'>\n                            <div class='display-1'>\n                                <i class='fas fa-ellipsis-h' />\n                            </div>\n                            <div style='line-height: 0.9em;'>\n                                <small>\n                                    <Text id='teams.something-missing'>Er det noe du savner på denne siden? Send oss en melding på Facebook.</Text>\n                                </small>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                {(isAdmin || isTeamAdmin) && <>\n                    <h5 class='font-weight-lighter text-muted border-bottom'><Text id='teams.visits'>Team page visits</Text></h5>\n                    <MiniViewGraph stores={this.props.stores}\n                        dataLeft={publicViewsGraphData}\n                        legendLeft={['team']}\n                        key={`minigraph-team-${publicTeam.uuidv4}`}\n                    />\n                </>}\n\n                {publicTeam.uuidv4 && <img src={`${this.apiServer}/api/teams/${publicTeam.uuidv4}/view?user=${user.id}&time=${this.time}`} style='width: 1; height: 1; opacity: 0.1;' />}\n\t\t\t</div>\n\t\t</>);\n\t}\n}\n\nexport default TeamsDetail;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { route } from 'preact-router';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nconst initialState = {\n\trequestSent: {},\n    confirmed: {},\n    deleted: {},\n    submenu: 'notfollowing',\n};\n\n@observer\nclass TeamLine extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n        this.updateTimer = {};\n    }\n\n    requestFollowTeam = async (e) => {\n        const { teamStore, userStore } = this.props.stores;\n        const { user } = userStore;\n        const teamId = parseInt(e.target.parentElement.dataset.team || e.target.dataset.team, 10);\n        teamStore.followRequest(teamId, user);\n        const { requestSent } = this.state;\n        requestSent[teamId] = true;\n        this.setState({ requestSent });\n    }\n\n    confirmRequest = async (e) => {\n        const { callback = () => {} } = this.props;\n        const { team, user } = e.target.closest('button').dataset;\n        const { teamStore } = this.props.stores;\n        const { confirmed, deleted } = this.state;\n\t\tconfirmed[`${team}-${user}`] = true;\n        delete deleted[`${team}-${user}`];\n        this.setState({ confirmed, deleted });\n        await teamStore.confirmFollowRequest({\n            team: parseInt(team, 10),\n            user: parseInt(user, 10),\n        });\n        callback();\n    }\n\n    deleteRequest = async (e) => {\n        const { callback = () => {} } = this.props;\n        const { team, user } = e.target.closest('button').dataset;\n        const { teamStore } = this.props.stores;\n        const { deleted, confirmed } = this.state;\n\t\tdeleted[`${team}-${user}`] = true;\n        delete confirmed[`${team}-${user}`];\n        this.setState({ deleted, confirmed });\n        await teamStore.deleteFollowRequest({\n            team: parseInt(team, 10),\n            user: parseInt(user, 10),\n        });\n        callback();\n    }\n\n    unFollowTeam = (e) => {\n        const { teamStore, userStore } = this.props.stores;\n        const { user } = userStore;\n        const teamId = parseInt(e.target.parentElement.dataset.team || e.target.dataset.team, 10);\n        teamStore.unollowTeam(teamId);\n        this.setState({ unfollowed: true });\n    }\n\n    getUnblockButton = (userId, myTeamId) => {\n        const { confirmed } = this.state;\n        const isConfirmed = confirmed[`${myTeamId}-${userId}`];\n        return <>\n            {isConfirmed ? <>\n                <small class='text-success'>\n                    <i class='fas fa-check' /> <Text id='teams.connect.confirmed'>Confirmed</Text>\n                </small>\n            </> : <>\n                <button class='btn btn-sm btn-block btn-success text-overflow mt-1'\n                    onClick={this.confirmRequest}\n                    data-team={myTeamId}\n                    data-user={userId}>\n                    <Text id='teams.connect.confirm'>Confirm</Text>\n                </button>\n            </>}\n        </>;\n    }\n\n    getButton = (team) => {\n        const { requestSent } = this.state;\n        const { userStore } = this.props.stores;\n        const { user } = userStore;\n\n        const isYourTeam = team.members && team.members.indexOf(user.id) > -1;\n        const isFollowing = team.followers && team.followers.indexOf(user.id) > -1;\n        const isBlocked = team.blockedFollowers && team.blockedFollowers.indexOf(user.id) > -1;\n        const hasRequestedFollow = requestSent[team.id] || team.followRequests && team.followRequests.findIndex(e => e.id === user.id) > -1;\n\n        if (isYourTeam) {\n            return (\n                <i class='fas fa-home' />\n            );\n        }\n        if (!team.public) {\n            return (<>\n                <small class='text-muted'>\n                    <Text id='teams.not-public'>Ikke offentlig</Text>\n                </small>\n            </>);\n        }\n        if (isFollowing) {\n            return (<>\n                <button\n                    class={`btn btn-sm btn-block btn-outline-secondary float-right`}\n                    onClick={this.unFollowTeam}\n                    disabled='true'\n                    data-team={team.id}\n                >\n                    <i class='fas fa-link mr-2' />\n                    <Text id='teams.connect.is-following'>Følger</Text>\n                </button>\n                <button\n                    class={`btn btn-sm btn-block btn-outline-danger float-right`}\n                    onClick={this.unFollowTeam}\n                    disabled='true'\n                    data-team={team.id}\n                >\n                    <Text id='teams.connect.unfollow'>Unfollow</Text>\n                </button>\n            </>);\n        }\n        if (isBlocked) {\n            return (<></>);\n            // return (\n            //     <button\n            //         class={`btn btn-sm btn-block btn-outline-secondary float-right`}\n            //         disabled='true'\n            //     >\n            //         <i class='fas fa-hand-paper mr-2' />\n            //         <Text id='teams.connect.is-blocked'>Blokkert</Text>\n            //     </button>\n            // );\n        }\n        if (hasRequestedFollow) {\n            return (\n                <button\n                    class={`btn btn-sm btn-block btn-outline-secondary float-right`}\n                    disabled='true'\n                >\n                    <i class='fas fa-hourglass-half mr-2' />\n                    <Text id='teams.connect.has-requested'>Venter på godkjenning</Text>\n                </button>\n            );\n        }\n        return (\n            <button\n                class={`btn btn-sm btn-block btn-outline-success float-right`}\n                onClick={this.requestFollowTeam}\n                data-team={team.id}\n            >\n                <i class='far fa-hand-point-right mr-2' />\n                <Text id='teams.connect.follow'>Følg</Text>\n            </button>\n        );\n    }\n\n\trender() {\n        const { deleted = {}, unfollowed } = this.state;\n        const { team, isBlocked, myTeamId, showBlockButton } = this.props;\n        const { storyStore } = this.props.stores;\n\n        const user = storyStore.findPublicUser(team.user) || team.user || {};\n        let image;\n        if (team.image && team.image.s3SmallLink) {\n            image = team.image;\n        } else if (team.images && team.images[0] && team.images[0].s3SmallLink) {\n            image = team.images[0];\n        } else if (user.image && user.image.s3SmallLink) {\n            image = user.image;\n        } else if (user.images && user.images[0] && user.images[0].s3SmallLink) {\n            image = user.images[0];\n        }\n        let shortname;\n        let name;\n        let username;\n        if (team && team.name) {\n            shortname = mu.displayNameShort(team);\n            name = mu.displayName(team);\n            username = mu.displayName(user);\n        } else if (user && user.id) {\n            shortname = mu.displayNameShort(user);\n            name = mu.displayName(user);\n        }\n\n        const isDeleted = deleted[`${myTeamId}-${user.id}`];\n\n        return (\n            <div class='col-12 mb-2 pb-2 border-bottom'\n                style={`${unfollowed ? 'text-decoration: line-through; opacity: 0.3;' : ''}`}\n            >\n                <div class='d-flex position-relative'>\n                    <div\n                        class={`text-center border rounded-circle imageRounded imageRoundedMedium`}\n                        style={image ? `background-image: url(\"${image.s3MediumLink}\"); background-size: cover;` : ''}\n                    >\n                        {!image && <div class='text-muted' style='font-size: 20px; padding-top: 3px;'>{shortname}</div>}\n                    </div>\n                    <div class='flex-grow-1 pl-3 text-overflow' style='line-height: 1.2em;'>\n                        <h5 class='mb-0'>\n                            {team.public ? <>\n                                <a href={`/teams/public/${team.uuidv4}`}>{name}</a>\n                            </> : <>\n                                {name}\n                            </>}                                         \n                        </h5>\n                        <div>\n                            {team.place ? `${team.place}, ` : ''} {team.country} &nbsp;\n                        </div>\n                        <div>\n                            <small class='text-muted'>\n                                {team && team.dogs && <span class=''><i class='fas fa-dog' /> {team.dogs.length}</span>} \n                                {team && team.followers && <span class='ml-2'><i class='fas fa-user' /> {team.followers.length}</span>}\n                                {username && <>\n                                    <small class='ml-2 text-muted'>\n                                        {username}\n                                    </small>\n                                </>}\n                                {showBlockButton && <>\n                                    {isDeleted ? <>\n                                        <small class='text-danger ml-3'>\n                                            <i class='fas fa-ban' /> <Text id='teams.connect.deleted'>Deleted</Text>\n                                        </small>\n                                    </> : <>\n                                        <button class='btn btn-sm btn-link text-overflow p-0 text-muted ml-3'\n                                            style='font-size: 0.8em;'\n                                            onClick={this.deleteRequest}\n                                            data-team={myTeamId}\n                                            data-user={user.id}\n                                        >\n                                            <i class='fas fa-ban' /> <Text id='teams.connect.block'>Blokkere</Text>\n                                        </button>\n                                    </>}\n                                </>}\n                            </small>\n                        </div>\n                    </div>\n                    <div>\n                        {isBlocked ? <>\n                            {this.getUnblockButton(user.id, myTeamId)}\n                        </> : <>\n                            {this.getButton(team)}\n                        </>}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default TeamLine;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer, withText } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nconst MARGIN_TOP = mu.marginTop(false);\nconst MARGIN_BOTTOM = mu.marginBottom();\n\n@observer\nclass Overlay extends Component {\n    render() {\n        const { children } = this.props;\n        return (\n            <div\n                class='w-100 h-100 fixed-top bg-light skipRefresh'\n                style={`\n                    margin-bottom: ${MARGIN_BOTTOM};\n                    margin-top: ${MARGIN_TOP};\n                    height: calc(100vh - ${MARGIN_TOP}) !important;\n                    top: 0;\n                    left: 0;\n                    overflow-x: auto;\n                    overflow-y: auto;\n                    transition: .3s;\n                    overscroll-behavior: contain;\n                    z-index: 10000;\n                `}\n            >\n                {children}\n            </div>\n        );\n    }\n}\n\nexport default Overlay;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nfunction hasImage(img) {\n    return (util.isObject(img) && img.s3LargeLink);\n}\n\n\n@observer\nclass ImageScroller extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            imageIdx: 0,\n            imageElementScale: 1,\n            imageElementMaxScale: 5,\n            start: {},\n        };\n    }\n\n    scrollImages = (e) => {\n        const { images } = this.props;\n        const totalImages = images.length - 1;\n\n        // scrollHeight: 705\n        // scrollLeft: 564\n        // scrollTop: 0\n        // scrollWidth: 1692\n\n        const { scrollLeft, scrollWidth, clientWidth } = e.target;\n        const imageStep = clientWidth;\n        const imageIdx = scrollLeft / imageStep;\n        // console.log({ e, imageStep, imageIdx, scrollLeft, scrollWidth, clientWidth });\n\n        const nearestInt = Math.round(imageIdx);\n        const diff = Math.abs(nearestInt - imageIdx);\n        // console.log({ nearestInt, diff });\n        if (Number.isInteger(imageIdx) || diff < 0.1) {\n            this.setState({\n                imageIdx: nearestInt,\n            });\n        }\n    }\n\n    distance = (event) => {\n        return Math.hypot(event.touches[0].pageX - event.touches[1].pageX, event.touches[0].pageY - event.touches[1].pageY);\n    }\n\n    pinchZoomOnTouchStart = (event) => {\n        // console.log('touchstart', event);\n        if (event.touches.length === 2) {\n            event.preventDefault(); // Prevent page scroll\n            event.stopPropagation();\n\n            // Calculate where the fingers have started on the X and Y axis\n            const start = {};\n            start.x = (event.touches[0].pageX + event.touches[1].pageX) / 2;\n            start.y = (event.touches[0].pageY + event.touches[1].pageY) / 2;\n            start.distance = this.distance(event);\n            this.setState({ start });\n        }    \n    }\n\n    pinchZoomOnTouchMove = (event) => {\n        // console.log('touchmove', event);\n        let { imageElementScale, imageElementMaxScale } = this.state;\n        const { start } = this.state;\n        if (event.touches.length === 2) {\n            event.preventDefault(); // Prevent page scroll\n            event.stopPropagation();\n            let scale;\n\n            // Safari provides event.scale as two fingers move on the screen\n            // For other browsers just calculate the scale manually\n            if (event.scale) {\n                scale = event.scale;\n            } else {\n            const deltaDistance = this.distance(event);\n                scale = deltaDistance / start.distance;\n            }\n\n            imageElementScale = Math.min(Math.max(1, scale), imageElementMaxScale);\n            this.setState({ imageElementScale }, () => {\n                // Calculate how much the fingers have moved on the X and Y axis\n                const deltaX = (((event.touches[0].pageX + event.touches[1].pageX) / 2) - start.x) * 2; // x2 for accelarated movement\n                const deltaY = (((event.touches[0].pageY + event.touches[1].pageY) / 2) - start.y) * 2; // x2 for accelarated movement\n\n                // Transform the image to make it grow and move with fingers\n                const transform = `translate3d(${deltaX}px, ${deltaY}px, 0) scale(${imageElementScale})`;\n                event.target.style.transition = '';\n                event.target.style.transform = transform;\n                event.target.style.WebkitTransform = transform;\n                event.target.style.zIndex = '100000';\n                // event.target.style.maxHeight = '';\n                // event.target.style.maxWidth = '';\n            });\n\n        }\n    }\n\n    pinchZoomOnTouchEnd = (event) => {\n        // console.log('touchend', event);\n        // Reset image to it's original format\n        this.setState({ imageElementScale: 1 });\n        event.target.style.transition = 'transform 250ms';\n        event.target.style.transform = '';\n        event.target.style.WebkitTransform = '';\n        event.target.style.zIndex = '';\n        // event.target.style.maxHeight = '75vh';\n        // event.target.style.maxWidth = '100%';\n    }\n\n    render() {\n        const { imageIdx, imageElementScale } = this.state;\n        const { images, id, dblClick = () => {}, likeRef = {}, noimagestext, minHeight = '100px' } = this.props;\n\n        if (!images || images.length === 0) {\n            if (noimagestext) {\n                return (<>            \n                    <div class='col-12 text-center text-muted'>\n                        <div class='display-1'>\n                            <i class='fas fa-camera' />\n                        </div>\n                        <h3 class='font-weight-lighter'>\n                            {noimagestext}\n                        </h3>\n                    </div>\n                </>);\n            }\n            return <></>;\n        }\n\n        return (\n            <div class='w-100 position-relative'>\n                <div\n                    class='d-flex flex-row flex-nowrap bg-light border-top border-bottom no-scrollbar'\n                    style={`\n                        overflow-x: ${imageElementScale > 1 && images.length === 1 ? 'visible !important' : 'auto'};\n                        overflow-y: ${imageElementScale > 1 ? 'visible !important' : 'auto'};\n                        scroll-snap-type: x mandatory;\n                    `}\n                    onScroll={this.scrollImages}\n                >\n                    {images && images.filter(hasImage).map((img, idx) => (\n                        <div class='col-12 clearfix p-0'>\n                            <div\n                                class={`w-100 h-100 text-center rounded-lg imageContainer d-flex justify-content-center align-items-center position-relative `}\n                                style={`\n                                    scroll-snap-align: start;\n                                    flex-wrap: wrap;\n                                `}\n                                // overflow: ${imageElementScale > 1 ? 'visible !important' : 'hidden'};\n                                onDblclick={dblClick}\n                                data-id={id}\n                                onTouchstart={(e) => { e.stopPropagation(); }}\n                                onTouchend={(e) => { e.stopPropagation(); }}\n                                onTouchmove={(e) => { e.stopPropagation(); }}\n                            >\t\t\t\t\t\n                                <div\n                                    class='position-absolute w-100 h-100'\n                                    style={`\n                                        background-image: url('${img.s3SmallLink}'); background-size: cover;\n                                        filter: blur(10px);\n                                        opacity: 0.5;\n                                    `}\n                                        // overflow-y: ${imageElementScale > 1 ? 'visible !important' : 'hidden'};\n                                />\n                                {img.s3LargeLink ? <img\n                                    class='img-fluid position-relative'\n                                    src={`${img.s3LargeLink}${img.updatedDate ? `?updated=${`${img.updatedDate}`}`: ''}`}\n                                    loading='lazy'\n                                    style={`max-height: 75vh; min-height: ${minHeight}; ${idx !== imageIdx ? '' : ''}`}\n\n                                    onTouchstart={this.pinchZoomOnTouchStart}\n                                    onTouchend={this.pinchZoomOnTouchEnd}\n                                    onTouchmove={this.pinchZoomOnTouchMove}\n                                /> : <>\n                                    <span class='display-1 text-muted'>\n                                        <i class='fas fa-camera' />\n                                    </span>\n                                </>}\n\n                                {/* <xmp>{JSON.stringify(img, null, 4)}</xmp> */}\n                            </div>\n                            {likeRef[id] && <span class='likeHeart position-absolute text-white display-1' style='top: calc(50% - 50px); left: calc(50% - 50px); width: 100px; height: 100px;'>\n                                <i class='fas fa-heart likeStory' />\n                            </span>}\n                        </div>\n                    ))}\n                </div>\n                {images && images.length > 1 && <>\n                    <div class='w-100 text-center'>\n                        <small>\n                            <small>\n                                {images && images.filter(hasImage).map((img, idx) => <>\n                                    <i class={`${idx === imageIdx ? 'fas' : 'far'} fa-circle mr-1`} />\n                                </>)}\n                            </small>\n                        </small>\n                    </div>\n                    <div\n                        class='position-absolute text-white font-weight-lighter px-1 py-1 rounded-lg'\n                        style='top: 10px; right: 10px; background-color: rgba(0, 0, 0, 0.3); line-height: 1.0em;'\n                    >\n                        <small>{imageIdx + 1} / {images.length}</small>\n                    </div>\n                </>}\n\n            </div>\n        );\n    }\n}\n\nexport default ImageScroller;\n"],"sourceRoot":""}