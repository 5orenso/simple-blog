(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"3on9":function(e,t,s){"use strict";(function(e){function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}function o(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function a(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?o(Object(s),!0).forEach((function(t){d(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function d(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var l,n=s("hosL"),c=s("Utv1"),r=s("/eY4"),h=s("cneo"),g=s("go65"),p=(s("Y3FI"),s("OhSV")),b=s("dVCl");const m={id:0,name:"empty"},f=()=>{const e=a({},m);return e.unique=`${(new Date).getTime()}-${c.a.randomPassword()}`,e};class u extends n.Component{render(){const{provided:e,snapshot:t,innerRef:s,children:o,className:a}=this.props;return Object(n.h)("div",i({class:"h-100 border "+a},e.droppableProps,{ref:s,style:(d=t.isDraggingOver,{borderStyle:d?"dashed":"",width:110})}),o);var d}}class O extends n.Component{constructor(...e){super(...e),this.removeThisPlaceholder=()=>{const{removePlaceholder:e=(()=>{}),idx:t,list:s}=this.props;e({idx:t,list:s})}}render(){const{provided:t,snapshot:s,innerRef:o,dog:d}=this.props;return Object(n.h)("div",i({},t.draggableProps,t.dragHandleProps,{ref:o,class:"mx-2 my-2 p-2",style:(l=s.isDragging,r=t.draggableProps.style,a({userSelect:"none",background:l?"#808080":"",maxWidth:92,height:100},r))}),0===d.id?Object(n.h)(e,null,Object(n.h)("div",null,Object(n.h)("div",{class:"text-center border rounded-circle imageRounded text-muted pt-2"},Object(n.h)("span",{class:"font-weight-lighter",style:"font-size: 35px;"}," ")),Object(n.h)("div",{class:"text-center"},Object(n.h)("button",{class:"btn btn-sm btn-link float-right p-0",onClick:this.removeThisPlaceholder},Object(n.h)("i",{class:"fas fa-trash-alt"}))," "))):Object(n.h)(e,null,Object(n.h)("div",null,Object(n.h)("div",{class:"text-center border rounded-circle imageRounded text-muted pt-2",style:""+(d.image?`background-image: url("${d.image.s3ThumbLink}");`:"")},!d.image&&Object(n.h)("span",{class:"font-weight-lighter",style:"font-size: 35px;"},c.a.ucfirst(d.name,!0))),Object(n.h)("div",{class:"text-center"},Object(n.h)("small",null,d.shortname||d.name,Object(n.h)("br",null))))));var l,r}}const j={filterby:c.a.get("dogs-filter")};let y=Object(r.a)(l=class extends n.Component{constructor(e){var t;super(e),t=this,this.toggleDog=async function(e){const{id:s}=e.target.closest("#dogContainer").dataset,i=parseInt(s,10),{object:o,type:a,elementtype:d,field:l,updateField:n,isNew:c,showPositions:r}=t.props,g=Object(h.i)(o[l])||[],p=g.indexOf(i);let b;p>-1?(g.splice(p,1),b="remove"):(g.push(i),b="add"),await n({id:o.id,field:l,value:g,type:a,elementtype:d,isNew:c,skipTimer:!0,singleValue:i}),t.setState({filterText:""}),r&&t.dndDogs({dogId:i,action:b})},this.findAllDogsInTeams=()=>{const{dogStore:e}=this.props.stores,{dogs:t=[]}=e,{object:s,currentTeam:i={}}=this.props,o=Object(h.i)(s.teams||[]),a=i.id;return t.filter(e=>!!(e.team===a||e.teams&&e.teams.indexOf(a)>-1)||(o.indexOf(e.team)>-1||!!e.teams&&e.teams.some(e=>o.indexOf(e)>=0))).map(e=>e.id)},this.addAllDogsInTeam=async function(){const{object:e,type:s,elementtype:i,field:o,updateField:a,isNew:d}=t.props,l=t.findAllDogsInTeams();await a({id:e.id,field:o,value:l,type:s,elementtype:i,isNew:d,skipTimer:!0})},this.dndDogs=({dogId:e,action:t})=>{const{dogStore:s}=this.props.stores,{dogs:i=[]}=s,{object:o}=this.props,a=o.dogs?e=>o.dogs.indexOf(e.id)>-1:()=>!1,d=Object(h.i)(i),l=e=>0===e||d.find(t=>t.id===e)&&-1===o.dogsRight.indexOf(e),n=e=>0===e||d.find(t=>t.id===e)&&-1===o.dogsLeft.indexOf(e),c=d.filter(a),r=Math.ceil(c.length/2),g=c.splice(0,r);let p=[];o.dogsLeft&&o.dogsLeft.length>0&&(p=o.dogsLeft.filter(l).map(e=>d.find(t=>t.id===e)||f()));let b=[];if(o.dogsRight&&o.dogsRight.length>0&&(b=o.dogsRight.filter(n).map(e=>d.find(t=>t.id===e)||f())),"add"===t){const t=i.find(t=>t.id===e);t&&(p.length>b.length?b.push(t):p.push(t))}if("remove"===t){const t=p.findIndex(t=>t.id===e);t>-1&&p.splice(t,1);const s=b.findIndex(t=>t.id===e);s>-1&&b.splice(s,1)}0===p.length&&0===b.length&&(p=g,b=c),t?this.setState({dogsLeft:p,dogsRight:b,dogPositionUpdated:!0},()=>this.updateDogPositions()):this.setState({dogsLeft:p,dogsRight:b})},this.addPlaceholderLeft=()=>{const{dogsLeft:e=[]}=this.state;e.push(f()),this.setState({dogsLeft:e,dogPositionUpdated:!0})},this.addPlaceholderRight=()=>{const{dogsRight:e=[]}=this.state;e.push(f()),this.setState({dogsRight:e,dogPositionUpdated:!0})},this.removePlaceholder=({idx:e,list:t})=>{if("dogsLeft"===t){const{dogsLeft:t=[]}=this.state;t.splice(e,1),this.setState({dogsLeft:t,dogPositionUpdated:!0})}if("dogsRight"===t){const{dogsRight:t=[]}=this.state;t.splice(e,1),this.setState({dogsRight:t,dogPositionUpdated:!0})}},this.clearAllDogs=async function(){const{object:e,type:s,elementtype:i,field:o,updateField:a,isNew:d}=t.props;await a({id:e.id,field:o,value:[],type:s,elementtype:i,isNew:d,skipTimer:!0}),t.resetDogPositions()},this.toggleSearchField=()=>{const{showSearchField:e}=this.state;this.setState({showSearchField:e?null:1})},this.getList=e=>this.state[e],this.onDragEnd=e=>{const{source:t,destination:s}=e;if(s)if(t.droppableId===s.droppableId){const e=((e,t,s)=>{const i=Array.from(e),[o]=i.splice(t,1);return i.splice(s,0,o),i})(this.getList(t.droppableId),t.index,s.index);this.setState({[t.droppableId]:e,dogPositionUpdated:!0})}else{const e=((e,t,s,i)=>{const o=Array.from(e),a=Array.from(t),[d]=o.splice(s.index,1);a.splice(i.index,0,d);const l={};return l[s.droppableId]=o,l[i.droppableId]=a,l})(this.getList(t.droppableId),this.getList(s.droppableId),t,s);this.setState({dogsLeft:e.dogsLeft,dogsRight:e.dogsRight,dogPositionUpdated:!0})}},this.updateDogPositions=async function(){const{dogsLeft:e=[],dogsRight:s=[]}=t.state,{object:i,updateField:o,isNew:a}=t.props;await o({id:i.id,field:"dogsLeft",value:e.map(e=>e.id),isNew:a,datatype:"array"}),await o({id:i.id,field:"dogsRight",value:s.map(e=>e.id),isNew:a,datatype:"array"}),t.setState({dogPositionUpdated:!1})},this.resetDogPositions=async function(){const{dogStore:e}=t.props.stores,{dogs:s=[]}=e,{object:i,updateField:o,isNew:a}=t.props,d=Object(h.i)(s).filter(e=>i.dogs.indexOf(e.id)>-1),l=Math.ceil(d.length/2),n=d.splice(0,l);await o({id:i.id,field:"dogsLeft",value:n.map(e=>e.id),isNew:a,datatype:"array"}),await o({id:i.id,field:"dogsRight",value:d.map(e=>e.id),isNew:a,datatype:"array"}),t.setState({dogsLeft:n,dogsRight:d,dogPositionUpdated:!1})},this.clearDogPositions=async function(){const{object:e,updateField:s,isNew:i}=t.props,o=[],a=[];await s({id:e.id,field:"dogsLeft",value:a,isNew:i,datatype:"array"}),await s({id:e.id,field:"dogsRight",value:o,isNew:i,datatype:"array"}),t.setState({dogsLeft:a,dogsRight:o,dogPositionUpdated:!1})},this.changeFilter=e=>{const t=e.target.value;this.setState({filterby:t}),c.a.set("dogs-filter",t),this.loadDog()},this.getFilteredDogs=(e=this.props)=>{const{filterby:t,filterText:s}=this.state,{object:i,filter:o=(()=>!0)}=e,{dogStore:a}=this.props.stores,{dogs:d=[]}=a;let l=o;if(i.dogs)switch(t){case"all":l=s?e=>e.name.match(new RegExp(s,"i"))||i.dogs.indexOf(e.id)>-1:()=>!0;break;case"onlySelected":l=s?e=>e.name.match(new RegExp(s,"i"))||i.dogs.indexOf(e.id)>-1:e=>i.dogs.indexOf(e.id)>-1;break;case"onlyTeam":l=s?e=>e.name.match(new RegExp(s,"i"))||i.dogs.indexOf(e.id)>-1:e=>i.team===e.team||i.dogs.indexOf(e.id)>-1;break;case"leadOnly":l=e=>i.dogs.indexOf(e.id)>-1||c.a.getNestedValue(e,"positions.lead.distanceKm")>0;break;case"pointOnly":l=e=>i.dogs.indexOf(e.id)>-1||c.a.getNestedValue(e,"positions.point.distanceKm")>0;break;case"teamOnly":l=e=>i.dogs.indexOf(e.id)>-1||c.a.getNestedValue(e,"positions.team.distanceKm")>0;break;case"wheelOnly":l=e=>i.dogs.indexOf(e.id)>-1||c.a.getNestedValue(e,"positions.wheel.distanceKm")>0}let n=d.filter(l);this.setState({filteredDogs:n})},this.state=a({dogsLeft:[],dogsRight:[]},j)}async loadDog(e=this.props){const{showPositions:t}=this.props,{dogStore:s}=e.stores;await s.load({query:{deceased:0},addData:["team","user","workoutSummary","vaccineStatuses","historyStatuses","vaccineLogStatuses","allDogs"]}),t&&this.dndDogs({}),this.getFilteredDogs()}componentWillReceiveProps(e){e.filter!==this.props.filter&&this.getFilteredDogs(e)}componentDidMount(){this.loadDog()}render(){const{filterby:t,filterText:s,showSearchField:i,dogsLeft:o=[],dogsRight:a=[],dogPositionUpdated:d,filteredDogs:l=[]}=this.state,{userStore:r,dogStore:m}=this.props.stores,{dogs:f=[]}=m,{user:j}=r,{language:y="en"}=j,{saved:v={},object:w,field:x,title:P,icon:k,help:D,showPositions:R=!1,currentTeam:S={}}=this.props,L=Object(h.i)(w[x])||[],N=this.findAllDogsInTeams(),I=w.teams?w.teams.map(e=>r.findTeam(e)):[];return Object(n.h)("div",{class:"form-group  mb-5 pb-1 border-bottom "+(v[`${x}.${w.id}`]?"is-valid":"")},Object(n.h)("span",{class:"float-right",onClick:this.toggleSearchField},Object(n.h)("i",{class:"fas fa-search"})),Object(n.h)("button",{class:"btn btn-sm btn-link float-right mr-5",onClick:this.clearAllDogs},Object(n.h)("i",{class:"fas fa-eraser"})," ",Object(n.h)(p.c,{id:"dog.dogs.remove-all-dogs"},"Fjern alle hundene")),Object(n.h)("label",{for:x+"Input"},k&&Object(n.h)("i",{class:k+" text-muted"})," ",P),Object(n.h)("div",{class:"container-fluid px-0"},i&&Object(n.h)("div",{class:"row"},Object(n.h)("div",{class:"col-12"},Object(n.h)(p.b,null,Object(n.h)("input",{class:"form-control form-control-sm",type:"text",placeholder:Object(n.h)(p.c,{id:"dog.dogs.search-for-dogs"},"Søk etter hund"),value:s,onInput:Object(g.a)(this,"filterText")})))),Object(n.h)("div",{class:"row"},Object(n.h)("div",{class:"col-12"},Object(n.h)("div",{class:"form-row align-items-center"},Object(n.h)("div",{class:"col-auto my-2 mx-auto"},Object(n.h)("select",{class:"custom-select",style:"background-color: inherit; border: none; padding-top: 0; padding-bottom: 0; height: 1.4em; font-size: 0.8em;",onInput:this.changeFilter},Object(n.h)("option",{value:"",selected:!t},"-- ",Object(n.h)(p.c,{id:"dog.dogs.choose-filter"},"Choose filter")," ---"),Object(n.h)("option",{value:"all",selected:"all"===t},Object(n.h)(p.c,{id:"dog.dogs.show-all"},"Vis alle")),Object(n.h)("option",{value:"onlySelected",selected:"onlySelected"===t},Object(n.h)(p.c,{id:"dog.dogs.show-only-selected"},"Vis kun valgte")),Object(n.h)("option",{value:"onlyTeam",selected:"onlyTeam"===t},Object(n.h)(p.c,{id:"dog.dogs.show-only-team-dogs"},"Vis kun hundene i teamet")),Object(n.h)("option",{value:"leadOnly",selected:"leadOnly"===t},Object(n.h)(p.c,{id:"dog.dogs.show-lead-dogs-only"},"Vis kun lederhunder")),Object(n.h)("option",{value:"pointOnly",selected:"pointOnly"===t},Object(n.h)(p.c,{id:"dog.dogs.show-point-dogs-only"},"Vis kun pointhunder")),Object(n.h)("option",{value:"teamOnly",selected:"teamOnly"===t},Object(n.h)(p.c,{id:"dog.dogs.show-team-dogs-only"},"Vis kun teamhunder")),Object(n.h)("option",{value:"wheelOnly",selected:"wheelOnly"===t},Object(n.h)(p.c,{id:"dog.dogs.show-wheel-dogs-only"},"Vis kun wheelhunder"))))))),Object(n.h)("div",{class:"row"},N.length>0&&Object(n.h)(e,null,Object(n.h)("button",{class:"btn btn-primary btn-block",onClick:this.addAllDogsInTeam},Object(n.h)("i",{class:"fas fa-plus mr-2"})," ",Object(n.h)(p.c,{id:"dog.dogs.add-all-in-team",fields:{total:N.length}},"Add all dogs in team"),S.name?": "+S.name:"",I&&I.length>0&&Object(n.h)("span",{class:"font-weight-lighter"},", ",I.map((t,s)=>Object(n.h)(e,null,s>0?", ":"",t))))),c.a.isArray(f)&&l.map(e=>{const s=r.findDogstatus({status:e.status,language:y}),i=r.findDogposition({position:e.position,language:y}),o=m.findHistoryStatuses(e.id);return Object(n.h)("div",{class:"col-6 col-sm-6 col-md-6 col-lg-6 mb-1"},Object(n.h)("div",{class:`border rounded px-3 pt-2 pb-1 ${L.indexOf(e.id)>-1?"bg-success":""} position-relative`,onClick:this.toggleDog,id:"dogContainer","data-id":e.id,style:"padding: .3rem !important; line-height: 1.1em; cursor: pointer; pointer-events: inherit;"},i&&Object(n.h)("small",{class:"position-absolute",style:"left:5px; top: 32px;"},Object(n.h)("span",{class:`badge badge-${i.class||"primary"} mr-3`},i.icon&&Object(n.h)("i",{class:i.icon})," ",i.name)),"leadOnly"===t&&c.a.getNestedValue(e,"positions.lead.distanceKm")>0&&Object(n.h)("small",{class:"position-absolute",style:"left:5px; top: 32px;"},Object(n.h)("span",{class:"badge badge-secondary mr-3"},Object(n.h)(p.c,{id:"dogs.sort-lead"},"Lead"),": ",c.a.format(c.a.getNestedValue(e,"positions.lead.distanceKm"),0),"km")),"pointOnly"===t&&c.a.getNestedValue(e,"positions.point.distanceKm")>0&&Object(n.h)("small",{class:"position-absolute",style:"left:5px; top: 32px;"},Object(n.h)("span",{class:"badge badge-secondary mr-3"},Object(n.h)(p.c,{id:"dogs.sort-point"},"Point"),": ",c.a.format(c.a.getNestedValue(e,"positions.point.distanceKm"),0),"km")),"teamOnly"===t&&c.a.getNestedValue(e,"positions.team.distanceKm")>0&&Object(n.h)("small",{class:"position-absolute",style:"left:5px; top: 32px;"},Object(n.h)("span",{class:"badge badge-secondary mr-3"},Object(n.h)(p.c,{id:"dogs.sort-team"},"Team"),": ",c.a.format(c.a.getNestedValue(e,"positions.team.distanceKm"),0),"km")),"wheelOnly"===t&&c.a.getNestedValue(e,"positions.wheel.distanceKm")>0&&Object(n.h)("small",{class:"position-absolute",style:"left:5px; top: 32px;"},Object(n.h)("span",{class:"badge badge-secondary mr-3"},Object(n.h)(p.c,{id:"dogs.sort-wheel"},"Wheel"),": ",c.a.format(c.a.getNestedValue(e,"positions.wheel.distanceKm"),0),"km")),Object(n.h)("div",{class:"d-flex"},Object(n.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall text-muted pt-2",style:""+(e.image?`background-image: url("${e.image.s3ThumbLink}");`:"")},!e.image&&Object(n.h)("span",{class:"font-weight-lighter",style:"font-size: 20px;"},c.a.ucfirst(e.name,!0))),Object(n.h)("div",{class:"flex-grow-1 pl-2 pr-1",style:`border-right: 4px solid ${r.findHarness(e.harness,"colorNonstop")} !important; line-height: 0.9em;`},Object(n.h)("small",null,Object(n.h)("small",{class:"float-right"},e.birth&&Object(n.h)("span",{class:"mr-1"},c.a.age(e.birth,e.deceased)),"female"===e.gender?Object(n.h)("i",{class:"fas fa-venus"}):Object(n.h)("i",{class:"fas fa-mars"})),e.shortname||e.name,Object(n.h)("br",null),Object(n.h)("div",{style:"line-height: 0.8em;"},Object(n.h)("small",null,r.findTeam(e.team)))),Object(n.h)("small",{class:"float-right"},s&&s.id&&Object(n.h)("span",{class:`badge badge-${s.class} mr-2 font-weight-light`},s.icon&&Object(n.h)("i",{class:s.icon})," ",s.name),e.specialNeeds&&Object(n.h)("span",{class:"badge badge-warning mr-2 font-weight-light"},Object(n.h)("i",{class:"fas fa-exclamation-triangle"})," ",e.specialNeeds),o&&o.map(e=>Object(n.h)("span",{class:"badge badge-warning mr-2",title:c.a.isoDate(e.endDate,!1,!1,!0)},e.title)))))))}))),v[`${x}.${w.id}`]?Object(n.h)("div",{class:"valid-feedback",style:"display: block;"},Object(n.h)(p.c,{id:"dog.dogs.saved-changes"},"Endringene er lagret")):Object(n.h)("small",{id:x+"Help",class:"form-text text-muted"},D),R&&Object(n.h)(e,null,Object(n.h)("div",{class:"container-fluid px-0 clearfix"},Object(n.h)("div",{class:"row"},Object(n.h)("div",{class:"col-12"},Object(n.h)("h5",null,Object(n.h)(p.c,{id:"dog.dogs.dogs-positions"},"Posisjoner i spannet")))),Object(n.h)(b.a,{onDragEnd:this.onDragEnd},Object(n.h)("div",{class:"row"},Object(n.h)("div",{class:"col-6 pr-0",style:"min-height: 100px;"},Object(n.h)(b.c,{droppableId:"dogsLeft"},(e,t)=>Object(n.h)(u,{provided:e,snapshot:t,innerRef:e.innerRef,className:"ml-auto"},o&&o.map((e,s)=>Object(n.h)(b.b,{key:`${e.id}-${e.unique}`,draggableId:`dragId-${e.id}-${e.unique}`,index:s},i=>Object(n.h)(O,{provided:i,snapshot:t,innerRef:i.innerRef,dog:e,removePlaceholder:this.removePlaceholder,idx:s,list:"dogsLeft"}))),e.placeholder))),Object(n.h)("div",{class:"col-6 pl-0",style:"min-height: 100px;"},Object(n.h)(b.c,{droppableId:"dogsRight"},(e,t)=>Object(n.h)(u,{provided:e,snapshot:t,innerRef:e.innerRef,className:"mr-auto"},a&&a.map((e,s)=>Object(n.h)(b.b,{key:`${e.id}-${e.unique}`,draggableId:`dragId-${e.id}-${e.unique}`,index:s},i=>Object(n.h)(O,{provided:i,snapshot:t,innerRef:i.innerRef,dog:e,removePlaceholder:this.removePlaceholder,idx:s,list:"dogsRight"}))),e.placeholder))))),Object(n.h)("div",{class:"row mb-3 mt-2"},Object(n.h)("div",{class:"col-6 pr-0"},Object(n.h)("button",{class:"btn btn-sm btn-outline-secondary",onClick:this.addPlaceholderLeft},Object(n.h)("i",{class:"fas fa-plus-circle"})," ",Object(n.h)(p.c,{id:"dog.dogs.addplaceholder"},"Add placeholder"))),Object(n.h)("div",{class:"col-6 pl-0"},Object(n.h)("button",{class:"float-right btn btn-sm btn-outline-secondary",onClick:this.addPlaceholderRight},Object(n.h)("i",{class:"fas fa-plus-circle"})," ",Object(n.h)(p.c,{id:"dog.dogs.addplaceholder"},"Add placeholder"))))),Object(n.h)("div",{class:"container-fluid px-0"},Object(n.h)("div",{class:"row"},Object(n.h)("div",{class:"col-6"},Object(n.h)("button",{class:"btn btn-sm btn-"+(d?"primary":"secondary"),onClick:this.updateDogPositions},Object(n.h)("i",{class:"fas fa-save"})," ",Object(n.h)(p.c,{id:"dog.dogs.saveDogPositions"},"Save dog positions"))),Object(n.h)("div",{class:"col-6"},Object(n.h)("button",{class:"float-right btn btn-sm btn-warning",onClick:this.resetDogPositions},Object(n.h)("i",{class:"fas fa-sync"})," ",Object(n.h)(p.c,{id:"dog.dogs.resetDogPositions"},"Reset dog positions")))),Object(n.h)("div",{class:"row mt-2"},Object(n.h)("div",{class:"col-6"}," "),Object(n.h)("div",{class:"col-6"},Object(n.h)("button",{class:"float-right btn btn-sm btn-link",onClick:this.clearDogPositions},Object(n.h)("i",{class:"fas fa-eraser"})," ",Object(n.h)(p.c,{id:"dog.dogs.clearDogPositions"},"Clear dog positions")))))))}})||l;t.a=y}).call(this,s("hosL").Fragment)}}]);
//# sourceMappingURL=3.chunk.fe9f7.esm.js.map