{"version":3,"sources":["webpack:///./routes/public/race/listMusher.js","webpack:///./routes/public/race/raceheader.js","webpack:///./components/public/heatmap.js","webpack:///./components/data/distance.js","webpack:///./routes/public/race/submenu.js","webpack:///./routes/public/race/style.css","webpack:///./components/data/temperature.js","webpack:///./routes/public/race/header.js","webpack:///./components/data/weight.js","webpack:///./routes/public/race/tracking.js","webpack:///./routes/public/race/raceText.js","webpack:///./components/data/elevation.js","webpack:///./components/data/speed.js","webpack:///./routes/public/race/displayMusher.js"],"names":["initialState","ListMusher","observer","Component","constructor","props","super","toggleFocusOnMusher","e","musherId","target","parentElement","dataset","musherid","appState","raceStore","this","stores","parseInt","focusOnMushers","getWorkoutSummaryActiveTeams","toggleInfoOnMusher","state","render","team","idx","language","infoOnMushers","line","getActiveTeamById","id","currentStages","getWorkoutSummaryByTeam","currentClass","getClassByTeamId","currentResults","getWorkoutResultsByTeam","distance","musher","getMusherByTeamId","image","images","length","raceClass","completed","distanceKm","hasStarted","currentSpeed","updated","isActive","currentLocation","coords","speed","timestamp","toFinish","class","style","s3SmallLink","onClick","data-musherid","util","ucfirst","String","firstname","lastname","name","title","format","secToHms","rest","isInProgress","dogs","formatDistance","Date","indexOf","battery","level","RaceHeader","race","today","status","startDate","endDate","signupStartDate","signupEndDate","classes","useEffect","document","PageTitle","formatDate","locale","hour12","hour","minute","liveRace","role","showAddComment","Heatmap","updateTimer","inputRef","setState","isLoading","adminStore","raceid","getPublicHeatmap","componentDidMount","loadHeatmap","waypoints","zoomToMarkers","mapid","fullscreenMap","publicHeatmap","heatmap","mapId","minZoom","maxZoom","height","key","displayDistance","Distance","value","smallUnit","userStore","user","settings","imperial","kmToMiles","mu","marginTop","marginBottom","subMenuMarginTop","email","submenu","jwtToken","getJwtToken","PublicRaceDetail","path","darkmode","currentMenu","match","href","module","exports","Temperature","celciusToFahrenheit","menu","profile","main","searchText","Navigation","toggleDropdown","menuName","parentNode","toggleDarkmode","toggleViewmode","mode","reloadApp","window","location","reload","adminLoadAll","async","getInfo","changeLanguage","lang","console","log","setLanguage","search","route","notifications","filter","read","src","type","data-name","className","activeClassName","onInput","selected","Weight","kgToPounds","MARGIN_TOP","MARKDOWN_OPTIONS","pedantic","gfm","breaks","sanitize","smartLists","smartypants","xhtml","reloadInSec","reloadIsActive","leaderboardMode","filterByraceClass","showLeaderBoard","showNews","ReloadTimer","initComponent","tickReloadTimeer","reloadLastEpoch","now","Math","floor","getTime","clearTimeout","tick","setTimeout","componentWillUnmount","radius","fontSize","classNames","reloadPercent","normalizeBetween","color","showPercentText","percent","showCenterText","centerText","centerTextSize","centerTextY","loadLiveRaceResults","getRaceTrackerData","raceTrackerRace","getRaceTrackerActiveTeams","loadRaceResults","teamIds","loadWorkoutSummary","setLeaderboardMode","chooseRaceClass","toggleShowLeaderBoard","hide","toggleShowNews","load","allTeamIds","contestants","map","flat","teamid","loadTeams","join","getAllClassesSortedBy","loadRace","RELOAD_INTERVAL_IN_SEC","width","innerWidth","innerHeight","getWindowDimensions","componentWillReceiveProps","nextProps","teamsInThisRace","activeTeams","teamList","linkBase","articles","reverse","article","date","replaceImages","s3LargeLink","ingress","markdown","markdownOpts","body","aria-describedby","sort","a","b","totalMushers","data-mode","contestant","currentTeam","teamId","getTeamById","text","finalText","regex","RegExp","replace","Elevation","meterToFeet","Speed","kmtToMph","DisplayMusher","avgDogs","speedAvg","weightedNormalizedDuration","duration","elevation","altitude","loadIndex","viewBox","d","svgElevation","svgMap","stage","currentEpoch","inDate","setUTCSeconds"],"mappings":"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","file":"67.chunk.be753.esm.js","sourcesContent":["import { h, Component } from 'preact';\nimport { useEffect } from \"preact/hooks\";\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nconst initialState = {\n};\n\n@observer\nclass ListMusher extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\ttoggleFocusOnMusher = (e) => {\n\t\tconst musherId = e.target.parentElement.dataset.musherid || e.target.dataset.musherid;\n\t\tconst { appState, raceStore } = this.props.stores;\n\t\tappState.toggleFocusOnMusher(parseInt(musherId, 10));\n\n\t\tconst { focusOnMushers } = appState;\n\t\traceStore.getWorkoutSummaryActiveTeams(focusOnMushers);\n\t}\n\n\ttoggleInfoOnMusher = (e) => {\n\t\tconst musherId = e.target.parentElement.dataset.musherid || e.target.dataset.musherid;\n\t\tconst { appState } = this.props.stores;\n\t\tappState.toggleInfoOnMusher(parseInt(musherId, 10));\n\t}\n\n    render() {\n\t\tconst { raceStore, appState } = this.props.stores;\n\t\tconst { team = {}, idx } = this.props;\n\t\tconst { darkmode, language = 'en', focusOnMushers = [], infoOnMushers = [] } = appState;\n\t\tconst { race } = raceStore;\n\n        const line = raceStore.getActiveTeamById(team.id);\n        const currentStages = raceStore.getWorkoutSummaryByTeam(team.id);\n        const currentClass = raceStore.getClassByTeamId(team.id);\n        const currentResults = raceStore.getWorkoutResultsByTeam(currentStages, currentClass.distance);\n        const musher = raceStore.getMusherByTeamId(team.id);\n        const image = team.images && team.images.length > 0 ? team.images[0] : {};\n        const raceClass = raceStore.getClassByTeamId(team.id);\n\n        const completed = currentResults.distanceKm / currentClass.distance * 100;\n        const hasStarted = completed > 0 ? 1 : 0;\n        const isDone = completed >= 100 ? 1 : 0;\n\n        let currentSpeed;\n        let updated;\n        let isActive;\n        if (line && line.currentLocation && line.currentLocation.coords) {\n            currentSpeed = line.currentLocation.coords.speed * 3.6;\n            updated = line.currentLocation.timestamp;\n            isActive = true;\n        }\n        let toFinish = raceClass.distance - currentResults.distanceKm;\n        if (toFinish < 0) {\n            toFinish = 0;\n        }\n\n        // const currentSpeed = util.format(line.currentLocation.coords.speed * 3.6, 1);\n        // avgDogs: 9.777777777777779\n        // distanceKm: 268.3432364824406\n        // duration: 67524.34002106966\n        // elevation: 5287.123805500813\n        // flatTotalKcal: 4971.658025959346\n        // images: Array(32) [ Proxy, Proxy, Proxy, … ]\n        // loadIndex: 1446\n        // rest: 2306\n        // speedAvg: 14.820718823260847\n        // totalKcalRelated: 1225.314525471911\n        // weightedTotalKcal: 11344.398317216459\n\n        return (<>\n            <div class='row border-top mt-2' style='font-size: 0.7em;'>\n                <div class='col-2 p-0 text-center'>\n                    <h2>{idx + 1}</h2>\n                </div>\n                <div class='col-2 p-0 text-center'>\n                    <div\n                        class={`text-center text-muted pt-2 h-100`}\n                        style={`background-image: url(\"${image.s3SmallLink}\"); background-size: cover;`}\n                        onClick={this.toggleInfoOnMusher} data-musherid={team.id}\n                    >\n                        {!image.s3SmallLink && <>\n                            <span class='font-weight-lighter' style='font-size: 35px;'>\n                                {util.ucfirst(String(musher.firstname), true)}\n                                {util.ucfirst(String(musher.lastname), true)}\n                            </span>\n                        </>}\n                    </div>\n                </div>\n                <div class='col-8'>\n                    <div class='row'>\n                        <div class='col-6 px-1'>\n                            <span class='font-weight-bold'>{musher.firstname} {musher.lastname}</span><br />\n                            <span class='font-weight-lighter'>{team.name}</span><br />\n                            {raceClass && raceClass.title && <>\n                                <span class='font-weight-lighter'>{raceClass.title}</span>\n                            </>}\n                        </div>\n                        <div class='col-3 p-0 text-center'>\n                            <span class='font-weight-lighter'>km</span><br />\n                            <span style='font-size: 2.0em;'>{util.format(currentResults.distanceKm, 0)}</span>\n                        </div>\n                        <div class='col-3 p-0 text-center'>\n                            <span class='font-weight-lighter'>to finish</span><br />\n                            <span style='font-size: 2.0em;'>\n                                {toFinish === 0 ? <i class='fas fa-flag-checkered text-success' /> : <>{util.format(toFinish, 0)}</>}\n                            </span>\n                        </div>\n                    </div>\n                    <div class='row border-top'>\n                        <div class='col-3 p-0 text-center'>\n                            <span class='font-weight-lighter'>Rest</span><br />\n                            {util.secToHms(currentResults.rest)}\n                        </div>\n                        <div class='col-3 p-0 text-center'>\n                            <span class='font-weight-lighter'>Speed</span><br />\n                            {currentSpeed ? <>{util.format(currentSpeed, 1)} km/t</> : '-'}\n                        </div>\n                        <div class='col-3 p-0 text-center'>\n                            <span class='font-weight-lighter'>Status</span><br />\n                            {line.isInProgress === 1 ? <span class='text-primary'>running</span> : ''}\n                            {line.isInProgress === 2 ? <span class='text-danger'>resting</span> : ''}\n                            {toFinish === 0 ? <>\n                                {!line.isInProgress ? <span class='text-success'>FINISH</span> : ''}\n                            </> : <>\n                                {!line.isInProgress ? <>\n                                    {hasStarted ? <span class='text-danger'>resting</span> : <span class='text-muted'>NYS</span>}\n                                </> : ''}\n                            </>}\n                            \n                        </div>\n                        <div class='col-3 p-0 text-center align-bottom'>\n                            <h5>\n                                {team.dogs && team.dogs ? util.format(team.dogs.length, 0) : '-'} <i class='fas fa-dog text-muted ml-2' />\n                            </h5>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class='row bg-secondary text-white' style='font-size: 0.8em;'>\n                <div class='col-6 text-left' style='font-size: 0.8em;'>\n                    {isActive && <>\n                        Updated: {util.formatDistance(updated, new Date())} ago\n                    </>}\n                </div>\n                <div class='col-6 text-right'>\n                    <span class='float-right' onClick={this.toggleFocusOnMusher} data-musherid={team.id}>{focusOnMushers.indexOf(team.id) > -1 ? <i class='fas fa-star text-warning' /> : <i class='far fa-star' />}</span>\n                    <span class='float-right mr-2' onClick={this.toggleInfoOnMusher} data-musherid={team.id}>{infoOnMushers.indexOf(team.id) > -1 ? <i class='fas fa-info-circle text-warning' /> : <i class='fas fa-info-circle' />}</span>\n\n                    {isActive && line.currentLocation.battery.level > 0 && <>\n                        <span class='float-right mr-2'>\n                            <i class='fas fa-battery-three-quarters text-muted ml-2 mr-1' />\n                            {util.format(line.currentLocation.battery.level * 100, 0)}%\n                        </span>\n                    </>}\n\n                </div>\n            </div>\n        </>);\n    }\n}\n\nexport default ListMusher;\n","import { h, Component } from 'preact';\nimport { useEffect } from \"preact/hooks\";\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nfunction PageTitle(title, classes = '') {\n\tuseEffect(() => {\n\t\tdocument.title = `Homerun Race: ${title}`;\n\t}, [title]);\n\treturn <h1 class={classes}>{title}</h1>;\n}\n\nconst initialState = {\n};\n\n@observer\nclass RaceHeader extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n    render() {\n\t\tconst { raceStore, appState } = this.props.stores;\n\t\tconst { title } = this.props;\n\t\tconst { darkmode, language = 'en' } = appState;\n\t\tconst { race } = raceStore;\n\n\t\tconst today = new Date();\n\t\tlet status = '';\n\t\tif (today >= new Date(race.startDate) && today <= new Date(race.endDate)) {\n\t\t\tstatus = 'race';\n\t\t} else if (today >= new Date(race.signupStartDate) && today <= new Date(race.signupEndDate)) {\n\t\t\tstatus = 'signup';\n\t\t} else if (today > new Date(race.endDate)) {\n\t\t\tstatus = 'done';\n\t\t}\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div class='d-flex'>\n\t\t\t\t\t<div class='flex-fill'>\n\t\t\t\t\t\t{PageTitle(title, 'mb-0')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='flex-fill text-center d-none d-md-block'>\n\t\t\t\t\t\t<h1 class='mb-0' style='line-height: 0.8em;'><span class='font-weight-lighter' style='letter-spacing: -1px;'>{race.title}</span></h1>\n\t\t\t\t\t\t<small class=''>\n\t\t\t\t\t\t\t{race.startDate && <>{util.formatDate(race.startDate, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</>}\n\t\t\t\t\t\t\t{race.endDate && <> - {util.formatDate(race.endDate, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</>}\n\t\t\t\t\t\t</small>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='flex-fill'>\n\t\t\t\t\t\t<h3 class='float-right'>\n\t\t\t\t\t\t\t{status === 'signup' && !race.liveRace && <>\n\t\t\t\t\t\t\t\t<div class='spinner-grow text-primary' role='status' />\n\t\t\t\t\t\t\t\t<span class='badge badge-primary ml-2'><Text id='races.signup-open'>Påmelding åpen</Text></span>\n\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t\t{status === 'race' && <>\n\t\t\t\t\t\t\t\t<div class='spinner-grow text-danger' role='status' />\n\t\t\t\t\t\t\t\t<span class='badge badge-danger ml-2'><Text id='races.race-in-progress'>Løp pågår</Text></span>\n\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t\t{status === 'done' && <>\n\t\t\t\t\t\t\t\t<i class='fas fa-check text-success' />\n\t\t\t\t\t\t\t\t<span class='badge badge-success ml-2'><Text id='races.race-finished'>Løp avsluttet</Text></span>\n\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t</h3>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class='d-block d-md-none'>\n\t\t\t\t\t<h4 class='mb-0' style='line-height: 0.8em;'><span class='font-weight-light' style='letter-spacing: -1px;'>{race.title}</span></h4>\n\t\t\t\t\t<small>\n\t\t\t\t\t\t{race.startDate && <>{util.formatDate(race.startDate, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</>}\n\t\t\t\t\t\t{race.endDate && <> - {util.formatDate(race.endDate, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</>}\n\t\t\t\t\t</small>\t\t\t\t\n\t\t\t\t</div>\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default RaceHeader;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport { toJS } from 'mobx'\n\nimport Map from '../../components/map';\n\nimport mu from '../../lib/musher-util';\n\nconst initialState = {\n\tshowAddComment: false,\n};\n\n@observer\nclass Heatmap extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n        this.updateTimer = {};\n\t\tthis.inputRef = {};\n    }\n\n\tasync loadHeatmap() {\n\t\tthis.setState({ isLoading: true });\n\t\tconst { adminStore } = this.props.stores;\n        const { raceid } = this.props;\n        await adminStore.getPublicHeatmap(raceid);\n\t\tthis.setState({ isLoading: false });\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.loadHeatmap();\n\t}\n\n    // componentWillReceiveProps() {\n\t// \tthis.loadHeatmap();\n\t// }\n\n    render() {\n        const { adminStore } = this.props.stores;\n        const { waypoints, zoomToMarkers, mapid, fullscreenMap } = this.props;\n        const { publicHeatmap: heatmap } = adminStore;\n        // const heatmap = publicHeatmap.slice(0, 10);\n        // const heatmap = [[60.4433,8.8996,14],[61.384,9.1152,14],[60.42,8.9422,15]];\n\n        return (\n            <>\n                {/* heatmap: {`map-${mapid}`}<br /> */}\n                {/* {JSON.stringify(heatmap)} */}\n                <Map\n                    stores={this.props.stores}\n                    mapId={heatmap.length}\n                    heatmap={heatmap}\n                    minZoom={2}\n                    maxZoom={18}\n                    height={600}\n                    waypoints={waypoints}\n                    zoomToMarkers={zoomToMarkers}\n                    fullscreenMap={fullscreenMap}\n                    key={`map-${mapid}`}\n                />\n            </>\n        );\n    }\n}\n\nexport default Heatmap;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nfunction displayDistance(distance) {\n\tif (distance < 5) {\n\t\treturn util.format(distance, 2);\n\t}\n\tif (distance < 10) {\n\t\treturn util.format(distance, 1);\n\t}\n\treturn util.format(distance, 1);\n}\n\nfunction kmToMiles(value) {\n    return 0.621371 * value;\n}\n\n@observer\nclass Distance extends Component {\n    render() {\n\t\tconst { value = 0, smallUnit } = this.props;\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { settings = {} } = user;\n\n        if (settings.imperial) {\n            return (<>\n                <nobr>\n\t\t\t\t\t{displayDistance(kmToMiles(value))} {smallUnit ? <><small><small><small class='ml-0 text-muted'>mi</small></small></small></> : <>mi</>}\n\t\t\t\t</nobr>\n            </>);\n        }\n\n\t\treturn (<>\n\t\t\t<nobr>\n\t            {displayDistance(value)} {smallUnit ? <><small><small><small class='ml-0 text-muted'>km</small></small></small></> : <>km</>}\n\t\t\t</nobr>\n\t    </>);\n    }\n}\n\nexport default Distance;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport linkstate from 'linkstate';\n\nimport Header from './header';\nimport Heatmap from '../../../components/public/heatmap';\n\nimport mu from '../../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(true);\nconst MARGIN_BOTTOM = mu.marginBottom();\nconst SUB_MENU_MARGIN_TOP = mu.subMenuMarginTop();\n\nconst initialState = {\n\tisLoading: false,\n\temail: '',\n\tsubmenu: 'ads',\n\tjwtToken: util.getJwtToken(),\n};\n\n@observer\nclass PublicRaceDetail extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\trender() {\n\t\tconst { appState } = this.props.stores;\n\t\tconst { raceid, path } = this.props;\n\t\tconst { darkmode } = appState;\n\n        let currentMenu = 'default';\n        if (path.match(/\\/race\\/:raceid$/)) {\n            currentMenu = 'default';\n        } else if (path.match(/\\/race\\/:raceid\\/mushers$/)) {\n            currentMenu = 'mushers';\n        } else if (path.match(/\\/race\\/:raceid\\/results$/)) {\n            currentMenu = 'results';\n        } else if (path.match(/\\/race\\/:raceid\\/media$/)) {\n            currentMenu = 'media';\n        } else if (path.match(/\\/race\\/:raceid\\/tracking$/)) {\n            currentMenu = 'tracking';\n        }\n\n\t\treturn (\n\t\t\t<>\t\t\t\t\n                <div class='row fixed-top pr-3' style={`margin-top: 40px; background-color: ${darkmode ? '#191d21' : '#f8f9fa'};`}>\n\n                    <div class='col-12 my-2 mx-2'>\n                        <ul class='nav nav-pills nav-fill flex-nowrap'>\n                            <li class='nav-item' style='max-width: 20%;'>\n                                <a href={`/race/${raceid}`} class={`text-overflow nav-link ${currentMenu === 'default' ? 'active' : ''}`}>\n                                    <nobr><i class='fas fa-info-circle' /> <Text id='race.therace'>Løpet</Text></nobr>\n                                </a>\n                            </li>\n                            <li class='nav-item' style='max-width: 20%;'>\n                                <a href={`/race/${raceid}/mushers`} class={`text-overflow nav-link ${currentMenu === 'mushers' ? 'active' : ''}`}>\n                                    <nobr><i class='fas fa-users' /> <Text id='race.mushers'>Deltakere</Text></nobr>\n                                </a>\n                            </li>\n                            <li class='nav-item' style='max-width: 20%;'>\n                                <a href={`/race/${raceid}/results`} class={`text-overflow nav-link ${currentMenu === 'results' ? 'active' : ''}`}>\n                                    <nobr><i class='fas fa-poll' /> <Text id='race.results'>Resultater</Text></nobr>\n                                </a>\n                            </li>\n                            <li class='nav-item' style='max-width: 20%;'>\n                                <a href={`/race/${raceid}/media`} class={`text-overflow nav-link ${currentMenu === 'media' ? 'active' : ''}`}>\n                                    <nobr><i class='fas fa-images' /> <Text id='race.media'>Bilder</Text></nobr>\n                                </a>\n                            </li>\n                            <li class='nav-item' style='max-width: 20%;'>\n                                <a href={`/race/${raceid}/tracking`} class={`text-overflow nav-link ${currentMenu === 'tracking' ? 'active' : ''}`}>\n                                    <nobr><i class='fas fa-map-marked-alt' /> <Text id='race.tracking'>Tracking</Text></nobr>\n                                </a>\n                            </li>\n                        </ul>\n                    </div>\n\n\n                    {/* <div class={`col text-center subtopmenu ${path.match(/\\/race\\/:raceid$/) ? 'border-bottom border-primary' : ''}`}>\n                        <a href={`/race/${raceid}`} class={`text-${path.match(/\\/race\\/:raceid$/) ? 'primary' : 'secondary'} stretched-link`}>\n                            <nobr><i class='fas fa-chart-line' /> <Text id='race.therace'>Løpet</Text></nobr>\n                        </a>\n                    </div>\n                    <div class={`col text-center subtopmenu ${path.match(/\\/race\\/:raceid\\/mushers$/) ? 'border-bottom border-primary' : ''}`}>\n                        <a href={`/race/${raceid}/mushers`} class={`text-${path.match(/\\/race\\/:raceid\\/mushers$/) ? 'primary' : 'secondary'} stretched-link`}>\n                            <nobr><i class='fas fa-chart-line' /> <Text id='race.mushers'>Deltakere</Text></nobr>\n                        </a>\n                    </div>\n                    <div class={`col text-center subtopmenu ${path.match(/\\/race\\/:raceid\\/results$/) ? 'border-bottom border-primary' : ''}`}>\n                        <a href={`/race/${raceid}/results`} class={`text-${path.match(/\\/race\\/:raceid\\/results$/) ? 'primary' : 'secondary'} stretched-link`}>\n                            <nobr><i class='fas fa-chart-line' /> <Text id='race.results'>Resultater</Text></nobr>\n                        </a>\n                    </div>\n                    <div class={`col text-center subtopmenu ${path.match(/\\/race\\/:raceid\\/tracking$/) ? 'border-bottom border-primary' : ''}`}>\n                        <a href={`/race/${raceid}/tracking`} class={`text-${path.match(/\\/race\\/:raceid\\/tracking$/) ? 'primary' : 'secondary'} stretched-link`}>\n                            <nobr><i class='fas fa-chart-line' /> <Text id='race.tracking'>Tracking</Text></nobr>\n                        </a>\n                    </div> */}\n                </div>\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default PublicRaceDetail;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"pointerCursor\":\"pointerCursor__1W6mM\"};","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nfunction celciusToFahrenheit(value) {\n    return ((value * 9/5) + 32);\n}\n\n@observer\nclass Temperature extends Component {\n    render() {\n\t\tconst { value = 0, smallUnit } = this.props;\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { settings = {} } = user;\n\n        if (settings.imperial) {\n            return (<>\n                <nobr>\n                    {util.format(celciusToFahrenheit(value), 0)}°F\n                </nobr>\n            </>);\n        }\n\n\t\treturn (<>\n            <nobr>\n                {util.format(value, 1)}°C\n            </nobr>\n        </>);\n    }\n}\n\nexport default Temperature;\n","import { h, Component } from 'preact';\nimport { Link } from 'preact-router/match';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport linkState from 'linkstate';\nimport { route } from 'preact-router';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport style from './style.css';\n\n\nconst initialState = {\n    menu: {\n\t\tprofile: false,\n\t\tmain: false,\n\t},\n\tsearchText: '',\n};\n\n@observer\nclass Navigation extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\ttoggleDropdown = (e) => {\n\t\tconst { menu } = this.state;\n\t\tlet menuName = e.target.dataset.name;\n\t\tif (!menuName && e.target.parentNode) {\n\t\t\tmenuName = e.target.parentNode.dataset.name;\n\t\t}\n\t\tif (menuName) {\n\t\t\tmenu[menuName] = !menu[menuName];\n\t\t}\n\t\tthis.setState({ menu });\n\t}\n\n\ttoggleDarkmode = (e) => {\n        const { appState } = this.props.stores;\n\t\tappState.toggleDarkmode();\n\t\tthis.toggleDropdown(e);\n\t}\n\n\ttoggleViewmode = (e) => {\n        const { appState } = this.props.stores;\n\t\tlet mode = e.target.dataset.mode;\n\t\tif (!mode && e.target.parentNode) {\n\t\t\tmode = e.target.parentNode.dataset.mode;\n\t\t}\n\t\tappState.toggleViewmode(mode);\n\t\tthis.toggleDropdown(e);\n\t}\n\n\treloadApp = () => {\n\t\twindow.location.reload(true);\n\t}\n\n\tadminLoadAll = async (e) => {\n        const { userStore } = this.props.stores;\n        await userStore.getInfo(true);\n\t}\n\n\tchangeLanguage = (e) => {\n\t\tconst lang = e.target.value;\n\t\tconsole.log('changeLanguage', lang);\n\t\tconst { appState, userStore } = this.props.stores;\n\t\tconst { user = {} } = userStore;\n\t\tif (user.email) {\n\t\t\tuserStore.setLanguage({ email: user.email, language: lang });\n\t\t}\n\t\tappState.setLanguage(lang);\n\t}\n\n\tsearch = () => {\n\t\tconst { searchText } = this.state;\n\t\troute(`/search/${searchText}`);\n\t}\n\n    render() {\n\t\tconst { menu, searchText } = this.state;\n        const { appState, userStore } = this.props.stores;\n        const { darkmode, viewmode, isCordova } = appState;\n\t\tconst { allUsers, isAdmin, user, notifications = [] } = userStore;\n\t\tconst unreadNotificatins = notifications.filter(e => !e.read);\n\t\tconst unread = unreadNotificatins.length || 0;\n\t\tconst { language = 'en' } = user;\n\n\t\treturn (\n\t\t\t<nav class='navbar navbar-expand-lg navbar-themed fixed-top py-1' style='z-index: 99999;'>\n\t\t\t\t<a class='navbar-brand' href='/race/'>\n\t\t\t\t\t{/* <img src={`./assets/logo-jul-2020-v2-${darkmode ? 'black' : 'white'}.png`} height='30' class='position-absolute' style='top: 8px; left: 6px' /> */}\n\t\t\t\t\t<img src={`./assets/homerun-race-logo-2-${darkmode ? 'white-' : ''}small.png`} height='37' class='position-absolute' style='top: 5px; left: 6px' />\n\t\t\t\t\t<span class='font-weight-normal' style='margin-left: 30px; font-size: 20px;'>Homerun Race</span>\n\t\t\t\t</a>\n\n\t\t\t\t<button class='navbar-toggler' type='button'\n\t\t\t\t\tdata-name='main'\n\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t>\n\t\t\t\t\t<span class='navbar-toggler-icon' />\n\t\t\t\t</button>\n\n\t\t\t\t<div class={`collapse navbar-collapse ${menu.main ? 'show' : ''}`} id='navbarSupportedContent'>\n\t\t\t\t\t<ul class='navbar-nav mr-auto ml-5'>\n\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/race'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tstyle='font-size: 1.0em !important;'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='fas fa-flag-checkered' /> <Text id='header.races'>Løpene</Text></Link>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/race/support'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tstyle='font-size: 1.0em !important;'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='far fa-question-circle' /> <Text id='header.support'>Support</Text></Link>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/race/news'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tstyle='font-size: 1.0em !important;'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='fas fa-quote-right' /> <Text id='header.news'>Nyheter</Text></Link>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t{/* <li class='nav-item'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='fas fa-dog' /> <Text id='header.backtoapp'>The Musher</Text></Link>\n\t\t\t\t\t\t</li> */}\n\t\t\t\t\t\t{/* <li class='nav-item'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/news'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='fas fa-quote-right' /> <Text id='header.news'>Nyheter</Text></Link>\n\t\t\t\t\t\t</li> */}\n\t\t\t\t\t\t{/* <li class='nav-item d-block d-lg-none'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/howto'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='fas fa-quote-right' /> <Text id='header.howto'>Hvordan gjør man det?</Text></Link>\n\t\t\t\t\t\t</li> */}\n\t\t\t\t\t</ul>\n\n\t\t\t\t\t<ul class='navbar-nav ml-auto '>\n\t\t\t\t\t\t{/* <li class='nav-item mr-2'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'}\n\t\t\t\t\t\t\t\thref='/users/notifications'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<i class='fas fa-bell mr-1' />\n\t\t\t\t\t\t\t\t{unread > 0 && <>\n\t\t\t\t\t\t\t\t\t<span class='badge badge-pill badge-danger'>{unread > 9 ? '9+' : unread}</span>\n\t\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</li> */}\n\t\t\t\t\t\t<li class='nav-item mr-2'>\n\t\t\t\t\t\t\t<div class='form-row align-items-center'>\n\t\t\t\t\t\t\t\t<div class='col-auto my-1' style='width: 80px;'>\n\t\t\t\t\t\t\t\t\t<select class='custom-select'\n\t\t\t\t\t\t\t\t\t\tstyle='background-color: inherit; border: none; padding: 0; height: 1.1em; font-size: 0.9em;'\n\t\t\t\t\t\t\t\t\t\tonInput={this.changeLanguage}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<option value='no' selected={language === 'no'}>🇳🇴 NO</option>\n\t\t\t\t\t\t\t\t\t\t<option value='en' selected={language === 'en'}>🇬🇧 EN</option>\n\t\t\t\t\t\t\t\t\t\t<option value='es' selected={language === 'es'}>🇪🇸 ES</option>\n\t\t\t\t\t\t\t\t\t\t<option value='de' selected={language === 'de'}>🇩🇪 DE</option>\n\t                                    <option value='fr' selected={language === 'fr'}>🇫🇷 FR</option>\n\t                                    <option value='ru' selected={language === 'ru'}>🇷🇺 RU</option>\n\t                                    <option value='se' selected={language === 'se'}>🇸🇪 SE</option>\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class='nav-item d-block d-lg-none'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'}\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tonClick={this.toggleDarkmode}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<i class={`${darkmode ? 'fas text-warning' : 'far'} fa-moon`} /> <Text id='header.darkmode'>Nattmodus</Text>\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class='nav-item mr-2 d-none d-lg-block'>\n\t\t\t\t\t\t\t<button class='btn btn-link'\n\t\t\t\t\t\t\t\tdata-name='profile'\n\t\t\t\t\t\t\t\tonClick={this.toggleDarkmode}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<i class={`${darkmode ? 'fas text-warning' : 'far'} fa-moon`} />\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t{/* <li class='nav-item ml-auto d-none d-lg-block'>\n\t\t\t\t\t\t\t<form class='form-inline my-2 my-lg-0'>\n\t\t\t\t\t\t\t\t<Localizer>\n\t\t\t\t\t\t\t\t\t<input class='form-control form-control-sm mr-sm-2' type='search' placeholder={<Text id='header.search-placeholder'>Søk etter det meste...</Text>}\n\t\t\t\t\t\t\t\t\t\tvalue={searchText}\n\t\t\t\t\t\t\t\t\t\tonInput={linkState(this, 'searchText')}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Localizer>\n\t\t\t\t\t\t\t\t<button class='btn btn-sm btn-outline-success my-2 my-sm-0' type='button'\t\n\t\t\t\t\t\t\t\t\tonClick={this.search}\n\t\t\t\t\t\t\t\t><Text id='header.search'>Søk</Text></button>\n\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t</li> */}\n\t\t\t\t\t</ul>\n\n\t\t\t\t    \n\n\t\t\t\t</div>\n\t\t\t</nav>\n\t\t);\n\t}\n}\n\nexport default Navigation;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nfunction kgToPounds(value) {\n    return 2.20462 * value;\n}\n\n@observer\nclass Weight extends Component {\n    render() {\n\t\tconst { value = 0, smallUnit } = this.props;\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { settings = {} } = user;\n\n        if (settings.imperial) {\n            return (<>\n                <nobr>\n                    {util.format(kgToPounds(value), 0)} lb\n                </nobr>\n            </>);\n        }\n\n\t\treturn (<>\n            <nobr>\n                {util.format(value, 0)} kg\n            </nobr>\n        </>);\n    }\n}\n\nexport default Weight;\n","import { h, Component } from 'preact';\nimport { useEffect } from 'preact/hooks';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport Markdown from 'preact-markdown';\n\nimport Header from './header';\nimport Submenu from './submenu';\nimport Heatmap from '../../../components/public/heatmap';\nimport RaceHeader from './raceheader';\nimport RaceText from './raceText';\nimport DisplayMusher from './displayMusher';\nimport ListMusher from './listMusher';\nimport Gauge from '../../../components/gauge';\n\nimport RaceTracking from '../../../components/public/raceTracking.js';\n\nimport mu from '../../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(true, true);\nconst MARGIN_BOTTOM = mu.marginBottom();\n\nconst MARKDOWN_OPTIONS = {\n\tpedantic: false,\n\tgfm: true,\n\tbreaks: true,\n\tsanitize: false,\n\tsmartLists: true,\n\tsmartypants: true,\n\txhtml: true,\n};\n\nfunction PageTitle(title, classes = '', style = '') {\n\tuseEffect(() => {\n\t\tdocument.title = `Homerun Race: ${title}`;\n\t}, [title]);\n\treturn <span class={classes} style={style}>{title}</span>;\n}\n\nfunction getWindowDimensions() {\n    const { innerWidth: width, innerHeight: height } = window;\n    return {\n        width,\n        height\n    };\n}\n\nconst initialState = {\n\tisLoading: false,\n\temail: '',\n\tsubmenu: 'ads',\n\tjwtToken: util.getJwtToken(),\n\n\treloadInSec: null,\n\treloadIsActive: false,\n\n\tleaderboardMode: 'mushers',\n\tfilterByraceClass: '',\n\tshowLeaderBoard: true,\n\tshowNews: true,\n};\n\nconst RELOAD_INTERVAL_IN_SEC = 60;\n\n@observer\nclass ReloadTimer extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n\t\tthis.updateTimer = {};\n    }\n\n\tinitComponent = () => {\n\t\tthis.setState({\n\t\t\treloadIsActive: true,\n\t\t}, () => this.tickReloadTimeer());\n\t}\n\n\ttickReloadTimeer = () => {\n        const { reloadLastEpoch } = this.props;\n\t\tconst { reloadIsActive } = this.state;\n        if (reloadIsActive) {\n\t\t\tconst now = Math.floor(new Date().getTime() / 1000);\n\t\t\tconst reloadInSec = RELOAD_INTERVAL_IN_SEC - (now - reloadLastEpoch);\n\t\t\tthis.setState({ reloadInSec });\n\t\t\tclearTimeout(this.updateTimer.tick);\n\t\t\tthis.updateTimer.tick = setTimeout(() => this.tickReloadTimeer(), 1000);\n        }\n\t\treturn false;\n    }\n\n\tcomponentDidMount() {\n\t\tthis.initComponent();\n\t}\n\n\tcomponentWillUnmount() {\n\t\tclearTimeout(this.updateTimer.tick);\n\t}\n\n\trender() {\n\t\tconst { reloadInSec } = this.state;\n\t\tconst { radius = 13, fontSize = 11, classNames = '' } = this.props;\n\t\tconst reloadPercent = Math.floor(util.normalizeBetween(reloadInSec, 0, RELOAD_INTERVAL_IN_SEC, 0, 100))\n\n\t\treturn (<>\t\t\n\t\t\t<span class={classNames}>\n\t\t\t\t<Gauge key={`gauge-reload-page`}\n\t\t\t\t\tcolor='primary'\n\t\t\t\t\tradius={radius}\n\t\t\t\t\tshowPercentText={false}\n\t\t\t\t\tpercent={reloadPercent}\n\t\t\t\t\tshowCenterText={true}\n\t\t\t\t\tcenterText={reloadInSec}\n\t\t\t\t\tcenterTextSize={fontSize}\n\t\t\t\t\tcenterTextY={'55%'}\n\t\t\t\t/>\n\t\t\t</span>\n\t\t</>);\n\t}\n}\n\n@observer\nclass PublicRaceDetail extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n\t\t\treloadLastEpoch: Math.floor(new Date().getTime() / 1000),\n        };\n\t\tthis.updateTimer = {};\n    }\n\n\tloadLiveRaceResults = async (props = this.props, focusOnMushers) => {\n\t\tconst { raceStore } = props.stores;\n\t\tconst { race } = raceStore;\n\t\tawait raceStore.getRaceTrackerData(race.raceTrackerRace);\n\t\traceStore.getRaceTrackerActiveTeams();\n\t}\n\n\tloadRaceResults = async (props = this.props, teamIds, focusOnMushers) => {\n\t\tconst { raceStore } = props.stores;\n\t\tconst { raceid } = props;\n\n\t\tawait raceStore.loadWorkoutSummary(teamIds, raceid);\n\t\traceStore.getWorkoutSummaryActiveTeams(focusOnMushers);\n\t}\n\n\tasync loadRace(props = this.props) {\n\t\tthis.setState({ isLoading: true });\n\t\tconst { raceStore, appState } = props.stores;\n\t\tconst { raceid } = props;\n\t\tawait raceStore.load(raceid);\n\t\tconst { race } = raceStore;\n\t\tconst { focusOnMushers = [] } = appState;\n\n\t\tconst allTeamIds = race.classes.filter(currentClass => currentClass.contestants && currentClass.contestants.length > 0).map((currentClass) => {\n            return currentClass.contestants.filter(musher => musher.team > 0).map(musher => musher.team);\n\t\t}).flat();\n\n\t\tconst teamsInThisRace = focusOnMushers.filter(teamid => allTeamIds.indexOf(teamid) > -1);\n\t\tthis.setState({ allTeamIds });\n\t\tif (allTeamIds.length > 0) {\n\t\t\tawait raceStore.loadTeams(allTeamIds.join(','));\n\t\t\tif (race.liveRace > 0) {\n\t\t\t\tawait this.loadLiveRaceResults(props, focusOnMushers);\n\n\t\t\t} else {\n\t\t\t\tawait this.loadRaceResults(props, allTeamIds.join(','), focusOnMushers);\n\t\t\t}\n\n\t\t}\n\t\traceStore.getAllClassesSortedBy();\n\n\t\tconst isLiveRace = race.liveRace === 1;\n\n\t\tif (!isLiveRace) {\n\t\t\t// Set reload timer\n\t\t\tclearTimeout(this.updateTimer.reload);\n\t\t\tthis.updateTimer.reload = setTimeout(async () => {\n\t\t\t\tconst reloadLastEpoch = Math.floor(new Date().getTime() / 1000);\n\t\t\t\tthis.setState({ reloadLastEpoch });\n\t\t\t\tthis.loadRace();\n\t\t\t}, RELOAD_INTERVAL_IN_SEC * 1000);\n\t\t}\n\n\t\tthis.setState({ isLoading: false });\n\t}\n\n\tsetLeaderboardMode = (e) => {\n\t\tconst leaderboardMode = e.target.parentElement.dataset.mode || e.target.dataset.mode;\n\t\tthis.setState({ leaderboardMode })\n\t}\n\n\tchooseRaceClass = (e) => {\n\t\tconst filterByraceClass = e.target.value;\n\t\tthis.setState({ filterByraceClass })\n\t}\n\n\ttoggleShowLeaderBoard = (hide) => {\n\t\tconst { showLeaderBoard } = this.state;\n\t\tif (hide === true) {\n\t\t\tthis.setState({ showLeaderBoard: false });\n\t\t} else {\n\t\t\tthis.setState({ showLeaderBoard: !showLeaderBoard });\n\t\t}\n\t}\n\n\ttoggleShowNews = (hide) => {\n\t\tconst { showNews } = this.state;\n\t\tif (hide === true) {\n\t\t\tthis.setState({ showNews: false });\n\t\t} else {\n\t\t\tthis.setState({ showNews: !showNews });\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\tclearTimeout(this.updateTimer.reload);\n\t\tclearTimeout(this.updateTimer.tick);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.loadRace();\n\t\tconst { width, height } = getWindowDimensions();\n\t\tif (width < 800) {\n\t\t\tthis.toggleShowLeaderBoard(true);\n\t\t\tthis.toggleShowNews(true);\n\t\t}\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {\n\t\tthis.loadRace(nextProps);\n\t}\n\n\trender() {\n\t\tconst { appState, raceStore, userStore } = this.props.stores;\n\t\tconst { user = {} } = userStore;\n\t\tconst { raceid, path } = this.props;\n\t\tconst { language = 'en', focusOnMushers = [], infoOnMushers = [] } = appState;\n\t\tconst { leaderboardMode, filterByraceClass, showLeaderBoard, showNews, reloadLastEpoch, allTeamIds = [] } = this.state;\n\n\t\tconst teamsInThisRace = focusOnMushers.filter(teamid => allTeamIds.indexOf(teamid) > -1);\n\n\t\tconst { activeTeams, teamList, waypoints, zoomToMarkers, race, classes } = raceStore;\n\n\t\tconst isLiveRace = race.liveRace === 1;\n\n\t\tif (isLiveRace) {\n\t\t\treturn (\n\t\t\t\t<div class='container-fluid position-relative p-0' style={`margin-top: 0; height: calc(100vh - ${MARGIN_TOP}); z-index: 9999;`}>\n\t\t\t\t\t<RaceTracking stores={this.props.stores} raceid={raceid} linkBase={'/race/'} />\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div class='container-fluid h-100 position-relative p-0'>\n\t\t\t\t\t<Heatmap\n\t\t\t\t\t\tstores={this.props.stores}\n\t\t\t\t\t\traceid={raceid}\n\t\t\t\t\t\twaypoints={waypoints}\n\t\t\t\t\t\tzoomToMarkers={zoomToMarkers}\n\t\t\t\t\t\tfullscreenMap={true}\n\t\t\t\t\t\t// key={`heatmap-${focusOnMushers.join('-')}-${reloadLastEpoch}`}\n\t\t\t\t\t\t// mapid={`heatmap-${focusOnMushers.join('-')}-${reloadLastEpoch}`}\n\t\t\t\t\t/>\n\n\t\t\t\t\t<div class='position-absolute' style='top: 15px; left: 5px; z-index: 99999999;'>\n\t\t\t\t\t\t<div class='logo ml-3 clearfix text-white'>\n\t\t\t\t\t\t\t<img src={`./assets/homerun-race-logo-2-small.png`} height='37' class='float-left' />\n\t\t\t\t\t\t\t<a href={`/race/${race.id}`}>\n\t\t\t\t\t\t\t\t<span class='font-weight-bold text-dark' style='font-size: 1.4em;'>Homerun Race</span>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{!showLeaderBoard && <div class='position-absolute' style='top: 55px; left: 5px; z-index: 99999999; width: 150px; height: 50px;'>\n\t\t\t\t\t\t<button type='button' class='btn btn-sm btn-light' onClick={this.toggleShowLeaderBoard}>\n\t\t                    <ReloadTimer stores={this.props.stores} classNames='float-right ml-2' reloadLastEpoch={reloadLastEpoch} />\n\t\t\t\t\t\t\t<span class='float-left'>Leaderboard</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>}\n\n\t\t\t\t\t{!showNews && <div class='position-absolute' style='bottom: 40px; right: 5px; z-index: 99999999; width: 150px; height: 50px;'>\n\t\t\t\t\t\t<button type='button' class='btn btn-sm btn-primary float-right' onClick={this.toggleShowNews}>\n\t\t\t\t\t\t\t<span class='float-left'>News</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>}\n\n\t\t\t\t\t{showNews && race && race.articles && race.articles && race.articles.length >  0 && <div class='position-absolute' style='bottom: 50px; right: 5px; z-index: 99999999; width: 350px; height: 40vh;'>\n\t\t\t\t\t\t<div class='container-fluid bg-light rounded-lg py-2 overflow-auto mt-2' style='opacity: 0.9; height: 90%;'>\n\t\t\t\t\t\t\t<div class='row bg-light'>\n\t\t\t\t\t\t\t\t<div class='col-12 bg-primary text-white'>\n\t\t\t\t\t\t\t\t\t<button type='button' class='btn btn-sm btn-danger float-right' onClick={this.toggleShowNews}>\n\t\t\t\t\t\t\t\t\t\tX\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\tNews\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class='col-12 bg-light'>\n\t\t\t\t\t\t\t\t\t{race && race.articles && race.articles.reverse().map(article => <div class='border-bottom mb-2 pb-2 clearfix'>\n\t\t\t\t\t\t\t\t\t\t<small class='text-muted float-right'>{util.formatDate(article.date, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</small>\n\t\t\t\t\t\t\t\t\t\t<h5>{mu.replaceImages(article.title, article.images, language, false)}</h5>\n\t\t\t\t\t\t\t\t\t\t{article.image && <img src={article.image.s3LargeLink} class='float-right rounded-lg ml-2' style='height: 100px;' />}\n\n\t\t\t\t\t\t\t\t\t\t{article.ingress && <strong>\n\t\t\t\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(article.ingress, article.images, language)} markdownOpts={MARKDOWN_OPTIONS} />\n\t\t\t\t\t\t\t\t\t\t</strong>}\n\t\t\t\t\t\t\t\t\t\t{article.body && <p>\n\t\t\t\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(article.body, article.images, language)} markdownOpts={MARKDOWN_OPTIONS} />\n\t\t\t\t\t\t\t\t\t\t</p>}\n\t\t\t\t\t\t\t\t\t</div>)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>}\n\n\t\t\t\t\t{showLeaderBoard && <div class='position-absolute' style='top: 55px; left: 5px; z-index: 99999999; width: 350px; height: 90vh;'>\n\t\t\t\t\t\t<div class='container-fluid bg-light rounded-lg py-2 overflow-auto mt-2' style='opacity: 0.9; height: 90%;'>\n\t\t\t\t\t\t\t<div class='row bg-light'>\n\t\t\t\t\t\t\t\t<div class='col-12'>\n\t\t\t\t\t\t\t\t\t<button type='button' class='btn btn-sm btn-link float-right' onClick={this.toggleShowLeaderBoard}>\n\t\t\t\t\t\t\t\t\t\tX\n\t\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t\t<ReloadTimer stores={this.props.stores} classNames='float-right' radius={15} fontSize={13} reloadLastEpoch={reloadLastEpoch} />\n\t\t\t\t\t\t\t\t\t<h5 class='mb-0'>Leaderboard</h5>\n\t\t\t\t\t\t\t\t\t{PageTitle(race.title, 'font-weight-normal text-dark', 'font-size: 1.0em;')}\n\n\t\t\t\t\t\t\t\t\t<select class='form-control-plaintext' aria-describedby='classHelp'\n\t\t\t\t\t\t\t\t\t\tonInput={this.chooseRaceClass}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<option value=''>-- Choose class --</option>\n\t\t\t\t\t\t\t\t\t\t{race.classes && race.classes.sort((a, b) => a.distance - b.distance).map(currentClass => <>\n\t\t\t\t\t\t\t\t\t\t\t<option value={currentClass.id}>{currentClass.title} ({currentClass.totalMushers})</option>\n\t\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t\t</select>\n\n\t\t\t\t\t\t\t\t\t<ul class='mt-2 nav nav-tabs nav-justified tracking-nav'>\n\t\t\t\t\t\t\t\t\t\t<li class='nav-item' style='width: 33%;'>\n\t\t\t\t\t\t\t\t\t\t\t<a class={`nav-link ${leaderboardMode === 'mushers' ? 'active' : ''}`} onClick={this.setLeaderboardMode} data-mode='mushers'><Text id='races.mushers'>Deltakere</Text></a>\n\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t<li class='nav-item' style='width: 33%;'>\n\t\t\t\t\t\t\t\t\t\t\t<a class={`nav-link ${leaderboardMode === 'onTrail' ? 'active' : ''}`} onClick={this.setLeaderboardMode} data-mode='onTrail'><Text id='races.on-trail'>På sporet nå</Text></a>\n\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t<li class='nav-item' style='width: 33%;'>\n\t\t\t\t\t\t\t\t\t\t\t<a class={`nav-link ${leaderboardMode === 'favorites' ? 'active' : ''}`} onClick={this.setLeaderboardMode} data-mode='favorites'><Text id='races.favorites'>Favoritter</Text></a>\n\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t{leaderboardMode === 'mushers' && <>\n\n\t\t\t\t\t\t\t\t{race.classes && race.classes.sort((a, b) => a.distance - b.distance)\n\t\t\t\t\t\t\t\t\t.filter((currentClass) => {\n\t\t\t\t\t\t\t\t\t\tif (filterByraceClass) {\n\t\t\t\t\t\t\t\t\t\t\tif (filterByraceClass === currentClass.id) {\n\t\t\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.map(currentClass => <>\n\t\t\t\t\t\t\t\t\t\t<div class='row mt-2 bg-primary text-white'>\n\t\t\t\t\t\t\t\t\t\t\t<div class='col-12'>\n\t\t\t\t\t\t\t\t\t\t\t\t<h5 class='m-0'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{currentClass.title}\n\t\t\t\t\t\t\t\t\t\t\t\t</h5>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t{classes[currentClass.id] && classes[currentClass.id].contestants && classes[currentClass.id].contestants.map((contestant, idx) => {\n\t\t\t\t\t\t\t\t\t\t\tconst { musher, currentTeam, currentStages, currentResults, completed, duration,\n\t\t\t\t\t\t\t\t\t\t\t\tnormalizedDuration, weightedNormalizedDuration, totalKcalRelated, weightedTotalKcal,\n\t\t\t\t\t\t\t\t\t\t\t\tflatTotalKcal, percentHarder, loadIndex, raceDistance, isDone } = contestant;\n\t\t\t\t\t\t\t\t\t\t\treturn (<>\n\t\t\t\t\t\t\t\t\t\t\t\t<ListMusher stores={this.props.stores} team={currentTeam} idx={idx} />\n\t\t\t\t\t\t\t\t\t\t\t</>);\n\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t</>)}\n\n\n\t\t\t\t\t\t\t\t{/* {(teamList && teamList.length > 0) ? teamList.filter((team) => {\n\t\t\t\t\t\t\t\t\tif (filterByraceClass) {\n\t\t\t\t\t\t\t\t\t\tconst raceClass = raceStore.getClassByTeamId(team.id);\n\t\t\t\t\t\t\t\t\t\tif (filterByraceClass === raceClass.id) {\n\t\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t}).map((team, idx) => <ListMusher stores={this.props.stores} team={team} idx={idx} />) : <>\n\t\t\t\t\t\t\t\t\t<div class='p-2 text-center'>\n\t\t\t\t\t\t\t\t\t\t<h5><Text id='races.no-teams-signed-up'>Ingen team påmeldt ennå...</Text></h5>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</>} */}\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t\t{leaderboardMode === 'favorites' && <>\n\t\t\t\t\t\t\t\t{(teamsInThisRace && teamsInThisRace.length > 0) ? teamsInThisRace.map((teamId, idx) => {\n\t\t\t\t\t\t\t\t\t\tconst team = raceStore.getTeamById(teamId);\n\t\t\t\t\t\t\t\t\t\treturn <ListMusher stores={this.props.stores} team={team} idx={idx} />;\n\t\t\t\t\t\t\t\t\t}\t\n\t\t\t\t\t\t\t\t) : <>\n\t\t\t\t\t\t\t\t\t<div class='p-2 text-center'>\n\t\t\t\t\t\t\t\t\t\t<h5><Text id='races.no-teams-signed-up'>Ingen team påmeldt ennå...</Text></h5>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t\t{leaderboardMode === 'onTrail' && <>\n\t\t\t\t\t\t\t\t<div class='text-muted text-center bg-light'><Text id='races.mushers-on-trail'>Mushers on trail</Text>: {activeTeams.length}</div>\n\t\t\t\t\t\t\t\t{(activeTeams && activeTeams.length > 0) ? activeTeams.filter((line) => {\n\t\t\t\t\t\t\t\t\tif (filterByraceClass) {\n\t\t\t\t\t\t\t\t\t\tconst raceClass = raceStore.getClassByTeamId(line.team);\n\t\t\t\t\t\t\t\t\t\tif (filterByraceClass === raceClass.id) {\n\t\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t}).map((line, idx) => {\n\t\t\t\t\t\t\t\t\tconst team = raceStore.getTeamById(line.team);\n\t\t\t\t\t\t\t\t\treturn (<ListMusher stores={this.props.stores} team={team} idx={idx} />);\n\t\t\t\t\t\t\t\t}) : <>\n\t\t\t\t\t\t\t\t\t<div class='p-2 text-center'>\n\t\t\t\t\t\t\t\t\t\t<h5><Text id='races.no-team-on-trail'>Ingen team tracker live i The Musher appen akkurat nå...</Text></h5>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>}\n\n\t\t\t\t\t{(infoOnMushers && infoOnMushers.length > 0 && teamList && teamList.length > 0) && <>\n\t\t\t\t\t\t<div class='position-absolute overflow-auto' style='top: 15px; right: 55px; z-index: 99999999; max-width: 830px; max-height: 90%;'>\n\t\t\t\t\t\t\t<div class=''>\n\t\t\t\t\t\t\t\t<div class='d-flex flex-wrap'>\n\t\t\t\t\t\t\t\t\t{infoOnMushers.map(teamId => <DisplayMusher stores={this.props.stores} teamId={teamId} />)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</>}\n\n\t\t\t\t</div>\n\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default PublicRaceDetail;\n","import { h, Component } from 'preact';\nimport { observer } from 'mobx-preact';\n\nconst initialState = {\n};\n\n@observer\nclass RaceText extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n    render() {\n\t\tconst { appState } = this.props.stores;\n\t\tconst { text } = this.props;\n\t\tconst { darkmode, language = 'en' } = appState;\n\n        let finalText = text;\n\n        const regex = new RegExp(`/<${language}>(.*?)<\\/${language}>/`);\n        const parsedText = text.replace(regex, '$1');\n        if (parsedText) {\n            finalText = text;\n        }\n\n\t\treturn (\n\t\t\t<>\n                {finalText}\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default RaceText;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nfunction meterToFeet(value) {\n    return 3.28084 * value;\n}\n\n@observer\nclass Elevation extends Component {\n    render() {\n\t\tconst { value = 0, smallUnit } = this.props;\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { settings = {} } = user;\n\n        if (settings.imperial) {\n            return (<>\n                <nobr>\n                    {util.format(meterToFeet(value), 0)} {smallUnit ? <><small><small><small class='ml-0 text-muted'>ft</small></small></small></> : <>ft</>}\n                </nobr>\n            </>);\n        }\n\n\t\treturn (<>\n            <nobr>\n                {util.format(value, 0)} {smallUnit ? <><small><small><small class='ml-0 text-muted'>m</small></small></small></> : <>m</>}\n            </nobr>\n        </>);\n    }\n}\n\nexport default Elevation;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nfunction kmtToMph(value) {\n    return 0.621371 * value;\n}\n\n@observer\nclass Speed extends Component {\n    render() {\n\t\tconst { value = 0, smallUnit } = this.props;\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { settings = {} } = user;\n\n        if (settings.imperial) {\n            return (<>\n                <nobr>\n                    {util.format(kmtToMph(value), 1)} {smallUnit ? <><small><small><small class='ml-0 text-muted'><Text id='workouts.mph'>mph</Text></small></small></small></> : <><Text id='workouts.mph'>mph</Text></>}\n                </nobr>\n            </>);\n        }\n\n\t\treturn (<>\n            <nobr>\n                {util.format(value, 1)} {smallUnit ? <><small><small><small class='ml-0 text-muted'><Text id='workouts.kmt'>km/t</Text></small></small></small></> : <><Text id='workouts.kmt'>km/t</Text></>}\n            </nobr>\n        </>);\n    }\n}\n\nexport default Speed;\n","import { h, Component } from 'preact';\nimport { useEffect } from \"preact/hooks\";\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nconst initialState = {\n};\n\n@observer\nclass DisplayMusher extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\ttoggleFocusOnMusher = (e) => {\n\t\tconst musherId = e.target.parentElement.dataset.musherid || e.target.dataset.musherid;\n\t\tconst { appState, raceStore } = this.props.stores;\n\t\tappState.toggleFocusOnMusher(parseInt(musherId, 10));\n\n\t\tconst { focusOnMushers } = appState;\n\t\traceStore.getWorkoutSummaryActiveTeams(focusOnMushers);\n\t}\n\n\ttoggleInfoOnMusher = (e) => {\n\t\tconst musherId = e.target.parentElement.dataset.musherid || e.target.dataset.musherid;\n\t\tconst { appState } = this.props.stores;\n\t\tappState.toggleInfoOnMusher(parseInt(musherId, 10));\n\t}\n\n    render() {\n\t\tconst { raceStore, appState } = this.props.stores;\n\t\tconst { teamId } = this.props;\n\t\tconst { darkmode, language = 'en' } = appState;\n\t\tconst { race } = raceStore;\n\n        const team = raceStore.getTeamById(teamId);\n        if (!team || !team.id) {\n            return <></>;\n        }\n        const line = raceStore.getActiveTeamById(team.id);\n        const currentStages = raceStore.getWorkoutSummaryByTeam(team.id).reverse();\n        const currentClass = raceStore.getClassByTeamId(team.id);\n        const currentResults = raceStore.getWorkoutResultsByTeam(currentStages, currentClass.distance);\n        const musher = raceStore.getMusherByTeamId(team.id);\n        const image = team.images && team.images.length > 0 ? team.images[0] : {};\n        const raceClass = raceStore.getClassByTeamId(team.id);\n\n        const completed = currentResults.distanceKm / currentClass.distance * 100;\n        const hasStarted = completed > 0 ? 1 : 0;\n        const isDone = completed >= 100 ? 1 : 0;\n\n        let currentSpeed;\n        let updated;\n        let isActive;\n        if (line && line.currentLocation && line.currentLocation.coords) {\n            currentSpeed = line.currentLocation.coords.speed * 3.6;\n            updated = line.currentLocation.timestamp;\n            isActive = true;\n        }\n        let toFinish = raceClass.distance - currentResults.distanceKm;\n        if (toFinish < 0) {\n            toFinish = 0;\n        }\n\n        // const currentSpeed = util.format(line.currentLocation.coords.speed * 3.6, 1);\n        // avgDogs: 9.777777777777779\n        // distanceKm: 268.3432364824406\n        // duration: 67524.34002106966\n        // elevation: 5287.123805500813\n        // flatTotalKcal: 4971.658025959346\n        // images: Array(32) [ Proxy, Proxy, Proxy, … ]\n        // loadIndex: 1446\n        // rest: 2306\n        // speedAvg: 14.820718823260847\n        // totalKcalRelated: 1225.314525471911\n        // weightedTotalKcal: 11344.398317216459\n\n\n\t\treturn (\n\t\t\t<>\n                <div class='mr-2 mb-2 overflow-auto' style='width: 350px !important; max-height: 350px; overflow-x: hidden !important;'>\n                    <div class='p-2 bg-light rounded-lg'>\n                        <div class='row mt-2' style='font-size: 0.9em;'>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n                            <div class='col-4 text-center'>\n                                <div\n                                    class={`text-center text-muted pt-2 h-100`}\n                                    style={`background-image: url(\"${image.s3SmallLink}\"); background-size: cover;`}\n                                    onClick={this.toggleFocusOnMusher} data-musherid={team.id}\n                                >\n                                    {!image.s3SmallLink && <>\n                                        <span class='font-weight-lighter' style='font-size: 55px;'>\n                                            {util.ucfirst(String(musher.firstname), true)}\n                                            {util.ucfirst(String(musher.lastname), true)}\n                                        </span>\n                                    </>}\n                                </div>\n                            </div>\n                            <div class='col-8'>\n                                <div class='row'>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n                                    <div class='col-12' style='font-size: 1.5em; line-height: 1.0em;'>\n                                        <button\n                                            type='button'\n                                            class='btn btn-sm float-right'\n                                            onClick={this.toggleInfoOnMusher} data-musherid={team.id}\n                                        >\n                                            X\n                                        </button>\n                                        <span class='font-weight-bold'>{musher.firstname} {musher.lastname}</span><br />\n                                        <span class='font-weight-lighter'>{team.name}</span><br />\n                                        {raceClass && raceClass.title && <>\n                                            <span class='font-weight-lighter mr-2' style='font-size: 0.8em;'>\n                                                {raceClass.title} - \n                                            </span>\n                                        </>}\n                                        <span class='font-weight-lighter' style='font-size: 0.8em;'>\n                                            {util.format(currentResults.avgDogs, 1)} <i class='fas fa-dog text-muted ml-1' />\n                                        </span>\n                                    </div>\n                                </div>\n                                <div class='row mt-2'>\n                                    <div class='col-4 text-center' style='line-height: 1.4em;'>\n                                        <span class='text-muted'>km/t</span><br />\n                                        <span style='font-size: 2.0em;'>{util.format(currentResults.speedAvg, 1)}</span>\n                                    </div>\n                                    <div class='col-4 text-center' style='line-height: 1.4em;'>\n                                        <span class='text-muted'>km</span><br />\n                                        <span style='font-size: 2.0em;'>{util.format(currentResults.distanceKm)}</span>\n                                    </div>\n                                    <div class='col-4 text-center' style='line-height: 1.4em;'>\n                                        <span class='text-muted'>to finish</span><br />\n                                        <span style='font-size: 2.0em;'>\n                                            {toFinish === 0 ? <i class='fas fa-flag-checkered text-success' /> : <>{util.format(toFinish, 0)}</>}\n                                        </span>\n                                    </div>\n                                </div>\n                                <div class='row mt-2'>\n                                    <div class='col-6 text-center' style='line-height: 1.4em;'>\n                                        <span class='text-muted'>\n                                            {toFinish === 0 ? <>\n                                                Calc.Duration\n                                            </> : <>\n                                                Duration\n                                            </>}\n                                        </span><br />\n                                        <span style='font-size: 1.5em;'>\n                                            {toFinish === 0 ? <>\n                                                {util.secToHms(currentResults.weightedNormalizedDuration || currentResults.duration)}\n                                            </> : <>\n                                                {util.secToHms(currentResults.duration)}\n                                            </>}\n                                        </span>\n                                    </div>\n                                    <div class='col-6 text-center' style='line-height: 1.4em;'>\n                                        <span class='text-muted'>Status</span><br />\n                                        <span style='font-size: 1.5em;'>\n                                            {isActive ? <>\n                                                {line.isInProgress === 1 ? <span class='text-primary'>running</span> : ''}\n                                                {line.isInProgress === 2 ? <span class='text-danger'>resting</span> : ''}\n                                                {toFinish === 0 ? <>\n                                                    {!line.isInProgress ? <span class='text-success'>FINISH</span> : ''}\n                                                </> : <>\n                                                    {!line.isInProgress ? <>\n                                                        {hasStarted ? <span class='text-danger'>resting</span> : <span class='text-muted'>NYS</span>}\n                                                    </> : '-'}                                                    \n                                                </>}\n                                            </> : <>\n                                                {toFinish === 0 ? <span class='text-success'>FINISH</span> : <>\n                                                    {hasStarted ? <span class='text-danger'>resting</span> : <span class='text-muted'>NYS</span>}\n                                                </>}\n                                            </>}\n                                        </span>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        <div class='row mt-2' style='font-size: 0.9em;'>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n                            <div class='col-6'>\n                                <table class='table table-sm table-striped'>\n                                    <tbody>\n                                        <tr>\n                                            <td>Current speed</td>\n                                            <td>{currentSpeed ? <>{util.format(currentSpeed, 1)} km/t</> : '-'}</td>\n                                        </tr>\n                                        <tr>\n                                            <td>Avg speed</td>\n                                            <td>{util.format(currentResults.speedAvg, 1)} km/t</td>\n                                        </tr>\n                                        <tr>\n                                            <td>Duration</td>\n                                            <td>{util.secToHms(currentResults.duration)}</td>\n                                        </tr>\n                                        <tr>\n                                            <td>Calculated duration</td>\n                                            <td>{util.secToHms(currentResults.weightedNormalizedDuration)}</td>\n                                        </tr>\n                                        <tr>\n                                            <td>Rest</td>\n                                            <td>{util.secToHms(currentResults.rest)}</td>\n                                        </tr>\n                                        <tr>\n                                            <td>Elevation</td>\n                                            <td>{util.format(currentResults.elevation, 0)} m</td>\n                                        </tr>\n                                        <tr>\n                                            <td>Altitude</td>\n                                            <td>{isActive ? <>{line.currentLocation.coords.altitude} moh</> : '-'}</td>\n                                        </tr>\n                                        <tr>\n                                            <td>Load index</td>\n                                            <td>{currentResults.loadIndex}</td>\n                                        </tr>\n                                        <tr>\n                                            <td>Updated:</td>\n                                            <td>{isActive ? <>{util.formatDistance(updated, new Date())} ago</> : '-'}</td>\n                                        </tr>\n                                    </tbody>\n                                </table>\n                            </div>\n                            <div class='col-6'>\n                                <span>Elevation profile:</span><br />\n                                {isActive ? <svg viewBox='0 0 300 100' style='width: 180px; height: 60px; top: 0; left: 0;'>\n                                    <path d={`${line.svgElevation}`} style='fill: #0063FF; stroke: #0063FF; stroke-width: 2; opacity: 0.2;' />\n                                </svg> : <div>-</div>}\n                                <span>Map profile:</span><br />\n                                {isActive ? <svg viewBox='0 0 300 300' style='width: 180px; height: 180px; top: 0; left: 0;'>\n                                    <path d={`${line.svgMap}`} style='fill: none; stroke: #FF6300; stroke-width: 5; opacity: 0.2;' />\n                                </svg> : <div>-</div>}\n                            </div>\n                        </div>\n\n                        <div class='mt-2' style='font-size: 0.9em;'>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\n                            <div class='d-flex flex-wrap'>\n                                {currentStages && currentStages.map((stage, idx) => {\n                                    const percent = stage.distanceKm / currentClass.distance * 100;\n                                    const width = percent > 100 ? 100 : parseInt(percent, 10);\n                                    const currentEpoch = Math.floor(new Date(stage.date).getTime() / 1000);\n                                    const inDate = new Date(0); // The 0 there is the key, which sets the date to the epoch\n                                    inDate.setUTCSeconds(currentEpoch + parseInt(stage.duration, 10));\n                                    const images = stage.images.flat();\n                                    if (1) {\n                                        return (<>\n                                            <div class='bg-light border rounded-lg text-right position-relative mr-1 mb-1'>\n                                                <svg viewBox='0 0 300 100' class='position-absolute' style='width: 100%; height: 95%; bottom: 0px; left: 0px; z-index: 0;'>\n                                                    <path d={`${stage.svgElevation}`} style='fill: #0063FF; stroke: #0063FF; stroke-width: 2; opacity: 0.2;' />\n                                                </svg>\n                                                <div class='position-relative px-3'>\n                                                    <span class='position-absolute' style='top: 3px; left: 3px; font-size: 1.3em;'>{idx + 1}</span>\n                                                    <small>\n                                                        <span class='float-left'>\n                                                            <nobr><i style='width: 20px;' class='fas fa-sign-out-alt' /> {util.formatDate(stage.date, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</nobr>\n                                                            <nobr><i style='width: 20px;' class='fas fa-sign-in-alt' /> {util.formatDate(inDate, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</nobr>\n                                                        </span>\n                                                        <span class='float-right'>\n                                                            {/* {restTimeText}\n                                                            {restTimeTrackText} */}\n                                                            <nobr><i style='width: 20px;' class='fas fa-road' /> {util.format(stage.distanceKm, 1) || 'n/a'} <span class='font-weight-lighter'>km</span></nobr>\n                                                            <nobr><i style='width: 20px;' class='fas fa-mountain' /> {util.format(stage.elevation, 0) || 'n/a'} <span class='font-weight-lighter'>m</span></nobr>\n                                                            <nobr><i style='width: 20px;' class='fas fa-tachometer-alt' /> {util.format(stage.speedAvg, 1) || 'n/a'} <span class='font-weight-lighter'>km/t</span></nobr><br />\n\n                                                            <nobr><i style='width: 20px;' class='fas fa-clock' /> {util.secToHms(stage.duration) || 'n/a'}</nobr>\n                                                            <nobr><i style='width: 20px;' class='fas fa-moon' /> {util.secToHms(stage.rest) || 'n/a'}</nobr><br />\n                                                            <nobr><i style='width: 20px;' class='fas fa-dog' /> {util.format(stage.avgDogs, 0) || 'n/a'}</nobr>\n                                                            <nobr><i style='width: 20px;' class='fas fa-balance-scale' /> {util.format(stage.loadIndex, 0) || 'n/a'}</nobr><br />\n                                                            <nobr><i style='width: 20px;' class='fas fa-images' /> {images.length}</nobr><br />\n                                                        </span>\n                                                    </small>\n                                                </div>\n                                            </div>\n                                        </>);\n                                    }\n                                    return (<>\n                                        <div class='bg-light border rounded-lg text-right position-relative px-3 mr-1 mb-1' style={`width: ${width}%; min-width: 320px;`}>\n                                            <small>\n                                                <span class='float-left'>{idx + 1}</span>\n                                                <nobr><i style='width: 20px;' class='fas fa-road' /> {util.format(stage.distanceKm, 1) || 'n/a'} <span class='font-weight-lighter'>km</span></nobr>\n                                                <nobr><i style='width: 20px;' class='fas fa-tachometer-alt' /> {util.format(stage.speedAvg, 1) || 'n/a'} <span class='font-weight-lighter'>km/t</span></nobr>\n                                                <nobr><i style='width: 20px;' class='fas fa-clock' /> {util.secToHms(stage.duration) || 'n/a'}</nobr>\n                                            </small>\n                                        </div>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n                                    </>);\n                                })}\n                            </div>\n\n                        </div>\n\n                    </div>\n                </div>\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default DisplayMusher;\n"],"sourceRoot":""}