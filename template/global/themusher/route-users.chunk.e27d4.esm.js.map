{"version":3,"sources":["webpack:///./routes/users/index.js"],"names":["MARGIN_TOP","mu","marginTop","MARGIN_BOTTOM","marginBottom","Profile","observer","Component","constructor","props","super","resetEmailMessage","userStore","this","stores","updateField","resetEmailError","toggleSetting","async","field","user","settings","updateSetting","state","time","Date","now","count","componentDidMount","verifyEmailToken","verifyEmail","token","render","emailMessage","emailError","emailMessageIcon","emailErrorIcon","teams","allTeams","findTeams","apiServer","util","getApiServer","jwtToken","getJwtToken","class","style","message","icon","remove","href","id","email","team","findTeam","map","name","username","firstname","lastname","cellphone","url","facebook","instagram","snapchat","type","onInput","checked","hideProfile","for","hideInvite","strava","access_token","athlete","src","profile","native"],"mappings":"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","file":"route-users.chunk.e27d4.esm.js","sourcesContent":["import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(false);\nconst MARGIN_BOTTOM = mu.marginBottom();\n\nimport Error from '../../components/error';\nimport Message from '../../components/message';\n\n@observer\nclass Profile extends Component {\n\tconstructor(props) {\n        super(props);\n        this.state = {\n            time: Date.now(),\n\t\t\tcount: 10\n        };\n    }\n\n\tresetEmailMessage = () => {\n\t\tconst { userStore } = this.props.stores;\n\t\tuserStore.updateField('emailMessage', '');\n\t\tuserStore.updateField('emailMessageIcon', '');\n\t}\n\n\tresetEmailError = () => {\n\t\tconst { userStore } = this.props.stores;\n\t\tuserStore.updateField('emailError', '');\n\t\tuserStore.updateField('emailErrorIcon', '');\n\t}\n\n\ttoggleSetting= async (field) => {\n        const { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { settings } = user;\n        await userStore.updateSetting({ [`settings.${field}`]: settings[field] === 1 ? 0 : 1 });\n    }\n\n\tcomponentDidMount() {\n\t\tconst { userStore } = this.props.stores;\n\n\t\tif (this.props.verifyEmailToken) {\n\t\t\tuserStore.verifyEmail({ token: this.props.verifyEmailToken });\n\t\t}\n\t}\n\n\trender() {\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user, emailMessage, emailError, emailMessageIcon, emailErrorIcon, isAdmin } = userStore;\n\t\tconst { teams, settings = {} } = user;\n\t\tconst allTeams = userStore.findTeams(teams);\n\t\tconst apiServer = util.getApiServer();\n\t\tconst jwtToken = util.getJwtToken();\n\t\treturn (\n\t\t\t<div class='container-fluid' style={`margin-bottom: ${MARGIN_BOTTOM}; margin-top: ${MARGIN_TOP};`}>\n                <div class='row'>\n\t\t\t\t\t<div class='col-12'>\n\t\t\t\t\t\t<Error message={emailError} icon={emailErrorIcon} remove={this.resetEmailError} />\n                        <Message message={emailMessage} icon={emailMessageIcon} remove={this.resetEmailMessage}  />\n\n\t\t\t\t\t\t<a href='/users/edit' class='btn btn-primary btn-sm float-right'>\n\t\t\t\t\t\t\t<Text id='users.edit'>Endre</Text>\n\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t<h5><Text id='users.title'>Din profil</Text></h5>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col-4 text-muted text-right'><Text id='users.email'>E-post</Text></div><div class='col-8'>{user.email}</div>\n\t\t\t\t\t{user.team && <><div class='col-4 text-muted text-right'><Text id='users.main-team'>Hovedteam</Text></div><div class='col-8'>{userStore.findTeam(user.team)}</div></>}\n\t\t\t\t\t{user.teams && <><div class='col-4 text-muted text-right'><Text id='users.all-teams'>Alle teamene</Text></div><div class='col-8'>{allTeams.map(team => (\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t{team.name}\n\t\t\t\t\t\t\t{/* <span class='text-muted'>\n\t\t\t\t\t\t\t\t<i class='fas fa-dog ml-3' /> {team.dogs.length}\n\t\t\t\t\t\t\t\t<i class='fas fa-users ml-3' /> {team.members.length}\n\t\t\t\t\t\t\t</span> */}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t))}</div></>}\n\t\t\t\t\t{user.username && <><div class='col-4 text-muted text-right'><Text id='users.username'>Brukernavn</Text></div><div class='col-8'>{user.username}</div></>}\n\t\t\t\t\t{user.firstname && <><div class='col-4 text-muted text-right'><Text id='users.firstname'>Fornavn</Text></div><div class='col-8'>{user.firstname}</div></>}\n\t\t\t\t\t{user.lastname && <><div class='col-4 text-muted text-right'><Text id='users.lastname'>Etternavn</Text></div><div class='col-8'>{user.lastname}</div></>}\n\t\t\t\t\t{user.cellphone && <><div class='col-4 text-muted text-right'><Text id='users.cellphone'>Mobil</Text></div><div class='col-8'>{user.cellphone}</div></>}\n\t\t\t\t\t{user.url && <><div class='col-4 text-muted text-right'><Text id='users.homepage'>Hjemmeside</Text></div><div class='col-8'>{user.url}</div></>}\n\t\t\t\t\t{user.facebook && <><div class='col-4 text-muted text-right'><Text id='users.facebook'>Facebook</Text></div><div class='col-8'>{user.facebook}</div></>}\n\t\t\t\t\t{user.instagram && <><div class='col-4 text-muted text-right'><Text id='users.instagram'>Instagram</Text></div><div class='col-8'>{user.instagram}</div></>}\n\t\t\t\t\t{user.snapchat && <><div class='col-4 text-muted text-right'><Text id='users.snapchat'>Snapchat</Text></div><div class='col-8'>{user.snapchat}</div></>}\n\n\t\t\t\t\t<div class='col-4 text-muted text-right'>\n\t\t\t\t\t\t<Text id='users.settings-hide-profile'>Skjul profilen</Text>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col-8'>\n\t\t\t\t\t\t<div class='custom-control custom-switch'>\n\t\t\t\t\t\t\t<input type='checkbox' class='custom-control-input' id='settingsHideProfile' onInput={() => this.toggleSetting('hideProfile')} checked={settings.hideProfile} />\n\t\t\t\t\t\t\t<label class='custom-control-label' for='settingsHideProfile' />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<small class='text-muted'><Text id='users.settings-hide-profile-help'>Det vil snart være mulig å bli venner med andre her på The Musher. Dersom du ikke vil at andre skal kunne finne deg, så kan du skjule profilen din her.</Text></small>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class='col-4 text-muted text-right'>\n\t\t\t\t\t\t<Text id='users.settings-hide-invite'>Skjul invitasjonsboks</Text>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col-8'>\n\t\t\t\t\t\t<div class='custom-control custom-switch'>\n\t\t\t\t\t\t\t<input type='checkbox' class='custom-control-input' id='settingsHideInvitation' onInput={() => this.toggleSetting('hideInvite')} checked={settings.hideInvite} />\n\t\t\t\t\t\t\t<label class='custom-control-label' for='settingsHideInvitation' />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<small class='text-muted'><Text id='users.settings-hide-invite-help'>Skjul invitasjonsboksen på forsiden.</Text></small>\n\t\t\t\t\t</div>\n\n\t\t\t\t</div>\n\t\t\t\t<div class='row border mt-5 pt-5'>\n\t\t\t\t\t<div class='col-12'>\n\t\t\t\t\t\t<h3>Strava</h3>\n\t\t\t\t\t</div>\n\t\t\t\t\t{user.strava && user.strava.access_token ? (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<div class='col-12'><h5><Text id='users.strava-connected'>Connected to Strava!</Text></h5></div>\n\t\t\t\t\t\t\t<div class='col-4 text-right text-muted'><Text id='users.strava-id'>id</Text>:</div><div class='col-8'> {user.strava.athlete.id}</div>\n\t\t\t\t\t\t\t<div class='col-4 text-right text-muted'><Text id='users.strava-username'>username</Text>:</div><div class='col-8'> {user.strava.athlete.username}</div>\n\t\t\t\t\t\t\t{/* <div class='col-4 text-right text-muted'>resource_state:</div><div class='col-8'> {user.strava.athlete.resource_state}</div>\n\t\t\t\t\t\t\t<div class='col-4 text-right text-muted'>firstname:</div><div class='col-8'> {user.strava.athlete.firstname}</div>\n\t\t\t\t\t\t\t<div class='col-4 text-right text-muted'>lastname:</div><div class='col-8'> {user.strava.athlete.lastname}</div>\n\t\t\t\t\t\t\t<div class='col-4 text-right text-muted'>city:</div><div class='col-8'> {user.strava.athlete.city}</div>\n\t\t\t\t\t\t\t<div class='col-4 text-right text-muted'>state:</div><div class='col-8'> {user.strava.athlete.state}</div>\n\t\t\t\t\t\t\t<div class='col-4 text-right text-muted'>country:</div><div class='col-8'> {user.strava.athlete.country}</div>\n\t\t\t\t\t\t\t<div class='col-4 text-right text-muted'>sex:</div><div class='col-8'> {user.strava.athlete.sex}</div>\n\t\t\t\t\t\t\t<div class='col-4 text-right text-muted'>premium:</div><div class='col-8'> {user.strava.athlete.premium}</div>\n\t\t\t\t\t\t\t<div class='col-4 text-right text-muted'>summit:</div><div class='col-8'> {user.strava.athlete.summit}</div>\n\t\t\t\t\t\t\t<div class='col-4 text-right text-muted'>created_at:</div><div class='col-8'> {user.strava.athlete.created_at}</div>\n\t\t\t\t\t\t\t<div class='col-4 text-right text-muted'>updated_at:</div><div class='col-8'> {user.strava.athlete.updated_at}</div>\n\t\t\t\t\t\t\t<div class='col-4 text-right text-muted'>badge_type_id:</div><div class='col-8'> {user.strava.athlete.badge_type_id}</div>\n\t\t\t\t\t\t\t<div class='col-4 text-right text-muted'>profile_medium:</div><div class='col-8'> <img src={user.strava.athlete.profile_medium} /></div> */}\n\t\t\t\t\t\t\t<div class='col-4 text-right text-muted'><Text id='users.strava-profile'>profile</Text>:</div><div class='col-8'> <img src={user.strava.athlete.profile} /></div>\n\t\t\t\t\t\t\t{/* <div class='col-4 text-right text-muted'>friend:</div><div class='col-8'> {user.strava.athlete.friend}</div>\n\t\t\t\t\t\t\t<div class='col-4 text-right text-muted'>follower:</div><div class='col-8'> {user.strava.athlete.follower}</div> */}\n\n\t\t\t\t\t\t\t{/* {isAdmin && <div class='col-12'>\n\t\t\t\t\t\t\t\t<button class='btn btn-primary' onclick={userStore.stravaGetActivityStream}><Text id='users.strava-get-activities'>Get activity streams</Text></button>\n\t\t\t\t\t\t\t</div>} */}\n\t\t\t\t\t\t\t<div class='col-12'>\n\t\t\t\t\t\t\t\t<a href={`${apiServer}/api/strava/request-access?token=${jwtToken}`} native><Text id='users.strava-reconnect'>Reconnect to Strava</Text></a>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<a href={`${apiServer}/api/strava/request-access?token=${jwtToken}`} native><Text id='users.strava-connect'>Connect to Strava</Text></a>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Profile;\n"],"sourceRoot":""}