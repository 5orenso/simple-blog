{"version":3,"sources":["webpack:///./components/team/publicFeedLine.js","webpack:///./components/team/connect-boxes.js","webpack:///./components/dog/scroller.js","webpack:///./components/ad/index.js","webpack:///./routes/workouts/publicDetail.js","webpack:///./components/team/connect-confirm.js","webpack:///./components/team/fastList.js"],"names":["initialState","showAddComment","likeWorkout","idxSuggestion","idxAd","limit","offset","hasFollowSugguestions","hasAd","sessionid","Date","getTime","TeamPublicFeedLine","observer","Component","constructor","props","super","toggleDate","e","stopPropagation","preventDefault","showDate","this","state","setState","async","workoutId","parseInt","target","closest","dataset","id","workoutStore","stores","setTimeout","response","status","addLikeToFeed","data","addCommentToFeed","type","workout","commentId","replyId","teamStore","addLikeToComment","addLikeToCommentReply","addCommentToWorkoutComment","addCommentToWorkout","addLikeToWorkout","toggleAddComment","inputRef","focus","shareLink","url","title","text","appState","shareUrl","showWorkoutDetail","localName","console","log","route","translate","feed","userStore","user","translatedTextName","object","field","translatedTextComment","comment","showOriginal","containerRef","render","onTeamClick","onUserClick","onDogClick","isAdmin","language","hasShareApi","publicDogs","team","findPublicTeam","publicUser","findPublicUser","teamType","findTeamAmbition","ambition","ambitions","findTeamType","isTeamAdmin","members","some","m","image","mu","getImage","priority","likes","comments","hasLikedWorkout","findIndex","totalFollowers","followers","length","isYourTeam","indexOf","isFollowing","hasRequestedFollow","followRequests","workoutEquipment","findEquipment","equipment","workoutEquipmentIcon","gpxInfo","shortname","name","username","userLink","displayNameShort","displayName","settings","uuidv4","hideProfile","images","mapImage","push","imgs","toJS","currentLocationGeocode","yrWeather","views","getViews","statistics","adminData","getAdminData","translationName","getTranslation","targetLang","feedName","feedComment","class","style","public","href","onClick","date","util","formatDate","locale","hour12","hour","minute","formatDistance","format","dogs","track","sledWeight","value","temperature","formattedCounty","moonIllumination","phaseIcon","formatted_address","deviceInfo","map","count","ranking","isNumber","rankingTrend","getClassForTrend","durationAvg","durationAvgTrend","statisticsCurrent","totalInteractions","shadowTags","tag","dblClick","likeRef","allDogs","distanceKm","elevation","duration","secToHms","speedAvg","avgGpsMovingSpeed","data-id","markdown","replaceImages","markdownOpts","getMarkdownOptions","buttonOnly","data-url","data-title","rel","data-native","c","inputRefObject","col","showAvatar","extraClass","callback","compact","requestSent","Teams","requestFollowTeam","followRequest","getButton","isBlocked","blockedFollowers","unFollowTeam","disabled","data-team","isLoading","loadPublic","query","notfollowing","array","componentDidMount","loadTeams","publicTeamsToFollow","darkmode","isArray","s3SmallLink","place","country","DogScroller","scrollImages","scrollLeft","clientWidth","imageIdx","nearestInt","Math","round","diff","abs","Number","isInteger","sortByName","a","b","dogA","find","dogB","size","onScroll","sort","dogId","dog","onTouchstart","onTouchend","onTouchmove","filter","d","className","showName","showPosition","Ad","withText","subject","body","logClick","adStore","ads","updateTimer","apiServer","getApiServer","section","path","currentTeam","postalcode","findTeam","page","replace","load","setTime","loadAd","componentWillReceiveProps","nextProps","time","match","ad","src","native","s3LargeLink","MARGIN_TOP","marginTop","MARGIN_TOP_BACK","marginTopBack","MARGIN_BOTTOM","marginBottom","dataFields","WorkoutPublicDetail","teamid","showTeam","hideTeam","dogid","showDog","hideDog","renderContent","obj","idx","back","history","goBack","workoutid","loadPublicFeed","componentWillUnmount","loadPublicWorkouit","handleIntersection","publicTeamsFeed","findPublicTeamByUuidv4","wrapperClassNames","contentClassNames","dataValues","confirmed","deleted","confirmRequest","follow","confirmFollowRequest","followRequestUser","deleteRequest","deleteFollowRequest","addData","teams","hasFollowRequests","reqUser","isDeleted","isConfirmed","publicTeam","data-user","data-follow","FastListLine","removeIntersectionObserver","addIntersectionObserver","dataProperties","forEach","encodeURI","ref","data-idx","FastList","deleteIntersectionObserver","intersectionObserver","entries","isIntersecting","height","currentHeight","max","childNodes","offsetHeight","scrollHeight","display","minHeight","setupIntersectionObserver","window","IntersectionObserverEntry","prototype","IntersectionObserver","root","rootMargin","threshold","observe","unobserve","componentWillMount","isObject","wrapperClasses","hasOwnProperty","contentClasses","key"],"mappings":"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","file":"76.chunk.a278a.esm.js","sourcesContent":["import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { toJS } from 'mobx';\nimport { Text, Localizer } from 'preact-i18n';\nimport Markdown from 'preact-markdown';\nimport { route } from 'preact-router';\n\nimport ImageScroller from '../imageScroller';\nimport DogScroller from '../dog/scroller';\nimport WorkoutComments from '../workout/comments';\nimport WorkoutAddComment from '../workout/commentAdd';\n\nimport PublicTeam from '../team/public';\n\nimport LikesAndComments from '../feedback/likesAndComments';\nimport Views from '../feedback/views';\n\nimport Speed from '../data/speed';\nimport Elevation from '../data/elevation';\nimport Weight from '../data/weight';\nimport Distance from '../data/distance';\nimport Temperature from '../data/temperature';\n\nimport mu from '../../lib/musher-util';\n\nfunction displayDistance(distanceKm) {\n\tif (distanceKm < 5) {\n\t\treturn util.format(distanceKm, 2);\n\t}\n\tif (distanceKm < 10) {\n\t\treturn util.format(distanceKm, 1);\n\t}\n\treturn util.format(distanceKm, 1);\n}\n\nconst initialState = {\n\tshowAddComment: {},\n    // viewImageIdx: {},\n    likeWorkout: {},\n    idxSuggestion: 0,\n    idxAd: 4,\n    limit: 15,\n    offset: 0,\n    hasFollowSugguestions: false,\n    hasAd: false,\n    sessionid: new Date().getTime(),\n};\n\n@observer\nclass TeamPublicFeedLine extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n        this.inputRef = {};\n        this.containerRef = null;\n    }\n\n    toggleDate = (e) => {\n        e.stopPropagation();\n        e.preventDefault();\n        const { showDate } = this.state;\n        this.setState({ showDate: !showDate });\n    }\n\n\tlikeWorkout = async (e) => {\n        const workoutId = parseInt(e.target.closest('.imageContainer').dataset.id, 10);\n\t\tconst { workoutStore } = this.props.stores;\n\n        const { likeWorkout } = this.state;\n        likeWorkout[workoutId] = true;\n        this.setState({ likeWorkout });\n        setTimeout(() => {\n            const { likeWorkout } = this.state;\n            delete likeWorkout[workoutId];\n            this.setState({ likeWorkout });\n        }, 1200);\n\n\t\tconst response = await workoutStore.likeWorkout({ id: workoutId });\n        if (response && response.status === 200) {\n            this.addLikeToFeed(workoutId, response.data);\n\t\t}\n\t}\n\n    addCommentToFeed = ({ type, workout, response, commentId, replyId }) => {\n        // console.log('addCommentToFeed', { workout, response, commentId });\n        const { teamStore } = this.props.stores;\n        switch (type) {\n            case 'likeComment':\n                teamStore.addLikeToComment({ id: workout.id, data: response.data, commentId });\n                break;\n            case 'likeReply':\n                teamStore.addLikeToCommentReply({ id: workout.id, data: response.data, commentId, replyId });\n                break;\n\n            default:\n                if (commentId) {\n                    teamStore.addCommentToWorkoutComment({ id: workout.id, data: response.data, commentId });\n                } else {\n                    teamStore.addCommentToWorkout({ id: workout.id, data: response.data });\n                }\n                break;\n        }\n    }\n\n    addLikeToFeed = (id, data) => {\n        const { teamStore } = this.props.stores;\n        teamStore.addLikeToWorkout({ id, data });\n    }\n\n\ttoggleAddComment = (e) => {\n\t\tconst workoutId = e.target.closest('button').dataset.id;\n\t\tconst { showAddComment } = this.state;\n        if (showAddComment[workoutId]) {\n            delete showAddComment[workoutId];\n        } else {\n            showAddComment[workoutId] = true;\n        }\n\t\tthis.setState({\n\t\t\tshowAddComment,\n\t\t}, () => {\n\t\t\tif (this.inputRef[workoutId]) {\n\t\t\t\tthis.inputRef[workoutId].focus();\n\t\t\t}\n\t\t});\n\t}\n\n    shareLink = (e) => {\n        const { url, title, text } = e.target.closest('button').dataset;\n        const { appState } = this.props.stores;\n        appState.shareUrl({ url, title, text });\n    }\n\n    showWorkoutDetail = (e) => {\n        if (e.target.localName === 'a') {\n            return false;\n        }\n        const target = e.target.closest('#workoutDetail');\n        if (target) {\n            const { id } = target.dataset;\n            if (id) {\n            console.log({ target, id });\n                route(`/workouts/public/${id}`);\n            }\n        }\n    }\n\n    translate = async (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        const { feed = {} } = this.props;\n        const { userStore, teamStore } = this.props.stores;\n        const { user } = userStore;\n        const translatedTextName = await teamStore.translate({ object: feed, user, field: 'name' });\n        let translatedTextComment;\n        if (feed.comment) {\n            translatedTextComment = await teamStore.translate({ object: feed, user, field: 'comment' });\n        }\n        this.setState({ showOriginal: 0, translatedTextName, translatedTextComment });\n    }\n\n    showOriginal = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.setState({ showOriginal: 1 });\n    }\n\n    render() {\n        const { feed, idx, onTeamClick = () => {}, onUserClick = () => {}, onDogClick = () => {} } = this.props;\n        const { showAddComment, showDate, likeWorkout, showOriginal, translatedTextName, translatedTextComment } = this.state;\n        const { teamStore, userStore, appState } = this.props.stores;\n        const { user, isAdmin } = userStore;\n        const { language = 'en' } = user;\n        const { darkmode, hasShareApi } = appState;\n\n        const { publicDogs } = teamStore;\n        const team = teamStore.findPublicTeam(feed.team) || {};\n        const publicUser = teamStore.findPublicUser(feed.user) || {};\n\n        const teamAmbition = userStore.findTeamAmbition({ ambition: team.ambitions, language });\n        const teamType = userStore.findTeamType({ type: team.type, language });\n\n        const isTeamAdmin = (team && team.members) ? team.members.some(m => m === user.id) : false;\n\n        const image = mu.getImage({ user: publicUser, team, object: feed, priority: 'user' });\n\n        const { likes, comments } = feed;\n        const hasLikedWorkout = feed.likes && feed.likes.findIndex(e => e.user === user.id) > -1;\n        const totalFollowers = team && team.followers ? team.followers.length : 0;\n\n        const isYourTeam = team.members && team.members.indexOf(user.id) > -1;\n        const isFollowing = team && team.followers && team.followers.indexOf(user.id) > -1;\n        const hasRequestedFollow = team.followRequests && team.followRequests.findIndex(e => e.id === user.id) > -1;\n        const workoutEquipment = userStore.findEquipment({ equipment: feed.equipment, language });\n        const workoutEquipmentIcon = userStore.findEquipment({ equipment: feed.equipment, field: 'icon' });\n\t\tconst { gpxInfo = {} } = feed;\n\n\n        let shortname;\n        let name;\n        let username;\n        let userLink;\n        if (publicUser) {\n            shortname = mu.displayNameShort(publicUser);\n            name = mu.displayName(publicUser);\n            username = mu.displayName(publicUser);\n            if (publicUser.settings && publicUser.uuidv4 !== user.uuidv4) {\n                userLink = publicUser.settings.hideProfile ? null : `/inbox/${publicUser.uuidv4}`;\n            }\n        }\n\n        const images = [];\n        if (feed.mapImage) {\n            images.push({\n                ...feed.mapImage,\n                type: 'map',\n            });\n        }\n        if (feed.images) {\n            const imgs = toJS(feed.images);\n            images.push(...imgs);\n        }\n\n        const { currentLocationGeocode = {}, yrWeather = [] } = feed;\n        const views = mu.getViews(feed.statistics);\n        const adminData = mu.getAdminData(feed.statistics);\n\n        if (!team || !team.name) {\n            return '';\n        }\n\n        const translationName = mu.getTranslation({\n            object: feed,\n            targetLang: language,\n            field: 'name',\n        }) || translatedTextName;\n        let feedName = translationName || feed.name;\n        const translationComment = mu.getTranslation({\n            object: feed,\n            targetLang: language,\n            field: 'comment',\n        }) || translatedTextComment;\n        let feedComment = translationComment || feed.comment;\n\n        if (showOriginal) {\n            feedName = feed.name;\n            feedComment = feed.comment;\n        }\n\n        return (<>\n            <div class='d-flex position-relative'>\n                <div class='text-center'>\n                    <div\n                        class={`position-relative text-center border rounded-circle imageRounded imageRoundedMedium`}\n                        style={image ? `background-image: url(\"${image}\"); background-size: cover;` : ''}>\n                        {!image && <i class='fas fa-users text-muted mt-2' style='font-size: 20px;' />}\n                    </div>\n                </div>\n                <div class='flex-grow-1 pl-3 text-overflow' style='line-height: 1.2em;'>\n                    <span class='badge badge-pill badge-secondary float-right'>{teamType}</span>\n                    <h5 class='mb-1 position-relative' style='line-height: 1.0em;'>\n                        {team.public ? <>\n                            <a href={`/teams/public/${team.uuidv4}`} onClick={(e) => onTeamClick(e, team.uuidv4)} class='stretched-link'>{team.name}</a>\n                        </> : <>\n                            {team.name}\n                        </>}\n                    </h5>\n                    <div class='mb-2'>\n                        {feed.date && <small class='text-muted' onClick={this.toggleDate}>\n                            {showDate ? util.formatDate(feed.date, { locale: 'no-NB', hour12: false, hour: '2-digit', minute: '2-digit' }) : util.formatDistance(feed.date, new Date(), { locale: 'no-NB' })}\n                        </small>}\n                        {feed.public === 1 ? <>\n                            <small class='ml-2 text-muted'>\n                                <i class='fas fa-globe-europe' />\n                            </small>\n                        </> : <>\n                            <small class='ml-2 text-muted'>\n                                <i class='fas fa-users' /> ({util.format(totalFollowers)})\n                            </small>\n                        </>}\n                        {username && <>\n                            <small class='ml-2 text-muted'>\n                                {userLink ? <>\n                                    <i class='fas fa-user' /> <a href={userLink}>{username}</a>\n                                </> : <>\n                                    <i class='fas fa-user' /> {username}\n                                </>}\n                            </small>\n                        </>}\n                        <small class='text-muted'>\n                            {feed.equipment > 0 && <><i class={`${workoutEquipmentIcon} ml-2`} /> {workoutEquipment}</>}\n                            {/* {feed.distanceKm > 0 && <><i class='fas fa-road ml-2' /> {displayDistance(feed.distanceKm)}km</>}\n                            {feed.elevation > 0 && <><i class='fas fa-mountain ml-2' /> {util.format(feed.elevation, 0)}m</>}\n                            {feed.speedAvg > 0 && <><i class='fas fa-tachometer-alt ml-2' /> {util.format(feed.speedAvg, 1)}km/t</>} */}\n                            {feed.dogs > 0 && <><i class='fas fa-dog ml-2' /> {feed.dogs.length}</>}\n                            {feed.track > 0 && <><i class={`fas fa-map-marked text-${feed.track > 0 ? 'success' : 'danger'} ml-2`} /></>}\n                            {/* {feed.dogsLeft > 0 && <><i class={`fas fa-crosshairs text-${feed.dogsLeft && feed.dogsRight ? 'success' : 'danger'} ml-2`} /></>} */}\n                            {feed.sledWeight > 0 && <>\n                                <i class='fas fa-sleigh ml-2' /> <Weight stores={this.props.stores} value={feed.sledWeight} />\n                            </>}\n                            {feed.temperature !== 0 && <>\n                                <i class='fas fa-temperature-low ml-2' /> <Temperature stores={this.props.stores} value={feed.temperature} />\n                            </>}\n                            {feed.dogs && feed.dogs.length > 0 && <>\n                                <i class='fas fa-dog ml-2' /> {util.format(feed.dogs.length, 0)}\n                            </>}\n                            {/* {feed.kcalBurnedTotal && <><i class='fas fa-balance-scale' /> {util.format(feed.kcalBurnedTotal)} kcal</>}\n                            {feed.kcalMeatGramsTotal && <><i class='fas fa-drumstick-bite ml-2' /> {util.format(feed.kcalMeatGramsTotal / 1000, 1)} kg</>}\n                            {feed.kcalSalmonGramsTotal && <><i class='fas fa-fish ml-2' /> {util.format(feed.kcalSalmonGramsTotal / 1000, 1)} kg</>}\n                            {feed.kcalFatGramsTotal && <><i class='fas fa-piggy-bank ml-2' /> {util.format(feed.kcalFatGramsTotal / 1000, 1)} kg</>} */}\n                            {currentLocationGeocode && currentLocationGeocode.formattedCounty && <>\n                                <i class='fas fa-map-marker-alt ml-2' /> {currentLocationGeocode.formattedCounty}\n                            </>}\n                            {feed.moonIllumination && feed.moonIllumination.phaseIcon && <span class='float-right ml-2'>{feed.moonIllumination.phaseIcon}</span>}\n                        </small>\n                    </div>\n\n                    {isAdmin && <div\n                        class='d-flex flex-row flex-nowrap bg-light border-top border-bottom py-2'\n                        style='overflow: auto;'\n                    >\n                        <small class='text-muted mr-2'>Adm:</small>\n                        {currentLocationGeocode && currentLocationGeocode.formatted_address && <>\n                            <small class='text-muted'>\n                                <i class='fas fa-map-marker-alt' /> {currentLocationGeocode.formatted_address}\n                            </small>\n                        </>}\n                        {publicUser.deviceInfo && <>\n                            <span class='badge badge-secondary ml-1 float-right font-weight-light'>\n                                {['platform', 'manufacturer', 'model'].map(e => <>\n                                    <span class='ml-1 text-white'>\n                                        {publicUser.deviceInfo[e]}\n                                    </span>\n                                </>)}\n                            </span>\n                        </>}\n                        {adminData && <>\n                            {/* {JSON.stringify(adminData)}<br /> */}\n                            <small class='ml-2 text-muted'>\n                                V: {adminData.count}\n                            </small>\n                            <small class='ml-2 text-muted'>\n                                R: {adminData.ranking} {util.isNumber(adminData.rankingTrend) && <><i class={mu.getClassForTrend(adminData.rankingTrend)} /></>}\n                            </small>\n                            <small class='ml-2 text-muted'>\n                                D: {util.format(adminData.durationAvg / 1000, 1)}s {util.isNumber(adminData.durationAvgTrend) && <><i class={mu.getClassForTrend(adminData.durationAvgTrend)} /></>}\n                            </small>\n                            {feed.statisticsCurrent && feed.statisticsCurrent.totalInteractions > 0 && <small class='ml-2 text-muted'>\n                                S: {util.format(feed.statisticsCurrent.totalInteractions, 0)}\n                            </small>}\n                            {feed.shadowTags && feed.shadowTags.map(tag => <>\n                                <span class='badge badge-secondary ml-2 float-right font-weight-light'>{tag}</span>\n                            </>)}\n                        </>}\n                    </div>}\n                </div>\n            </div>\n\n\n            {/* <div class='row'>\n                <div class='row mb-3'>\n                    {feed.gpxInfo && feed.gpxInfo.svgMap && <>\n                        <div class='col-6 mt-auto text-center overflow-hidden'>\n                            <svg viewBox='0 0 300 300' style='width: 150px; height: 150px;'>\n                                <path d={`${feed.gpxInfo.svgMap}`} style='fill: none; stroke: #0275d8; stroke-width: 5; opacity: 0.5;' />\n                            </svg>\n                            <small class='text-muted'>Track</small>\n                        </div>\n                    </>}\n                    {feed.gpxInfo && feed.gpxInfo.svgElevation && <>\n                        <div class='col-6 mt-auto text-center overflow-hidden'>\n                            <svg viewBox='0 0 300 200' style='width: 150px; height: 100px;'>\n                                <path d={`${feed.gpxInfo.svgElevation}`} style='fill: none; stroke: #5cb85c; stroke-width: 5; opacity: 0.5;' />\n                            </svg>\n                            <small class='text-muted'>Elevation</small>\n                        </div>\n                    </>}\n                </div>\n            </div> */}\n\n            <div class='container-fluid px-0 mt-1'>\n                <div class='row'>\n                    <ImageScroller stores={this.props.stores} images={images} id={feed.id} dblClick={this.likeWorkout} likeRef={likeWorkout} />\n                </div>\n            </div>\n\n            {feed.dogs && feed.dogs.length > 0 && <div class='container-fluid px-0 mt-1'>\n                <div class='row pt-2'>\n                    <DogScroller stores={this.props.stores} dogs={feed.dogs} allDogs={publicDogs} onDogClick={onDogClick} />\n                </div>\n            </div>}\n\n            <div class='d-flex justify-content-between bg-light rounded-lg px-2'>\n                {feed.distanceKm > 0 && <div class='mr-2 text-center'>\n                    <div class='text-overflow text-muted'>\n                        <small><i class='fas fa-road' /> <Text id='workout.calendar.distance'>Distanse</Text></small>\n                    </div>\n                    <div class='text-overflow font-weight-light' style='font-size: 1.2em;'>\n                        <Distance stores={this.props.stores} value={feed.distanceKm} />\n                    </div>\n                </div>}\n                {feed.elevation > 0 && <div class='mr-2 text-center'>\n                    <div class='text-overflow text-muted'>\n                        <small><i class='fas fa-mountain' /> <Text id='workout.calendar.ascend'>Høydemeter</Text></small>\n                    </div>\n                    <div class='text-overflow font-weight-light' style='font-size: 1.2em;'>\n                        <Elevation stores={this.props.stores} value={feed.elevation} />\n                    </div>\n                </div>}\n                {feed.duration > 0 && <div class='mr-2 text-center'>\n                    <div class='text-overflow text-muted'>\n                        <small><i class='fas fa-clock' /> <Text id='workout.calendar.duration'>Varighet</Text></small>\n                    </div>\n                    <div class='text-overflow font-weight-light' style='font-size: 1.2em;'>\n                        {util.secToHms(feed.duration, true)}\n                    </div>\n                </div>}\n                {feed.speedAvg > 0 && <div class='text-center'>\n                    <div class='text-overflow text-muted'>\n                        <small><i class='fas fa-tachometer-alt' /> <Text id='workout.calendar.avg-speed'>Snittfart</Text></small>\n                    </div>\n                    <div class='text-overflow font-weight-light' style='font-size: 1.2em;'>\n                        {gpxInfo && gpxInfo.avgGpsMovingSpeed > 0 ? <>\n                            <Speed stores={this.props.stores} value={gpxInfo.avgGpsMovingSpeed * 3.6} />\n                        </> : <>\n                            <Speed stores={this.props.stores} value={feed.speedAvg} />\n                        </>}\n                    </div>\n                </div>}\n            </div>\n\n            <div class='row mt-2'>\n                <div id='workoutDetail' class='clearfix col-12 font-weight-bold' style='font-size: 1.2em;' onClick={this.showWorkoutDetail} data-id={feed.uuidv4}>\n                    <Markdown markdown={mu.replaceImages(feedName, feed.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                </div>\n                <div class='clearfix col-12'>\n                    <Markdown markdown={mu.replaceImages(feedComment, feed.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                </div>\n                {feed.language !== language && <>\n                    {!showOriginal && translationName ? <>\n                        <button type='button' class='btn btn-sm btn-link text-muted' onClick={this.showOriginal}><i class='fas fa-cog' />  <Text id='home.translate-show-original'>Show original</Text></button>\n                    </> : <>\n                        <button type='button' class='btn btn-sm btn-link text-muted' onClick={this.translate}><i class='fas fa-cog' /> <Text id='home.translate-to'>See translation</Text></button>\n                    </>}\n                </>}\n            </div>\n\n            <div class='mt-2'>\n                <LikesAndComments\n                    stores={this.props.stores}\n                    likes={likes}\n                    comments={comments}\n                    type='team'\n                    onTeamClick={onTeamClick}\n                    onUserClick={onUserClick}\n                />\n            </div>\n\n            {!isYourTeam && !isFollowing && !hasRequestedFollow && <div class='clearfix mb-2'>\n                <PublicTeam stores={this.props.stores} team={team} buttonOnly={true} />\n            </div>}\n\n            <div>\n                <div class='row'>\n                    <div class='col text-center'>\n                        <button type='button' class={`imageContainer btn btn-sm btn-outline-${hasLikedWorkout ? 'primary' : 'secondary'} btn-lg btn-block ${hasLikedWorkout ? 'text-primary' : ''} text-overflow`}\n                            data-id={feed.id}\n                            onClick={this.likeWorkout}\n                            // disabled={hasLikedWorkout}\n                        >\n                            <i class={`${hasLikedWorkout ? 'text-primary fas' : 'far'} fa-thumbs-up`} /> <Text id='comments.like'>Lik</Text>\n                        </button>\n                    </div>\n                    <div class='col text-center'>\n                        <button type='button' class='btn btn-sm btn-outline-secondary btn-lg btn-block text-overflow'\n                            data-id={feed.id}\n                            onClick={this.toggleAddComment}\n                        >\n                            <i class='fas fa-comment' /> <Text id='comments.comment-add'>Kommentar</Text>\n                        </button>\n                    </div>\n                    {hasShareApi ? <>\n                        <div class='col text-center'>\n                            <button class='btn btn-sm btn-outline-secondary btn-lg btn-block text-overflow'\n                                onClick={this.shareLink}\n                                data-url={`https://themusher.app/share/workout/${feed.uuidv4}`}\n                                data-title={`title: ${feed.title}`}\n                            >\n                                <i class='fas fa-share' /> <Text id='story.share'>Del</Text>\n                            </button>\n                        </div>\n                    </> : <>\n                        <div class='col text-center'>\n                            <a class='btn btn-sm btn-outline-secondary btn-lg btn-block text-overflow'\n                                href={`https://themusher.app/share/workout/${feed.uuidv4}`}\n                                target='_blank'\n                                rel='noreferrer'\n                                data-native\n                            >\n                                <i class='fas fa-share' /> <Text id='story.share'>Del</Text>\n                            </a>\n                        </div>\n                    </>}\n                </div>\n            </div>\n\n            {views > 0 && <>\n                <div class='mt-2'>\n                    <Views\n                        stores={this.props.stores}\n                        views={views}\n                        object={feed}\n                        type='team'\n                        isTeamAdmin={isTeamAdmin}\n                        isAdmin={isAdmin}\n                        onTeamClick={onTeamClick}\n                        onUserClick={onUserClick}\n                    />\n                </div>\n            </>}\n\n            <div class='mt-2'>\n                {showAddComment[feed.id] && <WorkoutAddComment\n                    stores={this.props.stores}\n                    workout={feed}\n                    inputRef={c => this.inputRef[feed.id] = c}\n                    inputRefObject={this.inputRef}\n                    col='12'\n                    offset='0'\n                    showAvatar={true}\n                    extraClass='px-0'\n                    callback={this.addCommentToFeed}\n                />}\n                <WorkoutComments\n                    stores={this.props.stores}\n                    workout={feed}\n                    col='12'\n                    offset='0'\n                    compact={false}\n                    callback={this.addCommentToFeed}\n                />\n            </div>\n        </>);\n    }\n}\n\nexport default TeamPublicFeedLine;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nimport PublicTeam from '../../components/team/public';\n\nconst initialState = {\n\trequestSent: {},\n};\n\n@observer\nclass Teams extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\tasync loadTeams() {\n\t\tthis.setState({ isLoading: true });\n\t\tconst { teamStore } = this.props.stores;\n\t\tawait teamStore.loadPublic({ query: { notfollowing: 1, array: 1 }, limit: 15 });\n\t\tthis.setState({ isLoading: false });\n\t}\n\n\trequestFollowTeam = (e) => {\n        const { teamStore, userStore } = this.props.stores;\n        const { user } = userStore;\n        const { team } = e.target.closest('button').dataset;\n        teamStore.followRequest(parseInt(team, 10), user);\n\t\tconst { requestSent } = this.state;\n\t\trequestSent[team] = true;\n        this.setState({ requestSent });\n    }\n\n    getButton = (team) => {\n        const { requestSent } = this.state;\n        const { userStore } = this.props.stores;\n        const { user } = userStore;\n        const isYourTeam = team.members && team.members.findIndex(e => e.id === user.id) > -1;\n        const isFollowing = team.followers && team.followers.indexOf(user.id) > -1;\n        const isBlocked = team.blockedFollowers && team.blockedFollowers.indexOf(user.id) > -1;\n        const hasRequestedFollow = requestSent[team.id] || team.followRequests && team.followRequests.findIndex(e => e.id === user.id) > -1;\n\n        if (isYourTeam) {\n            return (\n                <i class='fas fa-home' />\n            );\n        }\n        if (isFollowing) {\n            return (\n                <button\n                    class={`btn btn-sm btn-block btn-outline-secondary float-right`}\n                    onClick={this.unFollowTeam}\n                    disabled='true'\n                    data-team={team.id}\n                >\n                    <i class='fas fa-link mr-2' />\n                    <Text id='teams.connect.is-following'>Følger</Text>\n                </button>\n            );\n        }\n        if (isBlocked) {\n            return (\n                <button\n                    class={`btn btn-sm btn-block btn-outline-secondary float-right`}\n                    disabled='true'\n                >\n                    <i class='fas fa-hand-paper mr-2' />\n                    <Text id='teams.connect.is-blocked'>Blokkert</Text>\n                </button>\n            );\n        }\n        if (hasRequestedFollow) {\n            return (\n                <button\n                    class={`btn btn-sm btn-block btn-outline-secondary float-right`}\n                    disabled='true'\n                >\n                    <i class='fas fa-hourglass-half mr-2' />\n                    <Text id='teams.connect.has-requested'>Venter på godkjenning</Text>\n                </button>\n            );\n        }\n        return (\n            <button\n                class={`btn btn-sm btn-block btn-outline-success float-right`}\n                onClick={this.requestFollowTeam}\n                data-team={team.id}\n            >\n                <i class='far fa-hand-point-right mr-2' />\n                <Text id='teams.connect.follow'>Følg</Text>\n            </button>\n        );\n    }\n\n\tcomponentDidMount() {\n\t\tthis.loadTeams();\n\t}\n\n\trender() {\n\t\tconst { teamStore, appState } = this.props.stores;\n\t\tconst { publicTeamsToFollow } = teamStore;\n        const { darkmode } = appState;\n\t\tif (!publicTeamsToFollow || publicTeamsToFollow.length === 0) {\n\t\t\treturn '';\n\t\t}\n\n\t\treturn (\n\t\t\t<div class='row pb-1 bg-light'>\n                <div class={`col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mb-0 position-relative rounded rounded-lg py-3 bg-${darkmode ? 'black' : 'white'} shadow-sm`}>\n\t\t\t\t\t<div class='container-fluid'>\n\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t<div class='col-12'>\n\t\t\t\t\t\t\t\t<h5><Text id='teams.connect.teams-to-follow'>Team du kan følge</Text>:</h5>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t<div class='d-flex flex-row flex-nowrap' style='overflow: auto;'>\n\t\t\t\t\t\t\t\t{util.isArray(publicTeamsToFollow) && publicTeamsToFollow.map((team) => {\n\t\t\t\t\t\t\t\t\tconst image = team.image && team.image.s3SmallLink ? team.image : null;\n\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t<div class='mr-2' style='width: 110px;'>\n\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\tclass={`text-center border rounded-lg`}\n\t\t\t\t\t\t\t\t\t\t\t\tstyle={image ? `background-image: url(\"${image.s3SmallLink}\"); background-size: cover; width: 110px; height: 100px;` : 'width: 110px; height: 100px;'}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t{!image && <i class='fas fa-users text-muted mt-3' style='font-size: 40px;' />}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<small>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class='text-overflow'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<strong>{team.name}</strong>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class='text-overflow'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{team.place ? `${team.place}, ` : ''} {team.country} &nbsp;\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class='text-overflow'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<small class='text-muted'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{team && team.dogs && <span class=''><i class='fas fa-dog' /> {team.dogs.length}</span>} \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{team && team.followers && <span class='ml-2'><i class='fas fa-user' /> {team.followers.length}</span>}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</small>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</small>\n\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t{this.getButton(team)}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Teams;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport DogSimplePublic from './simplePublic';\n\n@observer\nclass DogScroller extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            imageIdx: 0,\n        };\n    }\n\n    scrollImages = (e) => {\n        const { dogs } = this.props;\n\n        const { scrollLeft, scrollWidth, clientWidth } = e.target;\n        const imageStep = clientWidth;\n        const imageIdx = scrollLeft / imageStep;\n        // console.log({ e, imageStep, imageIdx, scrollLeft, scrollWidth, clientWidth });\n\n        const nearestInt = Math.round(imageIdx);\n        const diff = Math.abs(nearestInt - imageIdx);\n        // console.log({ nearestInt, diff });\n        if (Number.isInteger(imageIdx) || diff < 0.1) {\n            this.setState({\n                imageIdx: nearestInt,\n            });\n        }\n    }\n\n    sortByName = (a, b) => {\n        const { allDogs = [] } = this.props;\n        const dogA = allDogs.find(e => e.id === a);\n        const dogB = allDogs.find(e => e.id === b);\n        if (dogA && dogB) {\n            if (dogA.name > dogB.name) {\n                return 1;\n            }\n        }\n        return -1;\n    }\n\n    render() {\n        const { imageIdx } = this.state;\n        const { dogs, allDogs = [], size = 'medium', onDogClick = () => {} } = this.props;\n\n        return (\n            <div class='w-100'>\n                <div\n                    class='d-flex flex-row flex-nowrap no-scrollbar'\n                    style='overflow: auto; scroll-snap-type: x mandatory;'\n                    onScroll={this.scrollImages}\n                >\n                    {dogs && dogs.sort(this.sortByName).map((dogId, idx) => {\n                        const dog = allDogs.find(e => e.id === dogId);\n                        if (!dog) {\n                            return '';\n                        }\n                        return (\n                            <div class='col clearfix position-relative p-0 mx-2'>\n                                <div\n                                    class={`w-100 h-100 text-center rounded-lg imageContainer d-flex justify-content-center align-items-center`}\n                                    style={`\n                                        flex-wrap: wrap;\n                                        overflow-y: hidden;\n                                    `}\n                                    onTouchstart={(e) => { e.stopPropagation(); }}\n                                    onTouchend={(e) => { e.stopPropagation(); }}\n                                    onTouchmove={(e) => { e.stopPropagation(); }}\n                                >\n                                    <DogSimplePublic\n                                        stores={this.props.stores}\n                                        dog={dog}\n                                        dogs={allDogs.filter(d => dogs.indexOf(d.id) > -1).sort((a, b) => a.name > b.name ? 1 : -1)}\n                                        className='mx-auto'\n                                        showName={true}\n                                        showPosition={false}\n                                        size={size}\n                                        onDogClick={onDogClick} \n                                    />\n                                    {/* <xmp>{JSON.stringify(img, null, 4)}</xmp> */}\n                                </div>\n                            </div>\n                        );\n                    })}\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default DogScroller;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer, withText } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nconst initialState = {\n\tshowAddComment: false,\n};\n\n@withText(() => ({\n    subject: <Text id='ad.subject'>Annonseforespørsel</Text>,\n    body: <Text id='ad.body'>Hei, Jeg ønsker å vite mer om annonsering i appen The Musher.</Text>,\n}))\n\n@observer\nclass Ad extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n        this.updateTimer = {};\n\t\tthis.inputRef = {};\n        this.apiServer = util.getApiServer();\n    }\n\n\tasync loadAd(props = this.props) {\n\t\tthis.setState({ isLoading: true });\n\t\tconst { adStore, workoutStore, userStore, appState } = this.props.stores;\n        const { section } = this.props;\n        const { path: url = '' } = appState;\n        const { currentTeam } = workoutStore;\n        const { user } = userStore;\n        const { language = 'en' } = user;\n        let team = {};\n        let ambitions;\n        let type;\n        let postalcode;\n        let place;\n        let country;\n        if (currentTeam) {\n            team = userStore.findTeam(currentTeam, true);\n            if (team && team.id) {\n                ambitions = userStore.findTeamAmbition({ ambition: team.ambitions, language });\n                type = userStore.findTeamType({ type: team.type, language });\n                postalcode = team.postalcode;\n                place = team.place;\n                country = team.country;\n            }\n        }\n        // console.log({ currentTeam, team, ambitions,  type, postalcode, place, country });\n        // const { url = '' } = this.props;\n        const page = url.replace(/\\d+$/, 'detail');\n\n        // props: { \"url\": \"/\" }\n        // props: { \"url\": \"/workouts/\" }\n        // props: { \"url\": \"/workouts/4708\" }\n        // props: { \"url\": \"/dogs\" }\n        // props: { \"url\": \"/dogs/10\" }\n\n\t\tawait adStore.load({ query: { page, section }});\n        adStore.setTime();\n\t\tthis.setState({ isLoading: false });\n\t}\n\n    logClick = async () => {\n        const { adStore, userStore } = this.props.stores;\n        const { ads = [] } = adStore;\n        let id = ads.length > 0 ? ads[0].id : null;\n        const { user = {} } = userStore;\n        await adStore.logClick({ id, user: user.id });\n    }\n\n\tcomponentDidMount() {\n\t\tthis.loadAd();\n\t}\n\n    componentWillReceiveProps(nextProps) {\n        // console.log('componentWillReceiveProps', nextProps);\n        if (nextProps.path !== this.props.path) {\n            this.loadAd(nextProps);\n        }\n    }\n\n    render() {\n        const { adStore, userStore, appState } = this.props.stores;\n        const { subject, body, section } = this.props;\n        const { path } = appState;\n        const { user = {} } = userStore;\n        const { ads = [], time, adViews, adClicks } = adStore;\n        if (!user || !user.id || !ads || ads.length === 0) {\n            if (path.match(/\\/(home)/i)) {\n                return <>\n                    <div class='w-100'>\n                        <div class='row'>\n                            <div class='col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mb-0 position-relative'>\n                                <div class='border rounded-lg p-4 my-3'>\n                                    <span class='float-right display-4 text-warning'>\n                                        <i class='far fa-smile-wink' />\n                                    </span>\n                                    <h5><Text id='ad.heading'>Vil du annonsere her?</Text></h5>\n                                    <div><Text id='ad.teaser'>Det er super enkelt :)</Text></div>\n                                    <Localizer>\n                                        <a href={`mailto:post@themusher.no?subject=${subject}: ${path}: ${section}&body=${body}`} target='_blank' rel='noreferrer'>\n                                            <i class='fas fa-paper-plane' /> <Text id='ad.linktext'>Ta kontakt med The Musher</Text>\n                                        </a>\n                                    </Localizer>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </>;\n            }\n            return <></>;\n        }\n        const ad = ads[0];\n        return (\n            <>\n                <div class='w-100'>\n                    <div class='row'>\n                        <div class='col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mb-0 position-relative'>\n                            <div>\n                                <small><small class='text-muted'>\n                                    <Text id='ad.ad'>Annonse</Text>:\n                                    <img src={`${this.apiServer}/api/ads/${ad.id}/view?user=${user.id}&time=${time}`} style='width: 1; height: 1; opacity: 0.1;' />\n                                </small></small>\n                            </div>\n                            {ad.target ? <>\n                                <a\n                                    class='stretched-link'\n                                    href={`${ad.url}`}\n                                    target={ad.target || '_blank'}\n                                    rel='noopener noreferrer'\n                                    onClick={this.logClick}\n                                    native\n                                >\n                                    {ad.images && ad.images[0] && <>\n                                        <img src={ad.images[0].s3LargeLink} class='img-fluid rounded-lg' />\n                                    </>}\n                                </a>                            \n                            </> : <>\n                                <a\n                                    class='stretched-link'\n                                    href={`${ad.url}`}\n                                    onClick={this.logClick}\n                                >\n                                    {ad.images && ad.images[0] && <>\n                                        <img src={ad.images[0].s3LargeLink} class='img-fluid rounded-lg' />\n                                    </>}\n                                </a>\n                            </>}\n                        </div>\n                    </div>\n                </div>\n            </>\n        );\n    }\n}\n\nexport default Ad;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport TeamConnectBoxes from '../../components/team/connect-boxes';\nimport TeamConnectConfirm from '../../components/team/connect-confirm';\n\nimport Ad from '../../components/ad/';\n\nimport FastList from '../../components/team/fastList';\n\nimport Overlay from '../../components/overlay/';\nimport TeamsPublicDetail from '../../routes/teams/publicDetail';\nimport DogPublicDetail from '../../routes/dogs/publicDetail';\n\nimport TeamPublicFeedLine from '../../components/team/publicFeedLine';\n\nimport mu from '../../lib/musher-util';\n\nconst MARGIN_TOP = mu.marginTop(false);\nconst MARGIN_TOP_BACK = mu.marginTopBack(false);\nconst MARGIN_BOTTOM = mu.marginBottom();\n\nconst initialState = {\n\tshowAddComment: {},\n    // viewImageIdx: {},\n    likeWorkout: {},\n    hasFollowSugguestions: false, \n    hasAd: false,\n    sessionid: new Date().getTime(),\n};\n\nconst dataFields = ['id', 'type', 'user', 'team', 'title'];\n\n@observer\nclass WorkoutPublicDetail extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n    async loadPublicWorkouit({ props = this.props }) {\n\t\tconst { teamStore } = props.stores;\n        const { workout: workoutid } = props;\n\t\tawait teamStore.loadPublicFeed({ workoutid });\n\t}\n\n    // Overlay functions\n    onTeamClick = (e, teamid) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.setState({\n            showTeam: teamid,\n        });\n        return false;\n    }\n\n    hideTeam = () => {\n        this.setState({\n            showTeam: null,\n        });\n    }\n\n    onUserClick = (e, userid) => {\n        e.preventDefault();\n        e.stopPropagation();\n        return false;\n    }\n\n    onDogClick = (e, dogid, dogs) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.setState({\n            showDog: dogid,\n            dogs,\n        });\n        return false;\n    }\n\n    hideDog = () => {\n        this.setState({\n            showDog: null,\n        });\n    }\n    // /Overlay functions\n\n    componentWillUnmount() {\n        const { teamStore } = this.props.stores;\n        // teamStore.cleanupMemory();\n    }\n\n\tcomponentDidMount() {\n        this.loadPublicWorkouit(this.props);\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {\n        // console.log('componentWillReceiveProps', nextProps.viewmenu, this.props.viewmenu);\n        if (nextProps.workoutid !== this.props.workoutid) {\n            this.loadPublicWorkouit(nextProps);\n        }\n    }\n\n    renderContent = ({ obj, idx }) => {\n        const { appState } = this.props.stores;\n        const { path } = appState;\n\n        if (obj.type === 'ad') {\n            return(<>\n                <Ad stores={this.props.stores} path={path} />\n            </>);\n        }\n        if (obj.type === 'teamConfirm') {\n            return(<>\n                <TeamConnectConfirm stores={this.props.stores} />\n            </>);\n        }\n        if (obj.type === 'teamSuggestions') {\n            return(<>\n                <TeamConnectBoxes stores={this.props.stores} />\n            </>);\n        }\n        return (<>\n            <TeamPublicFeedLine\n                stores={this.props.stores}\n                feed={obj}\n                idx={idx}\n                onTeamClick={this.onTeamClick}\n                onUserClick={this.onUserClick}\n                onDogClick={this.onDogClick}\n            />\n        </>);\n    }\n\n    back = () => {\n        const { history } = this.props.stores;\n        history.goBack();\n    }\n\n    render() {\n        const { showTeam, showDog, handleIntersection, sessionid, dogs } = this.state;\n        const { teamStore, appState } = this.props.stores;\n        const { publicTeamsFeed } = teamStore;\n        const { path, darkmode } = appState;\n        const { teamid } = this.props;\n        const team = teamStore.findPublicTeamByUuidv4(teamid);\n        \n        const image = mu.getImage({ team });\n        let shortname;\n        let name;\n        let username;\n        if (team && team.name) {\n            shortname = mu.displayNameShort(team);\n            name = mu.displayName(team);\n        }\n\n\n        return (<>\n            {showTeam && <Overlay>\n                <TeamsPublicDetail stores={this.props.stores} teamid={showTeam} marginTop={'0px;'} marginBottom={'0px;'} back={this.hideTeam} hideTeam={this.hideTeam} />\n            </Overlay>}\n\n            {showDog && <Overlay>\n                <DogPublicDetail stores={this.props.stores} dogid={showDog} marginTop={'0px;'} marginBottom={'0px;'} back={this.hideDog} dogs={dogs} />\n            </Overlay>}\n\n\t\t\t<div class='container-fluid' style={`margin-bottom: ${MARGIN_BOTTOM}; margin-top: ${MARGIN_TOP};`}>\n                <div class='d-flex justify-content-between mb-2'>\n                    <div>\n\t\t\t\t\t\t<button class='btn btn-link float-left pl-0 fixed-top'\n                            style={`top: ${MARGIN_TOP_BACK}; left: 5px; font-size: 35px; width: 45px;`}\n\t\t\t\t\t\t\tonClick={this.back}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<i class='fas fa-arrow-circle-left' />\n\t\t\t\t\t\t</button>\n                    </div>\n                    <div>\n                        <h5 class='text-muted'>&nbsp;</h5>\n                    </div>\n                </div>\n\n                <div class='w-100'>\n                    {team ? <>\n                        <div class='row pb-3 pt-3'>\n                            <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 border-bottom'>\n                                <div class='row'>\n                                    <h3>\n                                        <div class='d-flex position-relative'>\n                                            <div\n                                                class={`text-center border rounded-circle imageRounded imageRoundedSmall`}\n                                                style={image ? `background-image: url(\"${image}\"); background-size: cover;` : ''}\n                                            >\n                                                {!image && <div class='text-muted' style='font-size: 20px; padding-top: 3px;'>{shortname}</div>}\n                                            </div>\n                                            <div class='flex-grow-1 pl-3 text-overflow' style='line-height: 1.2em;'>\n                                                <h3 class='mb-1'>\n                                                    {team.public ? <>\n                                                        <a href={`/teams/public/${team.uuidv4}`} class='stretched-link'>{name}</a>\n                                                    </> : <>\n                                                        {name}\n                                                    </>}\n                                                </h3>\n                                            </div>\n                                        </div>\n                                    </h3>\n                                </div>\n                            </div>\n                        </div>\n                    </> : <>\n                        <TeamConnectConfirm stores={this.props.stores} />\n                    </>}\n\n                    {(!publicTeamsFeed || publicTeamsFeed.length === 0) && <>\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 px-0'>\n                            <div class='text-center text-muted'>\n                                <div class='display-1'><i class='fas fa-chart-area' /></div>\n                                <h3><Text id='search.no-workouts-found'>No workouts found.</Text></h3>\n                                <Text id='teams.no-public-workouts-text'>Please follow more teams to see their workout activity on this page. This is a great way to get updates from all your favorite mushers.</Text>\n                            </div>\n                            <div class='text-center mt-3'>\n                                <a href='/teams/connect' class='btn btn-primary'>\n                                    <i class='fas fa-users' /> <Text id='header.connect-team'>Follow teams</Text>\n                                </a>\n                            </div>\n                        </div>\n                    </>}\n\n                    <FastList\n                        data={publicTeamsFeed}\n                        wrapperClassNames={'row pb-4'}\n                        contentClassNames={`col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 my-1 position-relative rounded rounded-lg py-3 bg-${darkmode ? 'black' : 'white'} shadow-sm`}\n                        renderContent={this.renderContent}\n                        dataFields={dataFields}\n                        dataValues={{ type: '10' }}\n                        handleIntersection={handleIntersection}\n                        sessionid={sessionid}\n                    />\n\n                </div>\n            </div>\n        </>);\n    }\n}\n\nexport default WorkoutPublicDetail;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nimport PublicTeam from '../../components/team/public';\n\nconst initialState = {\n\tconfirmed: {},\n\tdeleted: {},\n};\n\n@observer\nclass Teams extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n    async loadTeams() {\n        const { teamStore } = this.props.stores;\n        await teamStore.load({ query: {}, addData: ['followRequests'] });\n    }\n\n    confirmRequest = (e) => {\n        const { team, user, follow } = e.target.closest('button').dataset;\n        const { teamStore } = this.props.stores;\n        teamStore.confirmFollowRequest({\n            team: parseInt(team, 10),\n            user: parseInt(user, 10),\n        });\n        const { confirmed } = this.state;\n\t\tconfirmed[`${team}-${user}`] = true;\n        this.setState({ confirmed });\n\n        if (follow) {\n            teamStore.followRequestUser(user);\n        }\n    }\n\n    deleteRequest = (e) => {\n        const { team, user } = e.target.closest('button').dataset;\n        const { teamStore } = this.props.stores;\n        teamStore.deleteFollowRequest({\n            team: parseInt(team, 10),\n            user: parseInt(user, 10),\n        });\n        const { deleted } = this.state;\n\t\tdeleted[`${team}-${user}`] = true;\n        this.setState({ deleted });\n    }\n\n\tcomponentDidMount() {\n\t\tthis.loadTeams();\n\t}\n\n\trender() {\n        const { deleted = {}, confirmed = {} } = this.state;\n\t\tconst { teamStore, appState } = this.props.stores;\n\t\tconst { teams, hasFollowRequests, followRequests = [] } = teamStore;\n        const { darkmode } = appState;\n\t\tif (!hasFollowRequests) {\n\t\t\treturn '';\n\t\t}\n\n\t\treturn (\n            <div class='row pb-1'>\n                <div class={`col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mb-0 position-relative rounded rounded-lg py-3 bg-${darkmode ? 'black' : 'white'} shadow-sm`}>\n                    <div class='container-fluid'>\n                        <div class='row'>\n                            <div class='col-12'>\n                                <h5><Text id='teams.connect.teams-follow-requests'>Forespørsel om å følge</Text>:</h5>\n                            </div>\n                        </div>\n\t\t\t\t\t\t<div class='row'>\n                            <div class='d-flex flex-row flex-nowrap' style='overflow: auto;'>\n                                {util.isArray(teams) && teams.map((team) => <>\n                                    {team && util.isArray(team.followRequests) && team.followRequests.map((reqUser) => {\n                                        const image = reqUser.image && reqUser.image.s3SmallLink ? reqUser.image : null;\n                                        const isDeleted = deleted[`${team.id}-${reqUser.id}`];\n                                        const isConfirmed = confirmed[`${team.id}-${reqUser.id}`];\n                                        const publicTeam = followRequests.find(e => e.user.id === reqUser.id);\n                                        return (\n                                            <div class='mr-2 py-2 border rounded-lg' style='width: 150px;'>\n                                                <div class={`text-center border rounded-circle imageRounded imageRoundedSmall mx-auto`} style={image ? `background-image: url(\"${image.s3SmallLink}\");` : ''}>\n                                                    {!image && <div class='text-muted font-weight-lighter' style='font-size: 20px; padding-top: 5px;'>{mu.displayNameShort(reqUser)}</div>}\n                                                </div>\n                                                <small>\n                                                    <div class='text-overflow text-center'>\n                                                        <strong>{mu.displayName(reqUser)}</strong><br />\n                                                        {/* {publicTeam && publicTeam.public > 0 ? <>\n                                                            <a href={`/teams/public/${publicTeam.uuidv4}`}>{publicTeam.name}</a>\n                                                        </> : <>\n                                                            {publicTeam ? <>{publicTeam.name}</> : ''}<br />\n                                                            <span class='text-muted'>(<Text id='teams.not-public'>Not public</Text>)</span>\n                                                        </>} */}\n                                                    </div>\n                                                    <div class='text-overflow text-center'>\n                                                        <Text id='teams.connect.wants-to-follow'>wants to follow your team:</Text>\n                                                    </div>\n                                                    <div class='text-overflow text-center'>\n                                                        <strong>{mu.displayName(team)}</strong>\n                                                    </div>\n                                                </small>\n                                                {(isConfirmed || isDeleted) ? <>\n                                                    <div class='text-center'>\n                                                        {isConfirmed ? <div class='text-success'>\n                                                            <Text id='teams.connect.confirmed'>Confirmed</Text> <i class='fas fa-check' />\n                                                        </div> : <div class='text-danger'>\n                                                            <Text id='teams.connect.deleted'>Deleted</Text> <i class='fas fa-trash-alt' />\n                                                        </div>}\n                                                    </div>\n                                                </> : <>                                    \n                                                    <div>\n                                                        <button class='btn btn-sm btn-block btn-success text-overflow mt-1' onClick={this.confirmRequest} data-team={team.id} data-user={reqUser.id}>\n                                                            <Text id='teams.connect.confirm'>Confirm</Text>\n                                                        </button>\n                                                        {publicTeam && publicTeam.public > 0 && <button class='btn btn-sm btn-block btn-outline-success text-overflow mt-1' onClick={this.confirmRequest} data-team={team.id} data-user={reqUser.id} data-follow={true}>\n                                                            <Text id='teams.connect.confirm-and-follow'>Confirm & follow back</Text>\n                                                        </button>}\n                                                        <div class='mt-3'>\n                                                            <small>\n                                                                <button class='btn btn-sm btn-block btn-link text-overflow' style='font-size: 1.0em;' onClick={this.deleteRequest} data-team={team.id} data-user={reqUser.id}>\n                                                                    <Text id='teams.connect.delete'>Del</Text>\n                                                                </button>\n                                                            </small>\n                                                        </div>\n                                                    </div>\n                                                </>}\n                                            </div>\n                                        );\n                                    })}\n                                </>)}\n                            </div>\n                        </div>\n                        <details class='mt-3'>\n                            <summary><small><Text id='teams.connect.how-summary'>How does this work?</Text></small></summary>\n                            <p>\n                                <Text id='teams.connect.how-text'>What can followers see when I grant them access to follow? The answer is very little. They can see main details of the workouts you share and name of the dogs. That's all. Try to follow a team and check out the workout tab.</Text>\n                            </p>\n                        </details>\n                    </div>\n                </div>\n            </div>\n\t\t);\n\t}\n}\n\nexport default Teams;\n","import { h, Component } from 'preact';\nimport { observer } from 'mobx-preact';\nimport util from 'preact-util';\n\n// TODO: Do we need mobx? What is mobx doing here?  \n\n@observer\nclass FastListLine extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {};\n        this.containerRef = null;\n    }\n\n    componentWillUnmount() {\n        const { removeIntersectionObserver } = this.props;\n        if (removeIntersectionObserver) {\n            removeIntersectionObserver(this.containerRef);\n        }\n    }\n\n    componentDidMount() {\n        const { addIntersectionObserver } = this.props;\n        if (addIntersectionObserver) {\n            addIntersectionObserver(this.containerRef);\n        }\n    }\n\n    render() {\n        const {\n            wrapperClassNames = '',\n            contentClassNames = '',\n            renderContent,\n            obj = {},\n            idx,\n            dataFields,\n            dataValues,\n            sessionid,\n        } = this.props;\n\n        const dataProperties = {};\n        if (sessionid) {\n            dataProperties.sessionid = sessionid;\n        }\n        dataFields.forEach(e => dataProperties[`data-${e}`] = encodeURI(dataValues[e] || obj[e]));\n\n        return (\n            <div\n                class={`${wrapperClassNames}`}\n                ref={c => this.containerRef = c}\n                data-idx={idx}\n                {...dataProperties}\n            >\n                <div\n                    class={`${contentClassNames}`}\n                    style={`display: block;`}\n                >\n                    {renderContent({\n                        obj,\n                        idx,\n                    })}\n                </div>\n            </div>\n        );\n    }\n}\n\n@observer\nclass FastList extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {};\n    }\n\n    // IntersectionObserver\n    deleteIntersectionObserver = () => {\n        this.intersectionObserver = null;\n    }\n\n    handleIntersection = (entries) => {\n        const { handleIntersection } = this.props;\n        if (typeof(handleIntersection) === 'function') {\n            // console.log('handleIntersection');\n            handleIntersection(entries);\n        }\n        // console.log({ entries });\n        // TODO: Make it possible to run defined functions for entries.\n        // mu.intersectionObserverCallback(entries);\n        entries.forEach((e) => {\n            const { isIntersecting } = e;\n            const { height = 0 } = e.target.dataset;\n            // const childHeight = e.target.childNodes[0].getBoundingClientRect().height;\n            // const targetHeight = e.target.getBoundingClientRect().height;\n            const childHeight = e.target.childNodes[0].offsetHeight;\n            const targetHeight = e.target.offsetHeight;\n            const scrollHeight = e.target.scrollHeight;\n            const currentHeight = Math.max(childHeight, targetHeight, scrollHeight);\n            // console.log({ isIntersecting, height, childHeight, targetHeight, scrollHeight, currentHeight }, e.target);\n\n            if (isIntersecting) {\n                e.target.childNodes[0].style.display=`block`;\n                // TODO: Should be set after image is loaded.\n                // const height = e.target.childNodes[0].clientHeight > e.target.clientHeight ? e.target.childNodes[0].clientHeight : e.target.clientHeight;\n                // console.log(e.target);\n                // console.log('e.target.childNodes[0].offsetHeight:', e.target.childNodes[0].offsetHeight);\n                // console.log('e.target.childNodes[0].scrollHeight:', e.target.childNodes[0].scrollHeight);\n                // console.log('e.target.childNodes[0].clientHeight:', e.target.childNodes[0].clientHeight);\n                // console.log('e.target.offsetHeight:', e.target.offsetHeight);\n                // console.log('e.target.scrollHeight:', e.target.scrollHeight);\n                // console.log('e.target.clientHeight:', e.target.clientHeight);\n                // console.log('height:', height);\n                // e.target.style.height=`${height}px`;\n                e.target.style.minHeight = `${currentHeight > height ? currentHeight : height}px`;\n            } else if (e.target.style.minHeight) {\n                // e.target.style.height = `${currentHeight > height ? currentHeight : height}px`;\n                e.target.style.minHeight = `${currentHeight > height ? currentHeight : height}px`;\n                e.target.childNodes[0].style.display=`none`;\n            }\n        });\n    }\n\n    setupIntersectionObserver = () => {\n        if (!('IntersectionObserver' in window) ||\n            !('IntersectionObserverEntry' in window) ||\n            !('intersectionRatio' in window.IntersectionObserverEntry.prototype)) {\n            return false;\n        }\n\n        const options = {\n            root: null,\n            rootMargin: '100px',\n            threshold: 0.1,\n        };\n        this.intersectionObserver = new IntersectionObserver(this.handleIntersection, options);\n    }\n\n    addIntersectionObserver = (ref) => {\n        if (this.intersectionObserver && ref) {\n            this.intersectionObserver.observe(ref);\n        }\n    }\n    removeIntersectionObserver = (ref) => {\n        if (this.intersectionObserver && ref) {\n            this.intersectionObserver.unobserve(ref);\n        }\n    }\n\n    componentWillMount() {\n        this.setupIntersectionObserver();\n    }\n\n    componentWillUnmount() {\n        this.deleteIntersectionObserver();\n    }\n\n    render() {\n        const {\n            data = [],\n            wrapperClassNames = 'row pb-4 bg-light',\n            contentClassNames = `col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mb-0 position-relative rounded rounded-lg py-3 shadow-sm`,\n            renderContent = (e) => <>Missing render function!</>,\n            dataFields = [],\n            dataValues = {},\n        } = this.props;\n        \n        return (\n            <div class='w-100'>\n                {data && data.filter(e => util.isObject(e)).map((obj, idx) => {\n                    const wrapperClasses = obj.hasOwnProperty('wrapperClassNames') ? obj.wrapperClassNames : wrapperClassNames;\n                    const contentClasses = obj.hasOwnProperty('contentClassNames') ? obj.contentClassNames : contentClassNames;\n                    return (<>\n                        <FastListLine\n                            key={`fastline-${idx}-${obj.id}`}\n                            obj={obj}\n                            idx={idx}\n                            addIntersectionObserver={this.addIntersectionObserver}\n                            removeIntersectionObserver={this.removeIntersectionObserver}\n                            wrapperClassNames={wrapperClasses}\n                            contentClassNames={contentClasses}\n                            renderContent={renderContent}\n                            dataFields={dataFields}\n                            dataValues={dataValues}\n                        />\n                    </>);\n                })}\n            </div>\n        );\n    };\n}\n\nexport default FastList;\n"],"sourceRoot":""}