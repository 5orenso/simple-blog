{"version":3,"sources":["webpack:///./components/public/heatmap.js","webpack:///./components/login/loginForm.js","webpack:///./routes/public/race/submenu.js","webpack:///./routes/public/race/commentAdd.js","webpack:///./routes/public/race/style.css","webpack:///./routes/public/race/header.js","webpack:///./routes/public/race/commentReply.js","webpack:///./routes/public/race/comments.js","webpack:///./routes/public/race/raceText.js","webpack:///./routes/public/race/detail-signup.js","webpack:///./components/form/images.js","webpack:///./routes/public/race/detail.js","webpack:///./components/form/dragNdropFileupload.js"],"names":["initialState","showAddComment","Heatmap","observer","props","state","updateTimer","inputRef","loadHeatmap","this","setState","isLoading","stores","adminStore","getPublicHeatmap","raceid","componentDidMount","render","waypoints","zoomToMarkers","mapid","fullscreenMap","heatmap","publicHeatmap","mapId","length","minZoom","maxZoom","height","key","Component","Login","handleEmailInput","e","userStore","email","target","value","clearTimeout","checkEmailTimer","setTimeout","checkEmail","togglePassword","passwordType","updateCapsLockStatus","isCapsLock","login","routeLoginOk","appState","language","checkLogin","password","token","sendPubSubMessage","getInfo","route","resetLoginMessages","newUser","routeLoginNew","forgotten","routeLoginForgot","changeLanguage","setLanguage","validateLoginToken","response","loginToken","status","showToken","util","isString","darkmode","emailIsAvailable","twoFactorLogin","message","messageIcon","error","errorIcon","isValidEmail","validateEmail","isOkToLogin","class","src","id","icon","remove","for","type","onInput","onKeypress","style","linkState","onClick","role","disabled","mu","marginTop","marginBottom","subMenuMarginTop","submenu","jwtToken","getJwtToken","PublicRaceDetail","path","currentMenu","match","href","RaceAdd","beforeImagesUploaded","sendButtonEnabled","afterImagesUploaded","commentRace","callback","inputRefObject","race","raceStore","comment","showAddImage","body","images","resizeTextarea","addImage","addImages","push","handleImageErrored","image","onerror","Date","user","displayNameShort","userImage","displayName","undefined","s3SmallLink","placeholder","onKeyUp","onFocus","ref","data-id","isArray","map","img","onError","removeImage","data-name","name","object","updateField","before","after","autoOpen","module","exports","menu","profile","main","searchText","Navigation","toggleDropdown","menuName","dataset","parentNode","toggleDarkmode","toggleViewmode","mode","reloadApp","window","location","reload","adminLoadAll","lang","console","log","search","notifications","filter","read","className","activeClassName","selected","RaceCommentReply","commentReplyRace","commentId","showAllComments","showAllReplies","viewImageIdx","likeComment","likeReply","showOriginal","RaceComments","addLikeComment","closest","likeRaceComment","replyId","likeRaceCommentReply","replyComment","parentElement","focus","toggleComments","toggleReplies","toggleMenu","showMenu","showDeleteComment","showEdit","toggleEdit","commentEditText","toggleDeleteComment","deleteComment","deleteCommentRace","deleteCommentReply","deleteCommentReplyRace","commentid","saveComment","editCommentRace","saveCommentReply","editCommentReplyRace","viewImage","idx","translate","translatedText","preventDefault","stopPropagation","replyid","translateCommentReply","translateComment","initCall","col","offset","compact","currentUser","filteredComments","totalComments","diplayedComments","comments","slice","Math","max","reverse","teams","findPublicTeamByMembers","hasLikedComment","likes","findIndex","filteredReplises","totalReplies","diplayedReplies","max_comments","imgs","toJS","imageIdx","currentImage","translation","getCommentTranslations","targetLang","data-comment","uuidv4","public","t","markdown","replaceImages","markdownOpts","getMarkdownOptions","onDblclick","loading","s3LargeLink","data-idx","data-commentid","formatDistance","createdDate","locale","updatedDate","reply","hasLikedReply","replyTranslation","getCommentReplyTranslations","replyBody","data-replyid","fields","more","c","text","finalText","regex","RegExp","replace","showSignup","PublicRaceDetailSignup","signupToRace","signup","team","firstname","lastname","sportsClub","cellphone","facebook","instagram","newSignup","addContestant","classId","newContestant","addSignup","toggleShowSignup","updateSignup","updateObjectKeyValue","editSignup","field","data","raceClassId","classid","contestantId","contestantid","ucfirst","editClass","hide","subsection","signups","today","hasSignedup","skipTeams","parseInt","title","signupStartDate","formatDate","hour12","hour","minute","signupEndDate","signupClass","getRaceClassById","liveRace","signuppayment","paidSignupfee","signupfee","data-classid","data-contestantid","aria-describedby","indexOf","classes","sort","a","b","distance","currentClass","rules","checked","termsAndAgreement","declaration","routeLogin","skipPubSub","Images","handleAddImage","file","addToImages","skipTimer","files","uploadStatus","apiUrl","width","MARGIN_TOP","MARGIN_BOTTOM","newRaceArticle","newRaceUserImage","likeRace","toggleAddComment","raceId","addRaceArticle","addArticle","newArticle","addRaceUserImage","addUserImage","newUserImage","updateUserImageUpload","updateArticleUpload","removeRaceArticle","removeArticle","articleId","removeRaceUserImage","removeUserImage","userImageId","editRaceArticle","raceArticleId","editArticle","editRaceUserImage","raceUserImageId","editUserImage","resizeAllTextareas","textareaList","document","getElementsByTagName","i","l","el","element","scrollHeight","loadRace","load","countAll","resetSignup","contestants","updateKeyValue","componentWillReceiveProps","nextProps","isAdmin","section","totalClasses","totalContestants","hasLikedRace","startDate","endDate","s3XXLargeLink","active","useEffect","tag","split","rel","native","contactEmail","locationCity","locationCountry","veterinaryInfo","checkpoints","trailDescription","program","prices","articles","currentArticle","date","ingress","startTime","endTime","cols","data-field","linkstate","saved","userImages","currentUserImage","DragNDropFileupload","dropRef","createRef","handleDrag","handleDragIn","dragCounter","dataTransfer","items","drag","handleDragOut","handleDrop","readLocalFile","handleAddFiles","event","handleEvent","handleUpload","fileObject","isFunction","formData","FormData","append","uploadMeta","progress","xhr","XMLHttpRequest","upload","addEventListener","updateProgress","fileObj","uploadDone","open","getApiServer","setRequestHeader","send","filename","uploadedFilesData","imageNum","Promise","resolve","reject","reader","FileReader","photo","readAsDataURL","lengthComputable","percentComplete","loaded","total","readyState","JSON","parse","responseText","addFileToUpload","fileInput","loadingProgress","uploadedFiles","div","current","click","componentWillUnmount","removeEventListener","position","border","backgroundColor","top","bottom","left","right","zIndex","textAlign","color","fontSize","multiple","onchange","Object","keys","isImage","result","formatBytes","aria-valuenow","aria-valuemin","aria-valuemax","children"],"mappings":"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","file":"45.chunk.7a4df.js","sourcesContent":["import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport { toJS } from 'mobx'\n\nimport Map from '../../components/map';\n\nimport mu from '../../lib/musher-util';\n\nconst initialState = {\n\tshowAddComment: false,\n};\n\n@observer\nclass Heatmap extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n        this.updateTimer = {};\n\t\tthis.inputRef = {};\n    }\n\n\tasync loadHeatmap() {\n\t\tthis.setState({ isLoading: true });\n\t\tconst { adminStore } = this.props.stores;\n        const { raceid } = this.props;\n        await adminStore.getPublicHeatmap(raceid);\n\t\tthis.setState({ isLoading: false });\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.loadHeatmap();\n\t}\n\n    // componentWillReceiveProps() {\n\t// \tthis.loadHeatmap();\n\t// }\n\n    render() {\n        const { adminStore } = this.props.stores;\n        const { waypoints, zoomToMarkers, mapid, fullscreenMap } = this.props;\n        const { publicHeatmap: heatmap } = adminStore;\n        // const heatmap = publicHeatmap.slice(0, 10);\n        // const heatmap = [[60.4433,8.8996,14],[61.384,9.1152,14],[60.42,8.9422,15]];\n\n        return (\n            <>\n                {/* heatmap: {`map-${mapid}`}<br /> */}\n                {/* {JSON.stringify(heatmap)} */}\n                <Map\n                    stores={this.props.stores}\n                    mapId={heatmap.length}\n                    heatmap={heatmap}\n                    minZoom={2}\n                    maxZoom={18}\n                    height={600}\n                    waypoints={waypoints}\n                    zoomToMarkers={zoomToMarkers}\n                    fullscreenMap={fullscreenMap}\n                    key={`map-${mapid}`}\n                />\n            </>\n        );\n    }\n}\n\nexport default Heatmap;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { route } from 'preact-router';\nimport linkState from 'linkstate';\nimport { Text, Localizer, withText } from 'preact-i18n';\n\nimport Error from '../error';\nimport Message from '../message';\nimport Install from '../install';\n\n@observer\nclass Login extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            showToken: false,\n            isCapsLock: false,\n            passwordType: 'password',\n            email: this.props.email,\n        };\n    }\n\n    handleEmailInput = async (e) => {\n        const { userStore } = this.props.stores;\n        const email = e.target.value;\n        this.setState({ email });\n        clearTimeout(this.checkEmailTimer);\n        this.checkEmailTimer = setTimeout(() => userStore.checkEmail(email), 1000);\n    }\n\n    togglePassword = () => {\n        let { passwordType } = this.state;\n        if (passwordType === 'password') {\n            passwordType = 'text';\n        } else {\n            passwordType = 'password';\n        }\n        this.setState({ passwordType });\n    }\n\n    updateCapsLockStatus = (isCapsLock) => {\n        this.setState({\n            isCapsLock,\n        });\n    }\n\n    login = async () => {\n        const { routeLoginOk = '/' } = this.props;\n        const { email, password, token } = this.state;\n        const { userStore, appState } = this.props.stores;\n        const { language = 'en' } = appState;\n        const sendPubSubMessage = false;\n        const loginOk = await userStore.checkLogin({ email, password, token, sendPubSubMessage, language });\n        if (loginOk) {\n            await userStore.getInfo();\n            route(routeLoginOk);\n        }\n    }\n\n    resetLoginMessages = () => {\n        const { userStore } = this.props.stores;\n        userStore.resetLoginMessages();\n    }\n\n    newUser = () => {\n        const { email = '' } = this.state;\n        const { routeLoginNew = `/register/${email}` } = this.props;\n        route(routeLoginNew);\n    }\n\n    forgotten = () => {\n        const { email = '' } = this.state;\n        const { routeLoginForgot = `/forgotten/${email}` } = this.props;\n        route(routeLoginForgot);\n    }\n\n    // pwaInstallClick = (e) => {\n    //     // hide our user interface that shows our A2HS button\n    //     // addBtn.style.display = 'none';\n\n    //     // Show the prompt\n    //     this.deferredPrompt.prompt();\n    //     // Wait for the user to respond to the prompt\n    //     this.deferredPrompt.userChoice.then((choiceResult) => {\n    //         if (choiceResult.outcome === 'accepted') {\n    //             console.log('User accepted the A2HS prompt');\n    //         } else {\n    //             console.log('User dismissed the A2HS prompt');\n    //         }\n    //         this.deferredPrompt = null;\n    //     });\n    // }\n\n    // componentWillMount() {\n    //     window.addEventListener('beforeinstallprompt', (e) => {\n    //         // Prevent Chrome 67 and earlier from automatically showing the prompt\n    //         e.preventDefault();\n    //         // Stash the event so it can be triggered later.\n    //         this.deferredPrompt = e;\n\n    //         // // Update UI to notify the user they can add to home screen\n    //         // addBtn.style.display = 'block';\n    //     });\n    // }\n\n    changeLanguage = (e) => {\n        const lang = e.target.value;\n\t\tconst { appState } = this.props.stores;\n        appState.setLanguage(lang);\n    }\n\n    validateLoginToken = async () => {\n        const { userStore } = this.props.stores;\n        const { loginToken, routeLoginOk = '/' } = this.props;\n        // console.log(loginToken, util.isDefined(loginToken));\n        const response = await userStore.validateLoginToken(loginToken);\n        if (response && response.status === 200) {\n            await userStore.getInfo();\n            route(routeLoginOk);\n        }\n    }\n\n    componentDidMount() {\n        const { userStore } = this.props.stores;\n        if (this.props.email) {\n            clearTimeout(this.checkEmailTimer);\n            this.checkEmailTimer = setTimeout(() => userStore.checkEmail(this.props.email), 1000);\n        }\n        const { loginToken } = this.props;\n        if (util.isString(loginToken)) {\n            this.validateLoginToken();\n        }\n    }\n\n    render() {\n        const { isCapsLock, email, password, token, passwordType } = this.state;\n        const { appState, userStore } = this.props.stores;\n        const { language = 'en', darkmode } = appState;\n        const { routeLoginOk, routeLoginNew, routeLoginForgot, showLogo = true } = this.props;\n\n        const { emailIsAvailable, login, twoFactorLogin } = userStore;\n        const { message, messageIcon, error, errorIcon } = login;\n        const isValidEmail = util.validateEmail(email);\n        const isOkToLogin = isValidEmail && password;\n\n        return (\n            <div class='container-fluid'>\n                <div class='row'>\n                    <div class='col-10 offset-1 col-sm-8 offset-sm-2 col-md-6 offset-md-3 col-lg-4 offset-lg-4 pt-5'>\n\n                        <div class='d-flex justify-content-center'>\n                            {darkmode ? <>\n                                <img src={`https://themusher.app/assets/logo-qpaws-dark.png`} height='100' />\n                            </> : <>\n                                <img src={`https://themusher.app/assets/logo-qpaws-light.png`} height='100' />\n                            </>}\n                        </div>\n                        <div class='d-flex justify-content-center'>\n                            <h5 class='mt-1 mb-3'><Text id='login.login'>Logg inn</Text></h5>\n                        </div>\n\n                        <Error message={error} icon={errorIcon} remove={this.resetLoginMessages} />\n                        <Message message={message} icon={messageIcon} remove={this.resetLoginMessages}  />\n\n                        <div class='form-group'>\n                            <label for='emailInput'><i class='far fa-envelope' /> <Text id='login.email'>E-post</Text></label>\n                            <input type='email'\n                                class={`form-control ${email ? (isValidEmail && !emailIsAvailable ? 'is-valid' : 'is-invalid') : ''}`}\n                                id='emailInput'\n                                onInput={this.handleEmailInput}\n                                value={email}\n                                onKeypress={(e) => { util.isCapsLock(e, this.updateCapsLockStatus); }}\n                            />\n                            {email && isValidEmail && emailIsAvailable && <div class='invalid-feedback' style={`display: block;`}>\n                                <Text id='login.email-not-found'>E-posten finnes ikke, men du kan registrere deg 😃</Text>\n                            </div>}\n                            {email && !isValidEmail && <div class=\"invalid-feedback\" style={'display: block;'}>\n                                <Text id='login.email-not-valid'>Hmm, e-posten ser ikke helt riktig ut. Kan det være en skrivefeil?</Text>\n                            </div>}\n                            {email && isValidEmail && !emailIsAvailable && <div class=\"valid-feedback\" style={'display: block;'}>\n                                <Text id='login.email-looks-good'>E-post ser bra ut.</Text>\n                            </div>}\n                        </div>\n\n                        <div class='form-group'>\n                            <label for='passwordInput'><i class='fas fa-key' /> <Text id='login.password'>Passord</Text></label>\n                            <div class='input-group'>\n                                <input type={passwordType}\n                                    class={`form-control`}\n                                    id='passwordInput'\n                                    onInput={linkState(this, 'password')}\n                                    value={password}\n                                    onKeypress={(e) => { util.isCapsLock(e, this.updateCapsLockStatus); }}\n                                />\n                                <div class='input-group-append'>\n                                    <button class='btn btn-outline-secondary' type='button'\n                                        onClick={this.togglePassword}\n                                    >\n                                        <i class={`fas fa-eye${passwordType === 'text' ? '-slash' : ''}`} />\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n\n                        {isCapsLock && <div class='alert alert-danger' role='alert'>\n                            <Text id='login.caps-lock-on'>CAPS LOCK er på!</Text>\n                        </div>}\n\n                        {twoFactorLogin &&\n                            <div class='form-group'>\n                                <label for='tokenInput'><i class='fas fa-unlock' /> <Text id='login.2fa-token'>2FA Token</Text></label>\n                                <input type='number'\n                                    class='form-control'\n                                    id='tokenInput'\n                                    onInput={linkState(this, 'token')}\n                                    value={token}\n                                />\n                            </div>}\n\n                        <button class={`btn ${isOkToLogin ? 'btn-primary' : 'btn-outline-primary'}`} type='button'\n                            onClick={this.login}\n                            disabled={!isOkToLogin}\n                        >\n                            <i class='fas fa-sign-in-alt mr-2' />\n                            <Text id='login.login'>Logg inn</Text>\n                        </button>\n                        <button class='btn btn-outline-secondary float-right' type='button'\n                            onClick={this.newUser}\n                        >\n                            <i class='fas fa-plus mr-2' />\n                            <Text id='login.new-user'>Ny bruker</Text>\n                        </button>\n\n                        <small class='form-text text-muted mt-5 text-center'>\n                            <button class='btn btn-small btn-link'\n                                onClick={this.forgotten}\n                            >\n                                <Text id='login.forgot-password'>Glemt passordet?</Text>\n                            </button>\n                        </small>\n\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default Login;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport linkstate from 'linkstate';\n\nimport Header from './header';\nimport Heatmap from '../../../components/public/heatmap';\n\nimport mu from '../../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(true);\nconst MARGIN_BOTTOM = mu.marginBottom();\nconst SUB_MENU_MARGIN_TOP = mu.subMenuMarginTop();\n\nconst initialState = {\n\tisLoading: false,\n\temail: '',\n\tsubmenu: 'ads',\n\tjwtToken: util.getJwtToken(),\n};\n\n@observer\nclass PublicRaceDetail extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\trender() {\n\t\tconst { appState } = this.props.stores;\n\t\tconst { raceid, path } = this.props;\n\t\tconst { darkmode } = appState;\n\n        let currentMenu = 'default';\n        if (path.match(/\\/race\\/:raceid$/)) {\n            currentMenu = 'default';\n        } else if (path.match(/\\/race\\/:raceid\\/mushers$/)) {\n            currentMenu = 'mushers';\n        } else if (path.match(/\\/race\\/:raceid\\/results$/)) {\n            currentMenu = 'results';\n        } else if (path.match(/\\/race\\/:raceid\\/media$/)) {\n            currentMenu = 'media';\n        } else if (path.match(/\\/race\\/:raceid\\/tracking$/)) {\n            currentMenu = 'tracking';\n        }\n\n\t\treturn (\n\t\t\t<>\t\t\t\t\n                <div class='row fixed-top pr-3' style={`margin-top: 40px; background-color: ${darkmode ? '#191d21' : '#f8f9fa'};`}>\n\n                    <div class='col-12 my-2 mx-2'>\n                        <ul class='nav nav-pills nav-fill flex-nowrap'>\n                            <li class='nav-item' style='max-width: 20%;'>\n                                <a href={`/race/${raceid}`} class={`text-overflow nav-link ${currentMenu === 'default' ? 'active' : ''}`}>\n                                    <nobr><i class='fas fa-info-circle' /> <Text id='race.therace'>Løpet</Text></nobr>\n                                </a>\n                            </li>\n                            <li class='nav-item' style='max-width: 20%;'>\n                                <a href={`/race/${raceid}/mushers`} class={`text-overflow nav-link ${currentMenu === 'mushers' ? 'active' : ''}`}>\n                                    <nobr><i class='fas fa-users' /> <Text id='race.mushers'>Deltakere</Text></nobr>\n                                </a>\n                            </li>\n                            <li class='nav-item' style='max-width: 20%;'>\n                                <a href={`/race/${raceid}/results`} class={`text-overflow nav-link ${currentMenu === 'results' ? 'active' : ''}`}>\n                                    <nobr><i class='fas fa-poll' /> <Text id='race.results'>Resultater</Text></nobr>\n                                </a>\n                            </li>\n                            <li class='nav-item' style='max-width: 20%;'>\n                                <a href={`/race/${raceid}/media`} class={`text-overflow nav-link ${currentMenu === 'media' ? 'active' : ''}`}>\n                                    <nobr><i class='fas fa-images' /> <Text id='race.media'>Bilder</Text></nobr>\n                                </a>\n                            </li>\n                            <li class='nav-item' style='max-width: 20%;'>\n                                <a href={`/race/${raceid}/tracking`} class={`text-overflow nav-link ${currentMenu === 'tracking' ? 'active' : ''}`}>\n                                    <nobr><i class='fas fa-map-marked-alt' /> <Text id='race.tracking'>Tracking</Text></nobr>\n                                </a>\n                            </li>\n                        </ul>\n                    </div>\n\n\n                    {/* <div class={`col text-center subtopmenu ${path.match(/\\/race\\/:raceid$/) ? 'border-bottom border-primary' : ''}`}>\n                        <a href={`/race/${raceid}`} class={`text-${path.match(/\\/race\\/:raceid$/) ? 'primary' : 'secondary'} stretched-link`}>\n                            <nobr><i class='fas fa-chart-line' /> <Text id='race.therace'>Løpet</Text></nobr>\n                        </a>\n                    </div>\n                    <div class={`col text-center subtopmenu ${path.match(/\\/race\\/:raceid\\/mushers$/) ? 'border-bottom border-primary' : ''}`}>\n                        <a href={`/race/${raceid}/mushers`} class={`text-${path.match(/\\/race\\/:raceid\\/mushers$/) ? 'primary' : 'secondary'} stretched-link`}>\n                            <nobr><i class='fas fa-chart-line' /> <Text id='race.mushers'>Deltakere</Text></nobr>\n                        </a>\n                    </div>\n                    <div class={`col text-center subtopmenu ${path.match(/\\/race\\/:raceid\\/results$/) ? 'border-bottom border-primary' : ''}`}>\n                        <a href={`/race/${raceid}/results`} class={`text-${path.match(/\\/race\\/:raceid\\/results$/) ? 'primary' : 'secondary'} stretched-link`}>\n                            <nobr><i class='fas fa-chart-line' /> <Text id='race.results'>Resultater</Text></nobr>\n                        </a>\n                    </div>\n                    <div class={`col text-center subtopmenu ${path.match(/\\/race\\/:raceid\\/tracking$/) ? 'border-bottom border-primary' : ''}`}>\n                        <a href={`/race/${raceid}/tracking`} class={`text-${path.match(/\\/race\\/:raceid\\/tracking$/) ? 'primary' : 'secondary'} stretched-link`}>\n                            <nobr><i class='fas fa-chart-line' /> <Text id='race.tracking'>Tracking</Text></nobr>\n                        </a>\n                    </div> */}\n                </div>\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default PublicRaceDetail;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer, withText } from 'preact-i18n';\nimport linkState from 'linkstate';\n\nimport Images from '../../../components/form/images';\n\nimport mu from '../../../lib/musher-util';\n\n@observer\nclass RaceAdd extends Component {\n     constructor(props) {\n        super(props);\n        this.state = {\n            comment: {\n                body: '',\n                images: [],\n            },\n            showAddImage: false,\n            sendButtonEnabled: true,\n        };\n        this.inputRef = {};\n    }\n\n    beforeImagesUploaded = () => {\n        this.setState({ sendButtonEnabled: false });\n    }\n\n    afterImagesUploaded = () => {\n        this.setState({ sendButtonEnabled: true });\n    }\n\n    commentRace = async () => {\n        const { sendButtonEnabled } = this.state;\n        if (!sendButtonEnabled) {\n            return false;\n        }\n        const { callback = () => {}, inputRefObject = {} } = this.props;\n        const { race } = this.props;\n\t\tconst { raceStore } = this.props.stores;\n        const { comment, showAddImage } = this.state;\n        this.setState({ sendButtonEnabled: false });\n\t\tconst response = await raceStore.commentRace({ id: race.id, comment });\n\t\tif (response && response.status === 200) {\n            this.setState({\n                comment: {\n                    body: '',\n                    images: [],\n                },\n            }, () => {\n                mu.resizeTextarea(inputRefObject[race.id]);\n                if (showAddImage) {\n                    this.addImage();\n                }\n            });\n            callback({ race, response });\n\t\t}\n        this.setState({ sendButtonEnabled: true });\n\t}\n\n    addImages = ({ value }) => {\n        // updateField({ id: object.id, field: 'images', value: images, skipTimer: true });\n        const { comment } = this.state;\n        comment.images.push(...value);\n        this.setState({ comment });\n    }\n\n    addImage = () => {\n        const { showAddImage = false } = this.state;\n        this.setState({\n            showAddImage: !showAddImage,\n        });\n    }\n\n    handleImageErrored = (e) => {\n        const image = e.target;\n        image.onerror = null;\n        setTimeout(() => {\n            image.src += `?${new Date()}`;\n        }, 1000);\n    }\n\n    render() {\n        const { inputRef, race } = this.props;\n        const { comment, showAddImage, sendButtonEnabled } = this.state;\n        const { userStore } = this.props.stores;\n        const { user = {} } = userStore;\n        const displayNameShort = mu.displayNameShort(user);\n        const displayName = mu.displayName(user);\n        const userImage = user.image || (user.images ? user.images[0] : undefined);\n\n        return (<>\n            <div>\n                <div class='d-flex mb-0 position-relative w-100'>\n                    <div \n                        class={`text-center border rounded-circle imageRounded imageRoundedSmall`}\n                        style={`${userImage ? `background-image: url('${userImage.s3SmallLink}'); background-size: cover;` : ''} border-width: 3px !important;`}\n                    >\n                        {!userImage && <span class='font-weight-lighter' style='font-size: 15px;'>{displayNameShort}</span>}\n                    </div>\n                    <div class='col pl-3' style='line-height: 1.2em;'>\n\n                        <div class='d-flex bd-highlight'>\n                            <div class='p-0 w-100 bd-highlight'>\n                                <label class='sr-only' for='inlineFormInput'><Text id='comments.comment'>Kommentar</Text></label>\n                                <div class='border rounded rounded-lg position-relative'>\n                                    <Localizer>\n                                        <textarea\n                                            class='form-control-plaintext px-2'\n                                            type='text'\n                                            placeholder={<Text id='comments.write-comment'>Skriv en kommentar...</Text>}\n                                            onInput={linkState(this, 'comment.body')}\n                                            onKeyUp={mu.resizeTextarea}\n                                            onFocus={mu.resizeTextarea}\n                                            style='height: 2.3em;'\n                                            value={comment.body}\n                                            ref={inputRef}\n                                        />\n                                    </Localizer>\n\n                                    <div class='position-absolute' style='top: 8px; right: 10px; font-size: 1.2em;'>\n                                        <i class='fas fa-image pointerCursor'\n                                            data-id={race.id}\n                                            onClick={this.addImage}\n                                        />\n                                    </div>\n                                </div>\n                            </div>\n                            <div class='p-0 pl-2 flex-shrink-1 bd-highlight'>\n                                <button type='button' class={`btn btn-${sendButtonEnabled ? 'primary' : 'secondary'} mb-2`} disabled={!sendButtonEnabled}\n                                    onClick={this.commentRace}\n                                ><i class='fas fa-paper-plane' /></button>\n                            </div>\n                        </div>\n\n                    </div>\n                </div>\n                {showAddImage && <>\n                    <div class='col-12 text-center'>\n                        <div class='container-fluid'>\n                            <div class='row'>\n                                {util.isArray(comment.images) && comment.images.map(img => (\n                                    <div class='col-3 p-1'>\n                                        <img src={img.s3SmallLink} class='img-fluid' onError={this.handleImageErrored} />\n                                        <button class='btn btn-sm btn-link'\n                                            onClick={this.removeImage}\n                                            data-name={img.name}\n                                        ><i class='fas fa-trash' /> <Text id='comments.remove-image'>Remove</Text></button>\n                                    </div>\n                                ))}\n                            </div>\n                        </div>\n                        <Images object={comment} updateField={this.addImages} before={this.beforeImagesUploaded} after={this.afterImagesUploaded} autoOpen={true} />\n                    </div>\n                </>}\n            </div>\n        </>);\n    }\n}\n\nexport default RaceAdd;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"pointerCursor\":\"pointerCursor__1W6mM\"};","import { h, Component } from 'preact';\nimport { Link } from 'preact-router/match';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport linkState from 'linkstate';\nimport { route } from 'preact-router';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport style from './style.css';\n\n\nconst initialState = {\n    menu: {\n\t\tprofile: false,\n\t\tmain: false,\n\t},\n\tsearchText: '',\n};\n\n@observer\nclass Navigation extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\ttoggleDropdown = (e) => {\n\t\tconst { menu } = this.state;\n\t\tlet menuName = e.target.dataset.name;\n\t\tif (!menuName && e.target.parentNode) {\n\t\t\tmenuName = e.target.parentNode.dataset.name;\n\t\t}\n\t\tif (menuName) {\n\t\t\tmenu[menuName] = !menu[menuName];\n\t\t}\n\t\tthis.setState({ menu });\n\t}\n\n\ttoggleDarkmode = (e) => {\n        const { appState } = this.props.stores;\n\t\tappState.toggleDarkmode();\n\t\tthis.toggleDropdown(e);\n\t}\n\n\ttoggleViewmode = (e) => {\n        const { appState } = this.props.stores;\n\t\tlet mode = e.target.dataset.mode;\n\t\tif (!mode && e.target.parentNode) {\n\t\t\tmode = e.target.parentNode.dataset.mode;\n\t\t}\n\t\tappState.toggleViewmode(mode);\n\t\tthis.toggleDropdown(e);\n\t}\n\n\treloadApp = () => {\n\t\twindow.location.reload(true);\n\t}\n\n\tadminLoadAll = async (e) => {\n        const { userStore } = this.props.stores;\n        await userStore.getInfo(true);\n\t}\n\n\tchangeLanguage = (e) => {\n\t\tconst lang = e.target.value;\n\t\tconsole.log('changeLanguage', lang);\n\t\tconst { appState, userStore } = this.props.stores;\n\t\tconst { user = {} } = userStore;\n\t\tif (user.email) {\n\t\t\tuserStore.setLanguage({ email: user.email, language: lang });\n\t\t}\n\t\tappState.setLanguage(lang);\n\t}\n\n\tsearch = () => {\n\t\tconst { searchText } = this.state;\n\t\troute(`/search/${searchText}`);\n\t}\n\n    render() {\n\t\tconst { menu, searchText } = this.state;\n        const { appState, userStore } = this.props.stores;\n        const { darkmode, viewmode, isCordova } = appState;\n\t\tconst { allUsers, isAdmin, user, notifications = [] } = userStore;\n\t\tconst unreadNotificatins = notifications.filter(e => !e.read);\n\t\tconst unread = unreadNotificatins.length || 0;\n\t\tconst { language = 'en' } = user;\n\n\t\treturn (\n\t\t\t<nav class='navbar navbar-expand-lg navbar-themed fixed-top py-1' style='z-index: 99999;'>\n\t\t\t\t<a class='navbar-brand' href='/race/'>\n\t\t\t\t\t{/* <img src={`./assets/logo-jul-2020-v2-${darkmode ? 'black' : 'white'}.png`} height='30' class='position-absolute' style='top: 8px; left: 6px' /> */}\n\t\t\t\t\t<img src={`./assets/homerun-race-logo-2-${darkmode ? 'white-' : ''}small.png`} height='37' class='position-absolute' style='top: 5px; left: 6px' />\n\t\t\t\t\t<span class='font-weight-normal' style='margin-left: 30px; font-size: 20px;'>Homerun Race</span>\n\t\t\t\t</a>\n\n\t\t\t\t<button class='navbar-toggler' type='button'\n\t\t\t\t\tdata-name='main'\n\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t>\n\t\t\t\t\t<span class='navbar-toggler-icon' />\n\t\t\t\t</button>\n\n\t\t\t\t<div class={`collapse navbar-collapse ${menu.main ? 'show' : ''}`} id='navbarSupportedContent'>\n\t\t\t\t\t<ul class='navbar-nav mr-auto ml-5'>\n\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/race'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tstyle='font-size: 1.0em !important;'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='fas fa-flag-checkered' /> <Text id='header.races'>Løpene</Text></Link>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/race/support'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tstyle='font-size: 1.0em !important;'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='far fa-question-circle' /> <Text id='header.support'>Support</Text></Link>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/race/news'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tstyle='font-size: 1.0em !important;'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='fas fa-quote-right' /> <Text id='header.news'>Nyheter</Text></Link>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t{/* <li class='nav-item'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='fas fa-dog' /> <Text id='header.backtoapp'>The Musher</Text></Link>\n\t\t\t\t\t\t</li> */}\n\t\t\t\t\t\t{/* <li class='nav-item'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/news'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='fas fa-quote-right' /> <Text id='header.news'>Nyheter</Text></Link>\n\t\t\t\t\t\t</li> */}\n\t\t\t\t\t\t{/* <li class='nav-item d-block d-lg-none'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/howto'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='fas fa-quote-right' /> <Text id='header.howto'>Hvordan gjør man det?</Text></Link>\n\t\t\t\t\t\t</li> */}\n\t\t\t\t\t</ul>\n\n\t\t\t\t\t<ul class='navbar-nav ml-auto '>\n\t\t\t\t\t\t{/* <li class='nav-item mr-2'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'}\n\t\t\t\t\t\t\t\thref='/users/notifications'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<i class='fas fa-bell mr-1' />\n\t\t\t\t\t\t\t\t{unread > 0 && <>\n\t\t\t\t\t\t\t\t\t<span class='badge badge-pill badge-danger'>{unread > 9 ? '9+' : unread}</span>\n\t\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</li> */}\n\t\t\t\t\t\t<li class='nav-item mr-2'>\n\t\t\t\t\t\t\t<div class='form-row align-items-center'>\n\t\t\t\t\t\t\t\t<div class='col-auto my-1' style='width: 80px;'>\n\t\t\t\t\t\t\t\t\t<select class='custom-select'\n\t\t\t\t\t\t\t\t\t\tstyle='background-color: inherit; border: none; padding: 0; height: 1.1em; font-size: 0.9em;'\n\t\t\t\t\t\t\t\t\t\tonInput={this.changeLanguage}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<option value='no' selected={language === 'no'}>🇳🇴 NO</option>\n\t\t\t\t\t\t\t\t\t\t<option value='en' selected={language === 'en'}>🇬🇧 EN</option>\n\t\t\t\t\t\t\t\t\t\t<option value='es' selected={language === 'es'}>🇪🇸 ES</option>\n\t\t\t\t\t\t\t\t\t\t<option value='de' selected={language === 'de'}>🇩🇪 DE</option>\n\t                                    <option value='fr' selected={language === 'fr'}>🇫🇷 FR</option>\n\t                                    <option value='ru' selected={language === 'ru'}>🇷🇺 RU</option>\n\t                                    <option value='se' selected={language === 'se'}>🇸🇪 SE</option>\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class='nav-item d-block d-lg-none'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'}\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tonClick={this.toggleDarkmode}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<i class={`${darkmode ? 'fas text-warning' : 'far'} fa-moon`} /> <Text id='header.darkmode'>Nattmodus</Text>\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class='nav-item mr-2 d-none d-lg-block'>\n\t\t\t\t\t\t\t<button class='btn btn-link'\n\t\t\t\t\t\t\t\tdata-name='profile'\n\t\t\t\t\t\t\t\tonClick={this.toggleDarkmode}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<i class={`${darkmode ? 'fas text-warning' : 'far'} fa-moon`} />\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t{/* <li class='nav-item ml-auto d-none d-lg-block'>\n\t\t\t\t\t\t\t<form class='form-inline my-2 my-lg-0'>\n\t\t\t\t\t\t\t\t<Localizer>\n\t\t\t\t\t\t\t\t\t<input class='form-control form-control-sm mr-sm-2' type='search' placeholder={<Text id='header.search-placeholder'>Søk etter det meste...</Text>}\n\t\t\t\t\t\t\t\t\t\tvalue={searchText}\n\t\t\t\t\t\t\t\t\t\tonInput={linkState(this, 'searchText')}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Localizer>\n\t\t\t\t\t\t\t\t<button class='btn btn-sm btn-outline-success my-2 my-sm-0' type='button'\t\n\t\t\t\t\t\t\t\t\tonClick={this.search}\n\t\t\t\t\t\t\t\t><Text id='header.search'>Søk</Text></button>\n\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t</li> */}\n\t\t\t\t\t</ul>\n\n\t\t\t\t    \n\n\t\t\t\t</div>\n\t\t\t</nav>\n\t\t);\n\t}\n}\n\nexport default Navigation;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer, withText } from 'preact-i18n';\nimport linkState from 'linkstate';\n\nimport mu from '../../../lib/musher-util';\n\n@observer\nclass RaceCommentReply extends Component {\n    commentRace = async () => {\n        const { callback = () => {}, commentId } = this.props;\n        const { race } = this.props;\n\t\tconst { raceStore } = this.props.stores;\n        const { comment = '' } = this.state;\n\t\tconst response = await raceStore.commentReplyRace({ id: race.id, commentId, comment });\n\t\tif (response && response.status === 200) {\n            this.setState({\n                comment: '',\n            });\n            callback({ race, response });\n\t\t}\n\t}\n\n    render() {\n        const { inputRef } = this.props;\n        const { comment } = this.state;\n        const { userStore } = this.props.stores;\n        const { user = {} } = userStore;\n        const displayNameShort = mu.displayNameShort(user);\n        const displayName = mu.displayName(user);\n        const userImage = user.image || (user.images ? user.images[0] : undefined);\n\n        return (\n            <div class='w-100'>\n                <div class='d-flex mb-0 position-relative w-100'>\n                    <div \n                        class={`text-center border rounded-circle imageRounded imageRoundedThumb`}\n                        style={`${userImage ? `background-image: url('${userImage.s3SmallLink}'); background-size: cover;` : ''} border-width: 3px !important;`}\n                    >\n                        {!userImage && <span class='font-weight-lighter' style='font-size: 15px;'>{displayNameShort}</span>}\n                    </div>\n                    <div class='col pl-3' style='line-height: 1.2em;'>\n\n                        <div class='d-flex bd-highlight'>\n                            <div class='p-0 w-100 bd-highlight'>\n                                <label class='sr-only' for='inlineFormInput'><Text id='comments.comment'>Kommentar</Text></label>\n                                <Localizer>\n                                    <textarea\n                                        class='form-control rounded-lg'\n                                        type='text'\n                                        placeholder={<Text id='comments.write-reply'>Write a reply...</Text>}\n                                        onInput={linkState(this, 'comment')}\n                                        onKeyUp={mu.resizeTextarea}\n                                        onFocus={mu.resizeTextarea}\n                                        style='height: 2.3em;'\n                                        value={comment}\n                                        ref={inputRef}\n                                    />\n                                </Localizer>\n                            </div>\n                            <div class='p-0 pl-2 flex-shrink-1 bd-highlight'>\n                                <button type='button' class='btn btn-sm btn-primary mb-2'\n                                    onClick={this.commentRace}\n                                ><i class='fas fa-paper-plane' /></button>\n                            </div>\n                        </div>\n\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default RaceCommentReply;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { toJS } from 'mobx';\nimport { Text, Localizer, withText } from 'preact-i18n';\nimport Markdown from 'preact-markdown';\nimport linkState from 'linkstate';\n\nimport RaceReplyComment from './commentReply';\n\nimport mu from '../../../lib/musher-util';\n\nconst initialState = {\n    showAddComment: {},\n    showAllComments: false,\n    showAllReplies: {},\n    viewImageIdx: {},\n    likeComment: {},\n    likeReply: {},\n    showOriginal: {},\n};\n\nconst MAX_COMMENTS = 2;\n\n@observer\nclass RaceComments extends Component {\n     constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n        this.inputRef = {};\n    }\n\n    addLikeComment = async (e) => {\n        const { callback = () => {} } = this.props;\n        const commentId = e.target.closest('.commentContainer').dataset.id;\n        const { race } = this.props;\n\t\tconst { raceStore } = this.props.stores;\n\n        const { likeComment } = this.state;\n        likeComment[commentId] = true;\n        this.setState({ likeComment });\n        setTimeout(() => {\n            const { likeComment } = this.state;\n            delete likeComment[commentId];\n            this.setState({ likeComment });\n        }, 1200);\n\n\t\tconst response = await raceStore.likeRaceComment({ id: race.id, commentId });\n\t\tif (response && response.status === 200) {\n            callback({ type: 'likeComment', race, commentId, response });\n\t\t}\n        return true;\n    }\n\n    likeReply = async (e) => {\n        const { callback = () => {} } = this.props;\n        const replyId = e.target.closest('.replyContainer').dataset.id;\n        const commentId = e.target.closest('.replyContainer').dataset.comment;\n        const { race } = this.props;\n\t\tconst { raceStore } = this.props.stores;\n\n        const { likeReply } = this.state;\n        likeReply[replyId] = true;\n        this.setState({ likeReply });\n        setTimeout(() => {\n            const { likeReply } = this.state;\n            delete likeReply[replyId];\n            this.setState({ likeReply });\n        }, 1200);\n\n\t\tconst response = await raceStore.likeRaceCommentReply({ id: race.id, replyId, commentId });\n        if (response && response.status === 200) {\n            callback({ type: 'likeReply', race, commentId, replyId, response });\n\t\t}\n    }\n\n    replyComment = async (e) => {\n        const commentId = e.target.parentElement.dataset.id || e.target.dataset.id;\n\n        const { showAddComment } = this.state;\n        showAddComment[commentId] = !showAddComment[commentId];\n\t\tthis.setState({\n\t\t\tshowAddComment,\n\t\t}, () => {\n            if (this.inputRef[commentId]) {\n                this.inputRef[commentId].focus();\n            }\n\t\t});\n    }\n\n    toggleComments = () => {\n\t\tconst { showAllComments } = this.state;\n\t\tthis.setState({\n\t\t\tshowAllComments: !showAllComments,\n\t\t});\n\t}\n\n    toggleReplies = (e) => {\n        const commentId = e.target.parentElement.dataset.id || e.target.dataset.id;\n\t\tconst { showAllReplies } = this.state;\n        showAllReplies[commentId] = !showAllReplies[commentId];\n\t\tthis.setState({\n\t\t\tshowAllReplies,\n\t\t});\n\t}\n\n    toggleMenu = (e) => {\n        const { id } = e.target.closest('i').dataset;\n\t\tconst { showMenu = {} } = this.state;\n        showMenu[id] = !showMenu[id];\n\t\tthis.setState({\n            showDeleteComment: {},\n            showEdit: {},\n\t\t\tshowMenu,\n\t\t});\n\t}\n\n    toggleEdit = (e) => {\n        const { id, comment: commentEditText } = e.target.closest('button').dataset;\n\t\tconst { showEdit = {} } = this.state;\n        showEdit[id] = !showEdit[id];\n\t\tthis.setState({\n            showDeleteComment: {},\n\t\t\tshowEdit,\n            showMenu: {},\n            commentEditText,\n\t\t});\n\t}\n\n    toggleDeleteComment = (e) => {\n        const { id } = e.target.closest('button').dataset;\n\t\tconst { showDeleteComment = {} } = this.state;\n        showDeleteComment[id] = !showDeleteComment[id];\n\t\tthis.setState({\n\t\t\tshowDeleteComment,\n            showEdit: {},\n            showMenu: {},\n\t\t});\n\t}\n\n    deleteComment = async (e) => {\n        const { id: commentId } = e.target.closest('button').dataset;\n        const { race } = this.props;\n        const { raceStore } = this.props.stores;\n        await raceStore.deleteCommentRace({ id: race.id, commentId });\n        this.setState({\n            commentEditText: '',\n\t\t\tshowDeleteComment: {},\n            showEdit: {},\n            showMenu: {},\n\t\t});\n    }\n\n    deleteCommentReply = async (e) => {\n        const { id: replyId, commentid: commentId } = e.target.closest('button').dataset;\n        const { race } = this.props;\n        const { raceStore } = this.props.stores;\n        await raceStore.deleteCommentReplyRace({ id: race.id, commentId, replyId });\n        this.setState({\n            commentEditText: '',\n\t\t\tshowDeleteComment: {},\n            showEdit: {},\n            showMenu: {},\n\t\t});\n\n    }\n\n    saveComment = async (e) => {\n        const { id: commentId } = e.target.closest('button').dataset;\n        const { commentEditText: comment } = this.state;\n        const { race } = this.props;\n        const { raceStore } = this.props.stores;\n        await raceStore.editCommentRace({ id: race.id, commentId, comment });\n        this.setState({\n            commentEditText: '',\n\t\t\tshowDeleteComment: {},\n            showEdit: {},\n            showMenu: {},\n\t\t});\n    }\n\n    saveCommentReply = async (e) => {\n        const { id: replyId, commentid: commentId } = e.target.closest('button').dataset;\n        const { commentEditText: comment } = this.state;\n        const { race } = this.props;\n        const { raceStore } = this.props.stores;\n        await raceStore.editCommentReplyRace({ id: race.id, commentId, replyId, comment });\n        this.setState({\n            commentEditText: '',\n\t\t\tshowDeleteComment: {},\n            showEdit: {},\n            showMenu: {},\n\t\t});\n    }\n\n    viewImage = (e) => {\n\t\tconst { id, idx } = e.target.closest('img').dataset;\n        const { viewImageIdx } = this.state;\n        viewImageIdx[id] = idx;\n        this.setState({ viewImageIdx });\n    }\n\n    translate = async (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        const { replyid, commentid } = e.target.closest('button').dataset;\n        const { race } = this.props;\n        const { userStore, raceStore } = this.props.stores;\n        const { user } = userStore;\n        const { showOriginal = {}, translatedText = {} } = this.state;\n        const key = `${commentid}${replyid ? `-${replyid}`: ''}`;\n        showOriginal[key] = 0;\n        if (replyid) {\n            translatedText[key] = await raceStore.translateCommentReply({ commentid, replyid, race, user });\n        } else {\n            translatedText[key] = await raceStore.translateComment({ commentid, race, user });\n        }\n        this.setState({ showOriginal, translatedText });\n    }\n\n    showOriginal = (e) => {\n        const { replyid, commentid } = e.target.closest('button').dataset;\n        e.preventDefault();\n        e.stopPropagation();\n        const { showOriginal = {} } = this.state;\n        showOriginal[`${commentid}${replyid ? `-${replyid}`: ''}`] = 1;\n        this.setState({ showOriginal });\n    }\n\n    render() {\n        const { showAddComment, showAllComments, showAllReplies, viewImageIdx, showMenu = {}, showEdit = {},\n            showDeleteComment = {}, commentEditText, likeComment, showOriginal = {}, translatedText = {} } = this.state;\n\t\tconst { race, callback = () => {}, initCall = () => {}, col = 12, offset = 0, compact = false  } = this.props;\n        const { userStore, raceStore } = this.props.stores;\n        const { user: currentUser } = userStore;\n        const { language = 'en' } = currentUser;\n\n        let filteredComments = [];\n        let totalComments = 0;\n        let diplayedComments = 0;\n        let max_comments;\n        if (race.comments) {\n            totalComments = race.comments.length;\n            if (showAllComments) {\n                filteredComments = race.comments;\n            } else {\n                // filteredComments = race.comments.slice(0, MAX_COMMENTS);\n                const max_comments = compact ? 0 : MAX_COMMENTS;\n                filteredComments = race.comments.slice(Math.max(totalComments - max_comments, 0));\n            }\n            diplayedComments = filteredComments.length;\n        }\n\n\n        return (\n            <div class={`col-${col} offset-${offset} col-sm-8 col-lg-6 offset-sm-2 offset-lg-3`}>\n                {race && util.isArray(filteredComments) && filteredComments.reverse().map((comment) => {\n                    const { user = {} } = comment;\n                    const teams = raceStore.findPublicTeamByMembers(user.id);\n                    const displayNameShort = mu.displayNameShort(user);\n                    const displayName = mu.displayName(user);\n                    const userImage = user.image || (user.images ? user.images[0] : undefined);\n                    const hasLikedComment = comment.likes && comment.likes.findIndex(e => e.user === currentUser.id) > -1;\n\n                    let filteredReplises = [];\n                    let totalReplies = 0;\n                    let diplayedReplies = 0;\n                    if (comment.comments) {\n                        totalReplies = comment.comments.length;\n                        if (showAllReplies[comment.id]) {\n                            filteredReplises = comment.comments;\n                        } else {\n                            filteredReplises = comment.comments.slice(0, max_comments);\n                        }\n                        diplayedReplies = filteredReplises.length;\n                    }\n\n                    const images = [];\n                    if (comment.images) {\n                        const imgs = toJS(comment.images);\n                        images.push(...imgs);\n                    }\n                    const imageIdx = viewImageIdx[comment.id] ? viewImageIdx[comment.id] : 0;\n                    const currentImage = images && images[imageIdx] ? images[imageIdx] : null;\n\n                    const { currentLocationGeocode = {} } = comment;\n\n                    const translation = raceStore.getCommentTranslations({\n                        race,\n                        commentid: comment.id,\n                        targetLang: language,\n                    }) || translatedText[comment.id];\n                    let body = translation || comment.comment;\n                    if (showOriginal[comment.id]) {\n                        body = comment.comment;\n                    }\n\n                    return (\n                        <div class='row'>\n                            <div class='col-11 offset-1 d-flex mb-2 position-relative'>\n                                <div\n                                    class={`text-center border rounded-circle imageRounded imageRoundedSmall`}\n                                    style={`${userImage ? `background-image: url(\"${userImage.s3SmallLink}\"); background-size: cover;` : ''} border-width: 3px !important;`}\n                                >\n                                    {!user.image && <span class='font-weight-lighter' style='font-size: 15px;'>{displayNameShort}</span>}\n                                </div>\n                                <div class='flex-grow-1 pl-3 pt-0' style='line-height: 1.2em;'>\n                                    <div class='bg-light p-2 rounded rounded-lg position-relative'>\n\n                                        {currentUser.id === user.id && <>\n                                            <span class='float-right font-weight-lighter text-muted'>\n                                                <i class='fas fa-ellipsis-h' onClick={this.toggleMenu} data-id={comment.id} />\n                                            </span>\n                                        </>}\n                                        {showMenu[comment.id] && <>\n                                            <div class='position-absolute bg-white p-2 border rounded rounded-lg shadow-sm' style='top: 30px; right: 10px; width: 60%; z-index: 999999;'>\n                                                <button class='btn btn-link btn-block text-left' onClick={this.toggleEdit} data-id={comment.id} data-comment={comment.comment}><i class='fas fa-edit' /> Edit</button>\n                                                <hr />\n                                                <button class='btn btn-link btn-block text-left' onClick={this.toggleDeleteComment} data-id={comment.id}><i class='fas fa-trash-alt' /> Delete</button>\n                                            </div>\n                                        </>}\n\n                                        <div>\n                                            <span style='font-size: 0.95em;'>\n                                                <h5 class='font-weight-bold mb-2' style='font-size: 1.0em;'>\n                                                    {user.uuidv4 && user.uuidv4 !== currentUser.uuidv4 ? <>\n                                                        <a href={`/inbox/${user.uuidv4}`}>{displayName}</a>\n                                                    </> : <>\n                                                        {displayName}\n                                                    </>}\n                                                    {teams && teams.length > 0 && <>\n                                                        <span class='font-weight-lighter text-muted ml-1'>\n                                                            {teams.filter(e => e.public === 1).slice(0, 1).map(t => <>\n                                                                - <a href={`/teams/public/${t.uuidv4}`}>{t.name}</a>\n                                                            </>)}\n                                                        </span>\n                                                    </>}\n                                                </h5>\n\n\n                                                {showEdit[comment.id] ? <>\n                                                    <div class='d-flex bd-highlight'>\n                                                        <div class='p-0 w-100 bd-highlight'>\n                                                            <label class='sr-only' for='inlineFormInput'><Text id='comments.comment'>Kommentar</Text></label>\n                                                            <div class='border rounded rounded-lg position-relative'>\n                                                                <Localizer>\n                                                                    <textarea\n                                                                        class='form-control-plaintext px-2'\n                                                                        type='text'\n                                                                        placeholder={<Text id='comments.write-comment'>Skriv en kommentar...</Text>}\n                                                                        onInput={linkState(this, 'commentEditText')}\n                                                                        onKeyUp={mu.resizeTextarea}\n                                                                        onFocus={mu.resizeTextarea}\n                                                                        style='height: 2.3em;'\n                                                                        value={commentEditText}\n                                                                    />\n                                                                </Localizer>\n                                                           </div>\n                                                        </div>\n                                                        <div class='p-0 pl-2 flex-shrink-1 bd-highlight'>\n                                                            <button type='button' class='btn btn-primary mb-2'\n                                                                onClick={this.saveComment}\n                                                                data-id={comment.id}\n                                                            ><i class='fas fa-paper-plane' /></button>\n                                                        </div>\n                                                    </div>\n                                                </> : <>\n                                                    <Markdown markdown={mu.replaceImages(body, comment.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                                                </>}\n                                                {showDeleteComment[comment.id] && <div class='clearfix mt-3 mb-3'>\n                                                    <button class='btn btn-danger float-left' onClick={this.deleteComment} data-id={comment.id}><i class='fas fa-trash-alt' /> Delete</button>\n                                                    <button class='btn btn-secondary float-right' onClick={this.toggleDeleteComment} data-id={comment.id}><i class='fas fa-times-circle' /> Cancel</button>\n                                                </div>}\n\n                                            </span>\n                                        </div>\n                                        <div>\n                                            <div class='container-fluid px-3 mt-1'>\n                                                {currentImage && <div class='clearfix row position-relative'>\n                                                    <div\n                                                        class={`commentContainer col-12 px-0 overflow-hidden`}\n                                                        style={`max-height: 60vh;`}\n                                                        onDblclick={this.addLikeComment}\n                                                        data-id={comment.id}\n                                                    >\n                                                        <img loading='lazy' class={`img-fluid`} style='min-width: 100px;' src={currentImage.s3LargeLink} />\n                                                    </div>\n                                                    {likeComment[comment.id] && <span class='likeHeart position-absolute text-white display-1' style='top: calc(50% - 50px); left: calc(50% - 50px); width: 100px; height: 100px;'>\n                                                        <i class='fas fa-heart likeStory' />\n                                                    </span>}\n                                                </div>}\n                                                {images && images.length > 1 && <div class='clearfix d-flex flex-wrap row'>\n                                                    {util.isArray(images) && images.map((img, idx) => {\n                                                        return (<>\n                                                            <div\n                                                                class={`col px-0 overflow-hidden`}\n                                                                style={`max-height: 100px; min-width: 100px;`}\n                                                            >\n                                                                <img loading='lazy' class={`img-fluid border`} style='min-width: 100px;' src={img.s3SmallLink} onClick={this.viewImage} data-id={comment.id} data-idx={idx} />\n                                                            </div>\n                                                        </>);\n                                                    })}\n                                                </div>}\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <small>\n                                        <button class={`commentContainer btn btn-sm btn-link py-0 ${hasLikedComment ? 'text-primary' : ''}`}\n                                            onClick={this.addLikeComment}\n                                            data-id={comment.id}\n                                            disabled={hasLikedComment}\n                                        >\n                                            {hasLikedComment ? <Text id='comments.has-liked'>Liked</Text> : <Text id='comments.like'>Lik</Text>}\n                                        </button>\n                                        -\n                                        <button class='btn btn-sm btn-link py-0'\n                                            onClick={this.replyComment}\n                                            data-id={comment.id}\n                                        >\n                                            <Text id='comments.comment-add'>Kommentar</Text>\n                                        </button>\n                                        {comment.language !== language && <>\n                                            -\n                                            {!showOriginal[comment.id] && translation ? <>\n                                                <button\n                                                    type='button'\n                                                    class='btn btn-sm btn-link'\n                                                    data-commentid={comment.id}\n                                                    onClick={this.showOriginal}\n                                                >\n                                                    <i class='fas fa-cog' />  <Text id='home.translate-show-original'>Show original</Text>\n                                                </button>\n                                            </> : <>\n                                                <button\n                                                    type='button'\n                                                    class='btn btn-sm btn-link'\n                                                    onClick={this.translate}\n                                                    data-commentid={comment.id}\n                                                >\n                                                    <i class='fas fa-cog' /> <Text id='home.translate-to'>See translation</Text>\n                                                </button>\n                                            </>}\n                                        </>}\n                                        -\n                                        <button class='btn btn-sm btn-link py-0 disabled'>\n                                            {util.formatDistance(comment.createdDate, new Date(), { locale: 'no-NB' })}\n                                            {comment.updatedDate && <>\n                                                <span class='font-weight-light ml-2'>(Edited {util.formatDistance(comment.updatedDate, new Date(), { locale: 'no-NB' })})</span>\n                                            </>}\n                                        </button>\n                                    </small>\n                                </div>\n                                {comment.likes && comment.likes.length > 0 && <small class='position-absolute bg-light shadow-sm rounded-lg py-0 px-1' style='bottom: 20px; right: 15px;'>\n                                    <i class='fas fa-thumbs-up text-primary' /> {comment.likes.length}\n                                </small>}\n                            </div>\n                            <div class='col-10 offset-2 mb-2'>\n                                {comment && util.isArray(filteredReplises) && filteredReplises.map((reply) => {\n                                    const { user = {} } = reply;\n                                    const teams = raceStore.findPublicTeamByMembers(user.id);\n                                    const displayNameShort = mu.displayNameShort(user);\n                                    const displayName = mu.displayName(user);\n                                    const userImage = user.image || (user.images ? user.images[0] : undefined);\n                                    const hasLikedReply = reply.likes && reply.likes.findIndex(e => e.user === currentUser.id) > -1;\n                                    const { currentLocationGeocode = {} } = reply;\n\n                                    const replyTranslation = raceStore.getCommentReplyTranslations({\n                                        race,\n                                        commentid: comment.id,\n                                        replyid: reply.id,\n                                        targetLang: language,\n                                    }) || translatedText[`${comment.id}-${reply.id}`];\n                                    let replyBody = replyTranslation || reply.comment;\n                                    if (showOriginal[`${comment.id}-${reply.id}`]) {\n                                        replyBody = reply.comment;\n                                    }\n\n                                    return (\n                                        <div class='row'>\n                                            <div class='col-12 d-flex mb-2 position-relative'>\n                                                <div\n                                                    class={`text-center border rounded-circle imageRounded imageRoundedSmall`}\n                                                    style={`${userImage ? `background-image: url(\"${userImage.s3SmallLink}\"); background-size: cover;` : ''} border-width: 3px !important;`}\n                                                >\n                                                    {!user.image && <span class='font-weight-lighter' style='font-size: 15px;'>{displayNameShort}</span>}\n                                                </div>\n                                                <div class='flex-grow-1 pl-3 pt-0' style='line-height: 1.2em;'>\n                                                    <div class='bg-light p-2 rounded-lg position-relative'>\n                                                    {currentUser.id === user.id && <>\n                                                            <span class='float-right font-weight-lighter text-muted'>\n                                                                <i class='fas fa-ellipsis-h' onClick={this.toggleMenu} data-id={reply.id} />\n                                                            </span>\n                                                        </>}\n                                                        {showMenu[reply.id] && <>\n                                                            <div class='position-absolute bg-white p-2 border rounded rounded-lg shadow-sm' style='top: 30px; right: 10px; width: 60%; z-index: 999999;'>\n                                                                <button class='btn btn-link btn-block text-left' onClick={this.toggleEdit} data-id={reply.id} data-comment={reply.comment}><i class='fas fa-edit' /> Edit</button>\n                                                                <hr />\n                                                                <button class='btn btn-link btn-block text-left' onClick={this.toggleDeleteComment} data-id={reply.id}><i class='fas fa-trash-alt' /> Delete</button>\n                                                            </div>\n                                                        </>}\n\n                                                        <span style='font-size: 0.95em;'>\n                                                            <h5 class='font-weight-bold mb-2' style='font-size: 1.0em;'>\n                                                                {displayName}\n                                                                {teams && teams.length > 0 && <>\n                                                                    <span class='font-weight-lighter text-muted ml-2'>\n                                                                        {teams.filter(e => e.public === 1).slice(0, 1).map(t => <>\n                                                                            - <a href={`/teams/public/${t.uuidv4}`} class='mr-2'> {t.name}</a>\n                                                                        </>)}\n                                                                    </span>\n                                                                </>}\n                                                            </h5>\n\n\n                                                            {showEdit[reply.id] ? <>\n                                                                <div class='d-flex bd-highlight'>\n                                                                    <div class='p-0 w-100 bd-highlight'>\n                                                                        <label class='sr-only' for='inlineFormInput'><Text id='comments.comment'>Kommentar</Text></label>\n                                                                        <div class='border rounded rounded-lg position-relative'>\n                                                                            <Localizer>\n                                                                                <textarea\n                                                                                    class='form-control-plaintext px-2'\n                                                                                    type='text'\n                                                                                    placeholder={<Text id='comments.write-comment'>Skriv en kommentar...</Text>}\n                                                                                    onInput={linkState(this, 'commentEditText')}\n                                                                                    onKeyUp={mu.resizeTextarea}\n                                                                                    onFocus={mu.resizeTextarea}\n                                                                                    style='height: 2.3em;'\n                                                                                    value={commentEditText}\n                                                                                />\n                                                                            </Localizer>\n                                                                    </div>\n                                                                    </div>\n                                                                    <div class='p-0 pl-2 flex-shrink-1 bd-highlight'>\n                                                                        <button type='button' class='btn btn-primary mb-2'\n                                                                            onClick={this.saveCommentReply}\n                                                                            data-commentid={comment.id}\n                                                                            data-id={reply.id}\n                                                                        ><i class='fas fa-paper-plane' /></button>\n                                                                    </div>\n                                                                </div>\n                                                            </> : <>\n                                                                <Markdown markdown={mu.replaceImages(replyBody, reply.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                                                            </>}\n                                                            {showDeleteComment[reply.id] && <div class='clearfix mt-3 mb-3'>\n                                                                <button class='btn btn-danger float-left' onClick={this.deleteCommentReply} data-id={reply.id} data-commentid={comment.id}><i class='fas fa-trash-alt' /> Delete</button>\n                                                                <button class='btn btn-secondary float-right' onClick={this.toggleDeleteComment} data-id={reply.id}><i class='fas fa-times-circle' /> Cancel</button>\n                                                            </div>}\n\n                                                        </span>\n                                                    </div>\n                                                    <small>\n                                                        <button class={`replyContainer btn btn-sm btn-link py-0 ${hasLikedReply ? 'text-primary' : ''}`}\n                                                            onClick={this.likeReply}\n                                                            data-comment={comment.id}\n                                                            data-id={reply.id}\n                                                            disabled={hasLikedReply}\n                                                        >\n                                                            {hasLikedReply ? <Text id='comments.has-liked'>Liked</Text> : <Text id='comments.like'>Lik</Text>}\n                                                        </button>\n                                                        -\n                                                        <button class='btn btn-sm btn-link py-0'\n                                                            onClick={this.replyComment}\n                                                            data-id={comment.id}\n                                                        >\n                                                            <Text id='comments.comment-add'>Kommentar</Text>\n                                                        </button>\n                                                        {reply.language !== language && <>\n                                                            -\n                                                            {!showOriginal[`${comment.id}-${reply.id}`] && replyTranslation ? <>\n                                                                <button\n                                                                    type='button'\n                                                                    class='btn btn-sm btn-link'\n                                                                    data-commentid={comment.id}\n                                                                    data-replyid={reply.id}\n                                                                    onClick={this.showOriginal}\n                                                                >\n                                                                    <i class='fas fa-cog' />  <Text id='home.translate-show-original'>Show original</Text>\n                                                                </button>\n                                                            </> : <>\n                                                                <button\n                                                                    type='button'\n                                                                    class='btn btn-sm btn-link'\n                                                                    onClick={this.translate}\n                                                                    data-commentid={comment.id}\n                                                                    data-replyid={reply.id}\n                                                                >\n                                                                    <i class='fas fa-cog' /> <Text id='home.translate-to'>See translation</Text>\n                                                                </button>\n                                                            </>}\n                                                        </>}\n                                                        -\n                                                        <button class='btn btn-sm btn-link py-0 disabled'>\n                                                            {util.formatDistance(reply.createdDate, new Date(), { locale: 'no-NB' })}\n                                                            {reply.updatedDate && <>\n                                                                <span class='font-weight-light ml-2'>(Edited {util.formatDistance(reply.updatedDate, new Date(), { locale: 'no-NB' })})</span>\n                                                            </>}\n                                                        </button>\n                                                    </small>\n                                                </div>\n                                                {reply.likes && <small class='position-absolute bg-light shadow-sm rounded-lg py-0 px-1' style='bottom: 20px; right: 15px;'>\n                                                    <i class='fas fa-thumbs-up text-primary' /> {reply.likes.length}\n                                                </small>}\n                                            </div>\n                                        </div>\n                                    );\n                                })}\n                                {totalReplies - diplayedReplies > 0 && <div>\n                                    <button class='btn btn-sm btn-link py-0'\n                                        onClick={this.toggleReplies}\n                                        data-id={comment.id}\n                                    >\n                                        <Text id='comments.show-more' fields={{ more: totalReplies - diplayedReplies }}>\n                                            Vis {totalReplies - diplayedReplies} flere kommentarer...\n                                        </Text>\n                                    </button>\n                                </div>}\n\n                            </div>\n                            {showAddComment[comment.id] && <div class='col-11 offset-1 d-flex mb-2 position-relative'>\n                                <RaceReplyComment stores={this.props.stores} race={race}\n                                    initCall={initCall}\n                                    callback={callback}\n                                    commentId={comment.id}\n                                    inputRef={c => this.inputRef[comment.id] = c}\n                                    inputRefObject={this.inputRef}\n                                    key={`race-commentreply-${comment.id}`}\n                                />\n                            </div>}\n                        </div>\n                    );\n                })}\n                {totalComments - diplayedComments > 0 && <div>\n                    <button class='btn btn-sm btn-link py-0'\n                        onClick={this.toggleComments}\n                    >\n                        <Text id='comments.show-more' fields={{ more: totalComments - diplayedComments }}>\n                            Vis {totalComments - diplayedComments} flere kommentarer...\n                        </Text>\n                    </button>\n                </div>}\n                {showAllComments && <div>\n                    <button class='btn btn-sm btn-link py-0'\n                        onClick={this.toggleComments}\n                    >\n                        <Text id='comments.hide-all-comments'>Skjul alle kommentarene.</Text>\n                    </button>\n                </div>}\n            </div>\n        );\n    }\n}\n\nexport default RaceComments;\n","import { h, Component } from 'preact';\nimport { observer } from 'mobx-preact';\n\nconst initialState = {\n};\n\n@observer\nclass RaceText extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n    render() {\n\t\tconst { appState } = this.props.stores;\n\t\tconst { text } = this.props;\n\t\tconst { darkmode, language = 'en' } = appState;\n\n        let finalText = text;\n\n        const regex = new RegExp(`/<${language}>(.*?)<\\/${language}>/`);\n        const parsedText = text.replace(regex, '$1');\n        if (parsedText) {\n            finalText = text;\n        }\n\n\t\treturn (\n\t\t\t<>\n                {finalText}\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default RaceText;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport LoginForm from '../../../components/login/loginForm';\nimport LoginRegister from '../../../components/register';\nimport LoginForgot from '../../../components/forgotten';\n\nimport mu from '../../../lib/musher-util';\n\nconst initialState = {\n\tisLoading: false,\n    showSignup: false,\n};\n\n@observer\nclass PublicRaceDetailSignup extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n\t\tthis.inputRef = {};\n        this.updateTimer = {};\n    }\n\n\tsignupToRace = async () => {\n\t\tconst { raceStore, userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n        const { newSignup } = raceStore;\n\t\tconst { raceid } = this.props;\n\n        const signup = {\n            team: user.team,\n            firstname: user.firstname,\n            lastname: user.lastname,\n            sportsClub: user.sportsClub,\n            email: user.email,\n            cellphone: user.cellphone,\n            facebook: user.facebook,\n            instagram: user.instagram,\n            ...newSignup\n        };\n\n\t\tawait raceStore.addContestant({\n\t\t\tid: raceid,\n\t\t\tclassId: newSignup.class,\n\t\t\tnewContestant: signup,\n        });\n        raceStore.addSignup(signup);\n        this.toggleShowSignup(false, true);\n\t}\n\n    updateSignup = (e) => {\n        const key = e.target.id;\n        const value = e.target.value;\n        const { raceStore } = this.props.stores;\n        raceStore.updateObjectKeyValue('newSignup', key, value);\n    }\n\n    editSignup = (e) => {\n        const { raceid } = this.props;\n        const { raceStore } = this.props.stores;\n        const field = e.target.id;\n        const value = e.target.value;\n        const { classid, contestantid } = e.target.dataset;\n\n        // console.log({ raceid, field, value, classid });\n        // const { raceStore } = this.props.stores;\n        // raceStore.updateObjectKeyValue('signup', key, value);\n\n        const data = {\n\t\t\traceClassId: classid,\n            contestantId: contestantid,\n\t\t\t[`raceClassContestant${util.ucfirst(field)}`]: value,\n\t\t};\n\t\tclearTimeout(this.updateTimer[field]);\n\t\tthis.updateTimer[field] = setTimeout(async () => {\n\t\t\traceStore.editClass({\n\t\t\t\tid: raceid,\n\t\t\t\tdata,\n\t\t\t});\n\t\t}, 500);\n    }\n\n    toggleShowSignup = (e, hide) => {\n        const { showSignup } = this.state;\n        this.setState({\n            showSignup: hide ? false : !showSignup,\n        });\n    }\n\n\t// editRaceClass = async (e) => {\n\t// \tconst { id, field } = e.target.dataset;\n\t// \tconst { value } = e.target;\n\t// \tconst { raceid } = this.props;\n\t// \tconst { raceStore } = this.props.stores;\n\t// \tconst data = {\n\t// \t\traceClassId: id,\n\t// \t\t[`raceClass${util.ucfirst(field)}`]: value,\n\t// \t};\n\t// \tclearTimeout(this.updateTimer[field]);\n\t// \tthis.updateTimer[field] = setTimeout(async () => {\n\t// \t\traceStore.editClass({\n\t// \t\t\tid: raceid,\n\t// \t\t\tdata,\n\t// \t\t});\n\t// \t}, 500);\n\t// }\n\n\t// editSignupToRaceasync = async () => {\n\t// \tconst { raceStore, userStore } = this.props.stores;\n\t// \tconst { user } = userStore;\n    //     const { signup } = raceStore;\n\t// \tconst { raceid } = this.props;\n\n\t// \tawait raceStore.editContestant({\n\t// \t\tid: raceid,\n\t// \t\tclassId: signup.class,\n\t// \t\tnewContestant: {\n\t// \t\t\tteam: user.team,\n\t// \t\t\tfirstname: user.firstname,\n\t// \t\t\tlastname: user.lastname,\n\t// \t\t\tsportsClub: user.sportsClub,\n\t// \t\t\temail: user.email,\n\t// \t\t\tcellphone: user.cellphone,\n\t// \t\t\tfacebook: user.facebook,\n\t// \t\t\tinstagram: user.instagram,\n\t// \t\t\t ...signup\n\t// \t\t} });\n\t// }\n\n\trender() {\n        const { showSignup } = this.state;\n\t\tconst { appState, userStore, raceStore } = this.props.stores;\n\t\tconst { user = {}, teams = [], isAdmin } = userStore;\n        const { darkmode, language = 'en' } = appState;\n\t\tconst { raceid, subsection } = this.props;\n\t\tconst { race, signups, newSignup } = raceStore;\n\t\tconst today = new Date();\n        const hasSignedup = signups && signups.length > 0;\n        const skipTeams = signups.map(e => parseInt(e.team, 10)) || [];\n\n\t\treturn (\n\t\t\t<>\n                <h2 class='mb-0'><Text id='races.signup'>Påmelding</Text> <span class='font-weight-lighter' style='letter-spacing: -1px;'> - {race.title}</span></h2>\n\t            <div class='mb-4'>\n                    {race.signupStartDate && <><Text id='races.periode'>Periode</Text>: {util.formatDate(race.signupStartDate, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</>}\n                    {race.signupEndDate && <> - {util.formatDate(race.signupEndDate, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</>}\n                </div>\n\n                {today >= new Date(race.signupStartDate) && today <= new Date(race.signupEndDate) ? <>\n\n                    {user.email ? <>\n\n                        <span class='font-weight-lighter'><Text id='races.signed-in-as'>Logget inn som</Text>:</span> {user.email}<br /><br />\n\n                        {hasSignedup && signups.map((signup) => {\n                            let signupClass = {};\n                            if (signup.class) {\n                                signupClass = raceStore.getRaceClassById(signup.class);\n                            }\n\n                            return (<div class='mb-5 p-3 bg-light border rounded-lg'>\n                                <div class='font-weight-bold mb-4'>\n                                    <i class='fas fa-check text-success' /> <Text id='races.signed-up'>Din bruker er påmeldt!</Text><br />\n                                    {/* {JSON.stringify(signup)} */}\n                                </div>\n\n                                {!race.liveRace && race.signuppayment && <>\n                                    <div class='form-group row my-0'>\n                                        <label for='cellphone' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.signup'>Påmelding</Text></label>\n                                        <div class='col-10'>\n                                            {signup.paidSignupfee ? <div class='py-2'>\n                                                <Text id='races.paid'>Betalt</Text>: {util.formatDate(signup.paidSignupfee)}\n                                                <i class='fas fa-check text-success ml-3' />\n                                            </div> : <>\n                                                <div class='alert alert-danger mb-1' role='alert'>\n                                                    <h5>\n                                                        <span class='font-weight-lighter'><Text id='races.payment-info'>Betaling påmelding</Text>:</span> {mu.replaceImages(race.signuppayment, race.images, language, false)}<br />\n                                                        {signupClass.signupfee || race.signupfee} NOK\n                                                    </h5>\n                                                </div>\n                                            </>}\n                                        </div>\n                                    </div>\n                                </>}\n\n                                <div class='clearfix mt-2'>\n                                    <span class='font-weight-lighter float-right'><Text id='races.click-to-change'>Klikk for å endre info i påmeldingen.</Text></span>\n                                </div>\n\n                                <div class='form-group row my-0'>\n                                    <label for='cellphone' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.cellphone'>Mobil</Text></label>\n                                    <div class='col-10'>\n                                        <Localizer>\n                                            <input type='text' class='form-control-plaintext' id='cellphone'\n                                                data-classid={signup.class}\n                                                data-contestantid={signup.id}\n                                                onInput={this.editSignup}\n                                                value={signup.cellphone}\n                                                placeholder={<Text id='races.cellphone-help'>Hva er mobilnummer ditt?</Text>}\n                                            />\n                                        </Localizer>\n                                    </div>\n                                </div>\n                                <div class='form-group row my-0'>\n                                    <label for='firstname' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.firstname'>Fornavn</Text></label>\n                                    <div class='col-10'>\n                                        <Localizer>\n                                            <input type='text' class='form-control-plaintext' id='firstname'\n                                                data-classid={signup.class}\n                                                data-contestantid={signup.id}\n                                                onInput={this.editSignup}\n                                                value={signup.firstname}\n                                                placeholder={<Text id='races.firstname-help'>Hva er fornavnet ditt?</Text>}\n                                            />\n                                        </Localizer>\n                                    </div>\n                                </div>\n                                <div class='form-group row my-0'>\n                                    <label for='lastname' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.lastname'>Etternavn</Text></label>\n                                    <div class='col-10'>\n                                        <Localizer>\n                                            <input type='text' class='form-control-plaintext' id='lastname'\n                                                data-classid={signup.class}\n                                                data-contestantid={signup.id}\n                                                onInput={this.editSignup}\n                                                value={signup.lastname}\n                                                placeholder={<Text id='races.lastname-help'>Hva er etternavnet ditt?</Text>}\n                                            />\n                                        </Localizer>\n                                    </div>\n                                </div>\n                                <div class='form-group row my-0'>\n                                    <label for='sportsClub' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.sportsclub'>Klubb</Text></label>\n                                    <div class='col-10'>\n                                        <Localizer>\n                                            <input type='text' class='form-control-plaintext' id='sportsClub'\n                                                data-classid={signup.class}\n                                                data-contestantid={signup.id}\n                                                onInput={this.editSignup}\n                                                value={signup.sportsClub}\n                                                placeholder={<Text id='races.sportsClub-help'>Hvilken klubb tilhører du?</Text>}\n                                            />\n                                        </Localizer>\n                                    </div>\n                                </div>\n                                <div class='form-group row my-0'>\n                                    <label for='facebook' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.facebook'>Facebook</Text></label>\n                                    <div class='col-10'>\n                                        <Localizer>\n                                            <input type='text' class='form-control-plaintext' id='facebook'\n                                                data-classid={signup.class}\n                                                data-contestantid={signup.id}\n                                                onInput={this.editSignup}\n                                                value={signup.facebook}\n                                                placeholder={<Text id='races.facebook-help'>Hva er Facebook brukernavnet ditt?</Text>}\n                                            />\n                                        </Localizer>\n                                    </div>\n                                </div>\n                                <div class='form-group row my-0'>\n                                    <label for='instagram' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.instagram'>Instagram</Text></label>\n                                    <div class='col-10'>\n                                        <Localizer>\n                                            <input type='text' class='form-control-plaintext' id='instagram'\n                                                data-classid={signup.class}\n                                                data-contestantid={signup.id}\n                                                onInput={this.editSignup}\n                                                value={signup.instagram}\n                                                placeholder={<Text id='races.instagram-help'>Hva er Instagram brukernavnet ditt?</Text>}\n                                            />\n                                        </Localizer>\n                                    </div>\n                                </div>\n                                <div class='form-group row my-0'>\n                                    <label for='team' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.team'>Team</Text></label>\n                                    <div class='col-10'>\n                                        <select class='form-control-plaintext' id='team' aria-describedby='teamHelp'\n                                            data-classid={signup.class}\n                                            data-contestantid={signup.id}\n                                            onInput={this.editSignup}\n                                            value={signup.team}\n                                        >\n                                            <option value=''>-- <Text id='races.choose-team'>Velg team</Text> --</option>\n                                            {teams.map(team => \n                                                <option value={team.id}\n                                                    disabled={skipTeams.indexOf(team.id) > -1}\n                                                >{team.name} {skipTeams.indexOf(team.id) > -1 && team.id !== signup.team ? '(Already signed up!)' : ''}</option>\n                                            )}\n                                        </select>\n                                    </div>\n                                </div>\n                                <div class='form-group row my-0'>\n                                    <label for='team' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.class'>Klasse</Text></label>\n                                    <div class='col-10'>\n                                        <select class='form-control-plaintext' id='class' aria-describedby='classHelp'\n                                            onInput={this.editSignup}\n                                            value={signup.class}\n                                            disabled\n                                        >\n                                            <option value=''>-- <Text id='races.choose-class'>Velg klasse</Text> --</option>\n                                            {race.classes && race.classes.sort((a, b) => a.distance - b.distance).map(currentClass => <>\n                                                <option value={currentClass.id}>\n                                                    {currentClass.title}{!race.liveRace && <>\n                                                        - {currentClass.distance} km - Påmelding: {currentClass.signupfee || race.signupfee} NOK\n                                                    </>}\n                                                </option>\n                                            </>)}\n                                        </select>\n                                    </div>\n                                </div>\n\n                            </div>);\n                        })}\n                        \n                        {race.liveRace === 1 ? <>\n                            Signup is done at the race normal web pages.\n                        </> : <> \n                            {(hasSignedup && !showSignup) ? <>\n                                <button type='button' class='btn btn-sm float-right btn-outline-info' onClick={this.toggleShowSignup}><Text id='races.signup-another-team'>Meld meg på i flere klasser</Text></button>\n                            </> : <>\n\n                                <div class='form-group'>\n                                    <label for='cellphone'><Text id='races.cellphone'>Mobil</Text></label>\n                                    <input type='text' class='form-control' id='cellphone' aria-describedby='cellphoneHelp'\n                                        placeholder={user.cellphone}\n                                        onInput={this.updateSignup}\n                                        value={newSignup.cellphone}\n                                    />\n                                    <small id='cellphoneHelp' class='form-text text-muted'><Text id='races.cellphone-help'>'Hva er mobilnummer ditt?'</Text></small>\n                                </div>\n\n                                <div class='row'>\n                                    <div class='col'>\n                                        <div class='form-group'>\n                                            <label for='firstname'><Text id='races.firstname'>Fornavn</Text></label>\n                                            <input type='text' class='form-control' id='firstname' aria-describedby='firstnameHelp'\n                                                placeholder={user.firstname}\n                                                onInput={this.updateSignup}\n                                                value={newSignup.firstname}\n                                            />\n                                            <small id='firstnameHelp' class='form-text text-muted'><Text id='races.firstname-help'>Hva er fornavnet ditt?</Text></small>\n                                        </div>\n                                    </div>\n                                    <div class='col'>\n                                        <div class='form-group'>\n                                            <label for='lastname'><Text id='races.lastname'>Etternavn</Text></label>\n                                            <input type='text' class='form-control' id='lastname' aria-describedby='lastnameHelp'\n                                                placeholder={user.lastname}\n                                                onInput={this.updateSignup}\n                                                value={newSignup.lastname}\n                                            />\n                                            <small id='lastnameHelp' class='form-text text-muted'><Text id='races.lastname-help'>Hva er etternavnet ditt?</Text></small>\n                                        </div>\n                                    </div>\n                                </div>\n\n                                <div class='form-group'>\n                                    <label for='sportsClub'><Text id='races.sportsclub'>Klubb</Text></label>\n                                    <input type='text' class='form-control' id='sportsClub' aria-describedby='sportsClubHelp'\n                                        placeholder={user.sportsClub}\n                                        onInput={this.updateSignup}\n                                        value={newSignup.sportsClub}\n                                    />\n                                    <small id='sportsClubHelp' class='form-text text-muted'><Text id='races.sportsClub-help'>Hvilken klubb tilhører du?</Text></small>\n                                </div>\n\n                                <div class='row'>\n                                    <div class='col'>\n                                        <div class='form-group'>\n                                            <label for='facebook'><Text id='races.facebook'>Facebook</Text></label>\n                                            <input type='text' class='form-control' id='facebook' aria-describedby='facebookHelp'\n                                                placeholder={user.facebook}\n                                                onInput={this.updateSignup}\n                                                value={newSignup.facebook}\n                                            />\n                                            <small id='facebookHelp' class='form-text text-muted'><Text id='races.facebook-help'>Hva er Facebook brukernavnet ditt?</Text></small>\n                                        </div>\n                                    </div>\n                                    <div class='col'>\n                                        <div class='form-group'>\n                                            <label for='instagram'><Text id='races.instagram'>Instagram</Text></label>\n                                            <input type='text' class='form-control' id='instagram' aria-describedby='instagramHelp'\n                                                placeholder={user.instagram}\n                                                onInput={this.updateSignup}\n                                                value={newSignup.instagram}\n                                            />\n                                            <small id='instagramHelp' class='form-text text-muted'><Text id='races.instagram-help'>Hva er Instagram brukernavnet ditt?</Text></small>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class='form-group'>\n                                    <label for='team'><Text id='races.team'>Team</Text></label>\n                                    {!teams || teams.length === 0 && <>\n                                        <div class='alert alert-danger' role='alert'>\n                                            <Text id='races.no-teams'>Du har ingen team i appen din ennå. Gå inn i appen for å registrer team og forsøk igjen.</Text>\n                                        </div>\n                                    </>}\n                                    <select class='form-control' id='team' aria-describedby='teamHelp'\n                                        onInput={this.updateSignup}\n                                        value={newSignup.team}\n                                    >\n                                        <option value=''>-- <Text id='races.choose-team'>Velg team</Text> --</option>\n                                        {teams.map(team => \n                                            <option value={team.id}\n                                                disabled={skipTeams.indexOf(team.id) > -1}\n                                            >{team.name} {skipTeams.indexOf(team.id) > -1 ? '(Already signed up!)' : ''}</option>\n                                        )}\n                                    </select>\n                                    <small id='teamHelp' class='form-text text-muted'><Text id='races.choose-team-help'>Velg fra dine team</Text></small>\n                                </div>\n\n                                <div class='form-group'>\n                                    <label for='class'><Text id='races.class'>Klasse</Text></label>\n                                    <select class='form-control' id='class' aria-describedby='classHelp'\n                                        onInput={this.updateSignup}\n                                        value={newSignup.class}\n                                    >\n                                        <option value=''>-- <Text id='races.choose-class'>Velg klasse</Text> --</option>\n                                        {race.classes && race.classes.map(currentClass => <>\n                                            <option value={currentClass.id}>{currentClass.title} - {currentClass.distance} km - Påmelding: {currentClass.signupfee || race.signupfee} NOK</option>\n                                        </>)}\n                                    </select>\n                                    <small id='classHelp' class='form-text text-muted'><Text id='races.choose-class-help'>Velg ønsket klasse.</Text></small>\n                                </div>\n\n                                {race.rules && <div class='form-group form-check'>\n                                    <input type='checkbox' class='form-check-input' id='termsAndAgreement'\n                                        onInput={this.updateSignup}\n                                        checked={newSignup.termsAndAgreement}\n                                        value={true}\n                                    />\n                                    <label class='form-check-label' for='termsAndAgreement'><Text id='races.agreement-accept'>Jeg har lest og godtar reglene for løpet.</Text></label>\n                                </div>}\n\n                                {race.declaration && <div class='form-group form-check'>\n                                    <input type='checkbox' class='form-check-input' id='declaration'\n                                        onInput={this.updateSignup}\n                                        checked={newSignup.declaration}\n                                        value={true}\n                                    />\n                                    <label class='form-check-label' for='declaration'><Text id='races.declaration-accept'>Jeg signerer med dette egenærklæringen.</Text></label>\n                                </div>}\n\n                                <button type='button' class='btn btn-primary' onClick={this.signupToRace}><Text id='races.do-signup'>Meld meg på</Text></button>\n\n                                {hasSignedup && <button type='button' class='btn btn-danger float-right' onClick={this.toggleShowSignup}><Text id='races.hide-signup'>Avbryt</Text></button>}\n                            </>}\n                        </>}\n\n                    </> : <>\n\n                        {!subsection && <LoginForm stores={this.props.stores}\n                            routeLoginOk={`/race/${raceid}/signup`}\n                            routeLoginNew={`/race/${raceid}/signup/newUser`}\n                            routeLoginForgot={`/race/${raceid}/signup/forgotPassword`}\n                        />}\n\n                        {subsection === 'newUser' && <LoginRegister stores={this.props.stores}\n                            routeLogin={`/race/${raceid}/signup`}\n                            routeLoginForgot={`/race/${raceid}/signup/forgotPassword`}\n                            skipPubSub={true}\n                        />}\n\n                        {subsection === 'forgotPassword' && <LoginForgot stores={this.props.stores}\n                            routeLogin={`/race/${raceid}/signup`}\n                            routeLoginNew={`/race/${raceid}/signup/newUser`}\n                        />}\n                    </>}\n\n                </> : <>\n                    {today < new Date(race.signupStartDate) ? <>\n                        <h5 class='mt-4'>\n                            <i class='fas fa-exclamation-circle' /> <Text id='races.signup-not-open-yet'>Påmeldingen har ikke åpnet ennå!</Text>\n                        </h5>\n                        <p class='mt-4'>\n                            <Text id='races.signup-opening'>Påmeldingen åpner</Text>:<br />\n                            <span class='display-4'>{util.formatDate(race.signupStartDate, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</span>\n                        </p>\n                    </> : <>\n                        <h5 class='mt-4 mb-4'>\n                            <i class='fas fa-exclamation-circle' /> <Text id='races.signup-closed'>Påmeldingen er stengt!</Text>\n                        </h5>\n                    </>}\n                </>}\n            </>\n\t\t);\n\t}\n}\n\nexport default PublicRaceDetailSignup;\n","import { h, Component } from 'preact';\nimport { observer } from 'mobx-preact';\nimport { toJS } from 'mobx';\nimport util from 'preact-util';\n\nimport DragNDropFileupload from './dragNdropFileupload';\n\n@observer\nclass Images extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            files: [],\n        };\n    }\n    \n    handleAddImage = (file) => {\n        const { addToImages = true } = this.props;\n\n        // <Images saved={saved} object={dog} field={field} updateField={updateField} />\n        // updateFieldValue = ({ id, field, value, datatype, elementtype, isNew = false, skipTimer = false }) => {\n        const {\n            updateField,\n            object,\n            field,\n        } = this.props;\n\n        if (field) {\n            updateField({ id: object.id, field, value: file, skipTimer: true });\n        }\n\n        // let images = toJS(object.images);\n        // if (!util.isArray(images)) {\n        //     images = [];\n        // }\n        if (addToImages) {\n            const images = [];\n            images.push(file);\n            updateField({ id: object.id, field: 'images', value: images, skipTimer: true });\n        }\n        // const allImages = [];\n        // allImages.push(file);\n        // updateField({ id: object.id, field: 'allImages', value: allImages, skipTimer: true });\n    };\n\n    render() {\n        const { uploadStatus = () => {}, before = () => {}, after = () => {}, autoOpen = true } = this.props;\n        return (\n            <div class='row'>\n                <div class='col-12'>\n                    <DragNDropFileupload\n                        handleAddImage={this.handleAddImage}\n                        uploadStatus={uploadStatus}\n                        apiUrl={'/api/fileupload'}\n                        before={before}\n                        after={after}\n                        autoOpen={autoOpen}\n                    >\n                        <div style={{ height: 30, width: '100%' }}>\n                            {/* {files.map((file, idx) => (\n                                <div key={idx}>\n                                    {file.name}\n                                    Total: {util.asString(file, 'load', 'total')}\n                                    <img style='width: 48px;'\n                                        alt='Preview'\n                                        key={file.preview}\n                                        src={file.src}\n                                    />\n                                </div>\n                            ))} */}\n                        </div>\n                    </DragNDropFileupload>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default Images;\n","import { h, Component } from 'preact';\nimport { useEffect } from \"preact/hooks\";\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport linkstate from 'linkstate';\nimport Markdown from 'preact-markdown';\n\nimport Header from './header';\nimport Submenu from './submenu';\nimport DetailSignup from './detail-signup.js';\n\nimport LoginForm from '../../../components/login/loginForm';\nimport LoginRegister from '../../../components/register';\nimport LoginForgot from '../../../components/forgotten';\nimport RaceComments from './comments';\nimport RaceAddComment from './commentAdd';\nimport RaceText from './raceText';\nimport Images from '../../../components/form/images';\n\nimport mu from '../../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(true, true);\nconst MARGIN_BOTTOM = mu.marginBottom();\n\nfunction PageTitle(title) {\n  useEffect(() => {\n    document.title = `Homerun Race: ${title}`;\n  }, [title]);\n  return <h1 class='my-0'>{title}</h1>;\n}\n\nconst initialState = {\n\tisLoading: false,\n\temail: '',\n\tsubmenu: 'ads',\n\tjwtToken: util.getJwtToken(),\n\tnewRaceArticle: {},\n\tnewRaceUserImage: {},\n};\n\n@observer\nclass PublicRaceDetail extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n\t\tthis.inputRef = {};\n\t\tthis.updateTimer = {};\n    }\n\n\tasync loadRace(props = this.props) {\n\t\tthis.setState({ isLoading: true });\n\t\tconst { raceStore, userStore } = props.stores;\n\t\tconst { user = {} } = userStore;\n\t\tconst { raceid } = props;\n\t\tawait raceStore.load(raceid);\n\t\traceStore.countAll();\n\t\tthis.setState({ isLoading: false });\n\n\t\tlet signup = {};\n\t\traceStore.resetSignup();\n\t\tconst { race } = raceStore;\n\t\tif (race.classes && user && user.email) {\n\t\t\tfor (let i = 0, l = race.classes.length; i < l; i += 1) {\n\t\t\t\tconst currentClass = race.classes[i];\n\t\t\t\tif (currentClass.contestants) {\n\t\t\t\t\tconst idx = currentClass.contestants.findIndex(e => e.email === user.email);\n\t\t\t\t\tif (idx > -1) {\n\t\t\t\t\t\tsignup = { ...currentClass.contestants[idx], class: currentClass.id };\n\t\t\t\t\t\traceStore.addSignup(signup);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\traceStore.updateKeyValue('signup', signup);\n\n\t\tthis.resizeAllTextareas();\n\t}\n\n\tlikeRace = async () => {\n\t\tconst { raceStore } = this.props.stores;\n\t\tconst { race } = raceStore;\n\t\tconst response = await raceStore.likeRace({ id: race.id });\n\n        if (response && response.status === 200) {\n\t\t\t// this.loadRaceDetail({ race });\n\t\t}\n\t}\n\n\ttoggleAddComment = (e) => {\n\t\tconst raceId = e.target.parentElement.dataset.id || e.target.dataset.id;\n\t\tconst { showAddComment } = this.state;\n\t\tthis.setState({\n\t\t\tshowAddComment: !showAddComment,\n\t\t}, () => {\n\t\t\tif (this.inputRef[raceId]) {\n\t\t\t\tthis.inputRef[raceId].focus();\n\t\t\t}\n\t\t});\n\t}\n\n\taddRaceArticle = async () => {\n\t\tconst { raceid } = this.props;\n        const { raceStore } = this.props.stores;\n\t\tconst { newRaceArticle } = this.state;\n\t\tawait raceStore.addArticle({ id: raceid, newArticle: newRaceArticle });\n\t\tthis.setState({\n\t\t\tnewRaceArticle: {},\n\t\t});\n\t}\n\n\taddRaceUserImage = async () => {\n\t\tconst { raceid } = this.props;\n        const { raceStore } = this.props.stores;\n\t\tconst { newRaceUserImage } = this.state;\n\t\tawait raceStore.addUserImage({ id: raceid, newUserImage: newRaceUserImage });\n\t\tthis.setState({\n\t\t\tnewRaceUserImage: {},\n\t\t});\n\t}\n\n\tupdateUserImageUpload = ({ field, value }) => {\n\t\t// updateField({ id: object.id, field: 'images', value: images, skipTimer: true });\n\t\tconst { newRaceUserImage } = this.state;\n\t\tnewRaceUserImage[field] = value;\n\t\tthis.setState({ newRaceUserImage });\n\t}\n\n\tupdateArticleUpload = ({ field, value }) => {\n\t\t// updateField({ id: object.id, field: 'images', value: images, skipTimer: true });\n\t\tconst { newRaceArticle } = this.state;\n\t\tnewRaceArticle[field] = value;\n\t\tthis.setState({ newRaceArticle });\n\t}\n\n\tremoveRaceArticle = async (e) => {\n\t\tconst id = e.target.parentElement.dataset.id || e.target.dataset.id;\n\t\tconst { raceid } = this.props;\n        const { raceStore } = this.props.stores;\n\t\tawait raceStore.removeArticle({\n\t\t\tid: raceid,\n\t\t\tarticleId: id,\n\t\t});\n\t}\n\n\tremoveRaceUserImage = async (e) => {\n\t\tconst id = e.target.parentElement.dataset.id || e.target.dataset.id;\n\t\tconst { raceid } = this.props;\n        const { raceStore } = this.props.stores;\n\t\tawait raceStore.removeUserImage({\n\t\t\tid: raceid,\n\t\t\tuserImageId: id,\n\t\t});\n\t}\n\n\teditRaceArticle = async (e) => {\n\t\tconst { id, field } = e.target.dataset;\n\t\tconst { value } = e.target;\n\t\tconst { raceid } = this.props;\n\t\tconst { raceStore } = this.props.stores;\n\t\tconst data = {\n\t\t\traceArticleId: id,\n\t\t\t[`raceArticle${util.ucfirst(field)}`]: value,\n\t\t};\n\t\tclearTimeout(this.updateTimer[`${raceid}-${id}-${field}`]);\n\t\tthis.updateTimer[`${raceid}-${id}-${field}`] = setTimeout(async () => {\n\t\t\traceStore.editArticle({\n\t\t\t\tid: raceid,\n\t\t\t\tdata,\n\t\t\t});\n\t\t}, 1500);\n\n\t\tthis.resizeTextarea(e.target);\n\t}\n\n\teditRaceUserImage = async (e) => {\n\t\tconst { id, field } = e.target.dataset;\n\t\tconst { value } = e.target;\n\t\tconst { raceid } = this.props;\n\t\tconst { raceStore } = this.props.stores;\n\t\tconst data = {\n\t\t\traceUserImageId: id,\n\t\t\t[`raceUserImage${util.ucfirst(field)}`]: value,\n\t\t};\n\t\tclearTimeout(this.updateTimer[`${raceid}-${id}-${field}`]);\n\t\tthis.updateTimer[`${raceid}-${id}-${field}`] = setTimeout(async () => {\n\t\t\traceStore.editUserImage({\n\t\t\t\tid: raceid,\n\t\t\t\tdata,\n\t\t\t});\n\t\t}, 1500);\n\n\t\tthis.resizeTextarea(e.target);\n\t}\n\n\tresizeAllTextareas = () => {\n\t\tconst textareaList = document.getElementsByTagName('textarea');\n\t\tfor(let i = 0, l = textareaList.length; i < l; i += 1){\n\t\t\tconst textarea = textareaList[i];\n\t\t\tthis.resizeTextarea(textarea);\n\t\t}\n\t}\n\n\tresizeTextarea = (el) => {\n\t\tlet element = el;\n\t\tif (element.target) {\n\t\t\telement = el.target;\n\t\t}\n\t\tconst { scrollHeight } = element;\n\t\telement.style.height = `${scrollHeight}px`;\n\t}\n\n\thandleImageErrored = (e) => {\n        const image = e.target;\n        image.onerror = null;\n        setTimeout(() => {\n            image.src += `?${new Date()}`;\n        }, 1000);\n    }\n\n\tcomponentDidMount() {\n\t\tthis.loadRace();\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {\n\t\tthis.loadRace(nextProps);\n\t}\n\n\trender() {\n\t\tconst { showAddComment, newRaceArticle, newRaceUserImage } = this.state;\n\t\tconst { appState, userStore, raceStore } = this.props.stores;\n\t\tconst { allUsers, isAdmin, user = {}, notifications = [], teams = [] } = userStore;\n\t\tconst { raceid, path, section, subsection, col = 12, offset = 0 } = this.props;\n\t\tconst { darkmode, language = 'en' } = appState;\n\t\tconst { race, totalClasses, totalContestants } = raceStore;\n\n\t\tconst { likes = [], comments = [] } = race;\n\t\tconst hasLikedRace = race.likes && race.likes.findIndex(e => e.user === user.id) > -1;\n\n\t\tconst today = new Date();\n\t\tlet status = '';\n\t\tif (today >= new Date(race.startDate) && today <= new Date(race.endDate)) {\n\t\t\tstatus = 'race';\n\t\t} else if (today >= new Date(race.signupStartDate) && today <= new Date(race.signupEndDate)) {\n\t\t\tstatus = 'signup';\n\t\t} else if (today > new Date(race.endDate)) {\n\t\t\tstatus = 'done';\n\t\t}\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<Header stores={this.props.stores} />\n\n\t\t\t\t<div class='container-fluid position-relative' style={`margin-bottom: ${MARGIN_BOTTOM}; margin-top: ${MARGIN_TOP};`}>\n\t\t\t\t\t<Submenu stores={this.props.stores} path={path} raceid={raceid} />\n\n\t\t\t\t\t{isAdmin && <span class='float-right position-absolute' style='top: 10px; right: 10px; z-index:10000;'>\n\t\t\t\t\t\t<a href={`/race/${raceid}/edit`} class='btn btn-small btn-primary'>\n\t\t\t\t\t\t\t<nobr><i class='fas fa-chart-line' /> <Text id='race.edit'>Endre løpet</Text></nobr>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</span>}\n\n\t\t\t\t\t<div class='row border-bottom '>\n\t\t\t\t\t\t<div class='col-12'>\n\t\t\t\t\t\t\t{/* <span class='position-absolute d-none d-lg-block' style='top: 0px; right: 0px;'>\n\t\t\t\t\t\t\t\t<iframe width='350' height='450' src='https://www.spleis.no/project/164024/embed' frameborder='0' />\n\t\t\t\t\t\t\t</span> */}\n\n\t\t\t\t\t\t\t<div class='jumbotron-thumb d-flex align-items-center position-relative'>\n\t\t\t\t\t\t\t\t{(race.images && race.images[0]) ? <img src={race.images[0].s3XXLargeLink} class='img-fluid border rounded-lg' style='min-width: 100%' /> : ''}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<h3 class='float-right'>\n\t\t\t\t\t\t\t\t{status === 'signup' && !race.liveRace && <>\n\t\t\t\t\t\t\t\t\t<div class='spinner-grow text-primary' role='status' />\n\t\t\t\t\t\t\t\t\t<span class='badge badge-primary ml-2'><Text id='races.signup-open'>Påmelding åpen</Text></span>\n\t\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t\t\t{status === 'race' && <>\n\t\t\t\t\t\t\t\t\t<div class='spinner-grow text-danger' role='status' />\n\t\t\t\t\t\t\t\t\t<span class='badge badge-danger ml-2'><Text id='races.race-in-progress'>Løp pågår</Text></span>\n\t\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t\t\t{status === 'done' && <>\n\t\t\t\t\t\t\t\t\t<i class='fas fa-check text-success' />\n\t\t\t\t\t\t\t\t\t<span class='badge badge-success ml-2'><Text id='races.race-finished'>Løp avsluttet</Text></span>\n\t\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t<h1 class='float-right'>\n\t\t\t\t\t\t\t\t{isAdmin && <i class={`fas fa-eye${race.active ? ' text-success' : '-slash text-danger'} float-right`} />}\n\t\t\t\t\t\t\t</h1>\n\t\t\t\t\t\t\t{PageTitle(race.title)}\n\t\t\t\t\t\t\t{totalContestants > 10 ? <span class='text-muted font-weight-lighter'><Text id='races.starting-teams' fields={{ totalContestants, totalClasses }} /></span> : <></>}\n\t\t\t\t\t\t\t<div class='text-muted mt-2'>\n\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t{race.startDate && <>{util.formatDate(race.startDate, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</>}\n\t\t\t\t\t\t\t\t\t{race.endDate && <> - {util.formatDate(race.endDate, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</>}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=''>\n\t\t\t\t\t\t\t\t\t{race.tag && race.tag.split(',').map(tag => <>\n\t\t\t\t\t\t\t\t\t\t<span class='badge badge-pill badge-primary py-1 ml-2'>\n\t\t\t\t\t\t\t\t\t\t\t<a class='text-white' href={`https://www.facebook.com/hashtag/${tag}`} target='_blank' rel='noreferrer' native>\n\t\t\t\t\t\t\t\t\t\t\t\t<i class='fab fa-facebook' /> #{tag}\n\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t<span class='badge badge-pill badge-primary py-1 ml-2'>\n\t\t\t\t\t\t\t\t\t\t\t<a class='text-white' href={`https://www.instagram.com/explore/tags/${tag}`} target='_blank' rel='noreferrer' native>\n\t\t\t\t\t\t\t\t\t\t\t\t<i class='fab fa-instagram' /> #{tag}\n\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t{race.contactEmail && <span class='ml-2'>\n\t\t\t\t\t\t\t\t\t<a href={`mailto:${race.contactEmail}subject=Regarding ${race.title}&body=Write your question here :)`}><i class='fas fa-envelope' /> {race.contactEmail}</a>\n\t\t\t\t\t\t\t\t</span>}\n\t\t\t\t\t\t\t\t{race.facebook && <span class='ml-2'>\n\t\t\t\t\t\t\t\t\t<a href={`${race.facebook}`} target='_blank' rel='noreferrer' native><i class='fab fa-facebook' /> Facebook</a>\n\t\t\t\t\t\t\t\t</span>}\n\t\t\t\t\t\t\t\t{race.instagram && <span class='ml-2'>\n\t\t\t\t\t\t\t\t\t<a href={`${race.instagram}`} target='_blank' rel='noreferrer' native><i class='fab fa-instagram' /> Instagram</a>\n\t\t\t\t\t\t\t\t</span>}\n\t\t\t\t\t\t\t\t{race.signuppayment && <span class='badge badge-pill badge-success py-1 ml-2'>\n\t\t\t\t\t\t\t\t\t<span class='font-weight-lighter'><Text id='race.signup-payment'>Betaling påmelding</Text>:</span> {mu.replaceImages(race.signuppayment, race.images, language, false)}\n\t\t\t\t\t\t\t\t</span>}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{race.locationCity && <div class='text-muted'>\n\t\t\t\t\t\t\t\t<Text id='race.location'>Sted</Text>: {race.locationCity}, {race.locationCountry}\n\t\t\t\t\t\t\t</div>}\n\n\t\t\t\t\t\t\t{/* contactEmail\n\t\t\t\t\t\t\tcontactCellphone\n\t\t\t\t\t\t\tfacebook\n\t\t\t\t\t\t\tinstagram */}\n\n\t\t\t\t\t\t\t<ul class='nav nav-tabs my-3'>\n\t\t\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t\t\t<a class={`nav-link ${!section ? 'active' :''}`} href={`/race/${raceid}`}><i class='fas fa-info-circle' /> <Text id='race.about'>Om løpet</Text></a>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t\t\t<a class={`nav-link ${section === 'news' ? 'active' :''}`} href={`/race/${raceid}/news`}><i class='fas fa-rss' /> <Text id='race.news'>Nyheter</Text></a>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t\t\t<a class={`nav-link ${section === 'rules' ? 'active' :''}`} href={`/race/${raceid}/rules`}><i class='fas fa-gavel' /> <Text id='race.rules'>Regler</Text></a>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t{race.veterinaryInfo && <li class='nav-item'>\n\t\t\t\t\t\t\t\t\t<a class={`nav-link ${section === 'veterinaryInfo' ? 'active' :''}`} href={`/race/${raceid}/veterinaryInfo`}><i class='fas fa-stethoscope' /> <Text id='race.veterinary'>Veterinærinfo</Text></a>\n\t\t\t\t\t\t\t\t</li>}\n\t\t\t\t\t\t\t\t{race.checkpoints && <li class='nav-item'>\n\t\t\t\t\t\t\t\t\t<a class={`nav-link ${section === 'checkpoints' ? 'active' :''}`} href={`/race/${raceid}/checkpoints`}><i class='fas fa-map-marker-alt' /> <Text id='race.checkpoints'>Sjekkpunkter</Text></a>\n\t\t\t\t\t\t\t\t</li>}\n\t\t\t\t\t\t\t\t{race.trailDescription && <li class='nav-item'>\n\t\t\t\t\t\t\t\t\t<a class={`nav-link ${section === 'trailDescription' ? 'active' :''}`} href={`/race/${raceid}/trailDescription`}><i class='fas fa-map-signs' /> <Text id='race.track-description'>Løypebeskrivelse</Text></a>\n\t\t\t\t\t\t\t\t</li>}\n\t\t\t\t\t\t\t\t{race.program && <li class='nav-item'>\n\t\t\t\t\t\t\t\t\t<a class={`nav-link ${section === 'program' ? 'active' :''}`} href={`/race/${raceid}/program`}><i class='fas fa-list-alt' /> <Text id='race.program'>Program</Text></a>\n\t\t\t\t\t\t\t\t</li>}\n\t\t\t\t\t\t\t\t{race.prices && <li class='nav-item'>\n\t\t\t\t\t\t\t\t\t<a class={`nav-link ${section === 'prices' ? 'active' :''}`} href={`/race/${raceid}/prices`}><i class='fas fa-award' /> <Text id='race.prices'>Premier</Text></a>\n\t\t\t\t\t\t\t\t</li>}\n\t\t\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t\t\t<a class={`nav-link ${section === 'classes' ? 'active' :''}`} href={`/race/${raceid}/classes`}><i class='fas fa-folder-open' /> <Text id='race.classes'>Klasser</Text></a>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t\t\t<a class={`nav-link ${section === 'signup' ? 'active' :''}`} href={`/race/${raceid}/signup`}><i class='fas fa-folder-open' /> <Text id='race.signup'>Påmelding</Text></a>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t</ul>\n\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class={`col-${col} offset-${offset} col-sm-8 col-lg-8 offset-sm-2 offset-lg-2`}>\n\t\t\t\t\t\t\t{!section && <>\n\n\t\t\t\t\t\t\t\t{race.articles && race.articles.length > 0 && <div class='row'>\n\t\t\t\t\t\t\t\t\t<div class='col-12 mb-3 py-2 position-relative border-bottom bg-light'>\n\t\t\t\t\t\t\t\t\t\t<small>\n\t\t\t\t\t\t\t\t\t\t\t<div class='font-weight-bold'>\n\t\t\t\t\t\t\t\t\t\t\t\t<i class='fas fa-rss' /> <Text id='race.news'>Nyheter</Text>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t\t\t\t\t\t{race.articles && race.articles.reverse().slice(0, 3).map(currentArticle => <>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class='col-12 col-sm-6 col-md-4 col-lg-4 p-3 position-relative'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{currentArticle.image && <img src={currentArticle.image.s3LargeLink} class='float-right rounded-lg ml-2' style='height: 70px;' />}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class='text-muted font-weight-light mr-2'>{util.formatDate(currentArticle.date, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class='font-weight-bold mr-2' style='font-size: 1.2em;'><a href={`/race/${raceid}/news`} class={`text-${darkmode ? 'light' : 'dark'}`}>{mu.replaceImages(currentArticle.title, race.images, language, false)}</a></span><br />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class='font-weight-normal'>{mu.replaceImages(currentArticle.body, race.images, language, false)}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t\t\t\t\t{race.articles.length > 3 && <div class='col-12 mt-2 text-center' style='font-size: 1.5em;'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a href={`/race/${raceid}/news`} class='text-muted'><Text id='race.more-news'>Flere nyheter</Text> &raquo;</a>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</small>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>}\n\n\t\t\t\t\t\t\t\t<p class='clearfix'>\n\t\t\t\t\t\t\t\t\t<strong>\n\t\t\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(race.ingress, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t\t\t</strong>\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(race.body, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t\t{section === 'news' && <>\n\t\t\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t\t\t<div class='col-12'>\n\t\t\t\t\t\t\t\t\t\t<h2><Text id='race.news'>Nyheter</Text></h2>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t{race.articles && race.articles.reverse().map(currentArticle => <>\n\t\t\t\t\t\t\t\t\t\t<div class='col-12 col-sm-12 col-md-6 col-lg-4 p-3 position-relative'>\n\t\t\t\t\t\t\t\t\t\t\t<h5>{mu.replaceImages(currentArticle.title, race.images, language, false)}</h5>\n\t\t\t\t\t\t\t\t\t\t\t{currentArticle.image && <img src={currentArticle.image.s3LargeLink} class='float-right w-50 rounded-lg ml-2' />}\n\t\t\t\t\t\t\t\t\t\t\t<small class='text-muted'> {util.formatDate(currentArticle.date, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</small><br />\n\t\t\t\t\t\t\t\t\t\t\t<div class='font-weight-bold'>\n\t\t\t\t\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(currentArticle.ingress, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(currentArticle.body, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t\t{section === 'rules' && <>\n\t\t\t\t\t\t\t\t<h2><Text id='race.rules'>Regler</Text></h2>\n\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(race.rules, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t\t{section === 'veterinaryInfo' && <>\n\t\t\t\t\t\t\t\t<h2><Text id='race.veterinary'>Veterinærinfo</Text></h2>\n\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(race.veterinaryInfo, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t\t{section === 'checkpoints' && <>\n\t\t\t\t\t\t\t\t<h2><Text id='race.checkpoints'>Sjekkpunkter</Text></h2>\n\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(race.checkpoints, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t\t{section === 'trailDescription' && <>\n\t\t\t\t\t\t\t\t<h2><Text id='race.track-description'>Løypebeskrivelse</Text></h2>\n\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(race.trailDescription, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t\t{section === 'program' && <>\n\t\t\t\t\t\t\t\t<h2><Text id='race.program'>Program</Text></h2>\n\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(race.program, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t\t{section === 'prices' && <>\n\t\t\t\t\t\t\t\t<h2><Text id='race.prices'>Premier</Text></h2>\n\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(race.prices, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t\t{section === 'classes' && <>\n\t\t\t\t\t\t\t\t<h2><Text id='race.classes'>Klasser</Text></h2>\n\t\t\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t\t\t{race.classes && race.classes.sort((a, b) => a.distance - b.distance).map(currentClass => <>\n\t\t\t\t\t\t\t\t\t\t<div class='col-6 col-sm-6 col-lg-4 mb-4'>\n\t\t\t\t\t\t\t\t\t\t\t<div class='border rounded rounded-lg p-3'>\n\t\t\t\t\t\t\t\t\t\t\t\t<h5>{currentClass.title}</h5>\n\n\t\t\t\t\t\t\t\t\t\t\t\t<small>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{currentClass.startDate && <div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class='font-weight-lighter'><Text id='race.startdate'>Start</Text>:</span> {util.formatDate(`${currentClass.startDate} ${currentClass.startTime || '00:00:00'}`, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>}\n\t\t\t\t\t\t\t\t\t\t\t\t\t{currentClass.endDate && <div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class='font-weight-lighter'><Text id='race.enddate'>End</Text>:</span> {util.formatDate(`${currentClass.endDate} ${currentClass.endTime || '00:00:00'}`, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>}\n\t\t\t\t\t\t\t\t\t\t\t\t</small>\n\n\t\t\t\t\t\t\t\t\t\t\t\t<div><span class='font-weight-lighter'><Text id='race.distance'>Distanse</Text>:</span> {currentClass.distance} km</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div><span class='font-weight-lighter'><Text id='race.signup'>Påmelding</Text>:</span> {currentClass.signupfee || race.signupfee} NOK</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<p class='clearfix'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(currentClass.ingress, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t<small>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(currentClass.body, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t\t\t\t\t\t</small>\n\t\t\t\t\t\t\t\t\t\t\t\t{currentClass.rules && <>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<h5><Text id='race.rules'>Regler</Text></h5>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(currentClass.rules, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\t\t\t\t\t\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t\t{section === 'signup' && <DetailSignup stores={this.props.stores} raceid={raceid} subsection={subsection} />}\n\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/* <div class='row'>\n\t\t\t\t\t\t\t<div class='col-12'>\n\t\t\t\t\t\t\t\t{race.images && race.images.map(image => <>\n\t\t\t\t\t\t\t\t\t<div class='d-flex mx-0'>\n\t\t\t\t\t\t\t\t\t\t<img src={image.s3LargeLink} class='img-fluid align-middle' />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div> */}\n\n\t\t\t\t\t\t<div class={`col-${col} offset-${offset} col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mt-5`}>\n\t\t\t\t\t\t\t{likes && likes.length > 0 && <small class='bg-light shadow-sm rounded-lg py-0 px-1' style='bottom: 20px; right: 15px;'>\n\t\t\t\t\t\t\t\t<i class='fas fa-thumbs-up text-primary' /> {likes.length}\n\t\t\t\t\t\t\t</small>}\n\t\t\t\t\t\t\t{comments && comments.length > 0 && <small class='float-right bg-light shadow-sm rounded-lg py-0 px-1' style='bottom: 20px; right: 15px;'>\n\t\t\t\t\t\t\t\t<i class='fas fa-comment text-primary' /> {comments.length}\n\t\t\t\t\t\t\t</small>}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{user.email && <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-2 mb-3'>\n\t\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t\t<div class='col-6 text-center'>\n\t\t\t\t\t\t\t\t\t<button type='button' class={`btn btn-outline-${hasLikedRace ? 'primary' : 'secondary'} btn-lg btn-block ${hasLikedRace ? 'text-primary' : ''}`}\n\t\t\t\t\t\t\t\t\t\tonClick={this.likeRace}\n\t\t\t\t\t\t\t\t\t\t// disabled={hasLikedRace}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<i class={`${hasLikedRace ? 'text-primary fas' : 'far'} fa-thumbs-up`} /> Like\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class='col-6 text-center'>\n\t\t\t\t\t\t\t\t\t<button type='button' class='btn btn-outline-secondary btn-lg btn-block'\n\t\t\t\t\t\t\t\t\t\tdata-id={race.id}\n\t\t\t\t\t\t\t\t\t\tonClick={this.toggleAddComment}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<i class='fas fa-comment' /> Comment\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>}\n\t\t\t\t\t\t<div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-2 mb-3'>\n\t\t\t\t\t\t\t{showAddComment && user.email && <RaceAddComment\n\t\t\t\t\t\t\t\tstores={this.props.stores}\n\t\t\t\t\t\t\t\trace={race}\n\t\t\t\t\t\t\t\t// callback={this.loadRaceDetail}\n\t\t\t\t\t\t\t\tinputRef={c => this.inputRef[race.id] = c}\n\t\t\t\t\t\t\t\tinputRefObject={this.inputRef}\n\t\t\t\t\t\t\t/>}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class='col-12 mt-2'>\n\t\t\t\t\t\t\t<RaceComments\n\t\t\t\t\t\t\t\tstores={this.props.stores}\n\t\t\t\t\t\t\t\trace={race}\n\t\t\t\t\t\t\t\tcols='12'\n\t\t\t\t\t\t\t\t// callback={this.loadRaceDetail}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{isAdmin && <>\n\t\t\t\t\t\n\t\t\t\t\t\t\t\t<h2 class='mt-5'>Articles</h2>\n\t\t\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t\t\t{race.articles && race.articles.map(currentArticle => <>\n\t\t\t\t\t\t\t\t\t\t<div class='col-12 col-sm-6 col-md-4 col-lg-3 border rounded-lg p-3 position-relative'>\n\t\t\t\t\t\t\t\t\t\t\t<button class='btn btn-danger position-absolute' style='top:5px; right: 5px;' data-id={currentArticle.id} onClick={this.removeRaceArticle}>\n\t\t\t\t\t\t\t\t\t\t\t\t<i class='fas fa-times' />\n\t\t\t\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t\t\t\t{currentArticle.image && <img src={currentArticle.image.s3LargeLink} class='float-right w-100' />}\n\n\t\t\t\t\t\t\t\t\t\t\t{['title'].map(field => <>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type='text' class='form-control-plaintext font-weight-bold' id={field} aria-describedby={`${field}Help`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle='font-size: 1.5em;'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-id={currentArticle.id}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-field={field}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={currentArticle[field]}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonInput={this.editRaceArticle}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t\t\t\t{['ingress', 'body'].map(field => <>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<textarea type='textarea' class='form-control-plaintext' id={field} aria-describedby={`${field}Help`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-id={currentArticle.id}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-field={field}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={currentArticle[field]}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonInput={this.editRaceArticle}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle='height: 1em;'\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t\t\t<div class='col-6 offset-3 border rounded-lg m-2 p-3 bg-light'>\n\t\t\t\t\t\t\t\t\t\t<h5>Add new article</h5>\n\t\t\t\t\t\t\t\t\t\t{newRaceArticle && newRaceArticle.image && <img src={newRaceArticle.image.s3LargeLink} class='float-right w-50'  onError={this.handleImageErrored} />}\n\n\t\t\t\t\t\t\t\t\t\t{['title'].map(field => <>\n\t\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\n\t\t\t\t\t\t\t\t\t\t\t\t<label for={field}>{field}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t<input type='text' class='form-control' id={field} aria-describedby={`${field}Help`}\n\t\t\t\t\t\t\t\t\t\t\t\t\tonInput={linkstate(this, `newRaceArticle.${field}`)}\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={newRaceArticle[field]}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t\t\t{['ingress', 'body'].map(field => <>\n\t\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\n\t\t\t\t\t\t\t\t\t\t\t\t<label for={field}>{field}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t<textarea type='text' class='form-control' id={field} aria-describedby={`${field}Help`}\n\t\t\t\t\t\t\t\t\t\t\t\t\tonInput={linkstate(this, `newRaceArticle.${field}`)}\n\t\t\t\t\t\t\t\t\t\t\t\t\tonKeyUp={this.resizeTextarea}\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle='height: 1em;'\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={newRaceArticle[field]}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t</>)}\n\n\t\t\t\t\t\t\t\t\t\t<Images saved={{}} object={{}} field={'image'} updateField={this.updateArticleUpload} autoOpen={false} />\n\n\t\t\t\t\t\t\t\t\t\t<button class='btn btn-info' onClick={this.addRaceArticle}>Add race article</button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t\t\t<h2 class='mt-5'>User images</h2>\n\t\t\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t\t\t{race.userImages && race.userImages.map(currentUserImage => <>\n\t\t\t\t\t\t\t\t\t\t<div class='col-12 col-sm-6 col-md-4 col-lg-3 border rounded-lg p-3 position-relative'>\n\t\t\t\t\t\t\t\t\t\t\t<button class='btn btn-danger position-absolute' style='top:5px; right: 5px;' data-id={currentUserImage.id} onClick={this.removeRaceUserImage}>\n\t\t\t\t\t\t\t\t\t\t\t\t<i class='fas fa-times' />\n\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t<img src={currentUserImage.image.s3LargeLink} class='float-right w-100' />\n\n\t\t\t\t\t\t\t\t\t\t\t{['title'].map(field => <>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class='form-group '>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type='text' class='form-control-plaintext font-weight-bold' id={field} aria-describedby={`${field}Help`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle='font-size: 1.5em;'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-id={currentUserImage.id}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-field={field}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={currentUserImage[field]}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonInput={this.editRaceUserImage}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t\t\t\t{['body'].map(field => <>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<textarea type='textarea' class='form-control-plaintext' id={field} aria-describedby={`${field}Help`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-id={currentUserImage.id}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-field={field}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={currentUserImage[field]}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonInput={this.editRaceUserImage}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle='height: 1em;'\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t\t\t<div class='col-3 offset-3 border rounded-lg m-2 p-3 bg-light'>\n\t\t\t\t\t\t\t\t\t\t<h5>Add new user image</h5>\n\t\t\t\t\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t\t\t\t\t<div class='col'>\n\t\t\t\t\t\t\t\t\t\t\t\t{newRaceUserImage && newRaceUserImage.image && <img src={newRaceUserImage.image.s3LargeLink} class='float-right w-50'  onError={this.handleImageErrored} />}\n\t\t\t\t\t\t\t\t\t\t\t\t{['title'].map(field => <>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<label for={field}>{field}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type='text' class='form-control' id={field} aria-describedby={`${field}Help`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonInput={linkstate(this, `newRaceUserImage.${field}`)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={newRaceUserImage[field]}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t\t\t\t\t{['body'].map(field => <>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<label for={field}>{field}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<textarea type='text' class='form-control' id={field} aria-describedby={`${field}Help`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonInput={linkstate(this, `newRaceUserImage.${field}`)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonKeyUp={this.resizeTextarea}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle='height: 1em;'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={newRaceUserImage[field]}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t                    <Images saved={{}} object={{}} field={'image'} updateField={this.updateUserImageUpload} autoOpen={false} />\n\n\t\t\t\t\t\t\t\t\t\t<button class='btn btn-info' onClick={this.addRaceUserImage}>Add race user image</button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\n\t\t\t\t\t</>}\n\t\t\t\t</div>\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default PublicRaceDetail;\n","import { h, Component, createRef } from 'preact';\nimport { observer } from 'mobx-preact';\nimport util from 'preact-util';\nimport { Text, Localizer, withText } from 'preact-i18n';\n\nconst debug = false;\nconst debugName = 'Images';\n\n@observer\nclass DragNDropFileupload extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            drag: false,\n            loadingProgress: 0,\n            uploadedFiles: [],\n            uploadedFilesData: {},\n        };\n    }\n\n    dropRef = createRef();\n\n    handleDrag = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n    }\n\n    handleDragIn = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.dragCounter++;\n        if (e.dataTransfer.items && e.dataTransfer.items.length > 0) {\n            this.setState({ drag: true });\n        }\n    }\n\n    handleDragOut = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.dragCounter--;\n        if (this.dragCounter === 0) {\n            this.setState({ drag: false });\n        }\n    }\n\n    handleDrop = (e) => {\n        if (debug) {\n            console.log(`${debugName}.handleDrop: event`, e);\n        }\n        e.preventDefault();\n        e.stopPropagation();\n        this.setState({ drag: false });\n        if (e.dataTransfer.files && e.dataTransfer.files.length > 0) {\n            // this.props.handleDrop(e.dataTransfer.files);\n            // e.dataTransfer.clearData();\n            for (let i = 0, l = e.dataTransfer.files.length; i < l; i += 1) {\n                const photo = e.dataTransfer.files[i];\n                // if (photo.type.match('image.*')) {\n                this.readLocalFile(photo);\n                // }\n            }\n            this.dragCounter = 0;\n        }\n    }\n\n    // Upload\n    handleAddFiles = (event) => {\n        event.preventDefault();\n        const el = event.target;\n        if (debug) {\n            console.log(`${debugName}.handleAddFiles: event, el`, event, el);\n        }\n        for (let i = 0, l = el.files.length; i < l; i += 1) {\n            const photo = el.files[i];\n            // if (photo.type.match('image.*')) {\n            this.readLocalFile(photo);\n            // }\n        }\n    }\n\n    handleEvent = (e, fileObject) => {\n        if (debug) {\n            console.log(`${debugName}.handleEvent[${fileObject.name}]: ${e.type}: `\n                + `${e.loaded} bytes transferred of ${e.total}. Is lengthComputable: ${e.lengthComputable}: `\n                + `${JSON.stringify(e)}`);\n        }\n    }\n\n    handleUpload = (fileObject) => {\n        if (debug) {\n            console.log(`${debugName}.handleUpload[${fileObject.name}]`);\n        }\n\n        const { uploadStatus = () => {}, before = () => {}, after = () => {} } = this.props;\n        uploadStatus(false);\n\n        if (util.isFunction(before)) {\n            before();\n        }\n\n        const formData = new FormData();\n        formData.append('files[]', fileObject);\n        const uploadMeta = {\n            progress: 1,\n        };\n\n        uploadMeta.xhr = new XMLHttpRequest();\n\n        uploadMeta.xhr.upload.addEventListener('progress', (event) => {\n            const fileObj = fileObject;\n            this.updateProgress(event, fileObj);\n        });\n        uploadMeta.xhr.addEventListener('loadstart', (event) => {\n            const fileObj = fileObject;\n            this.handleEvent(event, fileObj);\n        });\n        uploadMeta.xhr.addEventListener('load', (event) => {\n            const fileObj = fileObject;\n            this.handleEvent(event, fileObj);\n        });\n        uploadMeta.xhr.addEventListener('loadend', (event) => {\n            const fileObj = fileObject;\n            if (util.isFunction(after)) {\n                after();\n            }\n            this.handleEvent(event, fileObj);\n        });\n        uploadMeta.xhr.addEventListener('progress', (event) => {\n            const fileObj = fileObject;\n            this.handleEvent(event, fileObj);\n        });\n        uploadMeta.xhr.addEventListener('error', (event) => {\n            const fileObj = fileObject;\n            this.handleEvent(event, fileObj);\n        });\n        uploadMeta.xhr.addEventListener('abort', (event) => {\n            const fileObj = fileObject;\n            this.handleEvent(event, fileObj);\n        });\n        uploadMeta.xhr.addEventListener('readystatechange', (event) => {\n            const fileObj = fileObject;\n            this.uploadDone(event, fileObj);\n        });\n\n        uploadMeta.xhr.open('POST', `${util.getApiServer()}${this.props.apiUrl}`);\n        uploadMeta.xhr.setRequestHeader('Authorization', `Bearer ${util.getJwtToken()}`);\n        uploadMeta.xhr.send(formData);\n\n        const filename = fileObject.name;\n        const uploadedFilesData = this.state.uploadedFilesData;\n        if (!uploadedFilesData[filename]) {\n            uploadedFilesData[filename] = {};\n        }\n        uploadedFilesData[filename].uploadMeta = uploadMeta;\n        uploadedFilesData[filename].imageNum = this.state.imageNum;\n        this.setState({ uploadedFilesData });\n    }\n\n    // eslint-disable-next-line\n    readLocalFile = (fileObject) => {\n        return new Promise((resolve, reject) => {\n            const reader = new FileReader();\n\n            reader.addEventListener('error', (error) => {\n                if (debug) {\n                    console.log(`${debugName}.FileReader: Error occurred reading file: ${fileObject.name}: ${error}`);\n                }\n                reject(error);\n            });\n\n            reader.addEventListener('load', (event) => {\n                if (debug) {\n                    console.log(`${debugName}.FileReader: File: ${fileObject.name} read successfully: `\n                        + `${JSON.stringify(event)}`);\n                }\n                const photo = fileObject;\n                const filename = photo.name;\n                const uploadedFilesData = this.state.uploadedFilesData;\n                if (!uploadedFilesData[filename]) {\n                    uploadedFilesData[filename] = {};\n                }\n                uploadedFilesData[filename].event = event;\n                this.setState({ uploadedFilesData });\n                this.handleUpload(photo);\n                resolve(event);\n            });\n\n            reader.readAsDataURL(fileObject);\n        });\n    }\n\n    updateProgress = (event, fileObject) => {\n        if (event.lengthComputable) {\n            const filename = fileObject.name;\n            const uploadedFilesData = this.state.uploadedFilesData;\n            const percentComplete = (event.loaded / event.total) * 100;\n            if (debug) {\n                console.log(`${debugName}.updateProgress[${filename}].progress`, percentComplete);\n            }\n            uploadedFilesData[filename].uploadMeta.progress = percentComplete;\n            this.setState({ uploadedFilesData });\n        }\n    }\n\n    uploadDone = (event, fileObject) => {\n        const filename = fileObject.name;\n        const uploadedFilesData = this.state.uploadedFilesData;\n        const uploadMeta = uploadedFilesData[filename].uploadMeta;\n        if (debug) {\n            console.log(`${debugName}.uploadDone[${filename}].uploadedFilesData`, uploadedFilesData);\n            console.log(`${debugName}.uploadDone[${filename}].uploadMeta`, uploadMeta);\n            console.log(`${debugName}.uploadDone.event`, event);\n        }\n\n        if (uploadMeta && uploadMeta.xhr.readyState === 4 && uploadMeta.xhr.status === 201) {\n            const response = JSON.parse(uploadMeta.xhr.responseText);\n            const files = response.data.files;\n            for (let i = 0; i < files.length; i += 1) {\n                const file = files[i];\n                this.addFileToUpload(file);\n                this.fileInput.value = '';\n            }\n        }\n    }\n\n    addFileToUpload(file) {\n        if (debug) {\n            console.log(`${debugName}.addFileToUpload[${file.name}]`);\n        }\n        const { uploadedFilesData } = this.state;\n        const { handleAddImage, uploadStatus = () => {} } = this.props;\n\n        delete uploadedFilesData[file.name];\n        this.setState({ uploadedFilesData });\n        handleAddImage(file);\n        uploadStatus(true);\n    }\n    // /Upload\n\n    componentDidMount() {\n        const div = this.dropRef.current;\n        div.addEventListener('dragenter', this.handleDragIn);\n        div.addEventListener('dragleave', this.handleDragOut);\n        div.addEventListener('dragover', this.handleDrag);\n        div.addEventListener('drop', this.handleDrop);\n\n        const { autoOpen } = this.props;\n\n        if (autoOpen) {\n            setTimeout(() => {\n                // console.log('[setTimeout]');\n                this.fileInput.click();\n            }, 10);\n        }\n    }\n\n    componentWillUnmount() {\n        const div = this.dropRef.current;\n        div.removeEventListener('dragenter', this.handleDragIn);\n        div.removeEventListener('dragleave', this.handleDragOut);\n        div.removeEventListener('dragover', this.handleDrag);\n        div.removeEventListener('drop', this.handleDrop);\n    }\n\n    render() {\n        const { uploadedFilesData } = this.state;\n\n        return (\n            <div style={{ position: 'relative' }} ref={this.dropRef}>\n                {this.state.drag &&\n                <div style={{\n                    border: 'dashed grey 4px',\n                    backgroundColor: 'rgba(255,255,255,.8)',\n                    position: 'absolute',\n                    top: 0,\n                    bottom: 0,\n                    left: 0,\n                    right: 0,\n                    zIndex: 9999,\n                }}>\n                    <div\n                        style={{\n                            position: 'absolute',\n                            top: '50%',\n                            right: 0,\n                            left: 0,\n                            textAlign: 'center',\n                            color: 'grey',\n                            fontSize: 36,\n                        }}\n                    >\n                        <div><Text id='imageupload.drag-files-here'>drop your files here :)</Text></div>\n                    </div>\n                </div>}\n\n                <div>\n                    <input class='btn btn-info col-sm-12' multiple\n                        type='file'\n                        id='image-file'\n                        onchange={this.handleAddFiles}\n                        ref={(c) => {\n                            this.fileInput = c;\n                        }}\n                    />\n                </div>\n                <div>\n                    {Object.keys(uploadedFilesData).length > 0 ? (<h3><Text id='imageupload.upload-images'>Uploaded images</Text></h3>) : ''}\n                    <ul class='list-group'>\n                        {Object.keys(uploadedFilesData).map((key) => {\n                            const { uploadMeta = {} } = uploadedFilesData[key];\n                            const isImage = key.match(/(jpg|jpeg|png|gif|heic|heif|svg|webp|tif)/i);\n                            return (\n                                <li class='list-group-item list-group-item-action flex-column align-items-start'>\n                                    <div class='d-flex w-100 justify-content-between'>\n                                        {isImage && <img class='img-fluid mr-3'\n                                            src={uploadedFilesData[key].event.target.result}\n                                            style='max-height: 50px;'\n                                        />}\n                                        <small>{uploadedFilesData[key].event.uploadDone}</small>\n                                        <Text id='imageupload.uploading-image'>Laster opp bilde...</Text>\n                                        <small>{util.formatBytes(uploadedFilesData[key].event.total, 2)}</small>\n                                    </div>\n                                    <div class='progress mt-1' style='height: 4px;'>\n                                        <div\n                                            class='progress-bar progress-bar-striped progress-bar-animated bg-success'\n                                            role='progressbar'\n                                            style={`width: ${uploadMeta.progress}%; height: 4px;`}\n                                            aria-valuenow={uploadMeta.progress}\n                                            aria-valuemin='0'\n                                            aria-valuemax='100'\n                                        />\n                                    </div>\n                                </li>\n                            );\n                        })}\n                    </ul>\n                </div>\n\n                {this.props.children}\n            </div>\n        );\n    }\n}\n\nexport default DragNDropFileupload;\n"],"sourceRoot":""}