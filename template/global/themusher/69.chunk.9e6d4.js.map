{"version":3,"sources":["webpack:///./routes/public/race/listMusher.js","webpack:///./routes/public/race/raceheader.js","webpack:///./components/public/heatmap.js","webpack:///./components/data/distance.js","webpack:///./routes/public/race/submenu.js","webpack:///./routes/public/race/style.css","webpack:///./components/data/temperature.js","webpack:///./routes/public/race/header.js","webpack:///./components/data/weight.js","webpack:///./routes/public/race/tracking.js","webpack:///./routes/public/race/raceText.js","webpack:///./components/data/elevation.js","webpack:///./components/data/speed.js","webpack:///./routes/public/race/displayMusher.js"],"names":["initialState","ListMusher","observer","props","toggleFocusOnMusher","e","stores","appState","raceStore","parseInt","target","parentElement","dataset","musherid","getWorkoutSummaryActiveTeams","focusOnMushers","toggleInfoOnMusher","state","render","currentSpeed","updated","isActive","this","team","idx","infoOnMushers","line","getActiveTeamById","id","currentStages","getWorkoutSummaryByTeam","currentClass","getClassByTeamId","currentResults","getWorkoutResultsByTeam","distance","musher","getMusherByTeamId","image","images","length","raceClass","completed","distanceKm","hasStarted","currentLocation","coords","speed","timestamp","toFinish","class","style","s3SmallLink","onClick","data-musherid","util","ucfirst","String","firstname","lastname","name","title","format","secToHms","rest","isInProgress","dogs","formatDistance","Date","indexOf","battery","level","Component","RaceHeader","language","race","today","status","startDate","endDate","signupStartDate","signupEndDate","classes","useEffect","document","PageTitle","formatDate","locale","hour12","hour","minute","liveRace","role","showAddComment","Heatmap","updateTimer","inputRef","loadHeatmap","setState","isLoading","adminStore","getPublicHeatmap","raceid","componentDidMount","waypoints","zoomToMarkers","mapid","fullscreenMap","heatmap","publicHeatmap","mapId","minZoom","maxZoom","height","key","displayDistance","Distance","value","smallUnit","userStore","user","settings","imperial","kmToMiles","mu","marginTop","marginBottom","subMenuMarginTop","email","submenu","jwtToken","getJwtToken","PublicRaceDetail","path","darkmode","currentMenu","match","href","module","exports","Temperature","celciusToFahrenheit","menu","profile","main","searchText","Navigation","toggleDropdown","menuName","parentNode","toggleDarkmode","toggleViewmode","mode","reloadApp","window","location","reload","adminLoadAll","getInfo","changeLanguage","lang","console","log","setLanguage","search","route","notifications","filter","read","src","type","data-name","className","activeClassName","onInput","selected","Weight","kgToPounds","MARGIN_TOP","MARKDOWN_OPTIONS","pedantic","gfm","breaks","sanitize","smartLists","smartypants","xhtml","reloadInSec","reloadIsActive","leaderboardMode","filterByraceClass","showLeaderBoard","showNews","ReloadTimer","initComponent","tickReloadTimeer","reloadLastEpoch","now","Math","floor","getTime","clearTimeout","tick","setTimeout","componentWillUnmount","radius","fontSize","classNames","reloadPercent","normalizeBetween","color","showPercentText","percent","showCenterText","centerText","centerTextSize","centerTextY","loadLiveRaceResults","getRaceTrackerData","raceTrackerRace","getRaceTrackerActiveTeams","loadRaceResults","teamIds","loadWorkoutSummary","setLeaderboardMode","chooseRaceClass","toggleShowLeaderBoard","hide","toggleShowNews","loadRace","allTeamIds","load","contestants","map","flat","teamid","loadTeams","join","getAllClassesSortedBy","RELOAD_INTERVAL_IN_SEC","width","innerWidth","innerHeight","componentWillReceiveProps","nextProps","teamsInThisRace","activeTeams","teamList","linkBase","articles","reverse","article","date","replaceImages","s3LargeLink","ingress","markdown","markdownOpts","body","aria-describedby","sort","a","b","totalMushers","data-mode","contestant","currentTeam","teamId","getTeamById","text","finalText","regex","RegExp","replace","Elevation","meterToFeet","Speed","kmtToMph","DisplayMusher","avgDogs","speedAvg","weightedNormalizedDuration","duration","elevation","altitude","loadIndex","viewBox","d","svgElevation","svgMap","stage","currentEpoch","inDate","setUTCSeconds"],"mappings":"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","file":"69.chunk.9e6d4.js","sourcesContent":["import { h, Component } from 'preact';\nimport { useEffect } from \"preact/hooks\";\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nconst initialState = {\n};\n\n@observer\nclass ListMusher extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\ttoggleFocusOnMusher = (e) => {\n\t\tconst musherId = e.target.parentElement.dataset.musherid || e.target.dataset.musherid;\n\t\tconst { appState, raceStore } = this.props.stores;\n\t\tappState.toggleFocusOnMusher(parseInt(musherId, 10));\n\n\t\tconst { focusOnMushers } = appState;\n\t\traceStore.getWorkoutSummaryActiveTeams(focusOnMushers);\n\t}\n\n\ttoggleInfoOnMusher = (e) => {\n\t\tconst musherId = e.target.parentElement.dataset.musherid || e.target.dataset.musherid;\n\t\tconst { appState } = this.props.stores;\n\t\tappState.toggleInfoOnMusher(parseInt(musherId, 10));\n\t}\n\n    render() {\n\t\tconst { raceStore, appState } = this.props.stores;\n\t\tconst { team = {}, idx } = this.props;\n\t\tconst { darkmode, language = 'en', focusOnMushers = [], infoOnMushers = [] } = appState;\n\t\tconst { race } = raceStore;\n\n        const line = raceStore.getActiveTeamById(team.id);\n        const currentStages = raceStore.getWorkoutSummaryByTeam(team.id);\n        const currentClass = raceStore.getClassByTeamId(team.id);\n        const currentResults = raceStore.getWorkoutResultsByTeam(currentStages, currentClass.distance);\n        const musher = raceStore.getMusherByTeamId(team.id);\n        const image = team.images && team.images.length > 0 ? team.images[0] : {};\n        const raceClass = raceStore.getClassByTeamId(team.id);\n\n        const completed = currentResults.distanceKm / currentClass.distance * 100;\n        const hasStarted = completed > 0 ? 1 : 0;\n        const isDone = completed >= 100 ? 1 : 0;\n\n        let currentSpeed;\n        let updated;\n        let isActive;\n        if (line && line.currentLocation && line.currentLocation.coords) {\n            currentSpeed = line.currentLocation.coords.speed * 3.6;\n            updated = line.currentLocation.timestamp;\n            isActive = true;\n        }\n        let toFinish = raceClass.distance - currentResults.distanceKm;\n        if (toFinish < 0) {\n            toFinish = 0;\n        }\n\n        // const currentSpeed = util.format(line.currentLocation.coords.speed * 3.6, 1);\n        // avgDogs: 9.777777777777779\n        // distanceKm: 268.3432364824406\n        // duration: 67524.34002106966\n        // elevation: 5287.123805500813\n        // flatTotalKcal: 4971.658025959346\n        // images: Array(32) [ Proxy, Proxy, Proxy, … ]\n        // loadIndex: 1446\n        // rest: 2306\n        // speedAvg: 14.820718823260847\n        // totalKcalRelated: 1225.314525471911\n        // weightedTotalKcal: 11344.398317216459\n\n        return (<>\n            <div class='row border-top mt-2' style='font-size: 0.7em;'>\n                <div class='col-2 p-0 text-center'>\n                    <h2>{idx + 1}</h2>\n                </div>\n                <div class='col-2 p-0 text-center'>\n                    <div\n                        class={`text-center text-muted pt-2 h-100`}\n                        style={`background-image: url(\"${image.s3SmallLink}\"); background-size: cover;`}\n                        onClick={this.toggleInfoOnMusher} data-musherid={team.id}\n                    >\n                        {!image.s3SmallLink && <>\n                            <span class='font-weight-lighter' style='font-size: 35px;'>\n                                {util.ucfirst(String(musher.firstname), true)}\n                                {util.ucfirst(String(musher.lastname), true)}\n                            </span>\n                        </>}\n                    </div>\n                </div>\n                <div class='col-8'>\n                    <div class='row'>\n                        <div class='col-6 px-1'>\n                            <span class='font-weight-bold'>{musher.firstname} {musher.lastname}</span><br />\n                            <span class='font-weight-lighter'>{team.name}</span><br />\n                            {raceClass && raceClass.title && <>\n                                <span class='font-weight-lighter'>{raceClass.title}</span>\n                            </>}\n                        </div>\n                        <div class='col-3 p-0 text-center'>\n                            <span class='font-weight-lighter'>km</span><br />\n                            <span style='font-size: 2.0em;'>{util.format(currentResults.distanceKm, 0)}</span>\n                        </div>\n                        <div class='col-3 p-0 text-center'>\n                            <span class='font-weight-lighter'>to finish</span><br />\n                            <span style='font-size: 2.0em;'>\n                                {toFinish === 0 ? <i class='fas fa-flag-checkered text-success' /> : <>{util.format(toFinish, 0)}</>}\n                            </span>\n                        </div>\n                    </div>\n                    <div class='row border-top'>\n                        <div class='col-3 p-0 text-center'>\n                            <span class='font-weight-lighter'>Rest</span><br />\n                            {util.secToHms(currentResults.rest)}\n                        </div>\n                        <div class='col-3 p-0 text-center'>\n                            <span class='font-weight-lighter'>Speed</span><br />\n                            {currentSpeed ? <>{util.format(currentSpeed, 1)} km/t</> : '-'}\n                        </div>\n                        <div class='col-3 p-0 text-center'>\n                            <span class='font-weight-lighter'>Status</span><br />\n                            {line.isInProgress === 1 ? <span class='text-primary'>running</span> : ''}\n                            {line.isInProgress === 2 ? <span class='text-danger'>resting</span> : ''}\n                            {toFinish === 0 ? <>\n                                {!line.isInProgress ? <span class='text-success'>FINISH</span> : ''}\n                            </> : <>\n                                {!line.isInProgress ? <>\n                                    {hasStarted ? <span class='text-danger'>resting</span> : <span class='text-muted'>NYS</span>}\n                                </> : ''}\n                            </>}\n                            \n                        </div>\n                        <div class='col-3 p-0 text-center align-bottom'>\n                            <h5>\n                                {team.dogs && team.dogs ? util.format(team.dogs.length, 0) : '-'} <i class='fas fa-dog text-muted ml-2' />\n                            </h5>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class='row bg-secondary text-white' style='font-size: 0.8em;'>\n                <div class='col-6 text-left' style='font-size: 0.8em;'>\n                    {isActive && <>\n                        Updated: {util.formatDistance(updated, new Date())} ago\n                    </>}\n                </div>\n                <div class='col-6 text-right'>\n                    <span class='float-right' onClick={this.toggleFocusOnMusher} data-musherid={team.id}>{focusOnMushers.indexOf(team.id) > -1 ? <i class='fas fa-star text-warning' /> : <i class='far fa-star' />}</span>\n                    <span class='float-right mr-2' onClick={this.toggleInfoOnMusher} data-musherid={team.id}>{infoOnMushers.indexOf(team.id) > -1 ? <i class='fas fa-info-circle text-warning' /> : <i class='fas fa-info-circle' />}</span>\n\n                    {isActive && line.currentLocation.battery.level > 0 && <>\n                        <span class='float-right mr-2'>\n                            <i class='fas fa-battery-three-quarters text-muted ml-2 mr-1' />\n                            {util.format(line.currentLocation.battery.level * 100, 0)}%\n                        </span>\n                    </>}\n\n                </div>\n            </div>\n        </>);\n    }\n}\n\nexport default ListMusher;\n","import { h, Component } from 'preact';\nimport { useEffect } from \"preact/hooks\";\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nfunction PageTitle(title, classes = '') {\n\tuseEffect(() => {\n\t\tdocument.title = `Homerun Race: ${title}`;\n\t}, [title]);\n\treturn <h1 class={classes}>{title}</h1>;\n}\n\nconst initialState = {\n};\n\n@observer\nclass RaceHeader extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n    render() {\n\t\tconst { raceStore, appState } = this.props.stores;\n\t\tconst { title } = this.props;\n\t\tconst { darkmode, language = 'en' } = appState;\n\t\tconst { race } = raceStore;\n\n\t\tconst today = new Date();\n\t\tlet status = '';\n\t\tif (today >= new Date(race.startDate) && today <= new Date(race.endDate)) {\n\t\t\tstatus = 'race';\n\t\t} else if (today >= new Date(race.signupStartDate) && today <= new Date(race.signupEndDate)) {\n\t\t\tstatus = 'signup';\n\t\t} else if (today > new Date(race.endDate)) {\n\t\t\tstatus = 'done';\n\t\t}\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div class='d-flex'>\n\t\t\t\t\t<div class='flex-fill'>\n\t\t\t\t\t\t{PageTitle(title, 'mb-0')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='flex-fill text-center d-none d-md-block'>\n\t\t\t\t\t\t<h1 class='mb-0' style='line-height: 0.8em;'><span class='font-weight-lighter' style='letter-spacing: -1px;'>{race.title}</span></h1>\n\t\t\t\t\t\t<small class=''>\n\t\t\t\t\t\t\t{race.startDate && <>{util.formatDate(race.startDate, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</>}\n\t\t\t\t\t\t\t{race.endDate && <> - {util.formatDate(race.endDate, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</>}\n\t\t\t\t\t\t</small>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='flex-fill'>\n\t\t\t\t\t\t<h3 class='float-right'>\n\t\t\t\t\t\t\t{status === 'signup' && !race.liveRace && <>\n\t\t\t\t\t\t\t\t<div class='spinner-grow text-primary' role='status' />\n\t\t\t\t\t\t\t\t<span class='badge badge-primary ml-2'><Text id='races.signup-open'>Påmelding åpen</Text></span>\n\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t\t{status === 'race' && <>\n\t\t\t\t\t\t\t\t<div class='spinner-grow text-danger' role='status' />\n\t\t\t\t\t\t\t\t<span class='badge badge-danger ml-2'><Text id='races.race-in-progress'>Løp pågår</Text></span>\n\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t\t{status === 'done' && <>\n\t\t\t\t\t\t\t\t<i class='fas fa-check text-success' />\n\t\t\t\t\t\t\t\t<span class='badge badge-success ml-2'><Text id='races.race-finished'>Løp avsluttet</Text></span>\n\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t</h3>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class='d-block d-md-none'>\n\t\t\t\t\t<h4 class='mb-0' style='line-height: 0.8em;'><span class='font-weight-light' style='letter-spacing: -1px;'>{race.title}</span></h4>\n\t\t\t\t\t<small>\n\t\t\t\t\t\t{race.startDate && <>{util.formatDate(race.startDate, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</>}\n\t\t\t\t\t\t{race.endDate && <> - {util.formatDate(race.endDate, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</>}\n\t\t\t\t\t</small>\t\t\t\t\n\t\t\t\t</div>\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default RaceHeader;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport { toJS } from 'mobx'\n\nimport Map from '../../components/map';\n\nimport mu from '../../lib/musher-util';\n\nconst initialState = {\n\tshowAddComment: false,\n};\n\n@observer\nclass Heatmap extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n        this.updateTimer = {};\n\t\tthis.inputRef = {};\n    }\n\n\tasync loadHeatmap() {\n\t\tthis.setState({ isLoading: true });\n\t\tconst { adminStore } = this.props.stores;\n        const { raceid } = this.props;\n        await adminStore.getPublicHeatmap(raceid);\n\t\tthis.setState({ isLoading: false });\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.loadHeatmap();\n\t}\n\n    // componentWillReceiveProps() {\n\t// \tthis.loadHeatmap();\n\t// }\n\n    render() {\n        const { adminStore } = this.props.stores;\n        const { waypoints, zoomToMarkers, mapid, fullscreenMap } = this.props;\n        const { publicHeatmap: heatmap } = adminStore;\n        // const heatmap = publicHeatmap.slice(0, 10);\n        // const heatmap = [[60.4433,8.8996,14],[61.384,9.1152,14],[60.42,8.9422,15]];\n\n        return (\n            <>\n                {/* heatmap: {`map-${mapid}`}<br /> */}\n                {/* {JSON.stringify(heatmap)} */}\n                <Map\n                    stores={this.props.stores}\n                    mapId={heatmap.length}\n                    heatmap={heatmap}\n                    minZoom={2}\n                    maxZoom={18}\n                    height={600}\n                    waypoints={waypoints}\n                    zoomToMarkers={zoomToMarkers}\n                    fullscreenMap={fullscreenMap}\n                    key={`map-${mapid}`}\n                />\n            </>\n        );\n    }\n}\n\nexport default Heatmap;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nfunction displayDistance(distance) {\n\tif (distance < 5) {\n\t\treturn util.format(distance, 2);\n\t}\n\tif (distance < 10) {\n\t\treturn util.format(distance, 1);\n\t}\n\treturn util.format(distance, 1);\n}\n\nfunction kmToMiles(value) {\n    return 0.621371 * value;\n}\n\n@observer\nclass Distance extends Component {\n    render() {\n\t\tconst { value = 0, smallUnit } = this.props;\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { settings = {} } = user;\n\n        if (settings.imperial) {\n            return (<>\n                <nobr>\n\t\t\t\t\t{displayDistance(kmToMiles(value))} {smallUnit ? <><small><small><small class='ml-0 text-muted'>mi</small></small></small></> : <>mi</>}\n\t\t\t\t</nobr>\n            </>);\n        }\n\n\t\treturn (<>\n\t\t\t<nobr>\n\t            {displayDistance(value)} {smallUnit ? <><small><small><small class='ml-0 text-muted'>km</small></small></small></> : <>km</>}\n\t\t\t</nobr>\n\t    </>);\n    }\n}\n\nexport default Distance;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport linkstate from 'linkstate';\n\nimport Header from './header';\nimport Heatmap from '../../../components/public/heatmap';\n\nimport mu from '../../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(true);\nconst MARGIN_BOTTOM = mu.marginBottom();\nconst SUB_MENU_MARGIN_TOP = mu.subMenuMarginTop();\n\nconst initialState = {\n\tisLoading: false,\n\temail: '',\n\tsubmenu: 'ads',\n\tjwtToken: util.getJwtToken(),\n};\n\n@observer\nclass PublicRaceDetail extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\trender() {\n\t\tconst { appState } = this.props.stores;\n\t\tconst { raceid, path } = this.props;\n\t\tconst { darkmode } = appState;\n\n        let currentMenu = 'default';\n        if (path.match(/\\/race\\/:raceid$/)) {\n            currentMenu = 'default';\n        } else if (path.match(/\\/race\\/:raceid\\/mushers$/)) {\n            currentMenu = 'mushers';\n        } else if (path.match(/\\/race\\/:raceid\\/results$/)) {\n            currentMenu = 'results';\n        } else if (path.match(/\\/race\\/:raceid\\/media$/)) {\n            currentMenu = 'media';\n        } else if (path.match(/\\/race\\/:raceid\\/tracking$/)) {\n            currentMenu = 'tracking';\n        }\n\n\t\treturn (\n\t\t\t<>\t\t\t\t\n                <div class='row fixed-top pr-3' style={`margin-top: 40px; background-color: ${darkmode ? '#191d21' : '#f8f9fa'};`}>\n\n                    <div class='col-12 my-2 mx-2'>\n                        <ul class='nav nav-pills nav-fill flex-nowrap'>\n                            <li class='nav-item' style='max-width: 20%;'>\n                                <a href={`/race/${raceid}`} class={`text-overflow nav-link ${currentMenu === 'default' ? 'active' : ''}`}>\n                                    <nobr><i class='fas fa-info-circle' /> <Text id='race.therace'>Løpet</Text></nobr>\n                                </a>\n                            </li>\n                            <li class='nav-item' style='max-width: 20%;'>\n                                <a href={`/race/${raceid}/mushers`} class={`text-overflow nav-link ${currentMenu === 'mushers' ? 'active' : ''}`}>\n                                    <nobr><i class='fas fa-users' /> <Text id='race.mushers'>Deltakere</Text></nobr>\n                                </a>\n                            </li>\n                            <li class='nav-item' style='max-width: 20%;'>\n                                <a href={`/race/${raceid}/results`} class={`text-overflow nav-link ${currentMenu === 'results' ? 'active' : ''}`}>\n                                    <nobr><i class='fas fa-poll' /> <Text id='race.results'>Resultater</Text></nobr>\n                                </a>\n                            </li>\n                            <li class='nav-item' style='max-width: 20%;'>\n                                <a href={`/race/${raceid}/media`} class={`text-overflow nav-link ${currentMenu === 'media' ? 'active' : ''}`}>\n                                    <nobr><i class='fas fa-images' /> <Text id='race.media'>Bilder</Text></nobr>\n                                </a>\n                            </li>\n                            <li class='nav-item' style='max-width: 20%;'>\n                                <a href={`/race/${raceid}/tracking`} class={`text-overflow nav-link ${currentMenu === 'tracking' ? 'active' : ''}`}>\n                                    <nobr><i class='fas fa-map-marked-alt' /> <Text id='race.tracking'>Tracking</Text></nobr>\n                                </a>\n                            </li>\n                        </ul>\n                    </div>\n\n\n                    {/* <div class={`col text-center subtopmenu ${path.match(/\\/race\\/:raceid$/) ? 'border-bottom border-primary' : ''}`}>\n                        <a href={`/race/${raceid}`} class={`text-${path.match(/\\/race\\/:raceid$/) ? 'primary' : 'secondary'} stretched-link`}>\n                            <nobr><i class='fas fa-chart-line' /> <Text id='race.therace'>Løpet</Text></nobr>\n                        </a>\n                    </div>\n                    <div class={`col text-center subtopmenu ${path.match(/\\/race\\/:raceid\\/mushers$/) ? 'border-bottom border-primary' : ''}`}>\n                        <a href={`/race/${raceid}/mushers`} class={`text-${path.match(/\\/race\\/:raceid\\/mushers$/) ? 'primary' : 'secondary'} stretched-link`}>\n                            <nobr><i class='fas fa-chart-line' /> <Text id='race.mushers'>Deltakere</Text></nobr>\n                        </a>\n                    </div>\n                    <div class={`col text-center subtopmenu ${path.match(/\\/race\\/:raceid\\/results$/) ? 'border-bottom border-primary' : ''}`}>\n                        <a href={`/race/${raceid}/results`} class={`text-${path.match(/\\/race\\/:raceid\\/results$/) ? 'primary' : 'secondary'} stretched-link`}>\n                            <nobr><i class='fas fa-chart-line' /> <Text id='race.results'>Resultater</Text></nobr>\n                        </a>\n                    </div>\n                    <div class={`col text-center subtopmenu ${path.match(/\\/race\\/:raceid\\/tracking$/) ? 'border-bottom border-primary' : ''}`}>\n                        <a href={`/race/${raceid}/tracking`} class={`text-${path.match(/\\/race\\/:raceid\\/tracking$/) ? 'primary' : 'secondary'} stretched-link`}>\n                            <nobr><i class='fas fa-chart-line' /> <Text id='race.tracking'>Tracking</Text></nobr>\n                        </a>\n                    </div> */}\n                </div>\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default PublicRaceDetail;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"pointerCursor\":\"pointerCursor__1W6mM\"};","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nfunction celciusToFahrenheit(value) {\n    return ((value * 9/5) + 32);\n}\n\n@observer\nclass Temperature extends Component {\n    render() {\n\t\tconst { value = 0, smallUnit } = this.props;\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { settings = {} } = user;\n\n        if (settings.imperial) {\n            return (<>\n                <nobr>\n                    {util.format(celciusToFahrenheit(value), 0)}°F\n                </nobr>\n            </>);\n        }\n\n\t\treturn (<>\n            <nobr>\n                {util.format(value, 1)}°C\n            </nobr>\n        </>);\n    }\n}\n\nexport default Temperature;\n","import { h, Component } from 'preact';\nimport { Link } from 'preact-router/match';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport linkState from 'linkstate';\nimport { route } from 'preact-router';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport style from './style.css';\n\n\nconst initialState = {\n    menu: {\n\t\tprofile: false,\n\t\tmain: false,\n\t},\n\tsearchText: '',\n};\n\n@observer\nclass Navigation extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\ttoggleDropdown = (e) => {\n\t\tconst { menu } = this.state;\n\t\tlet menuName = e.target.dataset.name;\n\t\tif (!menuName && e.target.parentNode) {\n\t\t\tmenuName = e.target.parentNode.dataset.name;\n\t\t}\n\t\tif (menuName) {\n\t\t\tmenu[menuName] = !menu[menuName];\n\t\t}\n\t\tthis.setState({ menu });\n\t}\n\n\ttoggleDarkmode = (e) => {\n        const { appState } = this.props.stores;\n\t\tappState.toggleDarkmode();\n\t\tthis.toggleDropdown(e);\n\t}\n\n\ttoggleViewmode = (e) => {\n        const { appState } = this.props.stores;\n\t\tlet mode = e.target.dataset.mode;\n\t\tif (!mode && e.target.parentNode) {\n\t\t\tmode = e.target.parentNode.dataset.mode;\n\t\t}\n\t\tappState.toggleViewmode(mode);\n\t\tthis.toggleDropdown(e);\n\t}\n\n\treloadApp = () => {\n\t\twindow.location.reload(true);\n\t}\n\n\tadminLoadAll = async (e) => {\n        const { userStore } = this.props.stores;\n        await userStore.getInfo(true);\n\t}\n\n\tchangeLanguage = (e) => {\n\t\tconst lang = e.target.value;\n\t\tconsole.log('changeLanguage', lang);\n\t\tconst { appState, userStore } = this.props.stores;\n\t\tconst { user = {} } = userStore;\n\t\tif (user.email) {\n\t\t\tuserStore.setLanguage({ email: user.email, language: lang });\n\t\t}\n\t\tappState.setLanguage(lang);\n\t}\n\n\tsearch = () => {\n\t\tconst { searchText } = this.state;\n\t\troute(`/search/${searchText}`);\n\t}\n\n    render() {\n\t\tconst { menu, searchText } = this.state;\n        const { appState, userStore } = this.props.stores;\n        const { darkmode, viewmode, isCordova } = appState;\n\t\tconst { allUsers, isAdmin, user, notifications = [] } = userStore;\n\t\tconst unreadNotificatins = notifications.filter(e => !e.read);\n\t\tconst unread = unreadNotificatins.length || 0;\n\t\tconst { language = 'en' } = user;\n\n\t\treturn (\n\t\t\t<nav class='navbar navbar-expand-lg navbar-themed fixed-top py-1' style='z-index: 99999;'>\n\t\t\t\t<a class='navbar-brand' href='/race/'>\n\t\t\t\t\t{/* <img src={`./assets/logo-jul-2020-v2-${darkmode ? 'black' : 'white'}.png`} height='30' class='position-absolute' style='top: 8px; left: 6px' /> */}\n\t\t\t\t\t<img src={`./assets/homerun-race-logo-2-${darkmode ? 'white-' : ''}small.png`} height='37' class='position-absolute' style='top: 5px; left: 6px' />\n\t\t\t\t\t<span class='font-weight-normal' style='margin-left: 30px; font-size: 20px;'>Homerun Race</span>\n\t\t\t\t</a>\n\n\t\t\t\t<button class='navbar-toggler' type='button'\n\t\t\t\t\tdata-name='main'\n\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t>\n\t\t\t\t\t<span class='navbar-toggler-icon' />\n\t\t\t\t</button>\n\n\t\t\t\t<div class={`collapse navbar-collapse ${menu.main ? 'show' : ''}`} id='navbarSupportedContent'>\n\t\t\t\t\t<ul class='navbar-nav mr-auto ml-5'>\n\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/race'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tstyle='font-size: 1.0em !important;'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='fas fa-flag-checkered' /> <Text id='header.races'>Løpene</Text></Link>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/race/support'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tstyle='font-size: 1.0em !important;'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='far fa-question-circle' /> <Text id='header.support'>Support</Text></Link>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/race/news'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tstyle='font-size: 1.0em !important;'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='fas fa-quote-right' /> <Text id='header.news'>Nyheter</Text></Link>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t{/* <li class='nav-item'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='fas fa-dog' /> <Text id='header.backtoapp'>The Musher</Text></Link>\n\t\t\t\t\t\t</li> */}\n\t\t\t\t\t\t{/* <li class='nav-item'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/news'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='fas fa-quote-right' /> <Text id='header.news'>Nyheter</Text></Link>\n\t\t\t\t\t\t</li> */}\n\t\t\t\t\t\t{/* <li class='nav-item d-block d-lg-none'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'} href='/howto'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t><i class='fas fa-quote-right' /> <Text id='header.howto'>Hvordan gjør man det?</Text></Link>\n\t\t\t\t\t\t</li> */}\n\t\t\t\t\t</ul>\n\n\t\t\t\t\t<ul class='navbar-nav ml-auto '>\n\t\t\t\t\t\t{/* <li class='nav-item mr-2'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'}\n\t\t\t\t\t\t\t\thref='/users/notifications'\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tonClick={this.toggleDropdown}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<i class='fas fa-bell mr-1' />\n\t\t\t\t\t\t\t\t{unread > 0 && <>\n\t\t\t\t\t\t\t\t\t<span class='badge badge-pill badge-danger'>{unread > 9 ? '9+' : unread}</span>\n\t\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</li> */}\n\t\t\t\t\t\t<li class='nav-item mr-2'>\n\t\t\t\t\t\t\t<div class='form-row align-items-center'>\n\t\t\t\t\t\t\t\t<div class='col-auto my-1' style='width: 80px;'>\n\t\t\t\t\t\t\t\t\t<select class='custom-select'\n\t\t\t\t\t\t\t\t\t\tstyle='background-color: inherit; border: none; padding: 0; height: 1.1em; font-size: 0.9em;'\n\t\t\t\t\t\t\t\t\t\tonInput={this.changeLanguage}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<option value='no' selected={language === 'no'}>🇳🇴 NO</option>\n\t\t\t\t\t\t\t\t\t\t<option value='en' selected={language === 'en'}>🇬🇧 EN</option>\n\t\t\t\t\t\t\t\t\t\t<option value='es' selected={language === 'es'}>🇪🇸 ES</option>\n\t\t\t\t\t\t\t\t\t\t<option value='de' selected={language === 'de'}>🇩🇪 DE</option>\n\t                                    <option value='fr' selected={language === 'fr'}>🇫🇷 FR</option>\n\t                                    <option value='ru' selected={language === 'ru'}>🇷🇺 RU</option>\n\t                                    <option value='se' selected={language === 'se'}>🇸🇪 SE</option>\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class='nav-item d-block d-lg-none'>\n\t\t\t\t\t\t\t<Link className='nav-link' activeClassName={'active'}\n\t\t\t\t\t\t\t\tdata-name='main'\n\t\t\t\t\t\t\t\tonClick={this.toggleDarkmode}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<i class={`${darkmode ? 'fas text-warning' : 'far'} fa-moon`} /> <Text id='header.darkmode'>Nattmodus</Text>\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class='nav-item mr-2 d-none d-lg-block'>\n\t\t\t\t\t\t\t<button class='btn btn-link'\n\t\t\t\t\t\t\t\tdata-name='profile'\n\t\t\t\t\t\t\t\tonClick={this.toggleDarkmode}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<i class={`${darkmode ? 'fas text-warning' : 'far'} fa-moon`} />\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t{/* <li class='nav-item ml-auto d-none d-lg-block'>\n\t\t\t\t\t\t\t<form class='form-inline my-2 my-lg-0'>\n\t\t\t\t\t\t\t\t<Localizer>\n\t\t\t\t\t\t\t\t\t<input class='form-control form-control-sm mr-sm-2' type='search' placeholder={<Text id='header.search-placeholder'>Søk etter det meste...</Text>}\n\t\t\t\t\t\t\t\t\t\tvalue={searchText}\n\t\t\t\t\t\t\t\t\t\tonInput={linkState(this, 'searchText')}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Localizer>\n\t\t\t\t\t\t\t\t<button class='btn btn-sm btn-outline-success my-2 my-sm-0' type='button'\t\n\t\t\t\t\t\t\t\t\tonClick={this.search}\n\t\t\t\t\t\t\t\t><Text id='header.search'>Søk</Text></button>\n\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t</li> */}\n\t\t\t\t\t</ul>\n\n\t\t\t\t    \n\n\t\t\t\t</div>\n\t\t\t</nav>\n\t\t);\n\t}\n}\n\nexport default Navigation;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nfunction kgToPounds(value) {\n    return 2.20462 * value;\n}\n\n@observer\nclass Weight extends Component {\n    render() {\n\t\tconst { value = 0, smallUnit } = this.props;\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { settings = {} } = user;\n\n        if (settings.imperial) {\n            return (<>\n                <nobr>\n                    {util.format(kgToPounds(value), 0)} lb\n                </nobr>\n            </>);\n        }\n\n\t\treturn (<>\n            <nobr>\n                {util.format(value, 0)} kg\n            </nobr>\n        </>);\n    }\n}\n\nexport default Weight;\n","import { h, Component } from 'preact';\nimport { useEffect } from 'preact/hooks';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport Markdown from 'preact-markdown';\n\nimport Header from './header';\nimport Submenu from './submenu';\nimport Heatmap from '../../../components/public/heatmap';\nimport RaceHeader from './raceheader';\nimport RaceText from './raceText';\nimport DisplayMusher from './displayMusher';\nimport ListMusher from './listMusher';\nimport Gauge from '../../../components/gauge';\n\nimport RaceTracking from '../../../components/public/raceTracking.js';\n\nimport mu from '../../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(true, true);\nconst MARGIN_BOTTOM = mu.marginBottom();\n\nconst MARKDOWN_OPTIONS = {\n\tpedantic: false,\n\tgfm: true,\n\tbreaks: true,\n\tsanitize: false,\n\tsmartLists: true,\n\tsmartypants: true,\n\txhtml: true,\n};\n\nfunction PageTitle(title, classes = '', style = '') {\n\tuseEffect(() => {\n\t\tdocument.title = `Homerun Race: ${title}`;\n\t}, [title]);\n\treturn <span class={classes} style={style}>{title}</span>;\n}\n\nfunction getWindowDimensions() {\n    const { innerWidth: width, innerHeight: height } = window;\n    return {\n        width,\n        height\n    };\n}\n\nconst initialState = {\n\tisLoading: false,\n\temail: '',\n\tsubmenu: 'ads',\n\tjwtToken: util.getJwtToken(),\n\n\treloadInSec: null,\n\treloadIsActive: false,\n\n\tleaderboardMode: 'mushers',\n\tfilterByraceClass: '',\n\tshowLeaderBoard: true,\n\tshowNews: true,\n};\n\nconst RELOAD_INTERVAL_IN_SEC = 60;\n\n@observer\nclass ReloadTimer extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n\t\tthis.updateTimer = {};\n    }\n\n\tinitComponent = () => {\n\t\tthis.setState({\n\t\t\treloadIsActive: true,\n\t\t}, () => this.tickReloadTimeer());\n\t}\n\n\ttickReloadTimeer = () => {\n        const { reloadLastEpoch } = this.props;\n\t\tconst { reloadIsActive } = this.state;\n        if (reloadIsActive) {\n\t\t\tconst now = Math.floor(new Date().getTime() / 1000);\n\t\t\tconst reloadInSec = RELOAD_INTERVAL_IN_SEC - (now - reloadLastEpoch);\n\t\t\tthis.setState({ reloadInSec });\n\t\t\tclearTimeout(this.updateTimer.tick);\n\t\t\tthis.updateTimer.tick = setTimeout(() => this.tickReloadTimeer(), 1000);\n        }\n\t\treturn false;\n    }\n\n\tcomponentDidMount() {\n\t\tthis.initComponent();\n\t}\n\n\tcomponentWillUnmount() {\n\t\tclearTimeout(this.updateTimer.tick);\n\t}\n\n\trender() {\n\t\tconst { reloadInSec } = this.state;\n\t\tconst { radius = 13, fontSize = 11, classNames = '' } = this.props;\n\t\tconst reloadPercent = Math.floor(util.normalizeBetween(reloadInSec, 0, RELOAD_INTERVAL_IN_SEC, 0, 100))\n\n\t\treturn (<>\t\t\n\t\t\t<span class={classNames}>\n\t\t\t\t<Gauge key={`gauge-reload-page`}\n\t\t\t\t\tcolor='primary'\n\t\t\t\t\tradius={radius}\n\t\t\t\t\tshowPercentText={false}\n\t\t\t\t\tpercent={reloadPercent}\n\t\t\t\t\tshowCenterText={true}\n\t\t\t\t\tcenterText={reloadInSec}\n\t\t\t\t\tcenterTextSize={fontSize}\n\t\t\t\t\tcenterTextY={'55%'}\n\t\t\t\t/>\n\t\t\t</span>\n\t\t</>);\n\t}\n}\n\n@observer\nclass PublicRaceDetail extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n\t\t\treloadLastEpoch: Math.floor(new Date().getTime() / 1000),\n        };\n\t\tthis.updateTimer = {};\n    }\n\n\tloadLiveRaceResults = async (props = this.props, focusOnMushers) => {\n\t\tconst { raceStore } = props.stores;\n\t\tconst { race } = raceStore;\n\t\tawait raceStore.getRaceTrackerData(race.raceTrackerRace);\n\t\traceStore.getRaceTrackerActiveTeams();\n\t}\n\n\tloadRaceResults = async (props = this.props, teamIds, focusOnMushers) => {\n\t\tconst { raceStore } = props.stores;\n\t\tconst { raceid } = props;\n\n\t\tawait raceStore.loadWorkoutSummary(teamIds, raceid);\n\t\traceStore.getWorkoutSummaryActiveTeams(focusOnMushers);\n\t}\n\n\tasync loadRace(props = this.props) {\n\t\tthis.setState({ isLoading: true });\n\t\tconst { raceStore, appState } = props.stores;\n\t\tconst { raceid } = props;\n\t\tawait raceStore.load(raceid);\n\t\tconst { race } = raceStore;\n\t\tconst { focusOnMushers = [] } = appState;\n\n\t\tconst allTeamIds = race.classes.filter(currentClass => currentClass.contestants && currentClass.contestants.length > 0).map((currentClass) => {\n            return currentClass.contestants.filter(musher => musher.team > 0).map(musher => musher.team);\n\t\t}).flat();\n\n\t\tconst teamsInThisRace = focusOnMushers.filter(teamid => allTeamIds.indexOf(teamid) > -1);\n\t\tthis.setState({ allTeamIds });\n\t\tif (allTeamIds.length > 0) {\n\t\t\tawait raceStore.loadTeams(allTeamIds.join(','));\n\t\t\tif (race.liveRace > 0) {\n\t\t\t\tawait this.loadLiveRaceResults(props, focusOnMushers);\n\n\t\t\t} else {\n\t\t\t\tawait this.loadRaceResults(props, allTeamIds.join(','), focusOnMushers);\n\t\t\t}\n\n\t\t}\n\t\traceStore.getAllClassesSortedBy();\n\n\t\tconst isLiveRace = race.liveRace === 1;\n\n\t\tif (!isLiveRace) {\n\t\t\t// Set reload timer\n\t\t\tclearTimeout(this.updateTimer.reload);\n\t\t\tthis.updateTimer.reload = setTimeout(async () => {\n\t\t\t\tconst reloadLastEpoch = Math.floor(new Date().getTime() / 1000);\n\t\t\t\tthis.setState({ reloadLastEpoch });\n\t\t\t\tthis.loadRace();\n\t\t\t}, RELOAD_INTERVAL_IN_SEC * 1000);\n\t\t}\n\n\t\tthis.setState({ isLoading: false });\n\t}\n\n\tsetLeaderboardMode = (e) => {\n\t\tconst leaderboardMode = e.target.parentElement.dataset.mode || e.target.dataset.mode;\n\t\tthis.setState({ leaderboardMode })\n\t}\n\n\tchooseRaceClass = (e) => {\n\t\tconst filterByraceClass = e.target.value;\n\t\tthis.setState({ filterByraceClass })\n\t}\n\n\ttoggleShowLeaderBoard = (hide) => {\n\t\tconst { showLeaderBoard } = this.state;\n\t\tif (hide === true) {\n\t\t\tthis.setState({ showLeaderBoard: false });\n\t\t} else {\n\t\t\tthis.setState({ showLeaderBoard: !showLeaderBoard });\n\t\t}\n\t}\n\n\ttoggleShowNews = (hide) => {\n\t\tconst { showNews } = this.state;\n\t\tif (hide === true) {\n\t\t\tthis.setState({ showNews: false });\n\t\t} else {\n\t\t\tthis.setState({ showNews: !showNews });\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\tclearTimeout(this.updateTimer.reload);\n\t\tclearTimeout(this.updateTimer.tick);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.loadRace();\n\t\tconst { width, height } = getWindowDimensions();\n\t\tif (width < 800) {\n\t\t\tthis.toggleShowLeaderBoard(true);\n\t\t\tthis.toggleShowNews(true);\n\t\t}\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {\n\t\tthis.loadRace(nextProps);\n\t}\n\n\trender() {\n\t\tconst { appState, raceStore, userStore } = this.props.stores;\n\t\tconst { user = {} } = userStore;\n\t\tconst { raceid, path } = this.props;\n\t\tconst { language = 'en', focusOnMushers = [], infoOnMushers = [] } = appState;\n\t\tconst { leaderboardMode, filterByraceClass, showLeaderBoard, showNews, reloadLastEpoch, allTeamIds = [] } = this.state;\n\n\t\tconst teamsInThisRace = focusOnMushers.filter(teamid => allTeamIds.indexOf(teamid) > -1);\n\n\t\tconst { activeTeams, teamList, waypoints, zoomToMarkers, race, classes } = raceStore;\n\n\t\tconst isLiveRace = race.liveRace === 1;\n\n\t\tif (isLiveRace) {\n\t\t\treturn (\n\t\t\t\t<div class='container-fluid position-relative p-0' style={`margin-top: 0; height: calc(100vh - ${MARGIN_TOP}); z-index: 9999;`}>\n\t\t\t\t\t<RaceTracking stores={this.props.stores} raceid={raceid} linkBase={'/race/'} />\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div class='container-fluid h-100 position-relative p-0'>\n\t\t\t\t\t<Heatmap\n\t\t\t\t\t\tstores={this.props.stores}\n\t\t\t\t\t\traceid={raceid}\n\t\t\t\t\t\twaypoints={waypoints}\n\t\t\t\t\t\tzoomToMarkers={zoomToMarkers}\n\t\t\t\t\t\tfullscreenMap={true}\n\t\t\t\t\t\t// key={`heatmap-${focusOnMushers.join('-')}-${reloadLastEpoch}`}\n\t\t\t\t\t\t// mapid={`heatmap-${focusOnMushers.join('-')}-${reloadLastEpoch}`}\n\t\t\t\t\t/>\n\n\t\t\t\t\t<div class='position-absolute' style='top: 15px; left: 5px; z-index: 99999999;'>\n\t\t\t\t\t\t<div class='logo ml-3 clearfix text-white'>\n\t\t\t\t\t\t\t<img src={`./assets/homerun-race-logo-2-small.png`} height='37' class='float-left' />\n\t\t\t\t\t\t\t<a href={`/race/${race.id}`}>\n\t\t\t\t\t\t\t\t<span class='font-weight-bold text-dark' style='font-size: 1.4em;'>Homerun Race</span>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{!showLeaderBoard && <div class='position-absolute' style='top: 55px; left: 5px; z-index: 99999999; width: 150px; height: 50px;'>\n\t\t\t\t\t\t<button type='button' class='btn btn-sm btn-light' onClick={this.toggleShowLeaderBoard}>\n\t\t                    <ReloadTimer stores={this.props.stores} classNames='float-right ml-2' reloadLastEpoch={reloadLastEpoch} />\n\t\t\t\t\t\t\t<span class='float-left'>Leaderboard</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>}\n\n\t\t\t\t\t{!showNews && <div class='position-absolute' style='bottom: 40px; right: 5px; z-index: 99999999; width: 150px; height: 50px;'>\n\t\t\t\t\t\t<button type='button' class='btn btn-sm btn-primary float-right' onClick={this.toggleShowNews}>\n\t\t\t\t\t\t\t<span class='float-left'>News</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>}\n\n\t\t\t\t\t{showNews && race && race.articles && race.articles && race.articles.length >  0 && <div class='position-absolute' style='bottom: 50px; right: 5px; z-index: 99999999; width: 350px; height: 40vh;'>\n\t\t\t\t\t\t<div class='container-fluid bg-light rounded-lg py-2 overflow-auto mt-2' style='opacity: 0.9; height: 90%;'>\n\t\t\t\t\t\t\t<div class='row bg-light'>\n\t\t\t\t\t\t\t\t<div class='col-12 bg-primary text-white'>\n\t\t\t\t\t\t\t\t\t<button type='button' class='btn btn-sm btn-danger float-right' onClick={this.toggleShowNews}>\n\t\t\t\t\t\t\t\t\t\tX\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\tNews\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class='col-12 bg-light'>\n\t\t\t\t\t\t\t\t\t{race && race.articles && race.articles.reverse().map(article => <div class='border-bottom mb-2 pb-2 clearfix'>\n\t\t\t\t\t\t\t\t\t\t<small class='text-muted float-right'>{util.formatDate(article.date, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</small>\n\t\t\t\t\t\t\t\t\t\t<h5>{mu.replaceImages(article.title, article.images, language, false)}</h5>\n\t\t\t\t\t\t\t\t\t\t{article.image && <img src={article.image.s3LargeLink} class='float-right rounded-lg ml-2' style='height: 100px;' />}\n\n\t\t\t\t\t\t\t\t\t\t{article.ingress && <strong>\n\t\t\t\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(article.ingress, article.images, language)} markdownOpts={MARKDOWN_OPTIONS} />\n\t\t\t\t\t\t\t\t\t\t</strong>}\n\t\t\t\t\t\t\t\t\t\t{article.body && <p>\n\t\t\t\t\t\t\t\t\t\t\t<Markdown markdown={mu.replaceImages(article.body, article.images, language)} markdownOpts={MARKDOWN_OPTIONS} />\n\t\t\t\t\t\t\t\t\t\t</p>}\n\t\t\t\t\t\t\t\t\t</div>)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>}\n\n\t\t\t\t\t{showLeaderBoard && <div class='position-absolute' style='top: 55px; left: 5px; z-index: 99999999; width: 350px; height: 90vh;'>\n\t\t\t\t\t\t<div class='container-fluid bg-light rounded-lg py-2 overflow-auto mt-2' style='opacity: 0.9; height: 90%;'>\n\t\t\t\t\t\t\t<div class='row bg-light'>\n\t\t\t\t\t\t\t\t<div class='col-12'>\n\t\t\t\t\t\t\t\t\t<button type='button' class='btn btn-sm btn-link float-right' onClick={this.toggleShowLeaderBoard}>\n\t\t\t\t\t\t\t\t\t\tX\n\t\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t\t<ReloadTimer stores={this.props.stores} classNames='float-right' radius={15} fontSize={13} reloadLastEpoch={reloadLastEpoch} />\n\t\t\t\t\t\t\t\t\t<h5 class='mb-0'>Leaderboard</h5>\n\t\t\t\t\t\t\t\t\t{PageTitle(race.title, 'font-weight-normal text-dark', 'font-size: 1.0em;')}\n\n\t\t\t\t\t\t\t\t\t<select class='form-control-plaintext' aria-describedby='classHelp'\n\t\t\t\t\t\t\t\t\t\tonInput={this.chooseRaceClass}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<option value=''>-- Choose class --</option>\n\t\t\t\t\t\t\t\t\t\t{race.classes && race.classes.sort((a, b) => a.distance - b.distance).map(currentClass => <>\n\t\t\t\t\t\t\t\t\t\t\t<option value={currentClass.id}>{currentClass.title} ({currentClass.totalMushers})</option>\n\t\t\t\t\t\t\t\t\t\t</>)}\n\t\t\t\t\t\t\t\t\t</select>\n\n\t\t\t\t\t\t\t\t\t<ul class='mt-2 nav nav-tabs nav-justified tracking-nav'>\n\t\t\t\t\t\t\t\t\t\t<li class='nav-item' style='width: 33%;'>\n\t\t\t\t\t\t\t\t\t\t\t<a class={`nav-link ${leaderboardMode === 'mushers' ? 'active' : ''}`} onClick={this.setLeaderboardMode} data-mode='mushers'><Text id='races.mushers'>Deltakere</Text></a>\n\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t<li class='nav-item' style='width: 33%;'>\n\t\t\t\t\t\t\t\t\t\t\t<a class={`nav-link ${leaderboardMode === 'onTrail' ? 'active' : ''}`} onClick={this.setLeaderboardMode} data-mode='onTrail'><Text id='races.on-trail'>På sporet nå</Text></a>\n\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t<li class='nav-item' style='width: 33%;'>\n\t\t\t\t\t\t\t\t\t\t\t<a class={`nav-link ${leaderboardMode === 'favorites' ? 'active' : ''}`} onClick={this.setLeaderboardMode} data-mode='favorites'><Text id='races.favorites'>Favoritter</Text></a>\n\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t{leaderboardMode === 'mushers' && <>\n\n\t\t\t\t\t\t\t\t{race.classes && race.classes.sort((a, b) => a.distance - b.distance)\n\t\t\t\t\t\t\t\t\t.filter((currentClass) => {\n\t\t\t\t\t\t\t\t\t\tif (filterByraceClass) {\n\t\t\t\t\t\t\t\t\t\t\tif (filterByraceClass === currentClass.id) {\n\t\t\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.map(currentClass => <>\n\t\t\t\t\t\t\t\t\t\t<div class='row mt-2 bg-primary text-white'>\n\t\t\t\t\t\t\t\t\t\t\t<div class='col-12'>\n\t\t\t\t\t\t\t\t\t\t\t\t<h5 class='m-0'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{currentClass.title}\n\t\t\t\t\t\t\t\t\t\t\t\t</h5>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t{classes[currentClass.id] && classes[currentClass.id].contestants && classes[currentClass.id].contestants.map((contestant, idx) => {\n\t\t\t\t\t\t\t\t\t\t\tconst { musher, currentTeam, currentStages, currentResults, completed, duration,\n\t\t\t\t\t\t\t\t\t\t\t\tnormalizedDuration, weightedNormalizedDuration, totalKcalRelated, weightedTotalKcal,\n\t\t\t\t\t\t\t\t\t\t\t\tflatTotalKcal, percentHarder, loadIndex, raceDistance, isDone } = contestant;\n\t\t\t\t\t\t\t\t\t\t\treturn (<>\n\t\t\t\t\t\t\t\t\t\t\t\t<ListMusher stores={this.props.stores} team={currentTeam} idx={idx} />\n\t\t\t\t\t\t\t\t\t\t\t</>);\n\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t</>)}\n\n\n\t\t\t\t\t\t\t\t{/* {(teamList && teamList.length > 0) ? teamList.filter((team) => {\n\t\t\t\t\t\t\t\t\tif (filterByraceClass) {\n\t\t\t\t\t\t\t\t\t\tconst raceClass = raceStore.getClassByTeamId(team.id);\n\t\t\t\t\t\t\t\t\t\tif (filterByraceClass === raceClass.id) {\n\t\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t}).map((team, idx) => <ListMusher stores={this.props.stores} team={team} idx={idx} />) : <>\n\t\t\t\t\t\t\t\t\t<div class='p-2 text-center'>\n\t\t\t\t\t\t\t\t\t\t<h5><Text id='races.no-teams-signed-up'>Ingen team påmeldt ennå...</Text></h5>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</>} */}\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t\t{leaderboardMode === 'favorites' && <>\n\t\t\t\t\t\t\t\t{(teamsInThisRace && teamsInThisRace.length > 0) ? teamsInThisRace.map((teamId, idx) => {\n\t\t\t\t\t\t\t\t\t\tconst team = raceStore.getTeamById(teamId);\n\t\t\t\t\t\t\t\t\t\treturn <ListMusher stores={this.props.stores} team={team} idx={idx} />;\n\t\t\t\t\t\t\t\t\t}\t\n\t\t\t\t\t\t\t\t) : <>\n\t\t\t\t\t\t\t\t\t<div class='p-2 text-center'>\n\t\t\t\t\t\t\t\t\t\t<h5><Text id='races.no-teams-signed-up'>Ingen team påmeldt ennå...</Text></h5>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t\t{leaderboardMode === 'onTrail' && <>\n\t\t\t\t\t\t\t\t<div class='text-muted text-center bg-light'><Text id='races.mushers-on-trail'>Mushers on trail</Text>: {activeTeams.length}</div>\n\t\t\t\t\t\t\t\t{(activeTeams && activeTeams.length > 0) ? activeTeams.filter((line) => {\n\t\t\t\t\t\t\t\t\tif (filterByraceClass) {\n\t\t\t\t\t\t\t\t\t\tconst raceClass = raceStore.getClassByTeamId(line.team);\n\t\t\t\t\t\t\t\t\t\tif (filterByraceClass === raceClass.id) {\n\t\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t}).map((line, idx) => {\n\t\t\t\t\t\t\t\t\tconst team = raceStore.getTeamById(line.team);\n\t\t\t\t\t\t\t\t\treturn (<ListMusher stores={this.props.stores} team={team} idx={idx} />);\n\t\t\t\t\t\t\t\t}) : <>\n\t\t\t\t\t\t\t\t\t<div class='p-2 text-center'>\n\t\t\t\t\t\t\t\t\t\t<h5><Text id='races.no-team-on-trail'>Ingen team tracker live i The Musher appen akkurat nå...</Text></h5>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t\t</>}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>}\n\n\t\t\t\t\t{(infoOnMushers && infoOnMushers.length > 0 && teamList && teamList.length > 0) && <>\n\t\t\t\t\t\t<div class='position-absolute overflow-auto' style='top: 15px; right: 55px; z-index: 99999999; max-width: 830px; max-height: 90%;'>\n\t\t\t\t\t\t\t<div class=''>\n\t\t\t\t\t\t\t\t<div class='d-flex flex-wrap'>\n\t\t\t\t\t\t\t\t\t{infoOnMushers.map(teamId => <DisplayMusher stores={this.props.stores} teamId={teamId} />)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</>}\n\n\t\t\t\t</div>\n\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default PublicRaceDetail;\n","import { h, Component } from 'preact';\nimport { observer } from 'mobx-preact';\n\nconst initialState = {\n};\n\n@observer\nclass RaceText extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n    render() {\n\t\tconst { appState } = this.props.stores;\n\t\tconst { text } = this.props;\n\t\tconst { darkmode, language = 'en' } = appState;\n\n        let finalText = text;\n\n        const regex = new RegExp(`/<${language}>(.*?)<\\/${language}>/`);\n        const parsedText = text.replace(regex, '$1');\n        if (parsedText) {\n            finalText = text;\n        }\n\n\t\treturn (\n\t\t\t<>\n                {finalText}\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default RaceText;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nfunction meterToFeet(value) {\n    return 3.28084 * value;\n}\n\n@observer\nclass Elevation extends Component {\n    render() {\n\t\tconst { value = 0, smallUnit } = this.props;\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { settings = {} } = user;\n\n        if (settings.imperial) {\n            return (<>\n                <nobr>\n                    {util.format(meterToFeet(value), 0)} {smallUnit ? <><small><small><small class='ml-0 text-muted'>ft</small></small></small></> : <>ft</>}\n                </nobr>\n            </>);\n        }\n\n\t\treturn (<>\n            <nobr>\n                {util.format(value, 0)} {smallUnit ? <><small><small><small class='ml-0 text-muted'>m</small></small></small></> : <>m</>}\n            </nobr>\n        </>);\n    }\n}\n\nexport default Elevation;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nfunction kmtToMph(value) {\n    return 0.621371 * value;\n}\n\n@observer\nclass Speed extends Component {\n    render() {\n\t\tconst { value = 0, smallUnit } = this.props;\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { settings = {} } = user;\n\n        if (settings.imperial) {\n            return (<>\n                <nobr>\n                    {util.format(kmtToMph(value), 1)} {smallUnit ? <><small><small><small class='ml-0 text-muted'><Text id='workouts.mph'>mph</Text></small></small></small></> : <><Text id='workouts.mph'>mph</Text></>}\n                </nobr>\n            </>);\n        }\n\n\t\treturn (<>\n            <nobr>\n                {util.format(value, 1)} {smallUnit ? <><small><small><small class='ml-0 text-muted'><Text id='workouts.kmt'>km/t</Text></small></small></small></> : <><Text id='workouts.kmt'>km/t</Text></>}\n            </nobr>\n        </>);\n    }\n}\n\nexport default Speed;\n","import { h, Component } from 'preact';\nimport { useEffect } from \"preact/hooks\";\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nconst initialState = {\n};\n\n@observer\nclass DisplayMusher extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\ttoggleFocusOnMusher = (e) => {\n\t\tconst musherId = e.target.parentElement.dataset.musherid || e.target.dataset.musherid;\n\t\tconst { appState, raceStore } = this.props.stores;\n\t\tappState.toggleFocusOnMusher(parseInt(musherId, 10));\n\n\t\tconst { focusOnMushers } = appState;\n\t\traceStore.getWorkoutSummaryActiveTeams(focusOnMushers);\n\t}\n\n\ttoggleInfoOnMusher = (e) => {\n\t\tconst musherId = e.target.parentElement.dataset.musherid || e.target.dataset.musherid;\n\t\tconst { appState } = this.props.stores;\n\t\tappState.toggleInfoOnMusher(parseInt(musherId, 10));\n\t}\n\n    render() {\n\t\tconst { raceStore, appState } = this.props.stores;\n\t\tconst { teamId } = this.props;\n\t\tconst { darkmode, language = 'en' } = appState;\n\t\tconst { race } = raceStore;\n\n        const team = raceStore.getTeamById(teamId);\n        if (!team || !team.id) {\n            return <></>;\n        }\n        const line = raceStore.getActiveTeamById(team.id);\n        const currentStages = raceStore.getWorkoutSummaryByTeam(team.id).reverse();\n        const currentClass = raceStore.getClassByTeamId(team.id);\n        const currentResults = raceStore.getWorkoutResultsByTeam(currentStages, currentClass.distance);\n        const musher = raceStore.getMusherByTeamId(team.id);\n        const image = team.images && team.images.length > 0 ? team.images[0] : {};\n        const raceClass = raceStore.getClassByTeamId(team.id);\n\n        const completed = currentResults.distanceKm / currentClass.distance * 100;\n        const hasStarted = completed > 0 ? 1 : 0;\n        const isDone = completed >= 100 ? 1 : 0;\n\n        let currentSpeed;\n        let updated;\n        let isActive;\n        if (line && line.currentLocation && line.currentLocation.coords) {\n            currentSpeed = line.currentLocation.coords.speed * 3.6;\n            updated = line.currentLocation.timestamp;\n            isActive = true;\n        }\n        let toFinish = raceClass.distance - currentResults.distanceKm;\n        if (toFinish < 0) {\n            toFinish = 0;\n        }\n\n        // const currentSpeed = util.format(line.currentLocation.coords.speed * 3.6, 1);\n        // avgDogs: 9.777777777777779\n        // distanceKm: 268.3432364824406\n        // duration: 67524.34002106966\n        // elevation: 5287.123805500813\n        // flatTotalKcal: 4971.658025959346\n        // images: Array(32) [ Proxy, Proxy, Proxy, … ]\n        // loadIndex: 1446\n        // rest: 2306\n        // speedAvg: 14.820718823260847\n        // totalKcalRelated: 1225.314525471911\n        // weightedTotalKcal: 11344.398317216459\n\n\n\t\treturn (\n\t\t\t<>\n                <div class='mr-2 mb-2 overflow-auto' style='width: 350px !important; max-height: 350px; overflow-x: hidden !important;'>\n                    <div class='p-2 bg-light rounded-lg'>\n                        <div class='row mt-2' style='font-size: 0.9em;'>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n                            <div class='col-4 text-center'>\n                                <div\n                                    class={`text-center text-muted pt-2 h-100`}\n                                    style={`background-image: url(\"${image.s3SmallLink}\"); background-size: cover;`}\n                                    onClick={this.toggleFocusOnMusher} data-musherid={team.id}\n                                >\n                                    {!image.s3SmallLink && <>\n                                        <span class='font-weight-lighter' style='font-size: 55px;'>\n                                            {util.ucfirst(String(musher.firstname), true)}\n                                            {util.ucfirst(String(musher.lastname), true)}\n                                        </span>\n                                    </>}\n                                </div>\n                            </div>\n                            <div class='col-8'>\n                                <div class='row'>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n                                    <div class='col-12' style='font-size: 1.5em; line-height: 1.0em;'>\n                                        <button\n                                            type='button'\n                                            class='btn btn-sm float-right'\n                                            onClick={this.toggleInfoOnMusher} data-musherid={team.id}\n                                        >\n                                            X\n                                        </button>\n                                        <span class='font-weight-bold'>{musher.firstname} {musher.lastname}</span><br />\n                                        <span class='font-weight-lighter'>{team.name}</span><br />\n                                        {raceClass && raceClass.title && <>\n                                            <span class='font-weight-lighter mr-2' style='font-size: 0.8em;'>\n                                                {raceClass.title} - \n                                            </span>\n                                        </>}\n                                        <span class='font-weight-lighter' style='font-size: 0.8em;'>\n                                            {util.format(currentResults.avgDogs, 1)} <i class='fas fa-dog text-muted ml-1' />\n                                        </span>\n                                    </div>\n                                </div>\n                                <div class='row mt-2'>\n                                    <div class='col-4 text-center' style='line-height: 1.4em;'>\n                                        <span class='text-muted'>km/t</span><br />\n                                        <span style='font-size: 2.0em;'>{util.format(currentResults.speedAvg, 1)}</span>\n                                    </div>\n                                    <div class='col-4 text-center' style='line-height: 1.4em;'>\n                                        <span class='text-muted'>km</span><br />\n                                        <span style='font-size: 2.0em;'>{util.format(currentResults.distanceKm)}</span>\n                                    </div>\n                                    <div class='col-4 text-center' style='line-height: 1.4em;'>\n                                        <span class='text-muted'>to finish</span><br />\n                                        <span style='font-size: 2.0em;'>\n                                            {toFinish === 0 ? <i class='fas fa-flag-checkered text-success' /> : <>{util.format(toFinish, 0)}</>}\n                                        </span>\n                                    </div>\n                                </div>\n                                <div class='row mt-2'>\n                                    <div class='col-6 text-center' style='line-height: 1.4em;'>\n                                        <span class='text-muted'>\n                                            {toFinish === 0 ? <>\n                                                Calc.Duration\n                                            </> : <>\n                                                Duration\n                                            </>}\n                                        </span><br />\n                                        <span style='font-size: 1.5em;'>\n                                            {toFinish === 0 ? <>\n                                                {util.secToHms(currentResults.weightedNormalizedDuration || currentResults.duration)}\n                                            </> : <>\n                                                {util.secToHms(currentResults.duration)}\n                                            </>}\n                                        </span>\n                                    </div>\n                                    <div class='col-6 text-center' style='line-height: 1.4em;'>\n                                        <span class='text-muted'>Status</span><br />\n                                        <span style='font-size: 1.5em;'>\n                                            {isActive ? <>\n                                                {line.isInProgress === 1 ? <span class='text-primary'>running</span> : ''}\n                                                {line.isInProgress === 2 ? <span class='text-danger'>resting</span> : ''}\n                                                {toFinish === 0 ? <>\n                                                    {!line.isInProgress ? <span class='text-success'>FINISH</span> : ''}\n                                                </> : <>\n                                                    {!line.isInProgress ? <>\n                                                        {hasStarted ? <span class='text-danger'>resting</span> : <span class='text-muted'>NYS</span>}\n                                                    </> : '-'}                                                    \n                                                </>}\n                                            </> : <>\n                                                {toFinish === 0 ? <span class='text-success'>FINISH</span> : <>\n                                                    {hasStarted ? <span class='text-danger'>resting</span> : <span class='text-muted'>NYS</span>}\n                                                </>}\n                                            </>}\n                                        </span>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        <div class='row mt-2' style='font-size: 0.9em;'>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n                            <div class='col-6'>\n                                <table class='table table-sm table-striped'>\n                                    <tbody>\n                                        <tr>\n                                            <td>Current speed</td>\n                                            <td>{currentSpeed ? <>{util.format(currentSpeed, 1)} km/t</> : '-'}</td>\n                                        </tr>\n                                        <tr>\n                                            <td>Avg speed</td>\n                                            <td>{util.format(currentResults.speedAvg, 1)} km/t</td>\n                                        </tr>\n                                        <tr>\n                                            <td>Duration</td>\n                                            <td>{util.secToHms(currentResults.duration)}</td>\n                                        </tr>\n                                        <tr>\n                                            <td>Calculated duration</td>\n                                            <td>{util.secToHms(currentResults.weightedNormalizedDuration)}</td>\n                                        </tr>\n                                        <tr>\n                                            <td>Rest</td>\n                                            <td>{util.secToHms(currentResults.rest)}</td>\n                                        </tr>\n                                        <tr>\n                                            <td>Elevation</td>\n                                            <td>{util.format(currentResults.elevation, 0)} m</td>\n                                        </tr>\n                                        <tr>\n                                            <td>Altitude</td>\n                                            <td>{isActive ? <>{line.currentLocation.coords.altitude} moh</> : '-'}</td>\n                                        </tr>\n                                        <tr>\n                                            <td>Load index</td>\n                                            <td>{currentResults.loadIndex}</td>\n                                        </tr>\n                                        <tr>\n                                            <td>Updated:</td>\n                                            <td>{isActive ? <>{util.formatDistance(updated, new Date())} ago</> : '-'}</td>\n                                        </tr>\n                                    </tbody>\n                                </table>\n                            </div>\n                            <div class='col-6'>\n                                <span>Elevation profile:</span><br />\n                                {isActive ? <svg viewBox='0 0 300 100' style='width: 180px; height: 60px; top: 0; left: 0;'>\n                                    <path d={`${line.svgElevation}`} style='fill: #0063FF; stroke: #0063FF; stroke-width: 2; opacity: 0.2;' />\n                                </svg> : <div>-</div>}\n                                <span>Map profile:</span><br />\n                                {isActive ? <svg viewBox='0 0 300 300' style='width: 180px; height: 180px; top: 0; left: 0;'>\n                                    <path d={`${line.svgMap}`} style='fill: none; stroke: #FF6300; stroke-width: 5; opacity: 0.2;' />\n                                </svg> : <div>-</div>}\n                            </div>\n                        </div>\n\n                        <div class='mt-2' style='font-size: 0.9em;'>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\n                            <div class='d-flex flex-wrap'>\n                                {currentStages && currentStages.map((stage, idx) => {\n                                    const percent = stage.distanceKm / currentClass.distance * 100;\n                                    const width = percent > 100 ? 100 : parseInt(percent, 10);\n                                    const currentEpoch = Math.floor(new Date(stage.date).getTime() / 1000);\n                                    const inDate = new Date(0); // The 0 there is the key, which sets the date to the epoch\n                                    inDate.setUTCSeconds(currentEpoch + parseInt(stage.duration, 10));\n                                    const images = stage.images.flat();\n                                    if (1) {\n                                        return (<>\n                                            <div class='bg-light border rounded-lg text-right position-relative mr-1 mb-1'>\n                                                <svg viewBox='0 0 300 100' class='position-absolute' style='width: 100%; height: 95%; bottom: 0px; left: 0px; z-index: 0;'>\n                                                    <path d={`${stage.svgElevation}`} style='fill: #0063FF; stroke: #0063FF; stroke-width: 2; opacity: 0.2;' />\n                                                </svg>\n                                                <div class='position-relative px-3'>\n                                                    <span class='position-absolute' style='top: 3px; left: 3px; font-size: 1.3em;'>{idx + 1}</span>\n                                                    <small>\n                                                        <span class='float-left'>\n                                                            <nobr><i style='width: 20px;' class='fas fa-sign-out-alt' /> {util.formatDate(stage.date, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</nobr>\n                                                            <nobr><i style='width: 20px;' class='fas fa-sign-in-alt' /> {util.formatDate(inDate, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</nobr>\n                                                        </span>\n                                                        <span class='float-right'>\n                                                            {/* {restTimeText}\n                                                            {restTimeTrackText} */}\n                                                            <nobr><i style='width: 20px;' class='fas fa-road' /> {util.format(stage.distanceKm, 1) || 'n/a'} <span class='font-weight-lighter'>km</span></nobr>\n                                                            <nobr><i style='width: 20px;' class='fas fa-mountain' /> {util.format(stage.elevation, 0) || 'n/a'} <span class='font-weight-lighter'>m</span></nobr>\n                                                            <nobr><i style='width: 20px;' class='fas fa-tachometer-alt' /> {util.format(stage.speedAvg, 1) || 'n/a'} <span class='font-weight-lighter'>km/t</span></nobr><br />\n\n                                                            <nobr><i style='width: 20px;' class='fas fa-clock' /> {util.secToHms(stage.duration) || 'n/a'}</nobr>\n                                                            <nobr><i style='width: 20px;' class='fas fa-moon' /> {util.secToHms(stage.rest) || 'n/a'}</nobr><br />\n                                                            <nobr><i style='width: 20px;' class='fas fa-dog' /> {util.format(stage.avgDogs, 0) || 'n/a'}</nobr>\n                                                            <nobr><i style='width: 20px;' class='fas fa-balance-scale' /> {util.format(stage.loadIndex, 0) || 'n/a'}</nobr><br />\n                                                            <nobr><i style='width: 20px;' class='fas fa-images' /> {images.length}</nobr><br />\n                                                        </span>\n                                                    </small>\n                                                </div>\n                                            </div>\n                                        </>);\n                                    }\n                                    return (<>\n                                        <div class='bg-light border rounded-lg text-right position-relative px-3 mr-1 mb-1' style={`width: ${width}%; min-width: 320px;`}>\n                                            <small>\n                                                <span class='float-left'>{idx + 1}</span>\n                                                <nobr><i style='width: 20px;' class='fas fa-road' /> {util.format(stage.distanceKm, 1) || 'n/a'} <span class='font-weight-lighter'>km</span></nobr>\n                                                <nobr><i style='width: 20px;' class='fas fa-tachometer-alt' /> {util.format(stage.speedAvg, 1) || 'n/a'} <span class='font-weight-lighter'>km/t</span></nobr>\n                                                <nobr><i style='width: 20px;' class='fas fa-clock' /> {util.secToHms(stage.duration) || 'n/a'}</nobr>\n                                            </small>\n                                        </div>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n                                    </>);\n                                })}\n                            </div>\n\n                        </div>\n\n                    </div>\n                </div>\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default DisplayMusher;\n"],"sourceRoot":""}