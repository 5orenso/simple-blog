(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{"4imK":function(t,e,s){"use strict";(function(t){var a,r=s("hosL"),o=s("Utv1"),i=s("/eY4"),n=s("OhSV"),l=s("nHdA"),c=s("irB3"),h=(s("UwwE"),s("8Lgr"));s("QkTp");let d=Object(i.a)(a=class extends r.Component{constructor(...t){var e;super(...t),e=this,this.toggleDate=t=>{t.stopPropagation(),t.preventDefault();const{showDate:e}=this.state;this.setState({showDate:!e})},this.ignoreGarminWorkout=async function(t){t.stopPropagation();const s=t.target.parentElement.dataset.id||t.target.dataset.id,{garminActivityDetailsStore:a}=e.props.stores;await a.ignoreWorkout(s),e.loadGarminActivities()},this.importGarminWorkout=async function(t){t.stopPropagation();const s=t.target.parentElement.dataset.id||t.target.dataset.id,{asTrack:a}=e.props,{garminActivityDetailsStore:r,workoutStore:o}=e.props.stores,{currentTeam:i}=o;a?await r.importTrack(s,i):await r.importWorkout(s,i),e.loadGarminActivities(),e.loadWorkouts()},this.loadWorkouts=async function(){const{workoutStore:t}=e.props.stores,{currentTeam:s}=t;await t.load({query:{team:s}})},this.toggleDetail=()=>{const{showDetail:t=!1}=this.state;this.setState({showDetail:!t})}}async loadGarminActivities(){const{garminActivityDetailsStore:t}=this.props.stores;t.load({query:{hideImported:1}})}componentDidMount(){this.loadGarminActivities()}render(){const{showDate:e,showDetail:s=!1}=this.state,{activities:a=[],showDate:i,asTrack:d=!1}=this.props,{userStore:u,workoutStore:p}=this.props.stores,{currentTeam:b}=p,{team:m}=u,g=u.findTeam(b||m.id);return s?Object(r.h)(t,null,Object(r.h)("div",{class:"col-12 mb-3"},Object(r.h)("div",{class:"row"},a&&a.length>0&&Object(r.h)("div",{class:"col-12 border-top border-bottom pt-3 pb-3 my-2 bg-light"},Object(r.h)("button",{type:"button",class:"float-right btn btn-sm btn-link",onClick:this.toggleDetail},Object(r.h)("i",{class:"fas fa-caret-up"})," ",Object(r.h)(n.c,{id:"garmin.hide-list"},"Hide list")),Object(r.h)("h5",null,Object(r.h)(n.c,{id:"workout.index.garmin-workouts"},"Garmin workouts / not imported")," ",a.length),a&&a.map(s=>{const{summary:a={}}=s,u=o.a.parseInputDate(a.startTimeInSeconds);return Object(r.h)(t,null,Object(r.h)("div",{class:"col-12 d-flex mb-4 position-relative"},Object(r.h)("div",{class:"text-center border rounded-circle imageRounded",style:'background-image: url("./assets/garmin-connect.png"); border-width: 3px !important;'}," "),Object(r.h)("div",{class:"flex-grow-1 pl-3",style:"line-height: 1.2em;"},Object(r.h)("h5",{class:"my-0 mb-1",style:"line-height: 1.0em;"},a.deviceName),a.activityType,Object(r.h)("br",null),Object(r.h)("small",{class:"text-muted"},u&&Object(r.h)("small",{onClick:this.toggleDate},i||e?o.a.formatDate(u,{locale:"no-NB"}):o.a.formatDistance(u,new Date,{locale:"no-NB"})),Object(r.h)("span",{class:"text-muted"},Object(r.h)("i",{class:"fas fa-road ml-2"})," ",Object(r.h)(h.a,{stores:this.props.stores,value:a.distanceInMeters/1e3}),Object(r.h)("i",{class:"fas fa-mountain ml-2"})," ",Object(r.h)(c.a,{stores:this.props.stores,value:a.totalElevationGainInMeters}),Object(r.h)("i",{class:"fas fa-tachometer-alt ml-2"})," ",Object(r.h)(l.a,{stores:this.props.stores,value:3.6*a.averageSpeedInMetersPerSecond}),Object(r.h)("i",{class:"fas fa-stopwatch ml-2"})," ",o.a.secToHms(a.durationInSeconds))),Object(r.h)("br",null),Object(r.h)("button",{class:"btn btn-sm btn-block btn-primary",onClick:this.importGarminWorkout,"data-id":s.id},Object(r.h)("i",{class:"fas fa-file-import"})," ",d?Object(r.h)(n.c,{id:"garmin.import-track"},"Import as track"):Object(r.h)(t,null,Object(r.h)(n.c,{id:"garmin.import"},"Import workout")," ",Object(r.h)("i",{class:"fas fa-arrow-right"})," ",g)),Object(r.h)("button",{class:"btn btn-sm btn-link",onClick:this.ignoreGarminWorkout,"data-id":s.id},Object(r.h)("i",{class:"fas fa-trash-alt"})," ",Object(r.h)(n.c,{id:"garmin.ignore"},"Ignore workout")))))}),Object(r.h)("button",{type:"button",class:"btn btn-block btn-primary mt-3",onClick:this.toggleDetail},Object(r.h)("i",{class:"fas fa-caret-up"})," ",Object(r.h)(n.c,{id:"garmin.hide-list"},"Hide list")))))):a&&a.length>0?Object(r.h)(t,null,Object(r.h)("div",{class:"col-12 mb-3"},Object(r.h)("button",{type:"button",class:"btn btn-block btn-outline-info",onClick:this.toggleDetail},Object(r.h)("div",{class:"float-right ml-2 text-center border rounded-circle imageRounded imageRoundedIcon",style:"background-image: url('./assets/garmin-connect.png');"}),Object(r.h)(n.c,{id:"workout.index.garmin-workouts"},"Garmin workouts / not imported")," ",a.length))):Object(r.h)(t,null)}})||a;e.a=d}).call(this,s("hosL").Fragment)},"8Lgr":function(t,e,s){"use strict";(function(t){function a(t){return i.a.format(t,t<5?2:1)}var r,o=s("hosL"),i=s("Utv1"),n=s("/eY4");s("OhSV"),s("ZOvn");let l=Object(n.a)(r=class extends o.Component{render(){const{value:e=0,smallUnit:s}=this.props,{userStore:r}=this.props.stores,{user:i}=r,{settings:n={}}=i;return n.imperial?Object(o.h)(t,null,Object(o.h)("nobr",null,a(function(t){return.621371*t}(e))," ",s?Object(o.h)(t,null,Object(o.h)("small",null,Object(o.h)("small",null,Object(o.h)("small",{class:"ml-0 text-muted"},"mi")))):Object(o.h)(t,null,"mi"))):Object(o.h)(t,null,Object(o.h)("nobr",null,a(e)," ",s?Object(o.h)(t,null,Object(o.h)("small",null,Object(o.h)("small",null,Object(o.h)("small",{class:"ml-0 text-muted"},"km")))):Object(o.h)(t,null,"km")))}})||r;e.a=l}).call(this,s("hosL").Fragment)},ETxl:function(t){t.exports={hoverelementonly:"hoverelementonly__1mJGJ",hoverElement:"hoverElement__axh3O",hoverelementhide:"hoverelementhide__1k_qH","progress-bar-vertical":"progress-bar-vertical__1B2sC","progress-bar":"progress-bar__pnsVj",dragged:"dragged__QXO46",over:"over__1re3x",list:"list__q_emZ"}},QkTp:function(t,e,s){"use strict";(function(t){var a,r=s("hosL"),o=s("Utv1"),i=s("/eY4");s("OhSV"),s("ZOvn");let n=Object(i.a)(a=class extends r.Component{render(){const{value:e=0}=this.props,{userStore:s}=this.props.stores,{user:a}=s,{settings:i={}}=a;return i.imperial?Object(r.h)(t,null,Object(r.h)("nobr",null,o.a.format(function(t){return 9*t/5+32}(e),0),"°F")):Object(r.h)(t,null,Object(r.h)("nobr",null,o.a.format(e,1),"°C"))}})||a;e.a=n}).call(this,s("hosL").Fragment)},UwwE:function(t,e,s){"use strict";(function(t){var a,r=s("hosL"),o=s("Utv1"),i=s("/eY4");s("OhSV"),s("ZOvn");let n=Object(i.a)(a=class extends r.Component{render(){const{value:e=0}=this.props,{userStore:s}=this.props.stores,{user:a}=s,{settings:i={}}=a;return i.imperial?Object(r.h)(t,null,Object(r.h)("nobr",null,o.a.format(function(t){return 2.20462*t}(e),0)," lb")):Object(r.h)(t,null,Object(r.h)("nobr",null,o.a.format(e,0)," kg"))}})||a;e.a=n}).call(this,s("hosL").Fragment)},bUJL:function(t,e,s){"use strict";(function(t){var a,r=s("hosL"),o=s("Utv1"),i=s("/eY4"),n=s("OhSV"),l=s("nHdA"),c=s("irB3"),h=(s("UwwE"),s("8Lgr"));s("QkTp");let d=Object(i.a)(a=class extends r.Component{constructor(...t){var e;super(...t),e=this,this.toggleDate=t=>{t.stopPropagation(),t.preventDefault();const{showDate:e}=this.state;this.setState({showDate:!e})},this.ignoreStravaWorkout=async function(t){t.stopPropagation();const s=t.target.parentElement.dataset.id||t.target.dataset.id,{stravaActivityStore:a}=e.props.stores;await a.ignoreWorkout(s),e.loadStravaActivities()},this.importStravaWorkout=async function(t){t.stopPropagation();const s=t.target.parentElement.dataset.id||t.target.dataset.id,{stravaActivityStore:a,workoutStore:r}=e.props.stores,{currentTeam:o}=r;await a.importWorkout(s,o),e.loadStravaActivities(),e.loadWorkouts()},this.loadWorkouts=async function(){const{workoutStore:t}=e.props.stores,{currentTeam:s}=t;await t.load({query:{team:s}})},this.toggleDetail=()=>{const{showDetail:t=!1}=this.state;this.setState({showDetail:!t})}}async loadStravaActivities(){const{stravaActivityStore:t}=this.props.stores;t.load({query:{hideImported:1}})}componentDidMount(){this.loadStravaActivities()}render(){const{showDate:e,showDetail:s=!1}=this.state,{activities:a,showDate:i}=this.props,{userStore:d,workoutStore:u}=this.props.stores,{currentTeam:p}=u,{team:b}=d,m=d.findTeam(p||b.id);return s?Object(r.h)(t,null,Object(r.h)("div",{class:"col-12 mb-3"},Object(r.h)("div",{class:"row"},a&&a.length>0&&Object(r.h)("div",{class:"col-12 border-top border-bottom pt-3 pb-3 my-2 bg-light"},Object(r.h)("button",{type:"button",class:"float-right btn btn-sm btn-link",onClick:this.toggleDetail},Object(r.h)("i",{class:"fas fa-caret-up"})," ",Object(r.h)(n.c,{id:"strava.hide-list"},"Hide list")),Object(r.h)("h5",null,Object(r.h)(n.c,{id:"workout.index.strava-workouts"},"Strava workouts / not imported")," ",a.length),a&&a.map(s=>{const{summary:a={}}=s;o.a.parseInputDate(a.startTimeInSeconds);return Object(r.h)(t,null,Object(r.h)("div",{class:"col-12 d-flex mb-4 position-relative"},Object(r.h)("div",{class:"text-center border rounded-circle imageRounded",style:'background-image: url("./assets/strava-icon.png"); border-width: 3px !important;'}," "),Object(r.h)("div",{class:"flex-grow-1 pl-3",style:"line-height: 1.2em;"},Object(r.h)("h5",{class:"my-0 mb-1",style:"line-height: 1.0em;"},s.name),s.type,Object(r.h)("br",null),Object(r.h)("small",{class:"text-muted"},s.start_date&&Object(r.h)("small",{onClick:this.toggleDate},i||e?o.a.formatDate(s.start_date,{locale:"no-NB"}):o.a.formatDistance(s.start_date,new Date,{locale:"no-NB"})),Object(r.h)("span",{class:"text-muted"},Object(r.h)("i",{class:"fas fa-road ml-2"})," ",Object(r.h)(h.a,{stores:this.props.stores,value:s.distance/1e3}),Object(r.h)("i",{class:"fas fa-mountain ml-2"})," ",Object(r.h)(c.a,{stores:this.props.stores,value:s.total_elevation_gain}),Object(r.h)("i",{class:"fas fa-tachometer-alt ml-2"})," ",Object(r.h)(l.a,{stores:this.props.stores,value:3.6*s.average_speed}),Object(r.h)("i",{class:"fas fa-stopwatch ml-2"})," ",o.a.secToHms(s.elapsed_time))),Object(r.h)("br",null),Object(r.h)("button",{class:"btn btn-sm btn-block btn-primary",onClick:this.importStravaWorkout,"data-id":s.id},Object(r.h)("i",{class:"fas fa-file-import"})," ",Object(r.h)(n.c,{id:"strava.import"},"Import workout")," ",Object(r.h)("i",{class:"fas fa-arrow-right"})," ",m),Object(r.h)("button",{class:"btn btn-sm btn-link",onClick:this.ignoreStravaWorkout,"data-id":s.id},Object(r.h)("i",{class:"fas fa-trash-alt"})," ",Object(r.h)(n.c,{id:"strava.ignore"},"Ignore workout")))))}),Object(r.h)("button",{type:"button",class:"btn btn-block btn-primary mt-3",onClick:this.toggleDetail},Object(r.h)("i",{class:"fas fa-caret-up"})," ",Object(r.h)(n.c,{id:"strava.hide-list"},"Hide list")))))):a&&a.length>0?Object(r.h)(t,null,Object(r.h)("div",{class:"col-12 mb-3"},Object(r.h)("button",{type:"button",class:"btn btn-block btn-outline-info",onClick:this.toggleDetail},Object(r.h)("div",{class:"float-right ml-2 text-center border rounded-circle imageRounded imageRoundedIcon",style:"background-image: url('./assets/strava-icon.png');"}),Object(r.h)(n.c,{id:"workout.index.strava-workouts"},"Strava workouts / not imported")," ",a.length))):Object(r.h)(t,null)}})||a;e.a=d}).call(this,s("hosL").Fragment)},irB3:function(t,e,s){"use strict";(function(t){var a,r=s("hosL"),o=s("Utv1"),i=s("/eY4");s("OhSV"),s("ZOvn");let n=Object(i.a)(a=class extends r.Component{render(){const{value:e=0,smallUnit:s}=this.props,{userStore:a}=this.props.stores,{user:i}=a,{settings:n={}}=i;return n.imperial?Object(r.h)(t,null,Object(r.h)("nobr",null,o.a.format(function(t){return 3.28084*t}(e),0)," ",s?Object(r.h)(t,null,Object(r.h)("small",null,Object(r.h)("small",null,Object(r.h)("small",{class:"ml-0 text-muted"},"ft")))):Object(r.h)(t,null,"ft"))):Object(r.h)(t,null,Object(r.h)("nobr",null,o.a.format(e,0)," ",s?Object(r.h)(t,null,Object(r.h)("small",null,Object(r.h)("small",null,Object(r.h)("small",{class:"ml-0 text-muted"},"m")))):Object(r.h)(t,null,"m")))}})||a;e.a=n}).call(this,s("hosL").Fragment)},nHdA:function(t,e,s){"use strict";(function(t){var a,r=s("hosL"),o=s("Utv1"),i=s("/eY4"),n=s("OhSV");s("ZOvn");let l=Object(i.a)(a=class extends r.Component{render(){const{value:e=0,smallUnit:s}=this.props,{userStore:a}=this.props.stores,{user:i}=a,{settings:l={}}=i;return l.imperial?Object(r.h)(t,null,Object(r.h)("nobr",null,o.a.format(function(t){return.621371*t}(e),1)," ",s?Object(r.h)(t,null,Object(r.h)("small",null,Object(r.h)("small",null,Object(r.h)("small",{class:"ml-0 text-muted"},Object(r.h)(n.c,{id:"workouts.mph"},"mph"))))):Object(r.h)(t,null,Object(r.h)(n.c,{id:"workouts.mph"},"mph")))):Object(r.h)(t,null,Object(r.h)("nobr",null,o.a.format(e,1)," ",s?Object(r.h)(t,null,Object(r.h)("small",null,Object(r.h)("small",null,Object(r.h)("small",{class:"ml-0 text-muted"},Object(r.h)(n.c,{id:"workouts.kmt"},"km/t"))))):Object(r.h)(t,null,Object(r.h)(n.c,{id:"workouts.kmt"},"km/t"))))}})||a;e.a=l}).call(this,s("hosL").Fragment)},nKYJ:function(t,e,s){"use strict";s.r(e),function(t){function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function r(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var o,i=s("hosL"),n=(s("Utv1"),s("/eY4")),l=s("OhSV"),c=s("go65"),h=s("w8dD"),d=(s("bUJL"),s("4imK")),u=s("ZOvn");const p=u.a.marginTop(!0),b=u.a.marginBottom(),m=u.a.subMenuMarginTop(),g={isLoading:!1};let O=Object(n.a)(o=class extends i.Component{constructor(t){super(t),this.state=function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){r(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},g)}async loadTracks(){this.setState({isLoading:!0});const{trackStore:t,userStore:e,messageStore:s}=this.props.stores;await t.load(),await e.getNotifications(),await s.getUnReadMessages(),this.setState({isLoading:!1})}async loadStravaActivities(){const{stravaActivityStore:t}=this.props.stores;t.load({query:{hideImported:1}})}async loadGarminActivities(){const{garminActivityDetailsStore:t}=this.props.stores;t.load({query:{hideImported:1}})}componentDidMount(){this.loadTracks(),this.loadGarminActivities()}render(){const{scrolledDown:e}=this.props,{isLoading:s,searchText:a}=this.state,{trackStore:r,userStore:o,appState:n,workoutStore:u,stravaActivityStore:g,garminActivityDetailsStore:O}=this.props.stores,{tracks:j}=r,{user:f}=o,{darkmode:v}=n,{currentTeam:k}=u,{stravaActivities:w=[]}=g,{garminActivityDetails:y=[]}=O;return Object(i.h)("div",{class:"container-fluid",style:`margin-bottom: ${b}; margin-top: ${p};`},Object(i.h)("div",{class:"row fixed-top pt-2",style:`margin-top: ${e>0?0:m}; background-color: ${v?"#191d21":"#f8f9fa"}; transition: all 0.3s ease-in-out;`},Object(i.h)("div",{class:"col text-center border-bottom border-primary subtopmenu"},Object(i.h)("a",{href:"/tracks/",class:"text-primary stretched-link"},Object(i.h)("nobr",null,Object(i.h)("i",{class:"fas fa-map-marked"})," ",Object(i.h)(l.c,{id:"tracks.your-tracks"},"Dine runder")))),Object(i.h)("div",{class:"col text-center subtopmenu"},Object(i.h)("a",{href:"/tracks/public",class:"text-secondary stretched-link"},Object(i.h)("nobr",null,Object(i.h)("i",{class:"fas fa-map-marked"})," ",Object(i.h)(l.c,{id:"tracks.public-tracks"},"Offentlige runder"))))),Object(i.h)("div",{class:"row"},Object(i.h)("div",{class:"col-12"},Object(i.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 px-0"},Object(i.h)("h5",null,Object(i.h)(l.c,{id:"tracks.all-tracks",fields:{total:j.length}},"Treningsrundene dine - ",j.length," stk"))),Object(i.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 px-0 clearfix mb-2"},Object(i.h)("a",{class:"btn btn-sm btn-primary float-right",href:"/tracks/edit/new"},Object(i.h)("i",{class:"fas fa-plus"})," ",Object(i.h)(l.c,{id:"tracks.add-new"},"Legg til runde"))),!s&&j&&0===j.length&&Object(i.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 text-muted"},Object(i.h)("div",{class:"text-center mb-5"},Object(i.h)("div",{class:"display-1"},Object(i.h)("i",{class:"fas fa-map-marked"})),Object(i.h)("h5",null,Object(i.h)(l.c,{id:"tracks.no-tracks-yet"},"Ingen runder er registrert ennå."))),Object(i.h)("p",{class:"text-center"},Object(i.h)("p",null,Object(i.h)(l.c,{id:"tracks.no-tracks-info-1"},"Du har mulighet til å laste opp GPX-filer fra rundene dine.")),Object(i.h)("p",null,Object(i.h)(l.c,{id:"tracks.no-tracks-info-2"},"Det finnes mange apper som lar deg lage GPX-filer, men vi anbefaler"),":"),"ViewRanger for ",Object(i.h)("a",{href:"https://apps.apple.com/gb/app/viewranger-hike-ride-or-walk/id404581674"},"iOS")," and  ",Object(i.h)("a",{href:"https://play.google.com/store/apps/details?id=com.augmentra.viewranger.android&hl=en"},"Android"),"."),Object(i.h)(l.c,{id:"tracks.howto-title"},"Slik kommer du i gang"),":",Object(i.h)("ol",null,Object(i.h)("li",null,Object(i.h)(l.c,{id:"tracks.howto-1"},'Trykk på knappen "Legg til runde" rett nedenfor.')))))),f&&f.garmin&&Object(i.h)("div",{class:"row"},Object(i.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mb-3"},Object(i.h)("div",{class:"row mt-3"},f&&f.garmin&&Object(i.h)(t,null,Object(i.h)(d.a,{stores:this.props.stores,activities:y,asTrack:!0,key:`garmin-${k}-${y.length}`}))))),Object(i.h)("div",{class:"row"},Object(i.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mb-3"},Object(i.h)("div",{class:"d-flex justify-content-center py-3"},Object(i.h)(l.b,null,Object(i.h)("input",{class:"form-control form-control mr-2",type:"search",placeholder:Object(i.h)(l.c,{id:"header.search-placeholder"},"Søk etter det meste..."),value:a,onInput:Object(c.a)(this,"searchText")}))))),Object(i.h)("div",{class:"row"},Object(i.h)("div",{class:"col-12"},j&&j.filter(t=>!a||new RegExp(a,"i").test(t.name)).map(t=>Object(i.h)(h.a,{stores:this.props.stores,track:t})))))}})||o;e.default=O}.call(this,s("hosL").Fragment)},om2D:function(t,e,s){"use strict";var a,r=s("hosL"),o=s("/eY4"),i=(s("cneo"),s("Utv1"),s("u2zT"));let n=Object(o.a)(a=class extends r.Component{constructor(t){super(t),this.handleAddImage=t=>{const{addToImages:e=!0}=this.props,{updateField:s,object:a,field:r}=this.props;if(r&&s({id:a.id,field:r,value:t,skipTimer:!0}),e){const e=[];e.push(t),s({id:a.id,field:"images",value:e,skipTimer:!0})}},this.state={files:[]}}render(){const{uploadStatus:t=(()=>{}),before:e=(()=>{}),after:s=(()=>{}),autoOpen:a=!0}=this.props;return Object(r.h)("div",{class:"row"},Object(r.h)("div",{class:"col-12"},Object(r.h)(i.a,{handleAddImage:this.handleAddImage,uploadStatus:t,apiUrl:"/api/fileupload",before:e,after:s,autoOpen:a},Object(r.h)("div",{style:{height:30,width:"100%"}}))))}})||a;e.a=n},u2zT:function(t,e,s){"use strict";var a,r=s("hosL"),o=s("/eY4"),i=s("Utv1"),n=s("OhSV");let l=Object(o.a)(a=class extends r.Component{constructor(t){super(t),this.dropRef=Object(r.createRef)(),this.handleDrag=t=>{t.preventDefault(),t.stopPropagation()},this.handleDragIn=t=>{t.preventDefault(),t.stopPropagation(),this.dragCounter++,t.dataTransfer.items&&t.dataTransfer.items.length>0&&this.setState({drag:!0})},this.handleDragOut=t=>{t.preventDefault(),t.stopPropagation(),this.dragCounter--,0===this.dragCounter&&this.setState({drag:!1})},this.handleDrop=t=>{if(t.preventDefault(),t.stopPropagation(),this.setState({drag:!1}),t.dataTransfer.files&&t.dataTransfer.files.length>0){for(let e=0,s=t.dataTransfer.files.length;e<s;e+=1){this.readLocalFile(t.dataTransfer.files[e])}this.dragCounter=0}},this.handleAddFiles=t=>{t.preventDefault();const e=t.target;for(let t=0,s=e.files.length;t<s;t+=1){this.readLocalFile(e.files[t])}},this.handleEvent=()=>{0},this.handleUpload=t=>{const{uploadStatus:e=(()=>{}),before:s=(()=>{}),after:a=(()=>{})}=this.props;e(!1),i.a.isFunction(s)&&s();const r=new FormData;r.append("files[]",t);const o={progress:1};o.xhr=new XMLHttpRequest,o.xhr.upload.addEventListener("progress",e=>{this.updateProgress(e,t)}),o.xhr.addEventListener("loadstart",e=>{this.handleEvent(e,t)}),o.xhr.addEventListener("load",e=>{this.handleEvent(e,t)}),o.xhr.addEventListener("loadend",e=>{const s=t;i.a.isFunction(a)&&a(),this.handleEvent(e,s)}),o.xhr.addEventListener("progress",e=>{this.handleEvent(e,t)}),o.xhr.addEventListener("error",e=>{this.handleEvent(e,t)}),o.xhr.addEventListener("abort",e=>{this.handleEvent(e,t)}),o.xhr.addEventListener("readystatechange",e=>{this.uploadDone(e,t)}),o.xhr.open("POST",`${i.a.getApiServer()}${this.props.apiUrl}`),o.xhr.setRequestHeader("Authorization","Bearer "+i.a.getJwtToken()),o.xhr.send(r);const n=t.name,l=this.state.uploadedFilesData;l[n]||(l[n]={}),l[n].uploadMeta=o,l[n].imageNum=this.state.imageNum,this.setState({uploadedFilesData:l})},this.readLocalFile=t=>new Promise((e,s)=>{const a=new FileReader;a.addEventListener("error",t=>{s(t)}),a.addEventListener("load",s=>{const a=t,r=a.name,o=this.state.uploadedFilesData;o[r]||(o[r]={}),o[r].event=s,this.setState({uploadedFilesData:o}),this.handleUpload(a),e(s)}),a.readAsDataURL(t)}),this.updateProgress=(t,e)=>{if(t.lengthComputable){const s=e.name,a=this.state.uploadedFilesData,r=t.loaded/t.total*100;0,a[s].uploadMeta.progress=r,this.setState({uploadedFilesData:a})}},this.uploadDone=(t,e)=>{const s=e.name,a=this.state.uploadedFilesData,r=a[s].uploadMeta;if(r&&4===r.xhr.readyState&&201===r.xhr.status){const t=JSON.parse(r.xhr.responseText).data.files;for(let e=0;e<t.length;e+=1){this.addFileToUpload(t[e]),this.fileInput.value=""}}},this.state={drag:!1,loadingProgress:0,uploadedFiles:[],uploadedFilesData:{}}}addFileToUpload(t){const{uploadedFilesData:e}=this.state,{handleAddImage:s,uploadStatus:a=(()=>{})}=this.props;delete e[t.name],this.setState({uploadedFilesData:e}),s(t),a(!0)}componentDidMount(){const t=this.dropRef.current;t.addEventListener("dragenter",this.handleDragIn),t.addEventListener("dragleave",this.handleDragOut),t.addEventListener("dragover",this.handleDrag),t.addEventListener("drop",this.handleDrop);const{autoOpen:e}=this.props;e&&setTimeout(()=>{this.fileInput.click()},10)}componentWillUnmount(){const t=this.dropRef.current;t.removeEventListener("dragenter",this.handleDragIn),t.removeEventListener("dragleave",this.handleDragOut),t.removeEventListener("dragover",this.handleDrag),t.removeEventListener("drop",this.handleDrop)}render(){const{uploadedFilesData:t}=this.state;return Object(r.h)("div",{style:{position:"relative"},ref:this.dropRef},this.state.drag&&Object(r.h)("div",{style:{border:"dashed grey 4px",backgroundColor:"rgba(255,255,255,.8)",position:"absolute",top:0,bottom:0,left:0,right:0,zIndex:9999}},Object(r.h)("div",{style:{position:"absolute",top:"50%",right:0,left:0,textAlign:"center",color:"grey",fontSize:36}},Object(r.h)("div",null,Object(r.h)(n.c,{id:"imageupload.drag-files-here"},"drop your files here :)")))),Object(r.h)("div",null,Object(r.h)("input",{class:"btn btn-info col-sm-12",multiple:!0,type:"file",id:"image-file",onchange:this.handleAddFiles,ref:t=>{this.fileInput=t}})),Object(r.h)("div",null,Object.keys(t).length>0?Object(r.h)("h3",null,Object(r.h)(n.c,{id:"imageupload.upload-images"},"Uploaded images")):"",Object(r.h)("ul",{class:"list-group"},Object.keys(t).map(e=>{const{uploadMeta:s={}}=t[e],a=e.match(/(jpg|jpeg|png|gif|heic|heif|svg|webp|tif)/i);return Object(r.h)("li",{class:"list-group-item list-group-item-action flex-column align-items-start"},Object(r.h)("div",{class:"d-flex w-100 justify-content-between"},a&&Object(r.h)("img",{class:"img-fluid mr-3",src:t[e].event.target.result,style:"max-height: 50px;"}),Object(r.h)("small",null,t[e].event.uploadDone),Object(r.h)(n.c,{id:"imageupload.uploading-image"},"Laster opp bilde..."),Object(r.h)("small",null,i.a.formatBytes(t[e].event.total,2))),Object(r.h)("div",{class:"progress mt-1",style:"height: 4px;"},Object(r.h)("div",{class:"progress-bar progress-bar-striped progress-bar-animated bg-success",role:"progressbar",style:`width: ${s.progress}%; height: 4px;`,"aria-valuenow":s.progress,"aria-valuemin":"0","aria-valuemax":"100"})))}))),this.props.children)}})||a;e.a=l}}]);
//# sourceMappingURL=route-tracks.chunk.5ced4.esm.js.map