{"version":3,"sources":["webpack:///./components/news/index.js","webpack:///./routes/news/index.js"],"names":["initialState","showAddComment","News","observer","props","likeNews","stores","newsStore","id","news","toggleAddComment","e","newsId","target","parentElement","dataset","setState","state","inputRef","focus","updateTimer","render","this","user","userStore","language","likes","comments","hasLikedNews","findIndex","class","style","images","s3SmallLink","href","active","mu","replaceImages","title","util","isoDate","createdDate","tag","ingress","length","type","onClick","data-id","c","col","offset","compact","Component","MARGIN_TOP","marginTop","MARGIN_BOTTOM","marginBottom","isLoading","NewsList","loadNews","query","isAdmin","showall","load","componentDidMount","componentWillReceiveProps","nextProps","newsList","map","n"],"mappings":"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","file":"route-news.chunk.0f3fb.js","sourcesContent":["import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\n\nimport mu from '../../lib/musher-util';\n\nimport NewsComments from '../../components/news/comments';\nimport NewsAddComment from '../../components/news/commentAdd';\n\nconst initialState = {\n\tshowAddComment: false,\n};\n\n@observer\nclass News extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n        this.updateTimer = {};\n\t\tthis.inputRef = {};\n    }\n\n\tlikeNews = async () => {\n\t\tconst { newsStore } = this.props.stores;\n        const { news } = this.props;\n\t\tconst response = await newsStore.likeNews({ id: news.id });\n\n        if (response.status === 200) {\n\t\t\t\n\t\t}\n\t}\n\n\ttoggleAddComment = (e) => {\n\t\tconst newsId = e.target.parentElement.dataset.id || e.target.dataset.id;\n\t\tconst { showAddComment } = this.state;\n\t\tthis.setState({\n\t\t\tshowAddComment: !showAddComment,\n\t\t}, () => {\n\t\t\tif (this.inputRef[newsId]) {\n\t\t\t\tthis.inputRef[newsId].focus();\n\t\t\t}\n\t\t});\n\t}\n\n    render() {\n        const { showAddComment } = this.state;\n        const { news = {} } = this.props;\n\n        const { userStore } = this.props.stores;\n        const { user } = userStore;\n        const { language = 'no' } = user;\n        const { likes = [], comments = [] } = news;\n\t\tconst hasLikedNews = news.likes && news.likes.findIndex(e => e.user === user.id) > -1;\n\n        return (\n            <>\n                <div class='w-100 mb-5'>\n                    <div class='row'>\n                        <div class='col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 d-flex mb-0 position-relative'>\n                            {/* {JSON.stringify(team, null, 4)} */}\n                            <div class={`text-center border rounded-circle imageRounded`} style={news.images && news.images[0] ? `background-image: url(\"${news.images[0].s3SmallLink}\");` : ''}>\n                                {!(news.images && news.images[0]) && <i class='fas fa-paragraph text-muted mt-3' style='font-size: 40px;' />}\n                            </div>\n                            <div class='flex-grow-1 pl-3' style='line-height: 1.2em;'>\n                                <a class='stretched-link' href={`/news/${news.id}`}>\n                                    <i class={`fas fa-eye${news.active ? ' text-success' : '-slash text-danger'} float-right`} />\n                                    <h5 class='mb-1' style='line-height: 1.0em;'>{mu.replaceImages(news.title, news.images, language)}</h5>\n                                </a>\n                                <div>\n                                    <small class='text-muted'>\n                                        {util.isoDate(news.createdDate)} - {news.tag}\n                                    </small>\n                                </div>\n                                {mu.replaceImages(news.ingress, news.images, language)}\n                            </div>\n                        </div>\n\n                        <div class='col-10 offset-2 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0'>\n                            {likes && likes.length > 0 && <small class='bg-light shadow-sm rounded-lg py-0 px-1' style='bottom: 20px; right: 15px;'>\n                                <i class='fas fa-thumbs-up text-primary' /> {likes.length}\n                            </small>}\n                            {comments && comments.length > 0 && <small class='float-right bg-light shadow-sm rounded-lg py-0 px-1' style='bottom: 20px; right: 15px;'>\n                                <i class='fas fa-comment text-primary' /> {comments.length}\n                            </small>}\n                        </div>\n\n                        <div class='col-10 offset-2 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-1 mb-2'>\n                            <div class='row'>\n                                <div class='col-6 text-center'>\n                                    <button type='button' class={`btn btn-sm btn-outline-${hasLikedNews ? 'primary' : 'secondary'} btn-lg btn-block ${hasLikedNews ? 'text-primary' : ''}`}\n                                        onClick={this.likeNews}\n                                        // disabled={hasLikedNews}\n                                    >\n                                        <i class={`${hasLikedNews ? 'text-primary fas' : 'far'} fa-thumbs-up`} /> Like\n                                    </button>\n                                </div>\n                                <div class='col-6 text-center'>\n                                    <button type='button' class='btn btn-sm btn-outline-secondary btn-lg btn-block'\n                                        data-id={news.id}\n                                        onClick={this.toggleAddComment}\n                                    >\n                                        <i class='fas fa-comment' /> Comment\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n\n                        {showAddComment && <NewsAddComment\n                            stores={this.props.stores}\n                            news={news}\n                            inputRef={c => this.inputRef[news.id] = c}\n                        />}\n                        <NewsComments stores={this.props.stores} news={news} col={10} offset={2} compact={true} />\n\n\n                    </div>\n                </div>\n            </>\n        );\n    }\n}\n\nexport default News;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport News from '../../components/news';\n\nimport mu from '../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(false);\nconst MARGIN_BOTTOM = mu.marginBottom();\n\nconst initialState = {\n\tisLoading: false,\n};\n\n@observer\nclass NewsList extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\tasync loadNews(props = this.props) {\n\t\tthis.setState({ isLoading: true });\n\t\tconst { newsStore, userStore } = props.stores;\n\t\tconst { isAdmin } = userStore;\n\t\tconst query = {\n\t\t\ttag: props.tag,\n\t\t};\n\t\tif (isAdmin) {\n\t\t\tquery.showall = 1;\n\t\t\tdelete query.tag;\n\t\t}\n\t\tawait newsStore.load({ query });\n\t\tthis.setState({ isLoading: false });\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.loadNews();\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {\n\t\tthis.loadNews(nextProps);\n\t}\n\n\trender() {\n\t\tconst { tag } = this.props;\n\t\tconst { newsStore, userStore } = this.props.stores;\n\t\tconst { newsList } = newsStore;\n\t\tconst { isAdmin } = userStore;\n\t\treturn (\n\t\t\t<div class='container-fluid' style={`margin-bottom: ${MARGIN_BOTTOM}; margin-top: ${MARGIN_TOP};`}>\n\t\t\t\t<div class='row'>\n\t\t\t\t\t<div class='col-12'>\n\t\t\t\t\t\t<div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 px-0'>\n\t\t\t\t\t\t\t<h5>{tag === 'news' ? <Text id='news.heading'>Siste nytt</Text> : <Text id='news.heading-howo'>Hvordan gjør man det?</Text>}</h5>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{isAdmin && <a class='btn btn-sm btn-success float-right ml-2'\n\t\t\t\t\t\t\thref={`/news/edit/new`}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<i class='fas fa-plus' /> <Text id='news.create'>Ny</Text>\n\t\t\t\t\t\t</a>}\n\n\t\t\t\t\t\t{newsList && newsList.map(n => <News stores={this.props.stores} news={n} />)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default NewsList;\n"],"sourceRoot":""}