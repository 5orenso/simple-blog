{"version":3,"sources":["webpack:///./routes/stories/index.js"],"names":["MARGIN_TOP","mu","marginTop","MARGIN_BOTTOM","marginBottom","initialState","isLoading","submenu","viewmenu","Home","observer","props","reloadFeeds","e","preventDefault","setState","PubSub","publish","topics","REFRESH_PAGE","message","sortby","storyStore","stores","sortBy","target","value","a","b","likes","length","comments","sortPublicFeed","state","loadAll","appState","this","userStore","getFingerprint","getInfo","getNotifications","user","currentLocationInfo","coords","getWeatherUser","lat","latitude","lon","longitude","altitude","componentDidMount","render","story","hashtag","yrWeather","currentLocationGeocode","place","formatted_address","class","style","url","data","id","onChange","href","Component"],"mappings":"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","file":"route-stories.chunk.9b3f3.js","sourcesContent":["import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport { route } from 'preact-router';\nimport linkState from 'linkstate';\n\nimport PubSub, { topics } from '../../lib/pubsub';\n\nimport mu from '../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(false);\nconst MARGIN_BOTTOM = mu.marginBottom();\n\nimport StoryAdd from '../../components/story/add';\nimport StoryPublicFeed from '../../components/story/publicFeed';\nimport StoryPublicDetail from '../../components/story/publicDetail';\nimport Ad from '../../components/ad/';\nimport YrWeather from '../../components/yrweather/';\n\nconst initialState = {\n\tisLoading: false,\n\tsubmenu: 'lastWorkouts',\n\tviewmenu: 'wall',\n};\n\n@observer\nclass Home extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\tasync loadAll() {\n\t\tconst { appState, userStore } = this.props.stores;\n\t\tthis.setState({ isLoading: true });\n        await appState.getFingerprint();\n        await userStore.getInfo();\n\t\tawait userStore.getNotifications();\n\n\t\tconst { user } = userStore;\n\t\tif (user.currentLocationInfo && user.currentLocationInfo.coords) {\n\t\t\tconst { latitude: lat, longitude: lon, altitude } = user.currentLocationInfo.coords;\n\t\t\tuserStore.getWeatherUser({ lat, lon, altitude });\n\t\t}\n\t\tthis.setState({ isLoading: false });\n    }\n\n\treloadFeeds = async (e) => {\n\t\te.preventDefault();\n\t\tthis.setState({ isLoading: true });\n        PubSub.publish(topics.REFRESH_PAGE, {\n            message: 'Refresh page.',\n        });\n\t\tthis.setState({ isLoading: false });\n\t}\n\n    sortby = (e) => {\n        const { storyStore } = this.props.stores;\n        const sortField = e.target.value;\n        let sortBy = () => {};\n        switch (sortField) {\n            case 'likes':\n                sortBy = (a, b) => a.likes.length < b.likes.length;\n                break;\n            case '-likes':\n                sortBy = (a, b) => a.likes.length > b.likes.length;\n                break;\n            case 'comments':\n                sortBy = (a, b) => a.comments.length < b.comments.length;\n                break;\n            case '-comments':\n                sortBy = (a, b) => a.comments.length > b.comments.length;\n                break;\n            default:\n                break;\n        }\n        storyStore.sortPublicFeed(sortBy);\n    }\n\n\tcomponentDidMount() {\n\t\tthis.loadAll();\n\t}\n\n\trender() {\n        const { isLoading, viewmenu } = this.state;\n        const { story, hashtag } = this.props;\n\t\tconst { userStore, appState } = this.props.stores;\n        const { darkmode } = appState;\n\n\t\tconst { user } = userStore;\n\t\tconst { yrWeather, currentLocationGeocode = {} } = user;\n\t\tconst { formatted_address: place } = currentLocationGeocode;\n\n\t\treturn (\n\t\t\t<div class='container-fluid' style={`margin-bottom: ${MARGIN_BOTTOM}; margin-top: ${MARGIN_TOP};`}>\n                <Ad stores={this.props.stores} url={this.props.url} />\n                <div class='bg-light'>\n                    <YrWeather stores={this.props.stores} data={yrWeather} place={place} />\n                </div>\n\n                <StoryAdd stores={this.props.stores} />\n\n                <div class='row bg-light'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 border-bottom'>\n                        <small class='float-right'>\n                            <select\n                                class='custom-select custom-select-sm'\n                                id='team'\n                                onChange={this.sortby}\n                            >                    \n                                <option value=''><Text id='story.sort.new'>Nyeste først</Text></option>\n                                <option value='likes'><Text id='story.sort.likes-desc'>Flest likes først</Text></option>\n                                <option value='-likes'><Text id='story.sort.likes-asc'>Færrest likes først</Text></option>\n                                <option value='comments'><Text id='story.sort.comments-desc'>Flest kommentarer først</Text></option>\n                                <option value='-comments'><Text id='story.sort.comments-asc'>Færrest kommentarer først</Text></option>\n                            </select>\n                        </small>\n\n                        <div>\n                            <h3>\n                                <a href='/stories'><i class='fas fa-home' /></a>\n                                {hashtag && <>\n                                    <span class='badge badge-primary ml-4'>#{hashtag}</span>\n                                </>}\n                            </h3>\n                        </div>\n                    </div>\n                </div>\n\n                <StoryPublicFeed stores={this.props.stores} story={story} hashtag={hashtag} />\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Home;\n"],"sourceRoot":""}