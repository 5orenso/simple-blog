(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{Dv8B:function(e,t,a){"use strict";a.r(t),function(e){function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var r,l,d,o=a("hosL"),n=a("Utv1"),h=a("/eY4"),p=a("cneo"),u=a("OhSV"),b=a("Y3FI"),f=a("go65"),O=a("RMlE"),g=a("ZOvn"),j=a("om2D"),m=a("TiXY");const v=g.a.marginTop(!0,!0),y=g.a.marginTopBack(!1),w=g.a.marginBottom(),x={isLoading:!1},I=e=>(t,a)=>e.map(e=>{let s=1;return"-"===e[0]&&(s=-1,e=e.substring(1)),t[e]>a[e]?s:t[e]<a[e]?-s:0}).reduce((e,t)=>e||t,0);let k=Object(h.a)(r=class extends o.Component{constructor(...e){var t;super(...e),t=this,this.handleImageErrored=e=>{const t=e.target;t.onerror=null,setTimeout(()=>{t.src+="?"+new Date},1e3)},this.removeImage=async function(e){const{raceStore:a}=t.props.stores,{race:s}=t.props;a.removeImage({id:s.id,name:e.target.parentElement.dataset.name||e.target.dataset.name})},this.removeMainImage=()=>{const{race:e,field:t,updateField:a}=this.props;a({id:e.id,field:t,value:{}})},this.setDateToNow=()=>{const{field:e,updateField:t,race:a}=this.props,s=n.a.isoDate(void 0,!1,!1,!0);t({id:a.id,field:e,value:s})},this.setTimeToNow=()=>{const{field:e,updateField:t,race:a}=this.props,s=n.a.isoTime();t({id:a.id,field:e,value:s,type:"time"})},this.setValue=e=>{const t=e.target.parentElement.dataset.value||e.target.dataset.value;if(t){const{field:e,updateField:a,race:s}=this.props;a({id:s.id,field:e,value:t})}},this.setRightValue=()=>{const{field:e,updateField:t,race:a,rightValueReal:s}=this.props;t({id:a.id,field:e,value:s})}}render(){const{saved:e,race:t,type:a="text",rows:s,field:i,min:c,max:r,step:l,title:d,icon:h,help:b,onInput:f,updateField:O,rightValue:g,required:v}=this.props;let y,w=Object(p.i)(t[i]),x=r;return"date"===a&&(w&&(w=n.a.isoDate(t[i],!1,!1,!0)),"today"===r&&(x=n.a.isoDate(void 0,!1,!1,!0))),"time"===a&&w&&(w=n.a.isoTime(t[i])),"duration"!==i&&"rest"!==i||(y=n.a.secToHms(w,!0)),"image"===a?Object(o.h)("div",{class:"form-group "+(e[`${i}.${t.id}`]?"is-valid":"")},Object(o.h)("label",{for:i+"Input"},h&&Object(o.h)("i",{class:h+" text-muted"})," ",d),Object(o.h)("div",{class:"container-fluid"},Object(o.h)("div",{class:"row"},t.images&&t.images.map(e=>Object(o.h)("div",{class:"col-3 p-1"},Object(o.h)("img",{src:e.s3SmallLink,class:"img-fluid",onError:this.handleImageErrored}),Object(o.h)("button",{class:"btn btn-sm btn-link",onClick:this.removeImage,"data-name":e.name},Object(o.h)("i",{class:"fas fa-trash"})," Del"))))),Object(o.h)(j.a,{saved:e,object:t,field:i,updateField:O,autoOpen:!1}),e[`${i}.${t.id}`]?Object(o.h)("div",{class:"valid-feedback",style:"display: block;"},Object(o.h)(u.c,{id:"race.changes-saved"},"Endringene er lagret")):Object(o.h)("small",{id:i+"Help",class:"form-text text-muted"},b)):"file"===a?Object(o.h)("div",{class:"form-group "+(e[`${i}.${t.id}`]?"is-valid":"")},Object(o.h)("label",{for:i+"Input"},h&&Object(o.h)("i",{class:h+" text-muted"})," ",d),Object(o.h)(m.a,{saved:e,object:t,field:i,updateField:O}),e[`${i}.${t.id}`]?Object(o.h)("div",{class:"valid-feedback",style:"display: block;"},Object(o.h)(u.c,{id:"race.changes-saved"},"Endringene er lagret")):Object(o.h)("small",{id:i+"Help",class:"form-text text-muted"},b)):"textarea"===a?Object(o.h)("div",{class:"form-group "+(e[`${i}.${t.id}`]?"is-valid":"")},Object(o.h)("label",{for:i+"Input"},h&&Object(o.h)("i",{class:h+" text-muted"})," ",d),Object(o.h)("textarea",{type:a,class:"form-control "+(e[`${i}.${t.id}`]?"is-valid":""),id:i+"Input","aria-describedby":i+"Help",value:w,rows:s,"data-id":t.id,"data-field":i,onInput:f}),e[`${i}.${t.id}`]?Object(o.h)("div",{class:"valid-feedback",style:"display: block;"},Object(o.h)(u.c,{id:"race.changes-saved"},"Endringene er lagret")):Object(o.h)("small",{id:i+"Help",class:"form-text text-muted"},b)):"toggle"===a?Object(o.h)("div",{class:"form-group "+(e[`${i}.${t.id}`]?"is-valid":"")},Object(o.h)("label",{for:i+"Input"},h&&Object(o.h)("i",{class:h+" text-muted"})," ",d),Object(o.h)("div",{class:"custom-control custom-switch"},Object(o.h)("input",{type:"checkbox",class:"custom-control-input",id:i+"Input",value:1===w?0:1,"data-id":t.id,"data-field":i,onInput:f,checked:1==w?"checked":""}),Object(o.h)("label",{class:"custom-control-label",for:i+"Input"})),e[`${i}.${t.id}`]?Object(o.h)("div",{class:"valid-feedback",style:"display: block;"},Object(o.h)(u.c,{id:"races.changes-saved"},"Endringene er lagret")):Object(o.h)("small",{id:i+"Help",class:"form-text text-muted"},b)):Object(o.h)("div",{class:"form-group "+(e[`${i}.${t.id}`]?"is-valid":"")},"date"===a&&Object(o.h)("span",{class:"float-right text-muted font-weight-lighter",onClick:this.setDateToNow},"I dag ",Object(o.h)("i",{class:"far fa-check-circle"})),"time"===a&&Object(o.h)("span",{class:"float-right text-muted font-weight-lighter",onClick:this.setTimeToNow},"NÃ¥ ",Object(o.h)("i",{class:"far fa-check-circle"})),g&&Object(o.h)("span",{class:"float-right text-muted font-weight-lighter",onClick:this.setRightValue},g),Object(o.h)("label",{for:i+"Input"},h&&Object(o.h)("i",{class:h+" text-muted"})," ",d),y&&Object(o.h)("span",{class:"float-right"},Object(o.h)("strong",{onClick:this.setValue,"data-value":void 0},y)),Object(o.h)("input",{type:a,class:`form-control ${e[`${i}.${t.id}`]?"is-valid":""} ${v?w?"border-success":"border-danger":""}`,id:i+"Input","aria-describedby":i+"Help",value:w,min:c,max:x,step:l,"data-id":t.id,"data-field":i,"data-type":a,onInput:f}),e[`${i}.${t.id}`]?Object(o.h)("div",{class:"valid-feedback",style:"display: block;"},Object(o.h)(u.c,{id:"race.changes-saved"},"Endringene er lagret")):Object(o.h)("small",{id:i+"Help",class:"form-text text-muted"},b))}})||r,F=Object(h.a)(l=class extends o.Component{constructor(...e){super(...e),this.onInput=e=>{const{field:t}=this.props,a=e.target.value,{raceStore:s}=this.props.stores;s.updateObjectKeyValue("newRace",t,a)}}render(){const{field:e,icon:t,title:a,help:s}=this.props,{raceStore:i}=this.props.stores,{newRace:c}=i;return Object(o.h)("div",{class:"form-group"},Object(o.h)("label",{for:e+"Input"},t&&Object(o.h)("i",{class:t+" text-muted"})," ",a),Object(o.h)("input",{type:"text",class:"form-control",id:e+"Input","aria-describedby":e+"Help",onInput:this.onInput,value:c[e]}),Object(o.h)("small",{id:e+"Help",class:"form-text text-muted"},s))}})||l,S=Object(h.a)(d=class extends o.Component{constructor(e){var t;super(e),t=this,this.updateField=e=>{const{id:t,field:a,type:s,elementtype:i}=e.target.dataset,c=e.target.value;this.updateFieldValue({id:parseInt(t,10),field:a,value:c,type:s,elementtype:i})},this.updateFieldValue=({id:e,field:a,value:s,datatype:i,elementtype:c,type:r,skipTimer:l=!1})=>{const{raceStore:d}=this.props.stores,{race:o}=d;let h=s,p=s;"time"===r&&(h=`${n.a.isoDate(o[a],!1,!1,!0)} ${s}`,p=h),"images"===a&&Array.isArray(o.images)&&Array.isArray(s)&&(p=[...o.images,...s]),"array"!==i||Array.isArray(s)||(h="number"===c?s.split(",").map(e=>parseFloat(e)||e):s.split(",")),d.updateField(e,a,p),l?this.doUpdateField(e,a,h):(clearTimeout(this.updateTimer[a]),this.updateTimer[a]=setTimeout((async function(){t.doUpdateField(e,a,h)}),1500))},this.insertNewRace=async function(){const{raceStore:e}=t.props.stores,{newRace:a}=e,s=await e.insert(i({},a)),{id:c}=s.data;Object(b.route)("/race/"+c)},this.addRaceClass=async function(){const{raceid:e}=t.props,{raceStore:a}=t.props.stores,{newRaceClass:s}=t.state;await a.addClass({id:e,newClass:s}),t.setState({newRaceClass:{}})},this.handleImageErrored=e=>{const t=e.target;t.onerror=null,setTimeout(()=>{t.src+="?"+new Date},1e3)},this.addRaceArticle=async function(){const{raceid:e}=t.props,{raceStore:a}=t.props.stores,{newRaceArticle:s}=t.state;await a.addArticle({id:e,newArticle:s}),t.setState({newRaceArticle:{}})},this.addRaceUserImage=async function(){const{raceid:e}=t.props,{raceStore:a}=t.props.stores,{newRaceUserImage:s}=t.state;await a.addUserImage({id:e,newUserImage:s}),t.setState({newRaceUserImage:{}})},this.updateUserImageUpload=({field:e,value:t})=>{const{newRaceUserImage:a}=this.state;a[e]=t,this.setState({newRaceUserImage:a})},this.removeRaceClass=async function(e){const a=e.target.parentElement.dataset.id||e.target.dataset.id,{raceid:s}=t.props,{raceStore:i}=t.props.stores;await i.removeClass({id:s,classId:a})},this.removeRaceArticle=async function(e){const a=e.target.parentElement.dataset.id||e.target.dataset.id,{raceid:s}=t.props,{raceStore:i}=t.props.stores;await i.removeArticle({id:s,articleId:a})},this.removeRaceUserImage=async function(e){const a=e.target.parentElement.dataset.id||e.target.dataset.id,{raceid:s}=t.props,{raceStore:i}=t.props.stores;await i.removeUserImage({id:s,userImageId:a})},this.editRaceClass=async function(e){const{id:a,field:s}=e.target.dataset,{value:i}=e.target,{raceid:c}=t.props,{raceStore:r}=t.props.stores,l={raceClassId:a,["raceClass"+n.a.ucfirst(s)]:i};clearTimeout(t.updateTimer[`${c}-${a}-${s}`]),t.updateTimer[`${c}-${a}-${s}`]=setTimeout((async function(){r.editClass({id:c,data:l})}),1500)},this.editRaceArticle=async function(e){const{id:a,field:s}=e.target.dataset,{value:i}=e.target,{raceid:c}=t.props,{raceStore:r}=t.props.stores,l={raceArticleId:a,["raceArticle"+n.a.ucfirst(s)]:i};clearTimeout(t.updateTimer[`${c}-${a}-${s}`]),t.updateTimer[`${c}-${a}-${s}`]=setTimeout((async function(){r.editArticle({id:c,data:l})}),1500)},this.editRaceUserImage=async function(e){const{id:a,field:s}=e.target.dataset,{value:i}=e.target,{raceid:c}=t.props,{raceStore:r}=t.props.stores,l={raceUserImageId:a,["raceUserImage"+n.a.ucfirst(s)]:i};clearTimeout(t.updateTimer[`${c}-${a}-${s}`]),t.updateTimer[`${c}-${a}-${s}`]=setTimeout((async function(){r.editUserImage({id:c,data:l})}),1500)},this.addCheckpoint=async function(e){const{raceStore:a}=t.props.stores,{checkpoint:s}=t.state,{race:c}=a,r=c.id,{classid:l}=e.target.dataset;await a.addCheckpoint({id:r,classId:l,newCheckpoint:i({},s)})},this.editCheckpoint=e=>{const{raceStore:t}=this.props.stores,{race:a}=t,s=a.id,i=e.target.id,c=e.target.value,{classid:r,checkpointid:l}=e.target.dataset,d={raceClassId:r,checkpointId:l,["raceClassCheckpoint"+n.a.ucfirst(i)]:c};clearTimeout(this.updateTimer[i]),this.updateTimer[i]=setTimeout((async function(){t.editClass({id:s,data:d}),t.localUpdateSignup(i,c)}),1500)},this.deleteCheckpoint=e=>{const{raceStore:t}=this.props.stores,{race:a}=t,s=a.id,i=e.target.id,c=e.target.value,{classid:r,checkpointid:l}=e.target.dataset,d={raceClassId:r,checkpointId:l,raceClassCheckpointDelete:1};clearTimeout(this.updateTimer[i]),this.updateTimer[i]=setTimeout((async function(){t.editClass({id:s,data:d}),t.localUpdateSignup(i,c)}),1500)},this.back=()=>{const{createNew:e}=this.props,{raceStore:t}=this.props.stores,{race:a}=t;e?Object(b.route)("/race/"):Object(b.route)("/race/"+a.id)},this.state=i(i({},x),{},{newRaceClass:{},newRaceArticle:{},newRaceUserImage:{},checkpoint:{}}),this.updateTimer={}}async loadRace(e=this.props){this.setState({isLoading:!0});const{raceStore:t}=this.props.stores;await t.load(e.raceid)}async doUpdateField(e,t,a){const{raceStore:s}=this.props.stores;await s.saveField(e,t,a)}componentDidMount(){this.loadRace()}render(){const{createNew:t}=this.props,{raceStore:a,userStore:s}=this.props.stores,{isAdmin:i}=s;if(!i)return"";const{race:c,saved:r}=a,l=["name","sortOrder","distanceFromPrev","estTimeToCpMinutes","estRestMinutes"];return Object(o.h)(e,null,Object(o.h)(O.a,{stores:this.props.stores}),Object(o.h)("div",{class:"container-fluid",style:`margin-bottom: ${w}; margin-top: ${v};`},Object(o.h)("button",{class:"btn btn-link float-left pl-0 fixed-top text-primary",style:`top: ${y}; left: 5px; font-size: 35px; width: 45px;`,onClick:this.back},Object(o.h)("i",{class:"fas fa-arrow-circle-left"})),t?Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col-12"},Object(o.h)("h5",null,Object(o.h)(u.c,{id:"race.add-new"},"Lag nytt innhold")),Object(o.h)(F,{stores:this.props.stores,field:"title",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.title"},"Tittel"),help:Object(o.h)(u.c,{id:"race.title-help"},"Title of this race story")}),Object(o.h)(F,{stores:this.props.stores,field:"tag",icon:"fas fa-eye",title:Object(o.h)(u.c,{id:"race.tag"},"Tag"),help:Object(o.h)(u.c,{id:"race.tag-help"},"Tag of this race story"),onInput:this.updateField}),Object(o.h)("button",{type:"button",class:"btn btn-primary mb-2",onclick:this.insertNewRace},"Save race"))):Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col-12"},Object(o.h)(k,{saved:r,race:c,field:"title",icon:"fas fa-heading",required:!0,title:Object(o.h)(u.c,{id:"race.title"},"Title"),help:Object(o.h)(u.c,{id:"race.title-help"},"Title of this race"),onInput:this.updateField}),Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"active",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.active"},"Active"),help:Object(o.h)(u.c,{id:"race.active-help"},"Is this active yet?"),onInput:this.updateField})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"nonstop",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.nonstop"},"Nonstop"),help:Object(o.h)(u.c,{id:"race.nonstop-help"},"Nonstop race."),onInput:this.updateField})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"liveRace",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.live-race"},"Live race"),help:Object(o.h)(u.c,{id:"race.live-race-help"},"Live race."),onInput:this.updateField}))),Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"signupfee",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.signupfee"},"Signup fee"),help:Object(o.h)(u.c,{id:"race.signupfee-help"},"Signup fee for this race."),onInput:this.updateField})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"signuppayment",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.signuppayment"},"Signup payment"),help:Object(o.h)(u.c,{id:"race.signuppayment-help"},"Signup payment for this race."),onInput:this.updateField}))),Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"signupStartDate",icon:"fas fa-heading",required:!0,title:Object(o.h)(u.c,{id:"race.signupStartDate"},"Signup start date"),type:"date",help:Object(o.h)(u.c,{id:"race.signupStartDate-help"},"Signup start date"),onInput:this.updateField,updateField:this.updateFieldValue})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"signupStartDate",icon:"fas fa-heading",required:!0,title:Object(o.h)(u.c,{id:"race.signupStartDate"},"Signup start time"),type:"time",help:Object(o.h)(u.c,{id:"race.signupStartDate-help"},"Signup start time"),onInput:this.updateField,updateField:this.updateFieldValue})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"signupEndDate",icon:"fas fa-heading",required:!0,title:Object(o.h)(u.c,{id:"race.signupEndDate"},"Signup end date"),type:"date",help:Object(o.h)(u.c,{id:"race.signupEndDate-help"},"Signup end date"),onInput:this.updateField,updateField:this.updateFieldValue})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"signupEndDate",icon:"fas fa-heading",required:!0,title:Object(o.h)(u.c,{id:"race.signupEndDate"},"Signup end time"),type:"time",help:Object(o.h)(u.c,{id:"race.signupEndDate-help"},"Signup end time"),onInput:this.updateField,updateField:this.updateFieldValue}))),Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"startDate",icon:"fas fa-heading",required:!0,title:Object(o.h)(u.c,{id:"race.startDate"},"Race start date"),type:"date",help:Object(o.h)(u.c,{id:"race.startDate-help"},"Race start date"),onInput:this.updateField,updateField:this.updateFieldValue})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"startDate",icon:"fas fa-heading",required:!0,title:Object(o.h)(u.c,{id:"race.startDate"},"Race start time"),type:"time",help:Object(o.h)(u.c,{id:"race.startDate-help"},"Race start time"),onInput:this.updateField,updateField:this.updateFieldValue})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"endDate",icon:"fas fa-heading",required:!0,title:Object(o.h)(u.c,{id:"race.endDate"},"Race end date"),type:"date",help:Object(o.h)(u.c,{id:"race.endDate-help"},"Race end date"),onInput:this.updateField,updateField:this.updateFieldValue})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"endDate",icon:"fas fa-heading",required:!0,title:Object(o.h)(u.c,{id:"race.endDate"},"Race end time"),type:"time",help:Object(o.h)(u.c,{id:"race.endDate-help"},"Race end time"),onInput:this.updateField,updateField:this.updateFieldValue}))),Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"tag",icon:"fas fa-heading",required:!0,title:Object(o.h)(u.c,{id:"race.tag"},"Tag"),help:Object(o.h)(u.c,{id:"race.tag-help"},"Sosial media tags of this race. Comma sep."),onInput:this.updateField})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"tagFacebookUsers",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.tag-facebook-user"},"Facebook users to tag"),help:Object(o.h)(u.c,{id:"race.tag-facebook-user-help"},"Facebook users to tag in this race. Comma sep."),onInput:this.updateField})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"tagInstagramUsers",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.tag-instagram-user"},"Intagram users to tag"),help:Object(o.h)(u.c,{id:"race.tag-instagram-user-help"},"Instagram users to tag in this race. Comma sep."),onInput:this.updateField}))),Object(o.h)(k,{saved:r,race:c,field:"raceTrackerRace",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.race-tracker-name"},"RaceTracker name"),help:Object(o.h)(u.c,{id:"race.race-tracker-name-help"},"Check database for RaceTracker name"),onInput:this.updateField}),Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"resultsText",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.resultsText"},"Results URL Text"),help:Object(o.h)(u.c,{id:"race.resultsText-help"},"Text to results URL"),onInput:this.updateField})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"resultsUrl",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.resultsUrl"},"Results URL"),help:Object(o.h)(u.c,{id:"race.resultsUrl-help"},"URL to results"),onInput:this.updateField})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"resultsHide",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.resultsHide"},"Results hide"),help:Object(o.h)(u.c,{id:"race.resultsHide-help"},"Show we hide results from the app?"),onInput:this.updateField}))),Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"countryRegexp",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.countryRegexp"},"Country regexp hide tracking"),help:Object(o.h)(u.c,{id:"race.countryRegexp-help"},"Hide tracking for matching countries"),onInput:this.updateField})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"countryRegexpMessage",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.countryRegexpMessage"},"Country regexp message"),help:Object(o.h)(u.c,{id:"race.countryRegexpMessage-help"},"Text for people without access."),onInput:this.updateField}))),Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"contestantsText",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.contestantsText"},"Contestants URL text"),help:Object(o.h)(u.c,{id:"race.contestantsText-help"},"Text to Contestants URL"),onInput:this.updateField})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"contestantsUrl",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.contestantsUrl"},"Contestants URL"),help:Object(o.h)(u.c,{id:"race.contestantsUrl-help"},"URL to Contestants"),onInput:this.updateField}))),[1,2,3,4].map(t=>Object(o.h)(e,null,Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"mediaText"+t,icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.mediaText"},"Media URL text ",t),help:Object(o.h)(u.c,{id:"race.mediaText1-help"},"Text to Media URL ",t),onInput:this.updateField})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"mediaURL"+t,icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.contestantsUrl"},"Media URL ",t),help:Object(o.h)(u.c,{id:"race.contestantsUrl-help"},"URL to Media ",t),onInput:this.updateField}))))),Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"contactEmail",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.contactEmail"},"Contact Email"),help:Object(o.h)(u.c,{id:"race.contactEmail-help"},"Contact Email of this race"),onInput:this.updateField})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"contactCellphone",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.contactCellphone"},"Contact Cellphone"),help:Object(o.h)(u.c,{id:"race.contactCellphone-help"},"Contact Cellphone of this race"),onInput:this.updateField})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"facebook",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.facebook"},"Facebook"),help:Object(o.h)(u.c,{id:"race.facebook-help"},"Facebook Event or page"),onInput:this.updateField})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"instagram",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.instagram"},"Instagram"),help:Object(o.h)(u.c,{id:"race.instagram-help"},"Instagram account or tag"),onInput:this.updateField}))),Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"locationCity",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.locationCity"},"Location City"),help:Object(o.h)(u.c,{id:"race.locationCity-help"},"Location City of this race"),onInput:this.updateField})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"locationState",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.locationState"},"Location State"),help:Object(o.h)(u.c,{id:"race.locationState-help"},"Location State of this race"),onInput:this.updateField})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"locationCountry",icon:"fas fa-heading",title:Object(o.h)(u.c,{id:"race.locationCountry"},"Location Country"),help:Object(o.h)(u.c,{id:"race.locationCountry-help"},"Location Country of this race"),onInput:this.updateField}))),Object(o.h)(k,{saved:r,race:c,field:"ingress",icon:"fas fa-quote-right",type:"textarea",title:Object(o.h)(u.c,{id:"race.ingress"},"Ingress"),help:Object(o.h)(u.c,{id:"race.ingress-help"},"Ingress of this race"),onInput:this.updateField}),Object(o.h)(k,{saved:r,race:c,field:"body",icon:"fas fa-quote-right",type:"textarea",rows:10,title:Object(o.h)(u.c,{id:"race.body"},"Body"),help:Object(o.h)(u.c,{id:"race.body-help"},"Body of this race"),onInput:this.updateField}),Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"rules",icon:"fas fa-quote-right",type:"textarea",rows:10,title:Object(o.h)(u.c,{id:"race.rules"},"Rules"),help:Object(o.h)(u.c,{id:"race.rules-help"},"Rules of this race"),onInput:this.updateField})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"declaration",icon:"fas fa-quote-right",type:"textarea",rows:10,title:Object(o.h)(u.c,{id:"race.declaration"},"Declaration"),help:Object(o.h)(u.c,{id:"race.declaration-help"},"Self declaration for the race"),onInput:this.updateField}))),Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"veterinaryInfo",icon:"fas fa-quote-right",type:"textarea",rows:10,title:Object(o.h)(u.c,{id:"race.veterinaryInfo"},"VeterinÃ¦rinfo"),help:Object(o.h)(u.c,{id:"race.veterinaryInfo-help"},"VeterinÃ¦rinfo"),onInput:this.updateField})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"checkpoints",icon:"fas fa-quote-right",type:"textarea",rows:10,title:Object(o.h)(u.c,{id:"race.checkpoints"},"Sjekkpunkter"),help:Object(o.h)(u.c,{id:"race.checkpoints-help"},"Sjekkpunkter"),onInput:this.updateField}))),Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"trailDescription",icon:"fas fa-quote-right",type:"textarea",rows:10,title:Object(o.h)(u.c,{id:"race.trailDescription"},"LÃ¸ypebeskrivelse"),help:Object(o.h)(u.c,{id:"race.trailDescription-help"},"LÃ¸ypebeskrivelse"),onInput:this.updateField})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"program",icon:"fas fa-quote-right",type:"textarea",rows:10,title:Object(o.h)(u.c,{id:"race.program"},"Program"),help:Object(o.h)(u.c,{id:"race.program-help"},"Program"),onInput:this.updateField})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"prices",icon:"fas fa-quote-right",type:"textarea",rows:10,title:Object(o.h)(u.c,{id:"race.prices"},"Prices"),help:Object(o.h)(u.c,{id:"race.prices-help"},"Prices for this race"),onInput:this.updateField}))),Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"resultDanger",icon:"fas fa-quote-right",type:"textarea",rows:10,title:Object(o.h)(u.c,{id:"race.resultDanger"},"resultDanger"),help:Object(o.h)(u.c,{id:"race.resultDanger-help"},"resultDanger for this race"),onInput:this.updateField})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"resultWarning",icon:"fas fa-quote-right",type:"textarea",rows:10,title:Object(o.h)(u.c,{id:"race.resultWarning"},"resultWarning"),help:Object(o.h)(u.c,{id:"race.resultWarning-help"},"resultWarning for this race"),onInput:this.updateField})),Object(o.h)("div",{class:"col"},Object(o.h)(k,{saved:r,race:c,field:"resultSuccess",icon:"fas fa-quote-right",type:"textarea",rows:10,title:Object(o.h)(u.c,{id:"race.resultSuccess"},"resultSuccess"),help:Object(o.h)(u.c,{id:"race.resultSuccess-help"},"resultSuccess for this race"),onInput:this.updateField}))),Object(o.h)(k,{saved:r,race:c,field:"image",type:"image",icon:"fas fa-camera",stores:this.props.stores,title:Object(o.h)(u.c,{id:"race.photo"},"Bilder"),help:Object(o.h)(u.c,{id:"race.photo-help"},"Images for this race."),onInput:this.updateField,updateField:this.updateFieldValue}),Object(o.h)("div",{class:"row"},c.classes&&c.classes.map(t=>Object(o.h)(e,null,Object(o.h)("div",{class:"col-12 border rounded-lg m-2 p-3"},Object(o.h)("button",{class:"btn btn-danger float-right","data-id":t.id,onClick:this.removeRaceClass},Object(o.h)("i",{class:"fas fa-times"})),Object(o.h)("h5",null,t.title),Object(o.h)("div",{class:"row"},["title","distance","minDistance","signupfee","track","raceTrackerResults","dogs"].map(a=>Object(o.h)(e,null,Object(o.h)("div",{class:"col form-group"},Object(o.h)("label",{for:a},a),Object(o.h)("input",{type:"text",class:"form-control",id:a,"aria-describedby":a+"Help","data-id":t.id,"data-field":a,value:t[a],onInput:this.editRaceClass}))))),Object(o.h)("div",{class:"row"},["startDate","endDate"].map(a=>Object(o.h)(e,null,Object(o.h)("div",{class:"col form-group"},Object(o.h)("label",{for:a},a),Object(o.h)("input",{type:"datetime-local",class:"form-control",id:a,"aria-describedby":a+"Help","data-id":t.id,"data-field":a,value:n.a.isoDate(t[a]),onInput:this.editRaceClass}))))),Object(o.h)("div",{class:"row"},["ingress","body","rules"].map(a=>Object(o.h)(e,null,Object(o.h)("div",{class:"col form-group"},Object(o.h)("label",{for:a},a),Object(o.h)("textarea",{type:"textarea",class:"form-control",id:a,"aria-describedby":a+"Help","data-id":t.id,"data-field":a,value:t[a],onInput:this.editRaceClass}))))),["waypoints"].map(a=>Object(o.h)(e,null,Object(o.h)("div",{class:"form-group"},Object(o.h)("label",{for:a},a),Object(o.h)("textarea",{type:"textarea",class:"form-control",id:a,"aria-describedby":a+"Help","data-id":t.id,"data-field":a,value:JSON.stringify(t[a],null,4),onInput:this.editRaceClass})))),Object(o.h)("div",{class:"overflow-auto"},Object(o.h)("div",{class:"d-flex flex-nowrap"},t.checkpoints&&t.checkpoints.slice().sort(I(["sortOrder"])).map(a=>Object(o.h)(e,null,Object(o.h)("div",{class:"border rounded-lg m-2 p-3 bg-light"},Object(o.h)("h5",null,a.name),["name","sortOrder","distanceFromStart","distanceFromPrev","estSpeed","requiredRestMinutes","timeEqualization","isStartLine","isFinishLine","estTimeToCpMinutes","estRestMinutes","hideResults","email","cellphone","facebook","instagram","image","topImage"].map(s=>Object(o.h)(e,null,Object(o.h)("div",{class:"form-group"},Object(o.h)("label",{for:s},l.indexOf(s)>-1&&Object(o.h)(e,null,"*")," ",s),Object(o.h)("input",{type:"text",class:"form-control "+(l.indexOf(s)>-1?a[s]?"border-success":"border-danger":""),id:s,"aria-describedby":s+"Help","data-classid":t.id,"data-checkpointid":a.id,"data-field":s,value:a[s],onInput:this.editCheckpoint,placeholder:"estSpeed"===s?12.5:""}),Object(o.h)("small",{id:s+"Help",class:"form-text text-muted"},"estTimeToCpMinutes"===s&&Object(o.h)(e,null,1e3*a.distanceFromPrev/((a.estSpeed||12.5)/3.6)/60,Object(o.h)("span",{class:"text-muted px-2"},"-"),n.a.secToHms(1e3*a.distanceFromPrev/((a.estSpeed||12.5)/3.6),!0),Object(o.h)("span",{class:"text-muted px-2"},"-"),a.estSpeed||12.5," km/t"),["requiredRestMinutes","estRestMinutes"].indexOf(s)>-1&&Object(o.h)(e,null,n.a.secToHms(60*a[s],!0)))))),["description"].map(s=>Object(o.h)(e,null,Object(o.h)("div",{class:"form-group"},Object(o.h)("label",{for:s},s),Object(o.h)("textarea",{type:"text",class:"form-control",id:s,"aria-describedby":s+"Help","data-classid":t.id,"data-checkpointid":a.id,"data-field":s,value:a[s],onInput:this.editCheckpoint})))),["position","polygon"].map(s=>Object(o.h)(e,null,Object(o.h)("div",{class:"form-group"},Object(o.h)("label",{for:s},s),Object(o.h)("textarea",{type:"textarea",class:"form-control",id:s,"aria-describedby":s+"Help","data-classid":t.id,"data-checkpointid":a.id,"data-field":s,value:JSON.stringify(a[s],null,4),onInput:this.editCheckpoint})))),Object(o.h)("button",{class:"btn btn-link",onClick:this.deleteCheckpoint,"data-classid":t.id,"data-checkpointid":a.id},"Delete")))))),t.checkpoints?Object(o.h)(e,null,Object(o.h)("div",{class:"overflow-auto"},Object(o.h)("div",{class:"d-flex flex-nowrap"},Object(o.h)("div",{class:"form-group"},Object(o.h)("label",null,"Waypoint data for class (copy & paste to field above)"),Object(o.h)("textarea",{type:"textarea",class:"form-control",value:JSON.stringify(t.checkpoints.slice().sort(I(["sortOrder"])).filter(e=>e.position&&e.position[0]).map(e=>({id:e.id,title:e.name,lat:e.position[0],lng:e.position[1]}),null,4))}))))):Object(o.h)(e,null),Object(o.h)("div",{class:"d-flex flex-nowrap"},Object(o.h)("div",{class:"border rounded-lg m-2 p-3 bg-light"},Object(o.h)("h5",null,"Add new checkpoint"),["name","distanceFromStart","requiredRestMinutes","email","cellphone"].map(t=>Object(o.h)(e,null,Object(o.h)("div",{class:"form-group"},Object(o.h)("label",{for:t},t),Object(o.h)("input",{type:"text",class:"form-control",id:t,"aria-describedby":t+"Help",onInput:Object(f.a)(this,"checkpoint."+t)})))),["position","polygon"].map(t=>Object(o.h)(e,null,Object(o.h)("div",{class:"form-group"},Object(o.h)("label",{for:t},t),Object(o.h)("textarea",{type:"text",class:"form-control",id:t,"aria-describedby":t+"Help",onInput:Object(f.a)(this,"checkpoint."+t)})))),Object(o.h)("button",{class:"btn btn-info","data-classid":t.id,onClick:this.addCheckpoint},"Add checkpoint"))))))),Object(o.h)("div",{class:"row"},Object(o.h)("div",{class:"col border rounded-lg m-2 p-3 bg-light"},Object(o.h)("h5",null,"Add new class"),["title","distance","minDistance","signupfee"].map(t=>Object(o.h)(e,null,Object(o.h)("div",{class:"form-group"},Object(o.h)("label",{for:t},t),Object(o.h)("input",{type:"text",class:"form-control",id:t,"aria-describedby":t+"Help",onInput:Object(f.a)(this,"newRaceClass."+t)})))),["ingress","body","rules"].map(t=>Object(o.h)(e,null,Object(o.h)("div",{class:"form-group"},Object(o.h)("label",{for:t},t),Object(o.h)("textarea",{type:"text",class:"form-control",id:t,"aria-describedby":t+"Help",onInput:Object(f.a)(this,"newRaceClass."+t)})))),Object(o.h)("button",{class:"btn btn-info",onClick:this.addRaceClass},"Add race class")))))))}})||d;t.default=S}.call(this,a("hosL").Fragment)},LMwI:function(e){e.exports={pointerCursor:"pointerCursor__1W6mM"}},RMlE:function(e,t,a){"use strict";function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var c,r=a("hosL"),l=a("ox/y"),d=(a("Utv1"),a("/eY4")),o=(a("go65"),a("Y3FI")),n=a("OhSV");a("LMwI");const h={menu:{profile:!1,main:!1},searchText:""};let p=Object(d.a)(c=class extends r.Component{constructor(e){var t;super(e),t=this,this.toggleDropdown=e=>{const{menu:t}=this.state;let a=e.target.dataset.name;!a&&e.target.parentNode&&(a=e.target.parentNode.dataset.name),a&&(t[a]=!t[a]),this.setState({menu:t})},this.toggleDarkmode=e=>{const{appState:t}=this.props.stores;t.toggleDarkmode(),this.toggleDropdown(e)},this.toggleViewmode=e=>{const{appState:t}=this.props.stores;let a=e.target.dataset.mode;!a&&e.target.parentNode&&(a=e.target.parentNode.dataset.mode),t.toggleViewmode(a),this.toggleDropdown(e)},this.reloadApp=()=>{window.location.reload(!0)},this.adminLoadAll=async function(){const{userStore:e}=t.props.stores;await e.getInfo(!0)},this.changeLanguage=e=>{const t=e.target.value;console.log("changeLanguage",t);const{appState:a,userStore:s}=this.props.stores,{user:i={}}=s;i.email&&s.setLanguage({email:i.email,language:t}),a.setLanguage(t)},this.search=()=>{const{searchText:e}=this.state;Object(o.route)("/search/"+e)},this.state=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},h)}render(){const{menu:e}=this.state,{appState:t,userStore:a}=this.props.stores,{darkmode:s}=t,{user:i,notifications:c=[]}=a,{language:d="en"}=(c.filter(e=>!e.read),i);return Object(r.h)("nav",{class:"navbar navbar-expand-lg navbar-themed fixed-top py-1",style:"z-index: 99999;"},Object(r.h)("a",{class:"navbar-brand",href:"/race/"},Object(r.h)("img",{src:`./assets/homerun-race-logo-2-${s?"white-":""}small.png`,height:"37",class:"position-absolute",style:"top: 5px; left: 6px"}),Object(r.h)("span",{class:"font-weight-normal",style:"margin-left: 30px; font-size: 20px;"},"Homerun Race")),Object(r.h)("button",{class:"navbar-toggler",type:"button","data-name":"main",onClick:this.toggleDropdown},Object(r.h)("span",{class:"navbar-toggler-icon"})),Object(r.h)("div",{class:"collapse navbar-collapse "+(e.main?"show":""),id:"navbarSupportedContent"},Object(r.h)("ul",{class:"navbar-nav mr-auto ml-5"},Object(r.h)("li",{class:"nav-item"},Object(r.h)(l.Link,{className:"nav-link",activeClassName:"active",href:"/race","data-name":"main",style:"font-size: 1.0em !important;",onClick:this.toggleDropdown},Object(r.h)("i",{class:"fas fa-flag-checkered"})," ",Object(r.h)(n.c,{id:"header.races"},"LÃ¸pene"))),Object(r.h)("li",{class:"nav-item"},Object(r.h)(l.Link,{className:"nav-link",activeClassName:"active",href:"/race/support","data-name":"main",style:"font-size: 1.0em !important;",onClick:this.toggleDropdown},Object(r.h)("i",{class:"far fa-question-circle"})," ",Object(r.h)(n.c,{id:"header.support"},"Support"))),Object(r.h)("li",{class:"nav-item"},Object(r.h)(l.Link,{className:"nav-link",activeClassName:"active",href:"/race/news","data-name":"main",style:"font-size: 1.0em !important;",onClick:this.toggleDropdown},Object(r.h)("i",{class:"fas fa-quote-right"})," ",Object(r.h)(n.c,{id:"header.news"},"Nyheter")))),Object(r.h)("ul",{class:"navbar-nav ml-auto "},Object(r.h)("li",{class:"nav-item mr-2"},Object(r.h)("div",{class:"form-row align-items-center"},Object(r.h)("div",{class:"col-auto my-1",style:"width: 80px;"},Object(r.h)("select",{class:"custom-select",style:"background-color: inherit; border: none; padding: 0; height: 1.1em; font-size: 0.9em;",onInput:this.changeLanguage},Object(r.h)("option",{value:"no",selected:"no"===d},"ðŸ‡³ðŸ‡´ NO"),Object(r.h)("option",{value:"en",selected:"en"===d},"ðŸ‡¬ðŸ‡§ EN"),Object(r.h)("option",{value:"es",selected:"es"===d},"ðŸ‡ªðŸ‡¸ ES"),Object(r.h)("option",{value:"de",selected:"de"===d},"ðŸ‡©ðŸ‡ª DE"),Object(r.h)("option",{value:"fr",selected:"fr"===d},"ðŸ‡«ðŸ‡· FR"),Object(r.h)("option",{value:"ru",selected:"ru"===d},"ðŸ‡·ðŸ‡º RU"),Object(r.h)("option",{value:"se",selected:"se"===d},"ðŸ‡¸ðŸ‡ª SE"))))),Object(r.h)("li",{class:"nav-item d-block d-lg-none"},Object(r.h)(l.Link,{className:"nav-link",activeClassName:"active","data-name":"main",onClick:this.toggleDarkmode},Object(r.h)("i",{class:(s?"fas text-warning":"far")+" fa-moon"})," ",Object(r.h)(n.c,{id:"header.darkmode"},"Nattmodus"))),Object(r.h)("li",{class:"nav-item mr-2 d-none d-lg-block"},Object(r.h)("button",{class:"btn btn-link","data-name":"profile",onClick:this.toggleDarkmode},Object(r.h)("i",{class:(s?"fas text-warning":"far")+" fa-moon"}))))))}})||c;t.a=p},TiXY:function(e,t,a){"use strict";var s,i=a("hosL"),c=a("/eY4"),r=(a("cneo"),a("Utv1"),a("OhSV")),l=a("u2zT");let d=Object(c.a)(s=class extends i.Component{constructor(e){super(e),this.handleAddImage=e=>{const{updateField:t,object:a,field:s}=this.props;t({id:a.id,field:s,value:e})},this.state={files:[]}}render(){const{uploadStatus:e=(()=>{}),before:t=(()=>{}),after:a=(()=>{}),autoOpen:s=!1}=this.props;return Object(i.h)("div",{class:"row"},Object(i.h)("div",{class:"col-12"},Object(i.h)(r.c,{id:"form.files.upload-file"},"Last opp fil"),":",Object(i.h)("br",null),Object(i.h)(l.a,{handleAddImage:this.handleAddImage,apiUrl:"/api/fileupload",uploadStatus:e,before:t,after:a,autoOpen:s},Object(i.h)("div",{style:{height:30,width:"100%"}}))))}})||s;t.a=d},om2D:function(e,t,a){"use strict";var s,i=a("hosL"),c=a("/eY4"),r=(a("cneo"),a("Utv1"),a("u2zT"));let l=Object(c.a)(s=class extends i.Component{constructor(e){super(e),this.handleAddImage=e=>{const{addToImages:t=!0}=this.props,{updateField:a,object:s,field:i}=this.props;if(i&&a({id:s.id,field:i,value:e,skipTimer:!0}),t){const t=[];t.push(e),a({id:s.id,field:"images",value:t,skipTimer:!0})}},this.state={files:[]}}render(){const{uploadStatus:e=(()=>{}),before:t=(()=>{}),after:a=(()=>{}),autoOpen:s=!0}=this.props;return Object(i.h)("div",{class:"row"},Object(i.h)("div",{class:"col-12"},Object(i.h)(r.a,{handleAddImage:this.handleAddImage,uploadStatus:e,apiUrl:"/api/fileupload",before:t,after:a,autoOpen:s},Object(i.h)("div",{style:{height:30,width:"100%"}}))))}})||s;t.a=l},u2zT:function(e,t,a){"use strict";var s,i=a("hosL"),c=a("/eY4"),r=a("Utv1"),l=a("OhSV");let d=Object(c.a)(s=class extends i.Component{constructor(e){super(e),this.dropRef=Object(i.createRef)(),this.handleDrag=e=>{e.preventDefault(),e.stopPropagation()},this.handleDragIn=e=>{e.preventDefault(),e.stopPropagation(),this.dragCounter++,e.dataTransfer.items&&e.dataTransfer.items.length>0&&this.setState({drag:!0})},this.handleDragOut=e=>{e.preventDefault(),e.stopPropagation(),this.dragCounter--,0===this.dragCounter&&this.setState({drag:!1})},this.handleDrop=e=>{if(e.preventDefault(),e.stopPropagation(),this.setState({drag:!1}),e.dataTransfer.files&&e.dataTransfer.files.length>0){for(let t=0,a=e.dataTransfer.files.length;t<a;t+=1){this.readLocalFile(e.dataTransfer.files[t])}this.dragCounter=0}},this.handleAddFiles=e=>{e.preventDefault();const t=e.target;for(let e=0,a=t.files.length;e<a;e+=1){this.readLocalFile(t.files[e])}},this.handleEvent=()=>{0},this.handleUpload=e=>{const{uploadStatus:t=(()=>{}),before:a=(()=>{}),after:s=(()=>{})}=this.props;t(!1),r.a.isFunction(a)&&a();const i=new FormData;i.append("files[]",e);const c={progress:1};c.xhr=new XMLHttpRequest,c.xhr.upload.addEventListener("progress",t=>{this.updateProgress(t,e)}),c.xhr.addEventListener("loadstart",t=>{this.handleEvent(t,e)}),c.xhr.addEventListener("load",t=>{this.handleEvent(t,e)}),c.xhr.addEventListener("loadend",t=>{const a=e;r.a.isFunction(s)&&s(),this.handleEvent(t,a)}),c.xhr.addEventListener("progress",t=>{this.handleEvent(t,e)}),c.xhr.addEventListener("error",t=>{this.handleEvent(t,e)}),c.xhr.addEventListener("abort",t=>{this.handleEvent(t,e)}),c.xhr.addEventListener("readystatechange",t=>{this.uploadDone(t,e)}),c.xhr.open("POST",`${r.a.getApiServer()}${this.props.apiUrl}`),c.xhr.setRequestHeader("Authorization","Bearer "+r.a.getJwtToken()),c.xhr.send(i);const l=e.name,d=this.state.uploadedFilesData;d[l]||(d[l]={}),d[l].uploadMeta=c,d[l].imageNum=this.state.imageNum,this.setState({uploadedFilesData:d})},this.readLocalFile=e=>new Promise((t,a)=>{const s=new FileReader;s.addEventListener("error",e=>{a(e)}),s.addEventListener("load",a=>{const s=e,i=s.name,c=this.state.uploadedFilesData;c[i]||(c[i]={}),c[i].event=a,this.setState({uploadedFilesData:c}),this.handleUpload(s),t(a)}),s.readAsDataURL(e)}),this.updateProgress=(e,t)=>{if(e.lengthComputable){const a=t.name,s=this.state.uploadedFilesData,i=e.loaded/e.total*100;0,s[a].uploadMeta.progress=i,this.setState({uploadedFilesData:s})}},this.uploadDone=(e,t)=>{const a=t.name,s=this.state.uploadedFilesData,i=s[a].uploadMeta;if(i&&4===i.xhr.readyState&&201===i.xhr.status){const e=JSON.parse(i.xhr.responseText).data.files;for(let t=0;t<e.length;t+=1){this.addFileToUpload(e[t]),this.fileInput.value=""}}},this.state={drag:!1,loadingProgress:0,uploadedFiles:[],uploadedFilesData:{}}}addFileToUpload(e){const{uploadedFilesData:t}=this.state,{handleAddImage:a,uploadStatus:s=(()=>{})}=this.props;delete t[e.name],this.setState({uploadedFilesData:t}),a(e),s(!0)}componentDidMount(){const e=this.dropRef.current;e.addEventListener("dragenter",this.handleDragIn),e.addEventListener("dragleave",this.handleDragOut),e.addEventListener("dragover",this.handleDrag),e.addEventListener("drop",this.handleDrop);const{autoOpen:t}=this.props;t&&setTimeout(()=>{this.fileInput.click()},10)}componentWillUnmount(){const e=this.dropRef.current;e.removeEventListener("dragenter",this.handleDragIn),e.removeEventListener("dragleave",this.handleDragOut),e.removeEventListener("dragover",this.handleDrag),e.removeEventListener("drop",this.handleDrop)}render(){const{uploadedFilesData:e}=this.state;return Object(i.h)("div",{style:{position:"relative"},ref:this.dropRef},this.state.drag&&Object(i.h)("div",{style:{border:"dashed grey 4px",backgroundColor:"rgba(255,255,255,.8)",position:"absolute",top:0,bottom:0,left:0,right:0,zIndex:9999}},Object(i.h)("div",{style:{position:"absolute",top:"50%",right:0,left:0,textAlign:"center",color:"grey",fontSize:36}},Object(i.h)("div",null,Object(i.h)(l.c,{id:"imageupload.drag-files-here"},"drop your files here :)")))),Object(i.h)("div",null,Object(i.h)("input",{class:"btn btn-info col-sm-12",multiple:!0,type:"file",id:"image-file",onchange:this.handleAddFiles,ref:e=>{this.fileInput=e}})),Object(i.h)("div",null,Object.keys(e).length>0?Object(i.h)("h3",null,Object(i.h)(l.c,{id:"imageupload.upload-images"},"Uploaded images")):"",Object(i.h)("ul",{class:"list-group"},Object.keys(e).map(t=>{const{uploadMeta:a={}}=e[t],s=t.match(/(jpg|jpeg|png|gif|heic|heif|svg|webp|tif)/i);return Object(i.h)("li",{class:"list-group-item list-group-item-action flex-column align-items-start"},Object(i.h)("div",{class:"d-flex w-100 justify-content-between"},s&&Object(i.h)("img",{class:"img-fluid mr-3",src:e[t].event.target.result,style:"max-height: 50px;"}),Object(i.h)("small",null,e[t].event.uploadDone),Object(i.h)(l.c,{id:"imageupload.uploading-image"},"Laster opp bilde..."),Object(i.h)("small",null,r.a.formatBytes(e[t].event.total,2))),Object(i.h)("div",{class:"progress mt-1",style:"height: 4px;"},Object(i.h)("div",{class:"progress-bar progress-bar-striped progress-bar-animated bg-success",role:"progressbar",style:`width: ${a.progress}%; height: 4px;`,"aria-valuenow":a.progress,"aria-valuemin":"0","aria-valuemax":"100"})))}))),this.props.children)}})||s;t.a=d}}]);
//# sourceMappingURL=34.chunk.5a174.esm.js.map