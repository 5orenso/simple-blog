(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{LOkn:function(e,t,s){"use strict";function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function a(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}s.r(t);var o,d,c,l=s("hosL"),r=s("Utv1"),p=s("/eY4"),h=(s("cneo"),s("OhSV")),b=s("Y3FI"),u=(s("go65"),s("ZOvn")),O=s("om2D"),f=s("TiXY");const j=u.a.marginTop(!1),m=u.a.marginTopBack(!1),w=u.a.marginBottom(),g={isLoading:!1};let v=Object(p.a)(o=class extends l.Component{constructor(...e){var t;super(...e),t=this,this.handleImageErrored=e=>{const t=e.target;t.onerror=null,setTimeout(()=>{t.src+="?"+new Date},1e3)},this.removeImage=async function(e){const{newsStore:s}=t.props.stores,{news:i}=t.props;s.removeImage({id:i.id,name:e.target.parentElement.dataset.name||e.target.dataset.name})},this.removeMainImage=()=>{const{news:e,field:t,updateField:s}=this.props;s({id:e.id,field:t,value:{}})}}render(){const{saved:e,news:t,type:s="text",rows:i,field:a,title:n,icon:o,help:d,onInput:c,updateField:p,max:b,min:u,step:j}=this.props;let m=t[a],w=b;return"date"===s&&(m&&(m=r.a.isoDate(t[a],!1,!1,!0)),"today"===b&&(w=r.a.isoDate(void 0,!1,!1,!0))),"image"===s?Object(l.h)("div",{class:"form-group "+(e[`${a}.${t.id}`]?"is-valid":"")},Object(l.h)("label",{for:a+"Input"},o&&Object(l.h)("i",{class:o+" text-muted"})," ",n),Object(l.h)("div",{class:"container-fluid"},Object(l.h)("div",{class:"row"},t.images&&t.images.map(e=>Object(l.h)("div",{class:"col-3 p-1"},Object(l.h)("img",{src:e.s3SmallLink,class:"img-fluid",onError:this.handleImageErrored}),Object(l.h)("button",{class:"btn btn-sm btn-link",onClick:this.removeImage,"data-name":e.name},Object(l.h)("i",{class:"fas fa-trash"})," Del"))))),Object(l.h)(O.a,{saved:e,object:t,field:a,updateField:p,autoOpen:!1}),e[`${a}.${t.id}`]?Object(l.h)("div",{class:"valid-feedback",style:"display: block;"},Object(l.h)(h.c,{id:"news.changes-saved"},"Endringene er lagret")):Object(l.h)("small",{id:a+"Help",class:"form-text text-muted"},d)):"file"===s?Object(l.h)("div",{class:"form-group "+(e[`${a}.${t.id}`]?"is-valid":"")},Object(l.h)("label",{for:a+"Input"},o&&Object(l.h)("i",{class:o+" text-muted"})," ",n),Object(l.h)(f.a,{saved:e,object:t,field:a,updateField:p}),e[`${a}.${t.id}`]?Object(l.h)("div",{class:"valid-feedback",style:"display: block;"},Object(l.h)(h.c,{id:"news.changes-saved"},"Endringene er lagret")):Object(l.h)("small",{id:a+"Help",class:"form-text text-muted"},d)):"textarea"===s?Object(l.h)("div",{class:"form-group "+(e[`${a}.${t.id}`]?"is-valid":"")},Object(l.h)("label",{for:a+"Input"},o&&Object(l.h)("i",{class:o+" text-muted"})," ",n),Object(l.h)("textarea",{type:s,class:"form-control "+(e[`${a}.${t.id}`]?"is-valid":""),id:a+"Input","aria-describedby":a+"Help",value:m,rows:i,"data-id":t.id,"data-field":a,onInput:c}),e[`${a}.${t.id}`]?Object(l.h)("div",{class:"valid-feedback",style:"display: block;"},Object(l.h)(h.c,{id:"news.changes-saved"},"Endringene er lagret")):Object(l.h)("small",{id:a+"Help",class:"form-text text-muted"},d)):Object(l.h)("div",{class:"form-group "+(e[`${a}.${t.id}`]?"is-valid":"")},Object(l.h)("label",{for:a+"Input"},o&&Object(l.h)("i",{class:o+" text-muted"})," ",n),Object(l.h)("input",{type:s,class:"form-control "+(e[`${a}.${t.id}`]?"is-valid":""),id:a+"Input","aria-describedby":a+"Help",value:m,min:u,max:w,step:j,"data-id":t.id,"data-field":a,onInput:c}),e[`${a}.${t.id}`]?Object(l.h)("div",{class:"valid-feedback",style:"display: block;"},Object(l.h)(h.c,{id:"news.changes-saved"},"Endringene er lagret")):Object(l.h)("small",{id:a+"Help",class:"form-text text-muted"},d))}})||o,y=Object(p.a)(d=class extends l.Component{constructor(...e){super(...e),this.onInput=e=>{const{field:t}=this.props,s=e.target.value,{newsStore:i}=this.props.stores;i.updateObjectKeyValue("newNews",t,s)}}render(){const{field:e,icon:t,title:s,help:i}=this.props,{newsStore:a}=this.props.stores,{newNews:n}=a;return Object(l.h)("div",{class:"form-group"},Object(l.h)("label",{for:e+"Input"},t&&Object(l.h)("i",{class:t+" text-muted"})," ",s),Object(l.h)("input",{type:"text",class:"form-control",id:e+"Input","aria-describedby":e+"Help",onInput:this.onInput,value:n[e]}),Object(l.h)("small",{id:e+"Help",class:"form-text text-muted"},i))}})||d,I=Object(p.a)(c=class extends l.Component{constructor(e){var t;super(e),t=this,this.updateField=e=>{const{id:t,field:s,type:i,elementtype:a}=e.target.dataset,{value:n,type:o,min:d,max:c}=e.target;"date"===o&&d&&c?n>=d&&n<=c&&this.updateFieldValue({id:parseInt(t,10),field:s,value:n,type:i,elementtype:a}):this.updateFieldValue({id:parseInt(t,10),field:s,value:n,type:i,elementtype:a})},this.updateFieldValue=({id:e,field:s,value:i,datatype:a,elementtype:n,skipTimer:o=!1})=>{const{newsStore:d}=this.props.stores;let c=i,l=i;const{news:r}=d;"images"===s&&Array.isArray(r.images)&&Array.isArray(i)&&(l=[...r.images,...i]),"array"!==a||Array.isArray(i)||(c="number"===n?i.split(",").map(e=>parseFloat(e)||e):i.split(",")),d.updateField(e,s,l),o?this.doUpdateField(e,s,c):(clearTimeout(this.updateTimer[s]),this.updateTimer[s]=setTimeout((async function(){t.doUpdateField(e,s,c)}),500))},this.insertNewNews=async function(){const{newsStore:e}=t.props.stores,{newNews:s}=e,i=await e.insert(a({},s));console.log({result:i});const{data:n}=i;n&&n.id&&Object(b.route)("/news/edit/"+n.id)},this.back=()=>{const{createNew:e}=this.props,{newsStore:t}=this.props.stores,{news:s}=t;e?Object(b.route)("/news/"):Object(b.route)("/news/"+s.id)},this.state=a({},g),this.updateTimer={}}async loadNews(e=this.props){this.setState({isLoading:!0});const{newsStore:t}=this.props.stores;await t.load(e.id)}async doUpdateField(e,t,s){const{newsStore:i}=this.props.stores;await i.saveField(e,t,s)}componentDidMount(){this.loadNews()}render(){const{createNew:e}=this.props,{newsStore:t,userStore:s}=this.props.stores,{isAdmin:i}=s;if(!i)return"";const{news:a,saved:n}=t;return Object(l.h)("div",{class:"container-fluid",style:`margin-bottom: ${w}; margin-top: ${j};`},Object(l.h)("div",{class:"d-flex justify-content-between mb-2"},Object(l.h)("div",null,Object(l.h)("button",{class:"btn btn-link pl-0 fixed-top text-primary",style:`top: ${m}; left: 5px; font-size: 35px; width: 45px;`,onClick:this.back},Object(l.h)("i",{class:"fas fa-arrow-circle-left"}))),Object(l.h)("div",null,Object(l.h)("h5",{class:"text-muted"},"News and howto content")),Object(l.h)("div",null,"Â ")),e?Object(l.h)("div",{class:"row"},Object(l.h)("div",{class:"col-12"},Object(l.h)("h5",null,Object(l.h)(h.c,{id:"news.add-new"},"Lag nytt innhold")),Object(l.h)(y,{stores:this.props.stores,field:"title",icon:"fas fa-heading",title:Object(l.h)(h.c,{id:"news.title"},"Tittel"),help:Object(l.h)(h.c,{id:"news.title-help"},"Title of this news story")}),Object(l.h)(y,{stores:this.props.stores,field:"tag",icon:"fas fa-eye",title:Object(l.h)(h.c,{id:"news.tag"},"Tag"),help:Object(l.h)(h.c,{id:"news.tag-help"},"Tag of this news story"),onInput:this.updateField}),Object(l.h)("button",{type:"button",class:"btn btn-primary mb-2",onclick:this.insertNewNews},"Save news"))):Object(l.h)("div",{class:"row"},Object(l.h)("div",{class:"col-12"},Object(l.h)(v,{saved:n,news:a,field:"title",icon:"fas fa-heading",title:Object(l.h)(h.c,{id:"news.title"},"Title"),help:Object(l.h)(h.c,{id:"news.title-help"},"Title of this news story"),onInput:this.updateField}),Object(l.h)(v,{stores:this.props.stores,saved:n,news:a,field:"date",icon:"fas fa-calendar",type:"date",min:"2010-01-01",max:"today",title:Object(l.h)(h.c,{id:"news.date"},"Dato"),help:Object(l.h)(h.c,{id:"news.date-help"},"Date for this news article. Format is: 'YYYY-MM-DD'."),onInput:this.updateField,updateField:this.updateFieldValue}),Object(l.h)(v,{saved:n,news:a,field:"active",icon:"fas fa-heading",title:Object(l.h)(h.c,{id:"news.active"},"Active"),help:Object(l.h)(h.c,{id:"news.active-help"},"Is this active yet?"),onInput:this.updateField}),Object(l.h)(v,{saved:n,news:a,field:"sort",icon:"fas fa-sort-amount-down",title:Object(l.h)(h.c,{id:"news.sort"},"Sort order"),help:Object(l.h)(h.c,{id:"news.sort-help"},"Highest number on top."),onInput:this.updateField}),Object(l.h)(v,{saved:n,news:a,field:"tag",icon:"fas fa-heading",title:Object(l.h)(h.c,{id:"news.tag"},"Tag"),help:Object(l.h)(h.c,{id:"news.tag-help"},"Tag of this news story"),onInput:this.updateField}),Object(l.h)(v,{saved:n,news:a,field:"ingress",icon:"fas fa-quote-right",type:"textarea",title:Object(l.h)(h.c,{id:"news.ingress"},"Ingress"),help:Object(l.h)(h.c,{id:"news.ingress-help"},"Ingress of this news story"),onInput:this.updateField}),Object(l.h)(v,{saved:n,news:a,field:"body",icon:"fas fa-quote-right",type:"textarea",rows:20,title:Object(l.h)(h.c,{id:"news.body"},"Body"),help:Object(l.h)(h.c,{id:"news.body-help"},"Body of this news story"),onInput:this.updateField}),Object(l.h)(v,{saved:n,news:a,field:"image",type:"image",icon:"fas fa-camera",stores:this.props.stores,title:Object(l.h)(h.c,{id:"news.photo"},"Bilder"),help:Object(l.h)(h.c,{id:"news.photo-help"},"Images for this news story."),onInput:this.updateField,updateField:this.updateFieldValue}))))}})||c;t.default=I},TiXY:function(e,t,s){"use strict";var i,a=s("hosL"),n=s("/eY4"),o=(s("cneo"),s("Utv1"),s("OhSV")),d=s("u2zT");let c=Object(n.a)(i=class extends a.Component{constructor(e){super(e),this.handleAddImage=e=>{const{updateField:t,object:s,field:i}=this.props;t({id:s.id,field:i,value:e})},this.state={files:[]}}render(){const{uploadStatus:e=(()=>{}),before:t=(()=>{}),after:s=(()=>{}),autoOpen:i=!1}=this.props;return Object(a.h)("div",{class:"row"},Object(a.h)("div",{class:"col-12"},Object(a.h)(o.c,{id:"form.files.upload-file"},"Last opp fil"),":",Object(a.h)("br",null),Object(a.h)(d.a,{handleAddImage:this.handleAddImage,apiUrl:"/api/fileupload",uploadStatus:e,before:t,after:s,autoOpen:i},Object(a.h)("div",{style:{height:30,width:"100%"}}))))}})||i;t.a=c}}]);
//# sourceMappingURL=44.chunk.98f7a.esm.js.map