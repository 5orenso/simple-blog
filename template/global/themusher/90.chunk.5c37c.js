(window.webpackJsonp=window.webpackJsonp||[]).push([[90],{"/DnB":function(e,t,r){"use strict";function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c,n=r("hosL"),s=(r("Utv1"),r("/eY4")),o={},l=Object(s.a)(c=function(e){function t(t){var r;return(r=e.call(this,t)||this).state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},o),r.container=null,r}var r,c;c=e,(r=t).prototype=Object.create(c.prototype),r.prototype.constructor=r,r.__proto__=c;var s=t.prototype;return s.componentDidMount=function(){var e=this.props,t=e.horizontal,r=e.vertical,a=void 0===r?"":r,i={behavior:"smooth"};t&&(i.inline=t),a&&(i.block=a),this.container.scrollIntoView(i)},s.render=function(){var e=this;return Object(n.h)("div",{ref:function(t){return e.container=t}}," ")},t}(n.Component))||c;t.a=l},QQvA:function(e,t,r){"use strict";r.r(t),function(e){function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var s,o,l,d=r("hosL"),p=r("Utv1"),u=r("/eY4"),h=(r("go65"),r("Y3FI")),b=r("cneo"),f=r("OhSV"),O=r("ZOvn"),m=r("om2D"),j=r("TiXY"),v=r("HqZR"),k=(r("/DnB"),O.a.marginTop(!1)),g=O.a.marginTopBack(!1),y=O.a.marginBottom(),w={newTrack:{}},I=Object(u.a)(s=function(t){function r(){for(var e,r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))||this).handleImageErrored=function(e){var t=e.target;t.onerror=null,setTimeout((function(){t.src+="?"+new Date}),1e3)},e.setDateToNow=function(){var t=e.props,r=t.field,a=t.updateField,i=t.track,c=p.a.isoDate(void 0,!1,!1,!0);a({id:i.id,field:r,value:c})},e.setTimeToNow=function(){var t=e.props,r=t.field,a=t.updateField,i=t.track,c=p.a.isoTime();a({id:i.id,field:r,value:c})},e.removeImage=function(t){return new Promise((function(r){return e.props.stores.trackStore.removeImage({id:e.props.track.id,name:t.target.parentElement.dataset.name||t.target.dataset.name}),r()}))},e.removeMainImage=function(){var t=e.props;(0,t.updateField)({id:t.track.id,field:t.field,value:{}})},e}return n(r,t),r.prototype.render=function(){var t=this,r=this.props,a=r.saved,i=r.track,c=r.type,n=void 0===c?"text":c,s=r.field,o=r.values,l=void 0===o?[]:o,u=r.title,h=r.icon,O=r.help,v=r.onInput,k=r.updateField,g=Object(b.i)(i[s]);return"date"===n&&g&&(g=p.a.isoDate(i[s],!1,!1,!0)),"image"===n?Object(d.h)("div",{class:"form-group "+(a[s+"."+i.id]?"is-valid":"")},Object(d.h)("label",{for:s+"Input"},h&&Object(d.h)("i",{class:h+" text-muted"})," ",u),Object(d.h)("div",{class:"container-fluid"},Object(d.h)("div",{class:"row"},i.image&&i.image.s3SmallLink&&Object(d.h)("div",{class:"col-3 p-1"},Object(d.h)("img",{src:i.image.s3SmallLink,class:"img-fluid border rounded-lg",onError:this.handleImageErrored}),Object(d.h)("button",{class:"btn btn-sm btn-link",onClick:this.removeMainImage,"data-name":i.image.name},Object(d.h)("i",{class:"fas fa-trash"})," Del"),Object(d.h)("span",{class:"badge badge-success"},"Main")),i.images&&i.images.map((function(e){return Object(d.h)("div",{class:"col-3 p-1"},Object(d.h)("img",{src:e.s3SmallLink,class:"img-fluid",onError:t.handleImageErrored}),Object(d.h)("button",{class:"btn btn-sm btn-link",onClick:t.removeImage,"data-name":e.name},Object(d.h)("i",{class:"fas fa-trash"})," Del"))})))),Object(d.h)(m.a,{saved:a,object:i,field:s,updateField:k,autoOpen:!1}),a[s+"."+i.id]?Object(d.h)("div",{class:"valid-feedback",style:"display: block;"},Object(d.h)(f.c,{id:"tracks.changes-saved"},"Endringene er lagret")):Object(d.h)("small",{id:s+"Help",class:"form-text text-muted"},O)):"file"===n?Object(d.h)("div",{class:"form-group "+(a[s+"."+i.id]?"is-valid":"")},Object(d.h)("label",{for:s+"Input"},h&&Object(d.h)("i",{class:h+" text-muted"})," ",u),Object(d.h)(j.a,{saved:a,object:i,field:s,updateField:k}),a[s+"."+i.id]?Object(d.h)("div",{class:"valid-feedback",style:"display: block;"},Object(d.h)(f.c,{id:"tracks.changes-saved"},"Endringene er lagret")):Object(d.h)("small",{id:s+"Help",class:"form-text text-muted"},O)):"radio"===n?Object(d.h)("div",{class:"form-group "+(a[s+"."+i.id]?"is-valid":"")},Object(d.h)("label",{for:s+"Input"},h&&Object(d.h)("i",{class:h+" text-muted"})," ",u,' "',g,'"'),l.map((function(t){return Object(d.h)(e,null,Object(d.h)("div",{class:"form-check"},Object(d.h)("input",{class:"form-check-input "+(a[s+"."+i.id]?"is-valid":""),type:"radio",id:s+"Input",value:t[0],"data-id":i.id,"data-field":s,onInput:v,checked:g==t[0]?"checked":""}),Object(d.h)("label",{class:"form-check-label",for:s+"Input"},t[1])))})),a[s+"."+i.id]?Object(d.h)("div",{class:"valid-feedback",style:"display: block;"},Object(d.h)(f.c,{id:"tracks.changes-saved"},"Endringene er lagret")):Object(d.h)("small",{id:s+"Help",class:"form-text text-muted"},O)):"toggle"===n?Object(d.h)("div",{class:"form-group "+(a[s+"."+i.id]?"is-valid":"")},Object(d.h)("label",{for:s+"Input"},h&&Object(d.h)("i",{class:h+" text-muted"})," ",u),Object(d.h)("div",{class:"custom-control custom-switch"},Object(d.h)("input",{type:"checkbox",class:"custom-control-input",id:s+"Input",value:1===g?0:1,"data-id":i.id,"data-field":s,onInput:v,checked:1==g?"checked":""}),Object(d.h)("label",{class:"custom-control-label",for:s+"Input"})),a[s+"."+i.id]?Object(d.h)("div",{class:"valid-feedback",style:"display: block;"},Object(d.h)(f.c,{id:"tracks.changes-saved"},"Endringene er lagret")):Object(d.h)("small",{id:s+"Help",class:"form-text text-muted"},O)):Object(d.h)("div",{class:"form-group "+(a[s+"."+i.id]?"is-valid":"")},Object(d.h)("label",{for:s+"Input"},h&&Object(d.h)("i",{class:h+" text-muted"})," ",u),Object(d.h)("input",{type:n,class:"form-control "+(a[s+"."+i.id]?"is-valid":""),id:s+"Input","aria-describedby":s+"Help",value:g,"data-id":i.id,"data-field":s,onInput:v}),a[s+"."+i.id]?Object(d.h)("div",{class:"valid-feedback",style:"display: block;"},Object(d.h)(f.c,{id:"tracks.changes-saved"},"Endringene er lagret")):Object(d.h)("small",{id:s+"Help",class:"form-text text-muted"},O))},r}(d.Component))||s,x=Object(u.a)(o=function(e){function t(){for(var t,r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))||this).onInput=function(e){t.props.stores.trackStore.updateObjectKeyValue("newTrack",t.props.field,e.target.value)},t}return n(t,e),t.prototype.render=function(){var e=this.props,t=e.field,r=e.icon,a=e.title,i=e.help,c=this.props.stores.trackStore.newTrack;return Object(d.h)("div",{class:"form-group"},Object(d.h)("label",{for:t+"Input"},r&&Object(d.h)("i",{class:r+" text-muted"})," ",a),Object(d.h)("input",{type:"text",class:"form-control",id:t+"Input","aria-describedby":t+"Help",onInput:this.onInput,value:c[t]}),Object(d.h)("small",{id:t+"Help",class:"form-text text-muted"},i))},t}(d.Component))||o,F=Object(u.a)(l=function(e){function t(t){var r;return(r=e.call(this,t)||this).insertTrack=function(){return new Promise((function(e,t){var a,c,n;return c=(a=r.props.stores).trackStore,n=a.userStore,Promise.resolve(c.insert(i({},c.newTrack))).then((function(){try{return Promise.resolve(n.getInfo()).then((function(){try{return r.resetTrack(),Object(h.route)("/tracks/"),e()}catch(e){return t(e)}}),t)}catch(e){return t(e)}}),t)}))},r.updateField=function(e){var t=e.target.dataset,a=t.field,i=t.type,c=t.elementtype,n=t.isNew,s=e.target.value;r.updateFieldValue({id:parseInt(t.id,10),field:a,value:s,type:i,elementtype:c,isNew:n})},r.updateFieldValue=function(e){var t=e.id,a=e.field,i=e.value,c=e.datatype,n=e.elementtype,s=e.isNew,o=void 0!==s&&s,l=e.skipTimer,d=void 0!==l&&l,p=r.props.stores.trackStore,u=i,h=i,b=p.track;"images"===a&&Array.isArray(b.images)&&Array.isArray(i)&&(h=[].concat(b.images,i)),"array"!==c||Array.isArray(i)||(u="number"===n?i.split(",").map((function(e){return parseFloat(e)||e})):i.split(",")),o?p.updateObjectKeyValue("newTrack",a,i):(p.updateField(t,a,h),d?r.doUpdateField(t,a,u):(clearTimeout(r.updateTimer[a]),r.updateTimer[a]=setTimeout((function(){return new Promise((function(e){return r.doUpdateField(t,a,u),e()}))}),500)))},r.back=function(){r.props.stores.history.goBack()},r.state=i({},w),r.updateTimer={},r}n(t,e);var r=t.prototype;return r.loadTrack=function(){return new Promise(function(e){var t=this.props.stores.trackStore;return"new"===this.props.track?this.setState({createNew:!0}):t.load(this.props.track),e()}.bind(this))},r.resetTrack=function(){this.props.stores.trackStore.updateKeyValue("newTrack",{})},r.doUpdateField=function(e,t,r){return new Promise(function(a,i){return Promise.resolve(this.props.stores.trackStore.saveField(e,t,r)).then((function(){try{return a()}catch(e){return i(e)}}),i)}.bind(this))},r.componentDidMount=function(){this.loadTrack()},r.render=function(){var e=this.state.createNew,t=this.props.stores.trackStore,r=t.insertStatus,a=t.saved,i=t.track,c=i.name,n=i.gpx,s=i.gpxInfo;return Object(d.h)("div",{class:"container-fluid",style:"margin-bottom: "+y+"; margin-top: "+k+";"},Object(d.h)("button",{class:"btn btn-link pl-0 fixed-top text-primary",style:"top: "+g+"; left: 5px; font-size: 35px; width: 45px;",onClick:this.back},Object(d.h)("i",{class:"fas fa-arrow-circle-left"})),Object(d.h)("div",{class:"row"},Object(d.h)("div",{class:"offset-0 col-12 offset-sm-2 col-sm-8 offset-lg-4 col-lg-4",style:"padding-left: 35px;"},e?Object(d.h)("div",null,Object(d.h)("h5",null,Object(d.h)(f.c,{id:"tracks.add-new"},"Legg til ny treningsrunde")),Object(d.h)(x,{stores:this.props.stores,field:"name",icon:"fas fa-heading",title:Object(d.h)(f.c,{id:"tracks.title"},"Tittel"),help:Object(d.h)(f.c,{id:"tracks.title-help"},"Tittel på denne runden. Eks: 'Rundt Veslevann og tilbake'")}),Object(d.h)(x,{stores:this.props.stores,field:"distanceKm",icon:"fas fa-road",title:Object(d.h)(f.c,{id:"tracks.distance"},"Distanse i km"),help:Object(d.h)(f.c,{id:"tracks.distance-help"},"Hvor lang er runden i km.")}),Object(d.h)(x,{stores:this.props.stores,field:"elevation",icon:"fas fa-mountain",title:Object(d.h)(f.c,{id:"tracks.elevation"},"Høydemeter"),help:Object(d.h)(f.c,{id:"tracks.elevation-help"},"Høydemeter du klatrer på denne runden.")}),Object(d.h)("button",{type:"button",class:"btn btn-primary",onClick:this.insertTrack},Object(d.h)(f.c,{id:"tracks.save"},"Registrer ny treningsrunde")),Object(d.h)("p",{class:"mt-4"},Object(d.h)(f.c,{id:"tracks.gpx-info"},"For å legge til GPX må du lagre og gå tilbake og endre denne."))):Object(d.h)("div",null,Object(d.h)("h5",null,Object(d.h)(f.c,{id:"tracks.edit"},"Endre"),": ",c),Object(d.h)(I,{saved:a,track:i,field:"public",icon:"fas fa-users",type:"toggle",title:Object(d.h)(f.c,{id:"tracks.public"},"Offentlig"),help:Object(d.h)(f.c,{id:"tracks.public-help"},"Er denne runden synlig for alle som bruker appen?"),onInput:this.updateField}),Object(d.h)(I,{saved:a,track:i,field:"name",icon:"fas fa-heading",title:Object(d.h)(f.c,{id:"tracks.title"},"Tittel"),help:Object(d.h)(f.c,{id:"tracks.title-help"},"Tittel på denne runden. Eks: 'Rundt Veslevann og tilbake'"),onInput:this.updateField}),Object(d.h)("div",{class:"row"},Object(d.h)("div",{class:"col"},Object(d.h)(I,{stores:this.props.stores,saved:a,track:i,field:"date",icon:"fas fa-calendar",type:"date",min:"2010-01-01",max:"today",title:Object(d.h)(f.c,{id:"tracks.date"},"Dato"),help:Object(d.h)(f.c,{id:"tracks.date-help"},"Dato for turen. Format på dato er: 'YYYY-MM-DD'."),onInput:this.updateField,updateField:this.updateFieldValue})),Object(d.h)("div",{class:"col"},Object(d.h)(I,{stores:this.props.stores,saved:a,track:i,field:"time",icon:"fas fa-clock",type:"time",title:Object(d.h)(f.c,{id:"tracks.time"},"Klokka"),help:Object(d.h)(f.c,{id:"tracks.time-help"},"Klokkeslett for turen. Format: 'HH:MI'."),onInput:this.updateField,updateField:this.updateFieldValue}))),Object(d.h)(I,{saved:a,track:i,field:"distanceKm",icon:"fas fa-road",title:Object(d.h)(f.c,{id:"tracks.distance"},"Distanse i km"),help:Object(d.h)(f.c,{id:"tracks.distance-help"},"Hvor lang er runden i km."),onInput:this.updateField}),Object(d.h)(I,{saved:a,track:i,field:"elevation",icon:"fas fa-mountain",title:Object(d.h)(f.c,{id:"tracks.elevation"},"Høydemeter"),help:Object(d.h)(f.c,{id:"tracks.elevation-help"},"Høydemeter du klatrer på denne runden."),onInput:this.updateField}),Object(d.h)(I,{saved:a,track:i,field:"image",icon:"fas fa-camera",type:"image",stores:this.props.stores,title:Object(d.h)(f.c,{id:"tracks.photos"},"Bilder"),help:Object(d.h)(f.c,{id:"tracks.photos-help"},"Bilder fra denne runden."),onInput:this.updateField,updateField:this.updateFieldValue}),n&&Object(d.h)("div",{style:"height: 500px;"},Object(d.h)(v.a,{stores:this.props.stores,mapId:i.id,geojson:n.geoJSON,gpxInfo:n.gpxInfo||s})),Object(d.h)(I,{saved:a,track:i,field:"gpx",type:"file",title:Object(d.h)(f.c,{id:"tracks.gpx"},"Gpx"),help:Object(d.h)(f.c,{id:"tracks.gpx-help"},"Gpx til denne runden."),onInput:this.updateField,updateField:this.updateFieldValue}))),r&&Object(d.h)("div",{class:"alert alert-success mt-4 col-12",role:"alert"},Object(d.h)(f.c,{id:"tracks.saved"},"Runden er lagret."))))},t}(d.Component))||l;t.default=F}.call(this,r("hosL").Fragment)},TiXY:function(e,t,r){"use strict";var a,i=r("hosL"),c=r("/eY4"),n=(r("cneo"),r("Utv1"),r("OhSV")),s=r("u2zT"),o=Object(c.a)(a=function(e){function t(t){var r;return(r=e.call(this,t)||this).handleAddImage=function(e){var t=r.props;(0,t.updateField)({id:t.object.id,field:t.field,value:e})},r.state={files:[]},r}var r,a;return a=e,(r=t).prototype=Object.create(a.prototype),r.prototype.constructor=r,r.__proto__=a,t.prototype.render=function(){var e=this.props,t=e.uploadStatus,r=void 0===t?function(){}:t,a=e.before,c=void 0===a?function(){}:a,o=e.after,l=void 0===o?function(){}:o,d=e.autoOpen,p=void 0!==d&&d;return Object(i.h)("div",{class:"row"},Object(i.h)("div",{class:"col-12"},Object(i.h)(n.c,{id:"form.files.upload-file"},"Last opp fil"),":",Object(i.h)("br",null),Object(i.h)(s.a,{handleAddImage:this.handleAddImage,apiUrl:"/api/fileupload",uploadStatus:r,before:c,after:l,autoOpen:p},Object(i.h)("div",{style:{height:30,width:"100%"}}))))},t}(i.Component))||a;t.a=o}}]);
//# sourceMappingURL=90.chunk.5c37c.js.map