(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{"/DnB":function(t,e,s){"use strict";function o(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,o)}return s}function c(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var a,n=s("hosL"),r=(s("Utv1"),s("/eY4")),l={},i=Object(r.a)(a=function(t){function e(e){var s;return(s=t.call(this,e)||this).state=function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?o(Object(s),!0).forEach((function(e){c(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},l),s.container=null,s}var s,a;a=t,(s=e).prototype=Object.create(a.prototype),s.prototype.constructor=s,s.__proto__=a;var r=e.prototype;return r.componentDidMount=function(){var t=this.props,e=t.horizontal,s=t.vertical,o=void 0===s?"":s,c={behavior:"smooth"};e&&(c.inline=e),o&&(c.block=o),this.container.scrollIntoView(c)},r.render=function(){var t=this;return Object(n.h)("div",{ref:function(e){return t.container=e}},"Â ")},e}(n.Component))||a;e.a=i},pJjI:function(t,e,s){"use strict";(function(t){var o,c=s("hosL"),a=s("Utv1"),n=s("/eY4"),r=s("OhSV"),l=(s("/DnB"),Object(n.a)(o=function(e){function s(){for(var t,s=arguments.length,o=new Array(s),c=0;c<s;c++)o[c]=arguments[c];return(t=e.call.apply(e,[this].concat(o))||this).toggleTeam=function(e){var s=t.props,o=s.callback,c=s.unsetTeamIfSelected,n=t.props.stores,r=n.dogStore,l=n.workoutStore;(void 0===c||c)&&e===r.currentTeam?(r.setCurrentTeam(void 0),l.setCurrentTeam(void 0)):(r.setCurrentTeam(e),l.setCurrentTeam(e)),a.a.isDefined(o)&&o()},t.showAllTeams=function(){var e=t.props.callback,s=t.props.stores,o=s.workoutStore;s.dogStore.setCurrentTeam(void 0),o.setCurrentTeam(void 0),a.a.isDefined(e)&&e()},t}var o,n;return n=e,(o=s).prototype=Object.create(n.prototype),o.prototype.constructor=o,o.__proto__=n,s.prototype.render=function(){var e=this,s=this.props.stores,o=s.userStore.teams,a=s.dogStore.currentTeam,n=this.props,l=n.highlight,i=n.showAll,h=void 0===i||i;return Object(c.h)("div",{class:"row mt-2"},Object(c.h)("div",{class:"w-100 overflow-hidden"},Object(c.h)("div",{class:"d-flex flex-row flex-nowrap pb-2 px-1 no-scrollbar",style:"overflow: auto; scroll-snap-type: x mandatory;"},o&&o.map((function(s,n){var r;return 1===o.length?r="rounded-pill-both":0===n?r="rounded-pill-left":n+1===o.length&&(r="rounded-pill-right"),Object(c.h)("div",{class:"col mb-0 px-0 clearfix",key:s.id},Object(c.h)("button",{class:"btn btn-sm btn-block \n\t\t\t\t\t\t\t\t\t\t\trounded-none "+r+"\n\t\t\t\t\t\t\t\t\t\t\t"+(a===s.id?"btn-success":"btn-outline-success")+"\n\t\t\t\t\t\t\t\t\t\t\ttext-nowrap clearfix",style:"text-overflow: ellipsis; overflow: hidden;",onClick:function(){return e.toggleTeam(s.id)}},Object(c.h)("i",{class:"fas fa-users"})," ",s.name,l&&l.indexOf(s.id)>-1&&Object(c.h)(t,null,a===s.id?Object(c.h)(t,null,Object(c.h)("i",{class:"fas fa-check float-right"})):Object(c.h)(t,null,Object(c.h)("div",{class:"spinner-grow text-warning float-right",role:"status"},Object(c.h)("span",{class:"sr-only"},"Loading...")),Object(c.h)("i",{class:"far fa-hand-point-left float-right",style:"font-size: 2.0em;"})))))}))),h&&Object(c.h)("div",{class:"row"},Object(c.h)("div",{class:"col-12 mb-1 px-1 d-flex justify-content-center"},Object(c.h)("button",{class:"btn btn-sm rounded-lg btn-link text-nowrap clearfix",style:"text-overflow: ellipsis; overflow: hidden;",onClick:this.showAllTeams},Object(c.h)("i",{class:"fas fa-users"})," ",Object(c.h)(r.c,{id:"teams.show-all"},"Show all"))))))},s}(c.Component))||o);e.a=l}).call(this,s("hosL").Fragment)},qZTL:function(t,e,s){"use strict";s.r(e),function(t){var o,c=s("hosL"),a=s("Utv1"),n=s("/eY4"),r=s("Y3FI"),l=(s("go65"),s("OhSV")),i=s("fh8t"),h=s.n(i),u=s("ZOvn"),p=s("67HY"),d=s("gbHB"),f=s("B+py"),b=s("pJjI"),g=s("s4FZ"),m=Object(n.a)(o=function(e){function s(t){var s;return(s=e.call(this,t)||this).loadApplication=function(){s.props.stores.applicationStore.load(s.state.id)},s.loadTeam=function(){return new Promise((function(t,e){var o;return s.setState({isLoading:!0}),o=s.props.stores,Promise.resolve(o.teamStore.load(o.workoutStore.currentTeam)).then((function(){try{return s.setState({isLoading:!1}),t()}catch(t){return e(t)}}),e)}))},s.changeLanguage=function(t){s.props.stores.appState.setLanguage(t.target.value)},s.grantAccess=function(){return new Promise((function(t,e){function o(){return s.setState({accessGranted:1}),t()}var c,a,n,r,l,i,h,u,p;return n=(c=s.props.stores).teamStore,r=c.workoutStore.currentTeam,l=(a=c.userStore).user,h=(i=s.state).returnUrl,u=i.id,p={grantedDate:new Date,returnUrl:h,team:r,appId:u},a.findApplicationById(u)?o.call(this):Promise.resolve(a.saveField(l.id,"applications",p)).then(function(){try{return Promise.resolve(a.saveField(l.id,"settings.veterinaryAllowed",1)).then(function(){try{return Promise.resolve(n.saveField(r,"public",1)).then(function(){try{return o.call(this)}catch(t){return e(t)}}.bind(this),e)}catch(t){return e(t)}}.bind(this),e)}catch(t){return e(t)}}.bind(this),e)}))},s.denyAccess=function(){Object(r.route)("/")},s.saveInputParams=function(){var t=s.props,e=t.returnUrl,o=t.id;e?(a.a.set("returnUrl",e),a.a.set("id",o)):(e=a.a.get("returnUrl"),o=a.a.get("id")),s.setState({returnUrl:e,id:o})},s.state={returnUrl:"",id:0},s}var o,n;n=e,(o=s).prototype=Object.create(n.prototype),o.prototype.constructor=o,o.__proto__=n;var i=s.prototype;return i.componentWillMount=function(){this.saveInputParams()},i.componentDidMount=function(){this.loadApplication(),this.loadTeam()},i.render=function(){var e=this.props.stores,s=e.appState,o=this.props.subsection,a=this.state,n=a.returnUrl,r=a.accessGranted,i=e.workoutStore.currentTeam,m=e.userStore.user,O=s.language,j=void 0===O?"en":O,v=s.darkmode,y=e.applicationStore.application,w=e.teamStore.team;if(!y)return Object(c.h)("div",{class:"container-fluid"},Object(c.h)("div",{class:"row"},Object(c.h)("div",{class:"col-10 offset-1 col-sm-8 offset-sm-2 col-md-6 offset-md-3 col-lg-4 offset-lg-4 pt-5"},Object(c.h)("div",{class:"d-flex justify-content-center"},v?Object(c.h)(t,null,Object(c.h)("img",{src:"https://themusher.app/assets/logo-qpaws-dark.png",height:"100"})):Object(c.h)(t,null,Object(c.h)("img",{src:"https://themusher.app/assets/logo-qpaws-light.png",height:"100"}))),Object(c.h)("div",{class:"d-flex justify-content-center"},Object(c.h)("h5",{class:"mt-1 mb-3 font-weight-lighter"},Object(c.h)(l.c,{id:"grant-access.title"},"Grant access"))),Object(c.h)("div",{class:"alert alert-danger",role:"alert"},Object(c.h)("h5",null,"Error"),"Application not found!"))));var x=y.title,k=y.body,S=y.images;return Object(c.h)("div",{class:"container-fluid"},Object(c.h)("div",{class:"row"},Object(c.h)("div",{class:"col-10 offset-1 col-sm-8 offset-sm-2 col-md-6 offset-md-3 col-lg-4 offset-lg-4 pt-5"},Object(c.h)("div",{class:"d-flex justify-content-center"},v?Object(c.h)(t,null,Object(c.h)("img",{src:"https://themusher.app/assets/logo-qpaws-dark.png",height:"100"})):Object(c.h)(t,null,Object(c.h)("img",{src:"https://themusher.app/assets/logo-qpaws-light.png",height:"100"}))),Object(c.h)("div",{class:"d-flex justify-content-center"},Object(c.h)("h5",{class:"mt-1 mb-3 font-weight-lighter"},Object(c.h)(l.c,{id:"grant-access.title"},"Grant access"))),Object(c.h)(g.a,{stores:this.props.stores,images:S,minHeight:"50px"}),Object(c.h)("h5",{class:"mt-3"},x),Object(c.h)("p",{class:"mt-3"},Object(c.h)(h.a,{markdown:u.a.replaceImages(k,S,j),markdownOpts:u.a.getMarkdownOptions()})))),Object(c.h)("div",{class:"row"},m.email?Object(c.h)(t,null,r?Object(c.h)(t,null,Object(c.h)("div",{class:"col-10 offset-1 col-sm-8 offset-sm-2 col-md-6 offset-md-3 col-lg-4 offset-lg-4 mt-3 border-top pt-3"},Object(c.h)("div",{class:"display-1 text-success text-center"},Object(c.h)("i",{class:"fas fa-check"})),Object(c.h)("p",null,Object(c.h)(l.c,{id:"grant-access.access-granted"},"Access granted. Now please click the button below to go back to")," ",x,"."),Object(c.h)("a",{class:"btn btn-success btn-block",href:n+"?userId="+m.uuidv4+"&teamId="+w.uuidv4,native:!0},Object(c.h)(l.c,{id:"grant-access.back-to-application"},"Back to"),": ",x," ",Object(c.h)("i",{class:"fas fa-arrow-right"})))):Object(c.h)(t,null,Object(c.h)("div",{class:"col-10 offset-1 col-sm-8 offset-sm-2 col-md-6 offset-md-3 col-lg-4 offset-lg-4 mt-3 border-top pt-3"},Object(c.h)("h5",{class:"font-weight-light"},Object(c.h)(l.c,{id:"grant-access.data-shared"},"Data beeing shared"),":"),Object(c.h)("p",null,Object(c.h)("i",{class:"fas fa-user"}),": ",Object(c.h)(l.c,{id:"grant-access.fields-shared-person"},"Image, Name, email, cellphone, address")),Object(c.h)("p",null,Object(c.h)("i",{class:"fas fa-dog"}),": ",Object(c.h)(l.c,{id:"grant-access.fields-shared-dog"},"Image, Name, chipId, gender, birth, vaccines")),Object(c.h)("p",null,Object(c.h)("i",{class:"fas fa-users"}),": ",Object(c.h)(l.c,{id:"grant-access.fields-shared-team"},"Name, description, images"))),Object(c.h)("div",{class:"col-10 offset-1 col-sm-8 offset-sm-2 col-md-6 offset-md-3 col-lg-4 offset-lg-4 mt-3 border-top pt-3"},Object(c.h)("h5",{class:"font-weight-light"},Object(c.h)(l.c,{id:"grant-access.choose-team"},"Choose team")),Object(c.h)("div",{class:"col-12"},Object(c.h)(b.a,{stores:this.props.stores,callback:this.loadTeam,key:"teams-"+i,showAll:!1}))),i?Object(c.h)(t,null,Object(c.h)("div",{class:"col-10 offset-1 col-sm-8 offset-sm-2 col-md-6 offset-md-3 col-lg-4 offset-lg-4 mt-3"},Object(c.h)("button",{class:"btn btn-primary btn-block",onClick:this.grantAccess},Object(c.h)("i",{class:"fas fa-check"})," ",Object(c.h)(l.c,{id:"grant-access.grant"},"Grant access")),Object(c.h)("button",{class:"mt-4 btn btn-sm btn-link text-muted float-right",onClick:this.denyAccess},Object(c.h)(l.c,{id:"grant-access.deny"},"Deny access")))):Object(c.h)(t,null,Object(c.h)("div",{class:"col-10 offset-1 col-sm-8 offset-sm-2 col-md-6 offset-md-3 col-lg-4 offset-lg-4 mt-3"},Object(c.h)("span",{class:"display-4"},Object(c.h)("i",{class:"fas fa-hand-point-up"})," Choose team"))))):Object(c.h)(t,null,!o&&Object(c.h)(p.a,{stores:this.props.stores,showLogo:!1,routeLoginOk:"/grant-access",routeLoginNew:"/grant-access/newUser",routeLoginForgot:"/grant-access/forgotPassword"}),"newUser"===o&&Object(c.h)(d.default,{stores:this.props.stores,showLogo:!1,routeLogin:"/grant-access",routeLoginForgot:"/grant-access/forgotPassword",skipPubSub:!0}),"forgotPassword"===o&&Object(c.h)(f.default,{stores:this.props.stores,showLogo:!1,routeLogin:"/grant-access",routeLoginNew:"/grant-access/newUser"}))),Object(c.h)("div",{class:"col-10 offset-1 col-sm-8 offset-sm-2 col-md-6 offset-md-3 col-lg-4 offset-lg-4"},Object(c.h)("div",{class:"form-row align-items-center"},Object(c.h)("div",{class:"col-auto my-1 mx-auto",style:"width: 80px;"},Object(c.h)("select",{class:"custom-select",style:"background-color: inherit; border: none;",onInput:this.changeLanguage},Object(c.h)("option",{value:"no",selected:"no"===j},"ðŸ‡³ðŸ‡´ NO"),Object(c.h)("option",{value:"en",selected:"en"===j},"ðŸ‡¬ðŸ‡§ EN"),Object(c.h)("option",{value:"es",selected:"es"===j},"ðŸ‡ªðŸ‡¸ ES"),Object(c.h)("option",{value:"de",selected:"de"===j},"ðŸ‡©ðŸ‡ª DE"),Object(c.h)("option",{value:"fr",selected:"fr"===j},"ðŸ‡«ðŸ‡· FR"),Object(c.h)("option",{value:"ru",selected:"ru"===j},"ðŸ‡·ðŸ‡º RU"),Object(c.h)("option",{value:"se",selected:"se"===j},"ðŸ‡¸ðŸ‡ª SE"))))))},s}(c.Component))||o;e.default=m}.call(this,s("hosL").Fragment)},s4FZ:function(t,e,s){"use strict";(function(t){function o(t){return n.a.isObject(t)&&t.s3LargeLink}var c,a=s("hosL"),n=s("Utv1"),r=s("/eY4"),l=(s("OhSV"),Object(r.a)(c=function(e){function s(t){var s;return(s=e.call(this,t)||this).scrollImages=function(t){var e=s.props,o=e.callback,c=void 0===o?function(){}:o,a=t.target,n=a.scrollLeft/a.clientWidth,r=Math.round(n),l=Math.abs(r-n);(Number.isInteger(n)||l<.1)&&(s.setState({imageIdx:r}),c(r))},s.onClickScrollLeft=function(){var t=s.imageScrollerRef;t.scrollBy({top:0,left:0-t.clientWidth,behavior:"smooth"})},s.onClickScrollRight=function(){var t=s.imageScrollerRef;t.scrollBy({top:0,left:t.clientWidth,behavior:"smooth"})},s.distance=function(t){return Math.hypot(t.touches[0].pageX-t.touches[1].pageX,t.touches[0].pageY-t.touches[1].pageY)},s.pinchZoomOnTouchStart=function(t){if(2===t.touches.length){t.preventDefault(),t.stopPropagation();var e={};e.x=(t.touches[0].pageX+t.touches[1].pageX)/2,e.y=(t.touches[0].pageY+t.touches[1].pageY)/2,e.distance=s.distance(t),s.setState({start:e})}},s.pinchZoomOnTouchMove=function(t){var e=s.state,o=e.imageElementScale,c=e.imageElementMaxScale,a=s.state.start;if(2===t.touches.length){var n;if(t.preventDefault(),t.stopPropagation(),t.scale)n=t.scale;else n=s.distance(t)/a.distance;o=Math.min(Math.max(1,n),c),s.setState({imageElementScale:o},(function(){var e="translate3d("+2*((t.touches[0].pageX+t.touches[1].pageX)/2-a.x)+"px, "+2*((t.touches[0].pageY+t.touches[1].pageY)/2-a.y)+"px, 0) scale("+o+")";t.target.style.transition="",t.target.style.transform=e,t.target.style.WebkitTransform=e,t.target.style.zIndex="100000"}))}},s.pinchZoomOnTouchEnd=function(t){s.setState({imageElementScale:1}),t.target.style.transition="transform 250ms",t.target.style.transform="",t.target.style.WebkitTransform="",t.target.style.zIndex=""},s.state={imageIdx:0,imageElementScale:1,imageElementMaxScale:5,start:{}},s}var c,n;return n=e,(c=s).prototype=Object.create(n.prototype),c.prototype.constructor=c,c.__proto__=n,s.prototype.render=function(){var e=this,s=this.state,c=s.imageIdx,n=s.imageElementScale,r=this.props,l=r.images,i=r.id,h=r.dblClick,u=void 0===h?function(){}:h,p=r.likeRef,d=void 0===p?{}:p,f=r.noimagestext,b=r.minHeight,g=void 0===b?"100px":b,m=this.props.stores.appState.isCordova,O=c>0,j=c<l.length-1;return l&&0!==l.length?Object(a.h)("div",{class:"w-100 position-relative"},Object(a.h)("div",{class:"d-flex flex-row flex-nowrap bg-light border-top border-bottom no-scrollbar",style:"\n                        overflow-x: "+(n>1&&1===l.length?"visible !important":"auto")+";\n                        overflow-y: "+(n>1?"visible !important":"auto")+";\n                        scroll-snap-type: x mandatory;\n                    ",onScroll:this.scrollImages,ref:function(t){return e.imageScrollerRef=t}},l&&l.filter(o).map((function(s){return Object(a.h)("div",{class:"col-12 clearfix p-0"},Object(a.h)("div",{class:"w-100 h-100 text-center rounded-lg imageContainer d-flex justify-content-center align-items-center position-relative ",style:"\n                                    scroll-snap-align: start;\n                                    flex-wrap: wrap;\n                                ",onDblclick:u,"data-id":i,onTouchstart:function(t){t.stopPropagation()},onTouchend:function(t){t.stopPropagation()},onTouchmove:function(t){t.stopPropagation()}},Object(a.h)("div",{class:"position-absolute w-100 h-100",style:"\n                                        background-image: url('"+s.s3SmallLink+"'); background-size: cover;\n                                        filter: blur(10px);\n                                        opacity: 0.5;\n                                    "}),s.s3LargeLink?Object(a.h)("img",{class:"img-fluid position-relative",src:s.s3LargeLink+(s.updatedDate?"?updated="+s.updatedDate:""),loading:"lazy",style:"max-height: 75vh; min-height: "+g+"; ",onTouchstart:e.pinchZoomOnTouchStart,onTouchend:e.pinchZoomOnTouchEnd,onTouchmove:e.pinchZoomOnTouchMove}):Object(a.h)(t,null,Object(a.h)("span",{class:"display-1 text-muted"},Object(a.h)("i",{class:"fas fa-camera"}))),s.title&&Object(a.h)("div",{class:"position-absolute w-100 text-center",style:"bottom: 0px; background-color: rgba(0, 0, 0, 0.5);"},s.title)),d[i]&&Object(a.h)("span",{class:"likeHeart position-absolute text-white display-1",style:"top: calc(50% - 50px); left: calc(50% - 50px); width: 100px; height: 100px;"},Object(a.h)("i",{class:"fas fa-heart likeStory"})))}))),l&&l.length>1&&Object(a.h)(t,null,Object(a.h)("div",{class:"w-100 text-center"},Object(a.h)("small",null,Object(a.h)("small",null,l&&l.filter(o).map((function(e,s){return Object(a.h)(t,null,Object(a.h)("i",{class:(s===c?"fas":"far")+" fa-circle mr-1"}))}))))),Object(a.h)("div",{class:"position-absolute text-white font-weight-lighter px-1 py-1 rounded-lg",style:"top: 10px; right: 10px; background-color: rgba(0, 0, 0, 0.3); line-height: 1.0em;"},Object(a.h)("small",null,c+1," / ",l.length))),m?Object(a.h)(t,null):Object(a.h)(t,null,O&&Object(a.h)("div",{class:"position-absolute d-none d-lg-block",style:"top: 50%; left: 5px;"},Object(a.h)("button",{type:"button",class:"btn btn-link text-secondary",style:"font-size: 3.0em; opacity: 0.7;",onClick:this.onClickScrollLeft},Object(a.h)("i",{class:"fas fa-arrow-circle-left"}))),j&&Object(a.h)("div",{class:"position-absolute d-none d-lg-block",style:"top: 50%; right: 5px;"},Object(a.h)("button",{type:"button",class:"btn btn-link text-secondary",style:"font-size: 3.0em; opacity: 0.7;",onClick:this.onClickScrollRight},Object(a.h)("i",{class:"fas fa-arrow-circle-right"}))))):f?Object(a.h)(t,null,Object(a.h)("div",{class:"col-12 text-center text-muted"},Object(a.h)("div",{class:"display-1"},Object(a.h)("i",{class:"fas fa-camera"})),Object(a.h)("h3",{class:"font-weight-lighter"},f))):Object(a.h)(t,null)},s}(a.Component))||c);e.a=l}).call(this,s("hosL").Fragment)}}]);
//# sourceMappingURL=route-grant-access.chunk.f17c5.js.map