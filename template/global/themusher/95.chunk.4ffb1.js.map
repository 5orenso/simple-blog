{"version":3,"sources":["webpack:///./components/dog/scroller.js","webpack:///./routes/workouts/publicDetail.js"],"names":["DogScroller","observer","props","scrollImages","e","target","imageIdx","scrollLeft","clientWidth","nearestInt","Math","round","diff","abs","Number","isInteger","setState","sortByName","a","b","allDogs","dogA","find","id","dogB","name","state","render","this","dogs","size","onDogClick","class","style","onScroll","sort","map","dogId","dog","onTouchstart","stopPropagation","onTouchend","onTouchmove","stores","filter","d","indexOf","className","showName","showPosition","Component","MARGIN_TOP","mu","marginTop","MARGIN_TOP_BACK","marginTopBack","MARGIN_BOTTOM","marginBottom","initialState","showAddComment","likeWorkout","hasFollowSugguestions","hasAd","sessionid","Date","getTime","dataFields","WorkoutPublicDetail","onTeamClick","teamid","preventDefault","showTeam","hideTeam","onUserClick","dogid","showDog","hideDog","renderContent","obj","idx","path","appState","type","feed","back","history","goBack","loadPublicWorkouit","teamStore","loadPublicFeed","workoutid","workout","componentWillUnmount","componentDidMount","componentWillReceiveProps","nextProps","shortname","handleIntersection","publicTeamsFeed","darkmode","team","findPublicTeamByUuidv4","image","getImage","displayNameShort","displayName","onClick","public","href","uuidv4","length","data","wrapperClassNames","contentClassNames","dataValues"],"mappings":"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","file":"95.chunk.4ffb1.js","sourcesContent":["import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport DogSimplePublic from './simplePublic';\n\n@observer\nclass DogScroller extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            imageIdx: 0,\n        };\n    }\n\n    scrollImages = (e) => {\n        const { dogs } = this.props;\n\n        const { scrollLeft, scrollWidth, clientWidth } = e.target;\n        const imageStep = clientWidth;\n        const imageIdx = scrollLeft / imageStep;\n        // console.log({ e, imageStep, imageIdx, scrollLeft, scrollWidth, clientWidth });\n\n        const nearestInt = Math.round(imageIdx);\n        const diff = Math.abs(nearestInt - imageIdx);\n        // console.log({ nearestInt, diff });\n        if (Number.isInteger(imageIdx) || diff < 0.1) {\n            this.setState({\n                imageIdx: nearestInt,\n            });\n        }\n    }\n\n    sortByName = (a, b) => {\n        const { allDogs = [] } = this.props;\n        const dogA = allDogs.find(e => e.id === a);\n        const dogB = allDogs.find(e => e.id === b);\n        if (dogA && dogB) {\n            if (dogA.name > dogB.name) {\n                return 1;\n            }\n        }\n        return -1;\n    }\n\n    render() {\n        const { imageIdx } = this.state;\n        const { dogs, allDogs = [], size = 'medium', onDogClick = () => {} } = this.props;\n\n        return (\n            <div class='w-100'>\n                <div\n                    class='d-flex flex-row flex-nowrap no-scrollbar'\n                    style='overflow: auto; scroll-snap-type: x mandatory;'\n                    onScroll={this.scrollImages}\n                >\n                    {dogs && dogs.sort(this.sortByName).map((dogId, idx) => {\n                        const dog = allDogs.find(e => e.id === dogId);\n                        if (!dog) {\n                            return '';\n                        }\n                        return (\n                            <div class='col clearfix position-relative p-0 mx-2'>\n                                <div\n                                    class={`w-100 h-100 text-center rounded-lg imageContainer d-flex justify-content-center align-items-center`}\n                                    style={`\n                                        flex-wrap: wrap;\n                                        overflow-y: hidden;\n                                    `}\n                                    onTouchstart={(e) => { e.stopPropagation(); }}\n                                    onTouchend={(e) => { e.stopPropagation(); }}\n                                    onTouchmove={(e) => { e.stopPropagation(); }}\n                                >\n                                    <DogSimplePublic\n                                        stores={this.props.stores}\n                                        dog={dog}\n                                        dogs={allDogs.filter(d => dogs.indexOf(d.id) > -1).sort((a, b) => a.name > b.name ? 1 : -1)}\n                                        className='mx-auto'\n                                        showName={true}\n                                        showPosition={false}\n                                        size={size}\n                                        onDogClick={onDogClick} \n                                    />\n                                    {/* <xmp>{JSON.stringify(img, null, 4)}</xmp> */}\n                                </div>\n                            </div>\n                        );\n                    })}\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default DogScroller;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport TeamConnectBoxes from '../../components/team/connect-boxes';\nimport TeamConnectConfirm from '../../components/team/connect-confirm';\n\nimport Ad from '../../components/ad/';\n\nimport FastList from '../../components/team/fastList';\n\nimport Overlay from '../../components/overlay/';\nimport TeamsPublicDetail from '../../routes/teams/publicDetail';\nimport DogPublicDetail from '../../routes/dogs/publicDetail';\n\nimport TeamPublicFeedLine from '../../components/team/publicFeedLine';\n\nimport mu from '../../lib/musher-util';\n\nconst MARGIN_TOP = mu.marginTop(false);\nconst MARGIN_TOP_BACK = mu.marginTopBack(false);\nconst MARGIN_BOTTOM = mu.marginBottom();\n\nconst initialState = {\n\tshowAddComment: {},\n    // viewImageIdx: {},\n    likeWorkout: {},\n    hasFollowSugguestions: false, \n    hasAd: false,\n    sessionid: new Date().getTime(),\n};\n\nconst dataFields = ['id', 'type', 'user', 'team', 'title'];\n\n@observer\nclass WorkoutPublicDetail extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n    async loadPublicWorkouit({ props = this.props }) {\n\t\tconst { teamStore } = props.stores;\n        const { workout: workoutid } = props;\n\t\tawait teamStore.loadPublicFeed({ workoutid });\n\t}\n\n    // Overlay functions\n    onTeamClick = (e, teamid) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.setState({\n            showTeam: teamid,\n        });\n        return false;\n    }\n\n    hideTeam = () => {\n        this.setState({\n            showTeam: null,\n        });\n    }\n\n    onUserClick = (e, userid) => {\n        e.preventDefault();\n        e.stopPropagation();\n        return false;\n    }\n\n    onDogClick = (e, dogid, dogs) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.setState({\n            showDog: dogid,\n            dogs,\n        });\n        return false;\n    }\n\n    hideDog = () => {\n        this.setState({\n            showDog: null,\n        });\n    }\n    // /Overlay functions\n\n    componentWillUnmount() {\n        const { teamStore } = this.props.stores;\n        // teamStore.cleanupMemory();\n    }\n\n\tcomponentDidMount() {\n        this.loadPublicWorkouit(this.props);\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {\n        // console.log('componentWillReceiveProps', nextProps.viewmenu, this.props.viewmenu);\n        if (nextProps.workoutid !== this.props.workoutid) {\n            this.loadPublicWorkouit(nextProps);\n        }\n    }\n\n    renderContent = ({ obj, idx }) => {\n        const { appState } = this.props.stores;\n        const { path } = appState;\n\n        if (obj.type === 'ad') {\n            return(<>\n                <Ad stores={this.props.stores} path={path} />\n            </>);\n        }\n        if (obj.type === 'teamConfirm') {\n            return(<>\n                <TeamConnectConfirm stores={this.props.stores} />\n            </>);\n        }\n        if (obj.type === 'teamSuggestions') {\n            return(<>\n                <TeamConnectBoxes stores={this.props.stores} />\n            </>);\n        }\n        return (<>\n            <TeamPublicFeedLine\n                stores={this.props.stores}\n                feed={obj}\n                idx={idx}\n                onTeamClick={this.onTeamClick}\n                onUserClick={this.onUserClick}\n                onDogClick={this.onDogClick}\n            />\n        </>);\n    }\n\n    back = () => {\n        const { history } = this.props.stores;\n        history.goBack();\n    }\n\n    render() {\n        const { showTeam, showDog, handleIntersection, sessionid, dogs } = this.state;\n        const { teamStore, appState } = this.props.stores;\n        const { publicTeamsFeed } = teamStore;\n        const { path, darkmode } = appState;\n        const { teamid } = this.props;\n        const team = teamStore.findPublicTeamByUuidv4(teamid);\n        \n        const image = mu.getImage({ team });\n        let shortname;\n        let name;\n        let username;\n        if (team && team.name) {\n            shortname = mu.displayNameShort(team);\n            name = mu.displayName(team);\n        }\n\n\n        return (<>\n            {showTeam && <Overlay>\n                <TeamsPublicDetail stores={this.props.stores} teamid={showTeam} marginTop={'0px;'} marginBottom={'0px;'} back={this.hideTeam} hideTeam={this.hideTeam} />\n            </Overlay>}\n\n            {showDog && <Overlay>\n                <DogPublicDetail stores={this.props.stores} dogid={showDog} marginTop={'0px;'} marginBottom={'0px;'} back={this.hideDog} dogs={dogs} />\n            </Overlay>}\n\n\t\t\t<div class='container-fluid' style={`margin-bottom: ${MARGIN_BOTTOM}; margin-top: ${MARGIN_TOP};`}>\n                <div class='d-flex justify-content-between mb-2'>\n                    <div>\n\t\t\t\t\t\t<button class='btn btn-link float-left pl-0 fixed-top'\n                            style={`top: ${MARGIN_TOP_BACK}; left: 5px; font-size: 35px; width: 45px;`}\n\t\t\t\t\t\t\tonClick={this.back}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<i class='fas fa-arrow-circle-left' />\n\t\t\t\t\t\t</button>\n                    </div>\n                    <div>\n                        <h5 class='text-muted'>&nbsp;</h5>\n                    </div>\n                </div>\n\n                <div class='w-100'>\n                    {team ? <>\n                        <div class='row pb-3 pt-3'>\n                            <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 border-bottom'>\n                                <div class='row'>\n                                    <h3>\n                                        <div class='d-flex position-relative'>\n                                            <div\n                                                class={`text-center border rounded-circle imageRounded imageRoundedSmall`}\n                                                style={image ? `background-image: url(\"${image}\"); background-size: cover;` : ''}\n                                            >\n                                                {!image && <div class='text-muted' style='font-size: 20px; padding-top: 3px;'>{shortname}</div>}\n                                            </div>\n                                            <div class='flex-grow-1 pl-3 text-overflow' style='line-height: 1.2em;'>\n                                                <h3 class='mb-1'>\n                                                    {team.public ? <>\n                                                        <a href={`/teams/public/${team.uuidv4}`} class='stretched-link'>{name}</a>\n                                                    </> : <>\n                                                        {name}\n                                                    </>}\n                                                </h3>\n                                            </div>\n                                        </div>\n                                    </h3>\n                                </div>\n                            </div>\n                        </div>\n                    </> : <>\n                        <TeamConnectConfirm stores={this.props.stores} />\n                    </>}\n\n                    {(!publicTeamsFeed || publicTeamsFeed.length === 0) && <>\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 px-0'>\n                            <div class='text-center text-muted'>\n                                <div class='display-1'><i class='fas fa-chart-area' /></div>\n                                <h3><Text id='search.no-workouts-found'>No workouts found.</Text></h3>\n                                <Text id='teams.no-public-workouts-text'>Please follow more teams to see their workout activity on this page. This is a great way to get updates from all your favorite mushers.</Text>\n                            </div>\n                            <div class='text-center mt-3'>\n                                <a href='/teams/connect' class='btn btn-primary'>\n                                    <i class='fas fa-users' /> <Text id='header.connect-team'>Follow teams</Text>\n                                </a>\n                            </div>\n                        </div>\n                    </>}\n\n                    <FastList\n                        data={publicTeamsFeed}\n                        wrapperClassNames={'row pb-4'}\n                        contentClassNames={`col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 my-1 position-relative rounded rounded-lg py-3 bg-${darkmode ? 'black' : 'white'} shadow-sm`}\n                        renderContent={this.renderContent}\n                        dataFields={dataFields}\n                        dataValues={{ type: '10' }}\n                        handleIntersection={handleIntersection}\n                        sessionid={sessionid}\n                    />\n\n                </div>\n            </div>\n        </>);\n    }\n}\n\nexport default WorkoutPublicDetail;\n"],"sourceRoot":""}