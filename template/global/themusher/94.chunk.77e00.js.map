{"version":3,"sources":["webpack:///./routes/teams/connect.js","webpack:///./components/team/public.js"],"names":["MARGIN_TOP","mu","marginTop","MARGIN_BOTTOM","marginTopBack","marginBottom","SUB_MENU_MARGIN_TOP","subMenuMarginTop","initialState","isLoading","limit","offset","submenu","Teams","observer","props","setLoadMore","stores","teamStore","state","search","setState","loadTeams","unsetLoadMore","searchForTeams","chooseSubmenu","e","target","parentElement","dataset","menu","opts","this","notfollowing","following","loadPublic","componentDidMount","componentWillUnmount","render","scrolledDown","publicTeamsToFollow","darkmode","appState","class","style","href","id","data-menu","onClick","fields","total","length","for","type","onInput","linkState","map","team","Component","Team","requestFollowTeam","user","userStore","teamId","parseInt","followRequest","requestSent","unFollowTeam","unollowTeam","unfollowed","getButton","text","skipHome","simple","classNames","isYourTeam","members","indexOf","isFollowing","followers","isBlocked","blockedFollowers","hasRequestedFollow","followRequests","findIndex","disabled","data-team","public","buttonOnly","language","teamAmbition","findTeamAmbition","ambition","ambitions","teamType","findTeamType","image","s3SmallLink","name","uuidv4","place","country","dogs"],"mappings":"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","file":"94.chunk.77e00.js","sourcesContent":["import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport linkState from 'linkstate';\n\nimport mu from '../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(true);\nconst MARGIN_TOP_BACK = mu.marginTopBack(false);\nconst MARGIN_BOTTOM = mu.marginBottom();\nconst SUB_MENU_MARGIN_TOP = mu.subMenuMarginTop();\n\nimport PublicTeam from '../../components/team/public';\n\nconst initialState = {\n\tisLoading: false,\n\tlimit: 25,\n\toffset: 0,\n\tsubmenu: 'notfollowing',\n};\n\n@observer\nclass Teams extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\tasync loadTeams({ limit, offset, search }) {\n\t\tconst { submenu } = this.state;\n\t\tthis.setState({ isLoading: true });\n\t\tconst { teamStore } = this.props.stores;\n\t\tconst opts = {};\n\t\tif (submenu === 'notfollowing') {\n\t\t\topts.notfollowing = 1;\n\t\t}\n\t\tif (submenu === 'following') {\n\t\t\topts.following = 1;\n\t\t}\n\t\tawait teamStore.loadPublic({ limit, offset, search, opts });\n\t\tthis.setState({ isLoading: false });\n\t}\n\n    setLoadMore = () => {\n        const { teamStore } = this.props.stores;\n        teamStore.setLoadMore(() => {\n            let { limit, offset, search } = this.state;\n            offset += limit;\n            this.setState({ offset });\n            this.loadTeams({ limit, offset, search });\n        });\n    }\n\n\tunsetLoadMore = () => {\n        const { teamStore } = this.props.stores;\n        teamStore.setLoadMore(() => {});\n    }\n\n\tsearchForTeams = () => {\n\t\tconst { search, limit } = this.state;\n\t\tthis.setState({\n\t\t\toffset: 0,\n\t\t});\n\t\tthis.loadTeams({ search, limit });\n\t}\n\n    chooseSubmenu = (e) => {\n\t\tconst { limit } = this.state;\n\t\tconst submenu = e.target.parentElement.dataset.menu || e.target.dataset.menu;\n\t\tthis.setState({\n\t\t\tsubmenu,\n\t\t\toffset: 0,\n\t\t}, () => {\n\t\t\tthis.loadTeams({\n\t\t\t\tlimit,\n\t\t\t\toffset: 0,\n\t\t\t});\n\t\t});\n\t}\n\n\tcomponentDidMount() {\n        const { limit, offset } = this.state;\n\t\tthis.loadTeams({ limit, offset });\n        this.setLoadMore();\n\t}\n\n    componentWillUnmount() {\n        this.unsetLoadMore();\n    }\n\n\trender() {\n        const { scrolledDown } = this.props;\n\t\tconst { isLoading, submenu } = this.state;\n\t\tconst { teamStore, userStore, appState } = this.props.stores;\n\t\tconst { publicTeamsToFollow = [] } = teamStore;\n\t\tconst { user } = userStore;\n\t\tconst { darkmode } = appState;\n\n\t\treturn (\n\t\t\t<div class='container-fluid' style={`margin-bottom: ${MARGIN_BOTTOM}; margin-top: ${MARGIN_TOP};`}>\n\t\t\t\t<div class='row fixed-top pt-2' style={`margin-top: ${scrolledDown > 0 ? 0 : SUB_MENU_MARGIN_TOP}; background-color: ${darkmode ? '#191d21' : '#f8f9fa'}; transition: all 0.3s ease-in-out;`}>\n\t\t\t\t\t<div class='col text-center subtopmenu'>\n\t\t\t\t\t\t<a href='/teams/' class='text-secondary stretched-link'><nobr><i class='fas fa-users' /> <Text id='teams.your-teams'>Your teams</Text></nobr></a>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col text-center border-bottom border-primary subtopmenu'>\n\t\t\t\t\t\t<a href='/teams/connect' class='text-primary stretched-link'><nobr><i class='fas fa-users' /> <Text id='teams.public-teams'>Public teams</Text></nobr></a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class='row'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 my-3'>\n\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t<div class='w-100 overflow-hidden'>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclass='d-flex flex-row flex-nowrap pb-2 px-1'\n\t\t\t\t\t\t\t\t\tstyle='overflow: auto; scroll-snap-type: x mandatory;'\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div class='col px-0 pt-2'>\n\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\tclass={`btn btn-block rounded-pill-left rounded-none ${submenu === 'all' ? 'btn-primary' : 'btn-outline-primary'} text-nowrap`}\n\t\t\t\t\t\t\t\t\t\t\tstyle='text-overflow: ellipsis; overflow: hidden;'\n\t\t\t\t\t\t\t\t\t\t\tdata-menu='all'\n\t\t\t\t\t\t\t\t\t\t\tonClick={this.chooseSubmenu}\n\t\t\t\t\t\t\t\t\t\t><i class='fas fa-users' /> <Text id='teams.all'>All</Text></button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class='col px-0 pt-2'>\n\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\tclass={`btn btn-block rounded-none ${submenu === 'notfollowing' ? 'btn-primary' : 'btn-outline-primary'} text-nowrap`}\n\t\t\t\t\t\t\t\t\t\t\tstyle='text-overflow: ellipsis; overflow: hidden;'\n\t\t\t\t\t\t\t\t\t\t\tdata-menu='notfollowing'\n\t\t\t\t\t\t\t\t\t\t\tonClick={this.chooseSubmenu}\n\t\t\t\t\t\t\t\t\t\t><i class='fas fa-unlink' /> <Text id='teams.notfollowing'>Not following</Text></button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class='col px-0 pt-2'>\n\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\tclass={`btn btn-block rounded-pill-right rounded-none ${submenu === 'following' ? 'btn-primary' : 'btn-outline-primary'} text-nowrap`}\n\t\t\t\t\t\t\t\t\t\t\tstyle='text-overflow: ellipsis; overflow: hidden;'\n\t\t\t\t\t\t\t\t\t\t\tdata-menu='following'\n\t\t\t\t\t\t\t\t\t\t\tonClick={this.chooseSubmenu}\n\t\t\t\t\t\t\t\t\t\t><i class='fas fa-link' /> <Text id='teams.following'>Following</Text></button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class='row'>\n\t\t\t\t\t<div class='col-12'>\n\t\t\t\t\t\t<div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 px-0'>\n\t\t\t\t\t\t\t<h5><Text id='teams.connect.all-teams' fields={{ total: publicTeamsToFollow.length }}>Alle offentlige team - {publicTeamsToFollow.length} stk</Text></h5>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 px-0'>\n\t                        <div class='d-flex flex-row flex-nowrap position-relative' style='overflow: auto;'>\n\t\t\t\t\t\t\t\t<div class='flex-grow-1'>\n\t\t\t\t\t\t\t\t\t<label class='sr-only' for='teamSearch'><Text id='search.title'>Search</Text></label>\n\t\t\t\t\t\t\t\t\t<Localizer>\n\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\t\t\t\t\t\tclass='form-control form-control-lg mb-2'\n\t\t\t\t\t\t\t\t\t\t\tid='teamSearch'\n\t\t\t\t\t\t\t\t\t\t\tonInput={linkState(this, 'search')}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</Localizer>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class='align-self-end ml-1'>\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\ttype='button'\n\t\t\t\t\t\t\t\t\t\tclass='btn btn-lg btn-primary mb-2'\n\t\t\t\t\t\t\t\t\t\tonClick={this.searchForTeams}\n\t\t\t\t\t\t\t\t\t><Text id='dog.veterinary.search'>Search</Text></button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{publicTeamsToFollow && publicTeamsToFollow.map(team => (\n\t\t\t\t\t\t\t<PublicTeam stores={this.props.stores} team={team} />\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Teams;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\n@observer\nclass Team extends Component {\n    requestFollowTeam = (e) => {\n        const { teamStore, userStore } = this.props.stores;\n        const { user } = userStore;\n        const teamId = parseInt(e.target.parentElement.dataset.team || e.target.dataset.team, 10);\n        teamStore.followRequest(teamId, user);\n        this.setState({ requestSent: true });\n    }\n\n    unFollowTeam = (e) => {\n        const { teamStore, userStore } = this.props.stores;\n        const { user } = userStore;\n        const teamId = parseInt(e.target.parentElement.dataset.team || e.target.dataset.team, 10);\n        teamStore.unollowTeam(teamId);\n        this.setState({ unfollowed: true });\n    }\n\n    getButton = (text = '') => {\n        const { requestSent } = this.state;\n        const { userStore } = this.props.stores;\n        const { user } = userStore;\n        const { team, skipHome, simple, classNames } = this.props;\n        const isYourTeam = team.members && team.members.indexOf(user.id) > -1;\n        const isFollowing = team.followers && team.followers.indexOf(user.id) > -1;\n        const isBlocked = team.blockedFollowers && team.blockedFollowers.indexOf(user.id) > -1;\n        const hasRequestedFollow = requestSent || team.followRequests && team.followRequests.findIndex(e => e.id === user.id) > -1;\n\n        if (isYourTeam) {\n            if (skipHome) {\n                return '';\n            }\n            return (\n                <i class='fas fa-home' />\n            );\n        }\n        if (isFollowing) {\n            return (<>\n                <button\n                    class={classNames || `btn btn-block btn-outline-secondary float-right`}\n                    onClick={this.unFollowTeam}\n                    disabled='true'\n                    data-team={team.id}\n                >\n                    <i class='fas fa-link mr-2' />\n                    <Text id='teams.connect.is-following'>Følger</Text> {!simple && <>{text}</>}\n                </button>\n                <button\n                    class={classNames || `btn btn-sm btn-block btn-danger float-right`}\n                    onClick={this.unFollowTeam}\n                    data-team={team.id}\n                >\n                    <i class='fas fa-unlink mr-2' />\n                    <Text id='teams.connect.unfollow'>Unfollow</Text>\n                </button>\n            </>);\n        }\n        if (isBlocked) {\n            return '';\n            // return (\n            //     <button\n            //         class={`btn btn-block btn-outline-secondary float-right`}\n            //         disabled='true'\n            //     >\n            //         <i class='fas fa-hand-paper mr-2' />\n            //         <Text id='teams.connect.is-blocked'>Blokkert</Text> {text}\n            //     </button>\n            // );\n        }\n        if (hasRequestedFollow) {\n            return (\n                <button\n                    class={classNames || `btn btn-block btn-outline-secondary float-right`}\n                    disabled='true'\n                >\n                    <i class='fas fa-hourglass-half mr-2' />\n                    <Text id='teams.connect.has-requested'>Venter på godkjenning</Text> {!simple && <>{text}</>}\n                </button>\n            );\n        }\n        if (team.public) {\n            return (\n                <button\n                    class={classNames || `btn btn-block btn-outline-success float-right`}\n                    onClick={this.requestFollowTeam}\n                    data-team={team.id}\n                >\n                    <i class='fas fa-plus mr-2' />\n                    <Text id='teams.connect.follow'>Følg</Text> {!simple && <>{text}</>}\n                </button>\n            );\n        }\n    }\n\n    render() {\n        const { unfollowed } = this.state;\n        const { team, buttonOnly } = this.props;\n        const { userStore } = this.props.stores;\n        const { user } = userStore;\n        const { language = 'en' } = user;\n        const teamAmbition = userStore.findTeamAmbition({ ambition: team.ambitions, language });\n        const teamType = userStore.findTeamType({ type: team.type, language });\n        const image = team.image && team.image.s3SmallLink ? team.image : null;\n\n        if (buttonOnly) {\n            return (<>\n                {this.getButton(`${team.name}`)}\n            </>);\n        }\n\n        return (\n            <div class='w-100 mb-3'>\n                <div class='row'>\n                    <div class='col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 d-flex mb-0 position-relative border-top pt-3'\n                        style={`${unfollowed ? 'text-decoration: line-through; opacity: 0.3;' : ''}`}\n                    >\n                        {/* {JSON.stringify(team, null, 4)} */}\n                        <a href={`/teams/public/${team.uuidv4}`}>\n                        <div class={`text-center border rounded-circle imageRounded`} style={image ? `background-image: url(\"${image.s3SmallLink}\");  background-size: cover;` : ''}>\n                            {!image && <i class='fas fa-users text-muted mt-3' style='font-size: 40px;' />}\n                        </div>\n                        </a>\n                        <div class='flex-grow-1 pl-3' style='line-height: 1.2em;'>\n                            <h5 class='mb-1' style='line-height: 1.0em;'>\n                                {team.public ? <>\n                                    <a href={`/teams/public/${team.uuidv4}`}>{team.name}</a>\n                                </> : <>\n                                    {team.name}\n                                </>}\n                            </h5>\n                            <div>\n                                {team.place} {team.country}\n                            </div>\n                            <div>\n                                {teamType && <span class='badge badge-pill badge-secondary'>{teamType}</span>}\n                                {teamAmbition && <span class='badge badge-pill badge-secondary ml-2'>{teamAmbition}</span>}\n                            </div>\n                            <small class='text-muted'>\n                                {team && team.dogs && <span class=''><i class='fas fa-dog' /> {team.dogs.length}</span>} \n                                {team && team.followers && <span class='ml-2'><i class='fas fa-user' /> {team.followers.length}</span>}\n                            </small>\n                        </div>\n                        <div>\n                            {this.getButton()}\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default Team;\n"],"sourceRoot":""}