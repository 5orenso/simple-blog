{"version":3,"sources":["webpack:///./routes/app-races/tracking.js","webpack:///./components/public/trackmap.js","webpack:///./routes/app-races/notifications.js","webpack:///./routes/app-races/userImages.js","webpack:///./routes/app-races/news.js","webpack:///./routes/app-races/signup.js","webpack:///./routes/app-races/mushers.js","webpack:///./routes/app-races/index.js","webpack:///./routes/app-races/classes.js","webpack:///./routes/app-races/results.js"],"names":["MARGIN_TOP","mu","marginTop","MARGIN_TOP_BACK","marginTopBack","initialState","marginBottom","subMenuMarginTop","isLoading","email","submenu","jwtToken","util","getJwtToken","reloadInSec","reloadIsActive","leaderboardMode","filterByraceClass","showLeaderBoard","showNews","ReloadTimer","observer","props","initComponent","setState","tickReloadTimeer","reloadLastEpoch","state","now","Math","floor","Date","getTime","clearTimeout","updateTimer","tick","setTimeout","componentDidMount","this","componentWillUnmount","render","radius","fontSize","classNames","reloadPercent","normalizeBetween","class","key","color","showPercentText","percent","showCenterText","centerText","centerTextSize","centerTextY","Component","MusherInfo","toggleAdminInfo","e","stopPropagation","showAdminInfo","toggleInfo","showInfo","bib","onTeamClick","onDogClick","stores","raceStore","isAdmin","userStore","musher","getMusherByBibId","getMusherByBibEmail","team","getTeamById","user","members","find","m","raceClass","getClassByTeamId","totals","getTotalsByTeamId","image","getImage","priority","shortname","displayNameShort","style","title","flag","firstname","lastname","sportsClub","public","onClick","id","href","uuidv4","name","markdown","replaceImages","description","images","markdownOpts","getMarkdownOptions","dogs","map","d","allDogs","distanceKm","length","format","elevation","secToHms","duration","rest","JSON","stringify","AppRaceDetailTracking","loadLiveRaceResults","getRaceTrackerData","race","raceTrackerRace","getRaceTrackerActiveTeams","loadRaceResults","teamIds","focusOnMushers","loadWorkoutSummary","raceid","getWorkoutSummaryActiveTeams","loadRace","allTeamIds","appState","load","classes","filter","currentClass","contestants","flat","loadTeams","join","liveRace","getAllClassesSortedBy","reload","RELOAD_INTERVAL_IN_SEC","setLeaderboardMode","target","parentElement","dataset","mode","chooseRaceClass","value","toggleShowLeaderBoard","hide","toggleShowNews","onMarkerClick","showModal","modalTitle","modalBib","modalEmail","toggleModal","teamid","preventDefault","showTeam","hideTeam","onUserClick","dogid","showDog","hideDog","back","history","goBack","width","window","innerWidth","height","innerHeight","waypoints","waypoints2","waypoints3","zoomToMarkers","fullscreenMap","src","showAddComment","Trackmap","inputRef","loadTrack","mapid","mapId","minZoom","maxZoom","AppRaceDetailNotifications","subscribeNotificationTopic","field","notificationTopics","setNotificationTopic","topic","AppRaceDetailUserImages","addRaceUserImage","addUserImage","newUserImage","newRaceUserImage","updateUserImageUpload","removeRaceUserImage","removeUserImage","userImageId","editRaceUserImage","data","raceUserImageId","ucfirst","editUserImage","resizeTextarea","el","element","scrollHeight","handleImageErrored","onerror","tags","tag","split","forEach","push","trim","hashTags","postfix","hashtags","AppRaceDetailNews","addRaceArticle","addArticle","newArticle","newRaceArticle","editRaceArticle","raceArticleId","editArticle","removeRaceArticle","removeArticle","articleId","updateArticleUpload","AppRaceDetailSignup","signupToRace","signup","addContestant","classId","newContestant","cellphone","facebook","instagram","updateSignup","updateObjectKeyValue","editSignup","classid","contestantid","raceClassId","contestantId","editClass","localUpdateSignup","teams","language","signupClass","getRaceClassById","findDogsByTeam","parseInt","vaccineLogStatuses","today","signupStartDate","signupEndDate","signuppayment","for","paidSignupfee","formatDate","role","signupfee","type","data-classid","data-contestantid","onInput","placeholder","aria-describedby","disabled","sort","a","b","distance","rules","checked","termsAndAgreement","declaration","isoDate","declarationDate","dog","s3SmallLink","birth","age","deceased","gender","chipId","vac","inKarens","vaccineAgens","durationEnd","karensDaysLeft","locale","hour12","hour","minute","AppRaceDetailMushers","toggleDisplayDetails","closest","editUserDetails","adminToggleEditUser","toggleEditUserDetails","toggleAdminSendMessage","showAdminSendMessage","toggleAdminImport","showAdminImport","adminSignupEdit","sendEmail","raceId","to","raceclassid","message","subject","body","emailResponse","resetEmail","parseInput","parseInputTimer","doParseInput","lines","String","headers","jsonData","firstLine","match","i","line","values","jsonObject","v","idx","val","toLowerCase","l","addMultipleContestants","displayDetails","startDate","startTime","endDate","endTime","scope","currentTeam","data-id","raceStatus","raceComment","gpxResultsApproved","alt","asFacebookLink","native","rel","asInstagramLink","price1","priceSent","price2","price3","startOrder","address","postalcode","postalplace","countryCode","birthdate","emails","date","dangerouslySetInnerHTML","__html","$str","replace","linkstate","rows","status","data-to","data-raceclassid","data-class","oninput","MARGIN_BOTTOM","likeRace","toggleAddComment","focus","chooseSubmenu","menu","route","resizeAllTextareas","textareaList","document","getElementsByTagName","addNavigation","findIndex","updateKeyValue","getDogs","loadPublicInteractions","componentWillReceiveProps","nextProps","likes","comments","hasLikedRace","isLiveRace","showSignup","data-menu","s3LargeLink","horizontal","vertical","veterinaryInfo","checkpoints","trailDescription","program","prices","ingress","indexOf","c","inputRefObject","cols","AppRaceDetailClasses","contentIsNotLoaded","aria-valuenow","aria-valuemin","aria-valuemax","AppRaceDetailResults","lockAllWorkoutsInRace","lockMessage","filterByClass","selectedClassId","toggleSelectedClassId","selectedClassIds","lastAllowedChangeDate","setHours","getHours","resultsUrl","resultsText","resultDanger","resultWarning","resultSuccess","totalMushers","totalFinished","contestant","currentStages","currentResults","completed","normalizedDuration","weightedNormalizedDuration","isDone","finishedDate","totalWorkoutTimeUsedSec","data-email","isLocked","stage","currentEpoch","inDate","setUTCSeconds","viewBox","svgElevation","speedAvg","avgDogs","lastUpdated","nonstop","totalRest","firstEpoch","firstGpxStartEpoch","lastGpxStartEpoch"],"mappings":"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","file":"route-app-races.chunk.111cd.js","sourcesContent":["import { h, Component } from 'preact';\nimport { useEffect } from 'preact/hooks';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport { route } from 'preact-router';\nimport Markdown from 'preact-markdown';\nimport linkstate from 'linkstate';\n\nimport Trackmap from '../../components/public/trackmap';\nimport Gauge from '../../components/gauge';\n\nimport DogScroller from '../../components/dog/scroller';\nimport Overlay from '../../components/overlay/';\nimport TeamsPublicDetail from '../../routes/teams/publicDetail';\nimport DogPublicDetail from '../../routes/dogs/publicDetail';\n\nimport mu from '../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(false);\nconst MARGIN_TOP_BACK = mu.marginTopBack(false);\nconst MARGIN_BOTTOM = mu.marginBottom();\nconst SUB_MENU_MARGIN_TOP = mu.subMenuMarginTop();\n\nfunction PageTitle(title, classes = '', style = '') {\n    useEffect(() => {\n        document.title = `Homerun Race: ${title}`;\n    }, [title]);\n    return <span class={classes} style={style}>{title}</span>;\n}\n\nfunction getWindowDimensions() {\n    const { innerWidth: width, innerHeight: height } = window;\n    return {\n        width,\n        height\n    };\n}\n\nconst initialState = {\n    isLoading: false,\n    email: '',\n    submenu: 'ads',\n    jwtToken: util.getJwtToken(),\n\n    reloadInSec: null,\n    reloadIsActive: false,\n\n    leaderboardMode: 'mushers',\n    filterByraceClass: '',\n    showLeaderBoard: true,\n    showNews: true,\n};\n\nconst RELOAD_INTERVAL_IN_SEC = 60;\n\n@observer\nclass ReloadTimer extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n        this.updateTimer = {};\n    }\n\n    initComponent = () => {\n        this.setState({\n            reloadIsActive: true,\n        }, () => this.tickReloadTimeer());\n    }\n\n    tickReloadTimeer = () => {\n        const { reloadLastEpoch } = this.props;\n        const { reloadIsActive } = this.state;\n        if (reloadIsActive) {\n            const now = Math.floor(new Date().getTime() / 1000);\n            const reloadInSec = RELOAD_INTERVAL_IN_SEC - (now - reloadLastEpoch);\n            this.setState({ reloadInSec });\n            clearTimeout(this.updateTimer.tick);\n            this.updateTimer.tick = setTimeout(() => this.tickReloadTimeer(), 1000);\n        }\n        return false;\n    }\n\n    componentDidMount() {\n        this.initComponent();\n    }\n\n    componentWillUnmount() {\n        clearTimeout(this.updateTimer.tick);\n    }\n\n    render() {\n        const { reloadInSec } = this.state;\n        const { radius = 13, fontSize = 11, classNames = '' } = this.props;\n        const reloadPercent = Math.floor(util.normalizeBetween(reloadInSec, 0, RELOAD_INTERVAL_IN_SEC, 0, 100))\n\n        return (<>\n            <span class={classNames}>\n                <Gauge key={`gauge-reload-page`}\n                    color='primary'\n                    radius={radius}\n                    showPercentText={false}\n                    percent={reloadPercent}\n                    showCenterText={true}\n                    centerText={reloadInSec}\n                    centerTextSize={fontSize}\n                    centerTextY={'55%'}\n                />\n            </span>\n        </>);\n    }\n}\n\n@observer\nclass MusherInfo extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n        };\n    }\n\n    toggleAdminInfo = (e) => {\n        e.stopPropagation();\n        const { showAdminInfo } = this.state;\n        this.setState({\n            showAdminInfo: !showAdminInfo,\n        });\n    }\n\n    toggleInfo = (e) => {\n        e.stopPropagation();\n        const { showInfo } = this.state;\n        this.setState({\n            showInfo: !showInfo,\n        });\n    }\n\n    render() {\n        const { showAdminInfo, showInfo } = this.state;\n        const { bib, email, onTeamClick, onUserClick, onDogClick } = this.props;\n\n        const { raceStore, userStore } = this.props.stores;\n        const { isAdmin } = userStore;\n        const musher = bib ? raceStore.getMusherByBibId(bib) : raceStore.getMusherByBibEmail(email);\n        const team = raceStore.getTeamById(musher.team);\n        const user = team.members ? team.members.find(m => m.email === musher.email) : {};\n        const raceClass = raceStore.getClassByTeamId(musher.team);\n        const totals = raceStore.getTotalsByTeamId(musher.team);\n        const image = mu.getImage({ user, team, priority: 'user' });\n        const shortname = mu.displayNameShort(user) || mu.displayNameShort(musher);\n        \n        return (<>\n            <div class='d-flex position-relative'>\n                <div\n                    class={`position-relative text-center border rounded-circle imageRounded imageRoundedMedium`}\n                    style={image ? `background-image: url(\"${image}\"); background-size: cover;` : ''}\n                >\n                    {!image && <div class='text-muted' style='font-size: 25px; padding-top: 5px;'>{shortname}</div>}\n                    <div\n                        class='rounded-pill-both px-2 text-center position-absolute bg-secondary font-weight-bold'\n                        style='bottom: -10px; right: 50%;'\n                    >\n                        {musher.bib && musher.bib !== 'n/a' && <>{musher.bib}</>}\n                    </div>\n                </div>\n                <div class='flex-grow-1 pl-3 text-overflow mb-3' style='line-height: 1.2em;'>\n                    <h6 class='font-weight-light mb-0'>{raceClass.title}</h6>\n                    <h3 class='mb-0'>\n                        {musher.flag} {musher.firstname} {musher.lastname}\n                    </h3>\n                    <h6 class='mb-0'>{musher.sportsClub}</h6>\n                </div>\n            </div>\n\n\n            {team.public > 0 && <>\n                {showInfo ? <>\n                    <button class='btn btn-link float-right' onClick={this.toggleInfo}>\n                        <i class='fas fa-angle-up' /> <Text id='races.hide-info'>Hide info</Text>\n                    </button>            \n                </> : <>\n                    <button class='btn btn-link float-right' onClick={this.toggleInfo}>\n                        <i class='fas fa-angle-down' /> <Text id='races.show-info'>Show info</Text>\n                    </button>            \n                </>}\n\n                <h3>\n                    {team.public ? <>\n                        <a href={`/teams/public/${team.uuidv4}`} onClick={(e) => onTeamClick(e, team.uuidv4)}>\n                            {team.name}\n                        </a>\n                    </> : <>\n                        {team.name}\n                    </>}\n                </h3>\n                {showInfo && <>\n                    <Markdown markdown={mu.replaceImages(team.description, team.images)} markdownOpts={mu.getMarkdownOptions()} />\n                </>}\n                {team.dogs && <div class='w-100'>\n                    <div class='row pt-2'>\n                        <DogScroller stores={this.props.stores} dogs={team.dogs.map(d => d.id)} allDogs={team.dogs} onDogClick={onDogClick} />\n                    </div>\n                </div>}\n            </>}\n\n            {totals && totals.distanceKm && <>\n                <div class='table-responsive-lg'>\n                    <table class='table table-borderless'>\n                        <tbody>\n                            <tr>\n                                <td style='width: 5%;'><i class='fas fa-dog' /></td>\n                                <td style='width: 60%'><Text id='races.dogs'>Dogs</Text></td>\n                                <td style='width: 5%;'>&nbsp;</td>\n                                <td class='text-right' style='width: 30%;'>{team.dogs.length}</td>\n                            </tr>\n                            <tr>\n                                <td><i class='fas fa-road' /></td>\n                                <td><Text id='races.distance'>Distance</Text></td>\n                                <td>&nbsp;</td>\n                                <td class='text-right'><nobr>{totals.distanceKm ? `${util.format(totals.distanceKm, 1)} km` : 'n/a'}</nobr></td>\n                            </tr>\n                            <tr>\n                                <td><i class='fas fa-mountain' /></td>\n                                <td><Text id='races.ascend'>Ascending</Text></td>\n                                <td>&nbsp;</td>\n                                <td class='text-right'><nobr>{totals.elevation ? `${util.format(totals.elevation, 0)} m` : 'n/a'}</nobr></td>\n                            </tr>\n                            <tr>\n                                <td><i class='fas fa-stopwatch' /></td>\n                                <td><Text id='races.race-time'>Racetime</Text></td>\n                                <td><i class='fas fa-clock' /></td>\n                                <td class='text-right'><nobr>{util.secToHms(totals.duration) || 'n/a'}</nobr></td>\n                            </tr>\n                            <tr>\n                                <td><i class='fas fa-bed' /></td>\n                                <td><Text id='races.rest-time'>Rest</Text></td>\n                                <td><i class='fas fa-clock' /></td>\n                                <td class='text-right'><nobr>{util.secToHms(totals.rest) || 'n/a'}</nobr></td>\n                            </tr>\n                        </tbody>\n                    </table>\n                </div>\n            </>}\n\n\n            {isAdmin && <div style='max-height: 200px; max-width: 70vw; overflow: auto;'>\n                <button class='btn btn-link btn-block' onClick={this.toggleAdminInfo}>\n                    Toggle admin info\n                </button>\n                {showAdminInfo && <>                \n                    <small>\n                        <xmp>\n                            {JSON.stringify(musher, null, 4)}\n                            {JSON.stringify(user, null, 4)}\n                            {JSON.stringify(team, null, 4)}\n                            {JSON.stringify(totals, null, 4)}\n\n                            {/* {\n                                \"firstDate\": \"2021-03-19 11:59\",\n                                \"lastDate\": \"2021-03-20 17:13\",\n                                \"firstEpoch\": 1616151540000,\n                                \"lastEpoch\": 1616256780000,\n                                \"now\": {\n                                    \"$numberDecimal\": \"1642675856939\"\n                                },\n                                \"totalTimeUsedSec\": 26524316,\n                                \"totalWorkoutTimeUsedSec\": 130895,\n                                \"lastDuration\": 25655,\n                                \"team\": 84,\n                                \"count\": 4,\n                                \"distanceKm\": 301.5906237951766,\n                                \"elevation\": 3610.019075719202,\n                                \"duration\": 77343,\n                                \"rest\": 1332,\n                                \"speedAvg\": 8.294634979660305,\n                                \"totalRest\": 54884,\n                                \"loadIndex\": 1080.75,\n                                \"totalKcalRelated\": 544.535560976128,\n                                \"weightedTotalKcal\": 12303.171406247127,\n                                \"flatTotalKcal\": 9424.70699359927,\n                                \"firstGpxStartEpoch\": null,\n                                \"lastGpxStartEpoch\": null\n                            } */}\n\n                        </xmp>\n                    </small>\n                </>}\n            </div>}\n        </>);\n    }\n}\n\n@observer\nclass AppRaceDetailTracking extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n            reloadLastEpoch: Math.floor(new Date().getTime() / 1000),\n        };\n        this.updateTimer = {};\n    }\n\n    loadLiveRaceResults = async (props = this.props, focusOnMushers) => {\n        const { raceStore } = props.stores;\n        const { race } = raceStore;\n        await raceStore.getRaceTrackerData(race.raceTrackerRace);\n        raceStore.getRaceTrackerActiveTeams();\n    }\n\n    loadRaceResults = async (props = this.props, teamIds, focusOnMushers) => {\n        const { raceStore } = props.stores;\n        const { raceid } = props;\n\n        await raceStore.loadWorkoutSummary(teamIds, raceid);\n        raceStore.getWorkoutSummaryActiveTeams(focusOnMushers);\n    }\n\n    loadRace = async (props = this.props) => {\n        this.setState({ isLoading: true });\n        const { raceStore, appState } = props.stores;\n        const { raceid } = props;\n        await raceStore.load(raceid);\n        const { race } = raceStore;\n        const { focusOnMushers } = appState;\n\n        const allTeamIds = race.classes.filter(currentClass => currentClass.contestants && currentClass.contestants.length > 0).map((currentClass) => {\n            return currentClass.contestants.filter(musher => musher.team > 0).map(musher => musher.team);\n        }).flat();\n\n        if (allTeamIds.length > 0) {\n            await raceStore.loadTeams(allTeamIds.join(','));\n            if (race.liveRace > 0) {\n                await this.loadLiveRaceResults(props, focusOnMushers);\n\n            } else {\n                await this.loadRaceResults(props, allTeamIds.join(','), focusOnMushers);\n            }\n        }\n        raceStore.getAllClassesSortedBy();\n\n        // Set reload timer\n        clearTimeout(this.updateTimer.reload);\n        this.updateTimer.reload = setTimeout(async () => {\n            const reloadLastEpoch = Math.floor(new Date().getTime() / 1000);\n            this.setState({ reloadLastEpoch });\n            this.loadRace(props);\n        }, RELOAD_INTERVAL_IN_SEC * 1000);\n\n        this.setState({ isLoading: false });\n    }\n\n    setLeaderboardMode = (e) => {\n        const leaderboardMode = e.target.parentElement.dataset.mode || e.target.dataset.mode;\n        this.setState({ leaderboardMode })\n    }\n\n    chooseRaceClass = (e) => {\n        const filterByraceClass = e.target.value;\n        this.setState({ filterByraceClass })\n    }\n\n    toggleShowLeaderBoard = (hide) => {\n        const { showLeaderBoard } = this.state;\n        if (hide === true) {\n            this.setState({ showLeaderBoard: false });\n        } else {\n            this.setState({ showLeaderBoard: !showLeaderBoard });\n        }\n    }\n\n    toggleShowNews = (hide) => {\n        const { showNews } = this.state;\n        if (hide === true) {\n            this.setState({ showNews: false });\n        } else {\n            this.setState({ showNews: !showNews });\n        }\n    }\n\n    componentWillUnmount() {\n        clearTimeout(this.updateTimer.reload);\n        clearTimeout(this.updateTimer.tick);\n    }\n\n    componentDidMount() {\n        this.loadRace();\n        const { width, height } = getWindowDimensions();\n        if (width < 800) {\n            this.toggleShowLeaderBoard(true);\n            this.toggleShowNews(true);\n        }\n    }\n\n    onMarkerClick = ({ title, bib, email, e }) => {\n        const { showModal } = this.state;\n        this.setState({\n            showModal: !showModal,\n            modalTitle: title,\n            modalBib: bib,\n            modalEmail: email,\n        });\n    }\n\n    toggleModal = () => {\n        const { showModal } = this.state;\n        this.setState({\n            showModal: !showModal,\n        });\n    }\n\n    // Overlay functions\n    onTeamClick = (e, teamid) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.setState({\n            showTeam: teamid,\n        });\n        return false;\n    }\n\n    hideTeam = () => {\n        this.setState({\n            showTeam: null,\n        });\n    }\n\n    onUserClick = (e, userid) => {\n        e.preventDefault();\n        e.stopPropagation();\n        return false;\n    }\n\n    onDogClick = (e, dogid, dogs) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.setState({\n            showDog: dogid,\n            dogs,\n        });\n        return false;\n    }\n\n    hideDog = () => {\n        this.setState({\n            showDog: null,\n        });\n    }\n\n    // /Overlay functions\n\n    back = () => {\n        const { history } = this.props.stores;\n        history.goBack();\n    }\n\n    render() {\n        const { userStore, raceStore, appState } = this.props.stores;\n        const { user = {}, teams = [], isAdmin } = userStore;\n        const { language = 'en' } = user;\n\n        const { raceid, path } = this.props;\n        const { focusOnMushers = [], infoOnMushers = [] } = appState;\n        const { leaderboardMode, filterByraceClass, showLeaderBoard, showNews, reloadLastEpoch,\n            showModal, modalTitle, modalBib, modalEmail,\n            showTeam, showDog,\n        } = this.state;\n\n        const { activeTeams, teamList, waypoints, waypoints2, waypoints3, zoomToMarkers, classes, race, racetrackerData } = raceStore;\n\n        const musher = modalBib ? raceStore.getMusherByBibId(modalBib) : raceStore.getMusherByBibEmail(modalEmail);\n        const team = raceStore.getTeamById(musher.team);\n\n        return (<>\n            {showTeam && <Overlay>\n                <TeamsPublicDetail stores={this.props.stores} teamid={showTeam} marginTop={'0px;'} marginBottom={'0px;'} back={this.hideTeam} hideTeam={this.hideTeam} />\n            </Overlay>}\n            {showDog && <Overlay>\n                <DogPublicDetail stores={this.props.stores} dogid={showDog} marginTop={'0px;'} marginBottom={'0px;'} back={this.hideDog} dogs={team.dogs} />\n            </Overlay>}\n        \n            <div class='container-fluid position-relative p-0' style={`margin-top: ${MARGIN_TOP}; height: calc(100vh - ${'130px'});`}>\n                <Trackmap\n                    stores={this.props.stores}\n                    raceid={raceid}\n                    waypoints={waypoints}\n                    waypoints2={waypoints2}\n                    waypoints3={waypoints3}\n                    zoomToMarkers={zoomToMarkers}\n                    fullscreenMap={true}\n                    onMarkerClick={this.onMarkerClick}\n                    // key={`heatmap-${racetrackerData.map(e => e.bib).join('-')}`}\n                    // mapid={`heatmap-${racetrackerData.map(e => e.bib).join('-')}`}\n                />\n\n                <div class='position-absolute' style='top: 15px; left: 50px; z-index: 9999;'>\n                    <button class='btn btn-link pl-0 fixed-top text-primary'\n                        style={`top: ${MARGIN_TOP_BACK}; left: 5px; font-size: 35px; width: 45px;`}\n                        onClick={this.back}>\n                        <i class='fas fa-arrow-circle-left' />\n                    </button>\n                    <div class='logo ml-3 clearfix text-white'>\n                        <img src={`./assets/homerun-race-logo-2-small.png`} height='37' class='float-left' />\n                        <a href={`/app-races/${race.id}/results`}>\n                            <span class='font-weight-bold text-dark' style='font-size: 1.4em;'>{race.title}</span>\n                        </a>\n                    </div>\n                </div>\n\n                <div class='position-absolute' style='top: 55px; left: 5px; z-index: 9999; width: 30px; height: 30px;'>\n                    <ReloadTimer stores={this.props.stores} classNames='float-right ml-2' reloadLastEpoch={reloadLastEpoch} />\n                </div>\n                {showModal && <>\n                    <div\n                        class='position-absolute'\n                        style='top: 0px; left: 0px; z-index: 9999; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3);'\n                        onClick={this.toggleModal}\n                    >\n                        <div\n                            class='position-absolute bg-light border rounded rounded-lg pt-5 pb-3 px-2'\n                            style='top: 50%; left: 50%; transform: translate(-50%, -50%); width: 80vw; max-width: 80vw; max-height: 80vh; overflow: auto;'\n                        >\n                            <button class='btn btn-link float-right position-absolute' style='top: 0px; right: 0px;'>\n                                Close\n                            </button>\n\n                            <MusherInfo\n                                stores={this.props.stores}\n                                bib={modalBib}\n                                email={modalEmail}\n                                onTeamClick={this.onTeamClick}\n                                onUserClick={this.onUserClick}\n                                onDogClick={this.onDogClick}\n                            />\n                        </div>\n                    </div>\n                </>}\n            </div>\n        </>);\n    }\n}\n\nexport default AppRaceDetailTracking;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport { toJS } from 'mobx'\n\nimport Map from '../../components/map';\n\nimport mu from '../../lib/musher-util';\n\nconst initialState = {\n\tshowAddComment: false,\n};\n\n@observer\nclass Trackmap extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n        this.updateTimer = {};\n\t\tthis.inputRef = {};\n    }\n\n\tasync loadTrack() {\n\t\t// this.setState({ isLoading: true });\n\t\t// const { adminStore } = this.props.stores;\n        // const { raceid } = this.props;\n        // await adminStore.getPublicHeatmap(raceid);\n\t\t// this.setState({ isLoading: false });\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.loadTrack();\n\t}\n\n    // componentWillReceiveProps() {\n\t// \tthis.loadHeatmap();\n\t// }\n\n    render() {\n        const { trackStore } = this.props.stores;\n        const { waypoints, waypoints2, waypoints3, zoomToMarkers, mapid, fullscreenMap, onMarkerClick } = this.props;\n        const { publicHeatmap: heatmap } = trackStore;\n        // const heatmap = publicHeatmap.slice(0, 10);\n        // const heatmap = [[60.4433,8.8996,14],[61.384,9.1152,14],[60.42,8.9422,15]];\n\n        return (\n            <>\n                {/* heatmap: {`map-${mapid}`}<br /> */}\n                {/* {JSON.stringify(heatmap)} */}\n                <Map\n                    stores={this.props.stores}\n                    mapId={mapid}\n                    // heatmap={heatmap}\n                    minZoom={2}\n                    maxZoom={18}\n                    height={600}\n                    waypoints={waypoints}\n                    waypoints2={waypoints2}\n                    waypoints3={waypoints3}\n                    zoomToMarkers={zoomToMarkers}\n                    fullscreenMap={fullscreenMap}\n                    onMarkerClick={onMarkerClick}\n                    key={`map-${mapid}`}\n                />\n            </>\n        );\n    }\n}\n\nexport default Trackmap;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport { route } from 'preact-router';\nimport Markdown from 'preact-markdown';\nimport linkstate from 'linkstate';\n\nimport mu from '../../lib/musher-util';\n\n@observer\nclass AppRaceDetailNotifications extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n        };\n\t\tthis.inputRef = {};\n        this.updateTimer = {};\n    }\n\n    subscribeNotificationTopic = async (field) => {\n\t\tconst { userStore } = this.props.stores;\n        const { user } = userStore;\n        const { notificationTopics = {} } = user;\n        const value = 1;\n        await userStore.setNotificationTopic({\n            field: `notificationTopics.${field}`,\n            value,\n        });\n    }\n\n    render() {\n\t\tconst { userStore, raceStore, appState } = this.props.stores;\n\t\tconst { user = {}, teams = [], isAdmin } = userStore;\n        const { language = 'en' } = user;\n        const { notificationTopics = {} } = user;\n\n\t\tconst { race = {} } = this.props;\n\n        const topic = `race-${race.id}`;\n        if (notificationTopics && notificationTopics[topic]) {\n            return '';\n        }\n\n        return (<>\n            <div class='row'>\n                <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2'>\n                    <button class='btn btn-block btn-info btn-lg' onClick={() => this.subscribeNotificationTopic(topic)}>\n                        <i class='fas fa-bell' /> <Text id='race.notifications'>Subscribe to race notifications</Text>\n                    </button>\n                </div>\n            </div>\n        </>);\n    }\n}\n\nexport default AppRaceDetailNotifications;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport { route } from 'preact-router';\nimport Markdown from 'preact-markdown';\nimport linkstate from 'linkstate';\n\nimport Images from '../../components/form/images';\n\nimport StoryAdd from '../../components/story/add';\nimport StoryPublicFeed from '../../components/story/publicFeed';\n\nimport mu from '../../lib/musher-util';\n\n@observer\nclass AppRaceDetailUserImages extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            newRaceUserImage: {},\n        };\n\t\tthis.inputRef = {};\n        this.updateTimer = {};\n    }\n\n\taddRaceUserImage = async () => {\n        const { race = {} } = this.props;\n        const raceid = race.id;\n        const { raceStore } = this.props.stores;\n\t\tconst { newRaceUserImage } = this.state;\n\t\tawait raceStore.addUserImage({ id: raceid, newUserImage: newRaceUserImage });\n\t\tthis.setState({\n\t\t\tnewRaceUserImage: {},\n\t\t});\n\t}\n\n\tupdateUserImageUpload = ({ field, value }) => {\n\t\t// updateField({ id: object.id, field: 'images', value: images, skipTimer: true });\n\t\tconst { newRaceUserImage } = this.state;\n\t\tnewRaceUserImage[field] = value;\n\t\tthis.setState({ newRaceUserImage });\n\t}\n\n\tremoveRaceUserImage = async (e) => {\n\t\tconst id = e.target.parentElement.dataset.id || e.target.dataset.id;\n        const { race = {} } = this.props;\n        const raceid = race.id;\n        const { raceStore } = this.props.stores;\n\t\tawait raceStore.removeUserImage({\n\t\t\tid: raceid,\n\t\t\tuserImageId: id,\n\t\t});\n\t}\n\n\teditRaceUserImage = async (e) => {\n\t\tconst { id, field } = e.target.dataset;\n\t\tconst { value } = e.target;\n        const { race = {} } = this.props;\n        const raceid = race.id;\n\t\tconst { raceStore } = this.props.stores;\n\t\tconst data = {\n\t\t\traceUserImageId: id,\n\t\t\t[`raceUserImage${util.ucfirst(field)}`]: value,\n\t\t};\n\t\tclearTimeout(this.updateTimer[`${raceid}-${id}-${field}`]);\n\t\tthis.updateTimer[`${raceid}-${id}-${field}`] = setTimeout(async () => {\n\t\t\traceStore.editUserImage({\n\t\t\t\tid: raceid,\n\t\t\t\tdata,\n\t\t\t});\n\t\t}, 1500);\n\n\t\tthis.resizeTextarea(e.target);\n\t}\n\n    resizeTextarea = (el) => {\n\t\tlet element = el;\n\t\tif (element.target) {\n\t\t\telement = el.target;\n\t\t}\n\t\tconst { scrollHeight } = element;\n\t\telement.style.height = `${scrollHeight}px`;\n\t}\n\n    handleImageErrored = (e) => {\n        const image = e.target;\n        image.onerror = null;\n        setTimeout(() => {\n            image.src += `?${new Date()}`;\n        }, 1000);\n    }\n\n    render() {\n        const { newRaceUserImage = {} } = this.state;\n\t\tconst { userStore, raceStore, appState } = this.props.stores;\n\t\tconst { user = {}, teams = [], isAdmin } = userStore;\n        const { language = 'en' } = user;\n\n\t\tconst { race = {} } = this.props;\n        const tags = ['photos'];\n        if (race.tag) {\n            race.tag.split(',').forEach(tag => {\n                tags.push(tag.trim());\n            })\n        }\n\n        return (<>\n            {user.id && <StoryAdd stores={this.props.stores} hashTags={tags} postfix={`[ ${race.title}: Images](/app-races/${race.id}/userImages)`} topic={`race-${race.id}`} />}\n\n            <StoryPublicFeed stores={this.props.stores} hashtags={tags} />\n\n            {/* <div class='row'>\n                <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2'>\n                    <h2 class='mb-0'><Text id='race.user-images'>User images</Text></h2>\n                </div>\n                <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2'>\n                    <div class='row'>\n                        {race.userImages && race.userImages.reverse().map(currentUserImage => <>\n                            <div class='col-12 col-sm-12 col-md-6 col-lg-6 col-xl-4 p-3 position-relative mb-3'>\n                                {isAdmin && <>\n                                    <button class='btn btn-danger position-absolute' style='top:5px; right: 5px;' data-id={currentUserImage.id} onClick={this.removeRaceUserImage}>\n                                        <i class='fas fa-times' />\n                                    </button>\n                                </>}\n\n                                <div class='clearfix'>\n                                    <img src={currentUserImage.image.s3LargeLink} class='img-fluid rounded-lg mb-2' />\n                                </div>\n                                <div class='clearfix'>\n                                    <h5 class='mb-0'>{currentUserImage.title}</h5>\n                                    <small class='text-muted'> {util.formatDate(currentUserImage.date, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</small><br />\n                                </div>\n                                <div class='clearfix'>\n                                    <Markdown markdown={mu.replaceImages(currentUserImage.body, currentUserImage.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                                </div>\n\n                                {isAdmin && <>\n                                    <div class='border-top border-bottom mb-5'>\n                                        <details>\n                                            <summary>Admin edit</summary>\n                                            <h5 class='border-bottom'>Admin UserImage Edit</h5>\n                                            {['title'].map(field => <>\n                                                <div class='form-group '>\n                                                    <label for={field}>{field}</label>\n                                                    <input type='text' class='form-control font-weight-bold' id={field} aria-describedby={`${field}Help`}\n                                                        style='font-size: 1.5em;'\n                                                        data-id={currentUserImage.id}\n                                                        data-field={field}\n                                                        value={currentUserImage[field]}\n                                                        onInput={this.editRaceUserImage}\n                                                    />\n                                                </div>\n                                            </>)}\n                                            {['body'].map(field => <>\n                                                <div class='form-group'>\n                                                    <label for={field}>{field}</label>\n                                                    <textarea type='textarea' class='form-control' id={field} aria-describedby={`${field}Help`}\n                                                        data-id={currentUserImage.id}\n                                                        data-field={field}\n                                                        value={currentUserImage[field]}\n                                                        onInput={this.editRaceUserImage}\n                                                        style='height: 3em;'\n                                                    />\n                                                </div>\n                                            </>)}\n                                        </details>\n                                    </div>\n                                </>}\n                            </div>\n                        </>)}\n                        {isAdmin && <>\n                            <div class='col-12 border rounded-lg m-2 p-3 bg-light'>\n                                <h5>Add new user image</h5>\n                                <div class='row'>\n                                    <div class='col'>\n                                        {newRaceUserImage && newRaceUserImage.image && <img src={newRaceUserImage.image.s3LargeLink} class='float-right w-50'  onError={this.handleImageErrored} />}\n                                        {['title'].map(field => <>\n                                            <div class='form-group'>\n                                                <label for={field}>{field}</label>\n                                                <input type='text' class='form-control' id={field} aria-describedby={`${field}Help`}\n                                                    onInput={linkstate(this, `newRaceUserImage.${field}`)}\n                                                    value={newRaceUserImage[field]}\n                                                />\n                                            </div>\t\t\t\t\t\t\t\t\t\t\n                                        </>)}\n                                        {['body'].map(field => <>\n                                            <div class='form-group'>\n                                                <label for={field}>{field}</label>\n                                                <textarea type='text' class='form-control' id={field} aria-describedby={`${field}Help`}\n                                                    onInput={linkstate(this, `newRaceUserImage.${field}`)}\n                                                    onKeyUp={this.resizeTextarea}\n                                                    style='height: 3em;'\n                                                    value={newRaceUserImage[field]}\n                                                />\n                                            </div>\t\t\t\t\t\t\t\t\t\t\n                                        </>)}\n                                    </div>\n                                </div>\n                                <Images saved={{}} object={{}} field={'image'} updateField={this.updateUserImageUpload} autoOpen={false} />\n                                <button class='btn btn-info' onClick={this.addRaceUserImage}>Add race user image</button>\n                            </div>\n                        </>}\n                    </div>\n                </div>\n            </div> */}\n        </>);\n    }\n}\n\nexport default AppRaceDetailUserImages;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport { route } from 'preact-router';\nimport Markdown from 'preact-markdown';\nimport linkstate from 'linkstate';\n\nimport Images from '../../components/form/images';\n\nimport StoryAdd from '../../components/story/add';\nimport StoryPublicFeed from '../../components/story/publicFeed';\n\nimport mu from '../../lib/musher-util';\n\n@observer\nclass AppRaceDetailNews extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            newRaceArticle: {},\n        };\n\t\tthis.inputRef = {};\n        this.updateTimer = {};\n    }\n\n    addRaceArticle = async () => {\n\t\tconst { race = {} } = this.props;\n        const raceid = race.id;\n        const { raceStore } = this.props.stores;\n\t\tconst { newRaceArticle } = this.state;\n\t\tawait raceStore.addArticle({ id: raceid, newArticle: newRaceArticle });\n\t\tthis.setState({\n\t\t\tnewRaceArticle: {},\n\t\t});\n\t}\n\n    editRaceArticle = async (e) => {\n\t\tconst { id, field } = e.target.dataset;\n\t\tconst { value } = e.target;\n\t\tconst { race = {} } = this.props;\n        const raceid = race.id;\n\t\tconst { raceStore } = this.props.stores;\n\t\tconst data = {\n\t\t\traceArticleId: id,\n\t\t\t[`raceArticle${util.ucfirst(field)}`]: value,\n\t\t};\n\t\tclearTimeout(this.updateTimer[`${raceid}-${id}-${field}`]);\n\t\tthis.updateTimer[`${raceid}-${id}-${field}`] = setTimeout(async () => {\n\t\t\traceStore.editArticle({\n\t\t\t\tid: raceid,\n\t\t\t\tdata,\n\t\t\t});\n\t\t}, 1500);\n\n\t\tthis.resizeTextarea(e.target);\n\t}\n\n    removeRaceArticle = async (e) => {\n\t\tconst id = e.target.parentElement.dataset.id || e.target.dataset.id;\n\t\tconst { race = {} } = this.props;\n        const raceid = race.id;\n        const { raceStore } = this.props.stores;\n\t\tawait raceStore.removeArticle({\n\t\t\tid: raceid,\n\t\t\tarticleId: id,\n\t\t});\n\t}\n\n    updateArticleUpload = ({ field, value }) => {\n\t\t// updateField({ id: object.id, field: 'images', value: images, skipTimer: true });\n\t\tconst { newRaceArticle } = this.state;\n\t\tnewRaceArticle[field] = value;\n\t\tthis.setState({ newRaceArticle });\n\t}\n\n    resizeTextarea = (el) => {\n\t\tlet element = el;\n\t\tif (element.target) {\n\t\t\telement = el.target;\n\t\t}\n\t\tconst { scrollHeight } = element;\n\t\telement.style.height = `${scrollHeight}px`;\n\t}\n\n    handleImageErrored = (e) => {\n        const image = e.target;\n        image.onerror = null;\n        setTimeout(() => {\n            image.src += `?${new Date()}`;\n        }, 1000);\n    }\n\n    render() {\n        const { newRaceArticle } = this.state;\n\t\tconst { userStore, raceStore, appState } = this.props.stores;\n\t\tconst { user = {}, teams = [], isAdmin } = userStore;\n        const { language = 'en' } = user;\n\n\t\tconst { race = {} } = this.props;\n\n        const tags = ['news'];\n        if (race.tag) {\n            race.tag.split(',').forEach(tag => {\n                tags.push(tag.trim());\n            })\n        }\n\n        return (<>\n            {user.id && <StoryAdd stores={this.props.stores} hashTags={tags} postfix={`[ ${race.title}: News](/app-races/${race.id}/news)`} topic={`race-${race.id}`} />}\n\n            <StoryPublicFeed stores={this.props.stores} hashtags={tags} />\n\n            {/* <div class='row'>\n                <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2'>\n                    <h2 class='mb-0'><Text id='race.news'>Nyheter</Text></h2>\n                </div>\n                <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2'>\n                    <div class='row'>\n                        {race.articles && race.articles.reverse().map(currentArticle => <>\n                            <div class='col-12 col-sm-12 col-md-6 col-lg-6 col-xl-4 p-3 position-relative mb-3'>\n                                <h5 class='mb-0'>{mu.replaceImages(currentArticle.title, race.images, language, false)}</h5>\n                                <small class='text-muted'> {util.formatDate(currentArticle.date, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</small><br />\n                                {currentArticle.image && <img src={currentArticle.image.s3LargeLink} class='float-right w-50 rounded-lg ml-2' />}\n                                <div class='font-weight-bold'>\n                                    <Markdown markdown={mu.replaceImages(currentArticle.ingress, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                                </div>\n                                <div class='clearfix'>\n                                    <Markdown markdown={mu.replaceImages(currentArticle.body, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                                </div>\n\n                                {isAdmin && <>\n                                    <div class='border-top border-bottom mb-5'>\n                                        <details>\n                                            <summary>Admin edit</summary>\n                                            <h5 class='border-bottom'>Admin News Edit</h5>\n                                            {['title'].map(field => <>\n                                                <div class='form-group'>\n                                                    <label for={field}>{field}</label>\n                                                    <input type='text' class='form-control font-weight-bold' id={field} aria-describedby={`${field}Help`}\n                                                        style='font-size: 1.5em;'\n                                                        data-id={currentArticle.id}\n                                                        data-field={field}\n                                                        value={currentArticle[field]}\n                                                        onInput={this.editRaceArticle}\n                                                    />\n                                                </div>\n                                            </>)}\n                                            {['ingress', 'body'].map(field => <>\n                                                <div class='form-group'>\n                                                    <label for={field}>{field}</label>\n                                                    <textarea type='textarea' class='form-control' id={field} aria-describedby={`${field}Help`}\n                                                        data-id={currentArticle.id}\n                                                        data-field={field}\n                                                        value={currentArticle[field]}\n                                                        onInput={this.editRaceArticle}\n                                                        style='height: 3em;'\n                                                    />\n                                                </div>\n                                            </>)}\n                                        </details>\n                                    </div>\n                                </>}\n                            </div>\n                        </>)}\n                    </div>\n                </div>\n                {isAdmin && <>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2'>\n                        <h5>Add new article</h5>\n                        {newRaceArticle && newRaceArticle.image && <img src={newRaceArticle.image.s3LargeLink} class='float-right w-50'  onError={this.handleImageErrored} />}\n\n                        {['title'].map(field => <>\n                            <div class='form-group'>\n                                <label for={field}>{field}</label>\n                                <input type='text' class='form-control' id={field} aria-describedby={`${field}Help`}\n                                    onInput={linkstate(this, `newRaceArticle.${field}`)}\n                                    value={newRaceArticle[field]}\n                                />\n                            </div>\t\t\t\t\t\t\t\t\t\t\n                        </>)}\n                        {['ingress', 'body'].map(field => <>\n                            <div class='form-group'>\n                                <label for={field}>{field}</label>\n                                <textarea type='text' class='form-control' id={field} aria-describedby={`${field}Help`}\n                                    onInput={linkstate(this, `newRaceArticle.${field}`)}\n                                    onKeyUp={this.resizeTextarea}\n                                    style='height: 3em;'\n                                    value={newRaceArticle[field]}\n                                />\n                            </div>\t\t\t\t\t\t\t\t\t\t\n                        </>)}\n                        <Images saved={{}} object={{}} field={'image'} updateField={this.updateArticleUpload} autoOpen={false} />\n                        <button class='btn btn-info' onClick={this.addRaceArticle}>Add race article</button>\n                    </div>\n                </>}\n            </div> */}\n        </>);\n    }\n}\n\nexport default AppRaceDetailNews;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport { route } from 'preact-router';\nimport Markdown from 'preact-markdown';\nimport linkstate from 'linkstate';\n\nimport mu from '../../lib/musher-util';\n\n@observer\nclass AppRaceDetailSignup extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n        };\n\t\tthis.inputRef = {};\n        this.updateTimer = {};\n    }\n\n\tsignupToRace = async () => {\n\t\tconst { raceStore, userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n        const { signup } = raceStore;\n        const { race = {} } = this.props;\n        const raceid = race.id;\n\n\t\tawait raceStore.addContestant({\n\t\t\tid: raceid,\n\t\t\tclassId: signup.class,\n\t\t\tnewContestant: {\n\t\t\t\tteam: user.team,\n\t\t\t\tfirstname: user.firstname,\n\t\t\t\tlastname: user.lastname,\n\t\t\t\tsportsClub: user.sportsClub,\n\t\t\t\temail: user.email,\n\t\t\t\tcellphone: user.cellphone,\n\t\t\t\tfacebook: user.facebook,\n\t\t\t\tinstagram: user.instagram,\n\t\t\t\t ...signup\n\t\t\t}\n        });\n\t}\n\n    updateSignup = (e) => {\n        const key = e.target.id;\n        const value = e.target.value;\n        const { raceStore } = this.props.stores;\n        raceStore.updateObjectKeyValue('signup', key, value);\n    }\n\n    editSignup = (e) => {\n        const { race = {} } = this.props;\n        const raceid = race.id;\n\n        const { raceStore } = this.props.stores;\n        const field = e.target.id;\n        const value = e.target.value;\n        const { classid, contestantid } = e.target.dataset;\n        raceStore.updateObjectKeyValue('signup', field, value);\n\n        // console.log({ raceid, field, value, classid });\n        // const { raceStore } = this.props.stores;\n        // raceStore.updateObjectKeyValue('signup', key, value);\n\n        const data = {\n\t\t\traceClassId: classid,\n            contestantId: contestantid,\n\t\t\t[`raceClassContestant${util.ucfirst(field)}`]: value,\n\t\t};\n\t\tclearTimeout(this.updateTimer[field]);\n\t\tthis.updateTimer[field] = setTimeout(async () => {\n\t\t\traceStore.editClass({\n\t\t\t\tid: raceid,\n\t\t\t\tdata,\n\t\t\t});\n            raceStore.localUpdateSignup(field, value);\n            if (field === 'team') {\n                await raceStore.loadTeams(value, true);\n            }\n\t\t}, 500);\n    }\n\n    render() {\n\t\tconst { userStore, raceStore, appState } = this.props.stores;\n\t\tconst { user = {}, teams = [], isAdmin } = userStore;\n        const { language = 'en' } = user;\n\n\t\tconst { race = {} } = this.props;\n        const { signup } = raceStore;\n\n        let signupClass = {};\n        let dogs = [];\n        if (signup.class) {\n            signupClass = raceStore.getRaceClassById(signup.class);\n        }\n        if (signup.team) {\n            dogs = userStore.findDogsByTeam(parseInt(signup.team, 10));\n        }\n        const { vaccineLogStatuses } = userStore;\n\t\tconst today = new Date();\n\n        return (<>\n            <div class='row'>\n                <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2'>\n                    <h2 class='mb-0'><Text id='races.signup'>Pmelding</Text></h2>\n                </div>\n                <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2'>\n                    {today >= new Date(race.signupStartDate) && today <= new Date(race.signupEndDate) ? <>\n                        <span class='font-weight-lighter'><Text id='races.signed-in-as'>Logget inn som</Text>:</span> {user.email}<br /><br />\n                        {signup.id ? <>\n                            <div class='font-weight-bold mb-4'>\n                                <i class='fas fa-check text-success' /> <Text id='races.signed-up'>Din bruker er pmeldt!</Text><br />\n                                {/* <xmp>{JSON.stringify(signup, null, 4)}</xmp> */}\n                            </div>\n\n                            {!race.liveRace && race.signuppayment && <>\n                                <div class='form-group row my-2'>\n                                    <label for='cellphone' class='col-2 col-form-label text-right font-weight-lighter'><Text id='races.signup'>Pmelding</Text></label>\n                                    <div class='col-10'>\n                                        {signup.paidSignupfee ? <div class='py-2'>\n                                            <Text id='races.paid'>Betalt</Text>: {util.formatDate(signup.paidSignupfee)}\n                                            <i class='fas fa-check text-success ml-3' />\n                                        </div> : <>\n                                            <div class='alert alert-danger mb-1' role='alert'>\n                                                <h5>\n                                                    <span class='font-weight-lighter'><Text id='races.payment-info'>Betaling pmelding</Text>:</span><br />\n                                                    <Markdown markdown={mu.replaceImages(race.signuppayment, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                                                    {signupClass.signupfee || race.signupfee} NOK\n                                                </h5>\n                                            </div>\n                                        </>}\n                                    </div>\n                                </div>\n                            </>}\n\n                            <div class='clearfix mt-2'>\n                                <span class='font-weight-lighter float-right'><Text id='races.click-to-change'>Click the fields to edit.</Text></span>\n                            </div>\n\n                            <div class='form-group row my-2'>\n                                <label for='cellphone' class='col-3 col-form-label text-right font-weight-lighter'><Text id='races.cellphone'>Mobil</Text></label>\n                                <div class='col-9'>\n                                    <Localizer>\n                                        <input type='text' class='form-control' id='cellphone'\n                                            data-classid={signup.class}\n                                            data-contestantid={signup.id}\n                                            onInput={this.editSignup}\n                                            value={signup.cellphone}\n                                            placeholder={<Text id='races.cellphone-help'>Hva er mobilnummer ditt?</Text>}\n                                        />\n                                    </Localizer>\n                                </div>\n                            </div>\n                            {signup.name && <div class='form-group row my-2'>\n                                <label for='name' class='col-3 col-form-label text-right font-weight-lighter'><Text id='races.name'>Navn</Text></label>\n                                <div class='col-9'>\n                                    {signup.name}\n                                </div>\n                            </div>}\n                            <div class='form-group row my-2'>\n                                <label for='firstname' class='col-3 col-form-label text-right font-weight-lighter'><Text id='races.firstname'>Fornavn</Text></label>\n                                <div class='col-9'>\n                                    <Localizer>\n                                        <input type='text' class='form-control' id='firstname'\n                                            data-classid={signup.class}\n                                            data-contestantid={signup.id}\n                                            onInput={this.editSignup}\n                                            value={signup.firstname}\n                                            placeholder={<Text id='races.firstname-help'>Hva er fornavnet ditt?</Text>}\n                                        />\n                                    </Localizer>\n                                </div>\n                            </div>\n                            <div class='form-group row my-2'>\n                                <label for='lastname' class='col-3 col-form-label text-right font-weight-lighter'><Text id='races.lastname'>Etternavn</Text></label>\n                                <div class='col-9'>\n                                    <Localizer>\n                                        <input type='text' class='form-control' id='lastname'\n                                            data-classid={signup.class}\n                                            data-contestantid={signup.id}\n                                            onInput={this.editSignup}\n                                            value={signup.lastname}\n                                            placeholder={<Text id='races.lastname-help'>Hva er etternavnet ditt?</Text>}\n                                        />\n                                    </Localizer>\n                                </div>\n                            </div>\n                            <div class='form-group row my-2'>\n                                <label for='sportsClub' class='col-3 col-form-label text-right font-weight-lighter'><Text id='races.sportsclub'>Klubb</Text></label>\n                                <div class='col-9'>\n                                    <Localizer>\n                                        <input type='text' class='form-control' id='sportsClub'\n                                            data-classid={signup.class}\n                                            data-contestantid={signup.id}\n                                            onInput={this.editSignup}\n                                            value={signup.sportsClub}\n                                            placeholder={<Text id='races.sportsClub-help'>Hvilken klubb tilhrer du?</Text>}\n                                        />\n                                    </Localizer>\n                                </div>\n                            </div>\n                            <div class='form-group row my-2'>\n                                <label for='facebook' class='col-3 col-form-label text-right font-weight-lighter'><Text id='races.facebook'>Facebook</Text></label>\n                                <div class='col-9'>\n                                    <Localizer>\n                                        <input type='text' class='form-control' id='facebook'\n                                            data-classid={signup.class}\n                                            data-contestantid={signup.id}\n                                            onInput={this.editSignup}\n                                            value={signup.facebook}\n                                            placeholder={<Text id='races.facebook-help'>Hva er Facebook brukernavnet ditt?</Text>}\n                                        />\n                                    </Localizer>\n                                </div>\n                            </div>\n                            <div class='form-group row my-2'>\n                                <label for='instagram' class='col-3 col-form-label text-right font-weight-lighter'><Text id='races.instagram'>Instagram</Text></label>\n                                <div class='col-9'>\n                                    <Localizer>\n                                        <input type='text' class='form-control' id='instagram'\n                                            data-classid={signup.class}\n                                            data-contestantid={signup.id}\n                                            onInput={this.editSignup}\n                                            value={signup.instagram}\n                                            placeholder={<Text id='races.instagram-help'>Hva er Instagram brukernavnet ditt?</Text>}\n                                        />\n                                    </Localizer>\n                                </div>\n                            </div>\n                            <div class='form-group row my-2'>\n                                <label for='team' class='col-3 col-form-label text-right font-weight-lighter'><Text id='races.team'>Team</Text></label>\n                                <div class='col-9'>\n                                    <select class='form-control' id='team' aria-describedby='teamHelp'\n                                        data-classid={signup.class}\n                                        data-contestantid={signup.id}\n                                        onInput={this.editSignup}\n                                        value={signup.team}\n                                    >\n                                        <option value=''>-- <Text id='races.choose-team'>Velg team</Text> --</option>\n                                        {teams.map(team =>\n                                            <option value={team.id}>{team.name}</option>\n                                        )}\n                                    </select>\n                                    {/* <details>\n                                        <summary>\n                                            <i class='fas fa-info-circle' /> <Text id='races.team-about'>About teams</Text>\n                                        </summary>\n                                        <Text id='races.team-help'>\n                                            <ol>\n                                                <li>Create a team for your race dogs.</li>\n                                                <li>Add the dogs you want to use for this race.</li>\n                                                <li>Choose the team for this race.</li>\n                                            </ol>\n                                        </Text>\n                                    </details> */}\n                                </div>\n                            </div>\n                            <div class='form-group row my-2'>\n                                <label for='team' class='col-3 col-form-label text-right font-weight-lighter'><Text id='races.class'>Klasse</Text></label>\n                                <div class='col-9'>\n                                    <select class='form-control' id='class' aria-describedby='classHelp'\n                                        data-classid={signup.class}\n                                        data-contestantid={signup.id}\n                                        onInput={this.editSignup}\n                                        value={signup.class}\n                                        disabled\n                                    >\n                                        <option value=''>-- <Text id='races.choose-class'>Velg klasse</Text> --</option>\n                                        {race.classes && race.classes.sort((a, b) => a.distance - b.distance).map(currentClass => <>\n                                            <option value={currentClass.id}>\n                                                {currentClass.title}{!race.liveRace && <>\n                                                    - {currentClass.distance} km - Pmelding: {currentClass.signupfee || race.signupfee} NOK\n                                                </>}\n                                            </option>\n                                        </>)}\n                                    </select>\n                                </div>\n                            </div>\n                            {race.rules && <div class='form-group row my-2'>\n                                <label for='team' class='col-3 col-form-label text-right font-weight-lighter'>&nbsp;</label>\n                                <div class='col-9 pl-5'>\n                                    <input type='checkbox' class='form-check-input' id='termsAndAgreement'\n                                        data-classid={signup.class}\n                                        data-contestantid={signup.id}\n                                        onInput={this.editSignup}\n                                        checked={signup.termsAndAgreement}\n                                        value={1}\n                                    />\n                                    <label class='form-check-label' for='termsAndAgreement'><Text id='races.agreement-accept'>Jeg har lest og godtar reglene for lpet.</Text></label>\n                                </div>\n                            </div>}\n                            {race.declaration && <div class='form-group row my-4'>\n                                <div class='col-12 text-center border-top'>\n                                    <h5><Text id='races.declaration'>Declaration</Text></h5>\n                                </div>\n                                <details class='col-12'>\n                                    {signup.declaration ? <>\n                                        <summary>\n                                            <Text id='races.see-declaration'>See declaration</Text> (<span class='text-muted font-weight-light'><Text id='races.declaration-signed'>Declaration signed</Text>: {util.isoDate(signup.declarationDate)}</span>)\n                                        </summary>\n                                    </> : <>\n                                        <summary>\n                                            <h5 class='btn btn-primary'><Text id='races.see-declaration'>See declaration</Text></h5>\n                                        </summary>\n                                    </>}\n\n                                    <Markdown markdown={mu.replaceImages(race.declaration, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n\n                                    {signup.declaration ? <>\n                                        <i>\n                                            <Text id='races.declaration-signed'>Declaration signed</Text>: {util.isoDate(signup.declarationDate)}\n                                        </i>\n                                    </> : <>\n                                        <div class='pl-5'>\n                                            <input type='checkbox' class='form-check-input' id='declaration'\n                                                data-classid={signup.class}\n                                                data-contestantid={signup.id}\n                                                onInput={this.editSignup}\n                                                checked={signup.declaration}\n                                                value={1}\n                                            />\n                                            <label class='form-check-label' for='declaration'><Text id='races.declaration-accept'>I hereby sign the declaration for the race!</Text></label>\n                                        </div>\n                                    </>}\n                                </details>\n                            </div>}\n\n                            <div class='form-group row my-4'>\n                                <div class='col-12 text-center border-top'>\n                                    <h5><Text id='races.chiplist'>Chiplist</Text></h5>\n                                </div>\n                                <details class='col-12'>\n                                    <summary>\n                                        <Text id='races.see-dogs'>See dogs & chiplist</Text>\n                                    </summary>\n                                    <div class='pt-3'>\n                                        {dogs && dogs.length > 0 ? <>\n                                            {dogs.map(dog => <>\n                                                <div class='d-flex mb-0 position-relative mb-3'>\n                                                    <div class={`text-center border rounded-circle imageRounded imageRoundedMedium text-muted pt-2`} style={dog.image ? `background-image: url(\"${dog.image.s3SmallLink}\"); background-size: cover;` : ''}>\n                                                        {/* {!dog.image && <i class='fas fa-dog mt-3' style='font-size: 40px;' />} */}\n                                                        {!dog.image && <span class='font-weight-lighter' style='font-size: 35px;'>{util.ucfirst(dog.name, true)}</span>}\n                                                    </div>\n                                                    <div class='flex-grow-1 pl-3 pr-2'>\n                                                        <span class='float-right'>\n                                                            {dog.birth && <span class='mr-2'>{util.age(dog.birth, dog.deceased)}</span>}\n                                                            {dog.gender === 'female' ? <i class='fas fa-venus' /> : <i class='fas fa-mars' />}\n                                                        </span>\n                                                        <a href={`/dogs/edit/${dog.id}`}>\n                                                            <h6 class='mb-1' style='line-height: 1.0em;'>\n                                                                {dog.shortname || dog.name} {dog.shortname && dog.shortname !== '' && <> - <span class='font-weight-lighter'>{dog.name}</span></>}\n                                                            </h6>\n                                                        </a>\n                                                        {dog.chipId ? <>\n                                                            <i class='fas fa-microchip text-muted' /> {dog.chipId}\n                                                        </> : <>\n                                                            <div class='alert alert-danger' role='alert'>\n                                                                <Text id='races.missing-chipid'>Missing chid id</Text>\n                                                            </div>\n                                                        </>}\n\n                                                        <div>\n                                                            {vaccineLogStatuses && vaccineLogStatuses.filter(e => e.chipId === dog.chipId).map((vac) => {\n                                                                return (\n                                                                    <span class={`badge badge-${vac.inKarens ? 'warning' : 'success'} mr-2 mb-1`}>\n                                                                        {vac.vaccineAgens.name}\n                                                                        <span class='font-weight-lighter ml-2'>\n                                                                            <i class='fas fa-calendar-check' /> {util.isoDate(vac.vaccineAgens.durationEnd, false, false, true)}\n                                                                            {vac.inKarens && <>\n                                                                                <br />\n                                                                                (karens: {util.format(vac.karensDaysLeft, 0)} days left)\n                                                                            </>}\n                                                                        </span>\n                                                                    </span>\n                                                                );\n                                                            })}\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                            </>)}\n                                        </> : <>\n                                            <div class='text-center text-muted'>\n                                                <div class='display-1'>\n                                                    <i class='fas fa-dog' />\n                                                </div>\n                                                <h3 class='font-weight-lighter'>\n                                                    <Text id='race.add-dogs'>Add a team to your race signup to see the dogs.</Text>\n                                                </h3>\n                                            </div>\n                                        </>}\n                                    </div>\n                                </details>\n                            </div>\n\n                        </> : <>\n\n                            {race.liveRace ? <>\n                                Signup is done at the race normal web pages.\n                            </> : <>\n                                <div class='form-group'>\n                                    <label for='cellphone'><Text id='races.cellphone'>Mobil</Text></label>\n                                    <input type='text' class='form-control' id='cellphone' aria-describedby='cellphoneHelp'\n                                        placeholder={user.cellphone}\n                                        onInput={this.updateSignup}\n                                        value={signup.cellphone}\n                                    />\n                                    <small id='cellphoneHelp' class='form-text text-muted'><Text id='races.cellphone-help'>'Hva er mobilnummer ditt?'</Text></small>\n                                </div>\n\n                                {signup.name && <div class='row'>\n                                    <div class='col'>\n                                        <div class='form-group'>\n                                            <label for='name'><Text id='races.name'>Name</Text></label>\n                                            <input type='text' class='form-control' id='name' aria-describedby='nameHelp'\n                                                placeholder={user.name}\n                                                onInput={this.updateSignup}\n                                                value={signup.name}\n                                            />\n                                            <small id='nameHelp' class='form-text text-muted'><Text id='races.name-help'>Hva er navnet ditt?</Text></small>\n                                        </div>\n                                    </div>\n                                </div>}\n                                <div class='row'>\n                                    <div class='col'>\n                                        <div class='form-group'>\n                                            <label for='firstname'><Text id='races.firstname'>Fornavn</Text></label>\n                                            <input type='text' class='form-control' id='firstname' aria-describedby='firstnameHelp'\n                                                placeholder={user.firstname}\n                                                onInput={this.updateSignup}\n                                                value={signup.firstname}\n                                            />\n                                            <small id='firstnameHelp' class='form-text text-muted'><Text id='races.firstname-help'>Hva er fornavnet ditt?</Text></small>\n                                        </div>\n                                    </div>\n                                    <div class='col'>\n                                        <div class='form-group'>\n                                            <label for='lastname'><Text id='races.lastname'>Etternavn</Text></label>\n                                            <input type='text' class='form-control' id='lastname' aria-describedby='lastnameHelp'\n                                                placeholder={user.lastname}\n                                                onInput={this.updateSignup}\n                                                value={signup.lastname}\n                                            />\n                                            <small id='lastnameHelp' class='form-text text-muted'><Text id='races.lastname-help'>Hva er etternavnet ditt?</Text></small>\n                                        </div>\n                                    </div>\n                                </div>\n\n                                <div class='form-group'>\n                                    <label for='sportsClub'><Text id='races.sportsclub'>Klubb</Text></label>\n                                    <input type='text' class='form-control' id='sportsClub' aria-describedby='sportsClubHelp'\n                                        placeholder={user.sportsClub}\n                                        onInput={this.updateSignup}\n                                        value={signup.sportsClub}\n                                    />\n                                    <small id='sportsClubHelp' class='form-text text-muted'><Text id='races.sportsClub-help'>Hvilken klubb tilhrer du?</Text></small>\n                                </div>\n\n                                <div class='row'>\n                                    <div class='col'>\n                                        <div class='form-group'>\n                                            <label for='facebook'><Text id='races.facebook'>Facebook</Text></label>\n                                            <input type='text' class='form-control' id='facebook' aria-describedby='facebookHelp'\n                                                placeholder={user.facebook}\n                                                onInput={this.updateSignup}\n                                                value={signup.facebook}\n                                            />\n                                            <small id='facebookHelp' class='form-text text-muted'><Text id='races.facebook-help'>Hva er Facebook brukernavnet ditt?</Text></small>\n                                        </div>\n                                    </div>\n                                    <div class='col'>\n                                        <div class='form-group'>\n                                            <label for='instagram'><Text id='races.instagram'>Instagram</Text></label>\n                                            <input type='text' class='form-control' id='instagram' aria-describedby='instagramHelp'\n                                                placeholder={user.instagram}\n                                                onInput={this.updateSignup}\n                                                value={signup.instagram}\n                                            />\n                                            <small id='instagramHelp' class='form-text text-muted'><Text id='races.instagram-help'>Hva er Instagram brukernavnet ditt?</Text></small>\n                                        </div>\n                                    </div>\n                                </div>\n\n                                <div class='form-group'>\n                                    <label for='team'><Text id='races.team'>Team</Text></label>\n                                    <select class='form-control' id='team' aria-describedby='teamHelp'\n                                        onInput={this.updateSignup}\n                                        value={signup.team}\n                                    >\n                                        <option value=''>-- <Text id='races.choose-team'>Velg team</Text> --</option>\n                                        {teams.map(team =>\n                                            <option value={team.id}>{team.name}</option>\n                                        )}\n                                    </select>\n                                    <small id='teamHelp' class='form-text text-muted'><Text id='races.choose-team-help'>Velg fra dine team</Text></small>\n                                </div>\n\n                                <div class='form-group'>\n                                    <label for='class'><Text id='races.class'>Klasse</Text></label>\n                                    <select class='form-control' id='class' aria-describedby='classHelp'\n                                        onInput={this.updateSignup}\n                                        value={signup.class}\n                                    >\n                                        <option value=''>-- <Text id='races.choose-class'>Velg klasse</Text> --</option>\n                                        {race.classes && race.classes.map(currentClass => <>\n                                            <option value={currentClass.id}>{currentClass.title} - {currentClass.distance} km - Pmelding: {currentClass.signupfee || race.signupfee} NOK</option>\n                                        </>)}\n                                    </select>\n                                    <small id='classHelp' class='form-text text-muted'><Text id='races.choose-class-help'>Velg nsket klasse.</Text></small>\n                                </div>\n\n                                <div class='form-group form-check'>\n                                    <input type='checkbox' class='form-check-input' id='termsAndAgreement'\n                                        onInput={this.updateSignup}\n                                        checked={signup.termsAndAgreement}\n                                        value={true}\n                                    />\n                                    <label class='form-check-label' for='termsAndAgreement'><Text id='races.agreement-accept'>Jeg har lest og godtar reglene for lpet.</Text></label>\n                                </div>\n                                <button type='button' class='btn btn-primary' onClick={this.signupToRace}><Text id='races.do-signup'>Meld meg p</Text></button>\n                            </>}\n\n                        </>}\n\n                    </> : <>\n                        {today < new Date(race.signupStartDate) ? <>\n                            <h5 class='mt-4'>\n                                <i class='fas fa-exclamation-circle' /> <Text id='races.signup-not-open-yet'>Pmeldingen har ikke pnet enn!</Text>\n                            </h5>\n                            <p class='mt-4'>\n                                <Text id='races.signup-opening'>Pmeldingen pner</Text>:<br />\n                                <span class='display-4'>{util.formatDate(race.signupStartDate, { locale: 'no-NB', hour12: false, hour: '2-digit', minute: '2-digit' })}</span>\n                            </p>\n                        </> : <>\n                            <h5 class='mt-4 mb-4'>\n                                <i class='fas fa-exclamation-circle' /> <Text id='races.signup-closed'>Pmeldingen er stengt!</Text>\n\n                                {/* {JSON.stringify(signup, null, 4)} */}\n                            </h5>\n                        </>}\n                    </>}\n                </div>\n            </div>\n        </>);\n    }\n}\n\nexport default AppRaceDetailSignup;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport { route } from 'preact-router';\nimport Markdown from 'preact-markdown';\nimport linkstate from 'linkstate';\n\nimport mu from '../../lib/musher-util';\n\nfunction nl2br($str) {\n\tif (typeof $str === 'string') {\n\t\treturn $str.replace(/[\\n]/g, '<br>');\n\t}\n\treturn $str;\n}\n\n@observer\nclass AppRaceDetailMushers extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            displayDetails: {},\n            editUserDetails: {},\n            showAdminSendMessage: {},\n            showAdminImport: {},\n            message: {},\n        };\n\t\tthis.inputRef = {};\n        this.updateTimer = {};\n        this.parseInputTimer = null;\n    }\n\n    toggleDisplayDetails = (e) => {\n\t\tconst id = e.target.closest('tr').dataset.id;\n\t\tconst { appState } = this.props.stores;\n\t\tconst { editUserDetails } = appState;\n\t\tif (!editUserDetails[id]) {\n\t\t\tappState.toggleDisplayDetails(id)\n\t\t}\n\t}\n\n    adminToggleEditUser = (e) => {\n\t\te.stopPropagation();\n\t\tconst id = e.target.closest('tr').dataset.id;\n\t\tconst { appState } = this.props.stores;\n\t\tappState.toggleEditUserDetails(id)\n\t}\n\n    toggleAdminSendMessage = (e) => {\n\t\tconst classId = e.target.closest('button').dataset.class;\n\t\tconst { showAdminSendMessage } = this.state;\n\t\tshowAdminSendMessage[classId] = !showAdminSendMessage[classId];\n\t\tthis.setState({ showAdminSendMessage });\n\t}\n\n    toggleAdminImport = (e) => {\n\t\tconst classId = e.target.closest('button').dataset.class;\n\t\tconst { showAdminImport } = this.state;\n\t\tshowAdminImport[classId] = !showAdminImport[classId];\n\t\tthis.setState({ showAdminImport });\n\t}\n\n    adminSignupEdit = (e) => {\n        const { race = {} } = this.props;\n        const raceid = race.id;\n        const { raceStore } = this.props.stores;\n        const field = e.target.id;\n        const value = e.target.value;\n        const { classid, contestantid } = e.target.dataset;\n\n        // console.log({ raceid, field, value, classid });\n        // const { raceStore } = this.props.stores;\n        // raceStore.updateObjectKeyValue('signup', key, value);\n\n        const data = {\n\t\t\traceClassId: classid,\n            contestantId: contestantid,\n\t\t\t[`raceClassContestant${util.ucfirst(field)}`]: value,\n\t\t};\n\t\tclearTimeout(this.updateTimer[field]);\n\t\tthis.updateTimer[field] = setTimeout(async () => {\n\t\t\traceStore.editClass({\n\t\t\t\tid: raceid,\n\t\t\t\tdata,\n\t\t\t});\n\t\t}, 500);\n\t}\n\n\tsendEmail = async (e) => {\n        const { race = {} } = this.props;\n        const raceId = race.id;\n\t\tconst to = e.target.closest('button').dataset.to;\n\t\tconst raceClassId = e.target.closest('button').dataset.raceclassid;\n\t\tconst { appState } = this.props.stores;\n\t\tconst { message } = this.state;\n\t\tconst { subject, body } = message;\n\t\tconst emailResponse = await appState.sendEmail({\n\t\t\tto,\n\t\t\tsubject,\n\t\t\tbody,\n\t\t\traceId,\n\t\t\traceClassId,\n\t\t});\n\t\tthis.setState({ emailResponse });\n\t}\n\n\tresetEmail = () => {\n\t\tthis.setState({\n\t\t\temailResponse: null,\n\t\t\tmessage: {\n\t\t\t\tsubject: '',\n\t\t\t\tbody: '',\n\t\t\t},\n\t\t});\n\t}\n\n    signupToRace = async ({ signup }) => {\n\t\tconst { raceStore } = this.props.stores;\n        const { race = {} } = this.props;\n        const raceid = race.id;\n\n\t\tawait raceStore.addContestant({\n\t\t\tid: raceid,\n\t\t\tclassId: signup.class,\n\t\t\tnewContestant: {\n\t\t\t\t// team: user.team,\n\t\t\t\t// firstname: user.firstname,\n\t\t\t\t// lastname: user.lastname,\n\t\t\t\t// sportsClub: user.sportsClub,\n\t\t\t\t// email: user.email,\n\t\t\t\t// cellphone: user.cellphone,\n\t\t\t\t// facebook: user.facebook,\n\t\t\t\t// instagram: user.instagram,\n\t\t\t\t ...signup\n\t\t\t}\n        });\n\t}\n\n    parseInput = async (data, classId) => {\n        clearTimeout(this.parseInputTimer);\n        this.parseInputTimer = setTimeout(() => this.doParseInput(data, classId), 500);\n    }\n\n    doParseInput = async (data, classId) => {\n        const lines = String(data).split('\\n');\n        let headers = [];\n        const jsonData = [];\n\n        // Get headers\n        const firstLine = lines[0];\n        if (firstLine.match(/\\t/)) {\n            headers = firstLine.split('\\t');\n        } else if (firstLine.match(/;/)) {\n            headers = firstLine.split(';');\n        } else {\n            headers = firstLine.split(',');\n        }\n\n        // Map data to headernames\n        for (let i = 1, l = lines.length; i < l; i += 1) {\n            const line = lines[i];\n            let values;\n            if (line.match(/\\t/)) {\n                values = line.split('\\t');\n            } else if (line.match(/;/)) {\n                values = line.split(';');\n            } else {\n                values = line.split(',');\n            }\n            const jsonObject = {};\n            values.forEach((v, idx) => {\n                let val = v;\n                if (headers[idx] === 'email') {\n                    val = v.toLowerCase();\n                }\n                jsonObject[headers[idx]] = val;\n            });\n            jsonData.push(jsonObject);\n        }\n\n        const { raceStore } = this.props.stores;\n        const { race = {} } = this.props;\n        const raceid = race.id;\n        raceStore.addMultipleContestants({ id: raceid, classId, contestants: jsonData });\n        return true;\n    }\n\n    render() {\n        const { showAdminSendMessage = {}, showAdminImport = {}, message = {}, emailResponse } = this.state;\n\t\tconst { userStore, raceStore, appState } = this.props.stores;\n\t\tconst { user = {}, teams = [], isAdmin } = userStore;\n        const { language = 'en' } = user;\n        const { displayDetails, editUserDetails } = appState;\n\n\t\tconst { race = {} } = this.props;\n\n        return (<>\n            <div class='row'>\n                <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2'>\n                    <h2 class='mb-0'><Text id='races.mushers'>Deltakere</Text></h2>\n                </div>\n                <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2'>\n                    {race.classes && race.classes.sort((a, b) => a.distance - b.distance).map(currentClass => <>\n                        {isAdmin && <span class='float-right'>\n                            Total app users: {currentClass.contestants && currentClass.contestants.filter(musher => musher.user).length}\n                        </span>}\n                        <h5>{currentClass.title} {currentClass.startDate && <>\n                            : <span class='font-weight-lighter'>\n                                {util.formatDate(`${currentClass.startDate} ${currentClass.startTime || '00:00:00'}`, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })} - {util.formatDate(`${currentClass.endDate} ${currentClass.endTime || '00:00:00'}`, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}\n                            </span>\n                        </>}</h5>\n                        <div class='table-responsive'>\n                            <table class='table table-sm table-striped'>\n                                <thead>\n                                    <tr>\n                                        <th scope='col'>#</th>\n                                        <th scope='col' style='min-width: 90%;'><Text id='races.name'>Navn</Text></th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    {currentClass.contestants && currentClass.contestants.map((musher, idx) => {\n                                        const currentTeam = raceStore.getTeamById(musher.team);\n\n                                        return (<>\n                                            <tr onClick={this.toggleDisplayDetails} data-id={musher.id}>\n                                                <th scope='row'>{idx + 1}</th>\n                                                <td\n                                                    class={`${displayDetails[musher.id] ? 'font-weight-bold' : ''}`}\n                                                    style={`${displayDetails[musher.id] ? '' : 'line-height: 0.8em;'}`}\n                                                >\n                                                    {isAdmin && <>\n                                                        <button class='btn btn-primary btn-sm float-right' onClick={this.adminToggleEditUser}><i class='fas fa-user-edit' /></button>\n                                                        {musher.paidSignupfee && <>\n                                                            <span class='float-right'>\n                                                                <i class='fas fa-check text-success' /><br />\n                                                            </span>\n                                                        </>}\n                                                        <small class='float-right'>\n                                                            {musher.raceStatus && <><span class='text-muted'>raceStatus:</span><br /> {musher.raceStatus}<br /></>}\n                                                            {musher.raceComment && <><span class='text-muted'>raceComment:</span><br /> {musher.raceComment}<br /></>}\n                                                            {musher.gpxResultsApproved && <><span class='text-muted'>gpxResultsApproved:</span><br /> {musher.gpxResultsApproved}<br /></>}\n                                                        </small>\n                                                    </>}\n                                                    {isAdmin && race.liveRace > 0 && <>\n                                                        <span class='float-right text-success mr-2' style='font-size: 1.2em;'>\n                                                            {musher.bib && <><i class='fas fa-tshirt ml-2' /> {musher.bib}</>}\n                                                            {musher.startTime && <><i class='fas fa-clock ml-2' /> {util.isoDate(musher.startTime)}</>}\n                                                            {musher.user && <i class='fas fa-mobile-alt ml-2' />}\n                                                            {musher.declaration && <i class='fas fa-handshake ml-2' alt={util.isoDate(musher.declarationDate)} />}\n\n                                                        </span>\n                                                    </>}\n                                                    {displayDetails[musher.id] ? <>\n                                                        {musher.firstname ? <>\n                                                            {musher.firstname} {musher.lastname}<br />\n                                                        </> : <>\n                                                            {musher.name}\n                                                        </>}\n                                                        <span class='text-muted'>{currentTeam.name}</span><br />\n                                                        <small class='text-muted'>{musher.sportsClub}</small><br />\n                                                        {musher.facebook && <a class='mr-2' href={mu.asFacebookLink(musher.facebook)} native target='_blank' rel='noreferrer'><i class='fab fa-facebook' /></a>}\n                                                        {musher.instagram && <a class='mr-2' href={mu.asInstagramLink(musher.instagram)} native target='_blank' rel='noreferrer'><i class='fab fa-instagram' /></a>}<br />\n\n                                                        {musher.price1 && <div class='font-weight-lighter'>\n                                                            <i class='fas fa-trophy text-warning' /> {musher.price1}\n                                                            {musher.priceSent && <>\n                                                                <i class='fas fa-check text-success' />\n                                                            </>}\n                                                        </div>}\n                                                        {musher.price2 && <div class='font-weight-lighter'><i class='fas fa-trophy text-warning' /> {musher.price2}</div>}\n                                                        {musher.price3 && <div class='font-weight-lighter'><i class='fas fa-trophy text-warning' /> {musher.price3}</div>}\n\n                                                        { 1 === 2 && <>\n                                                            <div class='w-100 position-relative'>\n                                                            <div\n                                                                class='d-flex flex-row flex-nowrap bg-light border-top border-bottom'\n                                                                style={`\n                                                                    overflow: auto;\n                                                                    scroll-snap-type: x mandatory;\n                                                                `}\n                                                            >\n                                                                {currentTeam && currentTeam.dogs && currentTeam.dogs.map(dog => <>\n                                                                    <div class='mx-0 mr-1 px-0 position-relative pt-1'>\n                                                                        <div\n                                                                            class={`text-center border rounded-circle imageRounded imageRoundedMedium text-muted pt-2`}\n                                                                            style={`${dog.image ? `background-image: url(\"${dog.image.s3SmallLink}\"); background-size: cover;` : ''} border-width: 2px !important;`}\n                                                                        >\n                                                                            {/* {!dog.image && <i class='fas fa-dog mt-3' style='font-size: 40px;' />} */}\n                                                                            {!dog.image && <span class='font-weight-lighter' style='font-size: 35px;'>{util.ucfirst(dog.name, true)}</span>}\n                                                                        </div>\n                                                                        <small>\n                                                                            <span class='float-left text-overflow' style={`width: 70px;`}>{dog.name}</span><br />\n                                                                        </small>\n                                                                        {(dog.birth || dog.gender) && <small>\n                                                                            <small class='font-weight-normal float-right position-absolute text-white bg-info p-1 rounded' style='top: 0px; right: 0px; line-height: 0.8em;'>\n                                                                                {dog.birth && <span class='mr-1 text-white'>{util.age(dog.birth, dog.deceased)}</span>}\n                                                                                {dog.gender && <>{dog.gender === 'female' ? <i class='fas fa-venus' /> : <i class='fas fa-mars' />}</>}\n                                                                            </small>\n                                                                        </small>}\n                                                                    </div>\n                                                                </>)}\n                                                            </div>\n                                                            </div>\n                                                        </>}\n\n                                                    </> : <>\n                                                        {musher.price1 && <span class='float-right text-warning' style='font-size: 1.2em;'>\n                                                            <i class='fas fa-trophy' />\n                                                            {musher.priceSent && <>\n                                                                <i class='fas fa-check text-success' />\n                                                            </>}\n                                                        </span>}\n                                                        <nobr>\n                                                            {musher.firstname ? <>\n                                                                {musher.firstname} {musher.lastname}<br />\n                                                            </> : <>\n                                                                {musher.name}\n                                                            </>}\n                                                            <small class='text-muted'>{musher.sportsClub}</small><br />\n                                                        </nobr>\n                                                    </>}\n\n\n                                                    {(isAdmin && editUserDetails[musher.id]) && <>\n                                                        <h5>Admin edit:</h5>\n\n                                                        <div class='form-group row my-0'>\n                                                            <label class='col-4 col-form-label text-right'>Email</label>\n                                                            <div class='col-8'>\n                                                                {musher.email}\n                                                            </div>\n                                                        </div>\n\n                                                        <div class='form-group row my-0'>\n                                                            <label for='bib' class='col-4 col-form-label text-right'>bib</label>\n                                                            <div class='col-8'>\n                                                                <input type='number' class='form-control' id='bib'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.bib}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='startTime' class='col-4 col-form-label text-right'>startTime</label>\n                                                            <div class='col-8'>\n                                                                <input type='date' class='form-control' id='startTime'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.startTime ? util.isoDate(musher.startTime, false, false, false) : null}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='team' class='col-4 col-form-label text-right'>team</label>\n                                                            <div class='col-8'>\n                                                                <input type='number' class='form-control' id='team'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.team}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='user' class='col-4 col-form-label text-right'>user</label>\n                                                            <div class='col-8'>\n                                                                <input type='number' class='form-control' id='user'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.user}\n                                                                />\n                                                            </div>\n                                                        </div>\n\n\n                                                        <div class='form-group row my-0'>\n                                                            <label for='team' class='col-4 col-form-label text-right'>Race status</label>\n                                                            <div class='col-8'>\n                                                                <select class='form-control' id='raceStatus'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.raceStatus}\n                                                                >\n                                                                    <option value=''>-- Choose race status --</option>\n                                                                    <option value='OK'>OK - Everything ok</option>\n                                                                    <option value='DNS'>DNS - Did Not Start</option>\n                                                                    <option value='DNF'>DNF - Did Not Finish</option>\n                                                                    <option value='DNQ'>DNQ - Did not qualify</option>\n                                                                    <option value='DQ'>DQ - Disqualified</option>\n                                                                </select>\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='raceComment' class='col-4 col-form-label text-right'>Race comment</label>\n                                                            <div class='col-8'>\n                                                                <input type='text' class='form-control' id='raceComment'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.raceComment}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='gpxResultsApproved' class='col-4 col-form-label text-right'>GPX Results approved (date)</label>\n                                                            <div class='col-8'>\n                                                                <input type='date' class='form-control' id='gpxResultsApproved'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.gpxResultsApproved ? util.isoDate(musher.gpxResultsApproved, false, false, true) : null}\n                                                                />\n                                                            </div>\n                                                        </div>\n\n                                                        <div class='form-group row my-0'>\n                                                            <label for='paidSignupfee' class='col-4 col-form-label text-right'>paidSignupfee (date)</label>\n                                                            <div class='col-8'>\n                                                                <input type='date' class='form-control' id='paidSignupfee'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.paidSignupfee ? util.isoDate(musher.paidSignupfee, false, false, true) : null}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='startOrder' class='col-4 col-form-label text-right'>startOrder</label>\n                                                            <div class='col-8'>\n                                                                <input type='number' class='form-control' id='startOrder'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.startOrder}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='cellphone' class='col-4 col-form-label text-right'>Mobil</label>\n                                                            <div class='col-8'>\n                                                                <input type='text' class='form-control' id='cellphone'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.cellphone}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='name' class='col-4 col-form-label text-right'>Navn</label>\n                                                            <div class='col-8'>\n                                                                <input type='text' class='form-control' id='name'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.name}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='firstname' class='col-4 col-form-label text-right'>Fornavn</label>\n                                                            <div class='col-8'>\n                                                                <input type='text' class='form-control' id='firstname'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.firstname}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='lastname' class='col-4 col-form-label text-right'>Etternavn</label>\n                                                            <div class='col-8'>\n                                                                <input type='text' class='form-control' id='lastname'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.lastname}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='address' class='col-4 col-form-label text-right'>Adresse</label>\n                                                            <div class='col-8'>\n                                                                <input type='text' class='form-control' id='address'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.address}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='postalcode' class='col-4 col-form-label text-right'>Postalcode</label>\n                                                            <div class='col-8'>\n                                                                <input type='text' class='form-control' id='postalcode'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.postalcode}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='postalplace' class='col-4 col-form-label text-right'>Postalplace</label>\n                                                            <div class='col-8'>\n                                                                <input type='text' class='form-control' id='postalplace'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.postalplace}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='flag' class='col-4 col-form-label text-right'>flag (emoji)</label>\n                                                            <div class='col-8'>\n                                                                <input type='text' class='form-control' id='flag'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.flag}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='countryCode' class='col-4 col-form-label text-right'>countryCode (iso)</label>\n                                                            <div class='col-8'>\n                                                                <input type='text' class='form-control' id='countryCode'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.countryCode}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='birthdate' class='col-4 col-form-label text-right'>birthdate</label>\n                                                            <div class='col-8'>\n                                                                <input type='date' class='form-control' id='birthdate'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.birthdate ? util.isoDate(musher.birthdate, false, false, true) : null}\n                                                                />\n                                                            </div>\n                                                        </div>\n\n                                                        <div class='form-group row my-0'>\n                                                            <label for='sportsClub' class='col-4 col-form-label text-right'>Klubb</label>\n                                                            <div class='col-8'>\n                                                                <input type='text' class='form-control' id='sportsClub'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.sportsClub}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='facebook' class='col-4 col-form-label text-right'>Facebook</label>\n                                                            <div class='col-8'>\n                                                                <input type='text' class='form-control' id='facebook'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.facebook}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='instagram' class='col-4 col-form-label text-right'>Instagram</label>\n                                                            <div class='col-8'>\n                                                                <input type='text' class='form-control' id='instagram'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.instagram}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        {/* <div class='form-group row my-0'>\n                                                            <label for='team' class='col-4 col-form-label text-right'>Team</label>\n                                                            <div class='col-8'>\n                                                                <select class='form-control' id='team' aria-describedby='teamHelp'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.team}\n                                                                >\n                                                                    <option value=''>-- Velg team --</option>\n                                                                    {teams.map(team =>\n                                                                        <option value={team.id}>{team.name}</option>\n                                                                    )}\n                                                                </select>\n                                                            </div>\n                                                        </div> */}\n                                                        <div class='form-group row my-0'>\n                                                            <label for='team' class='col-4 col-form-label text-right'>Klasse</label>\n                                                            <div class='col-8'>\n                                                                <select class='form-control' id='class' aria-describedby='classHelp'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.class}\n                                                                >\n                                                                    <option value=''>-- Choose race class --</option>\n                                                                    {race.classes && race.classes.sort((a, b) => a.distance - b.distance).map(currentClass => <>\n                                                                        <option value={currentClass.id}>{currentClass.title} - {currentClass.distance} km - Pmelding: {currentClass.signupfee || race.signupfee} NOK</option>\n                                                                    </>)}\n                                                                </select>\n                                                            </div>\n                                                        </div>\n\n                                                        <div class='form-group row my-0'>\n                                                            <label for='price1' class='col-4 col-form-label text-right'>Price 1</label>\n                                                            <div class='col-8'>\n                                                                <input type='text' class='form-control' id='price1'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.price1}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='price2' class='col-4 col-form-label text-right'>Price 2</label>\n                                                            <div class='col-8'>\n                                                                <input type='text' class='form-control' id='price2'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.price2}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='price3' class='col-4 col-form-label text-right'>Price 3</label>\n                                                            <div class='col-8'>\n                                                                <input type='text' class='form-control' id='price3'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.price3}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='priceSent' class='col-4 col-form-label text-right'>Price sent</label>\n                                                            <div class='col-8'>\n                                                                <input type='date' class='form-control' id='priceSent'\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.priceSent ? util.isoDate(musher.priceSent, false, false, true) : null}\n                                                                />\n                                                            </div>\n                                                        </div>\n\n                                                        <div class='form-group row my-5'>\n                                                            <div class='col-8'>\n                                                                <button type='button' class='btn btn-danger float-right'\n                                                                    id='deleteUser'\n                                                                    value='1'\n                                                                    onClick={this.adminSignupEdit}\n                                                                    data-classid={currentClass.id}\n                                                                    data-contestantid={musher.id}\n                                                                >\n                                                                    Delete user from this class\n                                                                </button>\n                                                            </div>\n                                                        </div>\n\n                                                    </>}\n                                                </td>\n                                            </tr>\n                                        </>);\n                                    })}\n                                </tbody>\n                            </table>\n                        </div>\n\n                        {isAdmin && <>\n                            {showAdminSendMessage[currentClass.id] ? <>\n                                <div class='container'>\n                                    <div class='row'>\n                                        <div class='col-12'>\n                                            <h5>Message to all mushers in {currentClass.title}</h5>\n                                            <div class='overflow-auto p-5' style='max-height: 30vh;'>\n                                                <small>\n                                                    {currentClass.emails && currentClass.emails.map((email) => <div class='border rounded-lg p-3 mb-3'>\n                                                        <div class='row bg-light'>\n                                                            <div class='col-3 text-right'>\n                                                                Date:\n                                                            </div>\n                                                            <div class='col-9'>\n                                                                {util.formatDate(email.date, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}\n                                                            </div>\n                                                        </div>\n                                                        <div class='row bg-light'>\n                                                            <div class='col-3 text-right'>\n                                                                To:\n                                                            </div>\n                                                            <div class='col-9'>\n                                                                {email.to.map(e => <span class='badge badge-info px-2 py-1 mr-2'>{e}</span>)}\n                                                            </div>\n                                                        </div>\n                                                        <div class='row bg-light'>\n                                                            <div class='col-3 text-right'>\n                                                                Subject:\n                                                            </div>\n                                                            <div class='col-9'>\n                                                                {email.subject}\n                                                            </div>\n                                                        </div>\n                                                        <div class='row mt-2'>\n                                                            <div class='col-3 text-right'>\n                                                                Body:\n                                                            </div>\n                                                            <div class='col-9'\n                                                                dangerouslySetInnerHTML={{ __html: nl2br(email.body) }}\n                                                            />\n                                                        </div>\n                                                    </div>)}\n                                                </small>\n                                            </div>\n\n                                            <div class='form-group row'>\n                                                <label for='subject' class='col-2 col-form-label text-right font-weight-lighter'>To</label>\n                                                <div class='col-10'>\n                                                    {currentClass.contestants && currentClass.contestants.map((musher) => <>\n                                                        <span class='badge badge-info px-2 py-1 mr-2'>{musher.firstname} {musher.lastname} ({musher.email})</span>\n                                                    </>)}\n                                                </div>\n                                            </div>\n                                            <div class='form-group row'>\n                                                <label for='subject' class='col-2 col-form-label text-right font-weight-lighter'>Subject</label>\n                                                <div class='col-10'>\n                                                    <input type='text' class='form-control' id='subject'\n                                                        onInput={linkstate(this, 'message.subject')}\n                                                        value={message.subject}\n                                                    />\n                                                </div>\n                                            </div>\n                                            <div class='form-group row'>\n                                                <label for='body' class='col-2 col-form-label text-right font-weight-lighter'>Message</label>\n                                                <div class='col-10'>\n                                                    <textarea type='text' class='form-control' id='body'\n                                                        rows='10'\n                                                        onInput={linkstate(this, 'message.body')}\n                                                        value={message.body}\n                                                    />\n                                                </div>\n                                                <div class='col-5 contain-images'>\n                                                    {message.body && <Markdown markdown={message.body} markdownOpts={mu.getMarkdownOptions()} />}\n                                                </div>\n                                            </div>\n\n                                            {emailResponse && <>\n                                                <div class={`alert alert-${emailResponse && emailResponse.status >= 300 ? 'danger' : 'success'}`} role='alert'>\n                                                    <small>\n                                                        <xmp>{JSON.stringify(emailResponse, null, 4)}</xmp>\n                                                    </small>\n                                                </div>\n                                            </>}\n\n                                            <button class='btn btn-success float-right'\n                                                type='button'\n                                                data-to={currentClass.contestants && currentClass.contestants.map(musher => musher.email)}\n                                                data-raceclassid={currentClass.id}\n                                                onClick={this.sendEmail}\n                                            >\n                                                <i class='fas fa-paper-plane' /> Send email to all mushers\n                                            </button>\n                                            <button class='btn btn-danger float-right mr-2'\n                                                type='button'\n                                                onClick={this.resetEmail}\n                                            >\n                                                <i class='fas fa-times' /> Reset email\n                                            </button>\n\n                                        </div>\n                                        <div class='col-12 text-center'>\n                                            <button class='btn btn-sm btn-link' type='button' onClick={this.toggleAdminSendMessage} data-class={currentClass.id}>Hide email form</button>\n                                        </div>\n                                    </div>\n                                </div>\n                            </> : <>\n                                <div class='col-12 text-center'>\n                                    <button class='btn btn-sm btn-link' type='button' onClick={this.toggleAdminSendMessage} data-class={currentClass.id}>Send message to all in this class</button>\n                                </div>\n                                <div class='col-12 text-center'>\n                                    <button class='btn btn-sm btn-link' type='button' onClick={this.toggleAdminImport} data-class={currentClass.id}>Toggle import form</button>\n                                </div>\n                            </>}\n\n                            {isAdmin && race.liveRace === 1 && showAdminImport[currentClass.id] && <>\n                                <div class='form-group'>\n                                    <label for='importUsers'><Text id='races.paste-users'>Paste your user data here to import users</Text>:</label>\n                                    <textarea\n                                        class='form-control'\n                                        id='importUsers'\n                                        rows='20'\n                                        oninput={e => this.parseInput(e.target.value, currentClass.id)}\n                                    />\n                                </div>\n                            </>}\n\n                        </>}\n                    </>)}\n                </div>\n            </div>\n        </>);\n    }\n}\n\nexport default AppRaceDetailMushers;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport { route } from 'preact-router';\nimport Markdown from 'preact-markdown';\nimport linkstate from 'linkstate';\n\nimport RaceComments from '../public/race/comments';\nimport RaceAddComment from '../public/race/commentAdd';\nimport RaceText from '../public/race/raceText';\nimport Images from '../../components/form/images';\nimport LikesAndComments from '../../components/feedback/likesAndComments';\n\nimport ScrollIntoView from '../../components/util/scrollIntoView';\n\nimport RaceResults from './results';\nimport RaceNews from './news';\nimport RaceSignup from './signup';\nimport RaceClasses from './classes';\nimport RaceMushers from './mushers';\nimport RaceUserImages from './userImages';\nimport RaceTracking from './tracking';\nimport RaceNotifications from './notifications';\n\nimport mu from '../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(false);\nconst MARGIN_TOP_BACK = mu.marginTopBack(false);\nconst MARGIN_BOTTOM = mu.marginBottom();\nconst SUB_MENU_MARGIN_TOP = mu.subMenuMarginTop();\n\nconst initialState = {\n\tisLoading: false,\n    showAdminSendMessage: {},\n\tnewRaceArticle: {},\n\tnewRaceUserImage: {},\n\tmessage: {\n\t\tsubject: '',\n\t\tbody: '',\n\t},\n};\n\n@observer\nclass AppRaceDetailSignup extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n            showAdminSendMessage: {},\n            newRaceArticle: {},\n            newRaceUserImage: {},\n            message: {\n                subject: '',\n                body: '',\n            },\n            submenu: props.submenu || 'about',\n        };\n\t\tthis.inputRef = {};\n        this.updateTimer = {};\n    }\n\n\tasync loadRace(props = this.props) {\n\t\tthis.setState({ isLoading: true });\n\t\tconst { raceStore, userStore } = props.stores;\n\t\tconst { user = {} } = userStore;\n\t\tconst { raceid } = props;\n\t\tawait raceStore.load(raceid);\n\t\tthis.setState({ isLoading: false });\n\n\t\tlet signup = {};\n\t\tconst { race } = raceStore;\n\t\tif (race.classes && user && user.email) {\n\t\t\tfor (let i = 0, l = race.classes.length; i < l; i += 1) {\n\t\t\t\tconst currentClass = race.classes[i];\n\t\t\t\tif (currentClass.contestants) {\n\t\t\t\t\tconst idx = currentClass.contestants.findIndex(e => e.email === user.email);\n\t\t\t\t\tif (idx > -1) {\n\t\t\t\t\t\tsignup = { ...currentClass.contestants[idx], class: currentClass.id };\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\traceStore.updateKeyValue('signup', signup);\n        if (signup.user) {\n            await userStore.getDogs({ id: signup.user });\n        }\n\n\t\tconst allTeamIds = race.classes.filter(currentClass => currentClass.contestants && currentClass.contestants.length > 0).map((currentClass) => {\n            return currentClass.contestants.filter(musher => musher.team > 0).map(musher => musher.team);\n\t\t}).flat();\n\t\tif (allTeamIds.length > 0 && raceid) {\n\t\t\tawait raceStore.loadTeams(allTeamIds.join(','));\n\t\t}\n\t\traceStore.getAllClassesSortedBy();\n\n\t\tawait raceStore.loadPublicInteractions(raceid);\n\t}\n\n    likeRace = async () => {\n\t\tconst { raceStore } = this.props.stores;\n\t\tconst { race } = raceStore;\n\t\tconst response = await raceStore.likeRace({ id: race.id });\n\n        if (response && response.status === 200) {\n\t\t\t// this.loadRaceDetail({ race });\n\t\t}\n\t}\n\n\ttoggleAddComment = (e) => {\n\t\tconst raceId = e.target.parentElement.dataset.id || e.target.dataset.id;\n\t\tconst { showAddComment } = this.state;\n\t\tthis.setState({\n\t\t\tshowAddComment: !showAddComment,\n\t\t}, () => {\n\t\t\tif (this.inputRef[raceId]) {\n\t\t\t\tthis.inputRef[raceId].focus();\n\t\t\t}\n\t\t});\n\t}\n\n\tchooseSubmenu = (e) => {\n\t\tconst submenu = e.target.parentElement.dataset.menu || e.target.dataset.menu;\n\t\tthis.setState({ submenu });\n        const { raceid } = this.props;\n        route(`/app-races/${raceid}/${submenu}`);\n\t}\n\n    resizeTextarea = (el) => {\n\t\tlet element = el;\n\t\tif (element.target) {\n\t\t\telement = el.target;\n\t\t}\n\t\tconst { scrollHeight } = element;\n\t\telement.style.height = `${scrollHeight}px`;\n\t}\n\n\tresizeAllTextareas = () => {\n\t\tconst textareaList = document.getElementsByTagName('textarea');\n\t\tfor(let i = 0, l = textareaList.length; i < l; i += 1){\n\t\t\tconst textarea = textareaList[i];\n\t\t\tthis.resizeTextarea(textarea);\n\t\t}\n\t}\n\n    addNavigation = (props) => {\n        // console.log({ props });\n        this.setState({ submenu: props.submenu });\n    }\n\n\tcomponentDidMount() {\n\t\tthis.loadRace();\n        this.resizeAllTextareas();\n\t}\n\n    componentWillReceiveProps(nextProps) {\n        if (nextProps.raceid !== this.props.raceid) {\n            this.loadRace(nextProps);\n        }\n        // console.log('componentWillReceiveProps', nextProps.submenu, this.props.submenu);\n        if (nextProps.submenu !== this.props.submenu) {\n            this.addNavigation(nextProps);\n        }\n\t}\n\n    back = () => {\n        route(`/`);\n    }\n\n\trender() {\n        const { submenu } = this.state;\n        const { showAdminSendMessage, message, emailResponse } = this.state;\n        const { showAddComment, newRaceArticle, newRaceUserImage } = this.state;\n\n\t\tconst { userStore, raceStore, appState } = this.props.stores;\n\t\tconst { user = {}, teams = [], isAdmin } = userStore;\n        const { language = 'en' } = user;\n\n\t\tconst { raceid, subsection } = this.props;\n\t\tconst { race, signup, zoomToMarkers } = raceStore;\n        const { darkmode, displayDetails, editUserDetails } = appState;\n\n\t\tconst { likes = [], comments = [] } = race;\n\t\tconst hasLikedRace = race.likes && race.likes.findIndex(e => e.user === user.id) > -1;\n\n        const today = new Date();\n        let status = '';\n        if (today >= new Date(race.startDate) && today <= new Date(race.endDate)) {\n            status = 'race';\n        } else if (today >= new Date(race.signupStartDate) && today <= new Date(race.signupEndDate)) {\n            status = 'signup';\n        }\n        const isLiveRace = race.liveRace === 1;\n        const showSignup = isLiveRace ? !!signup.email : true;\n\n        if (submenu === 'tracking') {\n            return (\n                <RaceTracking stores={this.props.stores} raceid={raceid} />\n            );\n        }\n\n\t\treturn (\n\t\t\t<div class='container-fluid' style={`margin-bottom: ${MARGIN_BOTTOM}; margin-top: ${MARGIN_TOP};`}>\n                <button class='btn btn-link pl-0 fixed-top text-primary'\n                    style={`top: ${MARGIN_TOP_BACK}; left: 5px; font-size: 35px; width: 45px;`}\n                    onClick={this.back}>\n                    <i class='fas fa-arrow-circle-left' />\n                </button>\n\n                <div class='row m-0'>\n\t\t\t\t\t<div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-1 mb-2 p-0'>\n                        <div class='row d-flex align-items-center position-relative'>\n                            <h3 class='position-absolute' style='top: 3px; right: 5px;'>\n                                {status === 'signup' && !isLiveRace && <>\n                                    <span\n                                        class='badge badge-primary badge-lg border border-white ml-2'\n                                        data-menu='signup'\n                                        onClick={this.chooseSubmenu}\n                                    >\n                                        <Text id='races.signup-open'>Pmelding pen</Text>\n                                    </span>\n                                </>}\n                                {status === 'race' && <>\n                                    <span class='badge badge-danger border border-white ml-2'><Text id='races.race-in-progress'>Lp pgr</Text></span>\n                                </>}\n                                {status === 'done' && <>\n                                    <span class='badge badge-success border border-white ml-2'><Text id='races.race-finished'>Lp avsluttet</Text></span>\n                                </>}\n                            </h3>\n                            {(race.images && race.images[0]) ? <img src={race.images[0].s3LargeLink} class='img-fluid' /> : ''}\n                        </div>\n                    </div>\n                </div>\n\n                <div class='row'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        {isAdmin && <>\n                            <a class='btn btn-primary float-right' href={`https://homerunrace.no/index#/race/${race.id}/edit`}>Edit</a>\n                        </>}\n                        <h3>{race.title}</h3>\n                        <div>\n                            {race.startDate && <><Text id='races.periode'>Periode</Text>: {util.formatDate(race.startDate, { locale: 'no-NB', hour12: false, hour: '2-digit', minute: '2-digit' })}</>}\n                            {race.endDate && <> - {util.formatDate(race.endDate, { locale: 'no-NB', hour12: false, hour: '2-digit', minute: '2-digit' })}</>}\n                        </div>\n                    </div>\n                </div>\n\n                <div class='row'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3'>\n                        <div class='row'>\n                            <div class='w-100 overflow-hidden'>\n                                <div\n                                    class='d-flex flex-row flex-nowrap pb-2 px-1'\n                                    style='overflow: auto; scroll-snap-type: x mandatory;'\n                                >\n                                    <div class='col px-0 pt-2'>\n                                        <button\n                                            class={`btn btn-block rounded-pill-left rounded-none ${submenu === 'about' ? 'btn-primary' : 'btn-outline-primary'} text-nowrap`}\n                                            style='text-overflow: ellipsis; overflow: hidden;'\n                                            data-menu='about'\n                                            onClick={this.chooseSubmenu}\n                                        ><i class='fas fa-info-circle' /> <Text id='race.about'>About</Text></button>\n                                        {submenu === 'about' && <ScrollIntoView horizontal={'center'} vertical={'end'} />}\n                                    </div>\n                                    <div class='col px-0 pt-2'>\n                                        <button\n                                            class={`btn btn-block rounded-none ${submenu === 'results' ? 'btn-primary' : 'btn-outline-primary'} text-nowrap`}\n                                            style='text-overflow: ellipsis; overflow: hidden;'\n                                            data-menu='results'\n                                            onClick={this.chooseSubmenu}\n                                        ><i class='fas fa-list-ol' /> <Text id='race.results'>Results</Text></button>\n                                        {submenu === 'results' && <ScrollIntoView horizontal={'center'} vertical={'end'} />}\n                                    </div>\n                                    <div class='col px-0 pt-2'>\n                                        <button\n                                            class={`btn btn-block rounded-none ${submenu === 'tracking' ? 'btn-primary' : 'btn-outline-primary'} text-nowrap`}\n                                            style='text-overflow: ellipsis; overflow: hidden;'\n                                            data-menu='tracking'\n                                            onClick={this.chooseSubmenu}\n                                        ><i class='fas fa-map-marker-alt' /> <Text id='race.tracking'>Tracking</Text></button>\n                                        {submenu === 'tracking' && <ScrollIntoView horizontal={'center'} vertical={'end'} />}\n                                    </div>\n                                    <div class='col px-0 pt-2'>\n                                        <button\n                                            class={`btn btn-block rounded-none ${submenu === 'news' ? 'btn-primary' : 'btn-outline-primary'} text-nowrap`}\n                                            style='text-overflow: ellipsis; overflow: hidden;'\n                                            data-menu='news'\n                                            onClick={this.chooseSubmenu}\n                                        ><i class='fas fa-rss' /> <Text id='race.news'>News</Text></button>\n                                        {submenu === 'news' && <ScrollIntoView horizontal={'center'} vertical={'end'} />}\n                                    </div>\n                                    <div class='col px-0 pt-2'>\n                                        <button\n                                            class={`btn btn-block rounded-none ${submenu === 'userImages' ? 'btn-primary' : 'btn-outline-primary'} text-nowrap`}\n                                            style='text-overflow: ellipsis; overflow: hidden;'\n                                            data-menu='userImages'\n                                            onClick={this.chooseSubmenu}\n                                        ><i class='fas fa-images' /> <Text id='race.user-images'>User images</Text></button>\n                                        {submenu === 'userImages' && <ScrollIntoView horizontal={'center'} vertical={'end'} />}\n                                    </div>\n                                    {race.rules && <div class='col px-0 pt-2'>\n                                        <button\n                                            class={`btn btn-block rounded-none ${submenu === 'rules' ? 'btn-primary' : 'btn-outline-primary'} text-nowrap`}\n                                            style='text-overflow: ellipsis; overflow: hidden;'\n                                            data-menu='rules'\n                                            onClick={this.chooseSubmenu}\n                                        ><i class='fas fa-gavel' /> <Text id='race.rules'>Rules</Text></button>\n                                        {submenu === 'rules' && <ScrollIntoView horizontal={'center'} vertical={'end'} />}\n                                    </div>}\n                                    {race.veterinaryInfo && <div class='col px-0 pt-2'>\n                                        <button\n                                            class={`btn btn-block rounded-none ${submenu === 'veterinary' ? 'btn-primary' : 'btn-outline-primary'} text-nowrap`}\n                                            style='text-overflow: ellipsis; overflow: hidden;'\n                                            data-menu='veterinary'\n                                            onClick={this.chooseSubmenu}\n                                        ><i class='fas fa-stethoscope' /> <Text id='race.veterinary'>Veterinary info</Text></button>\n                                        {submenu === 'veterinary' && <ScrollIntoView horizontal={'center'} vertical={'end'} />}\n                                    </div>}\n                                    {race.checkpoints && <div class='col px-0 pt-2'>\n                                        <button\n                                            class={`btn btn-block rounded-none ${submenu === 'checkpoints' ? 'btn-primary' : 'btn-outline-primary'} text-nowrap`}\n                                            style='text-overflow: ellipsis; overflow: hidden;'\n                                            data-menu='checkpoints'\n                                            onClick={this.chooseSubmenu}\n                                        ><i class='fas fa-map-marker-alt' /> <Text id='race.checkpoints'>Checkpoints</Text></button>\n                                        {submenu === 'checkpoints' && <ScrollIntoView horizontal={'center'} vertical={'end'} />}\n                                    </div>}\n                                    {race.trailDescription && <div class='col px-0 pt-2'>\n                                        <button\n                                            class={`btn btn-block rounded-none ${submenu === 'track' ? 'btn-primary' : 'btn-outline-primary'} text-nowrap`}\n                                            style='text-overflow: ellipsis; overflow: hidden;'\n                                            data-menu='track'\n                                            onClick={this.chooseSubmenu}\n                                        ><i class='fas fa-map-signs' /> <Text id='race.track-description'>Track description</Text></button>\n                                        {submenu === 'track' && <ScrollIntoView horizontal={'center'} vertical={'end'} />}\n                                    </div>}\n                                    {race.program && <div class='col px-0 pt-2'>\n                                        <button\n                                            class={`btn btn-block rounded-none ${submenu === 'program' ? 'btn-primary' : 'btn-outline-primary'} text-nowrap`}\n                                            style='text-overflow: ellipsis; overflow: hidden;'\n                                            data-menu='program'\n                                            onClick={this.chooseSubmenu}\n                                        ><i class='fas fa-list-alt' /> <Text id='race.program'>Program</Text></button>\n                                        {submenu === 'program' && <ScrollIntoView horizontal={'center'} vertical={'end'} />}\n                                    </div>}\n                                    {race.prices && <div class='col px-0 pt-2'>\n                                        <button\n                                            class={`btn btn-block rounded-none ${submenu === 'prices' ? 'btn-primary' : 'btn-outline-primary'} text-nowrap`}\n                                            style='text-overflow: ellipsis; overflow: hidden;'\n                                            data-menu='prices'\n                                            onClick={this.chooseSubmenu}\n                                        ><i class='fas fa-award' /> <Text id='race.prices'>Premier</Text></button>\n                                        {submenu === 'prices' && <ScrollIntoView horizontal={'center'} vertical={'end'} />}\n                                    </div>}\n                                    {!isLiveRace && <div class='col px-0 pt-2'>\n                                        <button\n                                            class={`btn btn-block rounded-none ${submenu === 'classes' ? 'btn-primary' : 'btn-outline-primary'} text-nowrap`}\n                                            style='text-overflow: ellipsis; overflow: hidden;'\n                                            data-menu='classes'\n                                            onClick={this.chooseSubmenu}\n                                        ><i class='fas fa-folder-open' /> <Text id='race.classes'>Classes</Text></button>\n                                        {submenu === 'classes' && <ScrollIntoView horizontal={'center'} vertical={'end'} />}\n                                    </div>}\n                                    <div class='col px-0 pt-2'>\n                                        <button\n                                            class={`btn btn-block rounded-none ${showSignup ? '' : 'rounded-pill-right'} ${submenu === 'mushers' ? 'btn-primary' : 'btn-outline-primary'} text-nowrap`}\n                                            style='text-overflow: ellipsis; overflow: hidden;'\n                                            data-menu='mushers'\n                                            onClick={this.chooseSubmenu}\n                                        ><i class='fas fa-users' /> <Text id='races.mushers'>Mushers</Text></button>\n                                        {submenu === 'mushers' && <ScrollIntoView horizontal={'center'} vertical={'end'} />}\n                                    </div>\n                                    {showSignup && <div class='col px-0 pt-2'>\n                                        <button\n                                            class={`btn btn-block rounded-pill-right rounded-none ${submenu === 'signup' ? 'btn-primary' : 'btn-outline-primary'} text-nowrap`}\n                                            style='text-overflow: ellipsis; overflow: hidden;'\n                                            data-menu='signup'\n                                            onClick={this.chooseSubmenu}\n                                        ><i class='fas fa-user-edit' /> <Text id='race.signup'>Sign up</Text></button>\n                                        {submenu === 'signup' && <ScrollIntoView horizontal={'center'} vertical={'end'} />}\n                                    </div>}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                {submenu === 'about' && <>\n                    <RaceNotifications stores={this.props.stores} race={race} />\n                    <div class='row'>\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2'>\n                            <h2 class='mb-0'><Text id='race.about'>Om lpet</Text></h2>\n                        </div>\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2'>\n                            <p class='clearfix'>\n                                <strong>\n                                    <Markdown markdown={mu.replaceImages(race.ingress, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                                </strong>\n                            </p>\n\n                            {status === 'signup' && <>\n                                {isLiveRace ? <>                                \n                                    <button\n                                        class='btn btn-block btn-success mb-3'\n                                        data-menu='signup'\n                                        onClick={this.chooseSubmenu}\n                                    >\n                                        <i class='fas fa-user-edit' /> <Text id='race.declaration'>Declaration</Text> & <Text id='race.chiplist'>Chiplist</Text>\n                                    </button>\n                                </> : <>                                \n                                    <button\n                                        class='btn btn-block btn-success mb-3'\n                                        data-menu='signup'\n                                        onClick={this.chooseSubmenu}\n                                    >\n                                        <i class='fas fa-user-edit' /> <Text id='race.signup'>Sign up</Text>\n                                    </button>\n                                </>}\n                            </>}\n\n                            <Markdown markdown={mu.replaceImages(race.body, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                        </div>\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2'>\n                            {race.tag && race.tag.split(',').map(tag => <>\n                                <span class='badge badge-pill badge-primary py-1 ml-2'>\n                                    <a class='text-white' href={`https://www.facebook.com/hashtag/${tag}`} target='_blank' rel='noreferrer' native>\n                                        <i class='fab fa-facebook' /> #{tag}\n                                    </a>\n                                </span>\n                                <span class='badge badge-pill badge-primary py-1 ml-2'>\n                                    <a class='text-white' href={`https://www.instagram.com/explore/tags/${tag}`} target='_blank' rel='noreferrer' native>\n                                        <i class='fab fa-instagram' /> #{tag}\n                                    </a>\n                                </span>\n                            </>)}\n                        </div>\n                    </div>\n                </>}\n                {submenu === 'results' && <>\n                    <RaceNotifications stores={this.props.stores} race={race} />\n                    <RaceResults stores={this.props.stores} raceid={raceid} />\n                </>}\n                {submenu === 'tracking' && <>\n                    <RaceTracking stores={this.props.stores} raceid={raceid} />\n                </>}\n                {submenu === 'news' && <>\n                    <RaceNews stores={this.props.stores} race={race} />\n                </>}\n                {submenu === 'userImages' && <>\n                    <RaceUserImages stores={this.props.stores} race={race} />\n                </>}\n                {submenu === 'rules' && <>\n                    <div class='row'>\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2'>\n                            <h2 class='mb-0'><Text id='race.rules'>Regler</Text></h2>\n                        </div>\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2'>\n                            <Markdown markdown={mu.replaceImages(race.rules, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                        </div>\n                    </div>\n                </>}\n                {submenu === 'veterinary' && <>\n                    <div class='row'>\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2'>\n                            <h2 class='mb-0'><Text id='race.veterinary'>Veterinrinfo</Text></h2>\n                        </div>\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2'>\n                            <Markdown markdown={mu.replaceImages(race.veterinaryInfo, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                        </div>\n                    </div>\n                </>}\n                {submenu === 'checkpoints' && <>\n                    <div class='row'>\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2'>\n                            <h2 class='mb-0'><Text id='race.checkpoints'>Sjekkpunkter</Text></h2>\n                        </div>\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2'>\n                            <Markdown markdown={mu.replaceImages(race.checkpoints, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                        </div>\n                    </div>\n                </>}\n                {submenu === 'track' && <>\n                    <div class='row'>\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2'>\n                            <h2 class='mb-0'><Text id='race.track-description'>Lypebeskrivelse</Text></h2>\n                        </div>\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2'>\n                            <Markdown markdown={mu.replaceImages(race.trailDescription, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                        </div>\n                    </div>\n                </>}\n                {submenu === 'program' && <>\n                    <div class='row'>\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2'>\n                            <h2 class='mb-0'><Text id='race.program'>Program</Text></h2>\n                        </div>\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2'>\n                            <Markdown markdown={mu.replaceImages(race.program, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                        </div>\n                    </div>\n                </>}\n                {submenu === 'prices' && <>\n                    <div class='row'>\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2'>\n                            <h2 class='mb-0'><Text id='race.prices'>Premier</Text></h2>\n                        </div>\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2'>\n                            <Markdown markdown={mu.replaceImages(race.prices, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                        </div>\n                    </div>\n                </>}\n                {submenu === 'mushers' && <>\n                    <RaceMushers stores={this.props.stores} race={race} />\n                </>}\n                {submenu === 'classes' && <>\n                    <RaceClasses stores={this.props.stores} race={race} />\n                </>}\n                {submenu === 'signup' && <>\n                    <RaceSignup stores={this.props.stores} race={race} />\n                </>}\n\n                {['about'].indexOf(submenu) > -1 && <>\n                    <div class='row'>\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2'>\n                            <div class=''>\n                                <LikesAndComments\n                                    stores={this.props.stores}\n                                    likes={likes}\n                                    comments={comments}\n                                    type='race'\n                                    // onTeamClick={onTeamClick}\n                                    // onUserClick={onUserClick}\n                                />\n                            </div>\n                        </div>\n\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-2 mb-3'>\n                            <div class='row'>\n                                <div class='col-6 text-center'>\n                                    <button type='button' class={`btn btn-outline-${hasLikedRace ? 'primary' : 'secondary'} btn-lg btn-block ${hasLikedRace ? 'text-primary' : ''}`}\n                                        onClick={this.likeRace}\n                                        // disabled={hasLikedRace}\n                                    >\n                                        <i class={`${hasLikedRace ? 'text-primary fas' : 'far'} fa-thumbs-up`} /> {hasLikedRace ? <Text id='comments.has-liked'>Liked</Text> : <Text id='comments.like'>Lik</Text>}\n                                    </button>\n                                </div>\n                                <div class='col-6 text-center'>\n                                    <button type='button' class='btn btn-outline-secondary btn-lg btn-block'\n                                        data-id={race.id}\n                                        onClick={this.toggleAddComment}\n                                    >\n                                        <i class='fas fa-comment' /> <Text id='comments.comment-add'>Comment</Text>\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-2 mb-3'>\n                            {showAddComment && user.email && <RaceAddComment\n                                stores={this.props.stores}\n                                race={race}\n                                // callback={this.loadRaceDetail}\n                                inputRef={c => this.inputRef[race.id] = c}\n                                inputRefObject={this.inputRef}\n                            />}\n                        </div>\n                        <div class='col-12 mt-2'>\n                            <RaceComments\n                                stores={this.props.stores}\n                                race={race}\n                                cols='12'\n                                // callback={this.loadRaceDetail}\n                            />\n                        </div>\n                    </div>\n                </>}\n            </div>\n\t\t);\n\t}\n}\n\nexport default AppRaceDetailSignup;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport { route } from 'preact-router';\nimport Markdown from 'preact-markdown';\nimport linkstate from 'linkstate';\n\nimport mu from '../../lib/musher-util';\n\n@observer\nclass AppRaceDetailClasses extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n        };\n\t\tthis.inputRef = {};\n        this.updateTimer = {};\n    }\n\n    render() {\n\t\tconst { userStore, raceStore, appState } = this.props.stores;\n\t\tconst { user = {}, teams = [], isAdmin } = userStore;\n        const { language = 'en' } = user;\n\n\t\tconst { race = {} } = this.props;\n\n        return (<>\n            <div class='row'>\n                <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2'>\n                    <h2 class='mb-0'><Text id='race.classes'>Klasser</Text></h2>\n                </div>\n                <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2'>\n                    <div class='row'>\n                        {race.classes && race.classes.sort((a, b) => a.distance - b.distance).map(currentClass => <>\n                            <div class='col-12 col-sm-6 col-lg-4 mb-4'>\n                                <div class='border rounded rounded-lg p-3'>\n                                    <h5>{currentClass.title}</h5>\n\n                                    {isAdmin && <>\n                                        <a href={`/tv/top10/${race.id}/${currentClass.id}`}>TV Top 10</a>\n                                    </>}\n\n                                    <small>\n                                        {currentClass.startDate && <div>\n                                            <span class='font-weight-lighter'><Text id='race.startdate'>Start</Text>:</span> {util.formatDate(`${currentClass.startDate} ${currentClass.startTime || '00:00:00'}`, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}\n                                        </div>}\n                                        {currentClass.endDate && <div>\n                                            <span class='font-weight-lighter'><Text id='race.enddate'>End</Text>:</span> {util.formatDate(`${currentClass.endDate} ${currentClass.endTime || '00:00:00'}`, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}\n                                        </div>}\n                                    </small>\n\n                                    <div><span class='font-weight-lighter'><Text id='race.distance'>Distanse</Text>:</span> {currentClass.distance} km</div>\n                                    <div><span class='font-weight-lighter'><Text id='race.signup'>Pmelding</Text>:</span> {currentClass.signupfee || race.signupfee} NOK</div>\n                                    <p class='clearfix'>\n                                        <Markdown markdown={mu.replaceImages(currentClass.ingress, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                                    </p>\n                                    <small>\n                                        <Markdown markdown={mu.replaceImages(currentClass.body, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                                    </small>\n                                    {currentClass.rules && <>\n                                        <h5><Text id='race.rules'>Regler</Text></h5>\n                                        <Markdown markdown={mu.replaceImages(currentClass.rules, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                                    </>}\n                                </div>\n                            </div>\n                        </>)}\n                    </div>\n                </div>\n            </div>\n        </>);\n    }\n}\n\nexport default AppRaceDetailClasses;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport { route } from 'preact-router';\nimport Markdown from 'preact-markdown';\nimport linkstate from 'linkstate';\n\nimport ScrollIntoView from '../../components/util/scrollIntoView';\n\nimport mu from '../../lib/musher-util';\n\nconst initialState = {\n\tisLoading: false,\n\tcontentIsNotLoaded: true,\n\n\treloadInSec: null,\n\treloadLastEpoch: null,\n\treloadIsActive: false,\n};\n\nconst RELOAD_INTERVAL_IN_SEC = 60;\n\nfunction raceStatus(musher) {\n\tswitch (musher.raceStatus) {\n\t\tcase 'OK':\n\t\t\treturn (<>\n\t\t\t\t<span class='position-absolute rounded-lg' style='top: 10px; left: 0px;'><i class='fas fa-check text-success' /></span>\n\t\t\t</>);\n\t\tcase 'DNS':\n\t\t\treturn (<>\n\t\t\t\t<span class='position-absolute bg-danger text-white text-center px-2 rounded-lg border' style='top: 5px; left: -100px; width: 80px'><i class='fas fa-info-circle' /> {musher.raceStatus}</span>\n\t\t\t</>);\n\t\tcase 'DNF':\n\t\t\treturn (<>\n\t\t\t\t<span class='position-absolute bg-danger text-white text-center px-2 rounded-lg border' style='top: 5px; left: -100px; width: 80px'><i class='fas fa-info-circle' /> {musher.raceStatus}</span>\n\t\t\t</>);\n\t\tcase 'DNQ':\n\t\t\treturn (<>\n\t\t\t\t<span class='position-absolute bg-danger text-white text-center px-2 rounded-lg border' style='top: 5px; left: -100px; width: 80px'><i class='fas fa-info-circle' /> {musher.raceStatus}</span>\n\t\t\t</>);\n\t\tcase 'DQ':\n\t\t\treturn (<>\n\t\t\t\t<span class='position-absolute bg-danger text-white text-center px-2 rounded-lg border' style='top: 5px; left: -100px; width: 80px'><i class='fas fa-info-circle' /> {musher.raceStatus}</span>\n\t\t\t</>);\n\t\tcase 'DC':\n\t\t\treturn (<>\n\t\t\t\t<span class='position-absolute bg-warning text-white text-center px-2 rounded-lg border' style='top: 5px; left: -150px; width: 80px'><i class='fas fa-info-circle' /> {musher.raceStatus}</span>\n\t\t\t</>);\n\t\tdefault:\n\t\t\treturn '';\n\t}\n}\n\n@observer\nclass ReloadTimer extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n\t\tthis.updateTimer = {};\n    }\n\n\tinitComponent = () => {\n\t\tconst reloadLastEpoch = Math.floor(new Date().getTime() / 1000);\n\t\tthis.setState({\n\t\t\treloadIsActive: true,\n\t\t\treloadLastEpoch,\n\t\t}, () => this.tickReloadTimeer());\n\t}\n\n\ttickReloadTimeer() {\n\t\tconst { reloadIsActive, reloadLastEpoch } = this.state;\n        if (reloadIsActive) {\n\t\t\tconst now = Math.floor(new Date().getTime() / 1000);\n\t\t\tconst reloadInSec = RELOAD_INTERVAL_IN_SEC - (now - reloadLastEpoch);\n\t\t\tthis.setState({ reloadInSec });\n\t\t\tclearTimeout(this.updateTimer.tick);\n\t\t\tthis.updateTimer.tick = setTimeout(() => this.tickReloadTimeer(), 1000);\n        }\n\t\treturn false;\n    }\n\n\tcomponentDidMount() {\n\t\tthis.initComponent();\n\t}\n\n\tcomponentWillUnmount() {\n\t\tclearTimeout(this.updateTimer.tick);\n\t}\n\n\trender() {\n\t\tconst { reloadInSec } = this.state;\n\t\tconst reloadPercent = Math.floor(util.normalizeBetween(reloadInSec, 0, RELOAD_INTERVAL_IN_SEC, 0, 100))\n\n\t\treturn (<>\n\t\t\t<div class='progress fixed-top' style='height: 2px; z-index: 999999;'>\n\t\t\t\t<div class='progress-bar' role='progressbar' style={`width: ${reloadPercent}%;`} aria-valuenow={reloadPercent} aria-valuemin='0' aria-valuemax='100' />\n\t\t\t</div>\n\t\t</>);\n\t}\n}\n\n@observer\nclass AppRaceDetailResults extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n        };\n\t\tthis.inputRef = {};\n        this.updateTimer = {};\n    }\n\n\tasync loadRace(props = this.props) {\n\t\tthis.setState({ isLoading: true });\n\t\tconst { raceStore } = props.stores;\n\t\tconst { raceid } = props;\n        await raceStore.load(raceid);\n        const { race } = raceStore;\n\n\t\tconst allTeamIds = race.classes.filter(currentClass => currentClass.contestants && currentClass.contestants.length > 0).map((currentClass) => {\n            return currentClass.contestants.filter(musher => musher.team > 0).map(musher => musher.team);\n\t\t}).flat();\n\t\t\n        if (allTeamIds.length > 0 && raceid) {\n\t\t\tawait raceStore.loadTeams(allTeamIds.join(','));\n\t\t\tawait raceStore.loadWorkoutSummary(allTeamIds.join(','), raceid);\n\t\t\traceStore.getWorkoutSummaryActiveTeams();\n\t\t}\n\t\traceStore.getAllClassesSortedBy();\n\n\t\t// Set reload timer\n\t\tclearTimeout(this.updateTimer.reload);\n\t\tthis.updateTimer.reload = setTimeout(async () => {\n\t\t\tconst reloadLastEpoch = Math.floor(new Date().getTime() / 1000);\n\t\t\tthis.setState({ reloadLastEpoch });\n\t\t\tthis.loadRace();\n\t\t}, RELOAD_INTERVAL_IN_SEC * 1000);\n\n\t\tthis.setState({\n\t\t\tisLoading: false,\n\t\t\tcontentIsNotLoaded: false,\n\t\t});\n\t}\n\n\ttoggleDisplayDetails = (e) => {\n\t\tconst email = e.target.closest('tr').dataset.email;\n\t\tconst { appState } = this.props.stores;\n\t\tappState.toggleDisplayDetails(email)\n\t}\n\n\tadminToggleEditUser = (e) => {\n\t\te.stopPropagation();\n\t\tconst email = e.target.closest('tr').dataset.email;\n\t\tconst { appState } = this.props.stores;\n\t\tappState.toggleEditUserDetails(email)\n\t}\n\n\tadminSignupEdit = (e) => {\n\t\tconst { raceid } = this.props;\n        const { raceStore } = this.props.stores;\n        const field = e.target.id;\n        const value = e.target.value;\n        const { classid, contestantid } = e.target.dataset;\n\n        // console.log({ raceid, field, value, classid });\n        // const { raceStore } = this.props.stores;\n        // raceStore.updateObjectKeyValue('signup', key, value);\n\n        const data = {\n\t\t\traceClassId: classid,\n            contestantId: contestantid,\n\t\t\t[`raceClassContestant${util.ucfirst(field)}`]: value,\n\t\t};\n\t\tclearTimeout(this.updateTimer[field]);\n\t\tthis.updateTimer[field] = setTimeout(async () => {\n\t\t\traceStore.editClass({\n\t\t\t\tid: raceid,\n\t\t\t\tdata,\n\t\t\t});\n\t\t}, 500);\n\t}\n\n\tlockAllWorkoutsInRace = async () => {\n\t\tconst { raceid } = this.props;\n        const { raceStore } = this.props.stores;\n\t\tconst lockMessage = await raceStore.lockAllWorkoutsInRace({ id: raceid });\n\t\tthis.setState({ lockMessage });\n\t}\n\n\tfilterByClass = (e) => {\n\t\tconst selectedClassId = e.target.closest('button').dataset.id;\n\t\tconst { appState } = this.props.stores;\n\t\tappState.toggleSelectedClassId(selectedClassId, true);\n\t}\n\n\tcomponentWillUnmount() {\n\t\tclearTimeout(this.updateTimer.reload);\n\t\tclearTimeout(this.updateTimer.tick);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.loadRace();\n\t}\n\n    render() {\n\t\tconst { contentIsNotLoaded, lockMessage } = this.state;\n\t\tconst { userStore, raceStore, appState } = this.props.stores;\n\t\tconst { user = {}, teams = [], isAdmin } = userStore;\n        const { language = 'en' } = user;\n\n        const { darkmode, displayDetails, editUserDetails, selectedClassIds = [] } = appState;\n\n\t\tconst { race = {}, teamList, classes = [] } = raceStore;\n\t\tconst { activeTeams, waypoints, zoomToMarkers } = raceStore;\n\n\t\tconst lastAllowedChangeDate = new Date(race.endDate);\n\t\tlastAllowedChangeDate.setHours(lastAllowedChangeDate.getHours() + 2);\n\n\t\tconst filterByClassId = (c) => {\n\t\t\tif (selectedClassIds.length > 0) {\n\t\t\t\treturn selectedClassIds.indexOf(c.id) > -1;\n\t\t\t}\n\t\t\treturn true;\n\t\t};\n\n        const isLiveRace = race.liveRace === 1;\n\n        return (<>\n            <div class='row'>\n                <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-0 mb-2'>\n                    <h2 class='mb-0'><Text id='race.results'>Results</Text></h2>\n                </div>\n                <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2'>\n                    <ReloadTimer stores={this.props.stores} />\n                    {isLiveRace ? <>\n                    \n                    </> : <>                    \n                        {user.email && <div class='alert alert-primary' role='alert'>\n                            {language === 'no' && <>\n                                Resultatene hentes direkte fra treningsktene i QPaws appen.<br />\n                                <strong>For at treningsktene skal bli registrert m ktene:</strong>\n                                <ul>\n                                    <li>Ha riktig dato som er innenfor lpsperioden.</li>\n                                    <li>Vre markert som 'Konkurranse'.</li>\n                                    <li>Vre registrert p teamet som er pmeldt.</li>\n                                </ul>\n                            </>}\n                            {language === 'en' && <>\n                                The results are imported directly from the workouts inside QPaws app.<br />\n                                <strong>To make sure your workouts are registered check the following:</strong>\n                                <ul>\n                                    <li>Use the correct date on your workout. Has to be inside the race period.</li>\n                                    <li>Mark the workout as 'Race'.</li>\n                                    <li>Workout has to be on the same team as you signed up with.</li>\n                                </ul>\n                            </>}\n                        </div>}\n                    </>}\n\n                    {race.resultsUrl ? <div class='p-3 my-4 bg-light'>\n                        <a href={race.resultsUrl} target='_blank' rel='noreferrer' native>\n                            {race.resultsText ? race.resultsText : <><Text id='races.results-here'>Se resultater her</Text> </>} <i class='fas fa-chevron-circle-right' />\n                        </a>\n                    </div> : <>\n\n                    </>}\n\n                    {(contentIsNotLoaded || !classes || classes.length === 0) && <div class='d-flex justify-content-center my-5 py-5'>\n                        <div class='spinner-border text-primary' role='status'>\n                            <span class='sr-only'>Loading...</span>\n                        </div>\n                    </div>}\n                </div>\n\n                <div class='col-12'>\n                    <div class='row'>\n                        <div class='w-100 overflow-hidden'>\n                            <div\n                                class='d-flex flex-row flex-nowrap pb-2 px-1'\n                                style='overflow: auto; scroll-snap-type: x mandatory;'\n                            >\n\n                                {race.classes && race.classes.sort((a, b) => a.distance - b.distance).map((currentClass, idx) => <>\n                                    <div class='col px-0 pt-2'>\n                                        <button\n                                            type='button'\n                                            class={`btn btn-block ${idx === 0 && 'rounded-pill-left'} ${idx === race.classes.length - 1 && 'rounded-pill-right'} rounded-none ${selectedClassIds.indexOf(currentClass.id) > -1 ? 'btn-primary' : 'btn-outline-primary'} text-nowrap`}\n                                            style='text-overflow: ellipsis; overflow: hidden;'\n                                            onClick={this.filterByClass}\n                                            data-id={currentClass.id}\n                                        >\n                                            {currentClass.title}\n                                        </button>\n                                    </div>\n                                </>)}\n\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <div class='col-12'>\n                    {race.classes && race.classes.filter(filterByClassId).sort((a, b) => a.distance - b.distance).map(currentClass => <div class='mt-5 mb-5'>\n                        {race.resultDanger && <div class='alert alert-danger' role='alert'>\n                            <div class='spinner-grow text-danger float-left' role='status'>\n                                <span class='sr-only'>Loading...</span>\n                            </div>\n                            <i class='fas fa-exclamation-triangle float-left mr-4' style='font-size: 2.0em;' />\n                            <Markdown markdown={mu.replaceImages(race.resultDanger, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                        </div>}\n                        {race.resultWarning && <div class='alert alert-warning' role='alert'>\n                            <i class='fas fa-exclamation float-left mr-4' style='font-size: 2.0em;' />\n                            <Markdown markdown={mu.replaceImages(race.resultWarning, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                        </div>}\n                        {race.resultSuccess && <div class='alert alert-success' role='alert'>\n                            <i class='fas fa-check float-left mr-4' style='font-size: 2.0em;' />\n                            <Markdown markdown={mu.replaceImages(race.resultSuccess, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                        </div>}\n\n                        <h3>{currentClass.title} {currentClass.startDate && <>\n                                : <span class='font-weight-lighter'>\n                                    {util.formatDate(`${currentClass.startDate} ${currentClass.startTime || '00:00:00'}`, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })} - {util.formatDate(`${currentClass.endDate} ${currentClass.endTime || '00:00:00'}`, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}\n                                </span>\n                            </>}\n                        </h3>\n                        <span class='float-right'>\n                            <span class='text-muted'><Text id='races.mushers'>Mushers</Text>: {currentClass.totalMushers || 0}</span>\n                            <span class='text-muted ml-4'><Text id='races.finished-mushers'>Finished mushers</Text>: {currentClass.totalFinished || 0} </span>\n                        </span>\n\n                        <div class='table-responsive-md'>\n                            <table class='table table-sm table-striped'>\n                                <thead>\n                                    <tr>\n                                        <th scope='col'>#</th>\n                                        <th scope='col' style='min-width: 200px;'><Text id='races.name'>Navn</Text></th>\n                                        {isAdmin && <>\n                                            <th class='d-none d-lg-table-cell' scope='col'><i class='fas fa-user-shield' /> Cellphone</th>\n                                            <th class='d-none d-lg-table-cell' scope='col'><i class='fas fa-user-shield' /> Email</th>\n                                        </>}\n                                        <th scope='col' class='d-none d-lg-table-cell' style='min-width: 400px;'><Text id='races.stages'>Etapper</Text></th>\n                                        <th scope='col'><Text id='races.result'>Resultat</Text></th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    {classes[currentClass.id] && classes[currentClass.id].contestants && classes[currentClass.id].contestants.map((contestant, idx) => {\n                                        const { musher, currentTeam, currentStages, currentResults, completed, duration,\n                                            normalizedDuration, weightedNormalizedDuration, totalKcalRelated, weightedTotalKcal,\n                                            flatTotalKcal, percentHarder, loadIndex, raceDistance, isDone, normalizedKcal, normalizedFlatKcal,\n                                            finishedDate, totalWorkoutTimeUsedSec,\n                                        } = contestant;\n\n                                        const totals = raceStore.getTotalsByTeamId(currentTeam.id);\n\n                                        return (<>\n                                            <tr onClick={this.toggleDisplayDetails} data-email={musher.email}>\n                                                <th scope='row'>\n                                                    {idx + 1}\n                                                    {isAdmin && currentResults && <>\n                                                        <br />{currentResults.isLocked ? <i class='fas fa-lock text-danger mr-2' /> : <i class='fas fa-lock-open text-success mr-2' />}\n                                                    </>}\n                                                </th>\n                                                <td\n                                                    class={`${displayDetails[musher.email] ? 'font-weight-bold' : ''}`}\n                                                    style={`${displayDetails[musher.email] ? '' : 'line-height: 0.8em;'}`}\n                                                >\n                                                    {displayDetails[musher.email] ? <>\n                                                        {musher.firstname} {musher.lastname}<br />\n                                                        <span class='text-muted'>{currentTeam.name}</span><br />\n                                                        <small class='text-muted'>{musher.sportsClub}</small><br />\n                                                        {musher.facebook && <a class='mr-2' href={mu.asFacebookLink(musher.facebook)} native target='_blank' rel='noreferrer'><i class='fab fa-facebook' /></a>}\n                                                        {musher.instagram && <a class='mr-2' href={mu.asInstagramLink(musher.instagram)} native target='_blank' rel='noreferrer'><i class='fab fa-instagram' /></a>}\n                                                        {musher.price1 && <div class='font-weight-lighter'>\n                                                            <i class='fas fa-trophy text-warning' /> {musher.price1}\n                                                            {musher.priceSent && <>\n                                                                <i class='fas fa-check text-success' />\n                                                            </>}\n                                                        </div>}\n                                                        {musher.price2 && <div class='font-weight-lighter'><i class='fas fa-trophy text-warning' /> {musher.price2}</div>}\n                                                        {musher.price3 && <div class='font-weight-lighter'><i class='fas fa-trophy text-warning' /> {musher.price3}</div>}\n\n                                                    </> : <>\n                                                        {musher.price1 && <span class='float-right text-warning' style='font-size: 1.2em;'>\n                                                            <i class='fas fa-trophy' />\n                                                            {musher.priceSent && <>\n                                                                <i class='fas fa-check text-success' />\n                                                            </>}\n                                                        </span>}\n                                                        <nobr>\n                                                            {musher.firstname} {musher.lastname}<br />\n                                                            <small class='text-muted'>{musher.sportsClub}</small><br />\n                                                        </nobr>\n                                                    </>}\n\n                                                </td>\n\n                                                {isAdmin && <>\n                                                    <td class='d-none d-lg-table-cell'>{musher.cellphone}</td>\n                                                    <td class='d-none d-lg-table-cell'>{musher.email}</td>\n                                                </>}\n\n                                                <td class='d-none d-lg-table-cell'>\n                                                    {isAdmin && <>\n                                                        <button class='btn btn-primary btn-sm float-right' onClick={this.adminToggleEditUser}><i class='fas fa-user-edit' /></button>\n                                                    </>}\n\n                                                    {(isAdmin && editUserDetails[musher.email]) && <>\n                                                        <h5>Admin edit:</h5>\n\n                                                        <div class='form-group row my-0'>\n                                                            <label class='col-sm-2 col-form-label text-right'>Email</label>\n                                                            <div class='col-sm-10'>\n                                                                {musher.email}\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label class='col-sm-2 col-form-label text-right'>Cellphone</label>\n                                                            <div class='col-sm-10'>\n                                                                {musher.cellphone}\n                                                            </div>\n                                                        </div>\n\n                                                        <div class='form-group row my-0'>\n                                                            <label for='team' class='col-sm-2 col-form-label text-right'>Race status</label>\n                                                            <div class='col-sm-10'>\n                                                                <select class='form-control-plaintext' id='raceStatus'\n                                                                    data-classid={musher.class}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.raceStatus}\n                                                                >\n                                                                    <option value=''>-- Choose race status --</option>\n                                                                    <option value='OK'>OK - Everything ok</option>\n                                                                    <option value='DNS'>DNS - Did Not Start</option>\n                                                                    <option value='DNF'>DNF - Did Not Finish</option>\n                                                                    <option value='DNQ'>DNQ - Did not qualify</option>\n                                                                    <option value='DQ'>DQ - Disqualified</option>\n                                                                    <option value='DC'>DC - Data changed by user</option>\n                                                                </select>\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='raceComment' class='col-sm-2 col-form-label text-right'>Race comment</label>\n                                                            <div class='col-sm-10'>\n                                                                <input type='text' class='form-control-plaintext' id='raceComment'\n                                                                    data-classid={musher.class}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.raceComment}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='gpxResultsApproved' class='col-sm-2 col-form-label text-right'>GPX Results approved (date)</label>\n                                                            <div class='col-sm-10'>\n                                                                <input type='date' class='form-control-plaintext' id='gpxResultsApproved'\n                                                                    data-classid={musher.class}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.gpxResultsApproved ? util.isoDate(musher.gpxResultsApproved, false, false, true) : null}\n                                                                />\n                                                            </div>\n                                                        </div>\n\n                                                        <div class='form-group row my-0'>\n                                                            <label for='price1' class='col-sm-2 col-form-label text-right'>Price 1</label>\n                                                            <div class='col-sm-10'>\n                                                                <input type='text' class='form-control-plaintext' id='price1'\n                                                                    data-classid={musher.class}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.price1}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='price2' class='col-sm-2 col-form-label text-right'>Price 2</label>\n                                                            <div class='col-sm-10'>\n                                                                <input type='text' class='form-control-plaintext' id='price2'\n                                                                    data-classid={musher.class}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.price2}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='price3' class='col-sm-2 col-form-label text-right'>Price 3</label>\n                                                            <div class='col-sm-10'>\n                                                                <input type='text' class='form-control-plaintext' id='price3'\n                                                                    data-classid={musher.class}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.price3}\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                        <div class='form-group row my-0'>\n                                                            <label for='priceSent' class='col-sm-2 col-form-label text-right'>Price sent</label>\n                                                            <div class='col-sm-10'>\n                                                                <input type='date' class='form-control-plaintext' id='priceSent'\n                                                                    data-classid={musher.class}\n                                                                    data-contestantid={musher.id}\n                                                                    onInput={this.adminSignupEdit}\n                                                                    value={musher.priceSent ? util.isoDate(musher.priceSent, false, false, true) : null}\n                                                                />\n                                                            </div>\n                                                        </div>\n\n                                                    </>}\n\n                                                    <div class='d-flex flex-wrap'>\n                                                        {currentStages && currentStages.map((stage, idx) => {\n                                                            const percent = stage.distanceKm / currentClass.distance * 100;\n                                                            const width = percent > 100 ? 100 : parseInt(percent, 10);\n                                                            const currentEpoch = Math.floor(new Date(stage.date).getTime() / 1000);\n                                                            const inDate = new Date(0); // The 0 there is the key, which sets the date to the epoch\n                                                            inDate.setUTCSeconds(currentEpoch + parseInt(stage.duration, 10));\n                                                            const images = stage.images.flat();\n                                                            if (displayDetails[musher.email]) {\n                                                                return (<>\n                                                                    <div class='bg-light border rounded-lg  text-right position-relative mr-1 mb-1' style={`width: 350px; min-width: 320px;`}>\n                                                                        <svg viewBox='0 0 300 100' class='position-absolute' style='width: 100%; height: 95%; bottom: 0px; left: 0px; z-index: 0;'>\n                                                                            <path d={`${stage.svgElevation}`} style='fill: #0063FF; stroke: #0063FF; stroke-width: 2; opacity: 0.2;' />\n                                                                        </svg>\n                                                                        <div class='position-relative px-3'>\n                                                                            <span class='position-absolute' style='top: 3px; left: 3px; font-size: 1.3em;'>\n                                                                                {idx + 1}\n                                                                            </span>\n                                                                            <small>\n                                                                                {isAdmin && <span class='position-absolute' style='top: 0px; right: -5px;'>\n                                                                                    {stage.isLocked ? <i class='fas fa-lock text-danger' /> : <i class='fas fa-lock-open text-success' />}\n                                                                                </span>}\n                                                                                <span class='float-left'>\n                                                                                    <nobr><i style='width: 20px;' class='fas fa-sign-out-alt text-muted' /> {util.formatDate(stage.date, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</nobr>\n                                                                                    <nobr><i style='width: 20px;' class='fas fa-sign-in-alt text-muted' /> {util.formatDate(inDate, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}</nobr>\n                                                                                </span>\n                                                                                <span class='float-right'>\n                                                                                    {/* {restTimeText}\n                                                                                    {restTimeTrackText} */}\n                                                                                    <nobr><i style='width: 20px;' class='fas fa-road text-muted' /> {util.format(stage.distanceKm, 1) || 'n/a'} <span class='font-weight-lighter'>km</span></nobr>\n                                                                                    <nobr><i style='width: 20px;' class='fas fa-mountain text-muted' /> {util.format(stage.elevation, 0) || 'n/a'} <span class='font-weight-lighter'>m</span></nobr>\n                                                                                    <nobr><i style='width: 20px;' class='fas fa-tachometer-alt text-muted' /> {util.format(stage.speedAvg, 1) || 'n/a'} <span class='font-weight-lighter'>km/t</span></nobr><br />\n\n                                                                                    <nobr><i style='width: 20px;' class='fas fa-clock text-muted' /> {util.secToHms(stage.duration) || 'n/a'}</nobr>\n                                                                                    <nobr><i style='width: 20px;' class='fas fa-moon text-muted' /> {util.secToHms(stage.rest) || 'n/a'}</nobr>\n                                                                                    <nobr><i style='width: 20px;' class='fas fa-running text-muted' /> {util.secToHms(stage.duration - stage.rest) || 'n/a'}</nobr><br />\n\n                                                                                    <nobr><i style='width: 20px;' class='fas fa-dog text-muted' /> {util.format(stage.avgDogs, 0) || 'n/a'}</nobr>\n                                                                                </span>\n                                                                            </small>\n                                                                        </div>\n                                                                    </div>\n                                                                </>);\n                                                            }\n                                                            return (<>\n                                                                <div class='bg-light border rounded-lg text-right position-relative px-3 mr-1 mb-1' style={`width: 300px; min-width: 300px;`}>\n                                                                    <small>\n                                                                        {isAdmin && <span class='position-absolute' style='top: 2px; right: -5px;'>\n                                                                            {stage.isLocked ? <i class='fas fa-lock text-danger' /> : <i class='fas fa-lock-open text-sucess' />}\n                                                                        </span>}\n\n                                                                        <span class='float-left'>{idx + 1}</span>\n                                                                        <nobr><i style='width: 20px;' class='fas fa-road text-muted' /> {util.format(stage.distanceKm, 1) || 'n/a'} <span class='font-weight-lighter'>km</span></nobr>\n                                                                        <nobr><i style='width: 20px;' class='fas fa-tachometer-alt text-muted' /> {util.format(stage.speedAvg, 1) || 'n/a'} <span class='font-weight-lighter'>km/t</span></nobr>\n                                                                        <nobr><i style='width: 20px;' class='fas fa-clock text-muted' /> {util.secToHms(stage.duration) || 'n/a'}</nobr>\n                                                                    </small>\n                                                                </div>\n                                                            </>);\n                                                        })}\n                                                    </div>\n                                                </td>\n                                                <td class='text-right position-relative pl-4'>\n                                                    {raceStatus(musher)}\n                                                    {musher.raceComment && <>\n                                                        <div class='alert alert-warning text-left' role='alert'>\n                                                            <i class='fas fa-exclamation-triangle float-left mr-4' style='font-size: 2.0em;' />\n                                                            <Markdown markdown={mu.replaceImages(musher.raceComment, race.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                                                        </div>\n                                                    </>}\n                                                    {(isAdmin && currentResults.lastUpdated > lastAllowedChangeDate) && <>\n                                                        <div class='alert alert-danger text-left d-none d-md-block' role='alert'>\n                                                            <i class='fas fa-exclamation-triangle float-left mr-4' style='font-size: 2.0em;' />\n                                                            <i class='fas fa-user-shield' /> Last changed: {util.formatDate(currentResults.lastUpdated, { locale: language, hour12: false, hour: '2-digit', minute: '2-digit' })}\n                                                        </div>\n                                                    </>}\n                                                    {completed >= 99 ? <span class='position-absolute' style='top: 10px; left: 0px;'><i class='fas fa-flag-checkered text-success' /></span> : ''}\n                                                    <small>\n                                                        {displayDetails[musher.email] ? <>\n                                                            <nobr><i style='width: 20px;' class='fas fa-road text-muted' /> {util.format(currentResults.distanceKm, 1) || 'n/a'} <span class='font-weight-lighter'>km</span></nobr>\n                                                            {/* <nobr><i style='width: 20px;' class='fas fa-tachometer-alt text-muted' /> {util.format(currentResults.speedAvg, 1) || 'n/a'} <span class='font-weight-lighter'>km/t</span></nobr> */}\n                                                            <nobr><i style='width: 20px;' class='fas fa-mountain text-muted' /> {util.format(currentResults.elevation, 0) || 'n/a'} <span class='font-weight-lighter'>m</span></nobr>\n                                                            <div class='progress mb-1' style='height: 3px;'>\n                                                                <div class={`progress-bar ${completed >= 99 ? 'bg-success' : ''}`}\n                                                                    role='progressbar'\n                                                                    style={`width: ${completed}%`}\n                                                                    aria-valuenow={`${completed}`}\n                                                                    aria-valuemin='0'\n                                                                    aria-valuemax='100'\n                                                                />\n                                                            </div>\n\n                                                            {race.nonstop ? <>\n                                                                <nobr><i style='width: 20px;' class='fas fa-clock text-muted' /> {util.secToHms(totalWorkoutTimeUsedSec) || 'n/a'}</nobr>\n                                                                <nobr><i style='width: 20px;' class='fas fa-moon text-muted' /> {util.secToHms(totals.totalRest) || 'n/a'}</nobr>\n\n                                                                <br /><nobr><i style='width: 20px;' class='fas fa-calendar text-muted' /> {util.isoDate(totals.firstEpoch)} - <i style='width: 20px;' class='fas fa-calendar text-muted' /> {util.isoDate(finishedDate)}</nobr>\n                                                                {isAdmin && <>\n                                                                    <br />\n                                                                    <div class='text-danger'>\n                                                                        {totals.firstGpxStartEpoch && <>\n                                                                            <nobr>firstGpxStartEpoch: {util.isoDate(totals.firstGpxStartEpoch)}</nobr><br />\n                                                                        </>}\n                                                                        {totals.lastGpxStartEpoch && <>\n                                                                            <nobr>lastGpxStartEpoch: {util.isoDate(totals.lastGpxStartEpoch)}</nobr><br />\n                                                                        </>}\n                                                                    </div>\n                                                                </>}\n                                                            </> : <>\n                                                                <nobr><i style='width: 20px;' class='fas fa-clock text-muted' /> {util.secToHms(currentResults.duration) || 'n/a'}</nobr>\n                                                                <nobr><i style='width: 20px;' class='fas fa-moon text-muted' /> {util.secToHms(currentResults.rest) || 'n/a'}</nobr>\n                                                                <nobr><i style='width: 20px;' class='fas fa-running text-muted' /> {util.secToHms(currentResults.duration - currentResults.rest) || 'n/a'}</nobr><br />\n                                                                {isDone === 1 && <><nobr class='font-weight-bold'><span class='font-weight-lighter text-muted'>Normalized to race distance:</span> <i style='width: 20px;' class='fas fa-clock text-muted' /> {util.secToHms(normalizedDuration) || 'n/a'}</nobr><br /></>}\n                                                                {isDone === 1 && <><nobr class='font-weight-bold'><span class='font-weight-lighter text-muted'>Normalized:</span> <i style='width: 20px;' class='fas fa-clock text-muted' /> {util.secToHms(weightedNormalizedDuration) || 'n/a'}</nobr><br /></>}\n                                                            </>}\n\n                                                            {/* <nobr><i style='width: 20px;' class='fas fa-dog text-muted' /> {util.format(currentResults.avgDogs, 0) || 'n/a'}</nobr> */}\n                                                        </> : <>\n                                                            <nobr><i style='width: 20px;' class='fas fa-road text-muted' /> {util.format(currentResults.distanceKm, 1) || 'n/a'} <span class='font-weight-lighter'>km</span></nobr>\n                                                            {/* <nobr><i style='width: 20px;' class='fas fa-tachometer-alt text-muted' /> {util.format(currentResults.speedAvg, 1) || 'n/a'} <span class='font-weight-lighter'>km/t</span></nobr> */}\n                                                            <nobr><i style='width: 20px;' class='fas fa-mountain text-muted' /> {util.format(currentResults.elevation, 0) || 'n/a'} <span class='font-weight-lighter'>m</span></nobr>\n\n                                                            <div class='progress mb-1' style='height: 3px;'>\n                                                                <div class={`progress-bar ${completed >= 99 ? 'bg-success' : ''}`}\n                                                                    role='progressbar'\n                                                                    style={`width: ${completed}%`}\n                                                                    aria-valuenow={`${completed}`}\n                                                                    aria-valuemin='0'\n                                                                    aria-valuemax='100'\n                                                                />\n                                                            </div>\n\n                                                            {race.nonstop ? <>\n                                                                <nobr><i style='width: 20px;' class='fas fa-clock text-muted' /> {util.secToHms(totalWorkoutTimeUsedSec) || 'n/a'}</nobr>\n                                                                <nobr><i style='width: 20px;' class='fas fa-moon text-muted' /> {util.secToHms(totals.totalRest) || 'n/a'}</nobr>\n                                                            </> : <>\n                                                                {isDone === 1 ? <>\n                                                                    <nobr class='font-weight-bold'><i style='width: 20px;' class='fas fa-clock text-muted' /> {util.secToHms(weightedNormalizedDuration) || 'n/a'}</nobr><br />\n                                                                </> : <>\n                                                                    <nobr><i style='width: 20px;' class='fas fa-clock text-muted' /> {util.secToHms(currentResults.duration) || 'n/a'}</nobr><br />\n                                                                </>}\n                                                            </>}\n                                                        </>}\n\n                                                        {/* raceDistance: {raceDistance}<br /> */}\n\n                                                        {/* duration: {util.secToHms(duration)}<br />\n                                                        normalizedDuration: {util.secToHms(normalizedDuration)}<br />\n                                                        weightedNormalizedDuration: {util.secToHms(weightedNormalizedDuration)}<br /> */}\n\n                                                        {/* totalKcalRelated: {totalKcalRelated}<br />\n                                                        weightedTotalKcal: {weightedTotalKcal}<br />\n                                                        flatTotalKcal: {flatTotalKcal}<br />\n                                                        percentHarder: {percentHarder}<br /> */}\n\n                                                        {/* loadIndex: {loadIndex}<br /> */}\n                                                    </small>\n                                                </td>\n                                            </tr>\n                                        </>);\n                                    })}\n                                </tbody>\n                            </table>\n                        </div>\n\n                        <div class='text-center text-muted'>\n                            <small>\n                                {language === 'no' && <>\n                                    OBS! Ref reglene s er det ikke lov til  endre treningsktene som er med i konkurransen etter at lpet er ferdig.<br />\n                                    Forsk p dette vil resultere i automatisk deplassering p listene.\n                                </>}\n                                {language === 'en' && <>\n                                    IMPORTANT! According to the rules: It is NOT allowed to try alter the workouts related to the competition after the race has ended.<br />\n                                    Attempts will result in automatic deplacement on the resultlists.\n                                </>}\n                            </small>\n                        </div>\n\n                    </div>)}\n\n\n                </div>\n\n\t\t\t\t{isAdmin && <>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass='btn btn-danger btn-lg float-right m-4'\n\t\t\t\t\t\tonClick={this.lockAllWorkoutsInRace}\n\t\t\t\t\t>\n\t\t\t\t\t\tLock all workouts in this race\n\t\t\t\t\t</button>\n\t\t\t\t\t<xmp class='m-5'>{JSON.stringify(lockMessage, null, 4)}</xmp>\n\t\t\t\t</>}\n\n                <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3 mb-2'>\n                    <a class='btn btn-lg btn-block btn-primary' href={`https://homerunrace.no/index#/race/${race.id}/results`}>All results</a>\n                </div>\n            </div>\n        </>);\n    }\n}\n\nexport default AppRaceDetailResults;\n"],"sourceRoot":""}