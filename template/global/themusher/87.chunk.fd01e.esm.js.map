{"version":3,"sources":["webpack:///./components/inbox/users.js","webpack:///./routes/inbox/new.js"],"names":["initialState","InboxUser","observer","Component","constructor","props","super","this","state","render","user","showDot","shortname","mu","displayNameShort","name","displayName","userImage","image","images","undefined","teamImage","teamName","lastMessage","isMyMessage","body","uuidv4","updateUser","id","class","style","s3SmallLink","href","place","country","readDate","maxLength","util","formatDistance","updated","Date","locale","MARGIN_TOP","marginTop","MARGIN_BOTTOM","marginBottom","isLoading","limit","offset","search","Inbox","searchForUsers","setState","loadUsers","messageStore","stores","componentDidMount","users","for","type","onInput","linkState","value","placeholder","onClick","map"],"mappings":"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","file":"87.chunk.fd01e.esm.js","sourcesContent":["import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nconst initialState = {};\n\n@observer\nclass InboxUser extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\trender() {\n        const { user = {}, showDot = false } = this.props;\n        const shortname = mu.displayNameShort(user);\n        const name = mu.displayName(user, true);\n        const userImage = user.image || (user.images ? user.images[0] : undefined) || user.teamImage;\n        const teamName = user.teamName;\n\n        const lastMessage = user.lastMessage;\n        let isMyMessage;\n        let body;\n        if (lastMessage) {\n            isMyMessage = user.uuidv4 !== lastMessage.updateUser;\n            body = lastMessage.body === 'LIKE_MESSAGE' ? <Text id='inbox.like-message'>Liked message</Text> : lastMessage.body;\n        }\n\n\t\treturn (\n            <div class='d-flex flex-row flex-nowrap position-relative' style='overflow: auto;'>\n                <div \n                    class={`text-center border rounded-circle imageRounded pt-2`}\n                    style={`${userImage ? `background-image: url(\"${userImage.s3SmallLink}\"); background-size: cover;` : ''} border-width: 3px !important;`}\n                >\n                    {!userImage && <span class='font-weight-lighter' style='font-size: 35px;'>{shortname}</span>}\n                </div>\n                <div class='flex-grow-1 pl-3 pt-0'>\n                    <div class='text-overflow'>\n                        <a href={`/inbox/${user.uuidv4}`} class='stretched-link'>\n                            <h5>{name}</h5>\n                        </a>\n                    </div>\n                    <div class='text-overflow'>\n                        {user.place ? `${user.place}, ` : ''} {user.country}\n                    </div>\n                    {lastMessage ? <>\n                        <div class={`text-overflow`}>\n                            {isMyMessage ? <>\n                                <span class='font-weight-lighter'><Text id='inbox.you'>You</Text>:</span>\n                                <span class={`ml-1 ${lastMessage.readDate ? '' : 'font-weight-bold'}`}>\n                                    {mu.maxLength(body, 30)}\n                                </span>\n                            </> : <>\n                                <span class={lastMessage.readDate ? '' : 'font-weight-bold'}>\n                                    {mu.maxLength(body, 30)}\n                                </span>\n                            </>}\n                            <span class='text-muted ml-3'>\n                                {util.formatDistance(lastMessage.updated, new Date(), { locale: 'no-NB' })}\n                            </span>\n                        </div>\n                    </> : <>\n                        {teamName && <div class='text-overflow'>\n                            {teamName}\n                        </div>}                    \n                    </>}\n                </div>\n                {showDot && <div class='d-flex align-items-center'>\n                    <i class='far fa-circle' style='font-size: 2.0em;' />\n                </div>}\n            </div>\n\t\t);\n\t}\n}\n\nexport default InboxUser;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\nimport linkState from 'linkstate';\n\nimport InboxUser from '../../components/inbox/users';\n\nimport mu from '../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(false);\nconst MARGIN_BOTTOM = mu.marginBottom();\n\nconst initialState = {\n    isLoading: false,\n\tlimit: 25,\n\toffset: 0,\n    search: '',\n};\n\n@observer\nclass Inbox extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n    async loadUsers({ limit, offset, search }) {\n\t\tthis.setState({ isLoading: true });\n\t\tconst { messageStore } = this.props.stores;\n\t\tawait messageStore.loadUsers({ limit, offset, search });\n\t\tthis.setState({ isLoading: false });\n\t}\n\n    searchForUsers = () => {\n        const { search, limit } = this.state;\n\t\tthis.setState({\n\t\t\toffset: 0,\n\t\t});\n\t\tthis.loadUsers({ search, limit });\n    }\n\n    componentDidMount() {\n\t\tthis.loadUsers({});\n\t}\n\n\t// componentWillReceiveProps(nextProps) {\n\t// \tthis.loadMessages(nextProps);\n\t// }\n\n    render() {\n        const { search } = this.state;\n        const { messageStore } = this.props.stores;\n        const { users } = messageStore;\n\n        return (\n\t\t\t<div class='container-fluid' style={`margin-bottom: ${MARGIN_BOTTOM}; margin-top: ${MARGIN_TOP};`}>\n                <div class='row fixed-top bg-light' style={`margin-top: ${MARGIN_TOP};`}>\n                    <div\n                        class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mx-2'\n                        // style={`${imageHeader ? `background-image: url(\"${imageHeader.s3SmallLink}\"); background-size: cover;` : ''} background-position: 50% 50%;`}\n                    >\n                        <a href='/inbox' class='float-left mr-3' style='font-size: 2.8em; line-height: 1.0em;'><i class='fas fa-angle-left' /></a>\n\n                        <div class='d-flex flex-row flex-nowrap position-relative' style='overflow: auto;'>\n                            <div \n                                class={`text-center border rounded-circle imageRounded imageRoundedSmall pt-0`}\n                                style={`border-width: 3px !important;`}\n                            >\n                                <span class='font-weight-lighter' style='font-size: 20px;'><i class='fas fa-user' /></span>\n                            </div>\n                            <div class='flex-grow-1 pl-3 pt-0'>\n                                <div class='text-overflow'>\n                                    <strong>New message</strong>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <div class='row'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-5'>\n                        <div class='d-flex flex-row flex-nowrap'>\n                            <div class='flex-grow-1'>\n                                <label class='sr-only' for='inboxSearch'><Text id='inbox.search'>Search</Text></label>\n                                <Localizer>\n                                    <input\n                                        type='text'\n                                        class='form-control mb-2'\n                                        id='inboxSearch'\n                                        onInput={linkState(this, 'search')}\n                                        value={search}\n                                        placeholder={<Text id='inbox.search-for-users'>Search for users you want to send a message to...</Text>}\n                                    />\n                                </Localizer>\n                            </div>\n                            <div class='ml-1'>\n                                <button\n                                    type='button'\n                                    class='btn btn-primary mb-2'\n                                    onClick={this.searchForUsers}\n                                ><Text id='inbox.search-button'>Search</Text></button>\n                            </div>\n                        </div>\n                    </div>\n\t\t\t\t</div>\n\n                <div class='row'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3'>\n                        <h5><Text id='inbox.new-message-suggested'>Suggested</Text></h5>\n                    </div>\n                </div>\n                <div class='row'>\n                    {users && users.map(user => <>\n                        <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-3'>\n                            <InboxUser stores={this.props.stores} user={user} showDot={true} />\n                        </div>\n                    </>)}\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default Inbox;\n"],"sourceRoot":""}