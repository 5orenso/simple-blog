{"version":3,"sources":["webpack:///./components/story/publicDetail.js","webpack:///./routes/stories/detail.js"],"names":["initialState","StoryPublicFeed","observer","props","state","inputRef","loadStoriesPublicFeed","this","stores","storyStore","loadPublicFeed","story","componentDidMount","componentWillReceiveProps","nextProps","render","publicFeed","darkmode","appState","class","length","map","showAllComments","Component","MARGIN_TOP","mu","marginTop","MARGIN_BOTTOM","marginBottom","MARGIN_TOP_BACK","marginTopBack","isLoading","submenu","viewmenu","Home","reloadFeeds","e","preventDefault","setState","back","history","goBack","loadAll","userStore","messageStore","getFingerprint","getInfo","getNotifications","getUnReadMessages","user","currentLocationInfo","coords","getWeatherUser","lat","latitude","lon","longitude","altitude","yrWeather","currentLocationGeocode","place","formatted_address","style","onClick","url","data","role","href","id"],"mappings":"sfAOMA,G,UAAe,IAGfC,EADLC,Y,cAEG,WAAYC,GAAO,aACf,cAAMA,IAAN,MACKC,M,+VAAL,IACOJ,GAEb,EAAKK,SAAW,GALK,E,0HAQbC,sBAAN,SAA4BH,GAA5B,iCAGF,YAHE,IAA4BA,MAAQI,KAAKJ,OAG3C,gBAFuBA,EAAMK,OAArBC,WAESC,eAAe,CAAEC,MADVR,EAAVQ,SACd,MAA0C,sDAHxC,a,EAMHC,kBAAA,WACOL,KAAKD,yB,EAGTO,0BAAA,SAA0BC,GAElBA,EAAUH,QAAUJ,KAAKJ,MAAMQ,OAC/BJ,KAAKD,sBAAsBQ,I,EAInCC,OAAA,WAAS,aAC4BR,KAAKJ,MAAMK,OACpCQ,EAFH,EACGP,WACAO,WACAC,EAHH,EACeC,SAEZD,SAER,OACI,mBAAKE,MAAM,SAEP,mBAAKA,MAAM,qBACP,mBAAKA,MAAK,uGAAwGF,EAAW,QAAU,SAA7H,eACJD,GAAoC,IAAtBA,EAAWI,QAAgB,mBACvC,mBAAKD,MAAM,+BACP,mBAAKA,MAAM,8BACP,iBAAGA,MAAM,oBAEb,2CAGPH,GAAcA,EAAWK,KAAI,SAACV,GAAD,OAAW,mBACrC,YAAC,IAAD,CACIH,OAAQ,EAAKL,MAAMK,OACnBG,MAAOA,EACPW,iBAAiB,Y,GAhDnBC,e,EA0DftB,Q,wiBC9DTuB,EAAaC,IAAGC,WAAU,GAC1BC,EAAgBF,IAAGG,eACnBC,EAAkBJ,IAAGK,eAAc,GAQnC9B,EAAe,CACpB+B,WAAW,EACXC,QAAS,eACTC,SAAU,QAILC,EADLhC,Y,cAEG,WAAYC,GAAO,aACf,cAAMA,IAAN,MAsBPgC,YAAc,SAAOC,GAAP,kCAGb,OAFAA,EAAEC,iBACF,EAAKC,SAAS,CAAEP,WAAW,IAC3B,gBAAM,EAAKzB,yBAAX,MAAkC,sBAClC,EAAKgC,SAAS,CAAEP,WAAW,IADO,mCA1Bb,EAwCnBQ,KAAO,WACiB,EAAKpC,MAAMK,OAAvBgC,QACAC,UAxCR,EAAKrC,M,+VAAL,IACOJ,GAHQ,E,0HAOhB0C,QAAN,4DAGO,OAFExB,GADT,EAC+CX,KAAKJ,MAAMK,QAAjDU,SAAUyB,EADnB,EACmBA,UAAWC,EAD9B,EAC8BA,aAC7BrC,KAAK+B,SAAS,CAAEP,WAAW,IACrB,gBAAMb,EAAS2B,kBAAf,KAA+B,eAC/B,uBAAMF,EAAUG,WAAhB,KAAyB,eAC/B,uBAAMH,EAAUI,oBAAhB,KAAkC,eAC5B,uBAAMH,EAAaI,qBAAnB,KAAsC,sBAEpCC,EAASN,EAATM,MACCC,qBAAuBD,EAAKC,oBAAoBC,QAExDR,EAAUS,eAAe,CAAEC,KAFqC,EACZJ,EAAKC,oBAAoBC,QAArEG,SACwBC,IAFgC,EACzCC,UACcC,SAF2B,EACzBA,WAGxClD,KAAK+B,SAAS,CAAEP,WAAW,IAPiB,yCADV,qCADH,qCADM,sCAHtC,a,EAuBMzB,sBAAN,SAA4BH,GAA5B,iCAGC,YAHD,IAA4BA,MAAQI,KAAKJ,OAGxC,gBAFuBA,EAAMK,OAArBC,WAESC,eAAe,CAAEC,MADVR,EAAVQ,SACd,MAA0C,sDAH3C,a,EAMAC,kBAAA,WACCL,KAAKmC,W,EAQN3B,OAAA,WAAS,IACAgB,EAAcxB,KAAKH,MAAnB2B,UACMpB,EAAUJ,KAAKJ,MAAfQ,MAENsC,EADc1C,KAAKJ,MAAMK,OAAzBmC,UACAM,KACAS,EAA2CT,EAA3CS,UALA,EAK2CT,EAAhCU,uBACQC,QANnB,MAKoC,GALpC,GAMAC,kBAER,OACC,mBAAK1C,MAAM,kBAAkB2C,MAAK,kBAAoBnC,EAApB,iBAAkDH,EAAlD,KACrB,uBACI,sBAAQL,MAAM,2CACV2C,MAAK,QAAUjC,EAAV,6CACLkC,QAASxD,KAAKgC,MACd,iBAAGpB,MAAM,+BAIjB,YAAC,IAAD,CAAIX,OAAQD,KAAKJ,MAAMK,OAAQwD,IAAKzD,KAAKJ,MAAM6D,MAC/C,mBAAK7C,MAAM,YACP,YAAC,IAAD,CAAWX,OAAQD,KAAKJ,MAAMK,OAAQyD,KAAMP,EAAWE,MAAOA,KAGlE,YAAC,IAAD,CAAUpD,OAAQD,KAAKJ,MAAMK,SAE7B,mBAAKW,MAAM,gBACP,mBAAKA,MAAM,2EACP,yBACI,yBACI,mBAAKA,MAAM,eACNY,EAAY,mBACT,mBAAKZ,MAAM,8BAA8B+C,KAAK,UAC1C,oBAAM/C,MAAM,WAAZ,gBAEF,mBACF,iBAAGgD,KAAK,IAAIL,MAAM,oBAAoBC,QAASxD,KAAK4B,aAAa,iBAAGhB,MAAM,wBAItF,oBAAMA,MAAM,cACR,iBAAGA,MAAM,eADb,IAC6B,YAAC,IAAD,CAAMiD,GAAG,aAAT,cAKzC,YAAC,IAAD,CAAmB5D,OAAQD,KAAKJ,MAAMK,OAAQG,MAAOA,M,GA3FlDY,e,EAiGJW,a","file":"100.chunk.ec638.js","sourcesContent":["import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport Story from './publicStory';\n\nimport mu from '../../lib/musher-util';\n\nconst initialState = {};\n\n@observer\nclass StoryPublicFeed extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n\t\tthis.inputRef = {};\n    }\n\n    async loadStoriesPublicFeed(props = this.props) {\n\t\tconst { storyStore } = props.stores;\n        const { story } = props;\n\t\tawait storyStore.loadPublicFeed({ story });\n\t}\n\n\tcomponentDidMount() {\n        this.loadStoriesPublicFeed();\n\t}\n\n    componentWillReceiveProps(nextProps) {\n        // console.log('componentWillReceiveProps', nextProps);\n        if (nextProps.story !== this.props.story) {\n            this.loadStoriesPublicFeed(nextProps);\n        }\n    }\n\n    render() {\n        const { storyStore, appState } = this.props.stores;\n        const { publicFeed } = storyStore;\n        const { darkmode } = appState;\n\n        return (\n            <div class='w-100'>\n\n                <div class='row pb-4 bg-light'>\n                    <div class={`col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 my-1 position-relative rounded rounded-lg py-3 bg-${darkmode ? 'black' : 'white'} shadow-sm`}>\n                        {!publicFeed || publicFeed.length === 0 && <>\n                            <div class='text-center text-muted mt-5'>\n                                <div class='display-1 text-center mb-5'>\n                                    <i class='fas fa-comment' />\n                                </div>\n                                <h3>No story found!</h3>\n                            </div>\n                        </>}\n                        {publicFeed && publicFeed.map((story) => <>\n                            <Story\n                                stores={this.props.stores}\n                                story={story}\n                                showAllComments={true}\n                            />\n                        </>)}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default StoryPublicFeed;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(false);\nconst MARGIN_BOTTOM = mu.marginBottom();\nconst MARGIN_TOP_BACK = mu.marginTopBack(false);\n\nimport StoryAdd from '../../components/story/add';\nimport StoryPublicFeed from '../../components/story/publicFeed';\nimport StoryPublicDetail from '../../components/story/publicDetail';\nimport Ad from '../../components/ad/';\nimport YrWeather from '../../components/yrweather/';\n\nconst initialState = {\n\tisLoading: false,\n\tsubmenu: 'lastWorkouts',\n\tviewmenu: 'wall',\n};\n\n@observer\nclass Home extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\tasync loadAll() {\n\t\tconst { appState, userStore, messageStore } = this.props.stores;\n\t\tthis.setState({ isLoading: true });\n        await appState.getFingerprint();\n        await userStore.getInfo();\n\t\tawait userStore.getNotifications();\n        await messageStore.getUnReadMessages();\n\n\t\tconst { user } = userStore;\n\t\tif (user.currentLocationInfo && user.currentLocationInfo.coords) {\n\t\t\tconst { latitude: lat, longitude: lon, altitude } = user.currentLocationInfo.coords;\n\t\t\tuserStore.getWeatherUser({ lat, lon, altitude });\n\t\t}\n\t\tthis.setState({ isLoading: false });\n    }\n\n\treloadFeeds = async (e) => {\n\t\te.preventDefault();\n\t\tthis.setState({ isLoading: true });\n\t\tawait this.loadStoriesPublicFeed();\n\t\tthis.setState({ isLoading: false });\n\t}\n\n\tasync loadStoriesPublicFeed(props = this.props) {\n\t\tconst { storyStore } = props.stores;\n        const { story } = props;\n\t\tawait storyStore.loadPublicFeed({ story });\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.loadAll();\n\t}\n\n    back = () => {\n        const { history } = this.props.stores;\n        history.goBack();\n    }\n\n\trender() {\n\t\tconst { isLoading } = this.state;\n        const { story } = this.props;\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { yrWeather, currentLocationGeocode = {} } = user;\n\t\tconst { formatted_address: place } = currentLocationGeocode;\n\n\t\treturn (\n\t\t\t<div class='container-fluid' style={`margin-bottom: ${MARGIN_BOTTOM}; margin-top: ${MARGIN_TOP};`}>\n                <div>\n                    <button class='btn btn-link pl-0 fixed-top text-primary'\n                        style={`top: ${MARGIN_TOP_BACK}; left: 5px; font-size: 35px; width: 45px;`}\n                        onClick={this.back}>\n                        <i class='fas fa-arrow-circle-left' />\n                    </button>\n                </div>\n\n                <Ad stores={this.props.stores} url={this.props.url} />\n                <div class='bg-light'>\n                    <YrWeather stores={this.props.stores} data={yrWeather} place={place} />\n                </div>\n\n                <StoryAdd stores={this.props.stores} />\n\n                <div class='row bg-light'>\n                    <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 border-bottom'>\n                        <small>\n                            <small>\n                                <div class='float-right'>\n                                    {isLoading ? <>\n                                        <div class='spinner-border text-primary' role='status'>\n                                            <span class='sr-only'>Loading...</span>\n                                        </div>\n                                    </> : <>\n                                        <a href='#' style='font-size: 1.8em;' onClick={this.reloadFeeds}><i class='fas fa-sync-alt' /></a>\n                                    </>}\n                                </div>\n                            </small>\n                            <span class='text-muted'>\n                                <i class='fas fa-rss' /> <Text id='home.wall'>Veggen</Text>\n                            </span>\n                        </small>\n                    </div>\n                </div>\n                <StoryPublicDetail stores={this.props.stores} story={story} />\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Home;\n"],"sourceRoot":""}