(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{"1OK2":function(t,e,s){"use strict";var o,a=s("hosL"),n=(s("Utv1"),s("/eY4"));Object(n.a)(o=function(t){function e(e){var s;(s=t.call(this,e)||this).touchStart=function(t){t.stopPropagation(),s.setState({startX:t.touches[0].pageX})},s.touchEnd=function(t){t.stopPropagation(),s.setState({startX:void 0,sliding:!1})},s.touchMove=function(t){if(t.stopPropagation(),s.state.totalImages>1){var e=s.state,o=e.startX,a=t.touches[0].pageX;e.sliding||(a>o+50?(s.setState({sliding:!0}),s.prevImage()):a<o-50&&(s.setState({sliding:!0}),s.nextImage()))}};var o=e.images,a=void 0===o?[]:o;return s.state={imageContainer:1,currentImage1:a[0]||{},currentImage2:{},currentIdx:0,totalImages:a.length||0,imageDots:[].concat(Array(a.length||0).fill(1).map((function(t,e){return t+e})))},s}var s,o;o=t,(s=e).prototype=Object.create(o.prototype),s.prototype.constructor=s,s.__proto__=o;var n=e.prototype;return n.nextImage=function(){var t,e=this.state,s=1===e.imageContainer?2:1,o=e.currentIdx+1;o>e.totalImages-1&&(o=0),this.setState(((t={})["currentImage"+s]=this.props.images[o],t.currentIdx=o,t.imageContainer=s,t))},n.prevImage=function(){var t,e=this.state,s=e.imageContainer,o=e.currentIdx-1;o<0&&(o=e.totalImages-1),this.setState(((t={})["currentImage"+(1===s?2:1)]=this.props.images[o],t.currentIdx=o,t.imageContainer=1===s?2:1,t))},n.componentWillReceiveProps=function(t){if(t.images!==this.props.images){var e=t.images,s=void 0===e?[]:e;this.setState({imageContainer:1,currentImage1:s.length>0?s[0]:{},currentImage2:{},currentIdx:0,totalImages:s.length||0,imageDots:[].concat(Array(s.length||0).fill(1).map((function(t,e){return t+e})))})}},n.render=function(){var t,e,s=this,o=this.state,n=o.currentImage1,i=o.currentImage2,r=o.imageContainer,l=o.totalImages,c=o.imageDots,d=o.currentIdx,u=this["image"+r],h=1===r?n:i;if(h.dimensions){var m=h.dimensions,b=m.width,p=m.height,f=m.orientation;f>4&&f<9?(t=b,e=p):(t=p,e=b)}var O=h.dimensions?e/t:u&&u.height?u.width/u.height:4/3;return l<=0?"":Object(a.h)("div",{class:"w-100"},Object(a.h)("div",{class:"border rounded position-relative w-100",style:"height: calc(85vw / "+O+"); overflow: hidden; transition: all .3s ease-in-out;",onTouchstart:this.touchStart,onTouchend:this.touchEnd,onTouchmove:this.touchMove},l>1&&Object(a.h)("span",{class:"position-absolute",style:"top:0px; right: 5px; z-index: 2000;"},Object(a.h)("small",null,d+1,"/",l)),n&&Object(a.h)("div",{class:"position-absolute",style:(1===r?"opacity: 1;":"opacity: 0;")+" transition: all .3s ease-in-out; top: 0; left: 0;"},Object(a.h)("img",{loading:"lazy",src:n.s3LargeLink,class:"img-fluid align-middle",ref:function(t){return s.image1=t}})),i&&Object(a.h)("div",{class:"position-absolute",style:(2===r?"opacity: 1;":"opacity: 0;")+" transition: all .3s ease-in-out; top: 0; left: 0;"},Object(a.h)("img",{loading:"lazy",src:i.s3LargeLink,class:"img-fluid align-middle",ref:function(t){return s.image2=t}}))),c.length>1&&Object(a.h)("div",{class:"w-100 text-center"},c.map((function(t){return Object(a.h)("span",{style:"color: "+(t===d+1?"#ffffff":"#808080")+";"},"•")}))))},e}(a.Component))},"4QWe":function(t,e,s){"use strict";(function(t){var o,a=s("hosL"),n=s("Utv1"),i=s("/eY4"),r=s("OhSV"),l=s("go65"),c=s("om2D"),d=s("ZOvn"),u=Object(i.a)(o=function(e){function s(t){var s;return(s=e.call(this,t)||this).beforeImagesUploaded=function(){s.setState({sendButtonEnabled:!1})},s.afterImagesUploaded=function(){s.setState({sendButtonEnabled:!0})},s.commentStory=function(){return new Promise((function(t,e){var o,a,n,i,r,l,c,u,h,m,b;return s.state.sendButtonEnabled?(n=void 0===(a=(o=s.props).callback)?function(){}:a,r=void 0===(i=o.inputRefObject)?{}:i,l=s.props.story,c=s.props.stores.storyStore,h=(u=s.state).comment,m=u.showAddImage,s.setState({sendButtonEnabled:!1}),Promise.resolve(c.commentStory({id:l.id,comment:h})).then((function(o){try{return(b=o)&&200===b.status&&(s.setState({comment:{body:"",images:[]}},(function(){d.a.resizeTextarea(r[l.id]),m&&s.addImage()})),n({story:l,response:b})),s.setState({sendButtonEnabled:!0}),t()}catch(t){return e(t)}}),e)):t(!1)}))},s.addImages=function(t){var e,o=s.state.comment;(e=o.images).push.apply(e,t.value),s.setState({comment:o})},s.addImage=function(){var t=s.state.showAddImage;s.setState({showAddImage:!(void 0!==t&&t)})},s.handleImageErrored=function(t){var e=t.target;e.onerror=null,setTimeout((function(){e.src+="?"+new Date}),1e3)},s.state={comment:{body:"",images:[]},showAddImage:!1,sendButtonEnabled:!0},s.inputRef={},s}var o,i;return i=e,(o=s).prototype=Object.create(i.prototype),o.prototype.constructor=o,o.__proto__=i,s.prototype.render=function(){var e=this,s=this.props,o=s.inputRef,i=s.story,u=this.state,h=u.comment,m=u.showAddImage,b=u.sendButtonEnabled,p=this.props.stores.userStore.user,f=void 0===p?{}:p,O=d.a.displayNameShort(f),g=(d.a.displayName(f),f.image||(f.images?f.images[0]:void 0));return Object(a.h)("div",null,Object(a.h)("div",{class:"d-flex mb-0 position-relative w-100"},Object(a.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall",style:(g?"background-image: url('"+g.s3SmallLink+"'); background-size: cover;":"")+" border-width: 3px !important;"},!f.image&&Object(a.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},O)),Object(a.h)("div",{class:"col pl-3",style:"line-height: 1.2em;"},Object(a.h)("div",{class:"d-flex bd-highlight"},Object(a.h)("div",{class:"p-0 w-100 bd-highlight"},Object(a.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(a.h)(r.c,{id:"comments.comment"},"Kommentar")),Object(a.h)("div",{class:"border rounded rounded-lg position-relative"},Object(a.h)(r.b,null,Object(a.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(a.h)(r.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(l.a)(this,"comment.body"),onKeyUp:d.a.resizeTextarea,onFocus:d.a.resizeTextarea,style:"height: 2.3em;",value:h.body,ref:o})),Object(a.h)("div",{class:"position-absolute",style:"top: 8px; right: 10px; font-size: 1.2em;"},Object(a.h)("i",{class:"fas fa-image pointerCursor","data-id":i.id,onClick:this.addImage})))),Object(a.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(a.h)("button",{type:"button",class:"btn btn-"+(b?"primary":"secondary")+" mb-2",disabled:!b,onClick:this.commentStory},Object(a.h)("i",{class:"fas fa-paper-plane"})))))),m&&Object(a.h)(t,null,Object(a.h)("div",{class:"col-12 text-center"},Object(a.h)("div",{class:"container-fluid"},Object(a.h)("div",{class:"row"},n.a.isArray(h.images)&&h.images.map((function(t){return Object(a.h)("div",{class:"col-3 p-1"},Object(a.h)("img",{src:t.s3SmallLink,class:"img-fluid",onError:e.handleImageErrored}),Object(a.h)("button",{class:"btn btn-sm btn-link",onClick:e.removeImage,"data-name":t.name},Object(a.h)("i",{class:"fas fa-trash"})," ",Object(a.h)(r.c,{id:"comments.remove-image"},"Remove")))})))),Object(a.h)(c.a,{object:h,updateField:this.addImages,before:this.beforeImagesUploaded,after:this.afterImagesUploaded,autoOpen:!0}))))},s}(a.Component))||o;e.a=u}).call(this,s("hosL").Fragment)},"5uob":function(t,e,s){"use strict";var o,a=s("hosL"),n=(s("Utv1"),s("/eY4")),i=s("OhSV"),r=s("go65"),l=(s("ETxl"),s("ZOvn")),c=Object(n.a)(o=function(t){function e(e){var s;return(s=t.call(this,e)||this).commentStory=function(){return new Promise((function(t,e){var o,a,n,i,r,c,d,u,h,m,b;return s.state.sendButtonEnabled?(n=void 0===(a=(o=s.props).callback)?function(){}:a,i=o.commentId,c=void 0===(r=o.inputRefObject)?{}:r,d=s.props.story,u=s.props.stores.storyStore,m=void 0===(h=s.state.comment)?"":h,s.setState({sendButtonEnabled:!1}),Promise.resolve(u.commentReplyStory({id:d.id,commentId:i,comment:m})).then((function(o){try{return(b=o)&&200===b.status&&(s.setState({comment:""},(function(){l.a.resizeTextarea(c[i])})),n({story:d,response:b,commentId:i})),s.setState({sendButtonEnabled:!0}),t()}catch(t){return e(t)}}),e)):t(!1)}))},s.state={sendButtonEnabled:!0},s.inputRef={},s}var s,o;o=t,(s=e).prototype=Object.create(o.prototype),s.prototype.constructor=s,s.__proto__=o;var n=e.prototype;return n.componentDidMount=function(){var t=this.props.initCall;(void 0===t?function(){}:t)()},n.render=function(){var t=this.props.inputRef,e=this.state,s=e.comment,o=e.sendButtonEnabled,n=this.props.stores.userStore.user,c=void 0===n?{}:n,d=l.a.displayNameShort(c),u=(l.a.displayName(c),c.image||(c.images?c.images[0]:void 0));return Object(a.h)("div",{class:"w-100"},Object(a.h)("div",{class:"d-flex mb-0 position-relative w-100"},Object(a.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedThumb",style:(u?"background-image: url('"+u.s3SmallLink+"'); background-size: cover;":"")+" border-width: 3px !important;"},!u&&Object(a.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},d)),Object(a.h)("div",{class:"col pl-3",style:"line-height: 1.2em;"},Object(a.h)("div",{class:"d-flex bd-highlight"},Object(a.h)("div",{class:"p-0 w-100 bd-highlight"},Object(a.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(a.h)(i.c,{id:"comments.comment"},"Kommentar")),Object(a.h)("div",{class:"border rounded rounded-lg position-relative"},Object(a.h)(i.b,null,Object(a.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(a.h)(i.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(r.a)(this,"comment"),onKeyUp:l.a.resizeTextarea,style:"height: 2.3em;",value:s,ref:t})))),Object(a.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(a.h)("button",{type:"button",class:"btn btn-"+(o?"primary":"secondary")+" mb-2",disabled:!o,onClick:this.commentStory},Object(a.h)("i",{class:"fas fa-paper-plane"})))))))},e}(a.Component))||o;e.a=c},B95u:function(t,e,s){"use strict";(function(t){function o(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,o)}return s}function a(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?o(Object(s),!0).forEach((function(e){n(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function n(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var i,r=s("hosL"),l=s("Utv1"),c=s("/eY4"),d=s("cneo"),u=s("OhSV"),h=s("fh8t"),m=s.n(h),b=s("go65"),p=s("5uob"),f=(s("ETxl"),s("ZOvn")),O={showAddComment:{},showAllComments:!1,showAllReplies:{},viewImageIdx:{},likeComment:{},likeReply:{},showOriginal:{}},g=Object(c.a)(i=function(e){function s(t){var s;return(s=e.call(this,t)||this).addLikeComment=function(t){return new Promise((function(e,o){var a,n,i,r,l,c,d;return n=void 0===(a=s.props.callback)?function(){}:a,i=t.target.closest(".commentContainer").dataset.id,r=s.props.story,l=s.props.stores.storyStore,(c=s.state.likeComment)[i]=!0,s.setState({likeComment:c}),setTimeout((function(){var t=s.state.likeComment;delete t[i],s.setState({likeComment:t})}),1200),Promise.resolve(l.likeStoryComment({id:r.id,commentId:i})).then((function(t){try{return(d=t)&&200===d.status&&n({type:"likeComment",story:r,commentId:i,response:d}),e(!0)}catch(t){return o(t)}}),o)}))},s.likeReply=function(t){return new Promise((function(e,o){var a,n,i,r,l,c,d,u;return n=void 0===(a=s.props.callback)?function(){}:a,i=t.target.closest(".replyContainer").dataset.id,r=t.target.closest(".replyContainer").dataset.comment,l=s.props.story,c=s.props.stores.storyStore,(d=s.state.likeReply)[i]=!0,s.setState({likeReply:d}),setTimeout((function(){var t=s.state.likeReply;delete t[i],s.setState({likeReply:t})}),1200),Promise.resolve(c.likeStoryCommentReply({id:l.id,replyId:i,commentId:r})).then((function(t){try{return(u=t)&&200===u.status&&n({type:"likeReply",story:l,commentId:r,replyId:i,response:u}),e()}catch(t){return o(t)}}),o)}))},s.replyComment=function(t){return new Promise((function(e){var o=t.target.parentElement.dataset.id||t.target.dataset.id,a=s.state.showAddComment;return a[o]=!a[o],s.setState({showAddComment:a},(function(){s.inputRef[o]&&s.inputRef[o].focus()})),e()}))},s.toggleComments=function(){s.setState({showAllComments:!s.state.showAllComments})},s.toggleReplies=function(t){var e=t.target.parentElement.dataset.id||t.target.dataset.id,o=s.state.showAllReplies;o[e]=!o[e],s.setState({showAllReplies:o})},s.toggleMenu=function(t){var e=t.target.closest("i").dataset.id,o=s.state.showMenu,a=void 0===o?{}:o;a[e]=!a[e],s.setState({showDeleteComment:{},showEdit:{},showMenu:a})},s.toggleEdit=function(t){var e=t.target.closest("button").dataset,o=e.id,a=e.comment,n=s.state.showEdit,i=void 0===n?{}:n;i[o]=!i[o],s.setState({showDeleteComment:{},showEdit:i,showMenu:{},commentEditText:a})},s.toggleDeleteComment=function(t){var e=t.target.closest("button").dataset.id,o=s.state.showDeleteComment,a=void 0===o?{}:o;a[e]=!a[e],s.setState({showDeleteComment:a,showEdit:{},showMenu:{}})},s.deleteComment=function(t){return new Promise((function(e,o){var a;return a=t.target.closest("button").dataset.id,Promise.resolve(s.props.stores.storyStore.deleteCommentStory({id:s.props.story.id,commentId:a})).then((function(){try{return s.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}}),e()}catch(t){return o(t)}}),o)}))},s.deleteCommentReply=function(t){return new Promise((function(e,o){var a;return a=t.target.closest("button").dataset,Promise.resolve(s.props.stores.storyStore.deleteCommentReplyStory({id:s.props.story.id,commentId:a.commentid,replyId:a.id})).then((function(){try{return s.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}}),e()}catch(t){return o(t)}}),o)}))},s.saveComment=function(t){return new Promise((function(e,o){var a;return a=t.target.closest("button").dataset.id,Promise.resolve(s.props.stores.storyStore.editCommentStory({id:s.props.story.id,commentId:a,comment:s.state.commentEditText})).then((function(){try{return s.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}}),e()}catch(t){return o(t)}}),o)}))},s.saveCommentReply=function(t){return new Promise((function(e,o){var a;return a=t.target.closest("button").dataset,Promise.resolve(s.props.stores.storyStore.editCommentReplyStory({id:s.props.story.id,commentId:a.commentid,replyId:a.id,comment:s.state.commentEditText})).then((function(){try{return s.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}}),e()}catch(t){return o(t)}}),o)}))},s.viewImage=function(t){var e=t.target.closest("img").dataset,o=s.state.viewImageIdx;o[e.id]=e.idx,s.setState({viewImageIdx:o})},s.translate=function(t){return new Promise((function(e,o){function a(){return s.setState({showOriginal:b,translatedText:f}),e()}var n,i,r,l,c,d,u,h,m,b,p,f,O;return t.preventDefault(),t.stopPropagation(),n=t.target.closest("button").dataset,l=s.props.story,d=(c=s.props.stores).storyStore,u=c.userStore.user,f=void 0===(p=(h=s.state).translatedText)?{}:p,(b=void 0===(m=h.showOriginal)?{}:m)[O=(r=n.commentid)+((i=n.replyid)?"-"+i:"")]=0,i?Promise.resolve(d.translateCommentReply({commentid:r,replyid:i,story:l,user:u})).then(function(t){try{return f[O]=t,a.call(this)}catch(t){return o(t)}}.bind(this),o):Promise.resolve(d.translateComment({commentid:r,story:l,user:u})).then(function(t){try{return f[O]=t,a.call(this)}catch(t){return o(t)}}.bind(this),o)}))},s.showOriginal=function(t){var e=t.target.closest("button").dataset,o=e.replyid,a=e.commentid;t.preventDefault(),t.stopPropagation();var n=s.state.showOriginal,i=void 0===n?{}:n;i[a+(o?"-"+o:"")]=1,s.setState({showOriginal:i})},s.displayTeam=function(t,e){t.preventDefault(),t.stopPropagation(),s.props.stores.appState.openDrawer("publicTeam",{teamId:e,height:"80vh"})},s.openInbox=function(t,e){t.preventDefault(),t.stopPropagation(),s.props.stores.appState.openDrawer("inboxDetail",{fromuser:e,height:"80vh"})},s.state=a(a({},O),{},{showAllComments:t.showAllComments}),s.inputRef={},s}var o,n;return n=e,(o=s).prototype=Object.create(n.prototype),o.prototype.constructor=o,o.__proto__=n,s.prototype.render=function(){var e,s=this,o=this.state,a=o.showAddComment,n=o.showAllComments,i=o.showAllReplies,c=o.viewImageIdx,h=o.showMenu,O=void 0===h?{}:h,g=o.showEdit,j=void 0===g?{}:g,v=o.showDeleteComment,y=void 0===v?{}:v,w=o.commentEditText,k=o.likeComment,x=o.showOriginal,S=void 0===x?{}:x,C=o.translatedText,I=void 0===C?{}:C,D=this.props,T=D.story,P=D.callback,R=void 0===P?function(){}:P,A=D.initCall,E=void 0===A?function(){}:A,L=D.compact,F=this.props.stores,M=F.userStore,z=F.storyStore,U=M.user,B=U.language,N=void 0===B?"en":B,_=[],W=0,K=0;return T.comments&&(W=T.comments.length,n?_=T.comments:(e=void 0!==L&&L?0:2,_=T.comments.slice(Math.max(W-e,0))),K=_.length),Object(r.h)("div",null,T&&l.a.isArray(_)&&_.reverse().map((function(o){var n=o.user,h=void 0===n?{}:n,g=z.findPublicTeamByMembers(h.id),v=f.a.displayNameShort(h),x=f.a.displayName(h),C=h.image||(h.images?h.images[0]:void 0),D=o.likes&&o.likes.findIndex((function(t){return t.user===U.id}))>-1,P=[],A=0,L=0;o.comments&&(A=o.comments.length,L=(P=i[o.id]?o.comments:o.comments.slice(0,e)).length);var F=[];if(o.images){var M=Object(d.i)(o.images);F.push.apply(F,M)}var B=c[o.id]?c[o.id]:0,_=F&&F[B]?F[B]:null,W=z.getCommentTranslations({story:T,commentid:o.id,targetLang:N})||I[o.id],K=W||o.comment;return S[o.id]&&(K=o.comment),Object(r.h)("div",{class:"row"},Object(r.h)("div",{class:"col-11 offset-1 d-flex mb-2 position-relative"},Object(r.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall",style:(C?'background-image: url("'+C.s3SmallLink+'"); background-size: cover;':"")+" border-width: 3px !important;"},!h.image&&Object(r.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},v)),Object(r.h)("div",{class:"flex-grow-1 pl-3 pt-0",style:"line-height: 1.2em;"},Object(r.h)("div",{class:"bg-light p-2 rounded rounded-lg position-relative"},U.id===h.id&&Object(r.h)(t,null,Object(r.h)("span",{class:"float-right font-weight-lighter text-muted"},Object(r.h)("i",{class:"fas fa-ellipsis-h",onClick:s.toggleMenu,"data-id":o.id}))),O[o.id]&&Object(r.h)(t,null,Object(r.h)("div",{class:"position-absolute bg-white p-2 border rounded rounded-lg shadow-sm",style:"top: 30px; right: 10px; width: 60%; z-index: 999999;"},Object(r.h)("button",{class:"btn btn-link btn-block text-left",onClick:s.toggleEdit,"data-id":o.id,"data-comment":o.comment},Object(r.h)("i",{class:"fas fa-edit"})," Edit"),Object(r.h)("hr",null),Object(r.h)("button",{class:"btn btn-link btn-block text-left",onClick:s.toggleDeleteComment,"data-id":o.id},Object(r.h)("i",{class:"fas fa-trash-alt"})," Delete"))),Object(r.h)("div",null,Object(r.h)("span",{style:"font-size: 0.95em;"},Object(r.h)("h5",{class:"font-weight-bold mb-2",style:"font-size: 1.0em;"},h.uuidv4&&h.uuidv4!==U.uuidv4?Object(r.h)(t,null,Object(r.h)("a",{href:"/inbox/"+h.uuidv4,onClick:function(t){return s.openInbox(t,h.uuidv4)}},x)):Object(r.h)(t,null,x),g&&g.length>0&&Object(r.h)(t,null,Object(r.h)("span",{class:"font-weight-lighter text-muted ml-1"},g.filter((function(t){return 1===t.public})).slice(0,1).map((function(e){return Object(r.h)(t,null,"- ",Object(r.h)("a",{href:"/teams/public/"+e.uuidv4,onClick:function(t){return s.displayTeam(t,e.uuidv4)}},e.name))}))))),j[o.id]?Object(r.h)(t,null,Object(r.h)("div",{class:"d-flex bd-highlight"},Object(r.h)("div",{class:"p-0 w-100 bd-highlight"},Object(r.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(r.h)(u.c,{id:"comments.comment"},"Kommentar")),Object(r.h)("div",{class:"border rounded rounded-lg position-relative"},Object(r.h)(u.b,null,Object(r.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(r.h)(u.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(b.a)(s,"commentEditText"),onKeyUp:f.a.resizeTextarea,onFocus:f.a.resizeTextarea,style:"height: 2.3em;",value:w})))),Object(r.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(r.h)("button",{type:"button",class:"btn btn-primary mb-2",onClick:s.saveComment,"data-id":o.id},Object(r.h)("i",{class:"fas fa-paper-plane"}))))):Object(r.h)(t,null,Object(r.h)(m.a,{markdown:f.a.replaceImages(K,o.images,N),markdownOpts:f.a.getMarkdownOptions()})),y[o.id]&&Object(r.h)("div",{class:"clearfix mt-3 mb-3"},Object(r.h)("button",{class:"btn btn-danger float-left",onClick:s.deleteComment,"data-id":o.id},Object(r.h)("i",{class:"fas fa-trash-alt"})," Delete"),Object(r.h)("button",{class:"btn btn-secondary float-right",onClick:s.toggleDeleteComment,"data-id":o.id},Object(r.h)("i",{class:"fas fa-times-circle"})," Cancel")))),Object(r.h)("div",null,Object(r.h)("div",{class:"container-fluid px-3 mt-1"},_&&Object(r.h)("div",{class:"clearfix row position-relative"},Object(r.h)("div",{class:"commentContainer col-12 px-0 overflow-hidden",style:"max-height: 60vh;",onDblclick:s.addLikeComment,"data-id":o.id},Object(r.h)("img",{loading:"lazy",class:"img-fluid",style:"min-width: 100px;",src:_.s3LargeLink})),k[o.id]&&Object(r.h)("span",{class:"likeHeart position-absolute text-white display-1",style:"top: calc(50% - 50px); left: calc(50% - 50px); width: 100px; height: 100px;"},Object(r.h)("i",{class:"fas fa-heart likeStory"}))),F&&F.length>1&&Object(r.h)("div",{class:"clearfix d-flex flex-wrap row"},l.a.isArray(F)&&F.map((function(e,a){return Object(r.h)(t,null,Object(r.h)("div",{class:"col px-0 overflow-hidden",style:"max-height: 100px; min-width: 100px;"},Object(r.h)("img",{loading:"lazy",class:"img-fluid border",style:"min-width: 100px;",src:e.s3SmallLink,onClick:s.viewImage,"data-id":o.id,"data-idx":a})))})))))),Object(r.h)("small",null,Object(r.h)("button",{class:"commentContainer btn btn-sm btn-link py-0 "+(D?"text-primary":""),onClick:s.addLikeComment,"data-id":o.id,disabled:D},D?Object(r.h)(u.c,{id:"comments.has-liked"},"Liked"):Object(r.h)(u.c,{id:"comments.like"},"Lik")),"-",Object(r.h)("button",{class:"btn btn-sm btn-link py-0",onClick:s.replyComment,"data-id":o.id},Object(r.h)(u.c,{id:"comments.comment-add"},"Kommentar")),o.language!==N&&Object(r.h)(t,null,"-",!S[o.id]&&W?Object(r.h)(t,null,Object(r.h)("button",{type:"button",class:"btn btn-sm btn-link","data-commentid":o.id,onClick:s.showOriginal},Object(r.h)("i",{class:"fas fa-cog"}),"  ",Object(r.h)(u.c,{id:"home.translate-show-original"},"Show original"))):Object(r.h)(t,null,Object(r.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:s.translate,"data-commentid":o.id},Object(r.h)("i",{class:"fas fa-cog"})," ",Object(r.h)(u.c,{id:"home.translate-to"},"See translation")))),"-",Object(r.h)("button",{class:"btn btn-sm btn-link py-0 disabled"},l.a.formatDistance(o.createdDate,new Date,{locale:"no-NB"}),o.updatedDate&&Object(r.h)(t,null,Object(r.h)("span",{class:"font-weight-light ml-2"},"(Edited ",l.a.formatDistance(o.updatedDate,new Date,{locale:"no-NB"}),")"))))),o.likes&&o.likes.length>0&&Object(r.h)("small",{class:"position-absolute bg-light shadow-sm rounded-lg py-0 px-1",style:"bottom: 20px; right: 15px;"},Object(r.h)("i",{class:"fas fa-thumbs-up text-primary"})," ",o.likes.length)),Object(r.h)("div",{class:"col-10 offset-2 mb-2"},o&&l.a.isArray(P)&&P.map((function(e){var a=e.user,n=void 0===a?{}:a,i=z.findPublicTeamByMembers(n.id),c=f.a.displayNameShort(n),d=f.a.displayName(n),h=n.image||(n.images?n.images[0]:void 0),p=e.likes&&e.likes.findIndex((function(t){return t.user===U.id}))>-1,g=z.getCommentReplyTranslations({story:T,commentid:o.id,replyid:e.id,targetLang:N})||I[o.id+"-"+e.id],v=g||e.comment;return S[o.id+"-"+e.id]&&(v=e.comment),Object(r.h)("div",{class:"row"},Object(r.h)("div",{class:"col-12 d-flex mb-2 position-relative"},Object(r.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall",style:(h?'background-image: url("'+h.s3SmallLink+'"); background-size: cover;':"")+" border-width: 3px !important;"},!n.image&&Object(r.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},c)),Object(r.h)("div",{class:"flex-grow-1 pl-3 pt-0",style:"line-height: 1.2em;"},Object(r.h)("div",{class:"bg-light p-2 rounded-lg position-relative"},U.id===n.id&&Object(r.h)(t,null,Object(r.h)("span",{class:"float-right font-weight-lighter text-muted"},Object(r.h)("i",{class:"fas fa-ellipsis-h",onClick:s.toggleMenu,"data-id":e.id}))),O[e.id]&&Object(r.h)(t,null,Object(r.h)("div",{class:"position-absolute bg-white p-2 border rounded rounded-lg shadow-sm",style:"top: 30px; right: 10px; width: 60%; z-index: 999999;"},Object(r.h)("button",{class:"btn btn-link btn-block text-left",onClick:s.toggleEdit,"data-id":e.id,"data-comment":e.comment},Object(r.h)("i",{class:"fas fa-edit"})," Edit"),Object(r.h)("hr",null),Object(r.h)("button",{class:"btn btn-link btn-block text-left",onClick:s.toggleDeleteComment,"data-id":e.id},Object(r.h)("i",{class:"fas fa-trash-alt"})," Delete"))),Object(r.h)("span",{style:"font-size: 0.95em;"},Object(r.h)("h5",{class:"font-weight-bold mb-2",style:"font-size: 1.0em;"},n.uuidv4&&n.uuidv4!==U.uuidv4?Object(r.h)(t,null,Object(r.h)("a",{href:"/inbox/"+n.uuidv4,onClick:function(t){return s.openInbox(t,n.uuidv4)}},d)):Object(r.h)(t,null,d),i&&i.length>0&&Object(r.h)(t,null,Object(r.h)("span",{class:"font-weight-lighter text-muted ml-2"},i.filter((function(t){return 1===t.public})).slice(0,1).map((function(e){return Object(r.h)(t,null,"- ",Object(r.h)("a",{href:"/teams/public/"+e.uuidv4,class:"mr-2",onClick:function(t){return s.displayTeam(t,e.uuidv4)}}," ",e.name))}))))),j[e.id]?Object(r.h)(t,null,Object(r.h)("div",{class:"d-flex bd-highlight"},Object(r.h)("div",{class:"p-0 w-100 bd-highlight"},Object(r.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(r.h)(u.c,{id:"comments.comment"},"Kommentar")),Object(r.h)("div",{class:"border rounded rounded-lg position-relative"},Object(r.h)(u.b,null,Object(r.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(r.h)(u.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(b.a)(s,"commentEditText"),onKeyUp:f.a.resizeTextarea,onFocus:f.a.resizeTextarea,style:"height: 2.3em;",value:w})))),Object(r.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(r.h)("button",{type:"button",class:"btn btn-primary mb-2",onClick:s.saveCommentReply,"data-commentid":o.id,"data-id":e.id},Object(r.h)("i",{class:"fas fa-paper-plane"}))))):Object(r.h)(t,null,Object(r.h)(m.a,{markdown:f.a.replaceImages(v,e.images,N),markdownOpts:f.a.getMarkdownOptions()})),y[e.id]&&Object(r.h)("div",{class:"clearfix mt-3 mb-3"},Object(r.h)("button",{class:"btn btn-danger float-left",onClick:s.deleteCommentReply,"data-id":e.id,"data-commentid":o.id},Object(r.h)("i",{class:"fas fa-trash-alt"})," Delete"),Object(r.h)("button",{class:"btn btn-secondary float-right",onClick:s.toggleDeleteComment,"data-id":e.id},Object(r.h)("i",{class:"fas fa-times-circle"})," Cancel")))),Object(r.h)("small",null,Object(r.h)("button",{class:"replyContainer btn btn-sm btn-link py-0 "+(p?"text-primary":""),onClick:s.likeReply,"data-comment":o.id,"data-id":e.id,disabled:p},p?Object(r.h)(u.c,{id:"comments.has-liked"},"Liked"):Object(r.h)(u.c,{id:"comments.like"},"Lik")),"-",Object(r.h)("button",{class:"btn btn-sm btn-link py-0",onClick:s.replyComment,"data-id":o.id},Object(r.h)(u.c,{id:"comments.comment-add"},"Kommentar")),e.language!==N&&Object(r.h)(t,null,"-",!S[o.id+"-"+e.id]&&g?Object(r.h)(t,null,Object(r.h)("button",{type:"button",class:"btn btn-sm btn-link","data-commentid":o.id,"data-replyid":e.id,onClick:s.showOriginal},Object(r.h)("i",{class:"fas fa-cog"}),"  ",Object(r.h)(u.c,{id:"home.translate-show-original"},"Show original"))):Object(r.h)(t,null,Object(r.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:s.translate,"data-commentid":o.id,"data-replyid":e.id},Object(r.h)("i",{class:"fas fa-cog"})," ",Object(r.h)(u.c,{id:"home.translate-to"},"See translation")))),"-",Object(r.h)("button",{class:"btn btn-sm btn-link py-0 disabled"},l.a.formatDistance(e.createdDate,new Date,{locale:"no-NB"}),e.updatedDate&&Object(r.h)(t,null,Object(r.h)("span",{class:"font-weight-light ml-2"},"(Edited ",l.a.formatDistance(e.updatedDate,new Date,{locale:"no-NB"}),")"))))),e.likes&&Object(r.h)("small",{class:"position-absolute bg-light shadow-sm rounded-lg py-0 px-1",style:"bottom: 20px; right: 15px;"},Object(r.h)("i",{class:"fas fa-thumbs-up text-primary"})," ",e.likes.length)))})),A-L>0&&Object(r.h)("div",null,Object(r.h)("button",{class:"btn btn-sm btn-link py-0",onClick:s.toggleReplies,"data-id":o.id},Object(r.h)(u.c,{id:"comments.show-more",fields:{more:A-L}},"Vis ",A-L," flere kommentarer...")))),a[o.id]&&Object(r.h)("div",{class:"col-11 offset-1 d-flex mb-2 position-relative"},Object(r.h)(p.a,{stores:s.props.stores,story:T,initCall:E,callback:R,commentId:o.id,inputRef:function(t){return s.inputRef[o.id]=t},inputRefObject:s.inputRef,key:"story-commentreply-"+o.id})))})),W-K>0&&Object(r.h)("div",null,Object(r.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.toggleComments},Object(r.h)(u.c,{id:"comments.show-more",fields:{more:W-K}},"Vis ",W-K," flere kommentarer..."))),n&&Object(r.h)("div",null,Object(r.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.toggleComments},Object(r.h)(u.c,{id:"comments.hide-all-comments"},"Skjul alle kommentarene."))))},s}(r.Component))||i;e.a=g}).call(this,s("hosL").Fragment)},ISGx:function(t,e,s){"use strict";(function(t){function o(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,o)}return s}function a(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?o(Object(s),!0).forEach((function(e){n(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function n(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var i,r=s("hosL"),l=s("Utv1"),c=s("/eY4"),d=s("cneo"),u=s("OhSV"),h=s("fh8t"),m=s.n(h),b=s("Y3FI"),p=s("s4FZ"),f=s("ZQlJ"),O=s("sqi2"),g=s("/922"),j=s("eQ6k"),v=s("+JSK"),y=s("vY+r"),w=s("nHdA"),k=s("irB3"),x=s("UwwE"),S=s("8Lgr"),C=s("QkTp"),I=s("ZOvn"),D={showAddComment:{},likeWorkout:{},idxSuggestion:0,idxAd:4,limit:15,offset:0,hasFollowSugguestions:!1,hasAd:!1,sessionid:(new Date).getTime()},T=Object(c.a)(i=function(e){function s(t){var s;return(s=e.call(this,t)||this).toggleDate=function(t){t.stopPropagation(),t.preventDefault(),s.setState({showDate:!s.state.showDate})},s.likeWorkout=function(t){return new Promise((function(e,o){var a,n,i,r;return a=parseInt(t.target.closest(".imageContainer").dataset.id,10),n=s.props.stores.workoutStore,(i=s.state.likeWorkout)[a]=!0,s.setState({likeWorkout:i}),setTimeout((function(){var t=s.state.likeWorkout;delete t[a],s.setState({likeWorkout:t})}),1200),Promise.resolve(n.likeWorkout({id:a})).then((function(t){try{return(r=t)&&200===r.status&&s.addLikeToFeed(a,r.data),e()}catch(t){return o(t)}}),o)}))},s.addCommentToFeed=function(t){var e=t.type,o=t.workout,a=t.response,n=t.commentId,i=t.replyId,r=s.props.holdingStore,l=void 0===r?"team":r;if("team"===l){var c=s.props.stores.teamStore;switch(e){case"likeComment":c.addLikeToComment({id:o.id,data:a.data,commentId:n});break;case"likeReply":c.addLikeToCommentReply({id:o.id,data:a.data,commentId:n,replyId:i});break;default:n?c.addCommentToWorkoutComment({id:o.id,data:a.data,commentId:n}):c.addCommentToWorkout({id:o.id,data:a.data})}}else if("story"===l){var d=s.props.stores.storyStore;switch(e){case"likeComment":d.workoutsAddLikeToComment({id:o.id,data:a.data,commentId:n});break;case"likeReply":d.workoutsAddLikeToCommentReply({id:o.id,data:a.data,commentId:n,replyId:i});break;default:n?d.workoutsAddCommentToWorkoutComment({id:o.id,data:a.data,commentId:n}):d.workoutsAddCommentToWorkout({id:o.id,data:a.data})}}},s.addLikeToFeed=function(t,e){var o=s.props.holdingStore,a=void 0===o?"team":o;if("team"===a)s.props.stores.teamStore.addLikeToWorkout({id:t,data:e});else if("story"===a){s.props.stores.storyStore.workoutsAddLikeToWorkout({id:t,data:e})}},s.toggleAddComment=function(t){var e=t.target.closest("button").dataset.id,o=s.state.showAddComment;o[e]?delete o[e]:o[e]=!0,s.setState({showAddComment:o},(function(){s.inputRef[e]&&s.inputRef[e].focus()}))},s.shareLink=function(t){var e=t.target.closest("button").dataset;s.props.stores.appState.shareUrl({url:e.url,title:e.title,text:e.text})},s.showWorkoutDetail=function(t){if("a"===t.target.localName)return!1;var e=t.target.closest("#workoutDetail");if(e){var s=e.dataset.id;s&&(console.log({target:e,id:s}),Object(b.route)("/workouts/public/"+s))}},s.translate=function(t){return new Promise((function(e,o){var a,n,i,r,l,c,d;return t.preventDefault(),t.stopPropagation(),n=void 0===(a=s.props.feed)?{}:a,r=(i=s.props.stores).teamStore,l=i.userStore.user,Promise.resolve(r.translate({object:n,user:l,field:"name"})).then(function(t){try{if(c=t,n.comment)return Promise.resolve(r.translate({object:n,user:l,field:"comment"})).then(function(t){try{return d=t,a.call(this)}catch(t){return o(t)}}.bind(this),o);function a(){return s.setState({showOriginal:0,translatedTextName:c,translatedTextComment:d}),e()}return a.call(this)}catch(t){return o(t)}}.bind(this),o)}))},s.showOriginal=function(t){t.preventDefault(),t.stopPropagation(),s.setState({showOriginal:1})},s.displayTeam=function(t,e){t.preventDefault(),t.stopPropagation(),s.props.stores.appState.openDrawer("publicTeam",{teamId:e,height:"80vh"})},s.openInbox=function(t,e){t.preventDefault(),t.stopPropagation(),s.props.stores.appState.openDrawer("inboxDetail",{fromuser:e,height:"80vh"})},s.state=a({},D),s.inputRef={},s.containerRef=null,s}var o,n;return n=e,(o=s).prototype=Object.create(n.prototype),o.prototype.constructor=o,o.__proto__=n,s.prototype.render=function(){var e,s=this,o=this.props,n=o.feed,i=o.onTeamClick,c=void 0===i?function(){}:i,h=o.onUserClick,b=void 0===h?function(){}:h,D=o.onDogClick,T=void 0===D?function(){}:D,P=o.holdingStore,R=void 0===P?"team":P,A=this.state,E=A.showAddComment,L=A.showDate,F=A.likeWorkout,M=A.showOriginal,z=A.translatedTextName,U=A.translatedTextComment,B=this.props.stores,N=B.teamStore,_=B.storyStore,W=B.userStore,K=B.appState,V=W.user,q=W.isAdmin,Y=V.language,Z=void 0===Y?"en":Y,Q=K.hasShareApi,G={},H={};if("team"===R)G=N.findPublicTeam(n.team),H=N.findPublicUser(n.user)||{},e=N.publicDogs;else if("story"===R){G=_.findPublicTeam(n.team),H=_.findPublicUser(n.user)||{},e=_.publicDogs}W.findTeamAmbition({ambition:G.ambitions,language:Z});var J,X,$=W.findTeamType({type:G.type,language:Z}),tt=!(!G||!G.members)&&G.members.some((function(t){return t===V.id})),et=I.a.getImage({user:H,team:G,object:n,priority:"user"}),st=n.likes,ot=n.comments,at=n.likes&&n.likes.findIndex((function(t){return t.user===V.id}))>-1,nt=G&&G.followers?G.followers.length:0,it=G.members&&G.members.indexOf(V.id)>-1,rt=G&&G.followers&&G.followers.indexOf(V.id)>-1,lt=G.followRequests&&G.followRequests.findIndex((function(t){return t.id===V.id}))>-1,ct=W.findEquipment({equipment:n.equipment,language:Z}),dt=W.findEquipment({equipment:n.equipment,field:"icon"}),ut=n.gpxInfo,ht=void 0===ut?{}:ut;H&&(I.a.displayNameShort(H),I.a.displayName(H),J=I.a.displayName(H),H.settings&&H.uuidv4!==V.uuidv4&&(X=H.settings.hideProfile?null:"/inbox/"+H.uuidv4));var mt=[];if(n.mapImage&&mt.push(a(a({},n.mapImage),{},{type:"map"})),n.images){var bt=Object(d.i)(n.images);mt.push.apply(mt,bt)}var pt=n.currentLocationGeocode,ft=void 0===pt?{}:pt,Ot=I.a.getViews(n.statistics),gt=I.a.getAdminData(n.statistics);if(!G||!G.name)return"";var jt=I.a.getTranslation({object:n,targetLang:Z,field:"name"})||z,vt=jt||n.name,yt=I.a.getTranslation({object:n,targetLang:Z,field:"comment"})||U||n.comment;return M&&(vt=n.name,yt=n.comment),Object(r.h)(t,null,Object(r.h)("div",{class:"d-flex position-relative"},Object(r.h)("div",{class:"text-center"},Object(r.h)("div",{class:"position-relative text-center border rounded-circle imageRounded imageRoundedMedium",style:et?'background-image: url("'+et+'"); background-size: cover;':""},!et&&Object(r.h)("i",{class:"fas fa-users text-muted mt-2",style:"font-size: 20px;"}))),Object(r.h)("div",{class:"flex-grow-1 pl-3 text-overflow",style:"line-height: 1.2em;"},Object(r.h)("span",{class:"badge badge-pill badge-secondary float-right"},$),Object(r.h)("h5",{class:"mb-1 position-relative",style:"line-height: 1.0em;"},G.public?Object(r.h)(t,null,Object(r.h)("a",{href:"/teams/public/"+G.uuidv4,onClick:function(t){return s.displayTeam(t,G.uuidv4)},class:"stretched-link"},G.name)):Object(r.h)(t,null,G.name)),Object(r.h)("div",{class:"mb-2"},n.date&&Object(r.h)("small",{class:"text-muted",onClick:this.toggleDate},L?l.a.formatDate(n.date,{locale:"no-NB",hour12:!1,hour:"2-digit",minute:"2-digit"}):l.a.formatDistance(n.date,new Date,{locale:"no-NB"})),1===n.public?Object(r.h)(t,null,Object(r.h)("small",{class:"ml-2 text-muted"},Object(r.h)("i",{class:"fas fa-globe-europe"}))):Object(r.h)(t,null,Object(r.h)("small",{class:"ml-2 text-muted"},Object(r.h)("i",{class:"fas fa-users"})," (",l.a.format(nt),")")),J&&Object(r.h)(t,null,Object(r.h)("small",{class:"ml-2 text-muted"},X?Object(r.h)(t,null,Object(r.h)("i",{class:"fas fa-user"})," ",Object(r.h)("a",{href:X,onClick:function(t){return s.openInbox(t,H.uuidv4)}},J)):Object(r.h)(t,null,Object(r.h)("i",{class:"fas fa-user"})," ",J))),Object(r.h)("small",{class:"text-muted"},n.equipment>0&&Object(r.h)(t,null,Object(r.h)("i",{class:dt+" ml-2"})," ",ct),n.dogs>0&&Object(r.h)(t,null,Object(r.h)("i",{class:"fas fa-dog ml-2"})," ",n.dogs.length),n.track>0&&Object(r.h)(t,null,Object(r.h)("i",{class:"fas fa-map-marked text-"+(n.track>0?"success":"danger")+" ml-2"})),n.sledWeight>0&&Object(r.h)(t,null,Object(r.h)("i",{class:"fas fa-sleigh ml-2"})," ",Object(r.h)(x.a,{stores:this.props.stores,value:n.sledWeight})),0!==n.temperature&&Object(r.h)(t,null,Object(r.h)("i",{class:"fas fa-temperature-low ml-2"})," ",Object(r.h)(C.a,{stores:this.props.stores,value:n.temperature})),n.dogs&&n.dogs.length>0&&Object(r.h)(t,null,Object(r.h)("i",{class:"fas fa-dog ml-2"})," ",l.a.format(n.dogs.length,0)),ft&&ft.formattedCounty&&Object(r.h)(t,null,Object(r.h)("i",{class:"fas fa-map-marker-alt ml-2"})," ",ft.formattedCounty),n.moonIllumination&&n.moonIllumination.phaseIcon&&Object(r.h)("span",{class:"float-right ml-2"},n.moonIllumination.phaseIcon))),q&&Object(r.h)("div",{class:"d-flex flex-row flex-nowrap bg-light border-top border-bottom py-2",style:"overflow: auto;"},Object(r.h)("small",{class:"text-muted mr-2"},"Adm:"),ft&&ft.formatted_address&&Object(r.h)(t,null,Object(r.h)("small",{class:"text-muted"},Object(r.h)("i",{class:"fas fa-map-marker-alt"})," ",ft.formatted_address)),H.deviceInfo&&Object(r.h)(t,null,Object(r.h)("span",{class:"badge badge-secondary ml-1 float-right font-weight-light"},["platform","manufacturer","model"].map((function(e){return Object(r.h)(t,null,Object(r.h)("span",{class:"ml-1 text-white"},H.deviceInfo[e]))})))),gt&&Object(r.h)(t,null,Object(r.h)("small",{class:"ml-2 text-muted"},"V: ",gt.count),Object(r.h)("small",{class:"ml-2 text-muted"},"R: ",gt.ranking," ",l.a.isNumber(gt.rankingTrend)&&Object(r.h)(t,null,Object(r.h)("i",{class:I.a.getClassForTrend(gt.rankingTrend)}))),Object(r.h)("small",{class:"ml-2 text-muted"},"D: ",l.a.format(gt.durationAvg/1e3,1),"s ",l.a.isNumber(gt.durationAvgTrend)&&Object(r.h)(t,null,Object(r.h)("i",{class:I.a.getClassForTrend(gt.durationAvgTrend)}))),n.statisticsCurrent&&n.statisticsCurrent.totalInteractions>0&&Object(r.h)("small",{class:"ml-2 text-muted"},"S: ",l.a.format(n.statisticsCurrent.totalInteractions,0)),n.shadowTags&&n.shadowTags.map((function(e){return Object(r.h)(t,null,Object(r.h)("span",{class:"badge badge-secondary ml-2 float-right font-weight-light"},e))})))))),Object(r.h)("div",{class:"container-fluid px-0 mt-1"},Object(r.h)("div",{class:"row"},Object(r.h)(p.a,{stores:this.props.stores,images:mt,id:n.id,dblClick:this.likeWorkout,likeRef:F}))),n.dogs&&n.dogs.length>0&&Object(r.h)("div",{class:"container-fluid px-0 mt-1"},Object(r.h)("div",{class:"row pt-2"},Object(r.h)(f.a,{stores:this.props.stores,dogs:n.dogs,allDogs:e,onDogClick:T}))),Object(r.h)("div",{class:"d-flex justify-content-between bg-light rounded-lg px-2"},n.distanceKm>0&&Object(r.h)("div",{class:"mr-2 text-center"},Object(r.h)("div",{class:"text-overflow text-muted"},Object(r.h)("small",null,Object(r.h)("i",{class:"fas fa-road"})," ",Object(r.h)(u.c,{id:"workout.calendar.distance"},"Distanse"))),Object(r.h)("div",{class:"text-overflow font-weight-light",style:"font-size: 1.2em;"},Object(r.h)(S.a,{stores:this.props.stores,value:n.distanceKm}))),n.elevation>0&&Object(r.h)("div",{class:"mr-2 text-center"},Object(r.h)("div",{class:"text-overflow text-muted"},Object(r.h)("small",null,Object(r.h)("i",{class:"fas fa-mountain"})," ",Object(r.h)(u.c,{id:"workout.calendar.ascend"},"Høydemeter"))),Object(r.h)("div",{class:"text-overflow font-weight-light",style:"font-size: 1.2em;"},Object(r.h)(k.a,{stores:this.props.stores,value:n.elevation}))),n.duration>0&&Object(r.h)("div",{class:"mr-2 text-center"},Object(r.h)("div",{class:"text-overflow text-muted"},Object(r.h)("small",null,Object(r.h)("i",{class:"fas fa-clock"})," ",Object(r.h)(u.c,{id:"workout.calendar.duration"},"Varighet"))),Object(r.h)("div",{class:"text-overflow font-weight-light",style:"font-size: 1.2em;"},l.a.secToHms(n.duration,!0))),n.speedAvg>0&&Object(r.h)("div",{class:"text-center"},Object(r.h)("div",{class:"text-overflow text-muted"},Object(r.h)("small",null,Object(r.h)("i",{class:"fas fa-tachometer-alt"})," ",Object(r.h)(u.c,{id:"workout.calendar.avg-speed"},"Snittfart"))),Object(r.h)("div",{class:"text-overflow font-weight-light",style:"font-size: 1.2em;"},ht&&ht.avgGpsMovingSpeed>0?Object(r.h)(t,null,Object(r.h)(w.a,{stores:this.props.stores,value:3.6*ht.avgGpsMovingSpeed})):Object(r.h)(t,null,Object(r.h)(w.a,{stores:this.props.stores,value:n.speedAvg}))))),Object(r.h)("div",{class:"row mt-2"},Object(r.h)("div",{id:"workoutDetail",class:"clearfix col-12 font-weight-bold",style:"font-size: 1.2em;",onClick:this.showWorkoutDetail,"data-id":n.uuidv4},Object(r.h)(m.a,{markdown:I.a.replaceImages(vt,n.images,Z),markdownOpts:I.a.getMarkdownOptions()})),Object(r.h)("div",{class:"clearfix col-12"},Object(r.h)(m.a,{markdown:I.a.replaceImages(yt,n.images,Z),markdownOpts:I.a.getMarkdownOptions()})),n.language!==Z&&Object(r.h)(t,null,!M&&jt?Object(r.h)(t,null,Object(r.h)("button",{type:"button",class:"btn btn-sm btn-link text-muted",onClick:this.showOriginal},Object(r.h)("i",{class:"fas fa-cog"}),"  ",Object(r.h)(u.c,{id:"home.translate-show-original"},"Show original"))):Object(r.h)(t,null,Object(r.h)("button",{type:"button",class:"btn btn-sm btn-link text-muted",onClick:this.translate},Object(r.h)("i",{class:"fas fa-cog"})," ",Object(r.h)(u.c,{id:"home.translate-to"},"See translation"))))),Object(r.h)("div",{class:"mt-2"},Object(r.h)(v.a,{stores:this.props.stores,likes:st,comments:ot,type:"team",onTeamClick:c,onUserClick:b})),!it&&!rt&&!lt&&Object(r.h)("div",{class:"clearfix mb-2"},Object(r.h)(j.a,{stores:this.props.stores,team:G,buttonOnly:!0})),Object(r.h)("div",null,Object(r.h)("div",{class:"row"},Object(r.h)("div",{class:"col text-center"},Object(r.h)("button",{type:"button",class:"imageContainer btn btn-sm btn-outline-"+(at?"primary":"secondary")+" btn-lg btn-block "+(at?"text-primary":"")+" text-overflow","data-id":n.id,onClick:this.likeWorkout},Object(r.h)("i",{class:(at?"text-primary fas":"far")+" fa-thumbs-up"})," ",Object(r.h)(u.c,{id:"comments.like"},"Lik"))),Object(r.h)("div",{class:"col text-center"},Object(r.h)("button",{type:"button",class:"btn btn-sm btn-outline-secondary btn-lg btn-block text-overflow","data-id":n.id,onClick:this.toggleAddComment},Object(r.h)("i",{class:"fas fa-comment"})," ",Object(r.h)(u.c,{id:"comments.comment-add"},"Kommentar"))),Q?Object(r.h)(t,null,Object(r.h)("div",{class:"col text-center"},Object(r.h)("button",{class:"btn btn-sm btn-outline-secondary btn-lg btn-block text-overflow",onClick:this.shareLink,"data-url":"https://themusher.app/share/workout/"+n.uuidv4,"data-title":"title: "+n.title},Object(r.h)("i",{class:"fas fa-share"})," ",Object(r.h)(u.c,{id:"story.share"},"Del")))):Object(r.h)(t,null,Object(r.h)("div",{class:"col text-center"},Object(r.h)("a",{class:"btn btn-sm btn-outline-secondary btn-lg btn-block text-overflow",href:"https://themusher.app/share/workout/"+n.uuidv4,target:"_blank",rel:"noreferrer","data-native":!0},Object(r.h)("i",{class:"fas fa-share"})," ",Object(r.h)(u.c,{id:"story.share"},"Del")))))),Ot>0&&Object(r.h)(t,null,Object(r.h)("div",{class:"mt-2"},Object(r.h)(y.a,{stores:this.props.stores,views:Ot,object:n,type:"team",isTeamAdmin:tt,isAdmin:q,onTeamClick:c,onUserClick:b}))),Object(r.h)("div",{class:"mt-2"},E[n.id]&&Object(r.h)(g.a,{stores:this.props.stores,workout:n,inputRef:function(t){return s.inputRef[n.id]=t},inputRefObject:this.inputRef,col:"12",offset:"0",showAvatar:!0,extraClass:"px-0",callback:this.addCommentToFeed}),Object(r.h)(O.a,{stores:this.props.stores,workout:n,col:"12",offset:"0",compact:!1,callback:this.addCommentToFeed})))},s}(r.Component))||i;e.a=T}).call(this,s("hosL").Fragment)},NMoA:function(t,e,s){"use strict";(function(t){function o(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,o)}return s}function a(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?o(Object(s),!0).forEach((function(e){n(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function n(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function i(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var r,l,c,d,u,h=s("hosL"),m=s("Utv1"),b=s("/eY4"),p=s("cneo"),f=s("OhSV"),O=s("fh8t"),g=s.n(O),j=s("go65"),v=s("Y3FI"),y=(s("1OK2"),s("B95u")),w=s("4QWe"),k=(s("NMoA"),s("P9Fo")),x=s("s4FZ"),S=s("+JSK"),C=s("vY+r"),I=s("eQ6k"),D=s("om2D"),T=s("ZOvn"),P={showAddComment:{},showTeamSetting:{},viewImageIdx:{},likeStory:{}},R=Object(b.a)(r=function(e){function s(t){var s;return(s=e.call(this,t)||this).saveStory=function(t){return new Promise((function(e,o){var a,n,i,r,l;return a=t.target.closest("button").dataset.id,n=s.state.storyBody,i=s.props.stores.storyStore,l=void 0===(r=s.props.callback)?function(){return!0}:r,Promise.resolve(i.saveField(parseInt(a,10),"body",n,!0)).then((function(){try{return i.publicFeedUpdate(parseInt(a,10),"body",n),s.setState({storyBody:"",storyType:0}),l(),e()}catch(t){return o(t)}}),o)}))},s.saveStoryField=function(t){return new Promise((function(e){var o=s.props.story.id,a=t.target,n=a.value,i=a.name,r=t.target.dataset,l=r.subfield,c=r.subvalue;return s.state.sendButtonEnabled?(s.props.stores.storyStore.publicFeedUpdate(o,i,n),clearTimeout(s.updateTimer[i]),s.updateTimer[i]=setTimeout((function(){return new Promise((function(t){var e;return s.doUpdateField(o,i,n,{query:(e={},e[l]=c,e)}),t()}))}),1e3),e()):e(!1)}))},s.updateFieldValue=function(t){var e=t.id,o=t.field,a=t.value,n=t.skipTimer,i=void 0!==n&&n,r=s.props.story,l=s.props.stores.storyStore,c=a,d=a;"images"===o&&Array.isArray(r.images)&&Array.isArray(a)&&(d=[].concat(r.images,a)),l.updateField(e,o,d),l.publicFeedUpdate(e,o,d),i?s.doUpdateField(e,o,c):(clearTimeout(s.updateTimer[o]),s.updateTimer[o]=setTimeout((function(){return new Promise((function(t){return s.doUpdateField(e,o,c),t()}))}),500))},s.beforeImagesUploaded=function(){s.setState({sendButtonEnabled:!1})},s.afterImagesUploaded=function(){s.setState({sendButtonEnabled:!0})},s.removeImage=function(t){return new Promise((function(e){return s.props.stores.storyStore.removeImage({id:s.props.story.id,name:t.target.parentElement.dataset.name||t.target.dataset.name}),e()}))},s.handleImageErrored=function(t){var e=t.target;e.onerror=null,setTimeout((function(){e.src+="?"+new Date}),1e3)},s.updateTimer={},s.textareaRef=Object(h.createRef)(),s.state={sendButtonEnabled:!0,storyBody:t.story.body},s}i(s,e);var o=s.prototype;return o.doUpdateField=function(t,e,s,o){return new Promise(function(n,i){return void 0===o&&(o={}),this.setState({sendButtonEnabled:!1}),Promise.resolve(this.props.stores.storyStore.saveField(parseInt(t,10),e,s,!0,{query:a({},o.query)})).then(function(){try{return this.setState({sendButtonEnabled:!0}),n()}catch(t){return i(t)}}.bind(this),i)}.bind(this))},o.componentDidMount=function(){this.textareaRef.current.focus()},o.render=function(){var e=this,s=this.state,o=s.storyBody,a=s.storyType,n=s.sendButtonEnabled,i=this.props.stores.userStore.isAdmin,r=this.props.story;return Object(h.h)(t,null,Object(h.h)("div",{class:"container-fluid px-0 mt-1"},Object(h.h)("div",{class:"row"},Object(h.h)("div",{class:"col-12 text-center mt-2"},Object(h.h)("div",{class:"container-fluid"},Object(h.h)("div",{class:"row d-flex align-items-end"},m.a.isArray(r.images)&&r.images.map((function(t,s){return Object(h.h)("div",{class:"col-3 p-1"},Object(h.h)("img",{src:t.s3SmallLink,class:"img-fluid",onError:e.handleImageErrored}),Object(h.h)("button",{class:"btn btn-sm btn-link",onClick:e.removeImage,"data-name":t.name},Object(h.h)("i",{class:"fas fa-trash"})," Del"),Object(h.h)("small",null,Object(h.h)("input",{class:"form-control",type:"text",name:"images.title","data-subfield":"name","data-subvalue":r.images[s].name,onInput:e.saveStoryField,value:r.images[s].title})))})))),Object(h.h)(D.a,{object:r,updateField:this.updateFieldValue,before:this.beforeImagesUploaded,after:this.afterImagesUploaded,autoOpen:!1}))),Object(h.h)("div",{class:"row"},Object(h.h)("div",{class:"col-12 mt-2"},Object(h.h)("label",null,Object(h.h)(f.c,{id:"story.content"},"Content")),Object(h.h)("div",{class:"border rounded rounded-lg position-relative"},Object(h.h)(f.b,null,Object(h.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(h.h)(f.c,{id:"story.add-content"},"Add your text here..."),onInput:Object(j.a)(this,"storyBody"),onFocus:T.a.resizeTextarea,style:"height: 2.3em;",value:o||r.body,ref:this.textareaRef}))))),Object(h.h)("div",{class:"row"},Object(h.h)("div",{class:"col-12 mt-2"},i&&Object(h.h)(t,null,Object(h.h)("div",{class:"col-12 mt-2"},Object(h.h)("div",{class:"form-group"},Object(h.h)("small",null,Object(h.h)("input",{type:"checkbox",id:"pinned-"+r.id,name:"pinned",onInput:this.saveStoryField,value:r.pinned?"":m.a.isoDate(),checked:r.pinned?"checked":""}),Object(h.h)("label",{class:"ml-2",for:"pinned-"+r.id},"Pinned to top."))))),i&&Object(h.h)(t,null,Object(h.h)("label",null,Object(h.h)(f.c,{id:"story.type"},"Type")),Object(h.h)("div",{class:"form-group"},Object(h.h)("small",null,Object(h.h)("select",{class:"custom-select custom-select-sm",id:r.id,name:"type",onInput:this.saveStoryField,value:a||r.type},Object(h.h)("option",{value:""},"-- ",Object(h.h)(f.c,{id:"story.type-choose"},"Velg type")," --"),Object(h.h)("option",{value:1,selected:1==r.type?"selected":""},"✍️ ",Object(h.h)(f.c,{id:"story.type-regular"},"Vanlig")),Object(h.h)("option",{value:2,selected:2==r.type?"selected":""},"🚀 ",Object(h.h)(f.c,{id:"story.type-ad"},"Annonse")),Object(h.h)("option",{value:3,selected:3==r.type?"selected":""},"📄 ",Object(h.h)(f.c,{id:"story.type-article"},"Artikkel")))))),r.type>=2&&Object(h.h)(t,null,Object(h.h)("label",null,Object(h.h)(f.c,{id:"story.url-text"},"URL text")),Object(h.h)("div",{class:"form-group"},Object(h.h)("small",null,Object(h.h)("input",{class:"form-control",type:"text",name:"urlText",onInput:this.saveStoryField,value:r.urlText}))),Object(h.h)("label",null,Object(h.h)(f.c,{id:"story.url"},"URL")),Object(h.h)("div",{class:"form-group"},Object(h.h)("small",null,Object(h.h)("input",{class:"form-control",type:"text",name:"url",onInput:this.saveStoryField,value:r.url})))),2===r.type&&Object(h.h)(t,null,Object(h.h)("label",null,Object(h.h)(f.c,{id:"story.code"},"Code")),Object(h.h)("div",{class:"form-group"},Object(h.h)("small",null,Object(h.h)("input",{class:"form-control",type:"text",name:"code",onInput:this.saveStoryField,value:r.code}))),Object(h.h)("label",null,Object(h.h)(f.c,{id:"story.country"},"Country")),Object(h.h)("div",{class:"form-group"},Object(h.h)("small",null,Object(h.h)("input",{class:"form-control",type:"text",name:"country",onInput:this.saveStoryField,value:r.country}))),Object(h.h)("label",null,Object(h.h)(f.c,{id:"story.region"},"Region")),Object(h.h)("div",{class:"form-group"},Object(h.h)("small",null,Object(h.h)("input",{class:"form-control",type:"text",name:"region",onInput:this.saveStoryField,value:r.region}))),Object(h.h)("label",null,Object(h.h)(f.c,{id:"story.currency"},"Currency")),Object(h.h)("div",{class:"form-group"},Object(h.h)("small",null,Object(h.h)("input",{class:"form-control",type:"text",name:"currency",onInput:this.saveStoryField,value:r.currency}))),Object(h.h)("label",null,Object(h.h)(f.c,{id:"story.price"},"Price")),Object(h.h)("div",{class:"form-group"},Object(h.h)("small",null,Object(h.h)("input",{class:"form-control",type:"text",name:"price",onInput:this.saveStoryField,value:r.price})))))),Object(h.h)("div",{class:"row"},Object(h.h)("div",{class:"col-12 mt-2"},Object(h.h)("button",{type:"button",class:"btn btn-block btn-"+(n?"primary":"secondary")+" mb-2",disabled:!n,onClick:this.saveStory,"data-id":r.id},Object(h.h)("i",{class:"fas fa-paper-plane"})," ",Object(h.h)(f.c,{id:"story.edit-save"},"Save changes"))))))},s}(h.Component))||r,A=Object(b.a)(l=function(e){function s(t){var s;return(s=e.call(this,t)||this).viewImage=function(t){var e=t.target.closest("img").dataset,o=s.state.viewImageIdx;o[e.id]=e.idx,s.setState({viewImageIdx:o})},s.showStoryDetail=function(t){if("a"===t.target.localName)return!1;var e=t.target.closest("#storyDetail").dataset.id;e&&Object(v.route)("/stories/"+e)},s.translate=function(t){return new Promise((function(e,o){var a;return t.preventDefault(),t.stopPropagation(),a=s.props.stores,Promise.resolve(a.storyStore.translate({story:s.props.story,user:a.userStore.user})).then((function(t){try{return s.setState({showOriginal:0,translatedText:t}),e()}catch(t){return o(t)}}),o)}))},s.showOriginal=function(t){t.preventDefault(),t.stopPropagation(),s.setState({showOriginal:1})},s.setSelectedImage=function(t){s.setState({selectedImageIdx:t})},s.state={viewImageIdx:{}},s}return i(s,e),s.prototype.render=function(){var e=this,s=this.state,o=s.showOriginal,a=s.translatedText,n=s.selectedImageIdx,i=void 0===n?0:n,r=this.props.stores,l=this.props,c=l.story,d=l.likeStory,u=l.likeRef,m=r.userStore.user.language,b=void 0===m?"en":m,O=[];if(c.images){var j=Object(p.i)(c.images);O.push.apply(O,j)}var v=T.a.getTranslation({object:c,targetLang:b,field:"body"})||a,y=v||c.body;o&&(y=c.body);var w=T.a.getInlineComponents(y||""),S=w.components,C=void 0===S?[]:S,I=w.finalBody,D=void 0===I?"":I;return Object(h.h)(t,null,Object(h.h)("div",{class:"container-fluid px-0 mt-1"},Object(h.h)("div",{class:"row"},Object(h.h)(x.a,{stores:this.props.stores,images:O,id:c.id,dblClick:d,likeRef:u,callback:this.setSelectedImage}))),Object(h.h)("div",{class:"row mt-2"},Object(h.h)("div",{class:"clearfix col-12 overflow-hidden",style:c.offline?"text-decoration: line-through;":""},Object(h.h)("div",{id:"storyDetail",onClick:this.showStoryDetail,"data-id":c.id},Object(h.h)(g.a,{markdown:T.a.replaceImages(D,c.images,b),markdownOpts:T.a.getMarkdownOptions()}),c.language!==b&&Object(h.h)(t,null,!o&&v?Object(h.h)(t,null,Object(h.h)("button",{type:"button",class:"btn btn-sm btn-link text-muted",onClick:this.showOriginal},Object(h.h)("i",{class:"fas fa-cog"}),"  ",Object(h.h)(f.c,{id:"home.translate-show-original"},"Show original"))):Object(h.h)(t,null,Object(h.h)("button",{type:"button",class:"btn btn-sm btn-link text-muted",onClick:this.translate},Object(h.h)("i",{class:"fas fa-cog"})," ",Object(h.h)(f.c,{id:"home.translate-to"},"See translation"))))),C&&C.map((function(t){if("poll"===t.name)return Object(h.h)(k.a,{stores:e.props.stores,story:c,storyId:c.id,params:t.params,opts:t.opts,content:t.content,selectedImageIdx:i})})))))},s}(h.Component))||l,E=Object(b.a)(c=function(e){function s(t){var s;return(s=e.call(this,t)||this).viewImage=function(t){var e=t.target.closest("img").dataset,o=s.state.viewImageIdx;o[e.id]=e.idx,s.setState({viewImageIdx:o})},s.showStoryDetail=function(t){if("a"===t.target.localName)return!1;var e=t.target.closest("#storyDetail").dataset.id;e&&Object(v.route)("/stories/"+e)},s.translate=function(t){return new Promise((function(e,o){var a,n,i,r;return t.preventDefault(),t.stopPropagation(),a=s.props.story,i=(n=s.props.stores).storyStore,r=n.userStore.user,s.setState({showOriginal:0}),Promise.resolve(i.translate({story:a,user:r})).then((function(){try{return e()}catch(t){return o(t)}}),o)}))},s.showOriginal=function(t){t.preventDefault(),t.stopPropagation(),s.setState({showOriginal:1})},s.getTranslation=function(){var t=s.props.stores,e=t.userStore,o=e.user.language;T.a.getTranslation({object:s.props.story,targetLang:void 0===o?"en":o,field:"body"})&&s.setState({showOriginal:0})},s.state={viewImageIdx:{}},s}i(s,e);var o=s.prototype;return o.componentWillMount=function(){this.getTranslation()},o.render=function(){var e=this.state,s=e.showOriginal,o=this.props.stores,a=this.props,n=a.story,i=a.likeStory,r=a.likeRef,l=o.userStore.user.language,c=void 0===l?"en":l,d=[];if(n.images){var u=Object(p.i)(n.images);d.push.apply(d,u)}var b=T.a.getTranslation({object:n,targetLang:c,field:"body"}),O=b||n.body;return s&&(O=n.body),Object(h.h)(t,null,Object(h.h)("div",{class:"container-fluid px-0 mt-1"},Object(h.h)("div",{class:"row"},Object(h.h)(x.a,{stores:this.props.stores,images:d,id:n.id,dblClick:i,likeRef:r}))),Object(h.h)("div",{class:"row mt-2"},Object(h.h)("div",{class:"clearfix col-12 overflow-hidden",style:n.offline?"text-decoration: line-through;":""},Object(h.h)("div",{id:"storyDetail","data-id":n.id},Object(h.h)(g.a,{markdown:T.a.replaceImages(O,n.images,c),markdownOpts:T.a.getMarkdownOptions()}),n.language!==c&&Object(h.h)(t,null,!s&&b?Object(h.h)(t,null,Object(h.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:this.showOriginal},Object(h.h)("i",{class:"fas fa-cog"}),"  ",Object(h.h)(f.c,{id:"home.translate-show-original"},"Show original"))):Object(h.h)(t,null,Object(h.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:this.translate},Object(h.h)("i",{class:"fas fa-cog"})," ",Object(h.h)(f.c,{id:"home.translate-to"},"See translation")))))),!!(n.url||n.code||n.price>0)&&Object(h.h)(t,null,Object(h.h)("div",{class:"clearfix col-12  py-2",style:n.offline?"text-decoration: line-through;":""},Object(h.h)("div",{class:"row"},n.url&&Object(h.h)(t,null,Object(h.h)("div",{class:"col-12 text-left",style:"font-size: 1.0em;"},Object(h.h)("a",{href:T.a.asUrl(n.url),target:"_blank",rel:"noreferrer"},Object(h.h)("i",{class:"fas fa-link mr-2"}),n.urlText?Object(h.h)(t,null,n.urlText):Object(h.h)(t,null,Object(h.h)(f.c,{id:"story.ad-url-readmore"},"Les mer..."))))),n.code&&Object(h.h)(t,null,Object(h.h)("div",{class:"col text-left",style:"font-size: 1.2em;"},Object(h.h)("nobr",null,Object(h.h)("span",{class:"font-weight-lighter"},Object(h.h)(f.c,{id:"story.ad-campaign-code"},"Kampanjekode"),":")," ",n.code))),n.price>0&&Object(h.h)(t,null,Object(h.h)("div",{class:"col text-right",style:"font-size: 1.2em;"},Object(h.h)("nobr",null,n.currencty&&Object(h.h)("span",{class:"font-weight-lighter"},n.currency)," ",m.a.format(n.price,2)))))))))},s}(h.Component))||c,L=Object(b.a)(d=function(e){function s(t){var s;return(s=e.call(this,t)||this).viewImage=function(t){var e=t.target.closest("img").dataset,o=s.state.viewImageIdx;o[e.id]=e.idx,s.setState({viewImageIdx:o})},s.showStoryDetail=function(t){if("a"===t.target.localName)return!1;var e=t.target.closest("#storyDetail").dataset.id;e&&Object(v.route)("/stories/"+e)},s.translate=function(t){return new Promise((function(e,o){var a,n,i,r;return t.preventDefault(),t.stopPropagation(),a=s.props.story,i=(n=s.props.stores).storyStore,r=n.userStore.user,s.setState({showOriginal:0}),Promise.resolve(i.translate({story:a,user:r})).then((function(){try{return e()}catch(t){return o(t)}}),o)}))},s.showOriginal=function(t){t.preventDefault(),t.stopPropagation(),s.setState({showOriginal:1})},s.getTranslation=function(){var t=s.props.stores,e=t.userStore,o=e.user.language;T.a.getTranslation({object:s.props.story,targetLang:void 0===o?"en":o,field:"body"})&&s.setState({showOriginal:0})},s.state={viewImageIdx:{}},s}i(s,e);var o=s.prototype;return o.componentWillMount=function(){this.getTranslation()},o.render=function(){var e=this.state,s=e.showOriginal,o=this.props.stores,a=this.props,n=a.story,i=a.likeStory,r=a.likeRef,l=o.userStore.user.language,c=void 0===l?"en":l,d=[];if(n.images){var u=Object(p.i)(n.images);d.push.apply(d,u)}var m=T.a.getTranslation({object:n,targetLang:c,field:"body"}),b=m||n.body;return s&&(b=n.body),Object(h.h)(t,null,Object(h.h)("div",{class:"container-fluid px-0 mt-1"},Object(h.h)("div",{class:"row"},Object(h.h)(x.a,{stores:this.props.stores,images:d,id:n.id,dblClick:i,likeRef:r}))),Object(h.h)("div",{class:"row mt-2"},Object(h.h)("div",{class:"clearfix col-12 overflow-hidden",style:n.offline?"text-decoration: line-through;":""},Object(h.h)("div",{id:"storyDetail",onClick:this.showStoryDetail,"data-id":n.id},Object(h.h)(g.a,{markdown:T.a.replaceImages(b,n.images,c),markdownOpts:T.a.getMarkdownOptions()}),n.language!==c&&Object(h.h)(t,null,!s&&m?Object(h.h)(t,null,Object(h.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:this.showOriginal},Object(h.h)("i",{class:"fas fa-cog"}),"  ",Object(h.h)(f.c,{id:"home.translate-show-original"},"Show original"))):Object(h.h)(t,null,Object(h.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:this.translate},Object(h.h)("i",{class:"fas fa-cog"})," ",Object(h.h)(f.c,{id:"home.translate-to"},"See translation")))))),!!(n.url||n.code||n.price)&&Object(h.h)(t,null,Object(h.h)("div",{class:"clearfix col-12  py-2",style:n.offline?"text-decoration: line-through;":""},Object(h.h)("div",{class:"row"},n.url&&Object(h.h)(t,null,Object(h.h)("div",{class:"col-12 text-left",style:"font-size: 1.0em;"},Object(h.h)("a",{href:T.a.asUrl(n.url),target:"_blank",rel:"noreferrer"},Object(h.h)("i",{class:"fas fa-link mr-2"}),n.urlText?Object(h.h)(t,null,n.urlText):Object(h.h)(t,null,Object(h.h)(f.c,{id:"story.ad-url-readmore"},"Les mer..."))))))))))},s}(h.Component))||d,F=Object(b.a)(u=function(e){function s(t){var s;return(s=e.call(this,t)||this).toggleDate=function(t){t.stopPropagation(),t.preventDefault(),s.setState({showDate:!s.state.showDate})},s.likeStory=function(){return new Promise((function(t,e){var o,a,n,i;return a=s.props.stores.storyStore,(n=s.state.likeStory)[o=s.props.story.id]=!0,i=Object.keys(n),s.setState({likeStory:n,likeIds:i}),setTimeout((function(){var t=s.state.likeStory;delete t[o];var e=Object.keys(t);s.setState({likeStory:t,likeIds:e})}),1200),Promise.resolve(a.likeStory({id:o})).then((function(s){try{return s,t()}catch(t){return e(t)}}),e)}))},s.toggleAddComment=function(t){var e=t.target.closest("button").dataset.id,o=s.state.showAddComment;o[e]?delete o[e]:o[e]=!0,s.setState({showAddComment:o},(function(){s.inputRef[e]&&s.inputRef[e].focus()}))},s.closeAllAddComments=function(){s.setState({showAddComment:{}})},s.toggleShowTeamSetting=function(t){var e=t.target.closest("button").dataset.id,o=s.state.showTeamSetting;o[e]?delete o[e]:o[e]=!0,s.setState({showTeamSetting:o})},s.viewImage=function(t){var e=t.target.closest("img").dataset,o=s.state.viewImageIdx;o[e.id]=e.idx,s.setState({viewImageIdx:o})},s.toggleMenu=function(t){var e=t.target.closest("i").dataset.id,o=s.state.showMenu,a=void 0===o?{}:o;a[e]=!a[e],s.setState({showDeleteStory:{},showEdit:{},showMenu:a})},s.toggleEdit=function(t){var e=t.target.closest("button").dataset.id,o=s.state.showEdit,a=void 0===o?{}:o;a[e]=!a[e],s.setState({showDeleteStory:{},showEdit:a,showMenu:{}})},s.toggleDeleteStory=function(t){var e=t.target.closest("button").dataset.id,o=s.state.showDeleteStory,a=void 0===o?{}:o;a[e]=!a[e],s.setState({showDeleteStory:a,showEdit:{},showMenu:{}})},s.reportStory=function(t){return new Promise((function(e,o){var a;return a=t.target.closest("button").dataset.id,Promise.resolve(s.props.stores.storyStore.reportStory({id:a})).then((function(){try{return s.setState({showEdit:{},showMenu:{}}),e()}catch(t){return o(t)}}),o)}))},s.adminRemoveStory=function(t){return new Promise((function(e,o){var a;return a=t.target.closest("button").dataset.id,Promise.resolve(s.props.stores.storyStore.adminHideStory({id:a})).then((function(){try{return s.setState({showEdit:{},showMenu:{}}),e()}catch(t){return o(t)}}),o)}))},s.deleteStory=function(t){return new Promise((function(e,o){var a,n;return a=t.target.closest("button").dataset.id,n=s.props.stores.storyStore,Promise.resolve(n.saveField(parseInt(a,10),"offline",1,!0)).then((function(){try{return n.publicFeedUpdate(parseInt(a,10),"offline",1),s.setState({storyBody:"",showDeleteStory:{},showEdit:{},showMenu:{}}),e()}catch(t){return o(t)}}),o)}))},s.doneEdit=function(){s.setState({showDeleteStory:{},showEdit:{},showMenu:{}})},s.showStoryDetail=function(t){if("a"===t.target.localName)return!1;var e=t.target.closest("#storyDetail").dataset.id;e&&Object(v.route)("/stories/"+e)},s.shareLink=function(t){var e=t.target.closest("button").dataset;s.props.stores.appState.shareUrl({url:e.url,title:e.title,text:e.text})},s.displayTeam=function(t,e){t.preventDefault(),t.stopPropagation(),s.props.stores.appState.openDrawer("publicTeam",{teamId:e,height:"80vh"})},s.openInbox=function(t,e){t.preventDefault(),t.stopPropagation(),s.props.stores.appState.openDrawer("inboxDetail",{fromuser:e,height:"80vh"})},s.state=a({},P),s.inputRef={},s}i(s,e);var o=s.prototype;return o.loadStoriesPublicFeed=function(t){return new Promise(function(e,s){return void 0===t&&(t=this.props),Promise.resolve(t.stores.storyStore.loadPublicFeed({hashtag:t.hashtag})).then((function(){try{return e()}catch(t){return s(t)}}),s)}.bind(this))},o.render=function(){var e,s,o,a,n=this,i=this.state,r=i.showAddComment,l=i.showDate,c=i.showMenu,d=void 0===c?{}:c,u=i.showEdit,b=void 0===u?{}:u,p=i.showDeleteStory,O=void 0===p?{}:p,g=i.showTeamSetting,j=i.likeStory,v=i.likeIds,k=this.props,x=k.story,D=k.showAllComments,P=k.onTeamClick,F=void 0===P?function(){}:P,M=k.onUserClick,z=void 0===M?function(){}:M,U=this.props.stores,B=U.userStore,N=U.storyStore,_=U.appState,W=B.user,K=void 0===W?{}:W,V=B.isAdmin,q=_.hasShareApi,Y=N.findPublicTeam(x.team)||{},Z=N.findPublicUser(x.user)||{},Q=T.a.getImage({user:Z,team:Y,priority:"user",object:x}),G=!(!Y||!Y.members)&&Y.members.some((function(t){return t===K.id}));Y&&Y.name?(e=T.a.displayNameShort(Y),s=T.a.displayName(Y),o=T.a.displayName(Z),Z.settings&&K.uuidv4!==Z.uuidv4&&(a=Z.settings.hideProfile?null:"/inbox/"+Z.uuidv4)):Z&&Z.id&&(e=T.a.displayNameShort(Z),s=T.a.displayName(Z));var H=x.likes,J=x.comments,X=x.reports,$=void 0===X?[]:X,tt=x.likes&&x.likes.findIndex((function(t){return t.user===K.id}))>-1,et=Y.followers?Y.followers.length:0,st=Y.members&&Y.members.indexOf(K.id)>-1,ot=Y.followers&&Y.followers.indexOf(K.id)>-1,at=Y.followRequests&&Y.followRequests.findIndex((function(t){return t.id===K.id}))>-1,nt=x.currentLocationGeocode,it=void 0===nt?{}:nt,rt=T.a.getViews(x.statistics),lt=T.a.getAdminData(x.statistics);return Object(h.h)(t,null,V||K.id===Z.id?Object(h.h)(t,null,Object(h.h)("span",{class:"float-right font-weight-lighter text-muted"},Object(h.h)("i",{class:"fas fa-ellipsis-h",onClick:this.toggleMenu,"data-id":x.id}))):Object(h.h)(t,null,!st&&!ot&&!at&&Y.public>0&&Object(h.h)("span",{class:"float-right"},Object(h.h)(I.a,{stores:this.props.stores,team:Y,buttonOnly:!0,simple:!0,classNames:"btn btn-link text-primary"}))),d[x.id]&&Object(h.h)(t,null,Object(h.h)("div",{class:"position-absolute bg-light p-2 border rounded rounded-lg shadow-sm",style:"top: 30px; right: 10px; width: 60%; z-index: 999999;"},K.id===Z.id?Object(h.h)(t,null,Object(h.h)("button",{class:"btn btn-link btn-block text-left",onClick:this.toggleEdit,"data-id":x.id},Object(h.h)("i",{class:"fas fa-edit"})," Edit"),Object(h.h)("hr",null),Object(h.h)("button",{class:"btn btn-link btn-block text-left text-danger",onClick:this.toggleDeleteStory,"data-id":x.id},Object(h.h)("i",{class:"fas fa-trash-alt"})," Delete")):Object(h.h)(t,null,Object(h.h)("button",{class:"btn btn-link btn-block text-left",onClick:this.reportStory,"data-id":x.id},Object(h.h)("i",{class:"fas fa-flag"})," Report"),V&&Object(h.h)(t,null,Object(h.h)("hr",null),Object(h.h)("button",{class:"btn btn-link btn-block text-left text-danger",onClick:this.adminRemoveStory,"data-id":x.id},Object(h.h)("i",{class:"fas fa-eraser"})," Remove from feed"))))),Object(h.h)("div",{class:"d-flex position-relative"},Object(h.h)("div",{class:"position-relative text-center border rounded-circle imageRounded imageRoundedMedium",style:Q?'background-image: url("'+Q+'"); background-size: cover;':""},!Q&&Object(h.h)("div",{class:"text-muted",style:"font-size: 20px; padding-top: 3px;"},e)),Object(h.h)("div",{class:"flex-grow-1 pl-3 text-overflow",style:"line-height: 1.2em;"},Object(h.h)("h5",{class:"mb-1 position-relative",style:"line-height: 1.0em; "+(x.offline?"text-decoration: line-through;":"")},Y.public?Object(h.h)(t,null,Object(h.h)("a",{href:"/teams/public/"+Y.uuidv4,onClick:function(t){return n.displayTeam(t,Y.uuidv4)},class:"stretched-link"},s)):Object(h.h)(t,null,s),st&&!Y.public&&Object(h.h)("button",{type:"button",class:"btn btn-sm btn-link text-muted","data-id":x.id,onClick:this.toggleShowTeamSetting},Object(h.h)("i",{class:"fas fa-exclamation-triangle"}))),Object(h.h)("div",{class:"mb-2",style:x.offline?"text-decoration: line-through;":""},x.pinned&&Object(h.h)(t,null,Object(h.h)("small",{class:"text-muted mr-2"},Object(h.h)("i",{class:"fas fa-thumbtack"}))),2===x.type?Object(h.h)(t,null,Object(h.h)("small",{class:"text-muted"},Object(h.h)(f.c,{id:"story.sponsored"},"Sponsored")," -")):Object(h.h)(t,null,x.date&&Object(h.h)("small",{class:"text-muted",onClick:this.toggleDate},l?m.a.formatDate(x.date,{locale:"no-NB",hour12:!1,hour:"2-digit",minute:"2-digit"}):m.a.formatDistance(x.date,new Date,{locale:"no-NB"}))),1===x.public?Object(h.h)(t,null,Object(h.h)("small",{class:"ml-2 text-muted"},Object(h.h)("i",{class:"fas fa-globe-europe"}))):Object(h.h)(t,null,Object(h.h)("small",{class:"ml-2 text-muted"},Object(h.h)("i",{class:"fas fa-users"})," (",m.a.format(et),")")),o&&Object(h.h)(t,null,Object(h.h)("small",{class:"ml-2 text-muted"},a?Object(h.h)(t,null,Object(h.h)("i",{class:"fas fa-user"})," ",Object(h.h)("a",{href:a,onClick:function(t){return n.openInbox(t,Z.uuidv4)}},o)):Object(h.h)(t,null,Object(h.h)("i",{class:"fas fa-user"})," ",o))),it&&it.formattedCounty&&Object(h.h)(t,null,Object(h.h)("small",{class:"ml-2 text-muted"},Object(h.h)("i",{class:"fas fa-map-marker-alt"})," ",it.formattedCounty))),V&&Object(h.h)("div",{class:"d-flex flex-row flex-nowrap bg-light border-top border-bottom py-2",style:"overflow: auto;"},Object(h.h)("small",{class:"text-muted mr-2"},"Adm:"),$&&$.length>0&&Object(h.h)(t,null,Object(h.h)("small",{class:"text-danger mr-2"},Object(h.h)("i",{class:"fas fa-flag"})," ",$.length)),it&&it.formatted_address&&Object(h.h)(t,null,Object(h.h)("small",{class:"text-muted"},Object(h.h)("i",{class:"fas fa-map-marker-alt"})," ",it.formatted_address)),Z.deviceInfo&&Object(h.h)(t,null,Object(h.h)("span",{class:"badge badge-secondary ml-2 float-right font-weight-light"},["platform","manufacturer","model"].map((function(e){return Object(h.h)(t,null,Object(h.h)("span",{class:"ml-2 text-white"},Z.deviceInfo[e]))})))),lt&&Object(h.h)(t,null,Object(h.h)("small",{class:"ml-2 text-muted"},"V: ",lt.count),Object(h.h)("small",{class:"ml-2 text-muted"},"R: ",lt.ranking," ",m.a.isNumber(lt.rankingTrend)&&Object(h.h)(t,null,Object(h.h)("i",{class:T.a.getClassForTrend(lt.rankingTrend)}))),Object(h.h)("small",{class:"ml-2 text-muted"},"D: ",m.a.format(lt.durationAvg/1e3,1),"s ",m.a.isNumber(lt.durationAvgTrend)&&Object(h.h)(t,null,Object(h.h)("i",{class:T.a.getClassForTrend(lt.durationAvgTrend)}))),x.statisticsCurrent&&x.statisticsCurrent.totalInteractions>0&&Object(h.h)("small",{class:"ml-2 text-muted"},"S: ",m.a.format(x.statisticsCurrent.totalInteractions,0)),x.shadowTags&&x.shadowTags.map((function(e){return Object(h.h)(t,null,Object(h.h)("span",{class:"badge badge-secondary ml-2 float-right font-weight-light"},e))})))))),b[x.id]||O[x.id]?Object(h.h)(t,null,Object(h.h)("div",{class:"row mt-2"},Object(h.h)("div",{class:"clearfix col-12",style:x.offline?"text-decoration: line-through;":""},b[x.id]&&Object(h.h)(t,null,Object(h.h)(R,{stores:this.props.stores,story:x,key:"story-edit-"+x.id,callback:this.doneEdit})),O[x.id]&&Object(h.h)("div",{class:"clearfix mt-3 mb-3"},Object(h.h)("button",{class:"btn btn-danger float-left",onClick:this.deleteStory,"data-id":x.id},Object(h.h)("i",{class:"fas fa-trash-alt"})," Delete"),Object(h.h)("button",{class:"btn btn-secondary float-right",onClick:this.toggleDeleteStory,"data-id":x.id},Object(h.h)("i",{class:"fas fa-times-circle"})," Cancel"))))):Object(h.h)(t,null,(!x.type||1==x.type)&&Object(h.h)(A,{stores:this.props.stores,story:x,key:"story-regular-view-"+x.id,likeStory:this.likeStory,likeRef:j,keys:v}),2==x.type&&Object(h.h)(E,{stores:this.props.stores,story:x,key:"story-ad-view-"+x.id,likeStory:this.likeStory,likeRef:j,keys:v}),3==x.type&&Object(h.h)(L,{stores:this.props.stores,story:x,key:"story-article-view-"+x.id,likeStory:this.likeStory,likeRef:j,keys:v}),Object(h.h)("div",{class:"d-flex justify-content-between mt-2"},Object(h.h)("div",{class:"mr-2"},Object(h.h)(S.a,{stores:this.props.stores,likes:H,comments:J,type:"story",onTeamClick:F,onUserClick:z})),rt>0&&Object(h.h)(t,null,Object(h.h)("div",null,Object(h.h)(C.a,{stores:this.props.stores,views:rt,object:x,type:"story",isTeamAdmin:G,isAdmin:V,onTeamClick:F,onUserClick:z})))),g[x.id]&&Object(h.h)(t,null,Object(h.h)("small",null,Object(h.h)("div",{class:"alert alert-info",role:"alert"},Object(h.h)("span",{class:"display-4 float-left"},Object(h.h)("i",{class:"fas fa-exclamation-triangle mr-3 mb-3"})),Object(h.h)("p",null,Object(h.h)(f.c,{id:"story.alert-text-1"},"Your team is not visible and it's not possible to request friendship with your team.")),Object(h.h)("p",null,Object(h.h)(f.c,{id:"story.alert-text-2"},"If you want to make your team visible so other can request to follow your team, you can find the setting here:")),Object(h.h)("p",null,Object(h.h)("a",{href:"/teams/edit/"+Y.id},Object(h.h)(f.c,{id:"story.alert-text-3"},"Edit team")))))),Object(h.h)("div",null,Object(h.h)("div",{class:"row"},Object(h.h)("div",{class:"col text-center"},Object(h.h)("button",{type:"button",class:"storyImage btn btn-sm btn-outline-"+(tt?"primary":"secondary")+" btn-lg btn-block "+(tt?"text-primary":"")+" text-overflow","data-id":x.id,onClick:this.likeStory},Object(h.h)("i",{class:(tt?"text-primary fas":"far")+" fa-thumbs-up"})," ",tt?Object(h.h)(f.c,{id:"comments.has-liked"},"Liked"):Object(h.h)(f.c,{id:"comments.like"},"Lik"))),Object(h.h)("div",{class:"col text-center"},Object(h.h)("button",{type:"button",class:"btn btn-sm btn-outline-secondary btn-block text-overflow","data-id":x.id,onClick:this.toggleAddComment},Object(h.h)("i",{class:"fas fa-comment"})," ",Object(h.h)(f.c,{id:"comments.comment-add"},"Kommentar"))),q?Object(h.h)(t,null,Object(h.h)("div",{class:"col text-center"},Object(h.h)("button",{class:"btn btn-sm btn-outline-secondary btn-block text-overflow",onClick:this.shareLink,"data-url":"https://themusher.app/share/story/"+x.uuidv4,"data-title":"title: "+x.title},Object(h.h)("i",{class:"fas fa-share"})," ",Object(h.h)(f.c,{id:"story.share"},"Del")))):Object(h.h)(t,null,Object(h.h)("div",{class:"col text-center"},Object(h.h)("a",{class:"btn btn-sm btn-outline-secondary btn-block text-overflow",href:"https://themusher.app/share/story/"+x.uuidv4,target:"_blank",rel:"noreferrer","data-native":!0},Object(h.h)("i",{class:"fas fa-share"})," ",Object(h.h)(f.c,{id:"story.share"},"Del")))))),Object(h.h)("div",{class:"mt-2"},Object(h.h)(y.a,{stores:this.props.stores,story:x,col:"10",offset:"2",compact:!1,showAllComments:D,initCall:this.closeAllAddComments}),r[x.id]&&Object(h.h)(w.a,{stores:this.props.stores,story:x,inputRef:function(t){return n.inputRef[x.id]=t},inputRefObject:this.inputRef,col:"10",offset:"2",key:"story-comment-"+x.id}))))},s}(h.Component))||u;e.a=F}).call(this,s("hosL").Fragment)},P9Fo:function(t,e,s){"use strict";(function(t){var o,a=s("hosL"),n=s("Utv1"),i=s("/eY4"),r=(s("cneo"),s("OhSV")),l=s("fh8t"),c=s.n(l),d=(s("go65"),s("ZOvn")),u=Object(i.a)(o=function(e){function s(t){var s;return(s=e.call(this,t)||this).pollStory=function(t){return new Promise((function(e,o){var a,n,i;return a=s.props.storyId,n=s.props.stores.storyStore,i=t.target.closest("button").dataset.line,Promise.resolve(n.pollStory({id:a,line:i})).then((function(t){try{return t,e()}catch(t){return o(t)}}),o)}))},s.toggleResult=function(){s.setState({viewResult:!s.state.viewResult})},s.state={},s.inputRef={},s}var o,i;return i=e,(o=s).prototype=Object.create(i.prototype),o.prototype.constructor=o,o.__proto__=i,s.prototype.render=function(){var e=this,s=this.state.viewResult,o=this.props,i=o.story,l=o.opts,u=o.selectedImageIdx,h=this.props.stores,m=h.userStore.user,b=m.language,p=void 0===b?"en":b,f=o.content.split("\n").map((function(t){return t.trim().replace(/^\-\s*/g,"")})),O=i.polls&&i.polls.findIndex((function(t){return t.user===m.id}))>-1,g=i.polls?i.polls.length:0,j=0;f.forEach((function(t){var e=100*(i.polls?i.polls.filter((function(e){return e.line===d.a.md5(t)})).length/g:0);e>j&&(j=e)}));var v=l.days?parseInt(l.days,10):7,y=n.a.addDays(i.date,v),w=y<new Date,k=new RegExp(/{{img\./i);return Object(a.h)(t,null,Object(a.h)("div",{class:"w-100 my-4 storyPoll"},w||O||s?Object(a.h)(t,null,f&&f.map((function(e){var s=i.polls&&i.polls.findIndex((function(t){return t.user===m.id&&t.line===d.a.md5(e)}))>-1,o=(i.polls?i.polls.filter((function(t){return t.line===d.a.md5(e)})).length:0)/g*100;return Object(a.h)(t,null,Object(a.h)("div",{class:"progress position-relative my-2 ",style:"height: 1.5em; font-size: 1.3em;"},Object(a.h)("span",{class:"position-absolute",style:"right: 10px;"}," ",n.a.format(o||0,1),"%"),Object(a.h)("span",{class:"position-absolute",style:"left: 10px;"},Object(a.h)(c.a,{markdown:d.a.replaceImages(e+" "+(s?"<i class='fas fa-check-circle' />":""),i.images,p,!1),markdownOpts:d.a.getMarkdownOptions()})),Object(a.h)("div",{class:"progress-bar "+(j===o?"bg-primary":"bg-secondary"),role:"progressbar",style:"width: "+o+"%;","aria-valuenow":o,"aria-valuemin":"0","aria-valuemax":"100"})))})),Object(a.h)("div",{class:"w-100 mt-3 text-muted d-flex justify-content-start"},Object(a.h)("div",null,Object(a.h)("small",null,n.a.format(g,0)," ",1===g?Object(a.h)(r.c,{id:"story.poll"},"vote"):Object(a.h)(r.c,{id:"story.polls"},"votes"))),w?Object(a.h)(t,null,Object(a.h)("div",{class:"ml-2"},Object(a.h)("small",null,"- ",Object(a.h)(r.c,{id:"story.finished"},"Finished")))):Object(a.h)(t,null,Object(a.h)("div",{class:"ml-2"},Object(a.h)("small",null,"- ",n.a.formatDistance(y,new Date,{},{extended:!0})," ",Object(a.h)(r.c,{id:"story.left"},"left"))),!O&&Object(a.h)("div",{class:"ml-2",onClick:this.toggleResult},Object(a.h)("small",null,"- ",Object(a.h)(r.c,{id:"story.view-vote"},"View vote")))))):Object(a.h)(t,null,f&&f.map((function(s,o){return Object(a.h)(t,null,Object(a.h)("button",{class:"btn btn-block "+(k.test(s)&&o===u?"btn-outline-success":"btn-outline-primary")+" rounded-pill",onClick:e.pollStory,"data-line":d.a.md5(s)},k.test(s)&&o===u&&Object(a.h)("span",{class:"float-right"},Object(a.h)("i",{class:"fas fa-eye"})),Object(a.h)(c.a,{markdown:d.a.replaceImages(s,i.images,p,!1),markdownOpts:d.a.getMarkdownOptions()})))})),Object(a.h)("div",{class:"w-100 mt-3 text-muted d-flex justify-content-start"},Object(a.h)("div",null,Object(a.h)("small",null,n.a.format(g,0)," ",1===g?Object(a.h)(r.c,{id:"story.poll"},"vote"):Object(a.h)(r.c,{id:"story.polls"},"votes"))),w?Object(a.h)(t,null,Object(a.h)("div",{class:"ml-2"},Object(a.h)("small",null,"- ",Object(a.h)(r.c,{id:"story.finished"},"Finished")))):Object(a.h)(t,null,Object(a.h)("div",{class:"ml-2"},Object(a.h)("small",null,"- ",n.a.formatDistance(y,new Date,{},{extended:!0})," ",Object(a.h)(r.c,{id:"story.left"},"left")))),Object(a.h)("div",{class:"ml-2",onClick:this.toggleResult},Object(a.h)("small",null,"- ",Object(a.h)(r.c,{id:"story.view-results"},"View results")))))))},s}(a.Component))||o;e.a=u}).call(this,s("hosL").Fragment)}}]);
//# sourceMappingURL=22.chunk.f8b93.js.map