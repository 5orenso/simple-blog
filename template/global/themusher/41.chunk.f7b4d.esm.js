(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{"5l0g":function(e,t,a){"use strict";(function(e){function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var c,l=a("hosL"),n=(a("Utv1"),a("/eY4")),o=(a("OhSV"),a("cneo"),a("HqZR"));a("ZOvn");const r={showAddComment:!1};let h=Object(n.a)(c=class extends l.Component{constructor(e){super(e),this.state=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},r),this.updateTimer={},this.inputRef={}}async loadHeatmap(){this.setState({isLoading:!0});const{adminStore:e}=this.props.stores,{raceid:t}=this.props;await e.getPublicHeatmap(t),this.setState({isLoading:!1})}componentDidMount(){this.loadHeatmap()}render(){const{adminStore:t}=this.props.stores,{waypoints:a,zoomToMarkers:s,mapid:i,fullscreenMap:c}=this.props,{publicHeatmap:n}=t;return Object(l.h)(e,null,Object(l.h)(o.a,{stores:this.props.stores,mapId:n.length,heatmap:n,minZoom:2,maxZoom:18,height:600,waypoints:a,zoomToMarkers:s,fullscreenMap:c,key:"map-"+i}))}})||c;t.a=h}).call(this,a("hosL").Fragment)},"67HY":function(e,t,a){"use strict";(function(e){var s,i=a("hosL"),c=a("Utv1"),l=a("/eY4"),n=a("Y3FI"),o=a("go65"),r=a("OhSV"),h=a("tJLP"),d=a("Cjoz");a("CE5K");let b=Object(l.a)(s=class extends i.Component{constructor(e){var t;super(e),t=this,this.handleEmailInput=async function(e){const{userStore:a}=t.props.stores,s=e.target.value;t.setState({email:s}),clearTimeout(t.checkEmailTimer),t.checkEmailTimer=setTimeout(()=>a.checkEmail(s),1e3)},this.togglePassword=()=>{let{passwordType:e}=this.state;e="password"===e?"text":"password",this.setState({passwordType:e})},this.updateCapsLockStatus=e=>{this.setState({isCapsLock:e})},this.login=async function(){const{routeLoginOk:e="/"}=t.props,{email:a,password:s,token:i}=t.state,{userStore:c,appState:l}=t.props.stores,{language:o="en"}=l;await c.checkLogin({email:a,password:s,token:i,sendPubSubMessage:!1,language:o})&&(await c.getInfo(),Object(n.route)(e))},this.resetLoginMessages=()=>{const{userStore:e}=this.props.stores;e.resetLoginMessages()},this.newUser=()=>{const{email:e=""}=this.state,{routeLoginNew:t="/register/"+e}=this.props;Object(n.route)(t)},this.forgotten=()=>{const{email:e=""}=this.state,{routeLoginForgot:t="/forgotten/"+e}=this.props;Object(n.route)(t)},this.changeLanguage=e=>{const t=e.target.value,{appState:a}=this.props.stores;a.setLanguage(t)},this.validateLoginToken=async function(){const{userStore:e}=t.props.stores,{loginToken:a,routeLoginOk:s="/"}=t.props,i=await e.validateLoginToken(a);i&&200===i.status&&(await e.getInfo(),Object(n.route)(s))},this.state={showToken:!1,isCapsLock:!1,passwordType:"password",email:this.props.email}}componentDidMount(){const{userStore:e}=this.props.stores;this.props.email&&(clearTimeout(this.checkEmailTimer),this.checkEmailTimer=setTimeout(()=>e.checkEmail(this.props.email),1e3));const{loginToken:t}=this.props;c.a.isString(t)&&this.validateLoginToken()}render(){const{isCapsLock:t,email:a,password:s,token:l,passwordType:n}=this.state,{appState:b,userStore:p}=this.props.stores,{language:m="en",darkmode:u}=b,{showLogo:g=!0}=this.props,{emailIsAvailable:O,login:j,twoFactorLogin:f}=p,{message:v,messageIcon:w,error:y,errorIcon:k}=j,x=c.a.validateEmail(a),S=x&&s;return Object(i.h)("div",{class:"container-fluid"},Object(i.h)("div",{class:"row"},Object(i.h)("div",{class:"col-10 offset-1 col-sm-8 offset-sm-2 col-md-6 offset-md-3 col-lg-4 offset-lg-4 pt-5"},Object(i.h)("div",{class:"d-flex justify-content-center"},u?Object(i.h)(e,null,Object(i.h)("img",{src:"https://themusher.app/assets/logo-qpaws-dark.png",height:"100"})):Object(i.h)(e,null,Object(i.h)("img",{src:"https://themusher.app/assets/logo-qpaws-light.png",height:"100"}))),Object(i.h)("div",{class:"d-flex justify-content-center"},Object(i.h)("h5",{class:"mt-1 mb-3"},Object(i.h)(r.c,{id:"login.login"},"Logg inn"))),Object(i.h)(h.a,{message:y,icon:k,remove:this.resetLoginMessages}),Object(i.h)(d.a,{message:v,icon:w,remove:this.resetLoginMessages}),Object(i.h)("div",{class:"form-group"},Object(i.h)("label",{for:"emailInput"},Object(i.h)("i",{class:"far fa-envelope"})," ",Object(i.h)(r.c,{id:"login.email"},"E-post")),Object(i.h)("input",{type:"email",class:"form-control "+(a?x&&!O?"is-valid":"is-invalid":""),id:"emailInput",onInput:this.handleEmailInput,value:a,onKeypress:e=>{c.a.isCapsLock(e,this.updateCapsLockStatus)}}),a&&x&&O&&Object(i.h)("div",{class:"invalid-feedback",style:"display: block;"},Object(i.h)(r.c,{id:"login.email-not-found"},"E-posten finnes ikke, men du kan registrere deg üòÉ")),a&&!x&&Object(i.h)("div",{class:"invalid-feedback",style:"display: block;"},Object(i.h)(r.c,{id:"login.email-not-valid"},"Hmm, e-posten ser ikke helt riktig ut. Kan det v√¶re en skrivefeil?")),a&&x&&!O&&Object(i.h)("div",{class:"valid-feedback",style:"display: block;"},Object(i.h)(r.c,{id:"login.email-looks-good"},"E-post ser bra ut."))),Object(i.h)("div",{class:"form-group"},Object(i.h)("label",{for:"passwordInput"},Object(i.h)("i",{class:"fas fa-key"})," ",Object(i.h)(r.c,{id:"login.password"},"Passord")),Object(i.h)("div",{class:"input-group"},Object(i.h)("input",{type:n,class:"form-control",id:"passwordInput",onInput:Object(o.a)(this,"password"),value:s,onKeypress:e=>{c.a.isCapsLock(e,this.updateCapsLockStatus)}}),Object(i.h)("div",{class:"input-group-append"},Object(i.h)("button",{class:"btn btn-outline-secondary",type:"button",onClick:this.togglePassword},Object(i.h)("i",{class:"fas fa-eye"+("text"===n?"-slash":"")}))))),t&&Object(i.h)("div",{class:"alert alert-danger",role:"alert"},Object(i.h)(r.c,{id:"login.caps-lock-on"},"CAPS LOCK er p√•!")),f&&Object(i.h)("div",{class:"form-group"},Object(i.h)("label",{for:"tokenInput"},Object(i.h)("i",{class:"fas fa-unlock"})," ",Object(i.h)(r.c,{id:"login.2fa-token"},"2FA Token")),Object(i.h)("input",{type:"number",class:"form-control",id:"tokenInput",onInput:Object(o.a)(this,"token"),value:l})),Object(i.h)("button",{class:"btn "+(S?"btn-primary":"btn-outline-primary"),type:"button",onClick:this.login,disabled:!S},Object(i.h)("i",{class:"fas fa-sign-in-alt mr-2"}),Object(i.h)(r.c,{id:"login.login"},"Logg inn")),Object(i.h)("button",{class:"btn btn-outline-secondary float-right",type:"button",onClick:this.newUser},Object(i.h)("i",{class:"fas fa-plus mr-2"}),Object(i.h)(r.c,{id:"login.new-user"},"Ny bruker")),Object(i.h)("small",{class:"form-text text-muted mt-5 text-center"},Object(i.h)("button",{class:"btn btn-small btn-link",onClick:this.forgotten},Object(i.h)(r.c,{id:"login.forgot-password"},"Glemt passordet?"))))))}})||s;t.a=b}).call(this,a("hosL").Fragment)},"8gML":function(e,t,a){"use strict";(function(e){function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var c,l=a("hosL"),n=a("Utv1"),o=a("/eY4"),r=a("OhSV"),h=(a("go65"),a("RMlE"),a("5l0g"),a("ZOvn"));h.a.marginTop(!0),h.a.marginBottom(),h.a.subMenuMarginTop();const d={isLoading:!1,email:"",submenu:"ads",jwtToken:n.a.getJwtToken()};let b=Object(o.a)(c=class extends l.Component{constructor(e){super(e),this.state=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},d)}render(){const{appState:t}=this.props.stores,{raceid:a,path:s}=this.props,{darkmode:i}=t;let c="default";return s.match(/\/race\/:raceid$/)?c="default":s.match(/\/race\/:raceid\/mushers$/)?c="mushers":s.match(/\/race\/:raceid\/results$/)?c="results":s.match(/\/race\/:raceid\/media$/)?c="media":s.match(/\/race\/:raceid\/tracking$/)&&(c="tracking"),Object(l.h)(e,null,Object(l.h)("div",{class:"row fixed-top pr-3",style:`margin-top: 40px; background-color: ${i?"#191d21":"#f8f9fa"};`},Object(l.h)("div",{class:"col-12 my-2 mx-2"},Object(l.h)("ul",{class:"nav nav-pills nav-fill flex-nowrap"},Object(l.h)("li",{class:"nav-item",style:"max-width: 20%;"},Object(l.h)("a",{href:"/race/"+a,class:"text-overflow nav-link "+("default"===c?"active":"")},Object(l.h)("nobr",null,Object(l.h)("i",{class:"fas fa-info-circle"})," ",Object(l.h)(r.c,{id:"race.therace"},"L√∏pet")))),Object(l.h)("li",{class:"nav-item",style:"max-width: 20%;"},Object(l.h)("a",{href:`/race/${a}/mushers`,class:"text-overflow nav-link "+("mushers"===c?"active":"")},Object(l.h)("nobr",null,Object(l.h)("i",{class:"fas fa-users"})," ",Object(l.h)(r.c,{id:"race.mushers"},"Deltakere")))),Object(l.h)("li",{class:"nav-item",style:"max-width: 20%;"},Object(l.h)("a",{href:`/race/${a}/results`,class:"text-overflow nav-link "+("results"===c?"active":"")},Object(l.h)("nobr",null,Object(l.h)("i",{class:"fas fa-poll"})," ",Object(l.h)(r.c,{id:"race.results"},"Resultater")))),Object(l.h)("li",{class:"nav-item",style:"max-width: 20%;"},Object(l.h)("a",{href:`/race/${a}/media`,class:"text-overflow nav-link "+("media"===c?"active":"")},Object(l.h)("nobr",null,Object(l.h)("i",{class:"fas fa-images"})," ",Object(l.h)(r.c,{id:"race.media"},"Bilder")))),Object(l.h)("li",{class:"nav-item",style:"max-width: 20%;"},Object(l.h)("a",{href:`/race/${a}/tracking`,class:"text-overflow nav-link "+("tracking"===c?"active":"")},Object(l.h)("nobr",null,Object(l.h)("i",{class:"fas fa-map-marked-alt"})," ",Object(l.h)(r.c,{id:"race.tracking"},"Tracking"))))))))}})||c;t.a=b}).call(this,a("hosL").Fragment)},"9lZG":function(e,t,a){"use strict";(function(e){var s,i=a("hosL"),c=a("Utv1"),l=a("/eY4"),n=a("OhSV"),o=a("go65"),r=a("om2D"),h=a("ZOvn");let d=Object(l.a)(s=class extends i.Component{constructor(e){var t;super(e),t=this,this.beforeImagesUploaded=()=>{this.setState({sendButtonEnabled:!1})},this.afterImagesUploaded=()=>{this.setState({sendButtonEnabled:!0})},this.commentRace=async function(){const{sendButtonEnabled:e}=t.state;if(!e)return!1;const{callback:a=(()=>{}),inputRefObject:s={}}=t.props,{race:i}=t.props,{raceStore:c}=t.props.stores,{comment:l,showAddImage:n}=t.state;t.setState({sendButtonEnabled:!1});const o=await c.commentRace({id:i.id,comment:l});o&&200===o.status&&(t.setState({comment:{body:"",images:[]}},()=>{h.a.resizeTextarea(s[i.id]),n&&t.addImage()}),a({race:i,response:o})),t.setState({sendButtonEnabled:!0})},this.addImages=({value:e})=>{const{comment:t}=this.state;t.images.push(...e),this.setState({comment:t})},this.addImage=()=>{const{showAddImage:e=!1}=this.state;this.setState({showAddImage:!e})},this.handleImageErrored=e=>{const t=e.target;t.onerror=null,setTimeout(()=>{t.src+="?"+new Date},1e3)},this.state={comment:{body:"",images:[]},showAddImage:!1,sendButtonEnabled:!0},this.inputRef={}}render(){const{inputRef:t,race:a}=this.props,{comment:s,showAddImage:l,sendButtonEnabled:d}=this.state,{userStore:b}=this.props.stores,{user:p={}}=b,m=h.a.displayNameShort(p),u=(h.a.displayName(p),p.image||(p.images?p.images[0]:void 0));return Object(i.h)(e,null,Object(i.h)("div",null,Object(i.h)("div",{class:"d-flex mb-0 position-relative w-100"},Object(i.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall",style:(u?`background-image: url('${u.s3SmallLink}'); background-size: cover;`:"")+" border-width: 3px !important;"},!u&&Object(i.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},m)),Object(i.h)("div",{class:"col pl-3",style:"line-height: 1.2em;"},Object(i.h)("div",{class:"d-flex bd-highlight"},Object(i.h)("div",{class:"p-0 w-100 bd-highlight"},Object(i.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(i.h)(n.c,{id:"comments.comment"},"Kommentar")),Object(i.h)("div",{class:"border rounded rounded-lg position-relative"},Object(i.h)(n.b,null,Object(i.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(i.h)(n.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(o.a)(this,"comment.body"),onKeyUp:h.a.resizeTextarea,onFocus:h.a.resizeTextarea,style:"height: 2.3em;",value:s.body,ref:t})),Object(i.h)("div",{class:"position-absolute",style:"top: 8px; right: 10px; font-size: 1.2em;"},Object(i.h)("i",{class:"fas fa-image pointerCursor","data-id":a.id,onClick:this.addImage})))),Object(i.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(i.h)("button",{type:"button",class:`btn btn-${d?"primary":"secondary"} mb-2`,disabled:!d,onClick:this.commentRace},Object(i.h)("i",{class:"fas fa-paper-plane"})))))),l&&Object(i.h)(e,null,Object(i.h)("div",{class:"col-12 text-center"},Object(i.h)("div",{class:"container-fluid"},Object(i.h)("div",{class:"row"},c.a.isArray(s.images)&&s.images.map(e=>Object(i.h)("div",{class:"col-3 p-1"},Object(i.h)("img",{src:e.s3SmallLink,class:"img-fluid",onError:this.handleImageErrored}),Object(i.h)("button",{class:"btn btn-sm btn-link",onClick:this.removeImage,"data-name":e.name},Object(i.h)("i",{class:"fas fa-trash"})," ",Object(i.h)(n.c,{id:"comments.remove-image"},"Remove")))))),Object(i.h)(r.a,{object:s,updateField:this.addImages,before:this.beforeImagesUploaded,after:this.afterImagesUploaded,autoOpen:!0})))))}})||s;t.a=d}).call(this,a("hosL").Fragment)},LMwI:function(e){e.exports={pointerCursor:"pointerCursor__1W6mM"}},RMlE:function(e,t,a){"use strict";function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var c,l=a("hosL"),n=a("ox/y"),o=(a("Utv1"),a("/eY4")),r=(a("go65"),a("Y3FI")),h=a("OhSV");a("LMwI");const d={menu:{profile:!1,main:!1},searchText:""};let b=Object(o.a)(c=class extends l.Component{constructor(e){var t;super(e),t=this,this.toggleDropdown=e=>{const{menu:t}=this.state;let a=e.target.dataset.name;!a&&e.target.parentNode&&(a=e.target.parentNode.dataset.name),a&&(t[a]=!t[a]),this.setState({menu:t})},this.toggleDarkmode=e=>{const{appState:t}=this.props.stores;t.toggleDarkmode(),this.toggleDropdown(e)},this.toggleViewmode=e=>{const{appState:t}=this.props.stores;let a=e.target.dataset.mode;!a&&e.target.parentNode&&(a=e.target.parentNode.dataset.mode),t.toggleViewmode(a),this.toggleDropdown(e)},this.reloadApp=()=>{window.location.reload(!0)},this.adminLoadAll=async function(){const{userStore:e}=t.props.stores;await e.getInfo(!0)},this.changeLanguage=e=>{const t=e.target.value;console.log("changeLanguage",t);const{appState:a,userStore:s}=this.props.stores,{user:i={}}=s;i.email&&s.setLanguage({email:i.email,language:t}),a.setLanguage(t)},this.search=()=>{const{searchText:e}=this.state;Object(r.route)("/search/"+e)},this.state=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},d)}render(){const{menu:e}=this.state,{appState:t,userStore:a}=this.props.stores,{darkmode:s}=t,{user:i,notifications:c=[]}=a,{language:o="en"}=(c.filter(e=>!e.read),i);return Object(l.h)("nav",{class:"navbar navbar-expand-lg navbar-themed fixed-top py-1",style:"z-index: 99999;"},Object(l.h)("a",{class:"navbar-brand",href:"/race/"},Object(l.h)("img",{src:`./assets/homerun-race-logo-2-${s?"white-":""}small.png`,height:"37",class:"position-absolute",style:"top: 5px; left: 6px"}),Object(l.h)("span",{class:"font-weight-normal",style:"margin-left: 30px; font-size: 20px;"},"Homerun Race")),Object(l.h)("button",{class:"navbar-toggler",type:"button","data-name":"main",onClick:this.toggleDropdown},Object(l.h)("span",{class:"navbar-toggler-icon"})),Object(l.h)("div",{class:"collapse navbar-collapse "+(e.main?"show":""),id:"navbarSupportedContent"},Object(l.h)("ul",{class:"navbar-nav mr-auto ml-5"},Object(l.h)("li",{class:"nav-item"},Object(l.h)(n.Link,{className:"nav-link",activeClassName:"active",href:"/race","data-name":"main",style:"font-size: 1.0em !important;",onClick:this.toggleDropdown},Object(l.h)("i",{class:"fas fa-flag-checkered"})," ",Object(l.h)(h.c,{id:"header.races"},"L√∏pene"))),Object(l.h)("li",{class:"nav-item"},Object(l.h)(n.Link,{className:"nav-link",activeClassName:"active",href:"/race/support","data-name":"main",style:"font-size: 1.0em !important;",onClick:this.toggleDropdown},Object(l.h)("i",{class:"far fa-question-circle"})," ",Object(l.h)(h.c,{id:"header.support"},"Support"))),Object(l.h)("li",{class:"nav-item"},Object(l.h)(n.Link,{className:"nav-link",activeClassName:"active",href:"/race/news","data-name":"main",style:"font-size: 1.0em !important;",onClick:this.toggleDropdown},Object(l.h)("i",{class:"fas fa-quote-right"})," ",Object(l.h)(h.c,{id:"header.news"},"Nyheter")))),Object(l.h)("ul",{class:"navbar-nav ml-auto "},Object(l.h)("li",{class:"nav-item mr-2"},Object(l.h)("div",{class:"form-row align-items-center"},Object(l.h)("div",{class:"col-auto my-1",style:"width: 80px;"},Object(l.h)("select",{class:"custom-select",style:"background-color: inherit; border: none; padding: 0; height: 1.1em; font-size: 0.9em;",onInput:this.changeLanguage},Object(l.h)("option",{value:"no",selected:"no"===o},"üá≥üá¥ NO"),Object(l.h)("option",{value:"en",selected:"en"===o},"üá¨üáß EN"),Object(l.h)("option",{value:"es",selected:"es"===o},"üá™üá∏ ES"),Object(l.h)("option",{value:"de",selected:"de"===o},"üá©üá™ DE"),Object(l.h)("option",{value:"fr",selected:"fr"===o},"üá´üá∑ FR"),Object(l.h)("option",{value:"ru",selected:"ru"===o},"üá∑üá∫ RU"),Object(l.h)("option",{value:"se",selected:"se"===o},"üá∏üá™ SE"))))),Object(l.h)("li",{class:"nav-item d-block d-lg-none"},Object(l.h)(n.Link,{className:"nav-link",activeClassName:"active","data-name":"main",onClick:this.toggleDarkmode},Object(l.h)("i",{class:(s?"fas text-warning":"far")+" fa-moon"})," ",Object(l.h)(h.c,{id:"header.darkmode"},"Nattmodus"))),Object(l.h)("li",{class:"nav-item mr-2 d-none d-lg-block"},Object(l.h)("button",{class:"btn btn-link","data-name":"profile",onClick:this.toggleDarkmode},Object(l.h)("i",{class:(s?"fas text-warning":"far")+" fa-moon"}))))))}})||c;t.a=b},UUHd:function(e,t,a){"use strict";var s,i=a("hosL"),c=(a("Utv1"),a("/eY4")),l=a("OhSV"),n=a("go65"),o=a("ZOvn");let r=Object(c.a)(s=class extends i.Component{constructor(...e){var t;super(...e),t=this,this.commentRace=async function(){const{callback:e=(()=>{}),commentId:a}=t.props,{race:s}=t.props,{raceStore:i}=t.props.stores,{comment:c=""}=t.state,l=await i.commentReplyRace({id:s.id,commentId:a,comment:c});l&&200===l.status&&(t.setState({comment:""}),e({race:s,response:l}))}}render(){const{inputRef:e}=this.props,{comment:t}=this.state,{userStore:a}=this.props.stores,{user:s={}}=a,c=o.a.displayNameShort(s),r=(o.a.displayName(s),s.image||(s.images?s.images[0]:void 0));return Object(i.h)("div",{class:"w-100"},Object(i.h)("div",{class:"d-flex mb-0 position-relative w-100"},Object(i.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedThumb",style:(r?`background-image: url('${r.s3SmallLink}'); background-size: cover;`:"")+" border-width: 3px !important;"},!r&&Object(i.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},c)),Object(i.h)("div",{class:"col pl-3",style:"line-height: 1.2em;"},Object(i.h)("div",{class:"d-flex bd-highlight"},Object(i.h)("div",{class:"p-0 w-100 bd-highlight"},Object(i.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(i.h)(l.c,{id:"comments.comment"},"Kommentar")),Object(i.h)(l.b,null,Object(i.h)("textarea",{class:"form-control rounded-lg",type:"text",placeholder:Object(i.h)(l.c,{id:"comments.write-reply"},"Write a reply..."),onInput:Object(n.a)(this,"comment"),onKeyUp:o.a.resizeTextarea,onFocus:o.a.resizeTextarea,style:"height: 2.3em;",value:t,ref:e}))),Object(i.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(i.h)("button",{type:"button",class:"btn btn-sm btn-primary mb-2",onClick:this.commentRace},Object(i.h)("i",{class:"fas fa-paper-plane"})))))))}})||s;t.a=r},Ysxg:function(e,t,a){"use strict";(function(e){function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var c,l=a("hosL"),n=a("Utv1"),o=a("/eY4"),r=a("cneo"),h=a("OhSV"),d=a("fh8t"),b=a.n(d),p=a("go65"),m=a("UUHd"),u=a("ZOvn");const g={showAddComment:{},showAllComments:!1,showAllReplies:{},viewImageIdx:{},likeComment:{},likeReply:{},showOriginal:{}};let O=Object(o.a)(c=class extends l.Component{constructor(e){var t;super(e),t=this,this.addLikeComment=async function(e){const{callback:a=(()=>{})}=t.props,s=e.target.closest(".commentContainer").dataset.id,{race:i}=t.props,{raceStore:c}=t.props.stores,{likeComment:l}=t.state;l[s]=!0,t.setState({likeComment:l}),setTimeout(()=>{const{likeComment:e}=t.state;delete e[s],t.setState({likeComment:e})},1200);const n=await c.likeRaceComment({id:i.id,commentId:s});return n&&200===n.status&&a({type:"likeComment",race:i,commentId:s,response:n}),!0},this.likeReply=async function(e){const{callback:a=(()=>{})}=t.props,s=e.target.closest(".replyContainer").dataset.id,i=e.target.closest(".replyContainer").dataset.comment,{race:c}=t.props,{raceStore:l}=t.props.stores,{likeReply:n}=t.state;n[s]=!0,t.setState({likeReply:n}),setTimeout(()=>{const{likeReply:e}=t.state;delete e[s],t.setState({likeReply:e})},1200);const o=await l.likeRaceCommentReply({id:c.id,replyId:s,commentId:i});o&&200===o.status&&a({type:"likeReply",race:c,commentId:i,replyId:s,response:o})},this.replyComment=async function(e){const a=e.target.parentElement.dataset.id||e.target.dataset.id,{showAddComment:s}=t.state;s[a]=!s[a],t.setState({showAddComment:s},()=>{t.inputRef[a]&&t.inputRef[a].focus()})},this.toggleComments=()=>{const{showAllComments:e}=this.state;this.setState({showAllComments:!e})},this.toggleReplies=e=>{const t=e.target.parentElement.dataset.id||e.target.dataset.id,{showAllReplies:a}=this.state;a[t]=!a[t],this.setState({showAllReplies:a})},this.toggleMenu=e=>{const{id:t}=e.target.closest("i").dataset,{showMenu:a={}}=this.state;a[t]=!a[t],this.setState({showDeleteComment:{},showEdit:{},showMenu:a})},this.toggleEdit=e=>{const{id:t,comment:a}=e.target.closest("button").dataset,{showEdit:s={}}=this.state;s[t]=!s[t],this.setState({showDeleteComment:{},showEdit:s,showMenu:{},commentEditText:a})},this.toggleDeleteComment=e=>{const{id:t}=e.target.closest("button").dataset,{showDeleteComment:a={}}=this.state;a[t]=!a[t],this.setState({showDeleteComment:a,showEdit:{},showMenu:{}})},this.deleteComment=async function(e){const{id:a}=e.target.closest("button").dataset,{race:s}=t.props,{raceStore:i}=t.props.stores;await i.deleteCommentRace({id:s.id,commentId:a}),t.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}})},this.deleteCommentReply=async function(e){const{id:a,commentid:s}=e.target.closest("button").dataset,{race:i}=t.props,{raceStore:c}=t.props.stores;await c.deleteCommentReplyRace({id:i.id,commentId:s,replyId:a}),t.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}})},this.saveComment=async function(e){const{id:a}=e.target.closest("button").dataset,{commentEditText:s}=t.state,{race:i}=t.props,{raceStore:c}=t.props.stores;await c.editCommentRace({id:i.id,commentId:a,comment:s}),t.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}})},this.saveCommentReply=async function(e){const{id:a,commentid:s}=e.target.closest("button").dataset,{commentEditText:i}=t.state,{race:c}=t.props,{raceStore:l}=t.props.stores;await l.editCommentReplyRace({id:c.id,commentId:s,replyId:a,comment:i}),t.setState({commentEditText:"",showDeleteComment:{},showEdit:{},showMenu:{}})},this.viewImage=e=>{const{id:t,idx:a}=e.target.closest("img").dataset,{viewImageIdx:s}=this.state;s[t]=a,this.setState({viewImageIdx:s})},this.translate=async function(e){e.preventDefault(),e.stopPropagation();const{replyid:a,commentid:s}=e.target.closest("button").dataset,{race:i}=t.props,{userStore:c,raceStore:l}=t.props.stores,{user:n}=c,{showOriginal:o={},translatedText:r={}}=t.state,h=`${s}${a?"-"+a:""}`;o[h]=0,r[h]=a?await l.translateCommentReply({commentid:s,replyid:a,race:i,user:n}):await l.translateComment({commentid:s,race:i,user:n}),t.setState({showOriginal:o,translatedText:r})},this.showOriginal=e=>{const{replyid:t,commentid:a}=e.target.closest("button").dataset;e.preventDefault(),e.stopPropagation();const{showOriginal:s={}}=this.state;s[`${a}${t?"-"+t:""}`]=1,this.setState({showOriginal:s})},this.state=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},g),this.inputRef={}}render(){const{showAddComment:t,showAllComments:a,showAllReplies:s,viewImageIdx:i,showMenu:c={},showEdit:o={},showDeleteComment:d={},commentEditText:g,likeComment:O,showOriginal:j={},translatedText:f={}}=this.state,{race:v,callback:w=(()=>{}),initCall:y=(()=>{}),col:k=12,offset:x=0,compact:S=!1}=this.props,{userStore:C,raceStore:I}=this.props.stores,{user:D}=C,{language:L="en"}=D;let R=[],E=0,T=0;if(v.comments){if(E=v.comments.length,a)R=v.comments;else{R=v.comments.slice(Math.max(E-(S?0:2),0))}T=R.length}return Object(l.h)("div",{class:`col-${k} offset-${x} col-sm-8 col-lg-6 offset-sm-2 offset-lg-3`},v&&n.a.isArray(R)&&R.reverse().map(a=>{const{user:k={}}=a,x=I.findPublicTeamByMembers(k.id),S=u.a.displayNameShort(k),C=u.a.displayName(k),R=k.image||(k.images?k.images[0]:void 0),E=a.likes&&a.likes.findIndex(e=>e.user===D.id)>-1;let T=[],P=0,A=0;a.comments&&(P=a.comments.length,T=s[a.id]?a.comments:a.comments.slice(0,void 0),A=T.length);const $=[];if(a.images){const e=Object(r.i)(a.images);$.push(...e)}const U=i[a.id]?i[a.id]:0,M=$&&$[U]?$[U]:null,{currentLocationGeocode:F={}}=a,H=I.getCommentTranslations({race:v,commentid:a.id,targetLang:L})||f[a.id];let z=H||a.comment;return j[a.id]&&(z=a.comment),Object(l.h)("div",{class:"row"},Object(l.h)("div",{class:"col-11 offset-1 d-flex mb-2 position-relative"},Object(l.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall",style:(R?`background-image: url("${R.s3SmallLink}"); background-size: cover;`:"")+" border-width: 3px !important;"},!k.image&&Object(l.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},S)),Object(l.h)("div",{class:"flex-grow-1 pl-3 pt-0",style:"line-height: 1.2em;"},Object(l.h)("div",{class:"bg-light p-2 rounded rounded-lg position-relative"},D.id===k.id&&Object(l.h)(e,null,Object(l.h)("span",{class:"float-right font-weight-lighter text-muted"},Object(l.h)("i",{class:"fas fa-ellipsis-h",onClick:this.toggleMenu,"data-id":a.id}))),c[a.id]&&Object(l.h)(e,null,Object(l.h)("div",{class:"position-absolute bg-white p-2 border rounded rounded-lg shadow-sm",style:"top: 30px; right: 10px; width: 60%; z-index: 999999;"},Object(l.h)("button",{class:"btn btn-link btn-block text-left",onClick:this.toggleEdit,"data-id":a.id,"data-comment":a.comment},Object(l.h)("i",{class:"fas fa-edit"})," Edit"),Object(l.h)("hr",null),Object(l.h)("button",{class:"btn btn-link btn-block text-left",onClick:this.toggleDeleteComment,"data-id":a.id},Object(l.h)("i",{class:"fas fa-trash-alt"})," Delete"))),Object(l.h)("div",null,Object(l.h)("span",{style:"font-size: 0.95em;"},Object(l.h)("h5",{class:"font-weight-bold mb-2",style:"font-size: 1.0em;"},k.uuidv4&&k.uuidv4!==D.uuidv4?Object(l.h)(e,null,Object(l.h)("a",{href:"/inbox/"+k.uuidv4},C)):Object(l.h)(e,null,C),x&&x.length>0&&Object(l.h)(e,null,Object(l.h)("span",{class:"font-weight-lighter text-muted ml-1"},x.filter(e=>1===e.public).slice(0,1).map(t=>Object(l.h)(e,null,"- ",Object(l.h)("a",{href:"/teams/public/"+t.uuidv4},t.name)))))),o[a.id]?Object(l.h)(e,null,Object(l.h)("div",{class:"d-flex bd-highlight"},Object(l.h)("div",{class:"p-0 w-100 bd-highlight"},Object(l.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(l.h)(h.c,{id:"comments.comment"},"Kommentar")),Object(l.h)("div",{class:"border rounded rounded-lg position-relative"},Object(l.h)(h.b,null,Object(l.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(l.h)(h.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(p.a)(this,"commentEditText"),onKeyUp:u.a.resizeTextarea,onFocus:u.a.resizeTextarea,style:"height: 2.3em;",value:g})))),Object(l.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(l.h)("button",{type:"button",class:"btn btn-primary mb-2",onClick:this.saveComment,"data-id":a.id},Object(l.h)("i",{class:"fas fa-paper-plane"}))))):Object(l.h)(e,null,Object(l.h)(b.a,{markdown:u.a.replaceImages(z,a.images,L),markdownOpts:u.a.getMarkdownOptions()})),d[a.id]&&Object(l.h)("div",{class:"clearfix mt-3 mb-3"},Object(l.h)("button",{class:"btn btn-danger float-left",onClick:this.deleteComment,"data-id":a.id},Object(l.h)("i",{class:"fas fa-trash-alt"})," Delete"),Object(l.h)("button",{class:"btn btn-secondary float-right",onClick:this.toggleDeleteComment,"data-id":a.id},Object(l.h)("i",{class:"fas fa-times-circle"})," Cancel")))),Object(l.h)("div",null,Object(l.h)("div",{class:"container-fluid px-3 mt-1"},M&&Object(l.h)("div",{class:"clearfix row position-relative"},Object(l.h)("div",{class:"commentContainer col-12 px-0 overflow-hidden",style:"max-height: 60vh;",onDblclick:this.addLikeComment,"data-id":a.id},Object(l.h)("img",{loading:"lazy",class:"img-fluid",style:"min-width: 100px;",src:M.s3LargeLink})),O[a.id]&&Object(l.h)("span",{class:"likeHeart position-absolute text-white display-1",style:"top: calc(50% - 50px); left: calc(50% - 50px); width: 100px; height: 100px;"},Object(l.h)("i",{class:"fas fa-heart likeStory"}))),$&&$.length>1&&Object(l.h)("div",{class:"clearfix d-flex flex-wrap row"},n.a.isArray($)&&$.map((t,s)=>Object(l.h)(e,null,Object(l.h)("div",{class:"col px-0 overflow-hidden",style:"max-height: 100px; min-width: 100px;"},Object(l.h)("img",{loading:"lazy",class:"img-fluid border",style:"min-width: 100px;",src:t.s3SmallLink,onClick:this.viewImage,"data-id":a.id,"data-idx":s})))))))),Object(l.h)("small",null,Object(l.h)("button",{class:"commentContainer btn btn-sm btn-link py-0 "+(E?"text-primary":""),onClick:this.addLikeComment,"data-id":a.id,disabled:E},E?Object(l.h)(h.c,{id:"comments.has-liked"},"Liked"):Object(l.h)(h.c,{id:"comments.like"},"Lik")),"-",Object(l.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.replyComment,"data-id":a.id},Object(l.h)(h.c,{id:"comments.comment-add"},"Kommentar")),a.language!==L&&Object(l.h)(e,null,"-",!j[a.id]&&H?Object(l.h)(e,null,Object(l.h)("button",{type:"button",class:"btn btn-sm btn-link","data-commentid":a.id,onClick:this.showOriginal},Object(l.h)("i",{class:"fas fa-cog"}),"  ",Object(l.h)(h.c,{id:"home.translate-show-original"},"Show original"))):Object(l.h)(e,null,Object(l.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:this.translate,"data-commentid":a.id},Object(l.h)("i",{class:"fas fa-cog"})," ",Object(l.h)(h.c,{id:"home.translate-to"},"See translation")))),"-",Object(l.h)("button",{class:"btn btn-sm btn-link py-0 disabled"},n.a.formatDistance(a.createdDate,new Date,{locale:"no-NB"}),a.updatedDate&&Object(l.h)(e,null,Object(l.h)("span",{class:"font-weight-light ml-2"},"(Edited ",n.a.formatDistance(a.updatedDate,new Date,{locale:"no-NB"}),")"))))),a.likes&&a.likes.length>0&&Object(l.h)("small",{class:"position-absolute bg-light shadow-sm rounded-lg py-0 px-1",style:"bottom: 20px; right: 15px;"},Object(l.h)("i",{class:"fas fa-thumbs-up text-primary"})," ",a.likes.length)),Object(l.h)("div",{class:"col-10 offset-2 mb-2"},a&&n.a.isArray(T)&&T.map(t=>{const{user:s={}}=t,i=I.findPublicTeamByMembers(s.id),r=u.a.displayNameShort(s),m=u.a.displayName(s),O=s.image||(s.images?s.images[0]:void 0),w=t.likes&&t.likes.findIndex(e=>e.user===D.id)>-1,{currentLocationGeocode:y={}}=t,k=I.getCommentReplyTranslations({race:v,commentid:a.id,replyid:t.id,targetLang:L})||f[`${a.id}-${t.id}`];let x=k||t.comment;return j[`${a.id}-${t.id}`]&&(x=t.comment),Object(l.h)("div",{class:"row"},Object(l.h)("div",{class:"col-12 d-flex mb-2 position-relative"},Object(l.h)("div",{class:"text-center border rounded-circle imageRounded imageRoundedSmall",style:(O?`background-image: url("${O.s3SmallLink}"); background-size: cover;`:"")+" border-width: 3px !important;"},!s.image&&Object(l.h)("span",{class:"font-weight-lighter",style:"font-size: 15px;"},r)),Object(l.h)("div",{class:"flex-grow-1 pl-3 pt-0",style:"line-height: 1.2em;"},Object(l.h)("div",{class:"bg-light p-2 rounded-lg position-relative"},D.id===s.id&&Object(l.h)(e,null,Object(l.h)("span",{class:"float-right font-weight-lighter text-muted"},Object(l.h)("i",{class:"fas fa-ellipsis-h",onClick:this.toggleMenu,"data-id":t.id}))),c[t.id]&&Object(l.h)(e,null,Object(l.h)("div",{class:"position-absolute bg-white p-2 border rounded rounded-lg shadow-sm",style:"top: 30px; right: 10px; width: 60%; z-index: 999999;"},Object(l.h)("button",{class:"btn btn-link btn-block text-left",onClick:this.toggleEdit,"data-id":t.id,"data-comment":t.comment},Object(l.h)("i",{class:"fas fa-edit"})," Edit"),Object(l.h)("hr",null),Object(l.h)("button",{class:"btn btn-link btn-block text-left",onClick:this.toggleDeleteComment,"data-id":t.id},Object(l.h)("i",{class:"fas fa-trash-alt"})," Delete"))),Object(l.h)("span",{style:"font-size: 0.95em;"},Object(l.h)("h5",{class:"font-weight-bold mb-2",style:"font-size: 1.0em;"},m,i&&i.length>0&&Object(l.h)(e,null,Object(l.h)("span",{class:"font-weight-lighter text-muted ml-2"},i.filter(e=>1===e.public).slice(0,1).map(t=>Object(l.h)(e,null,"- ",Object(l.h)("a",{href:"/teams/public/"+t.uuidv4,class:"mr-2"}," ",t.name)))))),o[t.id]?Object(l.h)(e,null,Object(l.h)("div",{class:"d-flex bd-highlight"},Object(l.h)("div",{class:"p-0 w-100 bd-highlight"},Object(l.h)("label",{class:"sr-only",for:"inlineFormInput"},Object(l.h)(h.c,{id:"comments.comment"},"Kommentar")),Object(l.h)("div",{class:"border rounded rounded-lg position-relative"},Object(l.h)(h.b,null,Object(l.h)("textarea",{class:"form-control-plaintext px-2",type:"text",placeholder:Object(l.h)(h.c,{id:"comments.write-comment"},"Skriv en kommentar..."),onInput:Object(p.a)(this,"commentEditText"),onKeyUp:u.a.resizeTextarea,onFocus:u.a.resizeTextarea,style:"height: 2.3em;",value:g})))),Object(l.h)("div",{class:"p-0 pl-2 flex-shrink-1 bd-highlight"},Object(l.h)("button",{type:"button",class:"btn btn-primary mb-2",onClick:this.saveCommentReply,"data-commentid":a.id,"data-id":t.id},Object(l.h)("i",{class:"fas fa-paper-plane"}))))):Object(l.h)(e,null,Object(l.h)(b.a,{markdown:u.a.replaceImages(x,t.images,L),markdownOpts:u.a.getMarkdownOptions()})),d[t.id]&&Object(l.h)("div",{class:"clearfix mt-3 mb-3"},Object(l.h)("button",{class:"btn btn-danger float-left",onClick:this.deleteCommentReply,"data-id":t.id,"data-commentid":a.id},Object(l.h)("i",{class:"fas fa-trash-alt"})," Delete"),Object(l.h)("button",{class:"btn btn-secondary float-right",onClick:this.toggleDeleteComment,"data-id":t.id},Object(l.h)("i",{class:"fas fa-times-circle"})," Cancel")))),Object(l.h)("small",null,Object(l.h)("button",{class:"replyContainer btn btn-sm btn-link py-0 "+(w?"text-primary":""),onClick:this.likeReply,"data-comment":a.id,"data-id":t.id,disabled:w},w?Object(l.h)(h.c,{id:"comments.has-liked"},"Liked"):Object(l.h)(h.c,{id:"comments.like"},"Lik")),"-",Object(l.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.replyComment,"data-id":a.id},Object(l.h)(h.c,{id:"comments.comment-add"},"Kommentar")),t.language!==L&&Object(l.h)(e,null,"-",!j[`${a.id}-${t.id}`]&&k?Object(l.h)(e,null,Object(l.h)("button",{type:"button",class:"btn btn-sm btn-link","data-commentid":a.id,"data-replyid":t.id,onClick:this.showOriginal},Object(l.h)("i",{class:"fas fa-cog"}),"  ",Object(l.h)(h.c,{id:"home.translate-show-original"},"Show original"))):Object(l.h)(e,null,Object(l.h)("button",{type:"button",class:"btn btn-sm btn-link",onClick:this.translate,"data-commentid":a.id,"data-replyid":t.id},Object(l.h)("i",{class:"fas fa-cog"})," ",Object(l.h)(h.c,{id:"home.translate-to"},"See translation")))),"-",Object(l.h)("button",{class:"btn btn-sm btn-link py-0 disabled"},n.a.formatDistance(t.createdDate,new Date,{locale:"no-NB"}),t.updatedDate&&Object(l.h)(e,null,Object(l.h)("span",{class:"font-weight-light ml-2"},"(Edited ",n.a.formatDistance(t.updatedDate,new Date,{locale:"no-NB"}),")"))))),t.likes&&Object(l.h)("small",{class:"position-absolute bg-light shadow-sm rounded-lg py-0 px-1",style:"bottom: 20px; right: 15px;"},Object(l.h)("i",{class:"fas fa-thumbs-up text-primary"})," ",t.likes.length)))}),P-A>0&&Object(l.h)("div",null,Object(l.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.toggleReplies,"data-id":a.id},Object(l.h)(h.c,{id:"comments.show-more",fields:{more:P-A}},"Vis ",P-A," flere kommentarer...")))),t[a.id]&&Object(l.h)("div",{class:"col-11 offset-1 d-flex mb-2 position-relative"},Object(l.h)(m.a,{stores:this.props.stores,race:v,initCall:y,callback:w,commentId:a.id,inputRef:e=>this.inputRef[a.id]=e,inputRefObject:this.inputRef,key:"race-commentreply-"+a.id})))}),E-T>0&&Object(l.h)("div",null,Object(l.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.toggleComments},Object(l.h)(h.c,{id:"comments.show-more",fields:{more:E-T}},"Vis ",E-T," flere kommentarer..."))),a&&Object(l.h)("div",null,Object(l.h)("button",{class:"btn btn-sm btn-link py-0",onClick:this.toggleComments},Object(l.h)(h.c,{id:"comments.hide-all-comments"},"Skjul alle kommentarene."))))}})||c;t.a=O}).call(this,a("hosL").Fragment)},aGZh:function(e,t,a){"use strict";(function(e){function t(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var i,c=a("hosL"),l=a("/eY4");const n={};Object(l.a)(i=class extends c.Component{constructor(e){super(e),this.state=function(e){for(var a=1;a<arguments.length;a++){var i=null!=arguments[a]?arguments[a]:{};a%2?t(Object(i),!0).forEach((function(t){s(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},n)}render(){const{appState:t}=this.props.stores,{text:a}=this.props,{language:s="en"}=t;let i=a;const l=new RegExp(`/<${s}>(.*?)</${s}>/`);return a.replace(l,"$1")&&(i=a),Object(c.h)(e,null,i)}})}).call(this,a("hosL").Fragment)},gs45:function(e,t,a){"use strict";(function(e){function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var l,n=a("hosL"),o=a("Utv1"),r=a("/eY4"),h=a("OhSV"),d=a("67HY"),b=a("gbHB"),p=a("B+py"),m=a("ZOvn");const u={isLoading:!1,showSignup:!1};let g=Object(r.a)(l=class extends n.Component{constructor(e){var t;super(e),t=this,this.signupToRace=async function(){const{raceStore:e,userStore:a}=t.props.stores,{user:s}=a,{newSignup:c}=e,{raceid:l}=t.props,n=i({team:s.team,firstname:s.firstname,lastname:s.lastname,sportsClub:s.sportsClub,email:s.email,cellphone:s.cellphone,facebook:s.facebook,instagram:s.instagram},c);await e.addContestant({id:l,classId:c.class,newContestant:n}),e.addSignup(n),t.toggleShowSignup(!1,!0)},this.updateSignup=e=>{const t=e.target.id,a=e.target.value,{raceStore:s}=this.props.stores;s.updateObjectKeyValue("newSignup",t,a)},this.editSignup=e=>{const{raceid:t}=this.props,{raceStore:a}=this.props.stores,s=e.target.id,i=e.target.value,{classid:c,contestantid:l}=e.target.dataset,n={raceClassId:c,contestantId:l,["raceClassContestant"+o.a.ucfirst(s)]:i};clearTimeout(this.updateTimer[s]),this.updateTimer[s]=setTimeout((async function(){a.editClass({id:t,data:n})}),500)},this.toggleShowSignup=(e,t)=>{const{showSignup:a}=this.state;this.setState({showSignup:!t&&!a})},this.state=i({},u),this.inputRef={},this.updateTimer={}}render(){const{showSignup:t}=this.state,{appState:a,userStore:s,raceStore:i}=this.props.stores,{user:c={},teams:l=[]}=s,{language:r="en"}=a,{raceid:u,subsection:g}=this.props,{race:O,signups:j,newSignup:f}=i,v=new Date,w=j&&j.length>0,y=j.map(e=>parseInt(e.team,10))||[];return Object(n.h)(e,null,Object(n.h)("h2",{class:"mb-0"},Object(n.h)(h.c,{id:"races.signup"},"P√•melding")," ",Object(n.h)("span",{class:"font-weight-lighter",style:"letter-spacing: -1px;"}," - ",O.title)),Object(n.h)("div",{class:"mb-4"},O.signupStartDate&&Object(n.h)(e,null,Object(n.h)(h.c,{id:"races.periode"},"Periode"),": ",o.a.formatDate(O.signupStartDate,{locale:r,hour12:!1,hour:"2-digit",minute:"2-digit"})),O.signupEndDate&&Object(n.h)(e,null," - ",o.a.formatDate(O.signupEndDate,{locale:r,hour12:!1,hour:"2-digit",minute:"2-digit"}))),v>=new Date(O.signupStartDate)&&v<=new Date(O.signupEndDate)?Object(n.h)(e,null,c.email?Object(n.h)(e,null,Object(n.h)("span",{class:"font-weight-lighter"},Object(n.h)(h.c,{id:"races.signed-in-as"},"Logget inn som"),":")," ",c.email,Object(n.h)("br",null),Object(n.h)("br",null),w&&j.map(t=>{let a={};return t.class&&(a=i.getRaceClassById(t.class)),Object(n.h)("div",{class:"mb-5 p-3 bg-light border rounded-lg"},Object(n.h)("div",{class:"font-weight-bold mb-4"},Object(n.h)("i",{class:"fas fa-check text-success"})," ",Object(n.h)(h.c,{id:"races.signed-up"},"Din bruker er p√•meldt!"),Object(n.h)("br",null)),!O.liveRace&&O.signuppayment&&Object(n.h)(e,null,Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"cellphone",class:"col-2 col-form-label text-right font-weight-lighter"},Object(n.h)(h.c,{id:"races.signup"},"P√•melding")),Object(n.h)("div",{class:"col-10"},t.paidSignupfee?Object(n.h)("div",{class:"py-2"},Object(n.h)(h.c,{id:"races.paid"},"Betalt"),": ",o.a.formatDate(t.paidSignupfee),Object(n.h)("i",{class:"fas fa-check text-success ml-3"})):Object(n.h)(e,null,Object(n.h)("div",{class:"alert alert-danger mb-1",role:"alert"},Object(n.h)("h5",null,Object(n.h)("span",{class:"font-weight-lighter"},Object(n.h)(h.c,{id:"races.payment-info"},"Betaling p√•melding"),":")," ",m.a.replaceImages(O.signuppayment,O.images,r,!1),Object(n.h)("br",null),a.signupfee||O.signupfee," NOK")))))),Object(n.h)("div",{class:"clearfix mt-2"},Object(n.h)("span",{class:"font-weight-lighter float-right"},Object(n.h)(h.c,{id:"races.click-to-change"},"Klikk for √• endre info i p√•meldingen."))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"cellphone",class:"col-2 col-form-label text-right font-weight-lighter"},Object(n.h)(h.c,{id:"races.cellphone"},"Mobil")),Object(n.h)("div",{class:"col-10"},Object(n.h)(h.b,null,Object(n.h)("input",{type:"text",class:"form-control-plaintext",id:"cellphone","data-classid":t.class,"data-contestantid":t.id,onInput:this.editSignup,value:t.cellphone,placeholder:Object(n.h)(h.c,{id:"races.cellphone-help"},"Hva er mobilnummer ditt?")})))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"firstname",class:"col-2 col-form-label text-right font-weight-lighter"},Object(n.h)(h.c,{id:"races.firstname"},"Fornavn")),Object(n.h)("div",{class:"col-10"},Object(n.h)(h.b,null,Object(n.h)("input",{type:"text",class:"form-control-plaintext",id:"firstname","data-classid":t.class,"data-contestantid":t.id,onInput:this.editSignup,value:t.firstname,placeholder:Object(n.h)(h.c,{id:"races.firstname-help"},"Hva er fornavnet ditt?")})))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"lastname",class:"col-2 col-form-label text-right font-weight-lighter"},Object(n.h)(h.c,{id:"races.lastname"},"Etternavn")),Object(n.h)("div",{class:"col-10"},Object(n.h)(h.b,null,Object(n.h)("input",{type:"text",class:"form-control-plaintext",id:"lastname","data-classid":t.class,"data-contestantid":t.id,onInput:this.editSignup,value:t.lastname,placeholder:Object(n.h)(h.c,{id:"races.lastname-help"},"Hva er etternavnet ditt?")})))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"sportsClub",class:"col-2 col-form-label text-right font-weight-lighter"},Object(n.h)(h.c,{id:"races.sportsclub"},"Klubb")),Object(n.h)("div",{class:"col-10"},Object(n.h)(h.b,null,Object(n.h)("input",{type:"text",class:"form-control-plaintext",id:"sportsClub","data-classid":t.class,"data-contestantid":t.id,onInput:this.editSignup,value:t.sportsClub,placeholder:Object(n.h)(h.c,{id:"races.sportsClub-help"},"Hvilken klubb tilh√∏rer du?")})))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"facebook",class:"col-2 col-form-label text-right font-weight-lighter"},Object(n.h)(h.c,{id:"races.facebook"},"Facebook")),Object(n.h)("div",{class:"col-10"},Object(n.h)(h.b,null,Object(n.h)("input",{type:"text",class:"form-control-plaintext",id:"facebook","data-classid":t.class,"data-contestantid":t.id,onInput:this.editSignup,value:t.facebook,placeholder:Object(n.h)(h.c,{id:"races.facebook-help"},"Hva er Facebook brukernavnet ditt?")})))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"instagram",class:"col-2 col-form-label text-right font-weight-lighter"},Object(n.h)(h.c,{id:"races.instagram"},"Instagram")),Object(n.h)("div",{class:"col-10"},Object(n.h)(h.b,null,Object(n.h)("input",{type:"text",class:"form-control-plaintext",id:"instagram","data-classid":t.class,"data-contestantid":t.id,onInput:this.editSignup,value:t.instagram,placeholder:Object(n.h)(h.c,{id:"races.instagram-help"},"Hva er Instagram brukernavnet ditt?")})))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"team",class:"col-2 col-form-label text-right font-weight-lighter"},Object(n.h)(h.c,{id:"races.team"},"Team")),Object(n.h)("div",{class:"col-10"},Object(n.h)("select",{class:"form-control-plaintext",id:"team","aria-describedby":"teamHelp","data-classid":t.class,"data-contestantid":t.id,onInput:this.editSignup,value:t.team},Object(n.h)("option",{value:""},"-- ",Object(n.h)(h.c,{id:"races.choose-team"},"Velg team")," --"),l.map(e=>Object(n.h)("option",{value:e.id,disabled:y.indexOf(e.id)>-1},e.name," ",y.indexOf(e.id)>-1&&e.id!==t.team?"(Already signed up!)":""))))),Object(n.h)("div",{class:"form-group row my-0"},Object(n.h)("label",{for:"team",class:"col-2 col-form-label text-right font-weight-lighter"},Object(n.h)(h.c,{id:"races.class"},"Klasse")),Object(n.h)("div",{class:"col-10"},Object(n.h)("select",{class:"form-control-plaintext",id:"class","aria-describedby":"classHelp",onInput:this.editSignup,value:t.class,disabled:!0},Object(n.h)("option",{value:""},"-- ",Object(n.h)(h.c,{id:"races.choose-class"},"Velg klasse")," --"),O.classes&&O.classes.sort((e,t)=>e.distance-t.distance).map(t=>Object(n.h)(e,null,Object(n.h)("option",{value:t.id},t.title,!O.liveRace&&Object(n.h)(e,null,"- ",t.distance," km - P√•melding: ",t.signupfee||O.signupfee," NOK"))))))))}),1===O.liveRace?Object(n.h)(e,null,"Signup is done at the race normal web pages."):Object(n.h)(e,null,w&&!t?Object(n.h)(e,null,Object(n.h)("button",{type:"button",class:"btn btn-sm float-right btn-outline-info",onClick:this.toggleShowSignup},Object(n.h)(h.c,{id:"races.signup-another-team"},"Meld meg p√• i flere klasser"))):Object(n.h)(e,null,Object(n.h)("div",{class:"form-group"},Object(n.h)("label",{for:"cellphone"},Object(n.h)(h.c,{id:"races.cellphone"},"Mobil")),Object(n.h)("input",{type:"text",class:"form-control",id:"cellphone","aria-describedby":"cellphoneHelp",placeholder:c.cellphone,onInput:this.updateSignup,value:f.cellphone}),Object(n.h)("small",{id:"cellphoneHelp",class:"form-text text-muted"},Object(n.h)(h.c,{id:"races.cellphone-help"},"'Hva er mobilnummer ditt?'"))),Object(n.h)("div",{class:"row"},Object(n.h)("div",{class:"col"},Object(n.h)("div",{class:"form-group"},Object(n.h)("label",{for:"firstname"},Object(n.h)(h.c,{id:"races.firstname"},"Fornavn")),Object(n.h)("input",{type:"text",class:"form-control",id:"firstname","aria-describedby":"firstnameHelp",placeholder:c.firstname,onInput:this.updateSignup,value:f.firstname}),Object(n.h)("small",{id:"firstnameHelp",class:"form-text text-muted"},Object(n.h)(h.c,{id:"races.firstname-help"},"Hva er fornavnet ditt?")))),Object(n.h)("div",{class:"col"},Object(n.h)("div",{class:"form-group"},Object(n.h)("label",{for:"lastname"},Object(n.h)(h.c,{id:"races.lastname"},"Etternavn")),Object(n.h)("input",{type:"text",class:"form-control",id:"lastname","aria-describedby":"lastnameHelp",placeholder:c.lastname,onInput:this.updateSignup,value:f.lastname}),Object(n.h)("small",{id:"lastnameHelp",class:"form-text text-muted"},Object(n.h)(h.c,{id:"races.lastname-help"},"Hva er etternavnet ditt?"))))),Object(n.h)("div",{class:"form-group"},Object(n.h)("label",{for:"sportsClub"},Object(n.h)(h.c,{id:"races.sportsclub"},"Klubb")),Object(n.h)("input",{type:"text",class:"form-control",id:"sportsClub","aria-describedby":"sportsClubHelp",placeholder:c.sportsClub,onInput:this.updateSignup,value:f.sportsClub}),Object(n.h)("small",{id:"sportsClubHelp",class:"form-text text-muted"},Object(n.h)(h.c,{id:"races.sportsClub-help"},"Hvilken klubb tilh√∏rer du?"))),Object(n.h)("div",{class:"row"},Object(n.h)("div",{class:"col"},Object(n.h)("div",{class:"form-group"},Object(n.h)("label",{for:"facebook"},Object(n.h)(h.c,{id:"races.facebook"},"Facebook")),Object(n.h)("input",{type:"text",class:"form-control",id:"facebook","aria-describedby":"facebookHelp",placeholder:c.facebook,onInput:this.updateSignup,value:f.facebook}),Object(n.h)("small",{id:"facebookHelp",class:"form-text text-muted"},Object(n.h)(h.c,{id:"races.facebook-help"},"Hva er Facebook brukernavnet ditt?")))),Object(n.h)("div",{class:"col"},Object(n.h)("div",{class:"form-group"},Object(n.h)("label",{for:"instagram"},Object(n.h)(h.c,{id:"races.instagram"},"Instagram")),Object(n.h)("input",{type:"text",class:"form-control",id:"instagram","aria-describedby":"instagramHelp",placeholder:c.instagram,onInput:this.updateSignup,value:f.instagram}),Object(n.h)("small",{id:"instagramHelp",class:"form-text text-muted"},Object(n.h)(h.c,{id:"races.instagram-help"},"Hva er Instagram brukernavnet ditt?"))))),Object(n.h)("div",{class:"form-group"},Object(n.h)("label",{for:"team"},Object(n.h)(h.c,{id:"races.team"},"Team")),!l||0===l.length&&Object(n.h)(e,null,Object(n.h)("div",{class:"alert alert-danger",role:"alert"},Object(n.h)(h.c,{id:"races.no-teams"},"Du har ingen team i appen din enn√•. G√• inn i appen for √• registrer team og fors√∏k igjen."))),Object(n.h)("select",{class:"form-control",id:"team","aria-describedby":"teamHelp",onInput:this.updateSignup,value:f.team},Object(n.h)("option",{value:""},"-- ",Object(n.h)(h.c,{id:"races.choose-team"},"Velg team")," --"),l.map(e=>Object(n.h)("option",{value:e.id,disabled:y.indexOf(e.id)>-1},e.name," ",y.indexOf(e.id)>-1?"(Already signed up!)":""))),Object(n.h)("small",{id:"teamHelp",class:"form-text text-muted"},Object(n.h)(h.c,{id:"races.choose-team-help"},"Velg fra dine team"))),Object(n.h)("div",{class:"form-group"},Object(n.h)("label",{for:"class"},Object(n.h)(h.c,{id:"races.class"},"Klasse")),Object(n.h)("select",{class:"form-control",id:"class","aria-describedby":"classHelp",onInput:this.updateSignup,value:f.class},Object(n.h)("option",{value:""},"-- ",Object(n.h)(h.c,{id:"races.choose-class"},"Velg klasse")," --"),O.classes&&O.classes.map(t=>Object(n.h)(e,null,Object(n.h)("option",{value:t.id},t.title," - ",t.distance," km - P√•melding: ",t.signupfee||O.signupfee," NOK")))),Object(n.h)("small",{id:"classHelp",class:"form-text text-muted"},Object(n.h)(h.c,{id:"races.choose-class-help"},"Velg √∏nsket klasse."))),O.rules&&Object(n.h)("div",{class:"form-group form-check"},Object(n.h)("input",{type:"checkbox",class:"form-check-input",id:"termsAndAgreement",onInput:this.updateSignup,checked:f.termsAndAgreement,value:!0}),Object(n.h)("label",{class:"form-check-label",for:"termsAndAgreement"},Object(n.h)(h.c,{id:"races.agreement-accept"},"Jeg har lest og godtar reglene for l√∏pet."))),O.declaration&&Object(n.h)("div",{class:"form-group form-check"},Object(n.h)("input",{type:"checkbox",class:"form-check-input",id:"declaration",onInput:this.updateSignup,checked:f.declaration,value:!0}),Object(n.h)("label",{class:"form-check-label",for:"declaration"},Object(n.h)(h.c,{id:"races.declaration-accept"},"Jeg signerer med dette egen√¶rkl√¶ringen."))),Object(n.h)("button",{type:"button",class:"btn btn-primary",onClick:this.signupToRace},Object(n.h)(h.c,{id:"races.do-signup"},"Meld meg p√•")),w&&Object(n.h)("button",{type:"button",class:"btn btn-danger float-right",onClick:this.toggleShowSignup},Object(n.h)(h.c,{id:"races.hide-signup"},"Avbryt"))))):Object(n.h)(e,null,!g&&Object(n.h)(d.a,{stores:this.props.stores,routeLoginOk:`/race/${u}/signup`,routeLoginNew:`/race/${u}/signup/newUser`,routeLoginForgot:`/race/${u}/signup/forgotPassword`}),"newUser"===g&&Object(n.h)(b.a,{stores:this.props.stores,routeLogin:`/race/${u}/signup`,routeLoginForgot:`/race/${u}/signup/forgotPassword`,skipPubSub:!0}),"forgotPassword"===g&&Object(n.h)(p.a,{stores:this.props.stores,routeLogin:`/race/${u}/signup`,routeLoginNew:`/race/${u}/signup/newUser`}))):Object(n.h)(e,null,v<new Date(O.signupStartDate)?Object(n.h)(e,null,Object(n.h)("h5",{class:"mt-4"},Object(n.h)("i",{class:"fas fa-exclamation-circle"})," ",Object(n.h)(h.c,{id:"races.signup-not-open-yet"},"P√•meldingen har ikke √•pnet enn√•!")),Object(n.h)("p",{class:"mt-4"},Object(n.h)(h.c,{id:"races.signup-opening"},"P√•meldingen √•pner"),":",Object(n.h)("br",null),Object(n.h)("span",{class:"display-4"},o.a.formatDate(O.signupStartDate,{locale:r,hour12:!1,hour:"2-digit",minute:"2-digit"})))):Object(n.h)(e,null,Object(n.h)("h5",{class:"mt-4 mb-4"},Object(n.h)("i",{class:"fas fa-exclamation-circle"})," ",Object(n.h)(h.c,{id:"races.signup-closed"},"P√•meldingen er stengt!")))))}})||l;t.a=g}).call(this,a("hosL").Fragment)},om2D:function(e,t,a){"use strict";var s,i=a("hosL"),c=a("/eY4"),l=(a("cneo"),a("Utv1"),a("u2zT"));let n=Object(c.a)(s=class extends i.Component{constructor(e){super(e),this.handleAddImage=e=>{const{addToImages:t=!0}=this.props,{updateField:a,object:s,field:i}=this.props;if(i&&a({id:s.id,field:i,value:e,skipTimer:!0}),t){const t=[];t.push(e),a({id:s.id,field:"images",value:t,skipTimer:!0})}},this.state={files:[]}}render(){const{uploadStatus:e=(()=>{}),before:t=(()=>{}),after:a=(()=>{}),autoOpen:s=!0}=this.props;return Object(i.h)("div",{class:"row"},Object(i.h)("div",{class:"col-12"},Object(i.h)(l.a,{handleAddImage:this.handleAddImage,uploadStatus:e,apiUrl:"/api/fileupload",before:t,after:a,autoOpen:s},Object(i.h)("div",{style:{height:30,width:"100%"}}))))}})||s;t.a=n},"p/0L":function(e,t,a){"use strict";a.r(t),function(e){function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var l,n=a("hosL"),o=a("QRet"),r=a("Utv1"),h=a("/eY4"),d=a("OhSV"),b=a("go65"),p=a("fh8t"),m=a.n(p),u=a("RMlE"),g=a("8gML"),O=a("gs45"),j=(a("67HY"),a("gbHB"),a("B+py"),a("Ysxg")),f=a("9lZG"),v=(a("aGZh"),a("om2D")),w=a("ZOvn");const y=w.a.marginTop(!0,!0),k=w.a.marginBottom(),x={isLoading:!1,email:"",submenu:"ads",jwtToken:r.a.getJwtToken(),newRaceArticle:{},newRaceUserImage:{}};let S=Object(h.a)(l=class extends n.Component{constructor(e){var t;super(e),t=this,this.likeRace=async function(){const{raceStore:e}=t.props.stores,{race:a}=e;await e.likeRace({id:a.id})},this.toggleAddComment=e=>{const t=e.target.parentElement.dataset.id||e.target.dataset.id,{showAddComment:a}=this.state;this.setState({showAddComment:!a},()=>{this.inputRef[t]&&this.inputRef[t].focus()})},this.addRaceArticle=async function(){const{raceid:e}=t.props,{raceStore:a}=t.props.stores,{newRaceArticle:s}=t.state;await a.addArticle({id:e,newArticle:s}),t.setState({newRaceArticle:{}})},this.addRaceUserImage=async function(){const{raceid:e}=t.props,{raceStore:a}=t.props.stores,{newRaceUserImage:s}=t.state;await a.addUserImage({id:e,newUserImage:s}),t.setState({newRaceUserImage:{}})},this.updateUserImageUpload=({field:e,value:t})=>{const{newRaceUserImage:a}=this.state;a[e]=t,this.setState({newRaceUserImage:a})},this.updateArticleUpload=({field:e,value:t})=>{const{newRaceArticle:a}=this.state;a[e]=t,this.setState({newRaceArticle:a})},this.removeRaceArticle=async function(e){const a=e.target.parentElement.dataset.id||e.target.dataset.id,{raceid:s}=t.props,{raceStore:i}=t.props.stores;await i.removeArticle({id:s,articleId:a})},this.removeRaceUserImage=async function(e){const a=e.target.parentElement.dataset.id||e.target.dataset.id,{raceid:s}=t.props,{raceStore:i}=t.props.stores;await i.removeUserImage({id:s,userImageId:a})},this.editRaceArticle=async function(e){const{id:a,field:s}=e.target.dataset,{value:i}=e.target,{raceid:c}=t.props,{raceStore:l}=t.props.stores,n={raceArticleId:a,["raceArticle"+r.a.ucfirst(s)]:i};clearTimeout(t.updateTimer[`${c}-${a}-${s}`]),t.updateTimer[`${c}-${a}-${s}`]=setTimeout((async function(){l.editArticle({id:c,data:n})}),1500),t.resizeTextarea(e.target)},this.editRaceUserImage=async function(e){const{id:a,field:s}=e.target.dataset,{value:i}=e.target,{raceid:c}=t.props,{raceStore:l}=t.props.stores,n={raceUserImageId:a,["raceUserImage"+r.a.ucfirst(s)]:i};clearTimeout(t.updateTimer[`${c}-${a}-${s}`]),t.updateTimer[`${c}-${a}-${s}`]=setTimeout((async function(){l.editUserImage({id:c,data:n})}),1500),t.resizeTextarea(e.target)},this.resizeAllTextareas=()=>{const e=document.getElementsByTagName("textarea");for(let t=0,a=e.length;t<a;t+=1){this.resizeTextarea(e[t])}},this.resizeTextarea=e=>{let t=e;t.target&&(t=e.target);const{scrollHeight:a}=t;t.style.height=a+"px"},this.handleImageErrored=e=>{const t=e.target;t.onerror=null,setTimeout(()=>{t.src+="?"+new Date},1e3)},this.state=i({},x),this.inputRef={},this.updateTimer={}}async loadRace(e=this.props){this.setState({isLoading:!0});const{raceStore:t,userStore:a}=e.stores,{user:s={}}=a,{raceid:c}=e;await t.load(c),t.countAll(),this.setState({isLoading:!1});let l={};t.resetSignup();const{race:n}=t;if(n.classes&&s&&s.email)for(let e=0,a=n.classes.length;e<a;e+=1){const a=n.classes[e];if(a.contestants){const e=a.contestants.findIndex(e=>e.email===s.email);e>-1&&(l=i(i({},a.contestants[e]),{},{class:a.id}),t.addSignup(l))}}t.updateKeyValue("signup",l),this.resizeAllTextareas()}componentDidMount(){this.loadRace()}componentWillReceiveProps(e){this.loadRace(e)}render(){const{showAddComment:t,newRaceArticle:a,newRaceUserImage:s}=this.state,{appState:i,userStore:c,raceStore:l}=this.props.stores,{isAdmin:h,user:p={},notifications:x=[],teams:S=[]}=c,{raceid:C,path:I,section:D,subsection:L,col:R=12,offset:E=0}=this.props,{darkmode:T,language:P="en"}=i,{race:A,totalClasses:$,totalContestants:U}=l,{likes:M=[],comments:F=[]}=A,H=A.likes&&A.likes.findIndex(e=>e.user===p.id)>-1,z=new Date;let N="";return z>=new Date(A.startDate)&&z<=new Date(A.endDate)?N="race":z>=new Date(A.signupStartDate)&&z<=new Date(A.signupEndDate)?N="signup":z>new Date(A.endDate)&&(N="done"),Object(n.h)(e,null,Object(n.h)(u.a,{stores:this.props.stores}),Object(n.h)("div",{class:"container-fluid position-relative",style:`margin-bottom: ${k}; margin-top: ${y};`},Object(n.h)(g.a,{stores:this.props.stores,path:I,raceid:C}),h&&Object(n.h)("span",{class:"float-right position-absolute",style:"top: 10px; right: 10px; z-index:10000;"},Object(n.h)("a",{href:`/race/${C}/edit`,class:"btn btn-small btn-primary"},Object(n.h)("nobr",null,Object(n.h)("i",{class:"fas fa-chart-line"})," ",Object(n.h)(d.c,{id:"race.edit"},"Endre l√∏pet")))),Object(n.h)("div",{class:"row border-bottom "},Object(n.h)("div",{class:"col-12"},Object(n.h)("div",{class:"jumbotron-thumb d-flex align-items-center position-relative"},A.images&&A.images[0]?Object(n.h)("img",{src:A.images[0].s3XXLargeLink,class:"img-fluid border rounded-lg",style:"min-width: 100%"}):""),Object(n.h)("h3",{class:"float-right"},"signup"===N&&!A.liveRace&&Object(n.h)(e,null,Object(n.h)("div",{class:"spinner-grow text-primary",role:"status"}),Object(n.h)("span",{class:"badge badge-primary ml-2"},Object(n.h)(d.c,{id:"races.signup-open"},"P√•melding √•pen"))),"race"===N&&Object(n.h)(e,null,Object(n.h)("div",{class:"spinner-grow text-danger",role:"status"}),Object(n.h)("span",{class:"badge badge-danger ml-2"},Object(n.h)(d.c,{id:"races.race-in-progress"},"L√∏p p√•g√•r"))),"done"===N&&Object(n.h)(e,null,Object(n.h)("i",{class:"fas fa-check text-success"}),Object(n.h)("span",{class:"badge badge-success ml-2"},Object(n.h)(d.c,{id:"races.race-finished"},"L√∏p avsluttet")))),Object(n.h)("h1",{class:"float-right"},h&&Object(n.h)("i",{class:`fas fa-eye${A.active?" text-success":"-slash text-danger"} float-right`})),(K=A.title,Object(o.d)(()=>{document.title="Homerun Race: "+K},[K]),Object(n.h)("h1",{class:"my-0"},K)),U>10?Object(n.h)("span",{class:"text-muted font-weight-lighter"},Object(n.h)(d.c,{id:"races.starting-teams",fields:{totalContestants:U,totalClasses:$}})):Object(n.h)(e,null),Object(n.h)("div",{class:"text-muted mt-2"},Object(n.h)("span",null,A.startDate&&Object(n.h)(e,null,r.a.formatDate(A.startDate,{locale:P,hour12:!1,hour:"2-digit",minute:"2-digit"})),A.endDate&&Object(n.h)(e,null," - ",r.a.formatDate(A.endDate,{locale:P,hour12:!1,hour:"2-digit",minute:"2-digit"}))),Object(n.h)("span",{class:""},A.tag&&A.tag.split(",").map(t=>Object(n.h)(e,null,Object(n.h)("span",{class:"badge badge-pill badge-primary py-1 ml-2"},Object(n.h)("a",{class:"text-white",href:"https://www.facebook.com/hashtag/"+t,target:"_blank",rel:"noreferrer",native:!0},Object(n.h)("i",{class:"fab fa-facebook"})," #",t)),Object(n.h)("span",{class:"badge badge-pill badge-primary py-1 ml-2"},Object(n.h)("a",{class:"text-white",href:"https://www.instagram.com/explore/tags/"+t,target:"_blank",rel:"noreferrer",native:!0},Object(n.h)("i",{class:"fab fa-instagram"})," #",t))))),A.contactEmail&&Object(n.h)("span",{class:"ml-2"},Object(n.h)("a",{href:`mailto:${A.contactEmail}subject=Regarding ${A.title}&body=Write your question here :)`},Object(n.h)("i",{class:"fas fa-envelope"})," ",A.contactEmail)),A.facebook&&Object(n.h)("span",{class:"ml-2"},Object(n.h)("a",{href:""+A.facebook,target:"_blank",rel:"noreferrer",native:!0},Object(n.h)("i",{class:"fab fa-facebook"})," Facebook")),A.instagram&&Object(n.h)("span",{class:"ml-2"},Object(n.h)("a",{href:""+A.instagram,target:"_blank",rel:"noreferrer",native:!0},Object(n.h)("i",{class:"fab fa-instagram"})," Instagram")),A.signuppayment&&Object(n.h)("span",{class:"badge badge-pill badge-success py-1 ml-2"},Object(n.h)("span",{class:"font-weight-lighter"},Object(n.h)(d.c,{id:"race.signup-payment"},"Betaling p√•melding"),":")," ",w.a.replaceImages(A.signuppayment,A.images,P,!1))),A.locationCity&&Object(n.h)("div",{class:"text-muted"},Object(n.h)(d.c,{id:"race.location"},"Sted"),": ",A.locationCity,", ",A.locationCountry),Object(n.h)("ul",{class:"nav nav-tabs my-3"},Object(n.h)("li",{class:"nav-item"},Object(n.h)("a",{class:"nav-link "+(D?"":"active"),href:"/race/"+C},Object(n.h)("i",{class:"fas fa-info-circle"})," ",Object(n.h)(d.c,{id:"race.about"},"Om l√∏pet"))),Object(n.h)("li",{class:"nav-item"},Object(n.h)("a",{class:"nav-link "+("news"===D?"active":""),href:`/race/${C}/news`},Object(n.h)("i",{class:"fas fa-rss"})," ",Object(n.h)(d.c,{id:"race.news"},"Nyheter"))),Object(n.h)("li",{class:"nav-item"},Object(n.h)("a",{class:"nav-link "+("rules"===D?"active":""),href:`/race/${C}/rules`},Object(n.h)("i",{class:"fas fa-gavel"})," ",Object(n.h)(d.c,{id:"race.rules"},"Regler"))),A.veterinaryInfo&&Object(n.h)("li",{class:"nav-item"},Object(n.h)("a",{class:"nav-link "+("veterinaryInfo"===D?"active":""),href:`/race/${C}/veterinaryInfo`},Object(n.h)("i",{class:"fas fa-stethoscope"})," ",Object(n.h)(d.c,{id:"race.veterinary"},"Veterin√¶rinfo"))),A.checkpoints&&Object(n.h)("li",{class:"nav-item"},Object(n.h)("a",{class:"nav-link "+("checkpoints"===D?"active":""),href:`/race/${C}/checkpoints`},Object(n.h)("i",{class:"fas fa-map-marker-alt"})," ",Object(n.h)(d.c,{id:"race.checkpoints"},"Sjekkpunkter"))),A.trailDescription&&Object(n.h)("li",{class:"nav-item"},Object(n.h)("a",{class:"nav-link "+("trailDescription"===D?"active":""),href:`/race/${C}/trailDescription`},Object(n.h)("i",{class:"fas fa-map-signs"})," ",Object(n.h)(d.c,{id:"race.track-description"},"L√∏ypebeskrivelse"))),A.program&&Object(n.h)("li",{class:"nav-item"},Object(n.h)("a",{class:"nav-link "+("program"===D?"active":""),href:`/race/${C}/program`},Object(n.h)("i",{class:"fas fa-list-alt"})," ",Object(n.h)(d.c,{id:"race.program"},"Program"))),A.prices&&Object(n.h)("li",{class:"nav-item"},Object(n.h)("a",{class:"nav-link "+("prices"===D?"active":""),href:`/race/${C}/prices`},Object(n.h)("i",{class:"fas fa-award"})," ",Object(n.h)(d.c,{id:"race.prices"},"Premier"))),Object(n.h)("li",{class:"nav-item"},Object(n.h)("a",{class:"nav-link "+("classes"===D?"active":""),href:`/race/${C}/classes`},Object(n.h)("i",{class:"fas fa-folder-open"})," ",Object(n.h)(d.c,{id:"race.classes"},"Klasser"))),Object(n.h)("li",{class:"nav-item"},Object(n.h)("a",{class:"nav-link "+("signup"===D?"active":""),href:`/race/${C}/signup`},Object(n.h)("i",{class:"fas fa-folder-open"})," ",Object(n.h)(d.c,{id:"race.signup"},"P√•melding"))))),Object(n.h)("div",{class:`col-${R} offset-${E} col-sm-8 col-lg-8 offset-sm-2 offset-lg-2`},!D&&Object(n.h)(e,null,A.articles&&A.articles.length>0&&Object(n.h)("div",{class:"row"},Object(n.h)("div",{class:"col-12 mb-3 py-2 position-relative border-bottom bg-light"},Object(n.h)("small",null,Object(n.h)("div",{class:"font-weight-bold"},Object(n.h)("i",{class:"fas fa-rss"})," ",Object(n.h)(d.c,{id:"race.news"},"Nyheter")),Object(n.h)("div",{class:"row"},A.articles&&A.articles.reverse().slice(0,3).map(t=>Object(n.h)(e,null,Object(n.h)("div",{class:"col-12 col-sm-6 col-md-4 col-lg-4 p-3 position-relative"},t.image&&Object(n.h)("img",{src:t.image.s3LargeLink,class:"float-right rounded-lg ml-2",style:"height: 70px;"}),Object(n.h)("span",{class:"text-muted font-weight-light mr-2"},r.a.formatDate(t.date,{locale:P,hour12:!1,hour:"2-digit",minute:"2-digit"})),Object(n.h)("span",{class:"font-weight-bold mr-2",style:"font-size: 1.2em;"},Object(n.h)("a",{href:`/race/${C}/news`,class:"text-"+(T?"light":"dark")},w.a.replaceImages(t.title,A.images,P,!1))),Object(n.h)("br",null),Object(n.h)("span",{class:"font-weight-normal"},w.a.replaceImages(t.body,A.images,P,!1))))),A.articles.length>3&&Object(n.h)("div",{class:"col-12 mt-2 text-center",style:"font-size: 1.5em;"},Object(n.h)("a",{href:`/race/${C}/news`,class:"text-muted"},Object(n.h)(d.c,{id:"race.more-news"},"Flere nyheter")," ¬ª")))))),Object(n.h)("p",{class:"clearfix"},Object(n.h)("strong",null,Object(n.h)(m.a,{markdown:w.a.replaceImages(A.ingress,A.images,P),markdownOpts:w.a.getMarkdownOptions()}))),Object(n.h)(m.a,{markdown:w.a.replaceImages(A.body,A.images,P),markdownOpts:w.a.getMarkdownOptions()})),"news"===D&&Object(n.h)(e,null,Object(n.h)("div",{class:"row"},Object(n.h)("div",{class:"col-12"},Object(n.h)("h2",null,Object(n.h)(d.c,{id:"race.news"},"Nyheter"))),A.articles&&A.articles.reverse().map(t=>Object(n.h)(e,null,Object(n.h)("div",{class:"col-12 col-sm-12 col-md-6 col-lg-4 p-3 position-relative"},Object(n.h)("h5",null,w.a.replaceImages(t.title,A.images,P,!1)),t.image&&Object(n.h)("img",{src:t.image.s3LargeLink,class:"float-right w-50 rounded-lg ml-2"}),Object(n.h)("small",{class:"text-muted"}," ",r.a.formatDate(t.date,{locale:P,hour12:!1,hour:"2-digit",minute:"2-digit"})),Object(n.h)("br",null),Object(n.h)("div",{class:"font-weight-bold"},Object(n.h)(m.a,{markdown:w.a.replaceImages(t.ingress,A.images,P),markdownOpts:w.a.getMarkdownOptions()})),Object(n.h)("div",null,Object(n.h)(m.a,{markdown:w.a.replaceImages(t.body,A.images,P),markdownOpts:w.a.getMarkdownOptions()}))))))),"rules"===D&&Object(n.h)(e,null,Object(n.h)("h2",null,Object(n.h)(d.c,{id:"race.rules"},"Regler")),Object(n.h)(m.a,{markdown:w.a.replaceImages(A.rules,A.images,P),markdownOpts:w.a.getMarkdownOptions()})),"veterinaryInfo"===D&&Object(n.h)(e,null,Object(n.h)("h2",null,Object(n.h)(d.c,{id:"race.veterinary"},"Veterin√¶rinfo")),Object(n.h)(m.a,{markdown:w.a.replaceImages(A.veterinaryInfo,A.images,P),markdownOpts:w.a.getMarkdownOptions()})),"checkpoints"===D&&Object(n.h)(e,null,Object(n.h)("h2",null,Object(n.h)(d.c,{id:"race.checkpoints"},"Sjekkpunkter")),Object(n.h)(m.a,{markdown:w.a.replaceImages(A.checkpoints,A.images,P),markdownOpts:w.a.getMarkdownOptions()})),"trailDescription"===D&&Object(n.h)(e,null,Object(n.h)("h2",null,Object(n.h)(d.c,{id:"race.track-description"},"L√∏ypebeskrivelse")),Object(n.h)(m.a,{markdown:w.a.replaceImages(A.trailDescription,A.images,P),markdownOpts:w.a.getMarkdownOptions()})),"program"===D&&Object(n.h)(e,null,Object(n.h)("h2",null,Object(n.h)(d.c,{id:"race.program"},"Program")),Object(n.h)(m.a,{markdown:w.a.replaceImages(A.program,A.images,P),markdownOpts:w.a.getMarkdownOptions()})),"prices"===D&&Object(n.h)(e,null,Object(n.h)("h2",null,Object(n.h)(d.c,{id:"race.prices"},"Premier")),Object(n.h)(m.a,{markdown:w.a.replaceImages(A.prices,A.images,P),markdownOpts:w.a.getMarkdownOptions()})),"classes"===D&&Object(n.h)(e,null,Object(n.h)("h2",null,Object(n.h)(d.c,{id:"race.classes"},"Klasser")),Object(n.h)("div",{class:"row"},A.classes&&A.classes.sort((e,t)=>e.distance-t.distance).map(t=>Object(n.h)(e,null,Object(n.h)("div",{class:"col-6 col-sm-6 col-lg-4 mb-4"},Object(n.h)("div",{class:"border rounded rounded-lg p-3"},Object(n.h)("h5",null,t.title),Object(n.h)("small",null,t.startDate&&Object(n.h)("div",null,Object(n.h)("span",{class:"font-weight-lighter"},Object(n.h)(d.c,{id:"race.startdate"},"Start"),":")," ",r.a.formatDate(`${t.startDate} ${t.startTime||"00:00:00"}`,{locale:P,hour12:!1,hour:"2-digit",minute:"2-digit"})),t.endDate&&Object(n.h)("div",null,Object(n.h)("span",{class:"font-weight-lighter"},Object(n.h)(d.c,{id:"race.enddate"},"End"),":")," ",r.a.formatDate(`${t.endDate} ${t.endTime||"00:00:00"}`,{locale:P,hour12:!1,hour:"2-digit",minute:"2-digit"}))),Object(n.h)("div",null,Object(n.h)("span",{class:"font-weight-lighter"},Object(n.h)(d.c,{id:"race.distance"},"Distanse"),":")," ",t.distance," km"),Object(n.h)("div",null,Object(n.h)("span",{class:"font-weight-lighter"},Object(n.h)(d.c,{id:"race.signup"},"P√•melding"),":")," ",t.signupfee||A.signupfee," NOK"),Object(n.h)("p",{class:"clearfix"},Object(n.h)(m.a,{markdown:w.a.replaceImages(t.ingress,A.images,P),markdownOpts:w.a.getMarkdownOptions()})),Object(n.h)("small",null,Object(n.h)(m.a,{markdown:w.a.replaceImages(t.body,A.images,P),markdownOpts:w.a.getMarkdownOptions()})),t.rules&&Object(n.h)(e,null,Object(n.h)("h5",null,Object(n.h)(d.c,{id:"race.rules"},"Regler")),Object(n.h)(m.a,{markdown:w.a.replaceImages(t.rules,A.images,P),markdownOpts:w.a.getMarkdownOptions()})))))))),"signup"===D&&Object(n.h)(O.a,{stores:this.props.stores,raceid:C,subsection:L})),Object(n.h)("div",{class:`col-${R} offset-${E} col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mt-5`},M&&M.length>0&&Object(n.h)("small",{class:"bg-light shadow-sm rounded-lg py-0 px-1",style:"bottom: 20px; right: 15px;"},Object(n.h)("i",{class:"fas fa-thumbs-up text-primary"})," ",M.length),F&&F.length>0&&Object(n.h)("small",{class:"float-right bg-light shadow-sm rounded-lg py-0 px-1",style:"bottom: 20px; right: 15px;"},Object(n.h)("i",{class:"fas fa-comment text-primary"})," ",F.length)),p.email&&Object(n.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-2 mb-3"},Object(n.h)("div",{class:"row"},Object(n.h)("div",{class:"col-6 text-center"},Object(n.h)("button",{type:"button",class:`btn btn-outline-${H?"primary":"secondary"} btn-lg btn-block ${H?"text-primary":""}`,onClick:this.likeRace},Object(n.h)("i",{class:(H?"text-primary fas":"far")+" fa-thumbs-up"})," Like")),Object(n.h)("div",{class:"col-6 text-center"},Object(n.h)("button",{type:"button",class:"btn btn-outline-secondary btn-lg btn-block","data-id":A.id,onClick:this.toggleAddComment},Object(n.h)("i",{class:"fas fa-comment"})," Comment")))),Object(n.h)("div",{class:"col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-2 mb-3"},t&&p.email&&Object(n.h)(f.a,{stores:this.props.stores,race:A,inputRef:e=>this.inputRef[A.id]=e,inputRefObject:this.inputRef})),Object(n.h)("div",{class:"col-12 mt-2"},Object(n.h)(j.a,{stores:this.props.stores,race:A,cols:"12"}))),h&&Object(n.h)(e,null,Object(n.h)("h2",{class:"mt-5"},"Articles"),Object(n.h)("div",{class:"row"},A.articles&&A.articles.map(t=>Object(n.h)(e,null,Object(n.h)("div",{class:"col-12 col-sm-6 col-md-4 col-lg-3 border rounded-lg p-3 position-relative"},Object(n.h)("button",{class:"btn btn-danger position-absolute",style:"top:5px; right: 5px;","data-id":t.id,onClick:this.removeRaceArticle},Object(n.h)("i",{class:"fas fa-times"})),t.image&&Object(n.h)("img",{src:t.image.s3LargeLink,class:"float-right w-100"}),["title"].map(a=>Object(n.h)(e,null,Object(n.h)("div",{class:"form-group"},Object(n.h)("input",{type:"text",class:"form-control-plaintext font-weight-bold",id:a,"aria-describedby":a+"Help",style:"font-size: 1.5em;","data-id":t.id,"data-field":a,value:t[a],onInput:this.editRaceArticle})))),["ingress","body"].map(a=>Object(n.h)(e,null,Object(n.h)("div",{class:"form-group"},Object(n.h)("textarea",{type:"textarea",class:"form-control-plaintext",id:a,"aria-describedby":a+"Help","data-id":t.id,"data-field":a,value:t[a],onInput:this.editRaceArticle,style:"height: 1em;"})))))))),Object(n.h)("div",{class:"row"},Object(n.h)("div",{class:"col-6 offset-3 border rounded-lg m-2 p-3 bg-light"},Object(n.h)("h5",null,"Add new article"),a&&a.image&&Object(n.h)("img",{src:a.image.s3LargeLink,class:"float-right w-50",onError:this.handleImageErrored}),["title"].map(t=>Object(n.h)(e,null,Object(n.h)("div",{class:"form-group"},Object(n.h)("label",{for:t},t),Object(n.h)("input",{type:"text",class:"form-control",id:t,"aria-describedby":t+"Help",onInput:Object(b.a)(this,"newRaceArticle."+t),value:a[t]})))),["ingress","body"].map(t=>Object(n.h)(e,null,Object(n.h)("div",{class:"form-group"},Object(n.h)("label",{for:t},t),Object(n.h)("textarea",{type:"text",class:"form-control",id:t,"aria-describedby":t+"Help",onInput:Object(b.a)(this,"newRaceArticle."+t),onKeyUp:this.resizeTextarea,style:"height: 1em;",value:a[t]})))),Object(n.h)(v.a,{saved:{},object:{},field:"image",updateField:this.updateArticleUpload,autoOpen:!1}),Object(n.h)("button",{class:"btn btn-info",onClick:this.addRaceArticle},"Add race article"))),Object(n.h)("h2",{class:"mt-5"},"User images"),Object(n.h)("div",{class:"row"},A.userImages&&A.userImages.map(t=>Object(n.h)(e,null,Object(n.h)("div",{class:"col-12 col-sm-6 col-md-4 col-lg-3 border rounded-lg p-3 position-relative"},Object(n.h)("button",{class:"btn btn-danger position-absolute",style:"top:5px; right: 5px;","data-id":t.id,onClick:this.removeRaceUserImage},Object(n.h)("i",{class:"fas fa-times"})),Object(n.h)("img",{src:t.image.s3LargeLink,class:"float-right w-100"}),["title"].map(a=>Object(n.h)(e,null,Object(n.h)("div",{class:"form-group "},Object(n.h)("input",{type:"text",class:"form-control-plaintext font-weight-bold",id:a,"aria-describedby":a+"Help",style:"font-size: 1.5em;","data-id":t.id,"data-field":a,value:t[a],onInput:this.editRaceUserImage})))),["body"].map(a=>Object(n.h)(e,null,Object(n.h)("div",{class:"form-group"},Object(n.h)("textarea",{type:"textarea",class:"form-control-plaintext",id:a,"aria-describedby":a+"Help","data-id":t.id,"data-field":a,value:t[a],onInput:this.editRaceUserImage,style:"height: 1em;"})))))))),Object(n.h)("div",{class:"row"},Object(n.h)("div",{class:"col-3 offset-3 border rounded-lg m-2 p-3 bg-light"},Object(n.h)("h5",null,"Add new user image"),Object(n.h)("div",{class:"row"},Object(n.h)("div",{class:"col"},s&&s.image&&Object(n.h)("img",{src:s.image.s3LargeLink,class:"float-right w-50",onError:this.handleImageErrored}),["title"].map(t=>Object(n.h)(e,null,Object(n.h)("div",{class:"form-group"},Object(n.h)("label",{for:t},t),Object(n.h)("input",{type:"text",class:"form-control",id:t,"aria-describedby":t+"Help",onInput:Object(b.a)(this,"newRaceUserImage."+t),value:s[t]})))),["body"].map(t=>Object(n.h)(e,null,Object(n.h)("div",{class:"form-group"},Object(n.h)("label",{for:t},t),Object(n.h)("textarea",{type:"text",class:"form-control",id:t,"aria-describedby":t+"Help",onInput:Object(b.a)(this,"newRaceUserImage."+t),onKeyUp:this.resizeTextarea,style:"height: 1em;",value:s[t]})))))),Object(n.h)(v.a,{saved:{},object:{},field:"image",updateField:this.updateUserImageUpload,autoOpen:!1}),Object(n.h)("button",{class:"btn btn-info",onClick:this.addRaceUserImage},"Add race user image"))))));var K}})||l;t.default=S}.call(this,a("hosL").Fragment)},u2zT:function(e,t,a){"use strict";var s,i=a("hosL"),c=a("/eY4"),l=a("Utv1"),n=a("OhSV");let o=Object(c.a)(s=class extends i.Component{constructor(e){super(e),this.dropRef=Object(i.createRef)(),this.handleDrag=e=>{e.preventDefault(),e.stopPropagation()},this.handleDragIn=e=>{e.preventDefault(),e.stopPropagation(),this.dragCounter++,e.dataTransfer.items&&e.dataTransfer.items.length>0&&this.setState({drag:!0})},this.handleDragOut=e=>{e.preventDefault(),e.stopPropagation(),this.dragCounter--,0===this.dragCounter&&this.setState({drag:!1})},this.handleDrop=e=>{if(e.preventDefault(),e.stopPropagation(),this.setState({drag:!1}),e.dataTransfer.files&&e.dataTransfer.files.length>0){for(let t=0,a=e.dataTransfer.files.length;t<a;t+=1){this.readLocalFile(e.dataTransfer.files[t])}this.dragCounter=0}},this.handleAddFiles=e=>{e.preventDefault();const t=e.target;for(let e=0,a=t.files.length;e<a;e+=1){this.readLocalFile(t.files[e])}},this.handleEvent=()=>{0},this.handleUpload=e=>{const{uploadStatus:t=(()=>{}),before:a=(()=>{}),after:s=(()=>{})}=this.props;t(!1),l.a.isFunction(a)&&a();const i=new FormData;i.append("files[]",e);const c={progress:1};c.xhr=new XMLHttpRequest,c.xhr.upload.addEventListener("progress",t=>{this.updateProgress(t,e)}),c.xhr.addEventListener("loadstart",t=>{this.handleEvent(t,e)}),c.xhr.addEventListener("load",t=>{this.handleEvent(t,e)}),c.xhr.addEventListener("loadend",t=>{const a=e;l.a.isFunction(s)&&s(),this.handleEvent(t,a)}),c.xhr.addEventListener("progress",t=>{this.handleEvent(t,e)}),c.xhr.addEventListener("error",t=>{this.handleEvent(t,e)}),c.xhr.addEventListener("abort",t=>{this.handleEvent(t,e)}),c.xhr.addEventListener("readystatechange",t=>{this.uploadDone(t,e)}),c.xhr.open("POST",`${l.a.getApiServer()}${this.props.apiUrl}`),c.xhr.setRequestHeader("Authorization","Bearer "+l.a.getJwtToken()),c.xhr.send(i);const n=e.name,o=this.state.uploadedFilesData;o[n]||(o[n]={}),o[n].uploadMeta=c,o[n].imageNum=this.state.imageNum,this.setState({uploadedFilesData:o})},this.readLocalFile=e=>new Promise((t,a)=>{const s=new FileReader;s.addEventListener("error",e=>{a(e)}),s.addEventListener("load",a=>{const s=e,i=s.name,c=this.state.uploadedFilesData;c[i]||(c[i]={}),c[i].event=a,this.setState({uploadedFilesData:c}),this.handleUpload(s),t(a)}),s.readAsDataURL(e)}),this.updateProgress=(e,t)=>{if(e.lengthComputable){const a=t.name,s=this.state.uploadedFilesData,i=e.loaded/e.total*100;0,s[a].uploadMeta.progress=i,this.setState({uploadedFilesData:s})}},this.uploadDone=(e,t)=>{const a=t.name,s=this.state.uploadedFilesData,i=s[a].uploadMeta;if(i&&4===i.xhr.readyState&&201===i.xhr.status){const e=JSON.parse(i.xhr.responseText).data.files;for(let t=0;t<e.length;t+=1){this.addFileToUpload(e[t]),this.fileInput.value=""}}},this.state={drag:!1,loadingProgress:0,uploadedFiles:[],uploadedFilesData:{}}}addFileToUpload(e){const{uploadedFilesData:t}=this.state,{handleAddImage:a,uploadStatus:s=(()=>{})}=this.props;delete t[e.name],this.setState({uploadedFilesData:t}),a(e),s(!0)}componentDidMount(){const e=this.dropRef.current;e.addEventListener("dragenter",this.handleDragIn),e.addEventListener("dragleave",this.handleDragOut),e.addEventListener("dragover",this.handleDrag),e.addEventListener("drop",this.handleDrop);const{autoOpen:t}=this.props;t&&setTimeout(()=>{this.fileInput.click()},10)}componentWillUnmount(){const e=this.dropRef.current;e.removeEventListener("dragenter",this.handleDragIn),e.removeEventListener("dragleave",this.handleDragOut),e.removeEventListener("dragover",this.handleDrag),e.removeEventListener("drop",this.handleDrop)}render(){const{uploadedFilesData:e}=this.state;return Object(i.h)("div",{style:{position:"relative"},ref:this.dropRef},this.state.drag&&Object(i.h)("div",{style:{border:"dashed grey 4px",backgroundColor:"rgba(255,255,255,.8)",position:"absolute",top:0,bottom:0,left:0,right:0,zIndex:9999}},Object(i.h)("div",{style:{position:"absolute",top:"50%",right:0,left:0,textAlign:"center",color:"grey",fontSize:36}},Object(i.h)("div",null,Object(i.h)(n.c,{id:"imageupload.drag-files-here"},"drop your files here :)")))),Object(i.h)("div",null,Object(i.h)("input",{class:"btn btn-info col-sm-12",multiple:!0,type:"file",id:"image-file",onchange:this.handleAddFiles,ref:e=>{this.fileInput=e}})),Object(i.h)("div",null,Object.keys(e).length>0?Object(i.h)("h3",null,Object(i.h)(n.c,{id:"imageupload.upload-images"},"Uploaded images")):"",Object(i.h)("ul",{class:"list-group"},Object.keys(e).map(t=>{const{uploadMeta:a={}}=e[t],s=t.match(/(jpg|jpeg|png|gif|heic|heif|svg|webp|tif)/i);return Object(i.h)("li",{class:"list-group-item list-group-item-action flex-column align-items-start"},Object(i.h)("div",{class:"d-flex w-100 justify-content-between"},s&&Object(i.h)("img",{class:"img-fluid mr-3",src:e[t].event.target.result,style:"max-height: 50px;"}),Object(i.h)("small",null,e[t].event.uploadDone),Object(i.h)(n.c,{id:"imageupload.uploading-image"},"Laster opp bilde..."),Object(i.h)("small",null,l.a.formatBytes(e[t].event.total,2))),Object(i.h)("div",{class:"progress mt-1",style:"height: 4px;"},Object(i.h)("div",{class:"progress-bar progress-bar-striped progress-bar-animated bg-success",role:"progressbar",style:`width: ${a.progress}%; height: 4px;`,"aria-valuenow":a.progress,"aria-valuemin":"0","aria-valuemax":"100"})))}))),this.props.children)}})||s;t.a=o}}]);
//# sourceMappingURL=41.chunk.f7b4d.esm.js.map