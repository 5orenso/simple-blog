(window.webpackJsonp=window.webpackJsonp||[]).push([[88],{"5OWT":function(e){e.exports={hoverelementonly:"hoverelementonly__4nHll",hoverElement:"hoverElement__rkj2s",hoverelementhide:"hoverelementhide__10QkM"}},Eo9z:function(e,t,n){"use strict";n.r(t),function(e){function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function l(e,t){var n=void 0!==e.musher;return(void 0!==t.musher)-n||!0===n&&e.musher.bib-t.musher.bib||0}var i,c,u,d=n("hosL"),h=n("Utv1"),b=n("/eY4"),m=n("OhSV"),f=n("fh8t"),p=n.n(f),O=n("ZOvn"),j=n("ZQlJ"),g=(n("q/oJ"),n("gWxU"),n("Nanz"),n("5OWT"),O.a.marginTop(!0)),v=O.a.marginBottom(),y={isLoading:!1,contentIsNotLoaded:!0,reloadInSec:null,reloadLastEpoch:null,reloadIsActive:!1},w=(Object(b.a)(i=function(t){function n(e){var n;return(n=t.call(this,e)||this).initComponent=function(){var e=Math.floor((new Date).getTime()/1e3);n.setState({reloadIsActive:!0,reloadLastEpoch:e},(function(){return n.tickReloadTimeer()}))},n.state=o({},y),n.updateTimer={},n}a(n,t);var r=n.prototype;return r.tickReloadTimeer=function(){var e=this,t=this.state,n=t.reloadLastEpoch;if(t.reloadIsActive){var r=Math.floor((new Date).getTime()/1e3);this.setState({reloadInSec:60-(r-n)}),clearTimeout(this.updateTimer.tick),this.updateTimer.tick=setTimeout((function(){return e.tickReloadTimeer()}),1e3)}return!1},r.componentDidMount=function(){this.initComponent()},r.componentWillUnmount=function(){clearTimeout(this.updateTimer.tick)},r.render=function(){var t=Math.floor(h.a.normalizeBetween(this.state.reloadInSec,0,60,0,100));return Object(d.h)(e,null,Object(d.h)("div",{class:"progress fixed-top",style:"height: 2px; z-index: 999999;"},Object(d.h)("div",{class:"progress-bar",role:"progressbar",style:"width: "+t+"%;","aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})))},n}(d.Component)),Object(b.a)(c=function(t){function n(e){var n;return(n=t.call(this,e)||this).toggleAdminInfo=function(e){e.stopPropagation(),n.setState({showAdminInfo:!n.state.showAdminInfo})},n.toggleInfo=function(e){e.stopPropagation(),n.setState({showInfo:!n.state.showInfo})},n.state={},n}return a(n,t),n.prototype.render=function(){var t=this.state,n=t.showAdminInfo,r=t.showInfo,o=this.props,s=o.classid,a=o.bib,l=o.email,i=o.onTeamClick,c=o.onDogClick,u=this.props.stores,b=u.raceStore,f=u.userStore.isAdmin,g=a?b.getMusherByBibId(a):b.getMusherByBibEmail(l),v=b.getTeamById(g.team),y=v.members?v.members.find((function(e){return e.email===g.email})):{},w=b.getClassById(s),k=b.getTotalsByTeamId(g.team),T=O.a.getImage({user:y,team:v,priority:"user"}),x=O.a.displayNameShort(y)||O.a.displayNameShort(g),S=O.a.getRankingColor(g.bib);return Object(d.h)(e,null,Object(d.h)("div",{class:"d-flex position-relative"},Object(d.h)("div",{class:"position-relative text-center border rounded-circle imageRounded imageRoundedMedium",style:T?'background-image: url("'+T+'"); background-size: cover;':""},!T&&Object(d.h)("div",{class:"text-muted",style:"font-size: 25px; padding-top: 5px;"},x),Object(d.h)("div",{class:"rounded-pill-both px-2 text-center position-absolute "+(S?"":"bg-secondary")+" font-weight-bold",style:"bottom: -20px; right: 0; "+(S?"background-color: "+S+";":"")},g.bib&&"n/a"!==g.bib&&Object(d.h)(e,null,g.bib))),Object(d.h)("div",{class:"flex-grow-1 pl-3 text-overflow mb-3",style:"line-height: 1.2em;"},Object(d.h)("h6",{class:"font-weight-light mb-0"},w.title),Object(d.h)("h3",{class:"mb-0"},g.flag," ",g.firstname," ",g.lastname),Object(d.h)("h6",{class:"mb-0"},g.sportsClub))),v.public>0&&Object(d.h)(e,null,r?Object(d.h)(e,null,Object(d.h)("button",{class:"btn btn-link float-right",onClick:this.toggleInfo},Object(d.h)("i",{class:"fas fa-angle-up"})," ",Object(d.h)(m.c,{id:"races.hide-info"},"Hide info"))):Object(d.h)(e,null,Object(d.h)("button",{class:"btn btn-link float-right",onClick:this.toggleInfo},Object(d.h)("i",{class:"fas fa-angle-down"})," ",Object(d.h)(m.c,{id:"races.show-info"},"Show info"))),Object(d.h)("h3",null,v.public?Object(d.h)(e,null,Object(d.h)("a",{href:"/teams/public/"+v.uuidv4,onClick:function(e){return i(e,v.uuidv4)}},v.name)):Object(d.h)(e,null,v.name)),r&&Object(d.h)(e,null,Object(d.h)(p.a,{markdown:O.a.replaceImages(v.description,v.images),markdownOpts:O.a.getMarkdownOptions()})),v.dogs&&Object(d.h)("div",{class:"w-100 container-fluid"},Object(d.h)("div",{class:"row pt-2"},Object(d.h)(j.a,{stores:this.props.stores,dogs:v.dogs.map((function(e){return e.id})),allDogs:v.dogs,onDogClick:c})))),k&&k.distanceKm&&Object(d.h)(e,null,Object(d.h)("div",{class:"table-responsive-lg"},Object(d.h)("table",{class:"table table-borderless"},Object(d.h)("tbody",null,Object(d.h)("tr",null,Object(d.h)("td",{style:"width: 5%;"},Object(d.h)("i",{class:"fas fa-dog"})),Object(d.h)("td",{style:"width: 60%"},Object(d.h)(m.c,{id:"races.dogs"},"Dogs")),Object(d.h)("td",{style:"width: 5%;"}," "),Object(d.h)("td",{class:"text-right",style:"width: 30%;"},v.dogs.length)),Object(d.h)("tr",null,Object(d.h)("td",null,Object(d.h)("i",{class:"fas fa-road"})),Object(d.h)("td",null,Object(d.h)(m.c,{id:"races.distance"},"Distance")),Object(d.h)("td",null," "),Object(d.h)("td",{class:"text-right"},Object(d.h)("nobr",null,k.distanceKm?h.a.format(k.distanceKm,1)+" km":"n/a"))),Object(d.h)("tr",null,Object(d.h)("td",null,Object(d.h)("i",{class:"fas fa-mountain"})),Object(d.h)("td",null,Object(d.h)(m.c,{id:"races.ascend"},"Ascending")),Object(d.h)("td",null," "),Object(d.h)("td",{class:"text-right"},Object(d.h)("nobr",null,k.elevation?h.a.format(k.elevation,0)+" m":"n/a"))),Object(d.h)("tr",null,Object(d.h)("td",null,Object(d.h)("i",{class:"fas fa-stopwatch"})),Object(d.h)("td",null,Object(d.h)(m.c,{id:"races.race-time"},"Racetime")),Object(d.h)("td",null,Object(d.h)("i",{class:"fas fa-clock"})),Object(d.h)("td",{class:"text-right"},Object(d.h)("nobr",null,h.a.secToHms(k.duration)||"n/a"))),Object(d.h)("tr",null,Object(d.h)("td",null,Object(d.h)("i",{class:"fas fa-bed"})),Object(d.h)("td",null,Object(d.h)(m.c,{id:"races.rest-time"},"Rest")),Object(d.h)("td",null,Object(d.h)("i",{class:"fas fa-clock"})),Object(d.h)("td",{class:"text-right"},Object(d.h)("nobr",null,h.a.secToHms(k.rest)||"n/a"))))))),f&&Object(d.h)("div",{style:"max-height: 200px; max-width: 70vw; overflow: auto;"},Object(d.h)("button",{class:"btn btn-link btn-block",onClick:this.toggleAdminInfo},"Toggle admin info"),n&&Object(d.h)(e,null,Object(d.h)("small",null,Object(d.h)("xmp",null,JSON.stringify(g,null,4),JSON.stringify(y,null,4),JSON.stringify(v,null,4),JSON.stringify(k,null,4))))))},n}(d.Component)),Object(b.a)(u=function(t){function n(e){var n;return(n=t.call(this,e)||this).loadLiveRaceResults=function(e,t,r){return new Promise((function(o,s){var a;return void 0===e&&(e=n.props),a=e.stores.raceStore,Promise.resolve(a.getRaceTrackerData(a.race.raceTrackerRace)).then((function(){try{return a.getRaceTrackerActiveTeams(t,r),o()}catch(e){return s(e)}}),s)}))},n.loadRaceResults=function(e,t,r){return new Promise((function(o,s){var a;return void 0===e&&(e=n.props),a=e.stores.raceStore,Promise.resolve(a.loadWorkoutSummary(t,e.raceid)).then((function(){try{return a.getWorkoutSummaryActiveTeams(t,r),o()}catch(e){return s(e)}}),s)}))},n.loadRace=function(e){return new Promise((function(t,r){var o,s,a,l,i,c,u,d,h,b,m,f;return void 0===e&&(e=n.props),n.setState({isLoading:!0}),s=(o=e.stores).raceStore,a=o.appState,i=(l=e).classid,Promise.resolve(s.load(l.raceid)).then(function(){try{if(c=s.race,u=a.focusOnMushers,h=void 0===(d=a.selectedClassIds)?[]:d,b=i||h[0],i&&a.toggleSelectedClassId(i,!0),(m=c.classes.filter((function(e){return e.id===b})).filter((function(e){return e.contestants&&e.contestants.length>0})).map((function(e){return e.contestants.filter((function(e){return e.team>0})).map((function(e){return e.team}))})).flat()).length>0)return Promise.resolve(s.loadTeams(m.join(","))).then(function(){try{return o.call(this)}catch(e){return r(e)}}.bind(this),r);function o(){function o(){return s.getAllClassesSortedBy(),(f=s.getClassById(b))&&f.raceTrackerResults&&s.getRacetrackerResults(f.raceTrackerResults),clearTimeout(n.updateTimer.reload),n.updateTimer.reload=setTimeout((function(){return new Promise((function(t){var r=Math.floor((new Date).getTime()/1e3);return n.setState({reloadLastEpoch:r}),n.loadRace(e),t()}))}),6e4),n.setState({isLoading:!1}),t()}return c.liveRace>0?Promise.resolve(n.loadLiveRaceResults(n.props,m,u)).then(function(){try{return o.call(this)}catch(e){return r(e)}}.bind(this),r):Promise.resolve(n.loadRaceResults(n.props,m,u)).then(function(){try{return o.call(this)}catch(e){return r(e)}}.bind(this),r)}return o.call(this)}catch(e){return r(e)}}.bind(this),r)}))},n.toggleFocusOnMusher=function(e){var t=n.props.stores,r=t.appState,o=t.raceStore;r.toggleFocusOnMusher(e.target.parentElement.dataset.musherid||e.target.dataset.musherid);var s=r.focusOnMushers;o.race.liveRace>0?o.getRaceTrackerActiveTeams(null,s):o.getWorkoutSummaryActiveTeams(null,s)},n.handleMusherClick=function(e){var t=e.target.closest("tr").dataset.bib;n.setState({showModal:!n.state.showModal,modalBib:t})},n.toggleModal=function(){n.setState({showModal:!n.state.showModal})},n.state=o({},y),n.inputRef={},n.updateTimer={},n}a(n,t);var r=n.prototype;return r.componentWillUnmount=function(){clearTimeout(this.updateTimer.reload),clearTimeout(this.updateTimer.tick)},r.componentDidMount=function(){this.loadRace()},r.componentWillReceiveProps=function(e){this.props.classid!==e.classid&&this.loadRace(e)},r.render=function(){var t=this.state,n=t.modalBib,r=t.modalEmail,o=this.props.stores,s=o.raceStore,a=this.props,i=a.classid,c=a.limit,u=void 0===c?100:c,b=s.race,m=void 0===b?{}:b,f=s.classes,p=void 0===f?[]:f,j=s.raceTrackerResults,y=new Date(m.endDate);y.setHours(y.getHours()+2);var w=m.classes&&m.classes.find((function(e){return e.id===i}))||{},k=n?s.getMusherByBibId(n):s.getMusherByBibEmail(r),T=(s.getTeamById(k.team),[]);return j&&j.data?T=j.data.map((function(e){var t=s.raceTrackerMapLine(e),n=parseInt(t.Bib,10),r={};return p&&p[w.id].contestants&&(r=p[w.id].contestants.find((function(e){return e.musher.bib===n}))||{}),r})):p[w.id]&&p[w.id].contestants&&(T=p[w.id].contestants.sort(l).slice(0,u).map((function(e){return e}))),Object(d.h)(e,null,Object(d.h)("div",{class:"container-fluid",style:"margin-bottom: "+v+"; height: calc(100% - "+v+" - "+g+");"},Object(d.h)("div",{class:"row"},Object(d.h)("div",{class:"col-12 px-0 position-relative",style:"font-size: 1.5em; line-height: 1.0em;"},Object(d.h)("div",{class:"w-100 overflow-hidden"},Object(d.h)("div",{class:"d-flex flex-row flex-nowrap pb-2 px-1",style:"overflow: auto; scroll-snap-type: x mandatory;"},m.classes&&m.classes.sort((function(e,t){return e.distance-t.distance})).map((function(t,n){return Object(d.h)(e,null,Object(d.h)("div",{class:"col px-0 pt-2"},Object(d.h)("a",{type:"button",class:"btn btn-block "+(0===n&&"rounded-pill-left")+" "+(n===m.classes.length-1&&"rounded-pill-right")+" rounded-none "+(t.id===i?"btn-primary":"btn-outline-primary")+" text-nowrap",style:"text-overflow: ellipsis; overflow: hidden;","data-id":t.id,href:"/embed/agreement/"+m.id+"/"+t.id},t.title)))})))),Object(d.h)("table",{class:"table table-striped table-bordered"},Object(d.h)("thead",null,Object(d.h)("tr",null,Object(d.h)("td",{colspan:"2",class:"px-4 py-4 overflow-hidden",style:"border-radius: 10px 0 0 0; font-size: 1.4em;"},Object(d.h)("nobr",null,w.title)),Object(d.h)("td",{class:"px-3 text-center py-4 overflow-hidden",style:"border-radius: 0 10px 0 0 ; font-size: 1.1em;"},"Agreement"))),Object(d.h)("tbody",null,T&&T.map((function(t,n){var r=t.musher,o=void 0===r?{}:r,a=t.currentTeam;s.getTotalsByTeamId((void 0===a?{}:a).id);return Object(d.h)(e,null,Object(d.h)("tr",{style:"border-bottom: 1px solid #7B312F;"},Object(d.h)("td",{class:"text-center align-middle ml-0 pl-0",style:"width: 50px; color: #ffffff; font-size: 1.2em; line-height: 1.2em;"},Object(d.h)("div",{class:"d-flex justify-content-start"},Object(d.h)("div",{class:"pl-3 pr-2 w-100 clearfix rounded-pill-right",style:"background-color: "+O.a.getRankingColor(n+1)},o.bib||n+1))),Object(d.h)("td",{class:"px-3 py-3",style:"font-size: 1.2em;"},Object(d.h)("nobr",null,o.flag," ",o.firstname," ",o.lastname,Object(d.h)("br",null)),Object(d.h)("small",null,o.cellphone,Object(d.h)("br",null),o.address,Object(d.h)("br",null),o.postalcode,Object(d.h)("br",null),o.postalplace,Object(d.h)("br",null),o.country,Object(d.h)("br",null))),Object(d.h)("td",{class:"text-center align-middle",style:"width: 150px; font-size: 1.2em;"},o.declaration&&Object(d.h)(e,null,Object(d.h)("nobr",null,Object(d.h)("i",{class:"fas fa-check text-success"})," ",h.a.isoDate(o.declarationDate))))))}))))))))},n}(d.Component))||u);t.default=w}.call(this,n("hosL").Fragment)}}]);
//# sourceMappingURL=88.chunk.c506e.js.map