{"version":3,"sources":["webpack:///./components/feedback/likesAndComments.js","webpack:///./components/workout/commentAdd.js","webpack:///./components/imageSlider/index.js","webpack:///./components/dog/addlog.js","webpack:///./components/dog/dogs.js","webpack:///./components/workout/summary.js","webpack:///./components/workout/commentReply.js","webpack:///./components/dog/status.js","webpack:///./components/data/distance.js","webpack:///../node_modules/prop-types/lib/ReactPropTypesSecret.js","webpack:///./components/style.css","webpack:///./components/workout/index.js","webpack:///../node_modules/prop-types/factoryWithThrowingShims.js","webpack:///./components/data/temperature.js","webpack:///./components/modal/index.js","webpack:///./components/data/weight.js","webpack:///../node_modules/prop-types/index.js","webpack:///./components/dog/scroller.js","webpack:///./components/gauge/style.css","webpack:///./components/data/elevation.js","webpack:///../src/util.js","webpack:///../src/PureComponent.js","webpack:///../src/memo.js","webpack:///../src/forwardRef.js","webpack:///../src/suspense.js","webpack:///../src/suspense-list.js","webpack:///../src/portals.js","webpack:///../src/render.js","webpack:///../src/index.js","webpack:///../src/Children.js","webpack:///./routes/home/todo.js","webpack:///./components/data/speed.js","webpack:///./components/form/images.js","webpack:///./components/workout/comments.js","webpack:///./components/form/dragNdropFileupload.js","webpack:///./components/feedback/views.js","webpack:///./components/gauge/index.js","webpack:///./components/dog/history.js"],"names":["initialState","DisplayLikesAndComments","observer","Component","constructor","props","super","toggleLikes","showLikesList","this","state","setState","render","storyStore","teamStore","workoutStore","raceStore","stores","likes","comments","type","onTeamClick","onUserClick","class","length","style","onClick","slice","map","like","user","teams","publicTeam","findPublicUser","findPublicTeamByMembers","util","isArray","find","e","public","mu","getImage","team","priority","displayNameShort","name","displayName","href","uuidv4","title","id","fields","total","image","shortname","WorkoutAdd","beforeImagesUploaded","sendButtonEnabled","afterImagesUploaded","commentWorkout","async","callback","inputRefObject","workout","comment","showAddImage","response","status","body","images","resizeTextarea","addImage","addImages","value","push","handleImageErrored","target","onerror","setTimeout","src","Date","inputRef","col","offset","showAvatar","extraClass","userStore","firstname","ucfirst","lastname","email","userImage","undefined","s3SmallLink","for","placeholder","onInput","linkState","onKeyUp","onFocus","ref","data-id","disabled","img","onError","removeImage","data-name","object","updateField","before","after","autoOpen","touchStart","stopPropagation","startX","touches","pageX","touchEnd","sliding","touchMove","totalImages","scrollDistance","x","prevImage","nextImage","imageContainer","currentImage1","currentImage2","currentIdx","imageDots","Array","fill","y","nextImageContainer","nextIdx","componentWillReceiveProps","nextProps","nextImages","curImage","htmlImageRatio","height","width","imgHeight","imgWidth","dimensions","orientation","imageRatio","onTouchstart","onTouchend","onTouchmove","loading","s3LargeLink","c","image1","image2","i","VACCINE_TYPES","getVaccineTypes","showLog","okToAddLog","DogAddLog","toggleLog","resetLog","newHistory","date","isoDate","time","isoTime","dogs","obj","imageUploadStatus","insertLog","dogStore","dog","save","history","loadDog","loadFeed","isDefined","PubSub","publish","topics","STATUS_MESSAGE","message","icon","field","setHistoryType","language","HISTORY_TYPE_MAP","getHistoryMap","historyType","endDate","addDays","setVaccineType","vaccineType","duration","getFeed","componentWillMount","className","currentTeam","currentTeamId","findTeam","elementtype","help","filter","indexOf","aria-describedby","autocomplete","required","weight","bodyScore","cost","pattern","uploadStatus","getPlaceholder","newPlaceholder","unique","getTime","randomPassword","List","provided","snapshot","innerRef","children","droppableProps","isDraggingOver","borderStyle","Dog","removeThisPlaceholder","removePlaceholder","idx","list","draggableProps","dragHandleProps","isDragging","draggableStyle","userSelect","background","maxWidth","s3ThumbLink","filterby","get","Dogs","toggleDog","closest","dataset","dogId","parseInt","isNew","showPositions","toJS","action","splice","skipTimer","singleValue","filterText","dndDogs","findAllDogsInTeams","selectedTeams","some","r","addAllDogsInTeam","allDogsInTeam","dogFilter","allDogs","filterLeft","a","dogsRight","filterRight","dogsLeft","defaultDogsRight","n","Math","ceil","defaultDogsLeft","idxLeft","findIndex","idxRight","dogPositionUpdated","updateDogPositions","addPlaceholderLeft","addPlaceholderRight","clearAllDogs","resetDogPositions","toggleSearchField","showSearchField","getList","onDragEnd","result","source","destination","droppableId","items","startIndex","endIndex","from","removed","reorder","index","droppableSource","droppableDestination","sourceClone","destClone","move","datatype","clearDogPositions","changeFilter","set","getFilteredDogs","match","RegExp","getNestedValue","filteredDogs","load","query","deceased","addData","componentDidMount","saved","teamNames","selected","dogStatus","findDogstatus","dogPosition","findDogposition","position","dogHistoryStatuses","findHistoryStatuses","format","findHarness","harness","birth","age","gender","specialNeeds","v","key","draggableId","summary","week","year","count","distanceKm","elevation","secToHms","speedAvg","WorkoutCommentReply","commentId","commentReplyWorkout","showWorkout","showInfo","hideTeam","fullWidth","daysBack","filterBy","workoutPlanStore","dogStatuses","statuses","workoutSummary","findCurrentWorkoutSummary","currentWeek","getWeek","currentYear","getYear","currentMonth","getMonth","seasonStart","planWeek","sumWorkoutPlanDaysBack","completedWeek","hasBirthday","hasWorkoutPlan","percentComplete","radius","heightAdd","showPercentText","percent","prefix","totalY","completed","completedY","positions","lead","point","wheel","displayDistance","distance","Distance","smallUnit","settings","imperial","kmToMiles","module","exports","getWorkoutColor","getWorkoutIcon","MAX_LOADINDEX","getMaxLoadIndex","showAddComment","viewImageIdx","likeWorkout","Workout","toggleDate","preventDefault","showDate","workoutId","toggleAddComment","parentElement","focus","viewImage","shareLink","url","text","appState","shareUrl","teamid","showTeam","onDogClick","dogid","showDog","hideDog","updateTimer","forceShowDate","wrapperClasses","wrapperClassesRow","viewmode","hasShareApi","intensity","findIntensity","code","teamName","forEach","hasLikedWorkout","gpxInfo","mushers","loadIndex","workoutEquipment","findEquipment","equipment","workoutEquipmentIcon","musherImages","musher","u","publicUser","mapImage","imgs","batteryUsage","battegryLevelStart","battegryLevelEnd","views","getViews","statistics","marginTop","marginBottom","back","temperature","isLocked","isInProgress","role","formatDate","locale","hour12","hour","minute","formatDistance","getLoadIndexColor","normalizeBetween","floor","getLoadIndexText","garminId","stravaId","track","sledWeight","kcalBurnedTotal","kcalMeatGramsTotal","kcalSalmonGramsTotal","kcalFatGramsTotal","description","markdown","replaceImages","markdownOpts","getMarkdownOptions","avgGpsMovingSpeed","dblClick","likeRef","data-url","data-title","rel","data-native","compact","isTeamAdmin","isAdmin","emptyFunction","emptyFunctionWithReset","ReactPropTypesSecret","require","resetWarningCache","shim","propName","componentName","location","propFullName","secret","err","Error","getShim","isRequired","ReactPropTypes","array","bool","func","number","string","symbol","any","arrayOf","element","elementType","instanceOf","node","objectOf","oneOf","oneOfType","shape","exact","checkPropTypes","PropTypes","Temperature","celciusToFahrenheit","Modal","startY","pageY","readyToRefresh","close","refreshing","appContainer","scrollTop","imagexxl","thumb","download","Weight","kgToPounds","DogScroller","scrollImages","scrollLeft","clientWidth","imageIdx","nearestInt","round","diff","abs","Number","isInteger","sortByName","b","dogA","dogB","size","onScroll","sort","d","showName","showPosition","Elevation","meterToFeet","assign","shallowDiffers","PureComponent","p","memo","comparer","shouldUpdate","updateRef","call","current","Memoed","shouldComponentUpdate","createElement","prototype","isReactComponent","forwardRef","fn","Forwarded","clone","$$typeof","REACT_FORWARD_SYMBOL","detachedClone","vnode","effect","removeOriginal","Suspense","_suspenders","suspended","component","lazy","loader","error","Lazy","prom","then","default","SuspenseList","_next","_map","ContextProvider","getChildContext","context","Portal","_this","container","_container","componentWillUnmount","_temp","nodeType","parentNode","childNodes","appendChild","child","insertBefore","removeChild","createPortal","parent","textContent","preactRender","hydrate","preactHydrate","empty","isPropagationStopped","cancelBubble","isDefaultPrevented","defaultPrevented","createFactory","bind","isValidElement","REACT_ELEMENT_TYPE","cloneElement","preactCloneElement","apply","arguments","unmountComponentAtNode","findDOMNode","base","isPureReactComponent","oldDiffHook","options","Symbol","mapFn","toChildArray","Children","only","normalized","toArray","oldCatchError","newVNode","oldVNode","promise","suspendingVNode","suspendingComponent","resolve","resolved","onResolved","onSuspensionComplete","pop","forceUpdate","wasHydrating","fallback","Fragment","delete","revealOrder","delegated","wrappedUnsuspend","unsuspend","Map","reverse","componentDidUpdate","CAMEL_PROPS","onChangeInputType","test","Object","defineProperty","configurable","writable","oldEventHook","event","persist","nativeEvent","currentComponent","classNameDescriptor","oldVNodeHook","normalizedProps","toLowerCase","replace","multiple","defaultValue","enumerable","oldBeforeRender","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","ReactCurrentDispatcher","readContext","version","unstable_batchedUpdates","arg","StrictMode","useState","useReducer","useEffect","useLayoutEffect","useRef","useImperativeHandle","useMemo","useCallback","useContext","useDebugValue","createContext","createRef","MARGIN_TOP","MARGIN_BOTTOM","SUB_MENU_MARGIN_TOP","subMenuMarginTop","isLoading","Home","loadDogs","loadAll","darkmode","dogsMaturity","findDogsByStatus","dogsWithStatus","dogsWithNeeds","findDogsWithNeeds","Speed","kmtToMph","Images","handleAddImage","file","addToImages","files","apiUrl","showAllComments","showAllReplies","WorkoutComments","likeComment","likeWorkoutComment","likeReply","replyId","likeWorkoutCommentReply","replyComment","toggleComments","toggleReplies","translate","replyid","commentid","showOriginal","translatedText","translateCommentReply","translateComment","currentUser","max_comments","filteredComments","totalComments","diplayedComments","max","hasLikedComment","filteredReplises","totalReplies","diplayedReplies","currentImage","currentLocationGeocode","translation","getCommentTranslations","targetLang","t","data-idx","data-commentid","createdDate","updatedDate","formatted_address","reply","hasLikedReply","replyTranslation","getCommentReplyTranslations","replyBody","data-comment","data-replyid","more","DragNDropFileupload","dropRef","handleDrag","handleDragIn","dragCounter","dataTransfer","drag","handleDragOut","handleDrop","l","readLocalFile","handleAddFiles","el","handleEvent","handleUpload","fileObject","isFunction","formData","FormData","append","uploadMeta","progress","xhr","XMLHttpRequest","upload","addEventListener","updateProgress","fileObj","uploadDone","open","getApiServer","setRequestHeader","getJwtToken","send","filename","uploadedFilesData","imageNum","Promise","reject","reader","FileReader","photo","readAsDataURL","lengthComputable","loaded","readyState","JSON","parse","responseText","data","addFileToUpload","fileInput","loadingProgress","uploadedFiles","div","click","removeEventListener","border","backgroundColor","top","bottom","left","right","zIndex","textAlign","color","fontSize","onchange","keys","isImage","formatBytes","aria-valuenow","aria-valuemin","aria-valuemax","toggleViews","showViewList","viewUsersArrays","entries","yearObject","weekObject","viewUsers","flat","userId","mouseData","Gauge","svgRef","showCenterText","centerText","centerTextSize","centerTextX","centerTextY","totalX","totalTextAnchor","completedX","completedTextAnchor","strokeWidth","innerRadius","strokeWidthGauge","circumference","PI","arc","dashArray","transform","min","textSize","textSizeSmall","xmlns","svg","preserveAspectRatio","gaugeBackground","cx","cy","strokeDasharray","strokeLinecap","gauge","stroke","strokeDashoffset","transition","gaugeText","dominant-baseline","text-anchor","font-size","secondary","DogHistoryLine","showModal","displayModal","currentImageXXL","closeModal","eventFired","diffY","diffX","deleteVerify","reset","deleted","deleteHistoryRequest","deleteHistory","line","$pull","_id","swipeLeft","hasImage","isBeeingEdited","hoverElement","hoverelementonly","grouped","dogImage","dogShortname","dogName"],"mappings":"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","file":"64.chunk.9ecc4.esm.js","sourcesContent":["import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nconst initialState = {};\n\nconst MAX_USERS_TO_DISPLAY = 1;\n\n@observer\nclass DisplayLikesAndComments extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n    toggleLikes = () => {\n        const { showLikesList } = this.state;\n        this.setState({\n            showLikesList: !showLikesList,\n        });\n    }\n\n    render() {\n        const { showLikesList } = this.state;\n        const { storyStore, teamStore, workoutStore, raceStore } = this.props.stores;\n        const { likes, comments, type = 'story', onTeamClick = () => {}, onUserClick = () => {} } = this.props;\n\t\treturn (<>\n            <div class='d-flex justify-content-between mb-2'>\n                {likes && likes.length > 0 && <>\n                    <div class='d-flex flex-row flex-nowrap position-relative mr-3' style='overflow: auto;'>\n                        <span\n                            class='text-muted mr-2'\n                            onClick={this.toggleLikes}\n                        >\n                            <i class='fas fa-thumbs-up text-primary' /> {likes.length}\n                        </span>\n                        {likes.slice(0, MAX_USERS_TO_DISPLAY).map((like) => {\n                            let user;\n                            let teams;\n                            if (type === 'story') {\n                                user = storyStore.findPublicUser(like.user);\n                                teams = storyStore.findPublicTeamByMembers(like.user);\n                            } else if (type === 'team') {\n                                user = teamStore.findPublicUser(like.user);\n                                teams = teamStore.findPublicTeamByMembers(like.user);\n                            } else if (type === 'workout') {\n                                user = workoutStore.findPublicUser(like.user);\n                                teams = workoutStore.findPublicTeamByMembers(like.user);\n                            } else if (type === 'race') {\n                                user = raceStore.findPublicUser(like.user);\n                                teams = raceStore.findPublicTeamByMembers(like.user);\n                            }\n                            let publicTeam;\n                            if (util.isArray(teams)) {\n                                publicTeam = teams.find(e => e.public === 1);\n                            }\n                            const image = mu.getImage({ user, team: publicTeam, priority: 'user' });\n                            const shortname = mu.displayNameShort(user);\n                            const name = mu.displayName(user);\n                            return (<>\n                                <span class='font-weight-lighter'>\n                                    {publicTeam ? <>\n                                        <a href={`/teams/public/${publicTeam.uuidv4}`} title={publicTeam.name} onClick={(e) => onTeamClick(e, publicTeam.uuidv4)}>\n                                            {name}\n                                        </a>\n                                    </> : <>\n                                        {name}\n                                    </>}\n                                </span>\n                            </>);\n                            // return (<>\n                            //     {publicTeam ? <>\n                            //         <a href={`/teams/public/${publicTeam.uuidv4}`} title={publicTeam.name} onClick={(e) => onTeamClick(e, publicTeam.uuidv4)}>\n                            //             <div\n                            //                 class={`text-center border rounded-circle imageRounded imageRoundedThumb`}\n                            //                 style={`${image ? `background-image: url(\"${image}\"); background-size: cover;` : ''}`}\n                            //             >\n                            //                 {!image && <div class='' style='font-size: 12px; padding-top: 3px;'>{shortname}</div>}\n                            //             </div>\n                            //         </a>\n                            //     </> : <>\n                            //         <div\n                            //             class={`text-center border rounded-circle imageRounded imageRoundedThumb`}\n                            //             style={`${image ? `background-image: url(\"${image}\"); background-size: cover;` : ''} opacity: 0.5;`}\n                            //         >\n                            //             {!image && <div class='text-muted' style='font-size: 12px; padding-top: 3px;'>{shortname}</div>}\n                            //         </div>\n                            //     </>}\n                            // </>);\n                        })}\n                        {likes.length > MAX_USERS_TO_DISPLAY && <>\n                            <span class='text-muted font-weight-lighter ml-2' onClick={this.toggleLikes}>\n                                <Text id='likes-comments.and' fields={{ total: likes.length - MAX_USERS_TO_DISPLAY }}>and {likes.length - MAX_USERS_TO_DISPLAY} others.</Text>\n                            </span>\n                        </>}\n                    </div>\n                </>}\n\n                {comments && comments.length > 0 && <span class='float-right text-muted'>\n                    <i class='fas fa-comment text-primary' /> {comments.length}\n                </span>}\n            </div>\n            {showLikesList && <div class='mt-3 mb-3'>\n                {likes && likes.map((like) => {\n                    let user;\n                    let teams;\n                    if (type === 'story') {\n                        user = storyStore.findPublicUser(like.user);\n                        teams = storyStore.findPublicTeamByMembers(like.user);\n                    } else if (type === 'team') {\n                        user = teamStore.findPublicUser(like.user);\n                        teams = teamStore.findPublicTeamByMembers(like.user);\n                    } else if (type === 'workout') {\n                        user = workoutStore.findPublicUser(like.user);\n                        teams = workoutStore.findPublicTeamByMembers(like.user);\n                    } else if (type === 'race') {\n                        user = raceStore.findPublicUser(like.user);\n                        teams = raceStore.findPublicTeamByMembers(like.user);\n                    }\n                    let publicTeam;\n                    if (util.isArray(teams)) {\n                        publicTeam = teams.find(e => e.public === 1);\n                    }\n                    const image = mu.getImage({ user, team: publicTeam, priority: 'user' });\n                    const shortname = mu.displayNameShort(user);\n                    const name = mu.displayName(user, true);\n                    return (<div class='d-flex flex-row position-relative font-weight-light mb-1'>\n                        {publicTeam ? <>\n                            <a href={`/teams/public/${publicTeam.uuidv4}`} title={publicTeam.name} onClick={(e) => onTeamClick(e, publicTeam.uuidv4)} class='stretched-link'>\n                                <div\n                                    class={`text-center border rounded-circle imageRounded imageRoundedThumb`}\n                                    style={`${image ? `background-image: url(\"${image}\"); background-size: cover;` : ''}`}\n                                >\n                                    {!image && <div class='' style='font-size: 12px; padding-top: 3px;'>{shortname}</div>}\n                                </div>\n                            </a>\n                            <div class='ml-2 '>\n                                {name} <span class='font-weight-lighter'>- {publicTeam.name}</span>\n                            </div>\n                        </> : <>\n                            <div\n                                class={`text-center border rounded-circle imageRounded imageRoundedThumb`}\n                                style={`${image ? `background-image: url(\"${image}\"); background-size: cover;` : ''} opacity: 0.5;`}\n                            >\n                                {!image && <div class='text-muted' style='font-size: 12px; padding-top: 3px;'>{shortname}</div>}\n                            </div>\n                            <div class='ml-2'>\n                                {name}\n                            </div>\n                        </>}\n                    </div>);\n                })}\n            </div>}\n\t\t</>);\n\t}\n}\n\nexport default DisplayLikesAndComments;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer, withText } from 'preact-i18n';\nimport linkState from 'linkstate';\n\nimport Images from '../form/images';\n\nimport style from '../style.css';\nimport mu from '../../lib/musher-util';\n\n@observer\nclass WorkoutAdd extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            comment: {\n                body: '',\n                images: [],\n            },\n            showAddImage: false,\n            sendButtonEnabled: true,\n        };\n        this.inputRef = {};\n    }\n\n    beforeImagesUploaded = () => {\n        this.setState({ sendButtonEnabled: false });\n    }\n\n    afterImagesUploaded = () => {\n        this.setState({ sendButtonEnabled: true });\n    }\n    \n    commentWorkout = async () => {\n        const { sendButtonEnabled } = this.state;\n        if (!sendButtonEnabled) {\n            return false;\n        }\n        const { callback = () => {}, inputRefObject = {} } = this.props;\n        const { workout } = this.props;\n\t\tconst { workoutStore } = this.props.stores;\n        const { comment, showAddImage } = this.state;\n        this.setState({ sendButtonEnabled: false });\n\t\tconst response = await workoutStore.commentWorkout({ id: workout.id, comment });\n\t\tif (response && response.status === 200) {\n            this.setState({\n                comment: {\n                    body: '',\n                    images: [],\n                },\n            }, () => {\n                mu.resizeTextarea(inputRefObject[workout.id]);\n                if (showAddImage) {\n                    this.addImage();\n                }\n            });\n            callback({ workout, response });\n\t\t}\n        this.setState({ sendButtonEnabled: true });\n\t}\n\n    addImages = ({ value }) => {\n        // updateField({ id: object.id, field: 'images', value: images, skipTimer: true });\n        const { comment } = this.state;\n        comment.images.push(...value);\n        this.setState({ comment });\n    }\n\n    addImage = () => {\n        const { showAddImage = false } = this.state;\n        this.setState({\n            showAddImage: !showAddImage,\n        });\n    }\n\n    handleImageErrored = (e) => {\n        const image = e.target;\n        image.onerror = null;\n        setTimeout(() => {\n            image.src += `?${new Date()}`;\n        }, 1000);\n    }\n\n    render() {\n        const { inputRef, col = 12, offset = 0, showAvatar = true, extraClass = '', workout } = this.props;\n        const { comment, showAddImage, sendButtonEnabled } = this.state;\n        const { userStore } = this.props.stores;\n        const { user = {} } = userStore;\n        const displayNameShort = user.firstname ? `${util.ucfirst(user.firstname, true)}${util.ucfirst(user.lastname, true)}` : `${util.ucfirst(user.email || '', true)}`;\n        // const displayName = user.firstname ? `${user.firstname} ${user.lastname}` : `${user.email}`;\n        const userImage = user.image || (user.images ? user.images[0] : undefined);\n\n        return (\n            <div class={`col-${col} offset-${offset} ${extraClass}`}>\n                <div class='d-flex mb-0 position-relative w-100'>\n                    {showAvatar && <div \n                        class={`text-center border rounded-circle imageRounded imageRoundedSmall`}\n                        style={`${userImage ? `background-image: url('${userImage.s3SmallLink}'); background-size: cover;` : ''} border-width: 3px !important;`}\n                    >\n                        {!user.image && <span class='font-weight-lighter' style='font-size: 15px;'>{displayNameShort}</span>}\n                    </div>}\n                    <div class='col pl-3' style='line-height: 1.2em;'>\n\n                        <div class='d-flex bd-highlight'>\n                            <div class='p-0 w-100 bd-highlight'>\n                                <label class='sr-only' for='inlineFormInput'><Text id='comments.comment'>Kommentar</Text></label>\n                                <div class='border rounded rounded-lg position-relative'>\n                                    <Localizer>\n                                        <textarea\n                                            class='form-control-plaintext px-2'\n                                            type='text'\n                                            placeholder={<Text id='comments.write-comment'>Skriv en kommentar...</Text>}\n                                            onInput={linkState(this, 'comment.body')}\n                                            onKeyUp={mu.resizeTextarea}\n                                            onFocus={mu.resizeTextarea}\n                                            style='height: 2.3em;'\n                                            value={comment.body}\n                                            ref={inputRef}\n                                        />\n                                    </Localizer>\n                                    <div class='position-absolute' style='top: 8px; right: 10px; font-size: 1.2em;'>\n                                        <i class='fas fa-image pointerCursor'\n                                            data-id={workout.id}\n                                            onClick={this.addImage}\n                                        />\n                                    </div>\n                                </div>\n                            </div>\n                            <div class='p-0 pl-2 flex-shrink-1 bd-highlight'>\n                                <button type='button' class={`btn btn-${sendButtonEnabled ? 'primary' : 'secondary'} mb-2`} disabled={!sendButtonEnabled}\n                                    onClick={this.commentWorkout}\n                                ><i class='fas fa-paper-plane' /></button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                {showAddImage && <>\n                    <div class='col-12 text-center'>\n                        <div class='container-fluid'>\n                            <div class='row'>\n                                {comment.images && comment.images.map(img => (\n                                    <div class='col-3 p-1'>\n                                        <img src={img.s3SmallLink} class='img-fluid' onError={this.handleImageErrored} />\n                                        <button class='btn btn-sm btn-link'\n                                            onClick={this.removeImage}\n                                            data-name={img.name}\n                                        ><i class='fas fa-trash' />  <Text id='comments.remove-image'>Remove</Text></button>\n                                    </div>\n                                ))}\n                            </div>\n                        </div>\n                        <Images object={comment} updateField={this.addImages} before={this.beforeImagesUploaded} after={this.afterImagesUploaded} autoOpen={true} />\n                    </div>\n                </>}\n            </div>\n        );\n    }\n}\n\nexport default WorkoutAdd;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\n\n@observer\nclass ImageSlider extends Component {\n    constructor(props) {\n        super(props);\n        const { images = [] } = props;\n        this.state = {\n            imageContainer: 1,\n            currentImage1: images[0] || {},\n            currentImage2: {},\n            currentIdx: 0,\n            totalImages: images.length || 0,\n            imageDots: [...Array(images.length || 0).fill(1).map((x, y) => x + y)],\n        };\n    }\n\n    nextImage() {\n        // console.log('next');\n        const { images } = this.props;\n        const { totalImages, currentIdx, imageContainer } = this.state;\n        const nextImageContainer = imageContainer === 1 ? 2 : 1;\n        let nextIdx = currentIdx + 1;\n        if (nextIdx > totalImages -1) {\n            nextIdx = 0;\n        }\n        this.setState({\n            [`currentImage${nextImageContainer}`]: images[nextIdx],\n            currentIdx: nextIdx,\n            imageContainer: nextImageContainer,\n        });\n    }\n\n    prevImage() {\n        // console.log('prev');\n        const { images } = this.props;\n        const { totalImages, currentIdx, imageContainer } = this.state;\n        const nextImageContainer = imageContainer === 1 ? 2 : 1;\n        let nextIdx = currentIdx - 1;\n        if (nextIdx < 0) {\n            nextIdx = totalImages - 1;\n        }\n        this.setState({\n            [`currentImage${nextImageContainer}`]: images[nextIdx],\n            currentIdx: nextIdx,\n            imageContainer: imageContainer === 1 ? 2 : 1,\n        });\n    }\n\n    touchStart = (e) => {\n        e.stopPropagation();\n        this.setState({\n            startX: e.touches[0].pageX,\n        })\n    }\n\n    touchEnd = (e) => {\n        e.stopPropagation();\n        this.setState({\n            startX: undefined,\n            sliding: false,\n        })\n    }\n\n    touchMove = (e) => {\n        e.stopPropagation();\n        // e.preventDefault();\n        const { totalImages } = this.state;\n        if (totalImages > 1) {\n            const { startX, sliding } = this.state;\n            const scrollDistance = 50;\n            const x = e.touches[0].pageX;\n            if (!sliding) {\n                if (x > startX + scrollDistance) {\n                    this.setState({ sliding: true })\n                    this.prevImage();\n                } else if (x < startX - scrollDistance) {\n                    this.setState({ sliding: true })\n                    this.nextImage();\n                }\n            }\n        }\n    }\n\n    componentWillReceiveProps(nextProps) {\n        // console.log('componentWillReceiveProps', nextProps);\n        if (nextProps.images !== this.props.images) {\n            const { images: nextImages = [] } = nextProps;\n            this.setState({\n                imageContainer: 1,\n                currentImage1: nextImages.length > 0 ? nextImages[0] : {},\n                currentImage2: {},\n                currentIdx: 0,\n                totalImages: nextImages.length || 0,\n                imageDots: [...Array(nextImages.length || 0).fill(1).map((x, y) => x + y)],\n            });\n        }\n    }\n\n    render() {\n        const { currentImage1, currentImage2, imageContainer, totalImages, imageDots, currentIdx } = this.state;\n        const img = this[`image${imageContainer}`];\n        const curImage = imageContainer === 1 ? currentImage1 : currentImage2;\n        const htmlImageRatio = img && img.height ? img.width / img.height : 4 / 3;\n        let imgHeight;\n        let imgWidth;\n        if (curImage.dimensions) {\n            const { width, height, orientation } = curImage.dimensions;\n            if (orientation > 4 && orientation < 9) {\n                imgHeight = width;\n                imgWidth = height;\n            } else {\n                imgHeight = height;\n                imgWidth = width;\n            }\n        }\n        const imageRatio = curImage.dimensions ? imgWidth / imgHeight : htmlImageRatio;\n        if (totalImages <= 0) {\n            return '';\n        }\n\n        return (\n            <div class='w-100'>\n                <div class='border rounded position-relative w-100'\n                    style={`height: calc(85vw / ${imageRatio}); overflow: hidden; transition: all .3s ease-in-out;`}\n                    onTouchstart={this.touchStart}\n                    onTouchend={this.touchEnd}\n                    onTouchmove={this.touchMove}\n                >\n                    {totalImages > 1 && <span class='position-absolute' style='top:0px; right: 5px; z-index: 2000;'><small>{currentIdx + 1}/{totalImages}</small></span>}\n                    {currentImage1 && <div class='position-absolute' style={`${imageContainer === 1 ? 'opacity: 1;' :  'opacity: 0;'} transition: all .3s ease-in-out; top: 0; left: 0;`}>\n                        <img loading='lazy' src={currentImage1.s3LargeLink}\n                            class='img-fluid align-middle'\n                            ref={c => this.image1 = c}\n                        />\n                    </div>}\n                    {currentImage2 && <div class='position-absolute' style={`${imageContainer === 2 ? 'opacity: 1;' :  'opacity: 0;'} transition: all .3s ease-in-out; top: 0; left: 0;`}>\n                        <img loading='lazy' src={currentImage2.s3LargeLink}\n                            class='img-fluid align-middle'\n                            ref={c => this.image2 = c}\n                        />\n                    </div>}\n                </div>\n                {imageDots.length > 1 && <div class='w-100 text-center'>{imageDots.map(i => <span style={`color: ${i === currentIdx + 1 ? '#ffffff' : '#808080'};`}>&bull;</span>)}</div>}\n            </div>\n        );\n    }\n}\n\nexport default ImageSlider;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { toJS } from 'mobx';\nimport linkState from 'linkstate';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nconst VACCINE_TYPES = mu.getVaccineTypes();\n\nimport PubSub, { topics } from '../../lib/pubsub';\nimport Images from '../../components/form/images';\nimport Dogs from '../../components/dog/dogs';\n\nconst initialState = {\n\tshowLog: false,\n\tokToAddLog: true,\n};\n\n@observer\nclass DogAddLog extends Component {\n\tconstructor(props) {\n        super(props);\n        this.state = {\n\t\t\tnewHistory: {\n\t\t\t\tdate: util.isoDate(new Date(), false, false, true),\n\t\t\t\ttime: util.isoTime(new Date()),\n                dogs: [],\n\t\t\t},\n\t\t\t...initialState,\n        };\n    }\n\n\tasync loadDog(props = this.props) {\n        const { dog } = props;\n        if (dog && dog.id) {\n            const { newHistory } = this.state;\n            newHistory.dogs = [dog.id];\n            this.setState({ newHistory });\n        }\n    }\n\n    async loadFeed() {\n\t\tconst { userStore } = this.props.stores;\n        await userStore.getFeed({});\n    }\n\n\ttoggleLog = () => {\n\t\tconst { showLog } = this.state;\n\t\tthis.setState({\n            showLog: !showLog,\n        });\n\t}\n\n\tresetLog = () => {\n\t\tthis.setState({\n\t\t\tnewHistory: {\n\t\t\t\tdate: util.isoDate(new Date(), false, false, true),\n\t\t\t\ttime: util.isoTime(new Date()),\n                dogs: [],\n\t\t\t},\n\t\t\tshowLog: false,\n\t\t});\n\t}\n\n\taddImages = (obj) => {\n\t\t// updateField({ id: object.id, field, value: file });\n\t\t// console.log('addImages', obj.value);\n\t\tif (Array.isArray(obj.value)) {\n\t\t\tconst { newHistory } = this.state;\n\t\t\tif (Array.isArray(newHistory.images)) {\n\t\t\t\tnewHistory.images = [...newHistory.images, ...obj.value];\n\t\t\t} else {\n\t\t\t\tnewHistory.images = obj.value;\n\t\t\t}\n\t\t\tthis.setState({ newHistory });\n\t\t}\n\t}\n\n\thandleImageErrored = (e) => {\n        const image = e.target;\n        image.onerror = null;\n        setTimeout(() => {\n            image.src += `?${new Date()}`;\n        }, 1000);\n    }\n\n\timageUploadStatus = (status) => {\n\t\tthis.setState({ okToAddLog: status });\n\t}\n\n\tinsertLog = async () => {\n\t\tconst { newHistory } = this.state;\n\t\tconst { dogStore, userStore } = this.props.stores;\n\t\tconst { callback } = this.props;\n\t\tconst { dog } = dogStore;\n\t\tconst { user } = userStore;\n\n\t\tif (!newHistory.title && !newHistory.comment) {\n\t\t\tPubSub.publish(topics.STATUS_MESSAGE, {\n\t\t\t\tmessage: 'Mangler tittel på logginnlegg',\n\t\t\t\ttype: 'warning',\n\t\t\t\ticon: 'fas fa-exclamation-triangle',\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!newHistory.id && newHistory.dogs.length === 0) {\n\t\t\tPubSub.publish(topics.STATUS_MESSAGE, {\n\t\t\t\tmessage: 'Mangler hunder til logginnlegg',\n\t\t\t\ttype: 'warning',\n\t\t\t\ticon: 'fas fa-exclamation-triangle',\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tnewHistory.date = `${newHistory.date} ${newHistory.time}`;\n\t\tawait dogStore.save({\n\t\t\tid: dog.id || newHistory.dogs[0],\n\t\t\thistory: {\n\t\t\t\tuser: {\n\t\t\t\t\tid: user.id,\n\t\t\t\t\temail: user.email,\n\t\t\t\t\tfirstname: user.firstname,\n\t\t\t\t\tlastname: user.lastname,\n\t\t\t\t},\n\t\t\t\t...newHistory,\n\t\t\t},\n\t\t});\n        this.resetLog();\n\t\tawait this.loadDog();\n        await this.loadFeed();\n\t\tif (util.isDefined(callback)) {\n\t\t\tcallback();\n\t\t}\n\t}\n\n\n    updateField = ({ id, field, value, type, elementtype, isNew }) => {\n        const { newHistory } = this.state;\n        newHistory[field] = value;\n        this.setState({ newHistory });\n    }\n\n\tsetHistoryType = (e) => {\n\t\tconst { userStore } = this.props.stores;\n        const { user } = userStore;\n        const { language = 'en' } = user;\n        const HISTORY_TYPE_MAP = mu.getHistoryMap(language);\n\n\t\tconst { newHistory } = this.state;\n\t\tconst value = e.target.value;\n\t\tnewHistory.historyType = value;\n\t\tif (!newHistory.title) {\n\t\t\tnewHistory.title = HISTORY_TYPE_MAP[value];\n\t\t}\n\t\tif (newHistory.historyType === 'maturity') {\n\t\t\tnewHistory.endDate = util.isoDate(util.addDays(newHistory.date, 7 * 3), false, false, true);\n\t\t}\n\t\tif (newHistory.historyType === 'mating' || newHistory.historyType === 'unwantedMating') {\n\t\t\tnewHistory.endDate = util.isoDate(util.addDays(newHistory.date, 63), false, false, true);\n\t\t}\n\t\tthis.setState({ newHistory });\n\t}\n\n\tsetVaccineType = (e) => {\n\t\tconst { newHistory } = this.state;\n\t\tconst value = e.target.value;\n\t\tnewHistory.vaccineType = value;\n\t\tnewHistory.title += ` - ${VACCINE_TYPES[value].name}`;\n\t\tnewHistory.endDate = util.isoDate(util.addDays(newHistory.date, VACCINE_TYPES[value].duration), false, false, true);\n\t\tthis.setState({ newHistory });\n\t}\n\n    componentWillMount() {\n        this.resetLog();\n        this.loadDog();\n    }\n\n    componentWillReceiveProps(nextProps) {\n        // console.log('componentWillReceiveProps', nextProps);\n        if (nextProps.dog.id !== this.props.dog.id) {\n            this.resetLog();\n            this.loadDog(nextProps);\n        }\n    }\n\n\trender() {\n\t\tconst { newHistory, showLog, okToAddLog } = this.state;\n\t\tconst { dog, className = 'btn-sm btn-secondary float-left' } = this.props;\n\t\tconst { workoutStore, userStore } = this.props.stores;\n\t\tconst { currentTeam: currentTeamId } = workoutStore;\n        const currentTeam = userStore.findTeam(currentTeamId, true);\n\n\t\tif (showLog) {\n\t\t\treturn (\n\t\t\t\t<div class='col-12 px-0 border rounded '>\n\t\t\t\t\t<button class={`'btn ${className}`}\n\t\t\t\t\t\tonClick={this.toggleLog}\n\t\t\t\t\t>\n\t\t\t\t\t\t<i class='fas fa-plus' /> {showLog ? <Text id='dog.addlog.hidelog'>Skjul logg</Text> : <Text id='dog.addlog.newlog'>Ny logg</Text>}\n\t\t\t\t\t</button>\n\t\t\t\t\t<br />\n\n\t\t\t\t\t{showLog && <div class='mb-2 py-4 px-2'>\n\t\t\t\t\t\t<h5><Text id='dog.addlog.addlog'>Legg til logg</Text></h5>\n\n\t\t\t\t\t\t<Localizer>\n\t                        <Dogs stores={this.props.stores} object={newHistory} type='array' elementtype='number' field='dogs' icon='fas fa-dog' \n\t\t\t\t\t\t\t\ttitle={<Text id='dog.addlog.dogs'>Hunder</Text>}\n\t\t\t\t\t\t\t\thelp={<Text id='dog.addlog.dogs-help'>Hvilke hunder gjelder dette?</Text>}\n\t\t\t\t\t\t\t\tupdateField={this.updateField} filter={(e) => dog.id === e.id || newHistory.dogs.indexOf(e.id) > -1}\n\t\t\t\t\t\t\t\tcurrentTeam={currentTeam}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Localizer>\t\t\t\t\t\t\t\n\n\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t<div class='form-group col'>\n\t\t\t\t\t\t\t\t<label for='dateInput'><i class='fas fa-calendar-alt' /> <Text id='dog.addlog.date'>Dato</Text></label>\n\t\t\t\t\t\t\t\t<input type='date' class='form-control' id='dateInput' aria-describedby='dateHelp'\n\t\t\t\t\t\t\t\t\tonInput={linkState(this, 'newHistory.date')}\n\t\t\t\t\t\t\t\t\tvalue={newHistory.date}\n\t\t\t\t\t\t\t\t\tautocomplete='off'\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<small id='dateHelp' class='form-text text-muted'><Text id='dog.addlog.date-help'>Dato for logglinje.</Text></small>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class='form-group col'>\n\t\t\t\t\t\t\t\t<label for='timeInput'><i class='fas fa-clock' /> <Text id='dog.addlog.time'>Klokka</Text></label>\n\t\t\t\t\t\t\t\t<input type='time' class='form-control' id='timeInput' aria-describedby='timeHelp'\n\t\t\t\t\t\t\t\t\tonInput={linkState(this, 'newHistory.time')}\n\t\t\t\t\t\t\t\t\tvalue={newHistory.time}\n\t\t\t\t\t\t\t\t\tautocomplete='off'\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<small id='timeHelp' class='form-text text-muted'><Text id='dog.addlog.time-help'>Tid for logglinje.</Text></small>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<div class='form-group'>\n\t\t\t\t\t\t\t<label for='typeInput'><i class='fas fa-folder-open' /> <Text id='dog.addlog.type'>Type hendelse</Text></label>\n\t\t\t\t\t\t\t<select class='form-control' id='typeInput' aria-describedby='typeHelp'\n\t\t\t\t\t\t\t\t// onInput={linkState(this, 'newHistory.historyType')}\n\t\t\t\t\t\t\t\tonInput={this.setHistoryType}\n\t\t\t\t\t\t\t\tvalue={newHistory.historyType}\n\t\t\t\t\t\t\t\tautocomplete='off'\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<option value=''>-- <Text id='dog.addlog.choose-type'>Velg type</Text> --</option>\n\t\t\t\t\t\t\t\t<option value='other'><Text id='dog.addlog.other'>Annet</Text></option>\n\t\t\t\t\t\t\t\t<option value='stoolProblem'><Text id='dog.addlog.stoolProblem'>Avføringsproblem</Text></option>\n\t\t\t\t\t\t\t\t<option value='bodyScore'><Text id='dog.addlog.bodyScore'>Bodyscore</Text></option>\n\t\t\t\t\t\t\t\t<option value='diarrhea'><Text id='dog.addlog.diarrhea'>Diarè</Text></option>\n\t\t\t\t\t\t\t\t<option value='foodLeftover'><Text id='dog.addlog.foodLeftover'>Ikke spist opp maten</Text></option>\n\t\t\t\t\t\t\t\t<option value='animalchiropractor'><Text id='dog.addlog.animalchiropractor'>Dyrekiropraktor</Text></option>\n\t\t\t\t\t\t\t\t<option value='clawClip'><Text id='dog.addlog.clawClip'>Kloklipp</Text></option>\n\t\t\t\t\t\t\t\t<option value='maturity'><Text id='dog.addlog.maturity'>Løpetid</Text></option>\n\t\t\t\t\t\t\t\t<option value='massage'><Text id='dog.addlog.massage'>Massasje</Text></option>\n\t\t\t\t\t\t\t\t<option value='newStraw'><Text id='dog.addlog.newStraw'>Ny halm/treull</Text></option>\n\t\t\t\t\t\t\t\t<option value='update'><Text id='dog.addlog.update'>Oppdatering</Text></option>\n\t\t\t\t\t\t\t\t<option value='deworming'><Text id='dog.addlog.deworming'>Ormekur</Text></option>\n\t\t\t\t\t\t\t\t<option value='mating'><Text id='dog.addlog.mating'>Parring</Text></option>\n\t\t\t\t\t\t\t\t<option value='injury'><Text id='dog.addlog.injury'>Skade</Text></option>\n\t\t\t\t\t\t\t\t<option value='fight'><Text id='dog.addlog.fight'>Slåsskamp</Text></option>\n\t\t\t\t\t\t\t\t<option value='sick'><Text id='dog.addlog.sick'>Syk</Text></option>\n\t\t\t\t\t\t\t\t<option value='unwantedMating'><Text id='dog.addlog.unwantedMating'>Tjuvparring</Text></option>\n\t\t\t\t\t\t\t\t<option value='vaccine'><Text id='dog.addlog.vaccine'>Vaksine</Text></option>\n\t\t\t\t\t\t\t\t<option value='weight'><Text id='dog.addlog.weight'>Veiing</Text></option>\n\t\t\t\t\t\t\t\t<option value='veterinarianVisit'><Text id='dog.addlog.veterinarianVisit'>Vetrinær besøk</Text> </option>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t<small id='nameHelp' class='form-text text-muted'><Text id='dog.addlog.type-help'>Type hendelse. Vetrinær besøk, vaksinering, syk, løpetid, etc.</Text></small>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{(['vaccine'].indexOf(newHistory.historyType) > -1) && <div class='form-group'>\n\t\t\t\t\t\t\t<label for='vaccineTypeInput'><i class='fas fa-hourglass-end' /> <Text id='dog.addlog.vaccine-type'>Vaksinetype</Text></label>\n\t\t\t\t\t\t\t<select class='form-control' id='vaccineTypeInput' aria-describedby='vaccineTypeHelp'\n\t\t\t\t\t\t\t\t// onInput={linkState(this, 'newHistory.historyType')}\n\t\t\t\t\t\t\t\tonInput={this.setVaccineType}\n\t\t\t\t\t\t\t\tvalue={newHistory.vaccineType}\n\t\t\t\t\t\t\t\tautocomplete='off'\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<option value=''>-- <Text id='dog.addlog.choose-vaccine'>Velg vaksinetype</Text> --</option>\n\t\t\t\t\t\t\t\t<option value='rabies'><Text id='dog.addlog.rabies'>Rabies (3 år)</Text></option>\n\t\t\t\t\t\t\t\t<option value='deworming'><Text id='dog.addlog.deworming'>Ormekur</Text></option>\n\t\t\t\t\t\t\t\t<option value='BbPi'><Text id='dog.addlog.BbPi'>BbPi - Nesevaksine (1 år)</Text></option>\n\t\t\t\t\t\t\t\t<option value='DHP'><Text id='dog.addlog.DHP'>DHP (3 år)</Text></option>\n\t\t\t\t\t\t\t\t<option value='DHPPi'><Text id='dog.addlog.DHPPi'>DHPPi (3 år)</Text></option>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t<small id='vaccineTypeHelp' class='form-text text-muted'><Text id='dog.addlog.vaccine-help'>Hvilken vaksinetype er dette?</Text></small>\n\t\t\t\t\t\t</div>}\n\n\t\t\t\t\t\t<div class='form-group'>\n\t\t\t\t\t\t\t<label for='nameInput'><Text id='dog.addlog.title'>Tittel</Text></label>\n\t\t\t\t\t\t\t<input type='text' class='form-control' id='nameInput' aria-describedby='nameHelp'\n\t\t\t\t\t\t\t\tonInput={linkState(this, 'newHistory.title')}\n\t\t\t\t\t\t\t\tvalue={newHistory.title}\n\t\t\t\t\t\t\t\tautocomplete='off'\n\t\t\t\t\t\t\t\trequired={true}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<small id='nameHelp' class='form-text text-muted'><Text id='dog.addlog.title-help'>Tittel på logglinje. Vetrinær besøk, Vaksinering, Syk, Profilbilde, etc.</Text></small>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{(['vaccine', 'maturity', 'unwantedMating', 'mating'].indexOf(newHistory.historyType) > -1) && <div class='form-group'>\n\t\t\t\t\t\t\t<label for='endDateInput'><i class='fas fa-hourglass-end' /> <Text id='dog.addlog.duration'>Varighet</Text></label>\n\t\t\t\t\t\t\t<input type='date' class='form-control' id='endDateInput' aria-describedby='endDateHelp'\n\t\t\t\t\t\t\t\tonInput={linkState(this, 'newHistory.endDate')}\n\t\t\t\t\t\t\t\tvalue={newHistory.endDate}\n\t\t\t\t\t\t\t\tautocomplete='off'\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<small id='endDateHelp' class='form-text text-muted'><Text id='dog.addlog.duration-help'>Når går denne vaksinen ut?</Text></small>\n\t\t\t\t\t\t</div>}\n\n\t\t\t\t\t\t{(newHistory.historyType === 'weight' || newHistory.historyType === 'bodyScore') && <div class='form-group'>\n\t\t\t\t\t\t\t<label for='weightInput'><i class='fas fa-balance-scale' /> <Text id='dog.addlog.weight-of-dog'>Vekt</Text></label>\n\t\t\t\t\t\t\t<input type='text' class='form-control' id='weightInput' aria-describedby='weightHelp'\n\t\t\t\t\t\t\t\tonInput={linkState(this, 'newHistory.weight')}\n\t\t\t\t\t\t\t\tvalue={newHistory.weight}\n\t\t\t\t\t\t\t\tautocomplete='off'\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<small id='weightHelp' class='form-text text-muted'><Text id='dog.addlog.weight-of-dog-help'>Vekten til hunden.</Text></small>\n\t\t\t\t\t\t</div>}\n\t\t\t\t\t\t{(newHistory.historyType === 'weight' || newHistory.historyType === 'bodyScore') && <div class='form-group'>\n\t\t\t\t\t\t\t<label for='bodyScoreInput'><i class='fas fa-balance-scale' /> <Text id='dog.addlog.bodyscore'>Bodyscore</Text></label>\n\t\t\t\t\t\t\t<input type='text' class='form-control' id='bodyScoreInput' aria-describedby='bodyScoreHelp'\n\t\t\t\t\t\t\t\tonInput={linkState(this, 'newHistory.bodyScore')}\n\t\t\t\t\t\t\t\tvalue={newHistory.bodyScore}\n\t\t\t\t\t\t\t\tautocomplete='off'\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<small id='bodyScoreHelp' class='form-text text-muted'><Text id='dog.addlog.bodyscore-help'>Bodyscore til hunden.</Text></small>\n\t\t\t\t\t\t</div>}\n\n\t\t\t\t\t\t{(newHistory.historyType === 'veterinarianVisit' || newHistory.historyType === 'vaccine') && <div class='form-group'>\n\t\t\t\t\t\t\t<label for='costInput'><i class='fas fa-money-bill-alt' /> <Text id='dog.addlog.cost'>Kostnad</Text></label>\n\t\t\t\t\t\t\t<input type='text' class='form-control' id='costInput' aria-describedby='costHelp'\n\t\t\t\t\t\t\t\tonInput={linkState(this, 'newHistory.cost')}\n\t\t\t\t\t\t\t\tvalue={newHistory.cost}\n\t\t\t\t\t\t\t\tautocomplete='off'\n\t\t\t\t\t\t\t\tpattern='[0-9]{3}' title='Kun tall. Ikke noen andre tegn eller symboler.'\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<small id='costHelp' class='form-text text-muted'><Text id='dog.addlog.cost-help'>Kostnad for denne hendelsen.</Text></small>\n\t\t\t\t\t\t</div>}\n\n\n\t\t\t\t\t\t<div class='form-group'>\n\t\t\t\t\t\t\t<label for='commentInput'><i class='fas fa-quote-right' /> <Text id='dog.addlog.commet'>Kommentar</Text></label>\n\t\t\t\t\t\t\t<input type='text' class='form-control' id='commentInput' aria-describedby='commentHelp'\n\t\t\t\t\t\t\t\tonInput={linkState(this, 'newHistory.comment')}\n\t\t\t\t\t\t\t\tvalue={newHistory.comment}\n\t\t\t\t\t\t\t\tautocomplete='off'\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<small id='commentHelp' class='form-text text-muted'><Text id='dog.addlog.comment-help'>Kommentar til loggen. Skriv mer om hva som hendte.</Text></small>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class='container-fluid'>\n\t\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t\t<div class='row-12'>\n\t\t\t\t\t\t\t\t\t<label for='imageInput'><i class='fas fa-camera' /> <Text id='dog.addlog.images'>Bilder</Text></label>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t\t{newHistory.images && newHistory.images.map(img => (\n\t\t\t\t\t\t\t\t\t<div class='col-3 p-1'>\n\t\t\t\t\t\t\t\t\t\t<img src={img.s3SmallLink} class='img-fluid' onError={this.handleImageErrored} />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Images object={newHistory} field='images' updateField={this.addImages} uploadStatus={this.imageUploadStatus} autoOpen={false} />\n\n\t\t\t\t\t\t<button type='button' class='btn btn-success'\n\t\t\t\t\t\t\tonClick={this.insertLog}\n\t\t\t\t\t\t\tdisabled={!okToAddLog}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{okToAddLog ? <Text id='dog.addlog.addlog'>Legg til logg</Text> : <Text id='dog.addlog.please-wait'>vent litt...</Text>}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button type='button' class='btn btn-danger float-right'\n\t\t\t\t\t\t\tonClick={this.resetLog}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Text id='dog.addlog.cancel'>Glem det</Text>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>}\n\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<button class={`'btn ${className}`}\n\t\t\t\tonClick={this.toggleLog}\n\t\t\t>\n\t\t\t\t<i class='fas fa-plus' /> {showLog ? <Text id='dog.addlog.hidelog'>Skjul logg</Text> : <Text id='dog.addlog.newlog'>Ny logg</Text>}\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default DogAddLog;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { toJS } from 'mobx';\nimport linkState from 'linkstate';\nimport { route } from 'preact-router';\nimport { Text, Localizer, withText } from 'preact-i18n';\n\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd';\n\nconst placeholder = {\n    id: 0,\n    name: 'empty',\n};\n\nconst getPlaceholder = () => {\n    const newPlaceholder = { ...placeholder };\n    newPlaceholder.unique= `${new Date().getTime()}-${util.randomPassword()}`;\n    return newPlaceholder;\n}\n\n// a little function to help us with reordering the result\nconst reorder = (list, startIndex, endIndex) => {\n    const result = Array.from(list);\n    const [removed] = result.splice(startIndex, 1);\n    result.splice(endIndex, 0, removed);\n\n    return result;\n};\n\n/**\n * Moves an item from one list to another list.\n */\nconst move = (source, destination, droppableSource, droppableDestination) => {\n    const sourceClone = Array.from(source);\n    const destClone = Array.from(destination);\n    const [removed] = sourceClone.splice(droppableSource.index, 1);\n\n    destClone.splice(droppableDestination.index, 0, removed);\n\n    const result = {};\n    result[droppableSource.droppableId] = sourceClone;\n    result[droppableDestination.droppableId] = destClone;\n\n    return result;\n};\n\nconst getItemStyle = (isDragging, draggableStyle) => ({\n    // some basic styles to make the items look a bit nicer\n    userSelect: 'none',\n    // padding: grid * 2,\n    // margin: `0 0 ${grid}px 0`,\n\n    // change background colour if dragging\n    background: isDragging ? \"#808080\" : \"\",\n    maxWidth: 92,\n    height: 100,\n\n    // styles we need to apply on draggables\n    ...draggableStyle\n});\n\nconst getListStyle = isDraggingOver => ({\n    borderStyle: isDraggingOver ? \"dashed\" : \"\",\n    // background: isDraggingOver ? \"#a0a0a0\" : \"\",\n    // padding: grid,\n    width: 110,\n});\n\nclass List extends Component {\n  render() {\n    const { provided, snapshot, innerRef, children, className } = this.props;\n    return (\n        <div class={`h-100 border ${className}`} {...provided.droppableProps} ref={innerRef}\n            style={getListStyle(snapshot.isDraggingOver)}\n        >\n            {children}\n        </div>\n    );\n  }\n}\n\n\nclass Dog extends Component {\n    removeThisPlaceholder = () => {\n        const { removePlaceholder = () => {}, idx, list } = this.props;\n        removePlaceholder({ idx, list });\n    }\n\n    render() {\n        const { provided, snapshot, innerRef, dog } = this.props;\n        return (\n            <div\n                {...provided.draggableProps}\n                {...provided.dragHandleProps}\n                ref={innerRef}\n                class='mx-2 my-2 p-2'\n                style={getItemStyle(\n                    snapshot.isDragging,\n                    provided.draggableProps.style\n                )}\n            >\n                {dog.id === 0 ? (\n                    <>\n                        <div>\n                            <div class={`text-center border rounded-circle imageRounded text-muted pt-2`}>\n                                <span class='font-weight-lighter' style='font-size: 35px;'>&nbsp;</span>\n                            </div>\n                            <div class='text-center'>\n                                <button class='btn btn-sm btn-link float-right p-0' onClick={this.removeThisPlaceholder}>\n                                    <i class='fas fa-trash-alt' />\n                                </button>\n                                &nbsp;\n                            </div>\n                        </div>\n                    </>\n                ) : (\n                    <>\n                        <div>\n                            <div class={`text-center border rounded-circle imageRounded text-muted pt-2`} style={`${dog.image ? `background-image: url(\"${dog.image.s3ThumbLink}\");` : ''}`}>\n                                {/* {!dog.image && <i class='fas fa-dog' style='font-size: 20px;' />} */}\n                                {!dog.image && <span class='font-weight-lighter' style='font-size: 35px;'>{util.ucfirst(dog.name, true)}</span>}\n                            </div>\n                            <div class='text-center'>\n                                <small>\n                                    {dog.shortname || dog.name}<br />\n                                </small>\n\n                            </div>\n                        </div>\n                    </>\n                )}\n            </div>\n        );\n    }\n}\n\n\nconst initialState = {\n    filterby: util.get('dogs-filter'),\n};\n\n@observer\nclass Dogs extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            dogsLeft: [],\n            dogsRight: [],\n            ...initialState,\n        };\n    }\n\n    toggleDog = async (e) => {\n        const { id } = e.target.closest('#dogContainer').dataset;\n        const dogId = parseInt(id, 10);\n        const { object, type, elementtype, field, updateField, isNew, showPositions } = this.props;\n        const value = toJS(object[field]) || [];\n        const idx = value.indexOf(dogId);\n        let action;\n        if (idx > -1) {\n            value.splice(idx, 1);\n            action = 'remove';\n        } else {\n            value.push(dogId);\n            action = 'add';\n        }\n        await updateField({ id: object.id, field, value, type, elementtype, isNew, skipTimer: true, singleValue: dogId });\n        this.setState({\n            filterText: '',\n        });\n        if (showPositions) {\n            this.dndDogs({ dogId, action });\n        }\n    }\n\n    findAllDogsInTeams = () => {\n        const { dogStore } = this.props.stores;\n        const { dogs = [] } = dogStore;\n        const { object, currentTeam = {} } = this.props;\n        const selectedTeams = toJS(object.teams || []);\n        const currentTeamId = currentTeam.id;\n        const filter = (e) => {\n            if (e.team === currentTeamId || (e.teams && e.teams.indexOf(currentTeamId) > -1)) {\n                return true;\n            }\n            if (selectedTeams.indexOf(e.team) > -1) {\n                return true;\n            }\n            if (e.teams) {\n                return e.teams.some(r => selectedTeams.indexOf(r) >= 0);\n            }\n            return false;\n        };\n        const allDogsInTeam = dogs.filter(filter).map(e => e.id);\n        return allDogsInTeam;\n    }\n\n    addAllDogsInTeam = async () => {\n        const { object, type, elementtype, field, updateField, isNew } = this.props;\n        const allDogsInTeam = this.findAllDogsInTeams();\n        await updateField({ id: object.id, field, value: allDogsInTeam, type, elementtype, isNew, skipTimer: true });\n    }\n\n    // toggleFilter = () => {\n    //     const { showAll } = this.state;\n    //     this.setState({\n    //         showAll: showAll ? 0 : 1,\n    //     });\n    //     this.loadDog();\n    // }\n\n    // toggleSelectedFilter = () => {\n    //     const { showOnlySelected } = this.state;\n    //     this.setState({\n    //         showOnlySelected: showOnlySelected ? 0 : 1,\n    //     });\n    // }\n\n    dndDogs = ({ dogId, action }) => {\n        const { dogStore } = this.props.stores;\n        const { dogs = [] } = dogStore;\n        const { object } = this.props;\n        const dogFilter = object.dogs ? (e) => object.dogs.indexOf(e.id) > -1 : () => false;\n        const allDogs = toJS(dogs);\n        const filterLeft = (dogId) => dogId === 0 || (allDogs.find(a => a.id === dogId) && object.dogsRight.indexOf(dogId) === -1);\n        const filterRight = (dogId) => dogId === 0 || (allDogs.find(a => a.id === dogId) && object.dogsLeft.indexOf(dogId) === -1);\n\n        const defaultDogsRight = allDogs.filter(dogFilter);\n        const n = Math.ceil(defaultDogsRight.length / 2);\n        const defaultDogsLeft = defaultDogsRight.splice(0, n);\n\n        let dogsLeft = [];\n        if (object.dogsLeft && object.dogsLeft.length > 0) {\n            dogsLeft = object.dogsLeft.filter(filterLeft)\n                .map((dogId) => {\n                    const dog = allDogs.find(e => e.id === dogId) || getPlaceholder();\n                    // console.log('dogId', dogId, dog);\n                    return dog;\n                });\n        }\n\n        let dogsRight = [];\n        if (object.dogsRight && object.dogsRight.length > 0) {\n            dogsRight = object.dogsRight.filter(filterRight)\n                .map((dogId) => {\n                    const dog = allDogs.find(e => e.id === dogId) || getPlaceholder();\n                    // console.log('dogId', dogId, dog);\n                    return dog;\n                });\n        }\n\n\n        if (action === 'add') {\n            const dog = dogs.find(e => e.id === dogId);\n            if (dog) {\n                if (dogsLeft.length > dogsRight.length) {\n                    dogsRight.push(dog);\n                } else {\n                    dogsLeft.push(dog);\n                }\n            }\n        }\n        if (action === 'remove') {\n            const idxLeft = dogsLeft.findIndex(e => e.id === dogId);\n            if (idxLeft > -1) {\n                dogsLeft.splice(idxLeft, 1);\n            }\n            const idxRight = dogsRight.findIndex(e => e.id === dogId);\n            if (idxRight > -1) {\n                dogsRight.splice(idxRight, 1);\n            }\n        }\n        // I owe Mariska Kleintjens a beer for this one: \n        if (dogsLeft.length === 0 && dogsRight.length === 0) {\n            dogsLeft = defaultDogsLeft;\n            dogsRight = defaultDogsRight;\n        }\n        if (action) {\n            this.setState({\n                dogsLeft,\n                dogsRight,\n                dogPositionUpdated: true,\n            }, () => this.updateDogPositions());\n            \n        } else {\n            this.setState({\n                dogsLeft,\n                dogsRight,\n            });\n        }\n    }\n\n    addPlaceholderLeft = () => {\n        const { dogsLeft = [] } = this.state;\n        dogsLeft.push(getPlaceholder());\n        this.setState({\n            dogsLeft,\n            dogPositionUpdated: true,\n        });\n    }\n\n    addPlaceholderRight = () => {\n        const { dogsRight = [] } = this.state;\n        dogsRight.push(getPlaceholder());\n        this.setState({\n            dogsRight,\n            dogPositionUpdated: true,\n        });\n    }\n\n    removePlaceholder = ({ idx, list }) => {\n        if (list === 'dogsLeft') {\n            const { dogsLeft = [] } = this.state;\n            dogsLeft.splice(idx, 1);\n            this.setState({\n                dogsLeft,\n                dogPositionUpdated: true,\n            });\n        }\n        if (list === 'dogsRight') {\n            const { dogsRight = [] } = this.state;\n            dogsRight.splice(idx, 1);\n            this.setState({\n                dogsRight,\n                dogPositionUpdated: true,\n            });\n        }\n    }\n\n    async loadDog(props = this.props) {\n        const { showPositions } = this.props;\n\t\tconst { dogStore } = props.stores;\n        await dogStore.load({ query: { deceased: 0 }, addData: ['team', 'user', 'workoutSummary', 'vaccineStatuses', 'historyStatuses', 'vaccineLogStatuses', 'allDogs'] });\n\n        if (showPositions) {\n            this.dndDogs({});\n        }\n        this.getFilteredDogs();\n    }\n\n    clearAllDogs = async () => {\n        const { object, type, elementtype, field, updateField, isNew } = this.props;\n        await updateField({ id: object.id, field, value: [], type, elementtype, isNew, skipTimer: true });\n        this.resetDogPositions();\n    }\n    \n    toggleSearchField = () => {\n        const { showSearchField } = this.state;\n        this.setState({\n            showSearchField: showSearchField ? null : 1,\n        });\n    }\n\n    getList = id => this.state[id];\n\n    onDragEnd = result => {\n        const { source, destination } = result;\n\n        // dropped outside the list\n        if (!destination) {\n            return;\n        }\n\n        if (source.droppableId === destination.droppableId) {\n            const items = reorder(\n                this.getList(source.droppableId),\n                source.index,\n                destination.index\n            );\n            this.setState({\n                [source.droppableId]: items,\n                dogPositionUpdated: true,\n            });\n        } else {\n            const result = move(\n                this.getList(source.droppableId),\n                this.getList(destination.droppableId),\n                source,\n                destination\n            );\n\n            this.setState({\n                dogsLeft: result.dogsLeft,\n                dogsRight: result.dogsRight,\n                dogPositionUpdated: true,\n            });\n        }\n    }\n\n    updateDogPositions = async () => {\n        const { dogsLeft = [], dogsRight = [] } = this.state;\n        const { object, updateField, isNew } = this.props;\n        await updateField({ id: object.id, field: 'dogsLeft', value: dogsLeft.map(e => e.id), isNew, datatype: 'array' });\n        await updateField({ id: object.id, field: 'dogsRight', value: dogsRight.map(e => e.id), isNew, datatype: 'array' });\n        this.setState({ dogPositionUpdated: false });\n    }\n\n    resetDogPositions = async () => {\n        const { dogStore } = this.props.stores;\n        const { dogs = [] } = dogStore;\n        const { object, updateField, isNew } = this.props;\n        const dogFilter = (e) => object.dogs.indexOf(e.id) > -1;\n        const allDogs = toJS(dogs);\n\n        const dogsRight = allDogs.filter(dogFilter);\n        const n = Math.ceil(dogsRight.length / 2);\n        const dogsLeft = dogsRight.splice(0, n);\n        await updateField({ id: object.id, field: 'dogsLeft', value: dogsLeft.map(e => e.id), isNew, datatype: 'array' });\n        await updateField({ id: object.id, field: 'dogsRight', value: dogsRight.map(e => e.id), isNew, datatype: 'array' });\n        this.setState({\n            dogsLeft,\n            dogsRight,\n            dogPositionUpdated: false,\n        });\n    }\n\n    clearDogPositions = async () => {\n        const { object, updateField, isNew } = this.props;\n        const dogsRight = [];\n        const dogsLeft = [];\n        await updateField({ id: object.id, field: 'dogsLeft', value: dogsLeft, isNew, datatype: 'array' });\n        await updateField({ id: object.id, field: 'dogsRight', value: dogsRight, isNew, datatype: 'array' });\n        this.setState({\n            dogsLeft,\n            dogsRight,\n            dogPositionUpdated: false,\n        });\n    }\n\n    changeFilter = (e) => {\n\t\tconst value = e.target.value;\n\t\tthis.setState({\n\t\t\tfilterby: value,\n\t\t});\n        util.set('dogs-filter', value);\n        this.loadDog();\n\t}\n\n    getFilteredDogs = (props = this.props) => {\n        const { filterby, filterText } = this.state;\n        const { object, filter = () => true } = props;\n        const { dogStore } = this.props.stores;\n\t\tconst { dogs = [] } = dogStore;\n\n        let dogFilter = filter;\n        if (object.dogs) {\n            switch (filterby) {\n                case 'all':\n                    if (filterText) {\n                        dogFilter = (e) => e.name.match(new RegExp(filterText, 'i')) || object.dogs.indexOf(e.id) > -1;\n                    } else {\n                        dogFilter = () => true;\n                    }\n                    break;\n                case 'onlySelected':\n                    if (filterText) {\n                        dogFilter = (e) => e.name.match(new RegExp(filterText, 'i')) || object.dogs.indexOf(e.id) > -1;\n                    } else {\n                        dogFilter = (e) => object.dogs.indexOf(e.id) > -1;\n                    }\n                    break;\n                case 'onlyTeam':\n                    if (filterText) {\n                        dogFilter = (e) => e.name.match(new RegExp(filterText, 'i')) || object.dogs.indexOf(e.id) > -1;\n                    } else {\n                        dogFilter = (e) => object.team === e.team || object.dogs.indexOf(e.id) > -1;\n                    }\n                    break;        \n                case 'leadOnly':\n                    dogFilter = (e) => {\n                        if (object.dogs.indexOf(e.id) > -1) {\n                            return true;\n                        }\n                        if (util.getNestedValue(e, 'positions.lead.distanceKm') > 0) {\n                            return true;\n                        }\n                        return false;\n                    };\n                    break;        \n                case 'pointOnly':\n                    dogFilter = (e) => {\n                        if (object.dogs.indexOf(e.id) > -1) {\n                            return true;\n                        }\n                        if (util.getNestedValue(e, 'positions.point.distanceKm') > 0) {\n                            return true;\n                        }\n                        return false;\n                    };\n                    break;        \n                case 'teamOnly':\n                    dogFilter = (e) => {\n                        if (object.dogs.indexOf(e.id) > -1) {\n                            return true;\n                        }\n                        if (util.getNestedValue(e, 'positions.team.distanceKm') > 0) {\n                            return true;\n                        }\n                        return false;\n                    };\n                    break;        \n                case 'wheelOnly':\n                    dogFilter = (e) => {\n                        if (object.dogs.indexOf(e.id) > -1) {\n                            return true;\n                        }\n                        if (util.getNestedValue(e, 'positions.wheel.distanceKm') > 0) {\n                            return true;\n                        }\n                        return false;\n                    };\n                    break;        \n            }\n        }\n        let filteredDogs = dogs.filter(dogFilter);\n        this.setState({\n            filteredDogs,\n        })\n    }\n\n\n    componentWillReceiveProps(nextProps) {\n        // console.log('componentWillReceiveProps', nextProps);\n        if (nextProps.filter !== this.props.filter) {\n            this.getFilteredDogs(nextProps);\n        }\n    }\n\n    componentDidMount() {\n        this.loadDog();\n    }\n\n    render() {\n        const { filterby, filterText, showSearchField, dogsLeft = [], dogsRight = [], dogPositionUpdated, filteredDogs = [] } = this.state;\n        const { userStore, dogStore } = this.props.stores;\n\t\tconst { dogs = [] } = dogStore;\n        const { isAdmin, user } = userStore;\n        const { language = 'en' } = user;\n\n        const { saved = {}, object, field, title, icon, help, showPositions = false, currentTeam = {} } = this.props;\n        const value = toJS(object[field]) || [];\n\n        const allDogsInTeam = this.findAllDogsInTeams();\n        const teamNames = object.teams ? object.teams.map(e => userStore.findTeam(e)) : [];\n\n        return (\n            <div class={`form-group  mb-5 pb-1 border-bottom ${saved[`${field}.${object.id}`] ? 'is-valid' : ''}`}>\n                <span class='float-right' onClick={this.toggleSearchField}>\n                    <i class='fas fa-search' />\n                </span>\n                <button class='btn btn-sm btn-link float-right mr-5' onClick={this.clearAllDogs}>\n                    <i class='fas fa-eraser' /> <Text id='dog.dogs.remove-all-dogs'>Fjern alle hundene</Text>\n                </button>\n                <label for={`${field}Input`}>{icon && <i class={`${icon} text-muted`} />} {title}</label>\n\n                <div class='container-fluid px-0'>\n                    {showSearchField && <div class='row'>\n                        <div class='col-12'>\n                            <Localizer>\n                                <input\n                                    class='form-control form-control-sm'\n                                    type='text'\n                                    placeholder={<Text id='dog.dogs.search-for-dogs'>Søk etter hund</Text>}\n                                    value={filterText}\n                                    onInput={linkState(this, 'filterText')}\n                                />\n                            </Localizer>\n                        </div>\n                    </div>}\n                    <div class='row'>\n                        <div class='col-12'>\n                            <div class='form-row align-items-center'>\n                                <div class='col-auto my-2 mx-auto'>\n                                    <select class='custom-select'\n                                        style='background-color: inherit; border: none; padding-top: 0; padding-bottom: 0; height: 1.4em; font-size: 0.8em;'\n                                        onInput={this.changeFilter}\n                                    >\n                                        <option value='' selected={!filterby}>-- <Text id='dog.dogs.choose-filter'>Choose filter</Text> ---</option>\n                                        <option value='all' selected={filterby === 'all'}><Text id='dog.dogs.show-all'>Vis alle</Text></option>\n                                        <option value='onlySelected' selected={filterby === 'onlySelected'}><Text id='dog.dogs.show-only-selected'>Vis kun valgte</Text></option>\n                                        <option value='onlyTeam' selected={filterby === 'onlyTeam'}><Text id='dog.dogs.show-only-team-dogs'>Vis kun hundene i teamet</Text></option>\n                                        <option value='leadOnly' selected={filterby === 'leadOnly'}><Text id='dog.dogs.show-lead-dogs-only'>Vis kun lederhunder</Text></option>\n                                        <option value='pointOnly' selected={filterby === 'pointOnly'}><Text id='dog.dogs.show-point-dogs-only'>Vis kun pointhunder</Text></option>\n                                        <option value='teamOnly' selected={filterby === 'teamOnly'}><Text id='dog.dogs.show-team-dogs-only'>Vis kun teamhunder</Text></option>\n                                        <option value='wheelOnly' selected={filterby === 'wheelOnly'}><Text id='dog.dogs.show-wheel-dogs-only'>Vis kun wheelhunder</Text></option>\n                                    </select>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class='row'>\n                        {allDogsInTeam.length > 0 && <>\n                            <button class='btn btn-primary btn-block'\n                                onClick={this.addAllDogsInTeam}\n                            >\n                               <i class='fas fa-plus mr-2' /> <Text id='dog.dogs.add-all-in-team' fields={{ total: allDogsInTeam.length }}>Add all dogs in team</Text>{currentTeam.name ? `: ${currentTeam.name}` : ''}\n                               {teamNames && teamNames.length > 0 && <span class='font-weight-lighter'>\n                                    , {teamNames.map((name, idx) => <>{idx > 0 ? ', ' : ''}{name}</>)}\n                                </span>}\n                            </button>\n                        </>}\n\n                        {util.isArray(dogs) && filteredDogs.map(dog => {\n                            const dogStatus = userStore.findDogstatus({ status: dog.status, language });\n                            const dogPosition = userStore.findDogposition({ position: dog.position, language });\n                            const dogHistoryStatuses = dogStore.findHistoryStatuses(dog.id);\n                            return (\n                                <div class='col-6 col-sm-6 col-md-6 col-lg-6 mb-1'>\n                                    <div class={`border rounded px-3 pt-2 pb-1 ${value.indexOf(dog.id) > -1 ? 'bg-success' : ''} position-relative`}\n                                        onClick={this.toggleDog}\n                                        id='dogContainer'\n                                        data-id={dog.id}\n                                        style='padding: .3rem !important; line-height: 1.1em; cursor: pointer; pointer-events: inherit;'\n                                    >\n                                        {dogPosition && <small class='position-absolute' style='left:5px; top: 32px;'>\n                                            <span class={`badge badge-${dogPosition.class || 'primary'} mr-3`}>{dogPosition.icon && <i class={dogPosition.icon} />} {dogPosition.name}</span>\n                                        </small>}\n\n                                        {filterby === 'leadOnly' && util.getNestedValue(dog, 'positions.lead.distanceKm') > 0 && <small class='position-absolute' style='left:5px; top: 32px;'>\n                                            <span class={`badge badge-secondary mr-3`}><Text id='dogs.sort-lead'>Lead</Text>: {util.format(util.getNestedValue(dog, 'positions.lead.distanceKm'), 0)}km</span>\n                                        </small>}\n                                        {filterby === 'pointOnly' && util.getNestedValue(dog, 'positions.point.distanceKm') > 0 && <small class='position-absolute' style='left:5px; top: 32px;'>\n                                            <span class={`badge badge-secondary mr-3`}><Text id='dogs.sort-point'>Point</Text>: {util.format(util.getNestedValue(dog, 'positions.point.distanceKm'), 0)}km</span>\n                                        </small>}\n                                        {filterby === 'teamOnly' && util.getNestedValue(dog, 'positions.team.distanceKm')> 0 && <small class='position-absolute' style='left:5px; top: 32px;'>\n                                            <span class={`badge badge-secondary mr-3`}><Text id='dogs.sort-team'>Team</Text>: {util.format(util.getNestedValue(dog, 'positions.team.distanceKm'), 0)}km</span>\n                                        </small>}\n                                        {filterby === 'wheelOnly' && util.getNestedValue(dog, 'positions.wheel.distanceKm') > 0 && <small class='position-absolute' style='left:5px; top: 32px;'>\n                                            <span class={`badge badge-secondary mr-3`}><Text id='dogs.sort-wheel'>Wheel</Text>: {util.format(util.getNestedValue(dog, 'positions.wheel.distanceKm'), 0)}km</span>\n                                        </small>}\n\n                                        <div class='d-flex'>\n                                            <div class={`text-center border rounded-circle imageRounded imageRoundedSmall text-muted pt-2`} style={`${dog.image ? `background-image: url(\"${dog.image.s3ThumbLink}\");` : ''}`}>\n                                                {/* {!dog.image && <i class='fas fa-dog' style='font-size: 20px;' />} */}\n                                                {!dog.image && <span class='font-weight-lighter' style='font-size: 20px;'>{util.ucfirst(dog.name, true)}</span>}\n                                            </div>\n                                            <div class='flex-grow-1 pl-2 pr-1'\n                                                style={`border-right: 4px solid ${userStore.findHarness(dog.harness, 'colorNonstop')} !important; line-height: 0.9em;`}\n                                            >\n                                                <small>\n                                                    <small class='float-right'>\n                                                        {dog.birth && <span class='mr-1'>{util.age(dog.birth, dog.deceased)}</span>}\n                                                        {dog.gender === 'female' ? <i class='fas fa-venus' /> : <i class='fas fa-mars' />}\n                                                    </small>\n                                                    {dog.shortname || dog.name}<br />\n                                                    <div style='line-height: 0.8em;'><small>{userStore.findTeam(dog.team)}</small></div>\n                                                </small>\n                                                <small class='float-right'>\n                                                    {dogStatus && dogStatus.id && <span class={`badge badge-${dogStatus.class} mr-2 font-weight-light`}>{dogStatus.icon && <i class={dogStatus.icon} />} {dogStatus.name}</span>}\n                                                    {dog.specialNeeds && <span class={`badge badge-warning mr-2 font-weight-light`}><i class='fas fa-exclamation-triangle' /> {dog.specialNeeds}</span>}\n                                                    {dogHistoryStatuses && dogHistoryStatuses.map(v => (\n                                                        <span class={`badge badge-warning mr-2`} title={util.isoDate(v.endDate, false, false, true)}>{v.title}</span>\n                                                    ))}\n                                                </small>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            );\n                        })}\n                    </div>\n                </div>\n                {saved[`${field}.${object.id}`] ? <div class={`valid-feedback`} style='display: block;'><Text id='dog.dogs.saved-changes'>Endringene er lagret</Text></div> : \n                    <small id={`${field}Help`} class='form-text text-muted'>{help}</small>}\n\n\n                {showPositions && <>\n                    <div class='container-fluid px-0 clearfix'>\n                        <div class='row'>\n                            <div class='col-12'>\n                                <h5><Text id='dog.dogs.dogs-positions'>Posisjoner i spannet</Text></h5>\n                            </div>\n                        </div>\n                        <DragDropContext onDragEnd={this.onDragEnd}>\n                            <div class='row'>\n                                <div class='col-6 pr-0' style='min-height: 100px;'>\n                                    <Droppable droppableId=\"dogsLeft\">\n                                        {(provided, snapshot) => (\n                                            <List provided={provided} snapshot={snapshot} innerRef={provided.innerRef} className='ml-auto'>\n                                                {dogsLeft && dogsLeft.map((dog, idx) =>\n                                                    <Draggable key={`${dog.id}-${dog.unique}`} draggableId={`dragId-${dog.id}-${dog.unique}`} index={idx}>\n                                                        {provided => (\n                                                            <Dog provided={provided} snapshot={snapshot} innerRef={provided.innerRef} dog={dog} removePlaceholder={this.removePlaceholder} idx={idx} list='dogsLeft' />\n                                                        )}\n                                                    </Draggable>\n                                                )}\n                                                {provided.placeholder}\n                                            </List>\n                                        )}\n                                    </Droppable>\n                                </div>\n                                <div class='col-6 pl-0' style='min-height: 100px;'>\n                                    <Droppable droppableId=\"dogsRight\">\n                                        {(provided, snapshot) => (\n                                            <List provided={provided} snapshot={snapshot} innerRef={provided.innerRef} className='mr-auto'>\n                                                {dogsRight && dogsRight.map((dog, idx) =>\n                                                    <Draggable key={`${dog.id}-${dog.unique}`} draggableId={`dragId-${dog.id}-${dog.unique}`} index={idx}>\n                                                        {provided => (\n                                                            <Dog provided={provided} snapshot={snapshot} innerRef={provided.innerRef} dog={dog} removePlaceholder={this.removePlaceholder} idx={idx} list='dogsRight' />\n                                                        )}\n                                                    </Draggable>\n                                                )}\n                                                {provided.placeholder}\n                                            </List>\n                                        )}\n                                    </Droppable>\n                                </div>\n                            </div>\n                        </DragDropContext>\n                        <div class='row mb-3 mt-2'>\n                            <div class='col-6 pr-0'>\n                                <button class='btn btn-sm btn-outline-secondary' onClick={this.addPlaceholderLeft}>\n                                    <i class='fas fa-plus-circle' /> <Text id='dog.dogs.addplaceholder'>Add placeholder</Text>\n                                </button>\n                            </div>\n                            <div class='col-6 pl-0'>\n                                <button class='float-right btn btn-sm btn-outline-secondary' onClick={this.addPlaceholderRight}>\n                                    <i class='fas fa-plus-circle' /> <Text id='dog.dogs.addplaceholder'>Add placeholder</Text>\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                    <div class='container-fluid px-0'>\n                        <div class='row'>\n                            <div class='col-6'>\n                                <button class={`btn btn-sm btn-${dogPositionUpdated ? 'primary' : 'secondary'}`} onClick={this.updateDogPositions}>\n                                    <i class='fas fa-save' /> <Text id='dog.dogs.saveDogPositions'>Save dog positions</Text>\n                                </button>\n                            </div>\n                            <div class='col-6'>\n                                <button class={`float-right btn btn-sm btn-warning`} onClick={this.resetDogPositions}>\n                                    <i class='fas fa-sync' /> <Text id='dog.dogs.resetDogPositions'>Reset dog positions</Text>\n                                </button>\n                            </div>\n                        </div>\n                        <div class='row mt-2'>\n                            <div class='col-6'>\n                                &nbsp;\n                            </div>\n                            <div class='col-6'>\n                                <button class={`float-right btn btn-sm btn-link`} onClick={this.clearDogPositions}>\n                                    <i class='fas fa-eraser' /> <Text id='dog.dogs.clearDogPositions'>Clear dog positions</Text>\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </>}\n\n            </div>\n        );\n    }\n}\n\nexport default Dogs;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer, withText } from 'preact-i18n';\n\n@observer\nclass WorkoutSummary extends Component {\n    render() {\n        const { summary = {} } = this.props;\n\n        return (\n            <div class='w-100 mb-3'>\n                <div class='row'>\n                    <div class='col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 d-flex mb-0 position-relative'>\n                        {/* {JSON.stringify(workout, null, 4)} */}\n                        <div class={`text-center border rounded-circle imageRounded`}>\n                            <div class={`text-muted mt-2`} style='font-size: 40px; line-height: 1;'>{summary.week}</div>\n                            <div class={`text-muted`} style='font-size: 10px; line-height: 0.8em;'>{summary.year}</div>\n                        </div>\n                        <div class='flex-grow-1 pl-3'>\n                            <h5 class='my-0'>{summary.week} - {summary.year}</h5>\n                            <small class='text-muted'>\n                                <i class='fas fa-wave-square' /> {summary.count}\n                                <i class='fas fa-road ml-2' /> {util.format(summary.distanceKm, 0)}km\n                                <i class='fas fa-mountain ml-2' /> {util.format(summary.elevation, 0)}m\n                                <i class='fas fa-stopwatch ml-2' /> {util.secToHms(summary.duration)}\n                                <i class='fas fa-tachometer-alt ml-2' /> {util.format(summary.speedAvg, 1)}km/t\n                            </small>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default WorkoutSummary;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer, withText } from 'preact-i18n';\nimport linkState from 'linkstate';\n\nimport style from '../style.css';\nimport mu from '../../lib/musher-util';\n\n@observer\nclass WorkoutCommentReply extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            sendButtonEnabled: true,\n        };\n        this.inputRef = {};\n    }\n\n    commentWorkout = async () => {\n        const { sendButtonEnabled } = this.state;\n        if (!sendButtonEnabled) {\n            return false;\n        }\n        const { callback = () => {}, commentId, inputRefObject = {} } = this.props;\n        const { workout } = this.props;\n\t\tconst { workoutStore } = this.props.stores;\n        const { comment = '' } = this.state;\n        this.setState({ sendButtonEnabled: false });\n\t\tconst response = await workoutStore.commentReplyWorkout({ id: workout.id, commentId, comment });\n\t\tif (response && response.status === 200) {\n            this.setState({\n                comment: '',\n            }, () => {\n                mu.resizeTextarea(inputRefObject[commentId]);\n            });\n            callback({ workout, response, commentId });\n\t\t}\n        this.setState({ sendButtonEnabled: true });\n\t}\n\n    render() {\n        const { inputRef } = this.props;\n        const { comment, sendButtonEnabled } = this.state;\n        const { userStore } = this.props.stores;\n        const { user = {} } = userStore;\n        const displayNameShort = user.firstname ? `${util.ucfirst(user.firstname, true)}${util.ucfirst(user.lastname, true)}` : `${util.ucfirst(user.email || '', true)}`;\n        // const displayName = user.firstname ? `${user.firstname} ${user.lastname}` : `${user.email}`;\n        const userImage = user.image || (user.images ? user.images[0] : undefined);\n\n        return (\n            <div class='w-100'>\n                <div class='d-flex mb-0 position-relative w-100'>\n                    <div \n                        class={`text-center border rounded-circle imageRounded imageRoundedThumb`}\n                        style={`${userImage ? `background-image: url('${userImage.s3SmallLink}'); background-size: cover;` : ''} border-width: 3px !important;`}\n                    >\n                        {!userImage && <span class='font-weight-lighter' style='font-size: 15px;'>{displayNameShort}</span>}\n                    </div>\n                    <div class='col pl-3' style='line-height: 1.2em;'>\n\n                        <div class='d-flex bd-highlight'>\n                            <div class='p-0 w-100 bd-highlight'>\n                                <label class='sr-only' for='inlineFormInput'><Text id='comments.comment'>Kommentar</Text></label>\n                                <div class='border rounded rounded-lg position-relative'>\n                                    <Localizer>\n                                        <textarea\n                                            class='form-control-plaintext px-2'\n                                            type='text'\n                                            placeholder={<Text id='comments.write-comment'>Skriv en kommentar...</Text>}\n                                            onInput={linkState(this, 'comment')}\n                                            onKeyUp={mu.resizeTextarea}\n                                            style='height: 2.3em;'\n                                            value={comment}\n                                            ref={inputRef}\n                                        />\n                                    </Localizer>\n                                </div>\n                            </div>\n                            <div class='p-0 pl-2 flex-shrink-1 bd-highlight'>\n                                <button type='button' class={`btn btn-${sendButtonEnabled ? 'primary' : 'secondary'} mb-2`} disabled={!sendButtonEnabled}\n                                    onClick={this.commentWorkout}\n                                ><i class='fas fa-paper-plane' /></button>\n                            </div>\n                        </div>\n\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default WorkoutCommentReply;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { toJS } from 'mobx';\nimport { Text, Localizer, withText } from 'preact-i18n';\n\nimport Gauge from '../gauge';\n\nimport mu from '../../lib/musher-util';\n\n// const STOP_STATUSES = [2, 9];\n// const WARN_STATUSES = [4, 8];\n\nfunction getFatigueLevel(wo, dog) {\n    return 'secondary';\n    // if (dog) {\n    //     if (STOP_STATUSES.indexOf(dog.status) > -1) {\n    //         return 'danger';\n    //     } else if (WARN_STATUSES.indexOf(dog.status) > -1) {\n    //         return 'warning';\n    //     }\n    // }\n    // if (wo) {\n    //     if (wo.distanceKm > 50) {\n    //         return 'danger';\n    //     } else if (wo.distanceKm > 30) {\n    //         return 'warning';\n    //     }\n    // }\n    // return 'success';\n}\n\n@observer\nclass Dog extends Component {\n    render() {\n        const { dog, showWorkout, showInfo, hideTeam = false, fullWidth = false, daysBack = 7, filterBy = '' } = this.props;\n\t\tconst { userStore, dogStore, workoutPlanStore } = this.props.stores;\n        if (!dog) {\n            return '';\n        }\n        const { isAdmin, user } = userStore;\n        const { language = 'en' } = user;\n\n        const dogStatus = userStore.findDogstatus({ status: dog.status, language });\n        const dogStatuses = dog.statuses ? dog.statuses.map(e => userStore.findDogstatus({ status: e, language })) : [];\n\n        const dogPosition = userStore.findDogposition({ position: dog.position, language });\n\n        const workoutSummary = dogStore.findCurrentWorkoutSummary(dog.id) || {};\n\n        const currentWeek = util.getWeek(new Date());\n\t\tconst currentYear = util.getYear();\n        const currentMonth = new Date().getMonth() + 1;\n        const seasonStart = parseInt(currentMonth < 8 ? currentYear - 1 : currentYear, 10);\n\t\tconst { week = currentWeek, year = seasonStart } = this.props;\n\t\tconst planWeek = workoutPlanStore.sumWorkoutPlanDaysBack(parseInt(year, 10), parseInt(week, 10), daysBack) || 0;\n        const completedWeek = util.format(workoutSummary.distanceKm || 0, 0);\n        const hasBirthday = mu.hasBirthday(dog.birth);\n\n        let hasWorkoutPlan = false;\n        let percentComplete = 0;\n        if (completedWeek && planWeek) {\n            percentComplete = completedWeek / planWeek * 100;\n            hasWorkoutPlan = true;\n        }\n        return (\n                    <div class={`${fullWidth ? '' : 'col-4'} mb-3 ${hasWorkoutPlan ? 'mt-2' : ''} position-relative`}>\n                        {/* {JSON.stringify(dog, null, 4)} */}\n                        <div\n                            class={`text-center border border-${getFatigueLevel(workoutSummary, dog)} rounded-circle imageRounded mx-auto text-muted pt-2 position-relative`}\n                            style={`${dog.image ? `background-image: url(\"${dog.image.s3SmallLink}\"); background-size: cover;` : ''} border-width: 2px !important;`}\n                        >\n                            {/* {!dog.image && <i class='fas fa-dog mt-3' style='font-size: 40px;' />} */}\n                            {!dog.image && <span class='font-weight-lighter' style='font-size: 35px;'>{util.ucfirst(dog.name, true)}</span>}\n                            {hasWorkoutPlan && <div class='position-absolute' style='top: -12px; left: -12px;'>\n                                <Gauge key={`gauge-${percentComplete}`}\n                                    radius={48} \n                                    heightAdd={15}\n                                    showPercentText={false}\n                                    percent={percentComplete}\n                                    prefix='%'\n                                    total={`${planWeek} km`}\n                                    totalY='95%'\n                                    completed={`${completedWeek} km`}\n                                    completedY='85%'\n                                />\n                            </div>}\n                        </div>\n                        <div class={`${hasWorkoutPlan ? 'mt-4' : ''}`} style='line-height: 1.0em;'>\n                            <small>\n                                <span class='float-right'>\n                                    {dog.birth && <span class='mr-2'>{util.age(dog.birth, dog.deceased)}</span>}\n                                    {dog.gender === 'female' ? <i class='fas fa-venus' /> : <i class='fas fa-mars' />}\n                                </span>\n                                <a class='stretched-link' href={`/dogs/${dog.id}`}>\n                                    <h5 class='mb-1 font-weight-light' style='line-height: 1.0em; font-size: 1.3em;'>\n                                        {dog.shortname || dog.name}\n                                        {hasBirthday && <>\n                                            <i class='fas fa-birthday-cake ml-3' />\n                                        </>}\n                                    </h5>\n                                </a>\n                                {!hideTeam && <><span class='font-weight-light'>{userStore.findTeam(dog.team)}</span><br /></>}\n                            </small>\n\n                                {filterBy && dog.positions && dog.positions.lead && <div class=''>\n                                    {filterBy === 'leadOnly' && dog.positions.lead.distanceKm > 0 && <span class='badge badge-success mr-2'>\n                                        <span><Text id='dogs.sort-lead'>Lead</Text>:</span> {util.format(dog.positions.lead.distanceKm, 0)} km\n                                    </span>}\n                                    {filterBy === 'pointOnly' && dog.positions.point.distanceKm > 0 && <span class='badge badge-success mr-2'>\n                                        <span><Text id='dogs.sort-point'>Point</Text>:</span> {util.format(dog.positions.point.distanceKm, 0)} km\n                                    </span>}\n                                    {filterBy === 'teamOnly' && dog.positions.team.distanceKm > 0 && <span class='badge badge-success mr-2'>\n                                        <span><Text id='dogs.sort-team'>Team</Text>:</span> {util.format(dog.positions.team.distanceKm, 0)} km\n                                    </span>}\n                                    {filterBy === 'wheelOnly' && dog.positions.wheel.distanceKm > 0 && <span class='badge badge-success mr-2'>\n                                        <span><Text id='dogs.sort-wheel'>Wheel</Text>:</span> {util.format(dog.positions.wheel.distanceKm, 0)} km\n                                    </span>}\n                                </div>}\n\n                            <small>\n                                {showWorkout && <small class='text-muted'>\n                                    {workoutSummary && workoutSummary.distanceKm > 0 && <span class='mr-2'><i class='fas fa-road' /> {util.format(workoutSummary.distanceKm, 0)}km</span>}\n                                    {workoutSummary && workoutSummary.elevation > 0 && <span class='mr-2'><i class='fas fa-mountain' /> {util.format(workoutSummary.elevation, 0)}m</span>}\n                                    {workoutSummary && workoutSummary.duration > 0 && <span class='mr-2'><i class='fas fa-clock' /> {util.secToHms(workoutSummary.duration, true)}</span>}\n                                    {workoutSummary && workoutSummary.speedAvg > 0 && <span class='mr-2'><i class='fas fa-tachometer-alt' /> {util.format(workoutSummary.speedAvg, 1)}km/t</span>}\n                                </small>}\n\n                                {showInfo && <small class='text-muted'>\n                                    {dog.weight && <><i class='fas fa-balance-scale ml-2' /> {util.format(dog.weight, 1)} kg</>}\n                                    {dog.bodyScore && <><i class='fas fa-dog ml-2' /> {util.format(dog.bodyScore, 1)}</>}\n                                </small>}\n\n                                <div class='clearfix pb-0 pt-1'>\n                                    {dogPosition && dogPosition.class && <span class={`badge badge-${dogPosition.class || 'primary'} mr-2`}>{dogPosition.icon && <i class={dogPosition.icon} />} {dogPosition.name}</span>}\n                                    {dog.specialNeeds && <span class={`badge badge-warning mr-2`}><i class='fas fa-exclamation-triangle' /> {dog.specialNeeds}</span>}\n                                    {dogStatus && dogStatus.class && <span class={`badge badge-${dogStatus.class} mr-2 mt-1`}>{dogStatus.icon && <i class={dogStatus.icon} />} {dogStatus.name}</span>}\n                                    {dogStatuses && dogStatuses.map(status => <>\n                                        {status && status.class && <span class={`badge badge-${status.class} mr-2 mt-1`}>{status.icon && <i class={status.icon} />} {status.name}</span>}\n                                    </>)}\n                                </div>\n                            </small>\n                        </div>\n                    </div>\n        );\n    }\n}\n\nexport default Dog;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nfunction displayDistance(distance) {\n\tif (distance < 5) {\n\t\treturn util.format(distance, 2);\n\t}\n\tif (distance < 10) {\n\t\treturn util.format(distance, 1);\n\t}\n\treturn util.format(distance, 1);\n}\n\nfunction kmToMiles(value) {\n    return 0.621371 * value;\n}\n\n@observer\nclass Distance extends Component {\n    render() {\n\t\tconst { value = 0, smallUnit } = this.props;\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { settings = {} } = user;\n\n        if (settings.imperial) {\n            return (<>\n                <nobr>\n\t\t\t\t\t{displayDistance(kmToMiles(value))} {smallUnit ? <><small><small><small class='ml-0 text-muted'>mi</small></small></small></> : <>mi</>}\n\t\t\t\t</nobr>\n            </>);\n        }\n\n\t\treturn (<>\n\t\t\t<nobr>\n\t            {displayDistance(value)} {smallUnit ? <><small><small><small class='ml-0 text-muted'>km</small></small></small></> : <>km</>}\n\t\t\t</nobr>\n\t    </>);\n    }\n}\n\nexport default Distance;\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"hoverelementonly\":\"hoverelementonly__1mJGJ\",\"hoverElement\":\"hoverElement__axh3O\",\"hoverelementhide\":\"hoverelementhide__1k_qH\",\"progress-bar-vertical\":\"progress-bar-vertical__1B2sC\",\"progress-bar\":\"progress-bar__pnsVj\",\"dragged\":\"dragged__QXO46\",\"over\":\"over__1re3x\",\"list\":\"list__q_emZ\"};","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { toJS } from 'mobx';\nimport { Text, Localizer, withText } from 'preact-i18n';\nimport Markdown from 'preact-markdown';\n\nimport Modal from '../modal';\nimport WorkoutComments from '../../components/workout/comments';\nimport WorkoutAddComment from '../../components/workout/commentAdd';\nimport ImageScroller from '../../components/imageScroller';\nimport DogScroller from '../../components/dog/scroller';\n\nimport Overlay from '../../components/overlay/';\nimport TeamsPublicDetail from '../../routes/teams/publicDetail';\nimport DogPublicDetail from '../../routes/dogs/publicDetail';\n\nimport LikesAndComments from '../../components/feedback/likesAndComments';\nimport Views from '../../components/feedback/views';\n\nimport Speed from '../../components/data/speed';\nimport Elevation from '../../components/data/elevation';\nimport Weight from '../../components/data/weight';\nimport Distance from '../../components/data/distance';\nimport Temperature from '../../components/data/temperature';\n\nimport mu from '../../lib/musher-util';\n\nconst MAX_LOADINDEX = mu.getMaxLoadIndex();\n\nfunction getWorkoutColor(workout) {\n\tswitch (workout.type) {\n\t\tcase 1:\n\t\t\treturn 'border-primary';\n\t\tcase 2:\n\t\t\treturn 'border-danger';\n\t\tcase 3:\n\t\t\treturn 'border-success';\n\t\tcase 4:\n\t\t\treturn 'border-info';\n\t\tdefault:\n\t\t\treturn 'border-warning';\n\t}\n}\n\nfunction getWorkoutIcon(workout) {\n\tswitch (workout.type) {\n\t\tcase 1:\n\t\t\treturn 'fas fa-running';\n\t\tcase 2:\n\t\t\treturn 'fas fa-flag-checkered';\n\t\tcase 3:\n\t\t\treturn 'fas fa-hiking';\n\t\tcase 4:\n\t\t\treturn 'fas fa-futbol';\n\t\tdefault:\n\t\t\treturn 'fas fa-hiking';\n\t}\n}\n\nfunction displayDistance(distanceKm) {\n\tif (distanceKm < 5) {\n\t\treturn util.format(distanceKm, 2);\n\t}\n\tif (distanceKm < 10) {\n\t\treturn util.format(distanceKm, 1);\n\t}\n\treturn util.format(distanceKm, 1);\n}\n\nconst initialState = {\n\tshowAddComment: false,\n    viewImageIdx: {},\n    likeWorkout: {},\n};\n\n@observer\nclass Workout extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n        this.updateTimer = {};\n\t\tthis.inputRef = {};\n    }\n\n    toggleDate = (e) => {\n        e.stopPropagation();\n        e.preventDefault();\n        const { showDate } = this.state;\n        this.setState({ showDate: !showDate });\n    }\n\n\n\tlikeWorkout = async () => {\n\t\tconst { workoutStore } = this.props.stores;\n        const { workout } = this.props;\n        const workoutId = workout.id;\n\n        const { likeWorkout } = this.state;\n        likeWorkout[workoutId] = true;\n        this.setState({ likeWorkout });\n        setTimeout(() => {\n            const { likeWorkout } = this.state;\n            delete likeWorkout[workoutId];\n            this.setState({ likeWorkout });\n        }, 1200);\n\n\t\tconst response = await workoutStore.likeWorkout({ id: workoutId });\n        if (response && response.status === 200) {\n\n\t\t}\n\t}\n\n\ttoggleAddComment = (e) => {\n\t\tconst workoutId = e.target.parentElement.dataset.id || e.target.dataset.id;\n\t\tconst { showAddComment } = this.state;\n\t\tthis.setState({\n\t\t\tshowAddComment: !showAddComment,\n\t\t}, () => {\n\t\t\tif (this.inputRef[workoutId]) {\n\t\t\t\tthis.inputRef[workoutId].focus();\n\t\t\t}\n\t\t});\n\t}\n\n    viewImage = (e) => {\n\t\tconst { id, idx } = e.target.closest('img').dataset;\n        const { viewImageIdx } = this.state;\n        viewImageIdx[id] = idx;\n        this.setState({ viewImageIdx });\n    }\n\n    shareLink = (e) => {\n        const { url, title, text } = e.target.closest('button').dataset;\n        const { appState } = this.props.stores;\n        appState.shareUrl({ url, title, text });\n    }\n\n        // Overlay functions\n    onTeamClick = (e, teamid) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.setState({\n            showTeam: teamid,\n        });\n        return false;\n    }\n\n    hideTeam = () => {\n        this.setState({\n            showTeam: null,\n        });\n    }\n\n    onUserClick = (e, userid) => {\n        e.preventDefault();\n        e.stopPropagation();\n        return false;\n    }\n\n    onDogClick = (e, dogid, dogs) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.setState({\n            showDog: dogid,\n            dogs,\n        });\n        return false;\n    }\n\n    hideDog = () => {\n        this.setState({\n            showDog: null,\n        });\n    }\n\n    render() {\n        const {\n            showDate,\n            showAddComment,\n            viewImageIdx = {},\n            likeWorkout,\n            dogs,\n            showTeam,\n            showDog,\n        } = this.state;\n        const {\n            workout,\n            showDate: forceShowDate,\n            wrapperClasses = 'col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3',\n            wrapperClassesRow = 'row',\n        } = this.props;\n\t\tconst { userStore, appState, workoutStore } = this.props.stores;\n        const { viewmode, hasShareApi } = appState;\n        const { user, dogs: allDogs } = userStore;\n        const { language = 'en' } = user;\n        const intensity = userStore.findIntensity({ code: workout.intensity, language }) || {};\n        // const teamName = userStore.findTeam(workout.team);\n        const team = userStore.findTeam(workout.team, true) || {};\n        const teamName = team.name;\n        // const teamNames = workout.teams ? workout.teams.map(e => userStore.findTeam(e)) : [];\n        const teamNames = [];\n        if (teamName) {\n            teamNames.push(teamName);\n        }\n        if (workout.teams) {\n            workout.teams.forEach((e) => {\n                if (userStore.findTeam(e)) {\n                    teamNames.push(userStore.findTeam(e));\n                }\n            });\n        }\n\n        const { likes = [], comments = [] } = workout;\n\t\tconst hasLikedWorkout = workout.likes && workout.likes.findIndex(e => e.user === user.id) > -1;\n        const { gpxInfo = {}, mushers = [] } = workout;\n\t\tconst { loadIndex = 0 } = gpxInfo;\n        const workoutEquipment = userStore.findEquipment({ equipment: workout.equipment, language });\n        const workoutEquipmentIcon = userStore.findEquipment({ equipment: workout.equipment, field: 'icon' });\n\n        const musherImages = [];\n        if (mushers.length > 1) {\n            mushers.slice(1, 10).map((musher) => {\n                const u = workoutStore.findPublicUser(musher) || {};\n                if (u.images && u.images[0]) {\n                    musherImages.push(u.images[0]);\n                }\n            });\n        }\n\n        const publicUser = workoutStore.findPublicUser(mushers[0]) || {};\n        let image;\n        if (publicUser && publicUser.images && publicUser.images[0]) {\n            image = publicUser.images[0];\n        } else if (team.image && team.image.s3SmallLink) {\n            image = team.image;\n        } else if (team.images && team.images[0] && team.images[0].s3SmallLink) {\n            image = team.images[0];\n        } else if (workout.image && workout.image.s3SmallLink) {\n            image = workout.image;\n        }\n\n        const images = [];\n        if (workout.mapImage) {\n            images.push({\n                ...workout.mapImage,\n                type: 'map',\n            });\n        }\n        if (workout.images) {\n            const imgs = toJS(workout.images);\n            images.push(...imgs);\n        }\n        const imageIdx = viewImageIdx[workout.id] ? viewImageIdx[workout.id] : 0;\n        const currentImage = images && images[imageIdx] ? images[imageIdx] : null;\n\n        let batteryUsage;\n        if (workout && workout.gpxInfo && workout.gpxInfo.battegryLevelStart) {\n            batteryUsage = (workout.gpxInfo.battegryLevelStart - workout.gpxInfo.battegryLevelEnd) * 100;\n        }\n\n        const views = mu.getViews(workout.statistics);\n\n        // let temperature;\n        // let windSpeed;\n        // if (util.checkNested(workout, 'temperature')) {\n        //     const yr = toJS(workout.yr[0].instant.details);\n        //     // displayValue = `Yr.no: 🌡️ ${yr.air_temperature}°C, 💨 ${yr.wind_speed}m/s 🧭 ${mu.windDirection(yr.wind_from_direction)}, ☁️ ${yr.cloud_area_fraction}%, ${yr.air_pressure_at_sea_level}mb, 💦 ${yr.relative_humidity}%`;\n        //     temperature = `${yr.air_temperature}°C`;\n        //     windSpeed = `${yr.wind_speed}m/s`;\n        // }\n\t\t// // const loadMultiplier = loadIndex / 100;\n\n        return (<>\n\n            {showTeam && <Overlay>\n                <TeamsPublicDetail stores={this.props.stores} teamid={showTeam} marginTop={'0px;'} marginBottom={'0px;'} back={this.hideTeam} hideTeam={this.hideTeam} />\n            </Overlay>}\n\n            {showDog && <Overlay>\n                <DogPublicDetail stores={this.props.stores} dogid={showDog} marginTop={'0px;'} marginBottom={'0px;'} back={this.hideDog} dogs={dogs} />\n            </Overlay>}\n\n            <div class='w-100 mb-2'>\n                <div class={wrapperClassesRow}>\n\n                    <div class={`${wrapperClasses} d-flex mb-0 position-relative`}>\n\n                        {/* {workout.gpxInfo && <svg viewBox='0 0 300 300' style='top: 80px; left: 10px; width: 90px; height: 90px;' class='position-absolute'>\n                            <path d={`${workout.gpxInfo.svgMap}`} style='fill: none; stroke: #0063FF; stroke-width: 5; opacity: 0.3;' />\n                        </svg>} */}\n\n                        {/* {JSON.stringify(workout, null, 4)} */}\n                        <div class='text-center'>\n                            <div\n                                class={`position-relative text-center border rounded-circle imageRounded ${getWorkoutColor(workout)}`}\n                                style={`${image ? `background-image: url(\"${image.s3SmallLink}\"); background-size: cover;` : ''} border-width: 3px !important;`}\n                            >\n                                {!image && <i class={`${getWorkoutIcon(workout)} text-${intensity.class ? intensity.class : 'muted'} mt-3`} style='font-size: 40px;' />}\n\n                                {musherImages && musherImages.map((img, idx) => <>\n                                    <div\n                                        class='position-absolute rounded-circle imageRounded border imageRoundedThumb border-white'\n                                        style={`\n                                            background-image: url(\"${img.s3SmallLink}\");\n                                            background-size: cover;\n                                            bottom: -3px;\n                                            left: ${-5 + (idx * 10)}px;\n                                        `}\n                                    />\n                                </>)}\n                            </div>\n                            {workout.temperature !== 0 && <>\n                                <span class='text-muted font-weight-light'>\n                                    <Temperature stores={this.props.stores} value={workout.temperature} />\n                                </span>\n                            </>}\n                        </div>\n                        <div class='flex-grow-1 pl-3' style='line-height: 1.2em;'>\n                            <span class='float-right'>\n                                {workout.isLocked === 1 && <i class='fas fa-lock text-danger ml-3' />}\n                                {workout.isInProgress === 1 && <div class='spinner-grow text-success ml-3' role='status' />}\n                                {workout.isInProgress === 2 && <i class='fas fa-pause-circle text-warning ml-3' />}\n                            </span>\n                            <a class='stretched-link' href={`/workouts/${workout.id}`}>\n                                <h5 class='my-0 mb-1' style='line-height: 1.0em;'>\n                                    {workout.name}\n                                </h5>\n                            </a>\n                            {teamNames && teamNames.length > 0 && <small class='font-weight-lighter'>\n                                {teamNames.map((name, idx) => <>{idx > 0 ? ', ' : ''}{name}</>)}\n                            </small>}\n                            <br />\n                            <small class='text-muted'>\n                                {workout.date && <small onClick={this.toggleDate}>\n                                    {forceShowDate || showDate ? util.formatDate(workout.date, { locale: 'no-NB', hour12: false, hour: '2-digit', minute: '2-digit' }) : util.formatDistance(workout.date, new Date(), { locale: 'no-NB' })}\n                                </small>}\n                                <span class={`badge badge-${intensity.class} ml-2`}>{intensity.name}</span>\n                                {loadIndex > 0 && <span class={`ml-2 text-${mu.getLoadIndexColor(util.normalizeBetween(loadIndex, 0, MAX_LOADINDEX, 0, 100))}`}>\n                                    <i class='fas fa-hand-rock mr-1' />\n                                    {Math.floor(util.normalizeBetween(loadIndex, 0, MAX_LOADINDEX, 0, 100))} -&nbsp;\n                                    {mu.getLoadIndexText(util.normalizeBetween(loadIndex, 0, MAX_LOADINDEX, 0, 100))}\n                                </span>}\n                                <br />\n                            </small>\n                            <small>\n                                <div class='text-muted'>\n                                    {workout.garminId > 0 && <div class={`float-left mr-2 text-center border rounded-circle imageRounded imageRoundedIcon`} style={`background-image: url(\"./assets/garmin-connect.png\");`} />}\n                                    {workout.stravaId > 0&& <div class={`float-left mr-2 text-center border rounded-circle imageRounded imageRoundedIcon`} style={`background-image: url(\"./assets/strava-icon.png\");`} />}\n\n                                    {workout.equipment > 0 && <><i class={`${workoutEquipmentIcon} ml-2`} /> {workoutEquipment}</>}\n                                    {/* {workout.distanceKm > 0 && <><i class='fas fa-road ml-2' /> {displayDistance(workout.distanceKm)}km</>}\n                                    {workout.elevation > 0 && <><i class='fas fa-mountain ml-2' /> {util.format(workout.elevation, 0)}m</>} */}\n                                    {/* {workout.speedAvg > 0 && <><i class='fas fa-tachometer-alt ml-2' /> {util.format(workout.speedAvg, 1)}km/t</>} */}\n                                    {workout.dogs > 0 && <><i class='fas fa-dog ml-2' /> {workout.dogs.length}</>}\n                                    {workout.track > 0 && <><i class={`fas fa-map-marked text-${workout.track > 0 ? 'success' : 'danger'} ml-2`} /></>}\n                                    {workout.dogsLeft > 0 && <><i class={`fas fa-crosshairs text-${workout.dogsLeft && workout.dogsRight ? 'success' : 'danger'} ml-2`} /></>}\n                                    {workout.sledWeight > 0 && <>\n                                        <i class='fas fa-sleigh ml-2' /> <Weight stores={this.props.stores} value={workout.sledWeight} />\n                                    </>}\n                                    {batteryUsage > 0 && <span class='text-muted ml-2'><i class='fas fa-battery-three-quarters' /> {util.format(batteryUsage, 1)}% <Text id='workout.battery-used'>used</Text></span>}\n                                </div>\n                                {['beta', 'advanced'].indexOf(viewmode) > -1 && (\n                                    <span class='text-muted'>\n                                        <i class='fas fa-balance-scale' /> {util.format(workout.kcalBurnedTotal)} <Text id='workout.kcal'>kcal</Text>\n                                        <i class='fas fa-drumstick-bite ml-2' /> <Weight stores={this.props.stores} value={workout.kcalMeatGramsTotal / 1000} />\n                                        <i class='fas fa-fish ml-2' /> <Weight stores={this.props.stores} value={workout.kcalSalmonGramsTotal / 1000} />\n                                        <i class='fas fa-piggy-bank ml-2' /> <Weight stores={this.props.stores} value={workout.kcalFatGramsTotal / 1000} />\n                                    </span>\n                                )}\n                            </small>\n                        </div>\n                    </div>\n                    <div class={`${wrapperClasses} position-relative mt-2`}>\n                        <strong>\n                            {workout.description}\n                        </strong>\n                    </div>\n                    <div class={`${wrapperClasses} position-relative`}>\n                        <Markdown markdown={mu.replaceImages(workout.comment, workout.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                    </div>\n                    <div class={`${wrapperClasses} d-flex mb-0 position-relative`}>\n                        <div class='container-fluid px-0'>\n                            <div class='row mt-1'>\n                                {workout.distanceKm > 0 && <div class='col-3'>\n                                    <div class='text-overflow'>\n                                        <small><i class='fas fa-road' /> <Text id='workout.calendar.distance'>Distanse</Text></small>\n                                    </div>\n                                    <div class='text-overflow font-weight-light' style='font-size: 1.2em;'>\n                                        <Distance stores={this.props.stores} value={workout.distanceKm} />\n                                    </div>\n                                </div>}\n                                {workout.elevation > 0 && <div class='col-3'>\n                                    <div class='text-overflow'>\n                                        <small><i class='fas fa-mountain' /> <Text id='workout.calendar.ascend'>Høydemeter</Text></small>\n                                    </div>\n                                    <div class='text-overflow font-weight-light' style='font-size: 1.2em;'>\n                                        <Elevation stores={this.props.stores} value={workout.elevation} />\n                                    </div>\n                                </div>}\n                                {workout.duration > 0 && <div class='col-3'>\n                                    <div class='text-overflow'>\n                                        <small><i class='fas fa-clock' /> <Text id='workout.calendar.duration'>Varighet</Text></small>\n                                    </div>\n                                    <div class='text-overflow font-weight-light' style='font-size: 1.2em;'>\n                                        {util.secToHms(workout.duration, true)}\n                                    </div>\n                                </div>}\n                                {workout.speedAvg > 0 && <div class='col-3'>\n                                    <div class='text-overflow'>\n                                        <small><i class='fas fa-tachometer-alt' /> <Text id='workout.calendar.avg-speed'>Snittfart</Text></small>\n                                    </div>\n                                    <div class='text-overflow font-weight-light' style='font-size: 1.2em;'>\n\t\t\t\t                        {workout.gpxInfo && workout.gpxInfo.avgGpsMovingSpeed > 0 ? <>\n                                            <Speed stores={this.props.stores} value={workout.gpxInfo.avgGpsMovingSpeed * 3.6} />\n                                        </> : <>\n                                            <Speed stores={this.props.stores} value={workout.speedAvg} />\n                                        </>}\n                                    </div>\n                                </div>}\n                            </div>\n                        </div>\n                    </div>\n\n                    {['beta', 'advanced', 'normal'].indexOf(viewmode) > -1 && (\n                        <div class={`${wrapperClasses}`}>\n                            <div class='container-fluid px-0 mt-1'>\n                                <div class='row'>\n                                    <ImageScroller stores={this.props.stores} images={images} id={workout.id} dblClick={this.likeWorkout} likeRef={likeWorkout} />\n                                </div>\n                            </div>\n                        </div>\n                    )}\n\n                    {['beta', 'advanced', 'normal'].indexOf(viewmode) > -1 && <>\n                        {workout.dogs && workout.dogs.length > 0 && <div class='container-fluid px-0 mt-1'>\n                            <div class='row pt-2'>\n                                <DogScroller stores={this.props.stores} dogs={workout.dogs} allDogs={allDogs} onDogClick={this.onDogClick} />\n                            </div>\n                        </div>}\n\n                        <div class='mt-2'>\n                            <LikesAndComments\n                                stores={this.props.stores}\n                                likes={likes}\n                                comments={comments}\n                                type='workout'\n                                onTeamClick={this.onTeamClick}\n                                onUserClick={this.onUserClick}\n                            />\n                        </div>\n\n                    </>}\n\n                    {['beta', 'advanced', 'normal'].indexOf(viewmode) > -1 && <>\n                        <div class={`${wrapperClasses} mb-0 position-relative mt-2`}>\n                            <div class='row'>\n                                <div class='col text-center'>\n                                    <button type='button' class={`btn btn-sm btn-outline-${hasLikedWorkout ? 'primary' : 'secondary'} btn-lg btn-block ${hasLikedWorkout ? 'text-primary' : ''}`}\n                                        onClick={this.likeWorkout}\n                                        // disabled={hasLikedWorkout}\n                                    >\n                                        <i class={`${hasLikedWorkout ? 'text-primary fas' : 'far'} fa-thumbs-up`} /> <Text id='comments.like'>Lik</Text>\n                                    </button>\n                                </div>\n                                <div class='col text-center'>\n                                    <button type='button' class='btn btn-sm btn-outline-secondary btn-lg btn-block'\n                                        data-id={workout.id}\n                                        onClick={this.toggleAddComment}\n                                    >\n                                        <i class='fas fa-comment' /> <Text id='comments.comment-add'>Kommentar</Text>\n                                    </button>\n                                </div>\n                                {hasShareApi ? <>\n                                    <div class='col text-center'>\n                                        <button class='btn btn-sm btn-outline-secondary btn-lg btn-block text-overflow'\n                                            onClick={this.shareLink}\n                                            data-url={`https://themusher.app/share/workout/${workout.uuidv4}`}\n                                            data-title={`title: ${workout.name}`}\n                                        >\n                                            <i class='fas fa-share' /> <Text id='workout.share'>Del</Text>\n                                        </button>\n                                    </div>\n                                </> : <>\n                                    <div class='col text-center'>\n                                        <a class='btn btn-sm btn-outline-secondary btn-lg btn-block text-overflow'\n                                            href={`https://themusher.app/share/workout/${workout.uuidv4}`}\n                                            target='_blank'\n                                            rel='noreferrer'\n                                            data-native\n                                        >\n                                            <i class='fas fa-share' /> <Text id='workout.share'>Del</Text>\n                                        </a>\n                                    </div>\n                                </>}\n                            </div>\n                        </div>\n\n                        <div class={`${wrapperClasses} mt-2 mb-3`}>\n                            {showAddComment && <WorkoutAddComment\n                                stores={this.props.stores}\n                                workout={workout}\n                                inputRef={c => this.inputRef[workout.id] = c}\n                                inputRefObject={this.inputRef}\n                                col='12'\n                                offset='0'\n                            />}\n                            <WorkoutComments stores={this.props.stores} workout={workout} col='10' offset='2' compact={true} />\n                        </div>\n\n                        {views > 0 && <>\n                            <div class='mt-2'>\n                                <Views\n                                    stores={this.props.stores}\n                                    views={views}\n                                    object={workout}\n                                    type='workout'\n                                    isTeamAdmin={true}\n                                    isAdmin={false}\n                                    onTeamClick={this.onTeamClick}\n                                    onUserClick={this.onUserClick}\n                                />\n                            </div>\n                        </>}\n\n                    </>}\n\n                </div>\n            </div>\n        </>);\n    }\n}\n\nexport default Workout;\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n\nfunction emptyFunction() {}\nfunction emptyFunctionWithReset() {}\nemptyFunctionWithReset.resetWarningCache = emptyFunction;\n\nmodule.exports = function() {\n  function shim(props, propName, componentName, location, propFullName, secret) {\n    if (secret === ReactPropTypesSecret) {\n      // It is still safe when called from React.\n      return;\n    }\n    var err = new Error(\n      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n      'Use PropTypes.checkPropTypes() to call them. ' +\n      'Read more at http://fb.me/use-check-prop-types'\n    );\n    err.name = 'Invariant Violation';\n    throw err;\n  };\n  shim.isRequired = shim;\n  function getShim() {\n    return shim;\n  };\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n  var ReactPropTypes = {\n    array: shim,\n    bool: shim,\n    func: shim,\n    number: shim,\n    object: shim,\n    string: shim,\n    symbol: shim,\n\n    any: shim,\n    arrayOf: getShim,\n    element: shim,\n    elementType: shim,\n    instanceOf: getShim,\n    node: shim,\n    objectOf: getShim,\n    oneOf: getShim,\n    oneOfType: getShim,\n    shape: getShim,\n    exact: getShim,\n\n    checkPropTypes: emptyFunctionWithReset,\n    resetWarningCache: emptyFunction\n  };\n\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nfunction celciusToFahrenheit(value) {\n    return ((value * 9/5) + 32);\n}\n\n@observer\nclass Temperature extends Component {\n    render() {\n\t\tconst { value = 0, smallUnit } = this.props;\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { settings = {} } = user;\n\n        if (settings.imperial) {\n            return (<>\n                <nobr>\n                    {util.format(celciusToFahrenheit(value), 0)}°F\n                </nobr>\n            </>);\n        }\n\n\t\treturn (<>\n            <nobr>\n                {util.format(value, 1)}°C\n            </nobr>\n        </>);\n    }\n}\n\nexport default Temperature;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer, withText } from 'preact-i18n';\n\n@observer\nclass Modal extends Component {\n    toggleDate = () => {\n        const { showDate } = this.state;\n        this.setState({ showDate: !showDate });\n    }\n\n    touchStart = (e) => {\n        e.stopPropagation();\n        this.setState({\n            startY: e.touches[0].pageY,\n        })\n    }\n\n    touchEnd = (e) => {\n        e.stopPropagation();\n        this.setState({\n            startY: undefined,\n            readyToRefresh: false,\n        })\n    }\n\n    touchMove = (e) => {\n        e.stopPropagation();\n        const { close } = this.props;\n        const { startY, refreshing } = this.state;\n        const scrollDistance = 30;\n        const y = e.touches[0].pageY;\n        if (this.appContainer) {\n            const { scrollTop } = this.appContainer;\n            if (scrollTop === 0 && y > startY + scrollDistance && !refreshing) {\n                close();\n            }\n        }\n    }\n\n    render() {\n        const { showDate } = this.state;\n        const { image, imagexxl, close, thumb, name, title, date } = this.props;\n        return (\n            <div class='fixed-top bg-dark text-center pt-2' style='width: 100vw; height: 100vh;'>\n                <button class='btn btn-secondary float-right mr-2' onClick={close}>X</button>\n\n                    <div class='d-flex mb-2 px-2'>\n                        {/* {JSON.stringify(dog, null, 4)} */}\n                        {thumb && <div class={`text-center border rounded-circle imageRounded imageRoundedSmall`} style={thumb ? `background-image: url(\"${thumb}\");` : ''}>\n                            &nbsp;\n                        </div>}\n                        <div class='flex-grow-1 pl-3 pr-2 text-left' style='line-height: 1.3em;'>\n                            {name && <strong class='mr-2'>{name}:</strong>}\n                            {title}<br />\n                            <small class='text-muted'>\n                                {date && <small onClick={this.toggleDate}>\n                                    {showDate ? util.formatDate(date, { locale: 'no-NB' }) : util.formatDistance(date, new Date(), { locale: 'no-NB' })}\n                                </small>}\n                            </small>\n                        </div>\n                    </div>\n\n\n                <img src={image}\n                    class='img-fluid align-middle mt-2 mb-2'\n                    onClick={close}\n                    onTouchstart={this.touchStart}\n                    onTouchend={this.touchEnd}\n                    onTouchmove={this.touchMove}\n                    ref={c => this.appContainer = c}\n                />\n\n                <a target='_blank' rel='noopener noreferrer' href={imagexxl || image} download={imagexxl || image}>\n                    <i class='fas fa-download' /> <Text id='modal.download'>Last ned bildet</Text>\n                </a>\n            </div>\n        );\n    }\n}\n\nexport default Modal;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nfunction kgToPounds(value) {\n    return 2.20462 * value;\n}\n\n@observer\nclass Weight extends Component {\n    render() {\n\t\tconst { value = 0, smallUnit } = this.props;\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { settings = {} } = user;\n\n        if (settings.imperial) {\n            return (<>\n                <nobr>\n                    {util.format(kgToPounds(value), 0)} lb\n                </nobr>\n            </>);\n        }\n\n\t\treturn (<>\n            <nobr>\n                {util.format(value, 0)} kg\n            </nobr>\n        </>);\n    }\n}\n\nexport default Weight;\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var ReactIs = require('react-is');\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = require('./factoryWithTypeCheckers')(ReactIs.isElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = require('./factoryWithThrowingShims')();\n}\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport DogSimplePublic from './simplePublic';\n\n@observer\nclass DogScroller extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            imageIdx: 0,\n        };\n    }\n\n    scrollImages = (e) => {\n        const { dogs } = this.props;\n\n        const { scrollLeft, scrollWidth, clientWidth } = e.target;\n        const imageStep = clientWidth;\n        const imageIdx = scrollLeft / imageStep;\n        // console.log({ e, imageStep, imageIdx, scrollLeft, scrollWidth, clientWidth });\n\n        const nearestInt = Math.round(imageIdx);\n        const diff = Math.abs(nearestInt - imageIdx);\n        // console.log({ nearestInt, diff });\n        if (Number.isInteger(imageIdx) || diff < 0.1) {\n            this.setState({\n                imageIdx: nearestInt,\n            });\n        }\n    }\n\n    sortByName = (a, b) => {\n        const { allDogs = [] } = this.props;\n        const dogA = allDogs.find(e => e.id === a);\n        const dogB = allDogs.find(e => e.id === b);\n        if (dogA && dogB) {\n            if (dogA.name > dogB.name) {\n                return 1;\n            }\n        }\n        return -1;\n    }\n\n    render() {\n        const { imageIdx } = this.state;\n        const { dogs, allDogs = [], size = 'medium', onDogClick = () => {} } = this.props;\n\n        return (\n            <div class='w-100'>\n                <div\n                    class='d-flex flex-row flex-nowrap no-scrollbar'\n                    style='overflow: auto; scroll-snap-type: x mandatory;'\n                    onScroll={this.scrollImages}\n                >\n                    {dogs && dogs.sort(this.sortByName).map((dogId, idx) => {\n                        const dog = allDogs.find(e => e.id === dogId);\n                        if (!dog) {\n                            return '';\n                        }\n                        return (\n                            <div class='col clearfix position-relative p-0 mx-2'>\n                                <div\n                                    class={`w-100 h-100 text-center rounded-lg imageContainer d-flex justify-content-center align-items-center`}\n                                    style={`\n                                        flex-wrap: wrap;\n                                        overflow-y: hidden;\n                                    `}\n                                    onTouchstart={(e) => { e.stopPropagation(); }}\n                                    onTouchend={(e) => { e.stopPropagation(); }}\n                                    onTouchmove={(e) => { e.stopPropagation(); }}\n                                >\n                                    <DogSimplePublic\n                                        stores={this.props.stores}\n                                        dog={dog}\n                                        dogs={allDogs.filter(d => dogs.indexOf(d.id) > -1).sort((a, b) => a.name > b.name ? 1 : -1)}\n                                        className='mx-auto'\n                                        showName={true}\n                                        showPosition={false}\n                                        size={size}\n                                        onDogClick={onDogClick} \n                                    />\n                                    {/* <xmp>{JSON.stringify(img, null, 4)}</xmp> */}\n                                </div>\n                            </div>\n                        );\n                    })}\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default DogScroller;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"gaugeBackground\":\"gaugeBackground__1UGxt\",\"gauge\":\"gauge__2ZDxd\",\"success\":\"success__3UQxg\",\"primary\":\"primary__3pPV6\",\"secondary\":\"secondary__-Vrk_\",\"info\":\"info__3t5zs\",\"warning\":\"warning__1jHlR\",\"danger\":\"danger__BLVC9\",\"gaugeText\":\"gaugeText__1on-w\"};","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nfunction meterToFeet(value) {\n    return 3.28084 * value;\n}\n\n@observer\nclass Elevation extends Component {\n    render() {\n\t\tconst { value = 0, smallUnit } = this.props;\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { settings = {} } = user;\n\n        if (settings.imperial) {\n            return (<>\n                <nobr>\n                    {util.format(meterToFeet(value), 0)} {smallUnit ? <><small><small><small class='ml-0 text-muted'>ft</small></small></small></> : <>ft</>}\n                </nobr>\n            </>);\n        }\n\n\t\treturn (<>\n            <nobr>\n                {util.format(value, 0)} {smallUnit ? <><small><small><small class='ml-0 text-muted'>m</small></small></small></> : <>m</>}\n            </nobr>\n        </>);\n    }\n}\n\nexport default Elevation;\n","/**\n * Assign properties from `props` to `obj`\n * @template O, P The obj and props types\n * @param {O} obj The object to copy properties to\n * @param {P} props The object to copy properties from\n * @returns {O & P}\n */\nexport function assign(obj, props) {\n\tfor (let i in props) obj[i] = props[i];\n\treturn /** @type {O & P} */ (obj);\n}\n\n/**\n * Check if two objects have a different shape\n * @param {object} a\n * @param {object} b\n * @returns {boolean}\n */\nexport function shallowDiffers(a, b) {\n\tfor (let i in a) if (i !== '__source' && !(i in b)) return true;\n\tfor (let i in b) if (i !== '__source' && a[i] !== b[i]) return true;\n\treturn false;\n}\n","import { Component } from 'preact';\nimport { shallowDiffers } from './util';\n\n/**\n * Component class with a predefined `shouldComponentUpdate` implementation\n */\nexport function PureComponent(p) {\n\tthis.props = p;\n}\nPureComponent.prototype = new Component();\n// Some third-party libraries check if this property is present\nPureComponent.prototype.isPureReactComponent = true;\nPureComponent.prototype.shouldComponentUpdate = function(props, state) {\n\treturn shallowDiffers(this.props, props) || shallowDiffers(this.state, state);\n};\n","import { createElement } from 'preact';\nimport { shallowDiffers } from './util';\n\n/**\n * Memoize a component, so that it only updates when the props actually have\n * changed. This was previously known as `React.pure`.\n * @param {import('./internal').FunctionComponent} c functional component\n * @param {(prev: object, next: object) => boolean} [comparer] Custom equality function\n * @returns {import('./internal').FunctionComponent}\n */\nexport function memo(c, comparer) {\n\tfunction shouldUpdate(nextProps) {\n\t\tlet ref = this.props.ref;\n\t\tlet updateRef = ref == nextProps.ref;\n\t\tif (!updateRef && ref) {\n\t\t\tref.call ? ref(null) : (ref.current = null);\n\t\t}\n\n\t\tif (!comparer) {\n\t\t\treturn shallowDiffers(this.props, nextProps);\n\t\t}\n\n\t\treturn !comparer(this.props, nextProps) || !updateRef;\n\t}\n\n\tfunction Memoed(props) {\n\t\tthis.shouldComponentUpdate = shouldUpdate;\n\t\treturn createElement(c, props);\n\t}\n\tMemoed.displayName = 'Memo(' + (c.displayName || c.name) + ')';\n\tMemoed.prototype.isReactComponent = true;\n\tMemoed._forwarded = true;\n\treturn Memoed;\n}\n","import { options } from 'preact';\nimport { assign } from './util';\n\nlet oldDiffHook = options._diff;\noptions._diff = vnode => {\n\tif (vnode.type && vnode.type._forwarded && vnode.ref) {\n\t\tvnode.props.ref = vnode.ref;\n\t\tvnode.ref = null;\n\t}\n\tif (oldDiffHook) oldDiffHook(vnode);\n};\n\nexport const REACT_FORWARD_SYMBOL =\n\t(typeof Symbol != 'undefined' &&\n\t\tSymbol.for &&\n\t\tSymbol.for('react.forward_ref')) ||\n\t0xf47;\n\n/**\n * Pass ref down to a child. This is mainly used in libraries with HOCs that\n * wrap components. Using `forwardRef` there is an easy way to get a reference\n * of the wrapped component instead of one of the wrapper itself.\n * @param {import('./index').ForwardFn} fn\n * @returns {import('./internal').FunctionComponent}\n */\nexport function forwardRef(fn) {\n\t// We always have ref in props.ref, except for\n\t// mobx-react. It will call this function directly\n\t// and always pass ref as the second argument.\n\tfunction Forwarded(props, ref) {\n\t\tlet clone = assign({}, props);\n\t\tdelete clone.ref;\n\t\tref = props.ref || ref;\n\t\treturn fn(\n\t\t\tclone,\n\t\t\t!ref || (typeof ref === 'object' && !('current' in ref)) ? null : ref\n\t\t);\n\t}\n\n\t// mobx-react checks for this being present\n\tForwarded.$$typeof = REACT_FORWARD_SYMBOL;\n\t// mobx-react heavily relies on implementation details.\n\t// It expects an object here with a `render` property,\n\t// and prototype.render will fail. Without this\n\t// mobx-react throws.\n\tForwarded.render = Forwarded;\n\n\tForwarded.prototype.isReactComponent = Forwarded._forwarded = true;\n\tForwarded.displayName = 'ForwardRef(' + (fn.displayName || fn.name) + ')';\n\treturn Forwarded;\n}\n","import { Component, createElement, options, Fragment } from 'preact';\nimport { assign } from './util';\n\nconst oldCatchError = options._catchError;\noptions._catchError = function(error, newVNode, oldVNode) {\n\tif (error.then) {\n\t\t/** @type {import('./internal').Component} */\n\t\tlet component;\n\t\tlet vnode = newVNode;\n\n\t\tfor (; (vnode = vnode._parent); ) {\n\t\t\tif ((component = vnode._component) && component._childDidSuspend) {\n\t\t\t\tif (newVNode._dom == null) {\n\t\t\t\t\tnewVNode._dom = oldVNode._dom;\n\t\t\t\t\tnewVNode._children = oldVNode._children;\n\t\t\t\t}\n\t\t\t\t// Don't call oldCatchError if we found a Suspense\n\t\t\t\treturn component._childDidSuspend(error, newVNode);\n\t\t\t}\n\t\t}\n\t}\n\toldCatchError(error, newVNode, oldVNode);\n};\n\nfunction detachedClone(vnode) {\n\tif (vnode) {\n\t\tif (vnode._component && vnode._component.__hooks) {\n\t\t\tvnode._component.__hooks._list.forEach(effect => {\n\t\t\t\tif (typeof effect._cleanup == 'function') effect._cleanup();\n\t\t\t});\n\n\t\t\tvnode._component.__hooks = null;\n\t\t}\n\n\t\tvnode = assign({}, vnode);\n\t\tvnode._component = null;\n\t\tvnode._children = vnode._children && vnode._children.map(detachedClone);\n\t}\n\n\treturn vnode;\n}\n\nfunction removeOriginal(vnode) {\n\tif (vnode) {\n\t\tvnode._original = null;\n\t\tvnode._children = vnode._children && vnode._children.map(removeOriginal);\n\t}\n\treturn vnode;\n}\n\n// having custom inheritance instead of a class here saves a lot of bytes\nexport function Suspense() {\n\t// we do not call super here to golf some bytes...\n\tthis._pendingSuspensionCount = 0;\n\tthis._suspenders = null;\n\tthis._detachOnNextRender = null;\n}\n\n// Things we do here to save some bytes but are not proper JS inheritance:\n// - call `new Component()` as the prototype\n// - do not set `Suspense.prototype.constructor` to `Suspense`\nSuspense.prototype = new Component();\n\n/**\n * @this {import('./internal').SuspenseComponent}\n * @param {Promise} promise The thrown promise\n * @param {import('./internal').VNode<any, any>} suspendingVNode The suspending component\n */\nSuspense.prototype._childDidSuspend = function(promise, suspendingVNode) {\n\tconst suspendingComponent = suspendingVNode._component;\n\n\t/** @type {import('./internal').SuspenseComponent} */\n\tconst c = this;\n\n\tif (c._suspenders == null) {\n\t\tc._suspenders = [];\n\t}\n\tc._suspenders.push(suspendingComponent);\n\n\tconst resolve = suspended(c._vnode);\n\n\tlet resolved = false;\n\tconst onResolved = () => {\n\t\tif (resolved) return;\n\n\t\tresolved = true;\n\t\tsuspendingComponent.componentWillUnmount =\n\t\t\tsuspendingComponent._suspendedComponentWillUnmount;\n\n\t\tif (resolve) {\n\t\t\tresolve(onSuspensionComplete);\n\t\t} else {\n\t\t\tonSuspensionComplete();\n\t\t}\n\t};\n\n\tsuspendingComponent._suspendedComponentWillUnmount =\n\t\tsuspendingComponent.componentWillUnmount;\n\tsuspendingComponent.componentWillUnmount = () => {\n\t\tonResolved();\n\n\t\tif (suspendingComponent._suspendedComponentWillUnmount) {\n\t\t\tsuspendingComponent._suspendedComponentWillUnmount();\n\t\t}\n\t};\n\n\tconst onSuspensionComplete = () => {\n\t\tif (!--c._pendingSuspensionCount) {\n\t\t\t// If the suspension was during hydration we don't need to restore the\n\t\t\t// suspended children into the _children array\n\t\t\tif (c.state._suspended) {\n\t\t\t\tc._vnode._children[0] = removeOriginal(c.state._suspended);\n\t\t\t}\n\n\t\t\tc.setState({ _suspended: (c._detachOnNextRender = null) });\n\n\t\t\tlet suspended;\n\t\t\twhile ((suspended = c._suspenders.pop())) {\n\t\t\t\tsuspended.forceUpdate();\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\n\t * We do not set `suspended: true` during hydration because we want the actual markup\n\t * to remain on screen and hydrate it when the suspense actually gets resolved.\n\t * While in non-hydration cases the usual fallback -> component flow would occour.\n\t */\n\tconst wasHydrating = suspendingVNode._hydrating === true;\n\tif (!c._pendingSuspensionCount++ && !wasHydrating) {\n\t\tc.setState({ _suspended: (c._detachOnNextRender = c._vnode._children[0]) });\n\t}\n\tpromise.then(onResolved, onResolved);\n};\n\nSuspense.prototype.componentWillUnmount = function() {\n\tthis._suspenders = [];\n};\n\n/**\n * @this {import('./internal').SuspenseComponent}\n * @param {import('./internal').SuspenseComponent[\"props\"]} props\n * @param {import('./internal').SuspenseState} state\n */\nSuspense.prototype.render = function(props, state) {\n\tif (this._detachOnNextRender) {\n\t\t// When the Suspense's _vnode was created by a call to createVNode\n\t\t// (i.e. due to a setState further up in the tree)\n\t\t// it's _children prop is null, in this case we \"forget\" about the parked vnodes to detach\n\t\tif (this._vnode._children) {\n\t\t\tthis._vnode._children[0] = detachedClone(this._detachOnNextRender);\n\t\t}\n\n\t\tthis._detachOnNextRender = null;\n\t}\n\n\t// Wrap fallback tree in a VNode that prevents itself from being marked as aborting mid-hydration:\n\t/** @type {import('./internal').VNode} */\n\tconst fallback =\n\t\tstate._suspended && createElement(Fragment, null, props.fallback);\n\tif (fallback) fallback._hydrating = null;\n\n\treturn [\n\t\tcreateElement(Fragment, null, state._suspended ? null : props.children),\n\t\tfallback\n\t];\n};\n\n/**\n * Checks and calls the parent component's _suspended method, passing in the\n * suspended vnode. This is a way for a parent (e.g. SuspenseList) to get notified\n * that one of its children/descendants suspended.\n *\n * The parent MAY return a callback. The callback will get called when the\n * suspension resolves, notifying the parent of the fact.\n * Moreover, the callback gets function `unsuspend` as a parameter. The resolved\n * child descendant will not actually get unsuspended until `unsuspend` gets called.\n * This is a way for the parent to delay unsuspending.\n *\n * If the parent does not return a callback then the resolved vnode\n * gets unsuspended immediately when it resolves.\n *\n * @param {import('./internal').VNode} vnode\n * @returns {((unsuspend: () => void) => void)?}\n */\nexport function suspended(vnode) {\n\t/** @type {import('./internal').Component} */\n\tlet component = vnode._parent._component;\n\treturn component && component._suspended && component._suspended(vnode);\n}\n\nexport function lazy(loader) {\n\tlet prom;\n\tlet component;\n\tlet error;\n\n\tfunction Lazy(props) {\n\t\tif (!prom) {\n\t\t\tprom = loader();\n\t\t\tprom.then(\n\t\t\t\texports => {\n\t\t\t\t\tcomponent = exports.default || exports;\n\t\t\t\t},\n\t\t\t\te => {\n\t\t\t\t\terror = e;\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tif (error) {\n\t\t\tthrow error;\n\t\t}\n\n\t\tif (!component) {\n\t\t\tthrow prom;\n\t\t}\n\n\t\treturn createElement(component, props);\n\t}\n\n\tLazy.displayName = 'Lazy';\n\tLazy._forwarded = true;\n\treturn Lazy;\n}\n","import { Component, toChildArray } from 'preact';\nimport { suspended } from './suspense.js';\n\n// Indexes to linked list nodes (nodes are stored as arrays to save bytes).\nconst SUSPENDED_COUNT = 0;\nconst RESOLVED_COUNT = 1;\nconst NEXT_NODE = 2;\n\n// Having custom inheritance instead of a class here saves a lot of bytes.\nexport function SuspenseList() {\n\tthis._next = null;\n\tthis._map = null;\n}\n\n// Mark one of child's earlier suspensions as resolved.\n// Some pending callbacks may become callable due to this\n// (e.g. the last suspended descendant gets resolved when\n// revealOrder === 'together'). Process those callbacks as well.\nconst resolve = (list, child, node) => {\n\tif (++node[RESOLVED_COUNT] === node[SUSPENDED_COUNT]) {\n\t\t// The number a child (or any of its descendants) has been suspended\n\t\t// matches the number of times it's been resolved. Therefore we\n\t\t// mark the child as completely resolved by deleting it from ._map.\n\t\t// This is used to figure out when *all* children have been completely\n\t\t// resolved when revealOrder is 'together'.\n\t\tlist._map.delete(child);\n\t}\n\n\t// If revealOrder is falsy then we can do an early exit, as the\n\t// callbacks won't get queued in the node anyway.\n\t// If revealOrder is 'together' then also do an early exit\n\t// if all suspended descendants have not yet been resolved.\n\tif (\n\t\t!list.props.revealOrder ||\n\t\t(list.props.revealOrder[0] === 't' && list._map.size)\n\t) {\n\t\treturn;\n\t}\n\n\t// Walk the currently suspended children in order, calling their\n\t// stored callbacks on the way. Stop if we encounter a child that\n\t// has not been completely resolved yet.\n\tnode = list._next;\n\twhile (node) {\n\t\twhile (node.length > 3) {\n\t\t\tnode.pop()();\n\t\t}\n\t\tif (node[RESOLVED_COUNT] < node[SUSPENDED_COUNT]) {\n\t\t\tbreak;\n\t\t}\n\t\tlist._next = node = node[NEXT_NODE];\n\t}\n};\n\n// Things we do here to save some bytes but are not proper JS inheritance:\n// - call `new Component()` as the prototype\n// - do not set `Suspense.prototype.constructor` to `Suspense`\nSuspenseList.prototype = new Component();\n\nSuspenseList.prototype._suspended = function(child) {\n\tconst list = this;\n\tconst delegated = suspended(list._vnode);\n\n\tlet node = list._map.get(child);\n\tnode[SUSPENDED_COUNT]++;\n\n\treturn unsuspend => {\n\t\tconst wrappedUnsuspend = () => {\n\t\t\tif (!list.props.revealOrder) {\n\t\t\t\t// Special case the undefined (falsy) revealOrder, as there\n\t\t\t\t// is no need to coordinate a specific order or unsuspends.\n\t\t\t\tunsuspend();\n\t\t\t} else {\n\t\t\t\tnode.push(unsuspend);\n\t\t\t\tresolve(list, child, node);\n\t\t\t}\n\t\t};\n\t\tif (delegated) {\n\t\t\tdelegated(wrappedUnsuspend);\n\t\t} else {\n\t\t\twrappedUnsuspend();\n\t\t}\n\t};\n};\n\nSuspenseList.prototype.render = function(props) {\n\tthis._next = null;\n\tthis._map = new Map();\n\n\tconst children = toChildArray(props.children);\n\tif (props.revealOrder && props.revealOrder[0] === 'b') {\n\t\t// If order === 'backwards' (or, well, anything starting with a 'b')\n\t\t// then flip the child list around so that the last child will be\n\t\t// the first in the linked list.\n\t\tchildren.reverse();\n\t}\n\t// Build the linked list. Iterate through the children in reverse order\n\t// so that `_next` points to the first linked list node to be resolved.\n\tfor (let i = children.length; i--; ) {\n\t\t// Create a new linked list node as an array of form:\n\t\t// \t[suspended_count, resolved_count, next_node]\n\t\t// where suspended_count and resolved_count are numeric counters for\n\t\t// keeping track how many times a node has been suspended and resolved.\n\t\t//\n\t\t// Note that suspended_count starts from 1 instead of 0, so we can block\n\t\t// processing callbacks until componentDidMount has been called. In a sense\n\t\t// node is suspended at least until componentDidMount gets called!\n\t\t//\n\t\t// Pending callbacks are added to the end of the node:\n\t\t// \t[suspended_count, resolved_count, next_node, callback_0, callback_1, ...]\n\t\tthis._map.set(children[i], (this._next = [1, 0, this._next]));\n\t}\n\treturn props.children;\n};\n\nSuspenseList.prototype.componentDidUpdate = SuspenseList.prototype.componentDidMount = function() {\n\t// Iterate through all children after mounting for two reasons:\n\t// 1. As each node[SUSPENDED_COUNT] starts from 1, this iteration increases\n\t//    each node[RELEASED_COUNT] by 1, therefore balancing the counters.\n\t//    The nodes can now be completely consumed from the linked list.\n\t// 2. Handle nodes that might have gotten resolved between render and\n\t//    componentDidMount.\n\tthis._map.forEach((node, child) => {\n\t\tresolve(this, child, node);\n\t});\n};\n","import { createElement, render } from 'preact';\n\n/**\n * @param {import('../../src/index').RenderableProps<{ context: any }>} props\n */\nfunction ContextProvider(props) {\n\tthis.getChildContext = () => props.context;\n\treturn props.children;\n}\n\n/**\n * Portal component\n * @this {import('./internal').Component}\n * @param {object | null | undefined} props\n *\n * TODO: use createRoot() instead of fake root\n */\nfunction Portal(props) {\n\tconst _this = this;\n\tlet container = props._container;\n\n\t_this.componentWillUnmount = function() {\n\t\trender(null, _this._temp);\n\t\t_this._temp = null;\n\t\t_this._container = null;\n\t};\n\n\t// When we change container we should clear our old container and\n\t// indicate a new mount.\n\tif (_this._container && _this._container !== container) {\n\t\t_this.componentWillUnmount();\n\t}\n\n\t// When props.vnode is undefined/false/null we are dealing with some kind of\n\t// conditional vnode. This should not trigger a render.\n\tif (props._vnode) {\n\t\tif (!_this._temp) {\n\t\t\t_this._container = container;\n\n\t\t\t// Create a fake DOM parent node that manages a subset of `container`'s children:\n\t\t\t_this._temp = {\n\t\t\t\tnodeType: 1,\n\t\t\t\tparentNode: container,\n\t\t\t\tchildNodes: [],\n\t\t\t\tappendChild(child) {\n\t\t\t\t\tthis.childNodes.push(child);\n\t\t\t\t\t_this._container.appendChild(child);\n\t\t\t\t},\n\t\t\t\tinsertBefore(child, before) {\n\t\t\t\t\tthis.childNodes.push(child);\n\t\t\t\t\t_this._container.appendChild(child);\n\t\t\t\t},\n\t\t\t\tremoveChild(child) {\n\t\t\t\t\tthis.childNodes.splice(this.childNodes.indexOf(child) >>> 1, 1);\n\t\t\t\t\t_this._container.removeChild(child);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// Render our wrapping element into temp.\n\t\trender(\n\t\t\tcreateElement(ContextProvider, { context: _this.context }, props._vnode),\n\t\t\t_this._temp\n\t\t);\n\t}\n\t// When we come from a conditional render, on a mounted\n\t// portal we should clear the DOM.\n\telse if (_this._temp) {\n\t\t_this.componentWillUnmount();\n\t}\n}\n\n/**\n * Create a `Portal` to continue rendering the vnode tree at a different DOM node\n * @param {import('./internal').VNode} vnode The vnode to render\n * @param {import('./internal').PreactElement} container The DOM node to continue rendering in to.\n */\nexport function createPortal(vnode, container) {\n\treturn createElement(Portal, { _vnode: vnode, _container: container });\n}\n","import {\n\trender as preactRender,\n\thydrate as preactHydrate,\n\toptions,\n\ttoChildArray,\n\tComponent\n} from 'preact';\n\nexport const REACT_ELEMENT_TYPE =\n\t(typeof Symbol != 'undefined' && Symbol.for && Symbol.for('react.element')) ||\n\t0xeac7;\n\nconst CAMEL_PROPS = /^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/;\n\n// Input types for which onchange should not be converted to oninput.\n// type=\"file|checkbox|radio\", plus \"range\" in IE11.\n// (IE11 doesn't support Symbol, which we use here to turn `rad` into `ra` which matches \"range\")\nconst onChangeInputType = type =>\n\t(typeof Symbol != 'undefined' && typeof Symbol() == 'symbol'\n\t\t? /fil|che|rad/i\n\t\t: /fil|che|ra/i\n\t).test(type);\n\n// Some libraries like `react-virtualized` explicitly check for this.\nComponent.prototype.isReactComponent = {};\n\n// `UNSAFE_*` lifecycle hooks\n// Preact only ever invokes the unprefixed methods.\n// Here we provide a base \"fallback\" implementation that calls any defined UNSAFE_ prefixed method.\n// - If a component defines its own `componentDidMount()` (including via defineProperty), use that.\n// - If a component defines `UNSAFE_componentDidMount()`, `componentDidMount` is the alias getter/setter.\n// - If anything assigns to an `UNSAFE_*` property, the assignment is forwarded to the unprefixed property.\n// See https://github.com/preactjs/preact/issues/1941\n[\n\t'componentWillMount',\n\t'componentWillReceiveProps',\n\t'componentWillUpdate'\n].forEach(key => {\n\tObject.defineProperty(Component.prototype, key, {\n\t\tconfigurable: true,\n\t\tget() {\n\t\t\treturn this['UNSAFE_' + key];\n\t\t},\n\t\tset(v) {\n\t\t\tObject.defineProperty(this, key, {\n\t\t\t\tconfigurable: true,\n\t\t\t\twritable: true,\n\t\t\t\tvalue: v\n\t\t\t});\n\t\t}\n\t});\n});\n\n/**\n * Proxy render() since React returns a Component reference.\n * @param {import('./internal').VNode} vnode VNode tree to render\n * @param {import('./internal').PreactElement} parent DOM node to render vnode tree into\n * @param {() => void} [callback] Optional callback that will be called after rendering\n * @returns {import('./internal').Component | null} The root component reference or null\n */\nexport function render(vnode, parent, callback) {\n\t// React destroys any existing DOM nodes, see #1727\n\t// ...but only on the first render, see #1828\n\tif (parent._children == null) {\n\t\tparent.textContent = '';\n\t}\n\n\tpreactRender(vnode, parent);\n\tif (typeof callback == 'function') callback();\n\n\treturn vnode ? vnode._component : null;\n}\n\nexport function hydrate(vnode, parent, callback) {\n\tpreactHydrate(vnode, parent);\n\tif (typeof callback == 'function') callback();\n\n\treturn vnode ? vnode._component : null;\n}\n\nlet oldEventHook = options.event;\noptions.event = e => {\n\tif (oldEventHook) e = oldEventHook(e);\n\te.persist = empty;\n\te.isPropagationStopped = isPropagationStopped;\n\te.isDefaultPrevented = isDefaultPrevented;\n\treturn (e.nativeEvent = e);\n};\n\nfunction empty() {}\n\nfunction isPropagationStopped() {\n\treturn this.cancelBubble;\n}\n\nfunction isDefaultPrevented() {\n\treturn this.defaultPrevented;\n}\n\nlet classNameDescriptor = {\n\tconfigurable: true,\n\tget() {\n\t\treturn this.class;\n\t}\n};\n\nlet oldVNodeHook = options.vnode;\noptions.vnode = vnode => {\n\tlet type = vnode.type;\n\tlet props = vnode.props;\n\tlet normalizedProps = props;\n\n\t// only normalize props on Element nodes\n\tif (typeof type === 'string') {\n\t\tnormalizedProps = {};\n\n\t\tfor (let i in props) {\n\t\t\tlet value = props[i];\n\n\t\t\tif (i === 'defaultValue' && 'value' in props && props.value == null) {\n\t\t\t\t// `defaultValue` is treated as a fallback `value` when a value prop is present but null/undefined.\n\t\t\t\t// `defaultValue` for Elements with no value prop is the same as the DOM defaultValue property.\n\t\t\t\ti = 'value';\n\t\t\t} else if (i === 'download' && value === true) {\n\t\t\t\t// Calling `setAttribute` with a truthy value will lead to it being\n\t\t\t\t// passed as a stringified value, e.g. `download=\"true\"`. React\n\t\t\t\t// converts it to an empty string instead, otherwise the attribute\n\t\t\t\t// value will be used as the file name and the file will be called\n\t\t\t\t// \"true\" upon downloading it.\n\t\t\t\tvalue = '';\n\t\t\t} else if (/ondoubleclick/i.test(i)) {\n\t\t\t\ti = 'ondblclick';\n\t\t\t} else if (\n\t\t\t\t/^onchange(textarea|input)/i.test(i + type) &&\n\t\t\t\t!onChangeInputType(props.type)\n\t\t\t) {\n\t\t\t\ti = 'oninput';\n\t\t\t} else if (/^on(Ani|Tra|Tou|BeforeInp)/.test(i)) {\n\t\t\t\ti = i.toLowerCase();\n\t\t\t} else if (CAMEL_PROPS.test(i)) {\n\t\t\t\ti = i.replace(/[A-Z0-9]/, '-$&').toLowerCase();\n\t\t\t} else if (value === null) {\n\t\t\t\tvalue = undefined;\n\t\t\t}\n\n\t\t\tnormalizedProps[i] = value;\n\t\t}\n\n\t\t// Add support for array select values: <select multiple value={[]} />\n\t\tif (\n\t\t\ttype == 'select' &&\n\t\t\tnormalizedProps.multiple &&\n\t\t\tArray.isArray(normalizedProps.value)\n\t\t) {\n\t\t\t// forEach() always returns undefined, which we abuse here to unset the value prop.\n\t\t\tnormalizedProps.value = toChildArray(props.children).forEach(child => {\n\t\t\t\tchild.props.selected =\n\t\t\t\t\tnormalizedProps.value.indexOf(child.props.value) != -1;\n\t\t\t});\n\t\t}\n\n\t\t// Adding support for defaultValue in select tag\n\t\tif (type == 'select' && normalizedProps.defaultValue != null) {\n\t\t\tnormalizedProps.value = toChildArray(props.children).forEach(child => {\n\t\t\t\tif (normalizedProps.multiple) {\n\t\t\t\t\tchild.props.selected =\n\t\t\t\t\t\tnormalizedProps.defaultValue.indexOf(child.props.value) != -1;\n\t\t\t\t} else {\n\t\t\t\t\tchild.props.selected =\n\t\t\t\t\t\tnormalizedProps.defaultValue == child.props.value;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tvnode.props = normalizedProps;\n\t}\n\n\tif (type && props.class != props.className) {\n\t\tclassNameDescriptor.enumerable = 'className' in props;\n\t\tif (props.className != null) normalizedProps.class = props.className;\n\t\tObject.defineProperty(normalizedProps, 'className', classNameDescriptor);\n\t}\n\n\tvnode.$$typeof = REACT_ELEMENT_TYPE;\n\n\tif (oldVNodeHook) oldVNodeHook(vnode);\n};\n\n// Only needed for react-relay\nlet currentComponent;\nconst oldBeforeRender = options._render;\noptions._render = function(vnode) {\n\tif (oldBeforeRender) {\n\t\toldBeforeRender(vnode);\n\t}\n\tcurrentComponent = vnode._component;\n};\n\n// This is a very very private internal function for React it\n// is used to sort-of do runtime dependency injection. So far\n// only `react-relay` makes use of it. It uses it to read the\n// context value.\nexport const __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED = {\n\tReactCurrentDispatcher: {\n\t\tcurrent: {\n\t\t\treadContext(context) {\n\t\t\t\treturn currentComponent._globalContext[context._id].props.value;\n\t\t\t}\n\t\t}\n\t}\n};\n","import {\n\tcreateElement,\n\trender as preactRender,\n\tcloneElement as preactCloneElement,\n\tcreateRef,\n\tComponent,\n\tcreateContext,\n\tFragment\n} from 'preact';\nimport {\n\tuseState,\n\tuseReducer,\n\tuseEffect,\n\tuseLayoutEffect,\n\tuseRef,\n\tuseImperativeHandle,\n\tuseMemo,\n\tuseCallback,\n\tuseContext,\n\tuseDebugValue\n} from 'preact/hooks';\nimport { PureComponent } from './PureComponent';\nimport { memo } from './memo';\nimport { forwardRef } from './forwardRef';\nimport { Children } from './Children';\nimport { Suspense, lazy } from './suspense';\nimport { SuspenseList } from './suspense-list';\nimport { createPortal } from './portals';\nimport {\n\thydrate,\n\trender,\n\tREACT_ELEMENT_TYPE,\n\t__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED\n} from './render';\n\nconst version = '16.8.0'; // trick libraries to think we are react\n\n/**\n * Legacy version of createElement.\n * @param {import('./internal').VNode[\"type\"]} type The node name or Component constructor\n */\nfunction createFactory(type) {\n\treturn createElement.bind(null, type);\n}\n\n/**\n * Check if the passed element is a valid (p)react node.\n * @param {*} element The element to check\n * @returns {boolean}\n */\nfunction isValidElement(element) {\n\treturn !!element && element.$$typeof === REACT_ELEMENT_TYPE;\n}\n\n/**\n * Wrap `cloneElement` to abort if the passed element is not a valid element and apply\n * all vnode normalizations.\n * @param {import('./internal').VNode} element The vnode to clone\n * @param {object} props Props to add when cloning\n * @param {Array<import('./internal').ComponentChildren>} rest Optional component children\n */\nfunction cloneElement(element) {\n\tif (!isValidElement(element)) return element;\n\treturn preactCloneElement.apply(null, arguments);\n}\n\n/**\n * Remove a component tree from the DOM, including state and event handlers.\n * @param {import('./internal').PreactElement} container\n * @returns {boolean}\n */\nfunction unmountComponentAtNode(container) {\n\tif (container._children) {\n\t\tpreactRender(null, container);\n\t\treturn true;\n\t}\n\treturn false;\n}\n\n/**\n * Get the matching DOM node for a component\n * @param {import('./internal').Component} component\n * @returns {import('./internal').PreactElement | null}\n */\nfunction findDOMNode(component) {\n\treturn (\n\t\t(component &&\n\t\t\t(component.base || (component.nodeType === 1 && component))) ||\n\t\tnull\n\t);\n}\n\n/**\n * Deprecated way to control batched rendering inside the reconciler, but we\n * already schedule in batches inside our rendering code\n * @template Arg\n * @param {(arg: Arg) => void} callback function that triggers the updated\n * @param {Arg} [arg] Optional argument that can be passed to the callback\n */\n// eslint-disable-next-line camelcase\nconst unstable_batchedUpdates = (callback, arg) => callback(arg);\n\n/**\n * Strict Mode is not implemented in Preact, so we provide a stand-in for it\n * that just renders its children without imposing any restrictions.\n */\nconst StrictMode = Fragment;\n\nexport * from 'preact/hooks';\nexport {\n\tversion,\n\tChildren,\n\trender,\n\thydrate,\n\tunmountComponentAtNode,\n\tcreatePortal,\n\tcreateElement,\n\tcreateContext,\n\tcreateFactory,\n\tcloneElement,\n\tcreateRef,\n\tFragment,\n\tisValidElement,\n\tfindDOMNode,\n\tComponent,\n\tPureComponent,\n\tmemo,\n\tforwardRef,\n\t// eslint-disable-next-line camelcase\n\tunstable_batchedUpdates,\n\tStrictMode,\n\tSuspense,\n\tSuspenseList,\n\tlazy,\n\t__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED\n};\n\n// React copies the named exports to the default one.\nexport default {\n\tuseState,\n\tuseReducer,\n\tuseEffect,\n\tuseLayoutEffect,\n\tuseRef,\n\tuseImperativeHandle,\n\tuseMemo,\n\tuseCallback,\n\tuseContext,\n\tuseDebugValue,\n\tversion,\n\tChildren,\n\trender,\n\thydrate,\n\tunmountComponentAtNode,\n\tcreatePortal,\n\tcreateElement,\n\tcreateContext,\n\tcreateFactory,\n\tcloneElement,\n\tcreateRef,\n\tFragment,\n\tisValidElement,\n\tfindDOMNode,\n\tComponent,\n\tPureComponent,\n\tmemo,\n\tforwardRef,\n\tunstable_batchedUpdates,\n\tStrictMode,\n\tSuspense,\n\tSuspenseList,\n\tlazy,\n\t__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED\n};\n","import { toChildArray } from 'preact';\n\nconst mapFn = (children, fn) => {\n\tif (children == null) return null;\n\treturn toChildArray(toChildArray(children).map(fn));\n};\n\n// This API is completely unnecessary for Preact, so it's basically passthrough.\nexport const Children = {\n\tmap: mapFn,\n\tforEach: mapFn,\n\tcount(children) {\n\t\treturn children ? toChildArray(children).length : 0;\n\t},\n\tonly(children) {\n\t\tconst normalized = toChildArray(children);\n\t\tif (normalized.length !== 1) throw 'Children.only';\n\t\treturn normalized[0];\n\t},\n\ttoArray: toChildArray\n};\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(true);\nconst MARGIN_BOTTOM = mu.marginBottom();\nconst SUB_MENU_MARGIN_TOP = mu.subMenuMarginTop();\n\nimport Workout from '../../components/workout';\nimport WorkoutSummary from '../../components/workout/summary';\nimport DogHistory from '../../components/dog/history';\nimport DogAddLog from '../../components/dog/addlog';\nimport DogStatus from '../../components/dog/status';\n\nconst initialState = {\n\tisLoading: false,\n};\n\n@observer\nclass Home extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\tasync loadAll() {\n\t\tthis.setState({ isLoading: true });\n\t\tawait this.loadDogs();\n\t\tthis.setState({ isLoading: false });\n    }\n\n\tloadDogs = async () => {\n\t\tthis.setState({ isLoading: true });\n\t\tconst { dogStore } = this.props.stores;\n\t\tconst { currentTeam } = dogStore;\n\n\t\tawait dogStore.load({ query: { team: currentTeam }, addData: ['workoutSummary'] });\n\t\tthis.setState({ isLoading: false });\n\t}\n\n\t// componentWillUnmount() {\n\t//     PubSub.unsubscribe(subscription);\n\t// }\n    componentDidMount() {\n        this.loadAll();\n    }\n\n\trender() {\n\t\tconst { dogStore, appState, userStore } = this.props.stores;\n        const { darkmode } = appState;\n\t\tconst { isAdmin } = userStore;\n\n\t\tconst dogsMaturity = dogStore.findDogsByStatus(10);\n\t\tconst dogsWithStatus = dogStore.findDogsByStatus([2, 4, 8, 9]);\n\t\tconst dogsWithNeeds = dogStore.findDogsWithNeeds();\n\n\t\treturn (\n\t\t\t<div class='container-fluid' style={`margin-bottom: ${MARGIN_BOTTOM}; margin-top: ${MARGIN_TOP};`}>\n\t\t\t\t<div class='row fixed-top' style={`margin-top: ${SUB_MENU_MARGIN_TOP}; background-color: ${darkmode ? '#191d21' : '#f8f9fa'};`}>\n\t\t\t\t\t{isAdmin && <div class='col text-center subtopmenu'>\n\t\t\t\t\t\t<a href='/admin' class='text-secondary stretched-link'><nobr><i class='fas fa-user-shield' /> <Text id='home.admin'>Admin</Text></nobr></a>\n\t\t\t\t\t</div>}\n\t\t\t\t\t<div class='col text-center subtopmenu'>\n\t\t\t\t\t\t<a href='/' class='text-secondary stretched-link'><nobr><i class='fas fa-chart-line' /> <Text id='todo.dashboard'>Dashboard</Text></nobr></a>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col text-center subtopmenu'>\n\t\t\t\t\t\t<a href='/feed' class='text-secondary stretched-link'><nobr><i class='fas fa-rss' /> <Text id='todo.feed'>Feed</Text></nobr></a>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col text-center border-bottom border-primary subtopmenu'>\n\t\t\t\t\t\t<a href='/todo' class='text-primary stretched-link'><nobr><i class='fas fa-list' /> <Text id='todo.todo'>Todo</Text></nobr></a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class='row'>\n\n\t\t\t\t\t<div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mb-4'>\n\t\t\t\t\t\t<h5><Text id='todo.dogs-follow-up'>Hunder som trenger oppfølging</Text></h5>\n\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t{dogsWithStatus && dogsWithStatus.map(d => <DogStatus stores={this.props.stores} dog={d} />)}\n\t\t\t\t\t\t\t{!dogsWithStatus || dogsWithStatus.length === 0 && <div class='col-12 text-center text-muted'>\n\t\t\t\t\t\t\t\t<h3><i class='fas fa-thumbs-up' /></h3>\n\t\t\t\t\t\t\t\t<Text id='todo.no-dogs-follow-up'>Ingen hunder som trenger ekstra oppfølging.</Text>\n\t\t\t\t\t\t\t</div>}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mb-4'>\n\t\t\t\t\t\t<h5><Text id='todo.dogs-special-needs'>Hunder med spesielle behov</Text></h5>\n\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t{dogsWithNeeds && dogsWithNeeds.map(d => <DogStatus stores={this.props.stores} dog={d} />)}\n\t\t\t\t\t\t\t{!dogsWithNeeds || dogsWithNeeds.length === 0 && <div class='col-12 text-center text-muted'>\n\t\t\t\t\t\t\t\t<h3><i class='fas fa-thumbs-up' /></h3>\n\t\t\t\t\t\t\t\t<Text id='todo.no-dogs-special-needs'>Ingen hunder med spesielle behov.</Text>\n\t\t\t\t\t\t\t</div>}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mb-4'>\n\t\t\t\t\t\t<h5><Text id='todo.dogs-with-maturity'>Hunder med løpetid</Text></h5>\n\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t{dogsMaturity && dogsMaturity.map(d => <DogStatus stores={this.props.stores} dog={d} />)}\n\t\t\t\t\t\t\t{!dogsMaturity || dogsMaturity.length === 0 && <div class='col-12 text-center text-muted'>\n\t\t\t\t\t\t\t\t<h3><i class='fas fa-thumbs-up' /></h3>\n\t\t\t\t\t\t\t\t<Text id='todo.no-dogs-with-maturity'>Ingen hunder med løpetid.</Text>\n\t\t\t\t\t\t\t</div>}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\t\t\t\t\t\n\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Home;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nfunction kmtToMph(value) {\n    return 0.621371 * value;\n}\n\n@observer\nclass Speed extends Component {\n    render() {\n\t\tconst { value = 0, smallUnit } = this.props;\n\t\tconst { userStore } = this.props.stores;\n\t\tconst { user } = userStore;\n\t\tconst { settings = {} } = user;\n\n        if (settings.imperial) {\n            return (<>\n                <nobr>\n                    {util.format(kmtToMph(value), 1)} {smallUnit ? <><small><small><small class='ml-0 text-muted'><Text id='workouts.mph'>mph</Text></small></small></small></> : <><Text id='workouts.mph'>mph</Text></>}\n                </nobr>\n            </>);\n        }\n\n\t\treturn (<>\n            <nobr>\n                {util.format(value, 1)} {smallUnit ? <><small><small><small class='ml-0 text-muted'><Text id='workouts.kmt'>km/t</Text></small></small></small></> : <><Text id='workouts.kmt'>km/t</Text></>}\n            </nobr>\n        </>);\n    }\n}\n\nexport default Speed;\n","import { h, Component } from 'preact';\nimport { observer } from 'mobx-preact';\nimport { toJS } from 'mobx';\nimport util from 'preact-util';\n\nimport DragNDropFileupload from './dragNdropFileupload';\n\n@observer\nclass Images extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            files: [],\n        };\n    }\n    \n    handleAddImage = (file) => {\n        const { addToImages = true } = this.props;\n\n        // <Images saved={saved} object={dog} field={field} updateField={updateField} />\n        // updateFieldValue = ({ id, field, value, datatype, elementtype, isNew = false, skipTimer = false }) => {\n        const {\n            updateField,\n            object,\n            field,\n        } = this.props;\n\n        if (field) {\n            updateField({ id: object.id, field, value: file, skipTimer: true });\n        }\n\n        // let images = toJS(object.images);\n        // if (!util.isArray(images)) {\n        //     images = [];\n        // }\n        if (addToImages) {\n            const images = [];\n            images.push(file);\n            updateField({ id: object.id, field: 'images', value: images, skipTimer: true });\n        }\n        // const allImages = [];\n        // allImages.push(file);\n        // updateField({ id: object.id, field: 'allImages', value: allImages, skipTimer: true });\n    };\n\n    render() {\n        const { uploadStatus = () => {}, before = () => {}, after = () => {}, autoOpen = true } = this.props;\n        return (\n            <div class='row'>\n                <div class='col-12'>\n                    <DragNDropFileupload\n                        handleAddImage={this.handleAddImage}\n                        uploadStatus={uploadStatus}\n                        apiUrl={'/api/fileupload'}\n                        before={before}\n                        after={after}\n                        autoOpen={autoOpen}\n                    >\n                        <div style={{ height: 30, width: '100%' }}>\n                            {/* {files.map((file, idx) => (\n                                <div key={idx}>\n                                    {file.name}\n                                    Total: {util.asString(file, 'load', 'total')}\n                                    <img style='width: 48px;'\n                                        alt='Preview'\n                                        key={file.preview}\n                                        src={file.src}\n                                    />\n                                </div>\n                            ))} */}\n                        </div>\n                    </DragNDropFileupload>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default Images;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { toJS } from 'mobx';\nimport { Text, Localizer, withText } from 'preact-i18n';\nimport Markdown from 'preact-markdown';\n\nimport WorkoutReplyComment from '../../components/workout/commentReply';\n\nimport style from '../style.css';\nimport mu from '../../lib/musher-util';\n\nconst initialState = {\n    showAddComment: {},\n    showAllComments: false,\n    showAllReplies: {},\n    viewImageIdx: {},\n};\n\nconst MAX_COMMENTS = 1;\n\n@observer\nclass WorkoutComments extends Component {\n     constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n        this.inputRef = {};\n    }\n\n    likeComment = async (e) => {\n        const { callback = () => {} } = this.props;\n        const commentId = e.target.parentElement.dataset.id || e.target.dataset.id;\n\n        const { workout } = this.props;\n\t\tconst { workoutStore } = this.props.stores;\n\t\tconst response = await workoutStore.likeWorkoutComment({ id: workout.id, commentId });\n\n\t\tif (response && response.status === 200) {\n            callback({ type: 'likeComment', workout, commentId, response });\n\t\t}\n        return true;\n    }\n\n    likeReply = async (e) => {\n        const { callback = () => {} } = this.props;\n\n        const replyId = e.target.parentElement.dataset.id || e.target.dataset.id;\n        const commentId = e.target.parentElement.dataset.comment || e.target.dataset.comment;\n\n        const { workout } = this.props;\n\t\tconst { workoutStore } = this.props.stores;\n\t\tconst response = await workoutStore.likeWorkoutCommentReply({ id: workout.id, replyId, commentId });\n\n        if (response && response.status === 200) {\n            callback({ type: 'likeReply', workout, commentId, replyId, response });\n\t\t}\n    }\n\n    replyComment = async (e) => {\n        const commentId = e.target.parentElement.dataset.id || e.target.dataset.id;\n\n        const { showAddComment } = this.state;\n        showAddComment[commentId] = !showAddComment[commentId];\n\t\tthis.setState({\n\t\t\tshowAddComment,\n\t\t}, () => {\n            if (this.inputRef[commentId]) {\n                this.inputRef[commentId].focus();\n            }\n\t\t});\n    }\n\n    toggleComments = () => {\n\t\tconst { showAllComments } = this.state;\n\t\tthis.setState({\n\t\t\tshowAllComments: !showAllComments,\n\t\t});\n\t}\n\n    toggleReplies = (e) => {\n        const commentId = e.target.parentElement.dataset.id || e.target.dataset.id;\n\t\tconst { showAllReplies } = this.state;\n        showAllReplies[commentId] = !showAllReplies[commentId];\n\t\tthis.setState({\n\t\t\tshowAllReplies,\n\t\t});\n\t}\n\n    viewImage = (e) => {\n\t\tconst { id, idx } = e.target.closest('img').dataset;\n        const { viewImageIdx } = this.state;\n        viewImageIdx[id] = idx;\n        this.setState({ viewImageIdx });\n    }\n\n    translate = async (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        const { replyid, commentid } = e.target.closest('button').dataset;\n        const { workout } = this.props;\n        const { userStore, teamStore } = this.props.stores;\n        const { user } = userStore;\n        const { showOriginal = {}, translatedText = {} } = this.state;\n        const key = `${commentid}${replyid ? `-${replyid}`: ''}`;\n        showOriginal[key] = 0;\n        if (replyid) {\n            translatedText[key] = await teamStore.translateCommentReply({ commentid, replyid, object: workout, user });\n        } else {\n            translatedText[key] = await teamStore.translateComment({ commentid, object: workout, user });\n        }\n        this.setState({ showOriginal, translatedText });\n    }\n\n    showOriginal = (e) => {\n        const { replyid, commentid } = e.target.closest('button').dataset;\n        e.preventDefault();\n        e.stopPropagation();\n        const { showOriginal = {} } = this.state;\n        showOriginal[`${commentid}${replyid ? `-${replyid}`: ''}`] = 1;\n        this.setState({ showOriginal });\n    }\n\n    render() {\n        const { showAddComment, showAllComments, showAllReplies, viewImageIdx, showOriginal = {}, translatedText = {} } = this.state;\n\t\tconst { workout, callback = () => {}, col = 12, offset = 0, compact = false } = this.props;\n        const { userStore, teamStore } = this.props.stores;\n        const { user: currentUser, isAdmin } = userStore;\n        const { language = 'en' } = currentUser;\n\n        let filteredComments = [];\n        let totalComments = 0;\n        let diplayedComments = 0;\n        let max_comments;\n        if (workout.comments) {\n            totalComments = workout.comments.length;\n            if (showAllComments) {\n                filteredComments = workout.comments;\n            } else {\n                // filteredComments = workout.comments.slice(0, MAX_COMMENTS);\n                max_comments = compact ? 0 : MAX_COMMENTS;\n                filteredComments = workout.comments.slice(Math.max(totalComments - max_comments, 0));\n            }\n            diplayedComments = filteredComments.length;\n        }\n\n        return (\n            <div>\n                {/* {showAllComments && <div>\n                    <button class='btn btn-sm btn-link py-0 mb-2'\n                        onClick={this.toggleComments}\n                    >\n                        <Text id='comments.hide-all-comments'>Skjul alle kommentarene.</Text>\n                    </button>\n                </div>} */}\n                {workout && filteredComments && filteredComments.reverse().map((comment) => {\n                    const { user = {} } = comment;\n                    const teams = teamStore.findPublicTeamByMembers(user.id);\n                    const displayNameShort = mu.displayNameShort(user);\n                    const displayName = mu.displayName(user);\n                    const userImage = user.image || (user.images ? user.images[0] : undefined);\n                    const hasLikedComment = comment.likes && comment.likes.findIndex(e => e.user === currentUser.id) > -1;\n\n                    let filteredReplises = [];\n                    let totalReplies = 0;\n                    let diplayedReplies = 0;\n                    if (comment.comments) {\n                        totalReplies = comment.comments.length;\n                        if (showAllReplies[comment.id]) {\n                            filteredReplises = comment.comments;\n                        } else {\n                            filteredReplises = comment.comments.slice(0, max_comments);\n                        }\n                        diplayedReplies = filteredReplises.length;\n                    }\n\n                    const images = [];\n                    if (comment.images) {\n                        const imgs = toJS(comment.images);\n                        images.push(...imgs);\n                    }\n                    const imageIdx = viewImageIdx[comment.id] ? viewImageIdx[comment.id] : 0;\n                    const currentImage = images && images[imageIdx] ? images[imageIdx] : null;\n\n                    const { currentLocationGeocode = {} } = comment;\n\n                   const translation = teamStore.getCommentTranslations({\n                        object: workout,\n                        commentid: comment.id,\n                        targetLang: language,\n                    }) || translatedText[comment.id];\n                    let body = translation || comment.comment;\n                    if (showOriginal[comment.id]) {\n                        body = comment.comment;\n                    }\n\n                    return (\n                        <div class='row'>\n                            <div class='col-12 d-flex mb-2 position-relative'>\n                                <div \n                                    class={`text-center border rounded-circle imageRounded imageRoundedSmall`}\n                                    style={`${userImage ? `background-image: url(\"${userImage.s3SmallLink}\"); background-size: cover;` : ''} border-width: 3px !important;`}\n                                >\n                                    {!user.image && <span class='font-weight-lighter' style='font-size: 15px;'>{displayNameShort}</span>}\n                                </div>\n                                <div class='flex-grow-1 pl-3 pt-0' style='line-height: 1.2em;'>\n                                    <div class='bg-light p-2 rounded rounded-lg'>\n                                        <div>\n                                            <span style='font-size: 0.95em;'>\n                                                <h5 class='font-weight-bold mb-0' style='font-size: 1.0em;'>\n                                                    {displayName}\n                                                </h5>\n\n                                                {teams && teams.length > 0 && <div class='mb-2'>\n                                                    <small class='font-weight-lighter text-muted'>\n                                                        {teams.filter(e => e.public === 1).slice(0, 2).map(t => <>\n                                                            <a href={`/teams/public/${t.uuidv4}`} class='mr-2'><i class='fas fa-users text-muted' /> {t.name}</a>\n                                                        </>)}\n                                                    </small>\n                                                </div>}\n\n                                                <Markdown markdown={mu.replaceImages(body, comment.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                                            </span>\n                                        </div>\n                                        <div class='container-fluid px-3 mt-1'>\n                                            {currentImage && <div class='clearfix row'>\n                                                <div\n                                                    class={`col-12 px-0 overflow-hidden`}\n                                                    style={`max-height: 30vh;`}                                                    \n                                                >\n                                                    <img loading='lazy' class={`img-fluid`} style='min-width: 100px;' src={currentImage.s3LargeLink} />\n                                                </div>\n                                            </div>}\n                                            {images && images.length > 1 && <div class='clearfix d-flex flex-wrap row'>\n                                                {images.map((img, idx) => {\n                                                    return (<>\n                                                        <div\n                                                            class={`col px-0 overflow-hidden`}\n                                                            style={`max-height: 100px; min-width: 100px;`}\n                                                        >\n                                                            <img loading='lazy' class={`img-fluid border`} style='min-width: 100px;' src={img.s3SmallLink} onClick={this.viewImage} data-id={comment.id} data-idx={idx} />\n                                                        </div>\n                                                    </>);\n                                                })}\n                                            </div>}\n                                        </div>\n                                    </div>\n                                    <small>\n                                        <button class={`btn btn-sm btn-link py-0 ${hasLikedComment ? 'text-primary' : ''}`}\n                                            onClick={this.likeComment}\n                                            data-id={comment.id}\n                                        >\n                                            <Text id='comments.like'>Lik</Text>\n                                        </button>\n                                        -\n                                        <button class='btn btn-sm btn-link py-0'\n                                            onClick={this.replyComment}\n                                            data-id={comment.id}\n                                        >\n                                            <Text id='comments.comment-add'>Kommentar</Text>\n                                        </button>\n                                        {comment.language !== language && <>\n                                            -\n                                            {!showOriginal[comment.id] && translation ? <>\n                                                <button\n                                                    type='button'\n                                                    class='btn btn-sm btn-link'\n                                                    data-commentid={comment.id}\n                                                    onClick={this.showOriginal}\n                                                >\n                                                    <i class='fas fa-cog' />  <Text id='home.translate-show-original'>Show original</Text>\n                                                </button>\n                                            </> : <>\n                                                <button\n                                                    type='button'\n                                                    class='btn btn-sm btn-link'\n                                                    onClick={this.translate}\n                                                    data-commentid={comment.id}\n                                                >\n                                                    <i class='fas fa-cog' /> <Text id='home.translate-to'>See translation</Text>\n                                                </button>\n                                            </>}\n                                        </>}\n                                        -\n                                        <button class='btn btn-sm btn-link py-0 disabled'>\n                                            {util.formatDistance(comment.createdDate, new Date(), { locale: 'no-NB' })}\n                                            {comment.updatedDate && <>\n                                                <span class='font-weight-light ml-2'>(Edited {util.formatDistance(comment.updatedDate, new Date(), { locale: 'no-NB' })})</span>\n                                            </>}\n                                        </button>\n                                        {isAdmin && currentLocationGeocode && currentLocationGeocode.formatted_address && <>\n                                            <span class='ml-2 text-muted'>\n                                                <i class='fas fa-map-marker-alt' /> {currentLocationGeocode.formatted_address}\n                                            </span>\n                                        </>}\n                                    </small>\n                                </div>\n                                {comment.likes && comment.likes.length > 0 && <small class='position-absolute bg-light shadow-sm rounded-lg py-0 px-1' style='bottom: 20px; right: 15px;'>\n                                    <i class='fas fa-thumbs-up text-primary' /> {comment.likes.length}\n                                </small>}\n                            </div>\n                            <div class='col-11 offset-1 mb-2'>\n\n                                {comment && filteredReplises && filteredReplises.map((reply) => {\n                                    const { user = {} } = reply;\n                                    const teams = teamStore.findPublicTeamByMembers(user.id);\n                                    const displayNameShort = user.firstname ? `${util.ucfirst(user.firstname, true)}${util.ucfirst(user.lastname, true)}` : `${util.ucfirst(user.email || '', true)}`;\n                                    const displayName = user.firstname ? `${user.firstname} ${user.lastname}` : `${user.email}`;\n                                    const userImage = user.image || (user.images ? user.images[0] : undefined);\n                                    const hasLikedReply = reply.likes && reply.likes.findIndex(e => e.user === currentUser.id) > -1;\n\n                                    const replyTranslation = teamStore.getCommentReplyTranslations({\n                                        object: workout,\n                                        commentid: comment.id,\n                                        replyid: reply.id,\n                                        targetLang: language,\n                                    }) || translatedText[`${comment.id}-${reply.id}`];\n                                    let replyBody = replyTranslation || reply.comment;\n                                    if (showOriginal[`${comment.id}-${reply.id}`]) {\n                                        replyBody = reply.comment;\n                                    }\n\n                                    return (\n                                        <div class='row'>\n                                            <div class='col-12 d-flex mb-2 position-relative'>\n                                                <div \n                                                    class={`text-center border rounded-circle imageRounded imageRoundedThumb`}\n                                                    style={`${userImage ? `background-image: url(\"${userImage.s3SmallLink}\"); background-size: cover;` : ''} border-width: 3px !important;`}\n                                                >\n                                                    {!user.image && <span class='font-weight-lighter' style='font-size: 15px;'>{displayNameShort}</span>}\n                                                </div>\n                                                <div class='flex-grow-1 pl-3 pt-0' style='line-height: 1.2em;'>\n                                                    <div class='bg-light p-2 rounded-lg'>\n                                                        <span style='font-size: 0.95em;'>\n                                                            <h5 class='font-weight-bold mb-0' style='font-size: 1.0em;'>\n                                                                {displayName}\n                                                            </h5>\n\n                                                            {teams && teams.length > 0 && <div class='mb-2'>\n                                                                <small class='font-weight-lighter text-muted'>\n                                                                    {teams.filter(e => e.public === 1).slice(0, 2).map(t => <>\n                                                                        <a href={`/teams/public/${t.uuidv4}`} class='mr-2'>\n                                                                            <i class='fas fa-users text-muted' /> {t.name}\n                                                                        </a>\n                                                                    </>)}\n                                                                </small>\n                                                            </div>}\n\n                                                            <Markdown markdown={mu.replaceImages(replyBody, reply.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                                                        </span>\n                                                    </div>\n                                                    <small>\n                                                        <button class={`btn btn-sm btn-link py-0 ${hasLikedReply ? 'text-primary' : ''}`}\n                                                            onClick={this.likeReply}\n                                                            data-comment={comment.id}\n                                                            data-id={reply.id}\n                                                        >\n                                                            <Text id='comments.like'>Lik</Text>\n                                                        </button>\n                                                        -\n                                                        <button class='btn btn-sm btn-link py-0'\n                                                            onClick={this.replyComment}\n                                                            data-id={comment.id}\n                                                        >\n                                                            <Text id='comments.comment-add'>Kommentar</Text>\n                                                        </button>\n                                                        {reply.language !== language && <>\n                                                            -\n                                                            {!showOriginal[`${comment.id}-${reply.id}`] && replyTranslation ? <>\n                                                                <button\n                                                                    type='button'\n                                                                    class='btn btn-sm btn-link'\n                                                                    data-commentid={comment.id}\n                                                                    data-replyid={reply.id}\n                                                                    onClick={this.showOriginal}\n                                                                >\n                                                                    <i class='fas fa-cog' />  <Text id='home.translate-show-original'>Show original</Text>\n                                                                </button>\n                                                            </> : <>\n                                                                <button\n                                                                    type='button'\n                                                                    class='btn btn-sm btn-link'\n                                                                    onClick={this.translate}\n                                                                    data-commentid={comment.id}\n                                                                    data-replyid={reply.id}\n                                                                >\n                                                                    <i class='fas fa-cog' /> <Text id='home.translate-to'>See translation</Text>\n                                                                </button>\n                                                            </>}\n                                                        </>}\n                                                        -\n                                                        <button class='btn btn-sm btn-link py-0 disabled'>\n                                                            {util.formatDistance(reply.createdDate, new Date(), { locale: 'no-NB' })}\n                                                        </button>\n                                                    </small>\n                                                </div>\n                                                {reply.likes && <small class='position-absolute bg-light shadow-sm rounded-lg py-0 px-1' style='bottom: 20px; right: 15px;'>\n                                                    <i class='fas fa-thumbs-up text-primary' /> {reply.likes.length}\n                                                </small>}\n                                            </div>\n                                        </div>\n                                    );\n                                })}\n                                {totalReplies - diplayedReplies > 0 && <div>\n                                    <button class='btn btn-sm btn-link py-0'\n                                        onClick={this.toggleReplies}\n                                        data-id={comment.id}\n                                    >\n                                        <Text id='comments.show-more' fields={{ more: totalReplies - diplayedReplies }}>\n                                            Vis {totalReplies - diplayedReplies} flere kommentarer...\n                                        </Text>\n                                    </button>\n                                </div>}\n\n                            </div>\n                            {showAddComment[comment.id] && <div class='col-11 offset-1 d-flex mb-2 position-relative'>\n                                <WorkoutReplyComment stores={this.props.stores} workout={workout}\n                                    callback={callback}\n                                    commentId={comment.id}\n                                    inputRef={c => this.inputRef[comment.id] = c}\n                                    inputRefObject={this.inputRef}\n                                />\n                            </div>}\n                        </div>\n                    );\n                })}\n                {totalComments - diplayedComments > 0 && <div>\n                    <button class='btn btn-sm btn-link py-0'\n                        onClick={this.toggleComments}\n                    >\n                        <Text id='comments.show-more' fields={{ more: totalComments - diplayedComments }}>\n                            Vis {totalComments - diplayedComments} flere kommentarer...\n                        </Text>\n                    </button>\n                </div>}\n                {showAllComments && <div>\n                    <button class='btn btn-sm btn-link py-0'\n                        onClick={this.toggleComments}\n                    >\n                        <Text id='comments.hide-all-comments'>Skjul alle kommentarene.</Text>\n                    </button>\n                </div>}\n            </div>\n        );\n    }\n}\n\nexport default WorkoutComments;\n","import { h, Component, createRef } from 'preact';\nimport { observer } from 'mobx-preact';\nimport util from 'preact-util';\nimport { Text, Localizer, withText } from 'preact-i18n';\n\nconst debug = false;\nconst debugName = 'Images';\n\n@observer\nclass DragNDropFileupload extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            drag: false,\n            loadingProgress: 0,\n            uploadedFiles: [],\n            uploadedFilesData: {},\n        };\n    }\n\n    dropRef = createRef();\n\n    handleDrag = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n    }\n\n    handleDragIn = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.dragCounter++;\n        if (e.dataTransfer.items && e.dataTransfer.items.length > 0) {\n            this.setState({ drag: true });\n        }\n    }\n\n    handleDragOut = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.dragCounter--;\n        if (this.dragCounter === 0) {\n            this.setState({ drag: false });\n        }\n    }\n\n    handleDrop = (e) => {\n        if (debug) {\n            console.log(`${debugName}.handleDrop: event`, e);\n        }\n        e.preventDefault();\n        e.stopPropagation();\n        this.setState({ drag: false });\n        if (e.dataTransfer.files && e.dataTransfer.files.length > 0) {\n            // this.props.handleDrop(e.dataTransfer.files);\n            // e.dataTransfer.clearData();\n            for (let i = 0, l = e.dataTransfer.files.length; i < l; i += 1) {\n                const photo = e.dataTransfer.files[i];\n                // if (photo.type.match('image.*')) {\n                this.readLocalFile(photo);\n                // }\n            }\n            this.dragCounter = 0;\n        }\n    }\n\n    // Upload\n    handleAddFiles = (event) => {\n        event.preventDefault();\n        const el = event.target;\n        if (debug) {\n            console.log(`${debugName}.handleAddFiles: event, el`, event, el);\n        }\n        for (let i = 0, l = el.files.length; i < l; i += 1) {\n            const photo = el.files[i];\n            // if (photo.type.match('image.*')) {\n            this.readLocalFile(photo);\n            // }\n        }\n    }\n\n    handleEvent = (e, fileObject) => {\n        if (debug) {\n            console.log(`${debugName}.handleEvent[${fileObject.name}]: ${e.type}: `\n                + `${e.loaded} bytes transferred of ${e.total}. Is lengthComputable: ${e.lengthComputable}: `\n                + `${JSON.stringify(e)}`);\n        }\n    }\n\n    handleUpload = (fileObject) => {\n        if (debug) {\n            console.log(`${debugName}.handleUpload[${fileObject.name}]`);\n        }\n\n        const { uploadStatus = () => {}, before = () => {}, after = () => {} } = this.props;\n        uploadStatus(false);\n\n        if (util.isFunction(before)) {\n            before();\n        }\n\n        const formData = new FormData();\n        formData.append('files[]', fileObject);\n        const uploadMeta = {\n            progress: 1,\n        };\n\n        uploadMeta.xhr = new XMLHttpRequest();\n\n        uploadMeta.xhr.upload.addEventListener('progress', (event) => {\n            const fileObj = fileObject;\n            this.updateProgress(event, fileObj);\n        });\n        uploadMeta.xhr.addEventListener('loadstart', (event) => {\n            const fileObj = fileObject;\n            this.handleEvent(event, fileObj);\n        });\n        uploadMeta.xhr.addEventListener('load', (event) => {\n            const fileObj = fileObject;\n            this.handleEvent(event, fileObj);\n        });\n        uploadMeta.xhr.addEventListener('loadend', (event) => {\n            const fileObj = fileObject;\n            if (util.isFunction(after)) {\n                after();\n            }\n            this.handleEvent(event, fileObj);\n        });\n        uploadMeta.xhr.addEventListener('progress', (event) => {\n            const fileObj = fileObject;\n            this.handleEvent(event, fileObj);\n        });\n        uploadMeta.xhr.addEventListener('error', (event) => {\n            const fileObj = fileObject;\n            this.handleEvent(event, fileObj);\n        });\n        uploadMeta.xhr.addEventListener('abort', (event) => {\n            const fileObj = fileObject;\n            this.handleEvent(event, fileObj);\n        });\n        uploadMeta.xhr.addEventListener('readystatechange', (event) => {\n            const fileObj = fileObject;\n            this.uploadDone(event, fileObj);\n        });\n\n        uploadMeta.xhr.open('POST', `${util.getApiServer()}${this.props.apiUrl}`);\n        uploadMeta.xhr.setRequestHeader('Authorization', `Bearer ${util.getJwtToken()}`);\n        uploadMeta.xhr.send(formData);\n\n        const filename = fileObject.name;\n        const uploadedFilesData = this.state.uploadedFilesData;\n        if (!uploadedFilesData[filename]) {\n            uploadedFilesData[filename] = {};\n        }\n        uploadedFilesData[filename].uploadMeta = uploadMeta;\n        uploadedFilesData[filename].imageNum = this.state.imageNum;\n        this.setState({ uploadedFilesData });\n    }\n\n    // eslint-disable-next-line\n    readLocalFile = (fileObject) => {\n        return new Promise((resolve, reject) => {\n            const reader = new FileReader();\n\n            reader.addEventListener('error', (error) => {\n                if (debug) {\n                    console.log(`${debugName}.FileReader: Error occurred reading file: ${fileObject.name}: ${error}`);\n                }\n                reject(error);\n            });\n\n            reader.addEventListener('load', (event) => {\n                if (debug) {\n                    console.log(`${debugName}.FileReader: File: ${fileObject.name} read successfully: `\n                        + `${JSON.stringify(event)}`);\n                }\n                const photo = fileObject;\n                const filename = photo.name;\n                const uploadedFilesData = this.state.uploadedFilesData;\n                if (!uploadedFilesData[filename]) {\n                    uploadedFilesData[filename] = {};\n                }\n                uploadedFilesData[filename].event = event;\n                this.setState({ uploadedFilesData });\n                this.handleUpload(photo);\n                resolve(event);\n            });\n\n            reader.readAsDataURL(fileObject);\n        });\n    }\n\n    updateProgress = (event, fileObject) => {\n        if (event.lengthComputable) {\n            const filename = fileObject.name;\n            const uploadedFilesData = this.state.uploadedFilesData;\n            const percentComplete = (event.loaded / event.total) * 100;\n            if (debug) {\n                console.log(`${debugName}.updateProgress[${filename}].progress`, percentComplete);\n            }\n            uploadedFilesData[filename].uploadMeta.progress = percentComplete;\n            this.setState({ uploadedFilesData });\n        }\n    }\n\n    uploadDone = (event, fileObject) => {\n        const filename = fileObject.name;\n        const uploadedFilesData = this.state.uploadedFilesData;\n        const uploadMeta = uploadedFilesData[filename].uploadMeta;\n        if (debug) {\n            console.log(`${debugName}.uploadDone[${filename}].uploadedFilesData`, uploadedFilesData);\n            console.log(`${debugName}.uploadDone[${filename}].uploadMeta`, uploadMeta);\n            console.log(`${debugName}.uploadDone.event`, event);\n        }\n\n        if (uploadMeta && uploadMeta.xhr.readyState === 4 && uploadMeta.xhr.status === 201) {\n            const response = JSON.parse(uploadMeta.xhr.responseText);\n            const files = response.data.files;\n            for (let i = 0; i < files.length; i += 1) {\n                const file = files[i];\n                this.addFileToUpload(file);\n                this.fileInput.value = '';\n            }\n        }\n    }\n\n    addFileToUpload(file) {\n        if (debug) {\n            console.log(`${debugName}.addFileToUpload[${file.name}]`);\n        }\n        const { uploadedFilesData } = this.state;\n        const { handleAddImage, uploadStatus = () => {} } = this.props;\n\n        delete uploadedFilesData[file.name];\n        this.setState({ uploadedFilesData });\n        handleAddImage(file);\n        uploadStatus(true);\n    }\n    // /Upload\n\n    componentDidMount() {\n        const div = this.dropRef.current;\n        div.addEventListener('dragenter', this.handleDragIn);\n        div.addEventListener('dragleave', this.handleDragOut);\n        div.addEventListener('dragover', this.handleDrag);\n        div.addEventListener('drop', this.handleDrop);\n\n        const { autoOpen } = this.props;\n\n        if (autoOpen) {\n            setTimeout(() => {\n                // console.log('[setTimeout]');\n                this.fileInput.click();\n            }, 10);\n        }\n    }\n\n    componentWillUnmount() {\n        const div = this.dropRef.current;\n        div.removeEventListener('dragenter', this.handleDragIn);\n        div.removeEventListener('dragleave', this.handleDragOut);\n        div.removeEventListener('dragover', this.handleDrag);\n        div.removeEventListener('drop', this.handleDrop);\n    }\n\n    render() {\n        const { uploadedFilesData } = this.state;\n\n        return (\n            <div style={{ position: 'relative' }} ref={this.dropRef}>\n                {this.state.drag &&\n                <div style={{\n                    border: 'dashed grey 4px',\n                    backgroundColor: 'rgba(255,255,255,.8)',\n                    position: 'absolute',\n                    top: 0,\n                    bottom: 0,\n                    left: 0,\n                    right: 0,\n                    zIndex: 9999,\n                }}>\n                    <div\n                        style={{\n                            position: 'absolute',\n                            top: '50%',\n                            right: 0,\n                            left: 0,\n                            textAlign: 'center',\n                            color: 'grey',\n                            fontSize: 36,\n                        }}\n                    >\n                        <div><Text id='imageupload.drag-files-here'>drop your files here :)</Text></div>\n                    </div>\n                </div>}\n\n                <div>\n                    <input class='btn btn-info col-sm-12' multiple\n                        type='file'\n                        id='image-file'\n                        onchange={this.handleAddFiles}\n                        ref={(c) => {\n                            this.fileInput = c;\n                        }}\n                    />\n                </div>\n                <div>\n                    {Object.keys(uploadedFilesData).length > 0 ? (<h3><Text id='imageupload.upload-images'>Uploaded images</Text></h3>) : ''}\n                    <ul class='list-group'>\n                        {Object.keys(uploadedFilesData).map((key) => {\n                            const { uploadMeta = {} } = uploadedFilesData[key];\n                            const isImage = key.match(/(jpg|jpeg|png|gif|heic|heif|svg|webp|tif)/i);\n                            return (\n                                <li class='list-group-item list-group-item-action flex-column align-items-start'>\n                                    <div class='d-flex w-100 justify-content-between'>\n                                        {isImage && <img class='img-fluid mr-3'\n                                            src={uploadedFilesData[key].event.target.result}\n                                            style='max-height: 50px;'\n                                        />}\n                                        <small>{uploadedFilesData[key].event.uploadDone}</small>\n                                        <Text id='imageupload.uploading-image'>Laster opp bilde...</Text>\n                                        <small>{util.formatBytes(uploadedFilesData[key].event.total, 2)}</small>\n                                    </div>\n                                    <div class='progress mt-1' style='height: 4px;'>\n                                        <div\n                                            class='progress-bar progress-bar-striped progress-bar-animated bg-success'\n                                            role='progressbar'\n                                            style={`width: ${uploadMeta.progress}%; height: 4px;`}\n                                            aria-valuenow={uploadMeta.progress}\n                                            aria-valuemin='0'\n                                            aria-valuemax='100'\n                                        />\n                                    </div>\n                                </li>\n                            );\n                        })}\n                    </ul>\n                </div>\n\n                {this.props.children}\n            </div>\n        );\n    }\n}\n\nexport default DragNDropFileupload;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nconst initialState = {};\n\n@observer\nclass DisplayLikesAndComments extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n    toggleViews = () => {\n        const { showViewList } = this.state;\n        const { isTeamAdmin, isAdmin } = this.props;\n        if (isTeamAdmin || isAdmin) {\n            this.setState({\n                showViewList: !showViewList,\n            });\n        }\n    }\n\n    render() {\n        const { showViewList } = this.state;\n        const { storyStore, teamStore, workoutStore } = this.props.stores;\n        const { views, object, isTeamAdmin, isAdmin,\n            type = 'story', onTeamClick = () => {}, onUserClick = () => {} } = this.props;\n\n        const viewUsersArrays = [];\n        Object.entries(object.statistics).forEach(([year, yearObject]) => {\n            // console.log({ year, yearObject });\n            Object.entries(yearObject).forEach(([week, weekObject]) => {\n                // console.log({ week, weekObject });\n                if (weekObject.viewUsers) {\n                    viewUsersArrays.push(weekObject.viewUsers);\n                }\n            });\n        });\n        const viewUsers = viewUsersArrays.flat().slice(0, 50);\n\n\t\treturn (<>\n            <div class='d-flex justify-content-end mb-2'>\n                <span class='ml-2 text-muted font-weight-lighter'\n                    onClick={this.toggleViews}\n                >\n                    {views} <Text id='story.views'>views</Text>\n                </span>\n            </div>\n            {showViewList && <div class='mt-3 mb-3'>\n                {viewUsers && viewUsers.map((userId) => {\n                    let user;\n                    let teams;\n                    if (type === 'story') {\n                        user = storyStore.findPublicUser(userId);\n                        teams = storyStore.findPublicTeamByMembers(userId);\n                    } else if (type === 'team') {\n                        user = teamStore.findPublicUser(userId);\n                        teams = teamStore.findPublicTeamByMembers(userId);\n                    } else if (type === 'workout') {\n                        user = workoutStore.findPublicUser(userId);\n                        teams = workoutStore.findPublicTeamByMembers(userId);\n                    }\n                    if (!user) {\n                        return '';\n                    }\n                    let publicTeam;\n                    if (util.isArray(teams)) {\n                        publicTeam = teams.find(e => e.public === 1);\n                    }\n                    const image = mu.getImage({ user, team: publicTeam, priority: 'user' });\n                    const shortname = mu.displayNameShort(user);\n                    const name = mu.displayName(user, true);\n                    return (<div class='d-flex flex-row position-relative font-weight-light mb-1'>\n                        {publicTeam ? <>\n                            <a href={`/teams/public/${publicTeam.uuidv4}`} title={publicTeam.name} onClick={(e) => onTeamClick(e, publicTeam.uuidv4)} class='stretched-link'>\n                                <div\n                                    class={`text-center border rounded-circle imageRounded imageRoundedThumb`}\n                                    style={`${image ? `background-image: url(\"${image}\"); background-size: cover;` : ''}`}\n                                >\n                                    {!image && <div class='' style='font-size: 12px; padding-top: 3px;'>{shortname}</div>}\n                                </div>\n                            </a>\n                            <div class='ml-2 '>\n                                {name} <span class='font-weight-lighter'>- {publicTeam.name}</span>\n                            </div>\n                        </> : <>\n                            <div\n                                class={`text-center border rounded-circle imageRounded imageRoundedThumb`}\n                                style={`${image ? `background-image: url(\"${image}\"); background-size: cover;` : ''} opacity: 0.5;`}\n                            >\n                                {!image && <div class='text-muted' style='font-size: 12px; padding-top: 3px;'>{shortname}</div>}\n                            </div>\n                            <div class='ml-2'>\n                                {name}\n                            </div>\n                        </>}\n                    </div>);\n                })}\n                {views > viewUsers.length && <>\n                    <small class='text-muted'>\n                        <Text id='story.limited-to'>Limited to max 50 users.</Text>\n                    </small>\n                </>}\n            </div>}\n\t\t</>);\n\t}\n}\n\nexport default DisplayLikesAndComments;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\n\nimport style from './style.css';\n\nconst initialState = {\n    mouseData: {},\n};\n\n@observer\nclass Gauge extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n        this.svgRef = null;\n    }\n\n    render() {\n        const {\n            radius = 50,\n            heightAdd = 0,\n            color = 'success',\n\n            showPercentText = true,\n            percent = 0,\n            prefix = '',\n\n            showCenterText= false,\n            centerText,\n            centerTextSize,\n            centerTextX,\n            centerTextY,\n\n            total = '',\n            totalY = '90%',\n            totalX = '50%',\n            totalTextAnchor = 'middle',\n                        \n            completed = '',\n            completedY = '65%',\n            completedX = '50%',\n            completedTextAnchor = 'middle',\n        } = this.props;\n        const strokeWidth = radius * 0.3;\n        const innerRadius = radius - strokeWidth / 2;\n\n        const strokeWidthGauge = radius * 0.3;\n\n        const circumference = innerRadius * 2 * Math.PI;\n        const arc = circumference * (270 / 360);\n        const dashArray = `${arc} ${circumference}`;\n        const transform = `rotate(135, ${radius}, ${radius})`;\n\n        const percentNormalized = Math.min(Math.max(percent, 0), 100);\n        const offset = arc - (percentNormalized / 100) * arc;\n\n        const textSize = centerTextSize || radius / 2.5;\n        const textSizeSmall = radius / 5;\n\n        return (\n            <>\n                <svg xmlns='http://www.w3.org/2000/svg' class={style.svg}\n                    // viewBox={`0 0 ${radius * 2} ${radius * 2}`}\n                    width={radius * 2}\n                    height={radius * 2 + heightAdd}\n                    preserveAspectRatio='none'\n                    ref={c => this.svgRef = c}\n                >\n\n                    <circle\n                        class={`${style.gaugeBackground}`}\n                        cx={radius}\n                        cy={radius}\n                        r={innerRadius}\n                        strokeWidth={strokeWidth}\n                        strokeDasharray={dashArray}\n                        strokeLinecap='round'\n                        transform={transform}\n                    />\n                    \n                    <circle\n                        class={`${style[color]} ${style.gauge}`}\n                        cx={radius}\n                        cy={radius}\n                        r={innerRadius}\n                        stroke='url(#grad)'\n                        strokeDasharray={dashArray}\n                        strokeDashoffset={offset}\n                        strokeLinecap='round'\n                        strokeWidth={strokeWidthGauge}\n                        style={{\n                            transition: 'stroke-dashoffset 0.3s',\n                        }}\n                        transform={transform}\n                    />\n                     \n                    {showPercentText && <text\n                        class={`${style.gaugeText} ${style[color]}`}\n                        x={centerTextX || '50%'}\n                        y={centerTextY || '50%'}\n                        dominant-baseline='middle'\n                        text-anchor='middle'\n                        font-size={textSize}\n                    >{percent} {prefix}</text>}\n\n                    {showCenterText && <text\n                        class={`${style.gaugeText} ${style[color]}`}\n                        x={centerTextX || '50%'}\n                        y={centerTextY || '50%'}\n                        dominant-baseline='middle'\n                        text-anchor='middle'\n                        font-size={textSize}\n                    >{centerText}</text>}\n\n                    {completed && <text\n                        class={`${style.gaugeText} ${style[color]}`}\n                        x={completedX}\n                        y={completedY}\n                        dominant-baseline='middle'\n                        text-anchor={completedTextAnchor}\n                        font-size={textSizeSmall}\n                    >{completed}</text>}\n\n                    <text\n                        class={`${style.gaugeText} ${style.secondary}`}\n                        x={totalX}\n                        y={totalY}\n                        dominant-baseline='middle'\n                        text-anchor={totalTextAnchor}\n                        font-size={textSizeSmall}\n                    >{total}</text>\n\n                </svg>\n            </>\n        );\n    }\n}\n\nexport default Gauge;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer, withText } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nimport Modal from '../modal';\nimport ImageSlider from '../imageSlider';\nimport ImageScroller from '../imageScroller';\n\n\nimport style from '../style.css';\n\nconst VACCINE_TYPES = mu.getVaccineTypes();\n\n@observer\nclass DogHistoryLine extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            showDate: false,\n        };\n    }\n\n    showModal = (e) => {\n        e.stopPropagation();\n        e.preventDefault();\n        const img = e.target.dataset.image;\n        const imgXXL = e.target.dataset.imagexxl;\n        const thumb = e.target.dataset.thumb;\n        const name = e.target.dataset.name;\n        const title = e.target.dataset.title;\n        const date = e.target.dataset.date;\n        this.setState({\n            displayModal: true,\n            currentImage: img,\n            currentImageXXL: imgXXL,\n            thumb,\n            name,\n            title,\n            date,\n        });\n    }\n\n    closeModal = () => {\n        this.setState({\n            displayModal: false,\n        });\n    }\n\n    toggleDate = () => {\n        const { showDate } = this.state;\n        this.setState({ showDate: !showDate });\n    }\n\n    touchStart = (e) => {\n        const { eventFired } = this.state;\n        if (!eventFired)  {\n            this.setState({\n                startY: e.touches[0].pageY,\n                startX: e.touches[0].pageX,\n                eventFired: false,\n                diffY: undefined,\n                diffX: undefined,\n                deleteVerify: false,\n            });\n        }\n    }\n\n    touchEnd = () => {\n        const { eventFired } = this.state;\n        if (eventFired) {\n            this.setState({\n                startY: undefined,\n                startX: undefined,\n            });\n        } else {\n            this.setState({\n                startY: undefined,\n                startX: undefined,\n                eventFired: false,\n                diffY: undefined,\n                diffX: undefined,\n                deleteVerify: false,\n            });\n        }\n    }\n\n    touchMove = (e) => {\n        const { eventFired } = this.state;\n        if (eventFired) {\n            return false;\n        }\n        const { startY, startX } = this.state;\n        const scrollDistance = 130;\n        const y = e.touches[0].pageY;\n        const x = e.touches[0].pageX;\n        const diffY = y - startY;\n        const diffX = x - startX;\n        this.setState({\n            diffY,\n            diffX,\n        });\n        if (y > (startY + scrollDistance)) {\n            // console.log('swiping down', y, '>', startY + scrollDistance);\n        } else if (y < (startY - scrollDistance)) {\n            // console.log('swiping up', y, '<', startY + scrollDistance);\n        } else if (x > (startX + scrollDistance)) {\n            // console.log('swiping right', startX, x);\n        } else if (x < (startX - scrollDistance)) {\n            this.setState({\n                eventFired: true,\n            });\n        }\n    }\n\n    reset = (e) => {\n        if (e) {\n            e.stopPropagation();\n            e.preventDefault();\n        }\n        this.setState({\n            deleted: false,\n            startY: undefined,\n            startX: undefined,\n            eventFired: false,\n            diffY: undefined,\n            diffX: undefined,\n            deleteVerify: false,\n        });\n    }\n\n    deleteHistoryRequest = async (e) => {\n        e.stopPropagation();\n        this.setState({\n            deleteVerify: true,\n        });\n    }\n\n    deleteHistory = async (e) => {\n        e.stopPropagation();\n        const { dogStore } = this.props.stores;\n        const { line } = this.props;\n        await dogStore.save({\n\t\t\tid: line.dogId,\n\t\t\t$pull: {\n                history: { _id: line.id || line._id },\n\t\t\t},\n\t\t});\n        this.setState({\n            deleted: true,\n            startY: undefined,\n            startX: undefined,\n            eventFired: false,\n            diffY: undefined,\n            diffX: undefined,\n            deleteVerify: false,\n        });\n    }\n\n    swipeLeft = (e) => {\n        const { eventFired } = this.state;\n        e.stopPropagation();\n        if (eventFired) {\n            this.reset();\n        } else {\n            this.setState({\n                eventFired: true,\n                diffX: -130,\n            });\n        }\n    }\n\n    componentWillReceiveProps(nextProps) {\n        // console.log('componentWillReceiveProps', nextProps);\n        if (nextProps.line.id !== this.props.line.id) {\n            this.reset();\n        }\n    }\n\n    render() {\n        const { userStore } = this.props.stores;\n        const { user } = userStore;\n        const { language = 'en' } = user;\n        const HISTORY_TYPE_MAP = mu.getHistoryMap(language);\n\n        const { displayModal, currentImage, currentImageXXL, showDate, thumb, name, title, date } = this.state;\n        const { line } = this.props;\n        const { diffX, deleted, deleteVerify } = this.state;\n        const hasImage = line.images && line.images.length > 0;\n        const isBeeingEdited = diffX < 0;\n        return (\n            <div class={`w-100 mb-4 position-relative ${style.hoverElement}`}\n                onTouchstart={deleted ? () => {} : this.touchStart}\n                onTouchend={deleted ? () => {} : this.touchEnd}\n                onTouchmove={deleted ? () => {} : this.touchMove}\n                onClick={!deleted && isBeeingEdited ? this.reset : () => {}}\n                style={`opacity: ${deleted ? 0.3 : 1};`}\n            >\n                {!isBeeingEdited && !deleted && <div class={`position-absolute ${style.hoverelementonly}`} style='top: 0px; right: 0px; z-index: 1000;'>\n                    <button class='btn btn-sm btn-secondary' type='button'\n                        onClick={this.swipeLeft}\n                    >\n                        <i class='fas fa-ellipsis-h' />\n                    </button>\n                </div>}\n                {isBeeingEdited && !deleted && <div class='position-absolute' style={`right: 0px; top: 10%; overflow: hidden; width: ${Math.abs(diffX) || 0}px; line-height: 0.8em;`}>\n                    {!line.grouped && <>\n                        {deleteVerify ?\n                            <>\n                                <button class='btn btn-sm btn-secondary float-right ml-3 mb-3'\n                                    onClick={this.reset}\n                                >\n                                    <i class='fas fa-times' /> <Text id='dog.history.no'>Nei</Text>\n                                </button>\n                                <button class='btn btn-sm btn-success float-right'\n                                    onClick={this.deleteHistory}\n                                >\n                                    <i class='fas fa-check' /> <Text id='dog.history.yes'>Ja</Text>\n                                </button>\n                            </>:\n                            <button class='btn btn-sm btn-danger float-right'\n                                onClick={this.deleteHistoryRequest}\n                            >\n                                <i class='fas fa-trash' /> <Text id='dog.history.delete'>Slett</Text>\n                            </button>\n                        }\n                    </>}\n                    {line.grouped && <small>\n                        <Text id='dog.history.cant-delete-groups'>Kan ikke slette grupperinger. Gå inn på hundene og slett der.</Text><br />\n                        <button class='btn btn-sm btn-success float-right'\n                            onClick={this.reset}\n                        >\n                            <i class='fas fa-check' /> Ok\n                        </button>\n                    </small>}\n                </div>}\n                <div class='row position-relative' style={`left: ${isBeeingEdited ? diffX : 0}px;`}>\n                    <div class='col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 d-flex mb-0 position-relative'>\n                        {/* {JSON.stringify(dog, null, 4)} */}\n                        {line.dogImage ? <div class={`text-center border rounded-circle imageRounded imageRoundedSmall`} style={line.dogImage ? `background-image: url(\"${line.dogImage.s3SmallLink}\"); background-size: cover;` : ''}>\n                            &nbsp;\n                        </div> : <div class={`text-center border rounded-circle imageRounded imageRoundedSmall`} style={line.images && line.images[0] ? `background-image: url(\"${line.images[0].s3SmallLink}\"); background-size: cover;` : ''}>\n                            {!hasImage && <i class='fas fa-rss text-muted mt-2' style='font-size: 20px;' />}\n                        </div>}                        \n                        <div class='flex-grow-1 pl-3 pr-2' style='line-height: 1.0em;'>\n                            {!line.grouped && line.dogId && <a class='stretched-link' href={`/dogs/${line.dogId}`}>\n                                <strong class='mr-2'>{line.dogShortname || line.dogName}: </strong>\n                            </a>}\n                            {line.title}<br />\n                            \n                            {line.grouped && (\n                                <>\n                                    <div class='w-100 clearfix mt-2'>\n                                        {line.grouped.map(el => (\n                                            <>\n                                                <a href={`/dogs/${el.dogId}`}>\n                                                    {el.dogImage ? (\n                                                        <div class={`text-center border rounded-circle imageRounded imageRoundedThumb float-left`}\n                                                            style={`margin-right: 2px; ${el.dogImage ? `background-image: url(\"${el.dogImage.s3SmallLink}\");` : ''}`}\n                                                        >\n                                                            &nbsp;\n                                                        </div>\n                                                    ) : (\n                                                        <div class={`text-center border rounded-circle imageRounded imageRoundedThumb float-left text-muted pt-1`} \n                                                            style={`margin-right: 2px; ${el.images && el.images[0] ? `background-image: url(\"${el.images[0].s3SmallLink}\");` : ''}`}\n                                                        >\n                                                            {/* {!hasImage && <i class='fas fa-dog text-muted' style='font-size: 10px;' />} */}\n                                                            {!hasImage && <span style='font-size: 15px;'>{util.ucfirst(el.dogName, true)}</span>}\n                                                        </div>\n                                                    )}\n                                                </a>\n                                            </>\n                                        ))}\n                                    </div>\n                                    <div class='w-100 clearfix mt-2'>\n                                        <small>\n                                            {line.grouped.map(el => (\n                                                <span class='float-left mr-2 text-muted'>\n                                                    <a href={`/dogs/${el.dogId}`}>\n                                                        {el.dogShortname || el.dogName}\n                                                    </a>\n                                                </span>\n                                            ))}\n                                        </small>\n                                    </div>\n                                </>\n                            )}\n\n                            <div class='w-100 clearfix'>\n                                <small class='text-muted'>\n                                    {line.date && <small onClick={this.toggleDate}>\n                                        {showDate ? util.formatDate(line.date, { locale: 'no-NB' }) : util.formatDistance(line.date, new Date(), { locale: 'no-NB' })}\n                                        {line.endDate && <span class='ml-3'><i class='fas fa-hourglass-end' /> {util.formatDate(line.endDate, { locale: 'no-NB' })}</span>}\n                                        {line.historyType && <span class='ml-3'>\n                                            <i class='fas fa-folder-open' /> {HISTORY_TYPE_MAP[line.historyType]} {line.vaccineType ? ` - ${VACCINE_TYPES[line.vaccineType].name}` : ''}\n                                        </span>}\n                                        {line.weight && <span class='ml-3'><i class='fas fa-balance-scale' /> {line.weight} kg</span>}\n                                        {line.bodyScore && <span class='ml-3'><i class='fas fa-dog' /> {line.bodyScore}</span>}\n                                        {line.user && line.user.email && <span class='ml-3'><i class='fas fa-user' /> {line.user.email}</span>}\n                                    </small>}\n                                </small>\n                            </div>\n\n                            <div class='row mt-2'>\n                                <div class='col-12'>\n                                    <span class='font-weight-normal'>{line.comment}</span>\n                                    <span class='float-right'>\n                                        {line.cost ? `Kr. ${util.format(line.cost, 2)}` : ''}\n                                    </span>\n                                </div>\n                            </div>\n\n                        </div>\n                    </div>\n\n                    <div class='col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mt-1'>\n                        <div class='row'>\n                            <ImageScroller stores={this.props.stores} images={line.images} />\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default DogHistoryLine;\n"],"sourceRoot":""}