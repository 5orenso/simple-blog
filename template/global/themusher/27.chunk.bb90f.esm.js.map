{"version":3,"sources":["webpack:///./components/imageSlider/index.js","webpack:///./components/workout/summary.js","webpack:///./routes/home/feed.js","webpack:///./components/workout/index.js","webpack:///./components/modal/index.js","webpack:///./components/dog/scroller.js","webpack:///./components/dog/calendar.js","webpack:///./components/dog/history.js"],"names":["observer","Component","constructor","props","super","touchStart","e","stopPropagation","this","setState","startX","touches","pageX","touchEnd","undefined","sliding","touchMove","totalImages","state","scrollDistance","x","prevImage","nextImage","images","imageContainer","currentImage1","currentImage2","currentIdx","length","imageDots","Array","fill","map","y","nextImageContainer","nextIdx","componentWillReceiveProps","nextProps","nextImages","render","img","curImage","htmlImageRatio","height","width","imgHeight","imgWidth","dimensions","orientation","imageRatio","class","style","onTouchstart","onTouchend","onTouchmove","loading","src","s3LargeLink","ref","c","image1","image2","i","summary","week","year","count","util","format","distanceKm","elevation","secToHms","duration","speedAvg","MARGIN_TOP","mu","marginTop","MARGIN_BOTTOM","marginBottom","SUB_MENU_MARGIN_TOP","subMenuMarginTop","initialState","isLoading","Home","setHistoryType","historyType","setDay","yyyy","mm","dd","resetDay","loadAll","loadFeed","userStore","workoutStore","stores","currentTeam","currentMonth","Date","getMonth","month","getYear","team","dog","getFeed","id","componentDidMount","filterHistories","isOk","day","appState","darkmode","historyFeed","isAdmin","href","basehref","callback","onClick","padDate","filter","line","getWorkoutColor","workout","type","getWorkoutIcon","MAX_LOADINDEX","getMaxLoadIndex","showAddComment","viewImageIdx","likeWorkout","Workout","toggleDate","preventDefault","showDate","async","workoutId","setTimeout","toggleAddComment","target","parentElement","dataset","inputRef","focus","viewImage","idx","closest","shareLink","url","title","text","shareUrl","onTeamClick","teamid","showTeam","hideTeam","onUserClick","onDogClick","dogid","dogs","showDog","hideDog","updateTimer","forceShowDate","wrapperClasses","wrapperClassesRow","viewmode","hasShareApi","user","allDogs","language","intensity","findIntensity","code","findTeam","teamName","name","teamNames","push","teams","forEach","likes","comments","hasLikedWorkout","findIndex","gpxInfo","mushers","loadIndex","workoutEquipment","findEquipment","equipment","workoutEquipmentIcon","field","musherImages","slice","musher","u","findPublicUser","publicUser","image","s3SmallLink","mapImage","imgs","toJS","batteryUsage","battegryLevelStart","battegryLevelEnd","views","getViews","statistics","back","temperature","value","isLocked","isInProgress","role","date","formatDate","locale","hour12","hour","minute","formatDistance","getLoadIndexColor","normalizeBetween","Math","floor","getLoadIndexText","garminId","stravaId","track","dogsLeft","dogsRight","sledWeight","indexOf","kcalBurnedTotal","kcalMeatGramsTotal","kcalSalmonGramsTotal","kcalFatGramsTotal","description","markdown","replaceImages","comment","markdownOpts","getMarkdownOptions","avgGpsMovingSpeed","dblClick","likeRef","data-id","data-url","uuidv4","data-title","rel","data-native","inputRefObject","col","offset","compact","object","isTeamAdmin","Modal","startY","pageY","readyToRefresh","close","refreshing","appContainer","scrollTop","imagexxl","thumb","download","DogScroller","scrollImages","scrollLeft","clientWidth","imageIdx","nearestInt","round","diff","abs","Number","isInteger","sortByName","a","b","dogA","find","dogB","size","onScroll","sort","dogId","d","className","showName","showPosition","RED_DAYS","HistoryCalendar","prevHistoryType","historytype","chooseDay","parseInt","loadHistorySummary","chosenDD","chosenMM","chosenYYYY","HISTORY_TYPE_MAP","getHistoryMap","DAYS","getDays","MONTHS","getMonths","currentDay","getDate","currentYear","getFullYear","monthNum","yearNum","nextMonth","nextYear","getNextMonth","prevMonth","prevYear","getPrevMonth","daysOfMonth","getDaysInMonth","weeksInMonth","getWeeksInMonth","daysOfWeek","getDaysInWeek","isoDate","getDay","weekObj","histories","findHistory","endHistories","findEndHistory","isChosen","isToday","isDayOff","data-day","data-month","data-year","history","bgColor","getHistoryTypeColor","getHistoryPri","key","data-historytype","VACCINE_TYPES","getVaccineTypes","DogHistoryLine","showModal","displayModal","currentImage","currentImageXXL","closeModal","eventFired","diffY","diffX","deleteVerify","reset","deleted","deleteHistoryRequest","deleteHistory","dogStore","save","$pull","_id","swipeLeft","hasImage","isBeeingEdited","hoverElement","hoverelementonly","grouped","dogImage","dogShortname","dogName","el","ucfirst","endDate","vaccineType","weight","bodyScore","email","cost"],"mappings":"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","file":"27.chunk.bb90f.esm.js","sourcesContent":["import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\n\n@observer\nclass ImageSlider extends Component {\n    constructor(props) {\n        super(props);\n        const { images = [] } = props;\n        this.state = {\n            imageContainer: 1,\n            currentImage1: images[0] || {},\n            currentImage2: {},\n            currentIdx: 0,\n            totalImages: images.length || 0,\n            imageDots: [...Array(images.length || 0).fill(1).map((x, y) => x + y)],\n        };\n    }\n\n    nextImage() {\n        // console.log('next');\n        const { images } = this.props;\n        const { totalImages, currentIdx, imageContainer } = this.state;\n        const nextImageContainer = imageContainer === 1 ? 2 : 1;\n        let nextIdx = currentIdx + 1;\n        if (nextIdx > totalImages -1) {\n            nextIdx = 0;\n        }\n        this.setState({\n            [`currentImage${nextImageContainer}`]: images[nextIdx],\n            currentIdx: nextIdx,\n            imageContainer: nextImageContainer,\n        });\n    }\n\n    prevImage() {\n        // console.log('prev');\n        const { images } = this.props;\n        const { totalImages, currentIdx, imageContainer } = this.state;\n        const nextImageContainer = imageContainer === 1 ? 2 : 1;\n        let nextIdx = currentIdx - 1;\n        if (nextIdx < 0) {\n            nextIdx = totalImages - 1;\n        }\n        this.setState({\n            [`currentImage${nextImageContainer}`]: images[nextIdx],\n            currentIdx: nextIdx,\n            imageContainer: imageContainer === 1 ? 2 : 1,\n        });\n    }\n\n    touchStart = (e) => {\n        e.stopPropagation();\n        this.setState({\n            startX: e.touches[0].pageX,\n        })\n    }\n\n    touchEnd = (e) => {\n        e.stopPropagation();\n        this.setState({\n            startX: undefined,\n            sliding: false,\n        })\n    }\n\n    touchMove = (e) => {\n        e.stopPropagation();\n        // e.preventDefault();\n        const { totalImages } = this.state;\n        if (totalImages > 1) {\n            const { startX, sliding } = this.state;\n            const scrollDistance = 50;\n            const x = e.touches[0].pageX;\n            if (!sliding) {\n                if (x > startX + scrollDistance) {\n                    this.setState({ sliding: true })\n                    this.prevImage();\n                } else if (x < startX - scrollDistance) {\n                    this.setState({ sliding: true })\n                    this.nextImage();\n                }\n            }\n        }\n    }\n\n    componentWillReceiveProps(nextProps) {\n        // console.log('componentWillReceiveProps', nextProps);\n        if (nextProps.images !== this.props.images) {\n            const { images: nextImages = [] } = nextProps;\n            this.setState({\n                imageContainer: 1,\n                currentImage1: nextImages.length > 0 ? nextImages[0] : {},\n                currentImage2: {},\n                currentIdx: 0,\n                totalImages: nextImages.length || 0,\n                imageDots: [...Array(nextImages.length || 0).fill(1).map((x, y) => x + y)],\n            });\n        }\n    }\n\n    render() {\n        const { currentImage1, currentImage2, imageContainer, totalImages, imageDots, currentIdx } = this.state;\n        const img = this[`image${imageContainer}`];\n        const curImage = imageContainer === 1 ? currentImage1 : currentImage2;\n        const htmlImageRatio = img && img.height ? img.width / img.height : 4 / 3;\n        let imgHeight;\n        let imgWidth;\n        if (curImage.dimensions) {\n            const { width, height, orientation } = curImage.dimensions;\n            if (orientation > 4 && orientation < 9) {\n                imgHeight = width;\n                imgWidth = height;\n            } else {\n                imgHeight = height;\n                imgWidth = width;\n            }\n        }\n        const imageRatio = curImage.dimensions ? imgWidth / imgHeight : htmlImageRatio;\n        if (totalImages <= 0) {\n            return '';\n        }\n\n        return (\n            <div class='w-100'>\n                <div class='border rounded position-relative w-100'\n                    style={`height: calc(85vw / ${imageRatio}); overflow: hidden; transition: all .3s ease-in-out;`}\n                    onTouchstart={this.touchStart}\n                    onTouchend={this.touchEnd}\n                    onTouchmove={this.touchMove}\n                >\n                    {totalImages > 1 && <span class='position-absolute' style='top:0px; right: 5px; z-index: 2000;'><small>{currentIdx + 1}/{totalImages}</small></span>}\n                    {currentImage1 && <div class='position-absolute' style={`${imageContainer === 1 ? 'opacity: 1;' :  'opacity: 0;'} transition: all .3s ease-in-out; top: 0; left: 0;`}>\n                        <img loading='lazy' src={currentImage1.s3LargeLink}\n                            class='img-fluid align-middle'\n                            ref={c => this.image1 = c}\n                        />\n                    </div>}\n                    {currentImage2 && <div class='position-absolute' style={`${imageContainer === 2 ? 'opacity: 1;' :  'opacity: 0;'} transition: all .3s ease-in-out; top: 0; left: 0;`}>\n                        <img loading='lazy' src={currentImage2.s3LargeLink}\n                            class='img-fluid align-middle'\n                            ref={c => this.image2 = c}\n                        />\n                    </div>}\n                </div>\n                {imageDots.length > 1 && <div class='w-100 text-center'>{imageDots.map(i => <span style={`color: ${i === currentIdx + 1 ? '#ffffff' : '#808080'};`}>&bull;</span>)}</div>}\n            </div>\n        );\n    }\n}\n\nexport default ImageSlider;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer, withText } from 'preact-i18n';\n\n@observer\nclass WorkoutSummary extends Component {\n    render() {\n        const { summary = {} } = this.props;\n\n        return (\n            <div class='w-100 mb-3'>\n                <div class='row'>\n                    <div class='col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 d-flex mb-0 position-relative'>\n                        {/* {JSON.stringify(workout, null, 4)} */}\n                        <div class={`text-center border rounded-circle imageRounded`}>\n                            <div class={`text-muted mt-2`} style='font-size: 40px; line-height: 1;'>{summary.week}</div>\n                            <div class={`text-muted`} style='font-size: 10px; line-height: 0.8em;'>{summary.year}</div>\n                        </div>\n                        <div class='flex-grow-1 pl-3'>\n                            <h5 class='my-0'>{summary.week} - {summary.year}</h5>\n                            <small class='text-muted'>\n                                <i class='fas fa-wave-square' /> {summary.count}\n                                <i class='fas fa-road ml-2' /> {util.format(summary.distanceKm, 0)}km\n                                <i class='fas fa-mountain ml-2' /> {util.format(summary.elevation, 0)}m\n                                <i class='fas fa-stopwatch ml-2' /> {util.secToHms(summary.duration)}\n                                <i class='fas fa-tachometer-alt ml-2' /> {util.format(summary.speedAvg, 1)}km/t\n                            </small>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default WorkoutSummary;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\nconst MARGIN_TOP = mu.marginTop(true);\nconst MARGIN_BOTTOM = mu.marginBottom();\nconst SUB_MENU_MARGIN_TOP = mu.subMenuMarginTop();\n\nimport Workout from '../../components/workout';\nimport WorkoutSummary from '../../components/workout/summary';\nimport DogHistory from '../../components/dog/history';\nimport DogAddLog from '../../components/dog/addlog';\nimport DogCalendar from '../../components/dog/calendar';\n\nconst initialState = {\n\tisLoading: false,\n};\n\n@observer\nclass Home extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n\t\tthis.loadAll();\n    }\n\n\tasync loadAll() {\n\t\tthis.setState({ isLoading: true });\n\t\tawait this.loadFeed();\n\t\tthis.setState({ isLoading: false });\n    }\n\n\tasync loadFeed(props = this.props) {\n\t\tconst { userStore, workoutStore } = this.props.stores;\n\t\tconst { currentTeam } = workoutStore;\n\n\t\tconst currentMonth = new Date().getMonth() + 1;\n        const { month = currentMonth, year = util.getYear(), team = currentTeam, dog = {} } = props;\n        await userStore.getFeed({ month, year, team, dog: dog.id });\n    }\n\n\tsetHistoryType = (historyType) => {\n\t\tthis.setState({ historyType });\n    }\n\n\tsetDay = (yyyy, mm, dd) => {\n\t\tthis.setState({ yyyy, mm, dd });\n\t}\n\n\tresetDay = () => {\n\t\tthis.setState({ yyyy: null, mm: null, dd: null });\n\t}\n\n\t// componentWillUnmount() {\n\t//     PubSub.unsubscribe(subscription);\n\t// }\n    componentDidMount() {\n        this.loadAll();\n    }\n\n\trender() {\n\t\tconst { isLoading, historyType, yyyy, mm, dd } = this.state;\n        // const filterHistories = historyType ? (e) => e.historyType === historyType : () => true;\n\t\tconst filterHistories = (e) => {\n            let isOk = true;\n            if (historyType) {\n                isOk = e.historyType === historyType;\n            }\n            if (isOk && yyyy && mm && dd) {\n                isOk = e.year === yyyy && e.month === mm && e.day === dd;\n            }\n            return isOk;\n        }\n\n\t\tconst { userStore, appState } = this.props.stores;\n        const { darkmode } = appState;\n\t\tconst { month, year } = this.props;\n\t\tconst { historyFeed, isAdmin } = userStore;\n\t\treturn (\n\t\t\t<div class='container-fluid' style={`margin-bottom: ${MARGIN_BOTTOM}; margin-top: ${MARGIN_TOP};`}>\n\t\t\t\t<div class='row fixed-top' style={`margin-top: ${SUB_MENU_MARGIN_TOP}; background-color: ${darkmode ? '#191d21' : '#f8f9fa'};`}>\n\t\t\t\t\t{isAdmin && <div class='col text-center subtopmenu'>\n\t\t\t\t\t\t<a href='/admin' class='text-secondary stretched-link'><nobr><i class='fas fa-user-shield' /> <Text id='home.admin'>Admin</Text></nobr></a>\n\t\t\t\t\t</div>}\n\t\t\t\t\t<div class='col text-center subtopmenu'>\n\t\t\t\t\t\t<a href='/' class='text-secondary stretched-link'><nobr><i class='fas fa-chart-line' /> <Text id='feed.dashboard'>Dashboard</Text></nobr></a>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col text-center border-bottom border-primary subtopmenu'>\n\t\t\t\t\t\t<a href='/feed' class='text-primary stretched-link'><nobr><i class='fas fa-rss' /> <Text id='feed.feed'>Feed</Text></nobr></a>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col text-center subtopmenu'>\n\t\t\t\t\t\t<a href='/todo' class='text-secondary stretched-link'><nobr><i class='fas fa-list' /> <Text id='feed.todo'>Todo</Text></nobr></a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t<div class='row'>\n\t\t\t\t\t<div class='col-12 mb-4'>\n\t\t\t\t\t\t<div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 px-0'>\n\t\t\t\t\t\t\t<span class='float-right'><DogAddLog stores={this.props.stores} dog={{}} /></span>\n\t\t\t\t\t\t\t<h5><Text id='feed.title'>Siste fra hundene</Text></h5>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<DogCalendar stores={this.props.stores} basehref={`/feed/`} month={month} year={year} callback={this.setHistoryType} setDay={this.setDay} />\n\n\t\t\t\t\t\t{!isLoading && historyFeed && historyFeed.length === 0 && (\n\t\t\t\t\t\t\t<div class='mb-5 py-3 text-center border-top border-bottom text-muted'>\n\t\t\t\t\t\t\t\t<div class='display-4'>\n\t\t\t\t\t\t\t\t\t<i class='fas fa-dog' />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<h5>\n\t\t\t\t\t\t\t\t\t<Text id='feed.no-log'>Ingen hendelser fra hundene.</Text>\n\t\t\t\t\t\t\t\t</h5>\n\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t<Text id='feed.tip-1'>Det er fint å legge inn hendelser (løpetid, skader, vaksinering, vetrinærbesøk, mm) og bilder av hundene i loggen.</Text>\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t<Text id='feed.tip-2'>På denne måten så vil hele teamet ditt se hva som skjer med hundene og hva som trengs å følges opp.\n\t\t\t\t\t\t\t\t\tDette er en slags <strike>Face</strike>Dogbook for hundene deres.</Text>\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t<a class='btn btn-info mt-3' href='/dogs/'>\n\t\t\t\t\t\t\t\t\t<i class='fas fa-dog' /> <Text id='feed.add-log'>Legg til logg på hundene</Text>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t{yyyy && mm && dd && (\n\t\t\t\t\t\t\t<div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 px-0 clearfix mb-3'>\n\t\t\t\t\t\t\t\t<button class='btn btn-sm btn-secondary float-right' onClick={this.resetDay}>\n\t\t\t\t\t\t\t\t\t<Text id='feed.show-all-days'>Vis alle</Text>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t<h5>{yyyy}-{util.padDate(mm)}-{util.padDate(dd)}:</h5>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t{historyFeed && historyFeed.filter(filterHistories).map(line => (\n\t\t\t\t\t\t\t<DogHistory stores={this.props.stores} line={line} />\n\t\t\t\t\t\t))}\n\n\t\t\t\t\t\t{!isLoading && historyFeed && historyFeed.filter(filterHistories).length === 0 && (\n\t\t\t\t\t\t\t<div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 px-0 clearfix'>\n\t\t\t\t\t\t\t\t<div class='mb-5 py-3 text-center border-top border-bottom text-muted'>\n\t\t\t\t\t\t\t\t\t<div class='display-4'>\n\t\t\t\t\t\t\t\t\t\t<i class='fas fa-dog' />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<h5>\n\t\t\t\t\t\t\t\t\t\t<Text id='feed.no-log'>Ingen hendelser fra hundene.</Text>\n\t\t\t\t\t\t\t\t\t</h5>\n\t\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t\t<Text id='feed.tip-1'>Det er fint å legge inn hendelser (løpetid, skader, vaksinering, vetrinærbesøk, mm) og bilder av hundene i loggen.</Text>\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t\t<Text id='feed.tip-2'>På denne måten så vil hele teamet ditt se hva som skjer med hundene og hva som trengs å følges opp.\n\t\t\t\t\t\t\t\t\t\tDette er en slags <strike>Face</strike>Dogbook for hundene deres.</Text>\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t\t<a class='btn btn-info mt-3' href='/dogs/'>\n\t\t\t\t\t\t\t\t\t\t<i class='fas fa-dog' /> <Text id='feed.add-log'>Legg til logg på hundene</Text>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Home;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { toJS } from 'mobx';\nimport { Text, Localizer, withText } from 'preact-i18n';\nimport Markdown from 'preact-markdown';\n\nimport Modal from '../modal';\nimport WorkoutComments from '../../components/workout/comments';\nimport WorkoutAddComment from '../../components/workout/commentAdd';\nimport ImageScroller from '../../components/imageScroller';\nimport DogScroller from '../../components/dog/scroller';\n\nimport Overlay from '../../components/overlay/';\nimport TeamsPublicDetail from '../../routes/teams/publicDetail';\nimport DogPublicDetail from '../../routes/dogs/publicDetail';\n\nimport LikesAndComments from '../../components/feedback/likesAndComments';\nimport Views from '../../components/feedback/views';\n\nimport Speed from '../../components/data/speed';\nimport Elevation from '../../components/data/elevation';\nimport Weight from '../../components/data/weight';\nimport Distance from '../../components/data/distance';\nimport Temperature from '../../components/data/temperature';\n\nimport mu from '../../lib/musher-util';\n\nconst MAX_LOADINDEX = mu.getMaxLoadIndex();\n\nfunction getWorkoutColor(workout) {\n\tswitch (workout.type) {\n\t\tcase 1:\n\t\t\treturn 'border-primary';\n\t\tcase 2:\n\t\t\treturn 'border-danger';\n\t\tcase 3:\n\t\t\treturn 'border-success';\n\t\tcase 4:\n\t\t\treturn 'border-info';\n\t\tdefault:\n\t\t\treturn 'border-warning';\n\t}\n}\n\nfunction getWorkoutIcon(workout) {\n\tswitch (workout.type) {\n\t\tcase 1:\n\t\t\treturn 'fas fa-running';\n\t\tcase 2:\n\t\t\treturn 'fas fa-flag-checkered';\n\t\tcase 3:\n\t\t\treturn 'fas fa-hiking';\n\t\tcase 4:\n\t\t\treturn 'fas fa-futbol';\n\t\tdefault:\n\t\t\treturn 'fas fa-hiking';\n\t}\n}\n\nfunction displayDistance(distanceKm) {\n\tif (distanceKm < 5) {\n\t\treturn util.format(distanceKm, 2);\n\t}\n\tif (distanceKm < 10) {\n\t\treturn util.format(distanceKm, 1);\n\t}\n\treturn util.format(distanceKm, 1);\n}\n\nconst initialState = {\n\tshowAddComment: false,\n    viewImageIdx: {},\n    likeWorkout: {},\n};\n\n@observer\nclass Workout extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n        this.updateTimer = {};\n\t\tthis.inputRef = {};\n    }\n\n    toggleDate = (e) => {\n        e.stopPropagation();\n        e.preventDefault();\n        const { showDate } = this.state;\n        this.setState({ showDate: !showDate });\n    }\n\n\n\tlikeWorkout = async () => {\n\t\tconst { workoutStore } = this.props.stores;\n        const { workout } = this.props;\n        const workoutId = workout.id;\n\n        const { likeWorkout } = this.state;\n        likeWorkout[workoutId] = true;\n        this.setState({ likeWorkout });\n        setTimeout(() => {\n            const { likeWorkout } = this.state;\n            delete likeWorkout[workoutId];\n            this.setState({ likeWorkout });\n        }, 1200);\n\n\t\tconst response = await workoutStore.likeWorkout({ id: workoutId });\n        if (response && response.status === 200) {\n\n\t\t}\n\t}\n\n\ttoggleAddComment = (e) => {\n\t\tconst workoutId = e.target.parentElement.dataset.id || e.target.dataset.id;\n\t\tconst { showAddComment } = this.state;\n\t\tthis.setState({\n\t\t\tshowAddComment: !showAddComment,\n\t\t}, () => {\n\t\t\tif (this.inputRef[workoutId]) {\n\t\t\t\tthis.inputRef[workoutId].focus();\n\t\t\t}\n\t\t});\n\t}\n\n    viewImage = (e) => {\n\t\tconst { id, idx } = e.target.closest('img').dataset;\n        const { viewImageIdx } = this.state;\n        viewImageIdx[id] = idx;\n        this.setState({ viewImageIdx });\n    }\n\n    shareLink = (e) => {\n        const { url, title, text } = e.target.closest('button').dataset;\n        const { appState } = this.props.stores;\n        appState.shareUrl({ url, title, text });\n    }\n\n        // Overlay functions\n    onTeamClick = (e, teamid) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.setState({\n            showTeam: teamid,\n        });\n        return false;\n    }\n\n    hideTeam = () => {\n        this.setState({\n            showTeam: null,\n        });\n    }\n\n    onUserClick = (e, userid) => {\n        e.preventDefault();\n        e.stopPropagation();\n        return false;\n    }\n\n    onDogClick = (e, dogid, dogs) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.setState({\n            showDog: dogid,\n            dogs,\n        });\n        return false;\n    }\n\n    hideDog = () => {\n        this.setState({\n            showDog: null,\n        });\n    }\n\n    render() {\n        const {\n            showDate,\n            showAddComment,\n            viewImageIdx = {},\n            likeWorkout,\n            dogs,\n            showTeam,\n            showDog,\n        } = this.state;\n        const {\n            workout,\n            showDate: forceShowDate,\n            wrapperClasses = 'col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3',\n            wrapperClassesRow = 'row',\n        } = this.props;\n\t\tconst { userStore, appState, workoutStore } = this.props.stores;\n        const { viewmode, hasShareApi } = appState;\n        const { user, dogs: allDogs } = userStore;\n        const { language = 'en' } = user;\n        const intensity = userStore.findIntensity({ code: workout.intensity, language }) || {};\n        // const teamName = userStore.findTeam(workout.team);\n        const team = userStore.findTeam(workout.team, true) || {};\n        const teamName = team.name;\n        // const teamNames = workout.teams ? workout.teams.map(e => userStore.findTeam(e)) : [];\n        const teamNames = [];\n        if (teamName) {\n            teamNames.push(teamName);\n        }\n        if (workout.teams) {\n            workout.teams.forEach((e) => {\n                if (userStore.findTeam(e)) {\n                    teamNames.push(userStore.findTeam(e));\n                }\n            });\n        }\n\n        const { likes = [], comments = [] } = workout;\n\t\tconst hasLikedWorkout = workout.likes && workout.likes.findIndex(e => e.user === user.id) > -1;\n        const { gpxInfo = {}, mushers = [] } = workout;\n\t\tconst { loadIndex = 0 } = gpxInfo;\n        const workoutEquipment = userStore.findEquipment({ equipment: workout.equipment, language });\n        const workoutEquipmentIcon = userStore.findEquipment({ equipment: workout.equipment, field: 'icon' });\n\n        const musherImages = [];\n        if (mushers.length > 1) {\n            mushers.slice(1, 10).map((musher) => {\n                const u = workoutStore.findPublicUser(musher) || {};\n                if (u.images && u.images[0]) {\n                    musherImages.push(u.images[0]);\n                }\n            });\n        }\n\n        const publicUser = workoutStore.findPublicUser(mushers[0]) || {};\n        let image;\n        if (publicUser && publicUser.images && publicUser.images[0]) {\n            image = publicUser.images[0];\n        } else if (team.image && team.image.s3SmallLink) {\n            image = team.image;\n        } else if (team.images && team.images[0] && team.images[0].s3SmallLink) {\n            image = team.images[0];\n        } else if (workout.image && workout.image.s3SmallLink) {\n            image = workout.image;\n        }\n\n        const images = [];\n        if (workout.mapImage) {\n            images.push({\n                ...workout.mapImage,\n                type: 'map',\n            });\n        }\n        if (workout.images) {\n            const imgs = toJS(workout.images);\n            images.push(...imgs);\n        }\n        const imageIdx = viewImageIdx[workout.id] ? viewImageIdx[workout.id] : 0;\n        const currentImage = images && images[imageIdx] ? images[imageIdx] : null;\n\n        let batteryUsage;\n        if (workout && workout.gpxInfo && workout.gpxInfo.battegryLevelStart) {\n            batteryUsage = (workout.gpxInfo.battegryLevelStart - workout.gpxInfo.battegryLevelEnd) * 100;\n        }\n\n        const views = mu.getViews(workout.statistics);\n\n        // let temperature;\n        // let windSpeed;\n        // if (util.checkNested(workout, 'temperature')) {\n        //     const yr = toJS(workout.yr[0].instant.details);\n        //     // displayValue = `Yr.no: 🌡️ ${yr.air_temperature}°C, 💨 ${yr.wind_speed}m/s 🧭 ${mu.windDirection(yr.wind_from_direction)}, ☁️ ${yr.cloud_area_fraction}%, ${yr.air_pressure_at_sea_level}mb, 💦 ${yr.relative_humidity}%`;\n        //     temperature = `${yr.air_temperature}°C`;\n        //     windSpeed = `${yr.wind_speed}m/s`;\n        // }\n\t\t// // const loadMultiplier = loadIndex / 100;\n\n        return (<>\n\n            {showTeam && <Overlay>\n                <TeamsPublicDetail stores={this.props.stores} teamid={showTeam} marginTop={'0px;'} marginBottom={'0px;'} back={this.hideTeam} hideTeam={this.hideTeam} />\n            </Overlay>}\n\n            {showDog && <Overlay>\n                <DogPublicDetail stores={this.props.stores} dogid={showDog} marginTop={'0px;'} marginBottom={'0px;'} back={this.hideDog} dogs={dogs} />\n            </Overlay>}\n\n            <div class='w-100 mb-2'>\n                <div class={wrapperClassesRow}>\n\n                    <div class={`${wrapperClasses} d-flex mb-0 position-relative`}>\n\n                        {/* {workout.gpxInfo && <svg viewBox='0 0 300 300' style='top: 80px; left: 10px; width: 90px; height: 90px;' class='position-absolute'>\n                            <path d={`${workout.gpxInfo.svgMap}`} style='fill: none; stroke: #0063FF; stroke-width: 5; opacity: 0.3;' />\n                        </svg>} */}\n\n                        {/* {JSON.stringify(workout, null, 4)} */}\n                        <div class='text-center'>\n                            <div\n                                class={`position-relative text-center border rounded-circle imageRounded ${getWorkoutColor(workout)}`}\n                                style={`${image ? `background-image: url(\"${image.s3SmallLink}\"); background-size: cover;` : ''} border-width: 3px !important;`}\n                            >\n                                {!image && <i class={`${getWorkoutIcon(workout)} text-${intensity.class ? intensity.class : 'muted'} mt-3`} style='font-size: 40px;' />}\n\n                                {musherImages && musherImages.map((img, idx) => <>\n                                    <div\n                                        class='position-absolute rounded-circle imageRounded border imageRoundedThumb border-white'\n                                        style={`\n                                            background-image: url(\"${img.s3SmallLink}\");\n                                            background-size: cover;\n                                            bottom: -3px;\n                                            left: ${-5 + (idx * 10)}px;\n                                        `}\n                                    />\n                                </>)}\n                            </div>\n                            {workout.temperature !== 0 && <>\n                                <span class='text-muted font-weight-light'>\n                                    <Temperature stores={this.props.stores} value={workout.temperature} />\n                                </span>\n                            </>}\n                        </div>\n                        <div class='flex-grow-1 pl-3' style='line-height: 1.2em;'>\n                            <span class='float-right'>\n                                {workout.isLocked === 1 && <i class='fas fa-lock text-danger ml-3' />}\n                                {workout.isInProgress === 1 && <div class='spinner-grow text-success ml-3' role='status' />}\n                                {workout.isInProgress === 2 && <i class='fas fa-pause-circle text-warning ml-3' />}\n                            </span>\n                            <a class='stretched-link' href={`/workouts/${workout.id}`}>\n                                <h5 class='my-0 mb-1' style='line-height: 1.0em;'>\n                                    {workout.name}\n                                </h5>\n                            </a>\n                            {teamNames && teamNames.length > 0 && <small class='font-weight-lighter'>\n                                {teamNames.map((name, idx) => <>{idx > 0 ? ', ' : ''}{name}</>)}\n                            </small>}\n                            <br />\n                            <small class='text-muted'>\n                                {workout.date && <small onClick={this.toggleDate}>\n                                    {forceShowDate || showDate ? util.formatDate(workout.date, { locale: 'no-NB', hour12: false, hour: '2-digit', minute: '2-digit' }) : util.formatDistance(workout.date, new Date(), { locale: 'no-NB' })}\n                                </small>}\n                                <span class={`badge badge-${intensity.class} ml-2`}>{intensity.name}</span>\n                                {loadIndex > 0 && <span class={`ml-2 text-${mu.getLoadIndexColor(util.normalizeBetween(loadIndex, 0, MAX_LOADINDEX, 0, 100))}`}>\n                                    <i class='fas fa-hand-rock mr-1' />\n                                    {Math.floor(util.normalizeBetween(loadIndex, 0, MAX_LOADINDEX, 0, 100))} -&nbsp;\n                                    {mu.getLoadIndexText(util.normalizeBetween(loadIndex, 0, MAX_LOADINDEX, 0, 100))}\n                                </span>}\n                                <br />\n                            </small>\n                            <small>\n                                <div class='text-muted'>\n                                    {workout.garminId > 0 && <div class={`float-left mr-2 text-center border rounded-circle imageRounded imageRoundedIcon`} style={`background-image: url(\"./assets/garmin-connect.png\");`} />}\n                                    {workout.stravaId > 0&& <div class={`float-left mr-2 text-center border rounded-circle imageRounded imageRoundedIcon`} style={`background-image: url(\"./assets/strava-icon.png\");`} />}\n\n                                    {workout.equipment > 0 && <><i class={`${workoutEquipmentIcon} ml-2`} /> {workoutEquipment}</>}\n                                    {/* {workout.distanceKm > 0 && <><i class='fas fa-road ml-2' /> {displayDistance(workout.distanceKm)}km</>}\n                                    {workout.elevation > 0 && <><i class='fas fa-mountain ml-2' /> {util.format(workout.elevation, 0)}m</>} */}\n                                    {/* {workout.speedAvg > 0 && <><i class='fas fa-tachometer-alt ml-2' /> {util.format(workout.speedAvg, 1)}km/t</>} */}\n                                    {workout.dogs > 0 && <><i class='fas fa-dog ml-2' /> {workout.dogs.length}</>}\n                                    {workout.track > 0 && <><i class={`fas fa-map-marked text-${workout.track > 0 ? 'success' : 'danger'} ml-2`} /></>}\n                                    {workout.dogsLeft > 0 && <><i class={`fas fa-crosshairs text-${workout.dogsLeft && workout.dogsRight ? 'success' : 'danger'} ml-2`} /></>}\n                                    {workout.sledWeight > 0 && <>\n                                        <i class='fas fa-sleigh ml-2' /> <Weight stores={this.props.stores} value={workout.sledWeight} />\n                                    </>}\n                                    {batteryUsage > 0 && <span class='text-muted ml-2'><i class='fas fa-battery-three-quarters' /> {util.format(batteryUsage, 1)}% <Text id='workout.battery-used'>used</Text></span>}\n                                </div>\n                                {['beta', 'advanced'].indexOf(viewmode) > -1 && (\n                                    <span class='text-muted'>\n                                        <i class='fas fa-balance-scale' /> {util.format(workout.kcalBurnedTotal)} <Text id='workout.kcal'>kcal</Text>\n                                        <i class='fas fa-drumstick-bite ml-2' /> <Weight stores={this.props.stores} value={workout.kcalMeatGramsTotal / 1000} />\n                                        <i class='fas fa-fish ml-2' /> <Weight stores={this.props.stores} value={workout.kcalSalmonGramsTotal / 1000} />\n                                        <i class='fas fa-piggy-bank ml-2' /> <Weight stores={this.props.stores} value={workout.kcalFatGramsTotal / 1000} />\n                                    </span>\n                                )}\n                            </small>\n                        </div>\n                    </div>\n                    <div class={`${wrapperClasses} position-relative mt-2`}>\n                        <strong>\n                            {workout.description}\n                        </strong>\n                    </div>\n                    <div class={`${wrapperClasses} position-relative`}>\n                        <Markdown markdown={mu.replaceImages(workout.comment, workout.images, language)} markdownOpts={mu.getMarkdownOptions()} />\n                    </div>\n                    <div class={`${wrapperClasses} d-flex mb-0 position-relative`}>\n                        <div class='container-fluid px-0'>\n                            <div class='row mt-1'>\n                                {workout.distanceKm > 0 && <div class='col-3'>\n                                    <div class='text-overflow'>\n                                        <small><i class='fas fa-road' /> <Text id='workout.calendar.distance'>Distanse</Text></small>\n                                    </div>\n                                    <div class='text-overflow font-weight-light' style='font-size: 1.2em;'>\n                                        <Distance stores={this.props.stores} value={workout.distanceKm} />\n                                    </div>\n                                </div>}\n                                {workout.elevation > 0 && <div class='col-3'>\n                                    <div class='text-overflow'>\n                                        <small><i class='fas fa-mountain' /> <Text id='workout.calendar.ascend'>Høydemeter</Text></small>\n                                    </div>\n                                    <div class='text-overflow font-weight-light' style='font-size: 1.2em;'>\n                                        <Elevation stores={this.props.stores} value={workout.elevation} />\n                                    </div>\n                                </div>}\n                                {workout.duration > 0 && <div class='col-3'>\n                                    <div class='text-overflow'>\n                                        <small><i class='fas fa-clock' /> <Text id='workout.calendar.duration'>Varighet</Text></small>\n                                    </div>\n                                    <div class='text-overflow font-weight-light' style='font-size: 1.2em;'>\n                                        {util.secToHms(workout.duration, true)}\n                                    </div>\n                                </div>}\n                                {workout.speedAvg > 0 && <div class='col-3'>\n                                    <div class='text-overflow'>\n                                        <small><i class='fas fa-tachometer-alt' /> <Text id='workout.calendar.avg-speed'>Snittfart</Text></small>\n                                    </div>\n                                    <div class='text-overflow font-weight-light' style='font-size: 1.2em;'>\n\t\t\t\t                        {workout.gpxInfo && workout.gpxInfo.avgGpsMovingSpeed > 0 ? <>\n                                            <Speed stores={this.props.stores} value={workout.gpxInfo.avgGpsMovingSpeed * 3.6} />\n                                        </> : <>\n                                            <Speed stores={this.props.stores} value={workout.speedAvg} />\n                                        </>}\n                                    </div>\n                                </div>}\n                            </div>\n                        </div>\n                    </div>\n\n                    {['beta', 'advanced', 'normal'].indexOf(viewmode) > -1 && (\n                        <div class={`${wrapperClasses}`}>\n                            <div class='container-fluid px-0 mt-1'>\n                                <div class='row'>\n                                    <ImageScroller stores={this.props.stores} images={images} id={workout.id} dblClick={this.likeWorkout} likeRef={likeWorkout} />\n                                </div>\n                            </div>\n                        </div>\n                    )}\n\n                    {['beta', 'advanced', 'normal'].indexOf(viewmode) > -1 && <>\n                        {workout.dogs && workout.dogs.length > 0 && <div class='container-fluid px-0 mt-1'>\n                            <div class='row pt-2'>\n                                <DogScroller stores={this.props.stores} dogs={workout.dogs} allDogs={allDogs} onDogClick={this.onDogClick} />\n                            </div>\n                        </div>}\n\n                        <div class='mt-2'>\n                            <LikesAndComments\n                                stores={this.props.stores}\n                                likes={likes}\n                                comments={comments}\n                                type='workout'\n                                onTeamClick={this.onTeamClick}\n                                onUserClick={this.onUserClick}\n                            />\n                        </div>\n\n                    </>}\n\n                    {['beta', 'advanced', 'normal'].indexOf(viewmode) > -1 && <>\n                        <div class={`${wrapperClasses} mb-0 position-relative mt-2`}>\n                            <div class='row'>\n                                <div class='col text-center'>\n                                    <button type='button' class={`btn btn-sm btn-outline-${hasLikedWorkout ? 'primary' : 'secondary'} btn-lg btn-block ${hasLikedWorkout ? 'text-primary' : ''}`}\n                                        onClick={this.likeWorkout}\n                                        // disabled={hasLikedWorkout}\n                                    >\n                                        <i class={`${hasLikedWorkout ? 'text-primary fas' : 'far'} fa-thumbs-up`} /> <Text id='comments.like'>Lik</Text>\n                                    </button>\n                                </div>\n                                <div class='col text-center'>\n                                    <button type='button' class='btn btn-sm btn-outline-secondary btn-lg btn-block'\n                                        data-id={workout.id}\n                                        onClick={this.toggleAddComment}\n                                    >\n                                        <i class='fas fa-comment' /> <Text id='comments.comment-add'>Kommentar</Text>\n                                    </button>\n                                </div>\n                                {hasShareApi ? <>\n                                    <div class='col text-center'>\n                                        <button class='btn btn-sm btn-outline-secondary btn-lg btn-block text-overflow'\n                                            onClick={this.shareLink}\n                                            data-url={`https://themusher.app/share/workout/${workout.uuidv4}`}\n                                            data-title={`title: ${workout.name}`}\n                                        >\n                                            <i class='fas fa-share' /> <Text id='workout.share'>Del</Text>\n                                        </button>\n                                    </div>\n                                </> : <>\n                                    <div class='col text-center'>\n                                        <a class='btn btn-sm btn-outline-secondary btn-lg btn-block text-overflow'\n                                            href={`https://themusher.app/share/workout/${workout.uuidv4}`}\n                                            target='_blank'\n                                            rel='noreferrer'\n                                            data-native\n                                        >\n                                            <i class='fas fa-share' /> <Text id='workout.share'>Del</Text>\n                                        </a>\n                                    </div>\n                                </>}\n                            </div>\n                        </div>\n\n                        <div class={`${wrapperClasses} mt-2 mb-3`}>\n                            {showAddComment && <WorkoutAddComment\n                                stores={this.props.stores}\n                                workout={workout}\n                                inputRef={c => this.inputRef[workout.id] = c}\n                                inputRefObject={this.inputRef}\n                                col='12'\n                                offset='0'\n                            />}\n                            <WorkoutComments stores={this.props.stores} workout={workout} col='10' offset='2' compact={true} />\n                        </div>\n\n                        {views > 0 && <>\n                            <div class='mt-2'>\n                                <Views\n                                    stores={this.props.stores}\n                                    views={views}\n                                    object={workout}\n                                    type='workout'\n                                    isTeamAdmin={true}\n                                    isAdmin={false}\n                                    onTeamClick={this.onTeamClick}\n                                    onUserClick={this.onUserClick}\n                                />\n                            </div>\n                        </>}\n\n                    </>}\n\n                </div>\n            </div>\n        </>);\n    }\n}\n\nexport default Workout;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer, withText } from 'preact-i18n';\n\n@observer\nclass Modal extends Component {\n    toggleDate = () => {\n        const { showDate } = this.state;\n        this.setState({ showDate: !showDate });\n    }\n\n    touchStart = (e) => {\n        e.stopPropagation();\n        this.setState({\n            startY: e.touches[0].pageY,\n        })\n    }\n\n    touchEnd = (e) => {\n        e.stopPropagation();\n        this.setState({\n            startY: undefined,\n            readyToRefresh: false,\n        })\n    }\n\n    touchMove = (e) => {\n        e.stopPropagation();\n        const { close } = this.props;\n        const { startY, refreshing } = this.state;\n        const scrollDistance = 30;\n        const y = e.touches[0].pageY;\n        if (this.appContainer) {\n            const { scrollTop } = this.appContainer;\n            if (scrollTop === 0 && y > startY + scrollDistance && !refreshing) {\n                close();\n            }\n        }\n    }\n\n    render() {\n        const { showDate } = this.state;\n        const { image, imagexxl, close, thumb, name, title, date } = this.props;\n        return (\n            <div class='fixed-top bg-dark text-center pt-2' style='width: 100vw; height: 100vh;'>\n                <button class='btn btn-secondary float-right mr-2' onClick={close}>X</button>\n\n                    <div class='d-flex mb-2 px-2'>\n                        {/* {JSON.stringify(dog, null, 4)} */}\n                        {thumb && <div class={`text-center border rounded-circle imageRounded imageRoundedSmall`} style={thumb ? `background-image: url(\"${thumb}\");` : ''}>\n                            &nbsp;\n                        </div>}\n                        <div class='flex-grow-1 pl-3 pr-2 text-left' style='line-height: 1.3em;'>\n                            {name && <strong class='mr-2'>{name}:</strong>}\n                            {title}<br />\n                            <small class='text-muted'>\n                                {date && <small onClick={this.toggleDate}>\n                                    {showDate ? util.formatDate(date, { locale: 'no-NB' }) : util.formatDistance(date, new Date(), { locale: 'no-NB' })}\n                                </small>}\n                            </small>\n                        </div>\n                    </div>\n\n\n                <img src={image}\n                    class='img-fluid align-middle mt-2 mb-2'\n                    onClick={close}\n                    onTouchstart={this.touchStart}\n                    onTouchend={this.touchEnd}\n                    onTouchmove={this.touchMove}\n                    ref={c => this.appContainer = c}\n                />\n\n                <a target='_blank' rel='noopener noreferrer' href={imagexxl || image} download={imagexxl || image}>\n                    <i class='fas fa-download' /> <Text id='modal.download'>Last ned bildet</Text>\n                </a>\n            </div>\n        );\n    }\n}\n\nexport default Modal;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer } from 'preact-i18n';\n\nimport DogSimplePublic from './simplePublic';\n\n@observer\nclass DogScroller extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            imageIdx: 0,\n        };\n    }\n\n    scrollImages = (e) => {\n        const { dogs } = this.props;\n\n        const { scrollLeft, scrollWidth, clientWidth } = e.target;\n        const imageStep = clientWidth;\n        const imageIdx = scrollLeft / imageStep;\n        // console.log({ e, imageStep, imageIdx, scrollLeft, scrollWidth, clientWidth });\n\n        const nearestInt = Math.round(imageIdx);\n        const diff = Math.abs(nearestInt - imageIdx);\n        // console.log({ nearestInt, diff });\n        if (Number.isInteger(imageIdx) || diff < 0.1) {\n            this.setState({\n                imageIdx: nearestInt,\n            });\n        }\n    }\n\n    sortByName = (a, b) => {\n        const { allDogs = [] } = this.props;\n        const dogA = allDogs.find(e => e.id === a);\n        const dogB = allDogs.find(e => e.id === b);\n        if (dogA && dogB) {\n            if (dogA.name > dogB.name) {\n                return 1;\n            }\n        }\n        return -1;\n    }\n\n    render() {\n        const { imageIdx } = this.state;\n        const { dogs, allDogs = [], size = 'medium', onDogClick = () => {} } = this.props;\n\n        return (\n            <div class='w-100'>\n                <div\n                    class='d-flex flex-row flex-nowrap no-scrollbar'\n                    style='overflow: auto; scroll-snap-type: x mandatory;'\n                    onScroll={this.scrollImages}\n                >\n                    {dogs && dogs.sort(this.sortByName).map((dogId, idx) => {\n                        const dog = allDogs.find(e => e.id === dogId);\n                        if (!dog) {\n                            return '';\n                        }\n                        return (\n                            <div class='col clearfix position-relative p-0 mx-2'>\n                                <div\n                                    class={`w-100 h-100 text-center rounded-lg imageContainer d-flex justify-content-center align-items-center`}\n                                    style={`\n                                        flex-wrap: wrap;\n                                        overflow-y: hidden;\n                                    `}\n                                    onTouchstart={(e) => { e.stopPropagation(); }}\n                                    onTouchend={(e) => { e.stopPropagation(); }}\n                                    onTouchmove={(e) => { e.stopPropagation(); }}\n                                >\n                                    <DogSimplePublic\n                                        stores={this.props.stores}\n                                        dog={dog}\n                                        dogs={allDogs.filter(d => dogs.indexOf(d.id) > -1).sort((a, b) => a.name > b.name ? 1 : -1)}\n                                        className='mx-auto'\n                                        showName={true}\n                                        showPosition={false}\n                                        size={size}\n                                        onDogClick={onDogClick} \n                                    />\n                                    {/* <xmp>{JSON.stringify(img, null, 4)}</xmp> */}\n                                </div>\n                            </div>\n                        );\n                    })}\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default DogScroller;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer, withText } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nconst RED_DAYS = [0, 6];\n\n@observer\nclass HistoryCalendar extends Component {\n\n    async loadHistorySummary(props = this.props) {\n        this.setState({ isLoading: true });\n\t\tconst { userStore, workoutStore } = this.props.stores;\n\t\tconst { currentTeam } = workoutStore;\n\n        const currentMonth = new Date().getMonth() + 1;\n        const { month = currentMonth, year = util.getYear(), team = currentTeam, dog = {}, callback = () => {} } = props;\n        await userStore.getFeed({ month, year, team, dog: dog.id });\n\n        const { historyType } = this.state;\n        callback(historyType);\n\n        this.setState({ isLoading: false });\n    }\n\n    setHistoryType = (e) => {\n        const { callback = () => {} } = this.props;\n        const { historyType: prevHistoryType } = this.state;\n        let historyType = e.target.dataset.historytype || e.target.parentElement.dataset.historytype;\n\n        if (historyType === prevHistoryType) {\n            this.setState({ historyType: null })\n            callback(null);\n        } else {\n            this.setState({ historyType });\n            callback(historyType);\n        }\n    }\n\n    chooseDay = (e) => {\n        const { year: yyyy, month: mm, day: dd } = this.state;\n        const { setDay = () => {} } = this.props;\n\t\tconst day = parseInt(e.target.parentElement.dataset.day || e.target.dataset.day, 10);\n\t\tconst month = parseInt(e.target.parentElement.dataset.month || e.target.dataset.month, 10);\n\t\tconst year = parseInt(e.target.parentElement.dataset.year || e.target.dataset.year, 10);\n\t\t// console.log({ day, month, year });\n\n        if (year === yyyy && month === mm && day === dd) {\n            this.setState({\n                year: null,\n                month: null,\n                day: null,\n            });\n            setDay(null, null, null);\n        } else {\n            this.setState({\n                year,\n                month,\n                day,\n            });\n            setDay(year, month, day);\n        }\n    }\n\n    componentDidMount() {\n        this.loadHistorySummary();\n    }\n\n    componentWillReceiveProps(nextProps) {\n        // console.log('componentWillReceiveProps', nextProps);\n        if (nextProps.month !== this.props.month\n            || nextProps.year !== this.props.year\n            || nextProps.dog !== this.props.dog\n            || nextProps.team !== this.props.team) {\n            this.loadHistorySummary(nextProps);\n        }\n    }\n\n    render() {\n        const { historyType, day: chosenDD, month: chosenMM, year: chosenYYYY } = this.state;\n        const filterHistories = historyType ? (e) => e.historyType === historyType : () => true;\n\n        const { appState, userStore } = this.props.stores;\n        const { user } = userStore;\n        const { language = 'en' } = user;\n\n        const HISTORY_TYPE_MAP = mu.getHistoryMap(language);\n        const DAYS = mu.getDays(language);\n        const MONTHS = mu.getMonths(language);\n\n\t\tconst { darkmode } = appState;\n        const currentDay = new Date().getDate();\n        const currentMonth = new Date().getMonth() + 1;\n        const currentYear = new Date().getFullYear();\n\t\tconst { month = currentMonth, year = util.getYear(), dog, basehref } = this.props;\n\n        const monthNum = parseInt(month, 10);\n        const yearNum = parseInt(year, 10);\n        const { month: nextMonth, year: nextYear } = mu.getNextMonth(monthNum, yearNum);\n        const { month: prevMonth, year: prevYear } = mu.getPrevMonth(monthNum, yearNum);\n\n        const daysOfMonth = util.getDaysInMonth(month, year);\n        const weeksInMonth = util.getWeeksInMonth(month, year);\n        const firstWeek = weeksInMonth[0].week;\n        const daysOfWeek = util.getDaysInWeek(firstWeek, year);\n\n        return (\n            <>\n                <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-4'>\n                    <a href={`${basehref || '/workouts/month/'}${nextMonth}/${nextYear}/skipScroll`} class='float-right btn btn-sm btn-link'><i class='fas fa-arrow-right' /></a>\n                    <a href={`${basehref || '/workouts/month/'}${prevMonth}/${prevYear}/skipScroll`} class='float-left btn btn-sm btn-link'><i class='fas fa-arrow-left' /></a>\n                    <h5><Text id='dog.calendar.month'>Måned</Text> - {MONTHS[month - 1]} {year}</h5>\n                    {dog && <div>{dog.name}</div>}\n                    <small>{util.isoDate(daysOfMonth[0], false, false, true)} - {util.isoDate(daysOfMonth[daysOfMonth.length - 1], false, false, true)}</small>\n                </div>\n\n                <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-4 mb-4'>\n                    <table class='table table-striped table-sm'>\n                        <thead>\n                            <tr>\n                                <th class='text-muted'><small><Text id='dog.calendar.week'>Uke</Text></small></th>\n                                {daysOfWeek.map(day => <th><small>{DAYS[day.getDay()]}</small></th>)}\n                                {/* <th class='text-muted'>Totalt</th> */}\n                            </tr>\n                        </thead>\n                        <tbody>\n                            {weeksInMonth && weeksInMonth.map(weekObj => {\n                                const daysOfWeek = util.getDaysInWeek(weekObj.week, year, month);\n                                return (\n                                    <tr>\n                                        <td class='text-right text-muted pt-3'>\n                                            <small>\n                                                {weekObj.week}\n                                            </small>\n                                        </td>\n                                        {daysOfWeek.map(day => {\n                                            const yyyy = day.getFullYear();\n                                            const mm = day.getMonth() + 1;\n                                            const dd = day.getDate()\n                                            const histories = userStore.findHistory(yyyy, mm, dd);\n                                            const endHistories = userStore.findEndHistory(yyyy, mm, dd);\n                                            // { \"id\": \"5f59d861eaa7385aaef6b399\", \"date\": \"2020-09-09T19:00:00.000Z\", \"year\": 2020, \"month\": 9,\n                                            // \"day\": 9, \"createdDate\": \"2020-09-10T07:40:17.834Z\", \"title\": \"Spiste ikke opp alt\",\n                                            // \"historyType\": \"foodLeftover\", \"images\": [], \"dogId\": 4, \"dogName\": \"Glenn\", \"dogShortname\": \"\",\n  \t\t\t\t\t\t\t\t\t\t\tconst isChosen = (chosenYYYY == yyyy && chosenMM == mm && chosenDD == dd);\n\t\t\t\t\t\t\t\t\t\t\tconst isToday =  (currentYear == yyyy) && (currentMonth == mm) && (currentDay == dd);\n\t\t\t\t\t\t\t\t\t\t\tconst isDayOff = RED_DAYS.indexOf(day.getDay()) > -1;\n\n                                            return (\n                                                <td class={`text-center font-weight-light position-relative pt-3 ${isChosen ? 'calendarIsChosen' : ''} ${isToday ? 'calendarIsToday' : ''} ${isDayOff ? 'calendarIsWeekend' : ''}`}\n                                                    style={`font-size: 0.8em;`}\n                                                    onClick={this.chooseDay} data-day={dd} data-month={mm} data-year={yyyy}\n                                                >\n                                                    <div class='position-absolute text-muted' style='top: 0px; right: 2px; font-size: 0.7em;'>\n                                                        {day.getDate()}\n                                                    </div>\n\n                                                    {histories && histories.length > 0 ? <>\n                                                        {histories.filter(filterHistories).map((history, idx) => {\n                                                            if (!history.historyType) {\n                                                                return (\n                                                                    <div class='rounded-circle position-absolute border'\n                                                                        style={`background-color: #808080; top: 50%; left: ${idx * 5}px; width: 15px; height: 15px;`}\n                                                                    />\n                                                                );\n                                                            }\n                                                            const bgColor = mu.getHistoryTypeColor(history.historyType);\n                                                            return (\n                                                                <div class='rounded-circle position-absolute border'\n                                                                    style={`background-color: ${bgColor}; top: 50%; left: ${idx * 5}px; width: 15px; height: 15px;`}\n                                                                />\n                                                            );\n                                                        })}\n                                                        {histories.length > 1 && <span class='position-absolute text-danger'\n                                                            style='bottom: 0; right: 0px; font-size: 0.7em;'>{histories.length}</span>}\n                                                    </>: '-'}\n\n                                                    {endHistories && endHistories.length > 0 ? <>\n                                                        {endHistories.filter(filterHistories).map((history, idx) => {\n                                                            if (!history.historyType) {\n                                                                return (\n                                                                    <div class='rounded position-absolute border border-white'\n                                                                        style={`background-color: #808080; top: 50%; left: ${idx * 5}px; width: 15px; height: 15px;`}\n                                                                    />\n                                                                );\n                                                            }\n                                                            const bgColor = mu.getHistoryTypeColor(history.historyType);\n                                                            return (\n                                                                <div class='rounded position-absolute border border-white'\n                                                                    style={`background-color: ${bgColor}; top: 50%; left: ${idx * 5}px; width: 15px; height: 15px;`}\n                                                                />\n                                                            );\n                                                        })}\n                                                        {endHistories.length > 1 && <span class='position-absolute text-danger'\n                                                            style='bottom: 0; right: 0px; font-size: 0.7em;'>{endHistories.length}</span>}\n                                                    </>: '-'}\n\n                                                </td>\n                                            );\n                                        })}\n                                    </tr>\n                                );\n                            })}\n                        </tbody>\n                    </table>\n                </div>\n\n                <div class='col-12 offset-0 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 mt-4 mb-4'>\n                    <div class='clearfix'>\n                        <small>\n                            {mu.getHistoryPri().map(key => {\n                                const bgColor = mu.getHistoryTypeColor(key);\n                                return (\n                                    <span class={`float-left mr-2 ${historyType === key ? 'font-weight-bold' : 'font-weight-lighter'}`} onClick={this.setHistoryType} data-historytype={key}>\n                                        <div class='rounded-circle border float-left mr-1'\n                                            style={`background-color: ${bgColor}; width: 15px; height: 15px;`}\n                                        /> {HISTORY_TYPE_MAP[key]}\n                                    </span>\n                                );\n                            })}\n                        </small>\n                    </div>\n                    <div class='clearfix'>\n                        <small>\n                            {mu.getHistoryPri(2).map(key => {\n                                const bgColor = mu.getHistoryTypeColor(key);\n                                return (\n                                    <span class={`float-left mr-2 ${historyType === key ? 'font-weight-bold' : 'font-weight-lighter'}`} onClick={this.setHistoryType} data-historytype={key}>\n                                        <div class='rounded-circle border float-left mr-1'\n                                            style={`background-color: ${bgColor}; width: 15px; height: 15px;`}\n                                        /> {HISTORY_TYPE_MAP[key]}\n                                    </span>\n                                );\n                            })}\n                        </small>\n                    </div>\n                    <div class='clearfix'>\n                        <small>\n                            {mu.getHistoryPri(3).map(key => {\n                                const bgColor = mu.getHistoryTypeColor(key);\n                                return (\n                                    <span class={`float-left mr-2 ${historyType === key ? 'font-weight-bold' : 'font-weight-lighter'}`} onClick={this.setHistoryType} data-historytype={key}>\n                                        <div class='rounded-circle border float-left mr-1'\n                                            style={`background-color: ${bgColor}; width: 15px; height: 15px;`}\n                                        /> {HISTORY_TYPE_MAP[key]}\n                                    </span>\n                                );\n                            })}\n                        </small>\n                    </div>\n                </div>\n            </>\n        );\n    }\n}\n\nexport default HistoryCalendar;\n","import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { Text, Localizer, withText } from 'preact-i18n';\n\nimport mu from '../../lib/musher-util';\n\nimport Modal from '../modal';\nimport ImageSlider from '../imageSlider';\nimport ImageScroller from '../imageScroller';\n\n\nimport style from '../style.css';\n\nconst VACCINE_TYPES = mu.getVaccineTypes();\n\n@observer\nclass DogHistoryLine extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            showDate: false,\n        };\n    }\n\n    showModal = (e) => {\n        e.stopPropagation();\n        e.preventDefault();\n        const img = e.target.dataset.image;\n        const imgXXL = e.target.dataset.imagexxl;\n        const thumb = e.target.dataset.thumb;\n        const name = e.target.dataset.name;\n        const title = e.target.dataset.title;\n        const date = e.target.dataset.date;\n        this.setState({\n            displayModal: true,\n            currentImage: img,\n            currentImageXXL: imgXXL,\n            thumb,\n            name,\n            title,\n            date,\n        });\n    }\n\n    closeModal = () => {\n        this.setState({\n            displayModal: false,\n        });\n    }\n\n    toggleDate = () => {\n        const { showDate } = this.state;\n        this.setState({ showDate: !showDate });\n    }\n\n    touchStart = (e) => {\n        const { eventFired } = this.state;\n        if (!eventFired)  {\n            this.setState({\n                startY: e.touches[0].pageY,\n                startX: e.touches[0].pageX,\n                eventFired: false,\n                diffY: undefined,\n                diffX: undefined,\n                deleteVerify: false,\n            });\n        }\n    }\n\n    touchEnd = () => {\n        const { eventFired } = this.state;\n        if (eventFired) {\n            this.setState({\n                startY: undefined,\n                startX: undefined,\n            });\n        } else {\n            this.setState({\n                startY: undefined,\n                startX: undefined,\n                eventFired: false,\n                diffY: undefined,\n                diffX: undefined,\n                deleteVerify: false,\n            });\n        }\n    }\n\n    touchMove = (e) => {\n        const { eventFired } = this.state;\n        if (eventFired) {\n            return false;\n        }\n        const { startY, startX } = this.state;\n        const scrollDistance = 130;\n        const y = e.touches[0].pageY;\n        const x = e.touches[0].pageX;\n        const diffY = y - startY;\n        const diffX = x - startX;\n        this.setState({\n            diffY,\n            diffX,\n        });\n        if (y > (startY + scrollDistance)) {\n            // console.log('swiping down', y, '>', startY + scrollDistance);\n        } else if (y < (startY - scrollDistance)) {\n            // console.log('swiping up', y, '<', startY + scrollDistance);\n        } else if (x > (startX + scrollDistance)) {\n            // console.log('swiping right', startX, x);\n        } else if (x < (startX - scrollDistance)) {\n            this.setState({\n                eventFired: true,\n            });\n        }\n    }\n\n    reset = (e) => {\n        if (e) {\n            e.stopPropagation();\n            e.preventDefault();\n        }\n        this.setState({\n            deleted: false,\n            startY: undefined,\n            startX: undefined,\n            eventFired: false,\n            diffY: undefined,\n            diffX: undefined,\n            deleteVerify: false,\n        });\n    }\n\n    deleteHistoryRequest = async (e) => {\n        e.stopPropagation();\n        this.setState({\n            deleteVerify: true,\n        });\n    }\n\n    deleteHistory = async (e) => {\n        e.stopPropagation();\n        const { dogStore } = this.props.stores;\n        const { line } = this.props;\n        await dogStore.save({\n\t\t\tid: line.dogId,\n\t\t\t$pull: {\n                history: { _id: line.id || line._id },\n\t\t\t},\n\t\t});\n        this.setState({\n            deleted: true,\n            startY: undefined,\n            startX: undefined,\n            eventFired: false,\n            diffY: undefined,\n            diffX: undefined,\n            deleteVerify: false,\n        });\n    }\n\n    swipeLeft = (e) => {\n        const { eventFired } = this.state;\n        e.stopPropagation();\n        if (eventFired) {\n            this.reset();\n        } else {\n            this.setState({\n                eventFired: true,\n                diffX: -130,\n            });\n        }\n    }\n\n    componentWillReceiveProps(nextProps) {\n        // console.log('componentWillReceiveProps', nextProps);\n        if (nextProps.line.id !== this.props.line.id) {\n            this.reset();\n        }\n    }\n\n    render() {\n        const { userStore } = this.props.stores;\n        const { user } = userStore;\n        const { language = 'en' } = user;\n        const HISTORY_TYPE_MAP = mu.getHistoryMap(language);\n\n        const { displayModal, currentImage, currentImageXXL, showDate, thumb, name, title, date } = this.state;\n        const { line } = this.props;\n        const { diffX, deleted, deleteVerify } = this.state;\n        const hasImage = line.images && line.images.length > 0;\n        const isBeeingEdited = diffX < 0;\n        return (\n            <div class={`w-100 mb-4 position-relative ${style.hoverElement}`}\n                onTouchstart={deleted ? () => {} : this.touchStart}\n                onTouchend={deleted ? () => {} : this.touchEnd}\n                onTouchmove={deleted ? () => {} : this.touchMove}\n                onClick={!deleted && isBeeingEdited ? this.reset : () => {}}\n                style={`opacity: ${deleted ? 0.3 : 1};`}\n            >\n                {!isBeeingEdited && !deleted && <div class={`position-absolute ${style.hoverelementonly}`} style='top: 0px; right: 0px; z-index: 1000;'>\n                    <button class='btn btn-sm btn-secondary' type='button'\n                        onClick={this.swipeLeft}\n                    >\n                        <i class='fas fa-ellipsis-h' />\n                    </button>\n                </div>}\n                {isBeeingEdited && !deleted && <div class='position-absolute' style={`right: 0px; top: 10%; overflow: hidden; width: ${Math.abs(diffX) || 0}px; line-height: 0.8em;`}>\n                    {!line.grouped && <>\n                        {deleteVerify ?\n                            <>\n                                <button class='btn btn-sm btn-secondary float-right ml-3 mb-3'\n                                    onClick={this.reset}\n                                >\n                                    <i class='fas fa-times' /> <Text id='dog.history.no'>Nei</Text>\n                                </button>\n                                <button class='btn btn-sm btn-success float-right'\n                                    onClick={this.deleteHistory}\n                                >\n                                    <i class='fas fa-check' /> <Text id='dog.history.yes'>Ja</Text>\n                                </button>\n                            </>:\n                            <button class='btn btn-sm btn-danger float-right'\n                                onClick={this.deleteHistoryRequest}\n                            >\n                                <i class='fas fa-trash' /> <Text id='dog.history.delete'>Slett</Text>\n                            </button>\n                        }\n                    </>}\n                    {line.grouped && <small>\n                        <Text id='dog.history.cant-delete-groups'>Kan ikke slette grupperinger. Gå inn på hundene og slett der.</Text><br />\n                        <button class='btn btn-sm btn-success float-right'\n                            onClick={this.reset}\n                        >\n                            <i class='fas fa-check' /> Ok\n                        </button>\n                    </small>}\n                </div>}\n                <div class='row position-relative' style={`left: ${isBeeingEdited ? diffX : 0}px;`}>\n                    <div class='col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 d-flex mb-0 position-relative'>\n                        {/* {JSON.stringify(dog, null, 4)} */}\n                        {line.dogImage ? <div class={`text-center border rounded-circle imageRounded imageRoundedSmall`} style={line.dogImage ? `background-image: url(\"${line.dogImage.s3SmallLink}\"); background-size: cover;` : ''}>\n                            &nbsp;\n                        </div> : <div class={`text-center border rounded-circle imageRounded imageRoundedSmall`} style={line.images && line.images[0] ? `background-image: url(\"${line.images[0].s3SmallLink}\"); background-size: cover;` : ''}>\n                            {!hasImage && <i class='fas fa-rss text-muted mt-2' style='font-size: 20px;' />}\n                        </div>}                        \n                        <div class='flex-grow-1 pl-3 pr-2' style='line-height: 1.0em;'>\n                            {!line.grouped && line.dogId && <a class='stretched-link' href={`/dogs/${line.dogId}`}>\n                                <strong class='mr-2'>{line.dogShortname || line.dogName}: </strong>\n                            </a>}\n                            {line.title}<br />\n                            \n                            {line.grouped && (\n                                <>\n                                    <div class='w-100 clearfix mt-2'>\n                                        {line.grouped.map(el => (\n                                            <>\n                                                <a href={`/dogs/${el.dogId}`}>\n                                                    {el.dogImage ? (\n                                                        <div class={`text-center border rounded-circle imageRounded imageRoundedThumb float-left`}\n                                                            style={`margin-right: 2px; ${el.dogImage ? `background-image: url(\"${el.dogImage.s3SmallLink}\");` : ''}`}\n                                                        >\n                                                            &nbsp;\n                                                        </div>\n                                                    ) : (\n                                                        <div class={`text-center border rounded-circle imageRounded imageRoundedThumb float-left text-muted pt-1`} \n                                                            style={`margin-right: 2px; ${el.images && el.images[0] ? `background-image: url(\"${el.images[0].s3SmallLink}\");` : ''}`}\n                                                        >\n                                                            {/* {!hasImage && <i class='fas fa-dog text-muted' style='font-size: 10px;' />} */}\n                                                            {!hasImage && <span style='font-size: 15px;'>{util.ucfirst(el.dogName, true)}</span>}\n                                                        </div>\n                                                    )}\n                                                </a>\n                                            </>\n                                        ))}\n                                    </div>\n                                    <div class='w-100 clearfix mt-2'>\n                                        <small>\n                                            {line.grouped.map(el => (\n                                                <span class='float-left mr-2 text-muted'>\n                                                    <a href={`/dogs/${el.dogId}`}>\n                                                        {el.dogShortname || el.dogName}\n                                                    </a>\n                                                </span>\n                                            ))}\n                                        </small>\n                                    </div>\n                                </>\n                            )}\n\n                            <div class='w-100 clearfix'>\n                                <small class='text-muted'>\n                                    {line.date && <small onClick={this.toggleDate}>\n                                        {showDate ? util.formatDate(line.date, { locale: 'no-NB' }) : util.formatDistance(line.date, new Date(), { locale: 'no-NB' })}\n                                        {line.endDate && <span class='ml-3'><i class='fas fa-hourglass-end' /> {util.formatDate(line.endDate, { locale: 'no-NB' })}</span>}\n                                        {line.historyType && <span class='ml-3'>\n                                            <i class='fas fa-folder-open' /> {HISTORY_TYPE_MAP[line.historyType]} {line.vaccineType ? ` - ${VACCINE_TYPES[line.vaccineType].name}` : ''}\n                                        </span>}\n                                        {line.weight && <span class='ml-3'><i class='fas fa-balance-scale' /> {line.weight} kg</span>}\n                                        {line.bodyScore && <span class='ml-3'><i class='fas fa-dog' /> {line.bodyScore}</span>}\n                                        {line.user && line.user.email && <span class='ml-3'><i class='fas fa-user' /> {line.user.email}</span>}\n                                    </small>}\n                                </small>\n                            </div>\n\n                            <div class='row mt-2'>\n                                <div class='col-12'>\n                                    <span class='font-weight-normal'>{line.comment}</span>\n                                    <span class='float-right'>\n                                        {line.cost ? `Kr. ${util.format(line.cost, 2)}` : ''}\n                                    </span>\n                                </div>\n                            </div>\n\n                        </div>\n                    </div>\n\n                    <div class='col-12 col-sm-8 col-lg-6 offset-sm-2 offset-lg-3 mt-1'>\n                        <div class='row'>\n                            <ImageScroller stores={this.props.stores} images={line.images} />\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default DogHistoryLine;\n"],"sourceRoot":""}