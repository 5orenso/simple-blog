{"version":3,"sources":["webpack:///./routes/parkmanagement/index.js"],"names":["initialState","ParkManagement","observer","Component","constructor","props","super","setWindpark","e","windmillStore","this","stores","setCurrentWindparkName","target","dataset","windpark","loadAll","state","wearStore","generateData","now","Math","floor","Date","getTime","markerDays","wutil","timeRangeDays","setState","componentDidMount","render","windparks","currentWindparkName","currentWindpark","class","style","map","wp","name","onClick","data-windpark","windmills","mill","eol","secLeftInLife","secLeftInLifeAdjusted","usedSeconds","usedCapacity","burnRate","installed","secInLifeTime","startEpoch","todayEpoch","wear","setUTCSeconds","title","maintainance","type","id","checked","production","for","capacity","role","aria-valuenow","aria-valuemin","aria-valuemax","util","format","isoDate","lat","lng"],"mappings":"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","file":"route-parkmanagement.chunk.e76ca.esm.js","sourcesContent":["import { h, Component } from 'preact';\nimport util from 'preact-util';\nimport { observer } from 'mobx-preact';\nimport { route } from 'preact-router';\n\nimport wutil from '../../lib/wifet-util';\nimport LineGraph from '../../components/lineGraph';\n\nconst initialState = {};\n\n@observer\nclass ParkManagement extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\tasync loadAll() {\n\t\tconst { wearStore } = this.props.stores;\n\t\twearStore.generateData();\n\n\t\tconst now = Math.floor(new Date().getTime() / 1000);\n\t\tconst markerDays = wutil.timeRangeDays(-4, 11);\n\t\tthis.setState({ now, markerDays });\n\t}\n\n\tsetWindpark = (e) => {\n\t\tconst { windmillStore } = this.props.stores;\n\t\tconst windpark = e.target.dataset.windpark;\n\t\twindmillStore.setCurrentWindparkName(windpark);\n\t\tthis.loadAll();\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.loadAll();\n\t}\n\n\trender() {\n\t\tconst { now, markerDays } = this.state;\n\t\tconst { windmillStore, wearStore } = this.props.stores;\n\t\tconst { wears: wearData, wearsAiFiltered: aiData } = wearStore;\n\t\tconst { windparks, currentWindparkName, currentWindpark } = windmillStore;\n\n\t\treturn (\n\t\t\t<div class='container-fluid mt-5 pt-2' style='margin-bottom: 200px;'>\n\t\t\t\t<div class='row'>\n\t\t\t\t\t<div class='col-4'>\n\t\t\t\t\t\t<h1><i class='fas fa-thermometer' /> Park management</h1>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col-8 pt-2'>\n\t\t\t\t\t\t<ul class='nav nav-pills float-right'>\n\t\t\t\t\t\t{windparks && windparks.map(wp => (\n\t\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass={`btn btn-link nav-link ${wp.name === currentWindparkName ? 'active' : ''}`}\n\t\t\t\t\t\t\t\t\tonClick={this.setWindpark}\n\t\t\t\t\t\t\t\t\tdata-windpark={wp.name}\n\t\t\t\t\t\t\t\t>{wp.name}</button>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t))}\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class='col-12'>\n\t\t\t\t\t\t<table class='table table-sm table-striped'>\n\t\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<th class='w-25'>Windmill</th>\n\t\t\t\t\t\t\t\t\t<th class=''>Installed</th>\n\t\t\t\t\t\t\t\t\t<th class=''>Maintainance</th>\n\t\t\t\t\t\t\t\t\t<th class='text-center'>Toggle</th>\n\t\t\t\t\t\t\t\t\t<th class='text-center'>Capacity</th>\n\t\t\t\t\t\t\t\t\t<th class='text-center'>Production</th>\n\t\t\t\t\t\t\t\t\t<th class='text-center'>Wear</th>\n\t\t\t\t\t\t\t\t\t<th class='text-center'>Burnrate</th>\n\t\t\t\t\t\t\t\t\t<th class='text-center'>EOL</th>\n\t\t\t\t\t\t\t\t\t<th class='text-center'>Location</th>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t\t{currentWindpark && currentWindpark.windmills && currentWindpark.windmills.map(mill => {\n\t\t\t\t\t\t\t\t\tlet eol;\n\t\t\t\t\t\t\t\t\tlet secLeftInLife;\n\t\t\t\t\t\t\t\t\tlet secLeftInLifeAdjusted;\n\t\t\t\t\t\t\t\t\tlet usedSeconds;\n\t\t\t\t\t\t\t\t\tlet usedCapacity;\n\t\t\t\t\t\t\t\t\tlet burnRate;\n\t\t\t\t\t\t\t\t\tif (mill.installed) {\n\t\t\t\t\t\t\t\t\t\tconst secInLifeTime = 17 * 365 * 86400;\n\t\t\t\t\t\t\t\t\t\tconst startEpoch = Math.floor(new Date(mill.installed).getTime() / 1000);\n\t\t\t\t\t\t\t\t\t\tconst todayEpoch = Math.floor(new Date().getTime() / 1000);\n\t\t\t\t\t\t\t\t\t\tusedSeconds = todayEpoch - startEpoch;\n\t\t\t\t\t\t\t\t\t\tsecLeftInLife = secInLifeTime - (secInLifeTime * mill.wear / 100);\n\t\t\t\t\t\t\t\t\t\tusedCapacity = usedSeconds / secInLifeTime * 100;\n\t\t\t\t\t\t\t\t\t\tburnRate = mill.wear / usedCapacity * 100;\n\t\t\t\t\t\t\t\t\t\tsecLeftInLifeAdjusted = secLeftInLife * (100 / burnRate);\n\t\t\t\t\t\t\t\t\t\teol = new Date(0);\n\t\t\t\t\t\t\t\t\t\teol.setUTCSeconds(todayEpoch + secLeftInLifeAdjusted);\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td>{mill.title}</td>\n\t\t\t\t\t\t\t\t\t\t\t<td>{mill.installed}</td>\n\t\t\t\t\t\t\t\t\t\t\t<td>{mill.maintainance}</td>\n\t\t\t\t\t\t\t\t\t\t\t<td class='text-center'>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class='custom-control custom-switch'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type='checkbox' class='custom-control-input' id={`switch${mill.title}`} checked={mill.production} />\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label class='custom-control-label' for={`switch${mill.title}`}></label>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t<td class='text-right'>{mill.capacity} Mw</td>\n\t\t\t\t\t\t\t\t\t\t\t<td class={`text-right ${mill.production ? 'text-success' : 'text-danger'}`}>\n\t\t\t\t\t\t\t\t\t\t\t\t{mill.production ? <i class='fas fa-check mr-4' /> : <i class='fas fa-exclamation-triangle mr-4' />}\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t<td class='text-right'>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class='progress'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class='progress-bar' role='progressbar' style={`width: ${mill.wear}%`} aria-valuenow={mill.wear} aria-valuemin='0' aria-valuemax='100'>{mill.wear}%</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t<td class='text-right'>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class='progress'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class={`progress-bar progress-bar-striped bg-${burnRate > 100 ? 'danger' : 'success'}`} role='progressbar' style={`width: ${burnRate}%`} aria-valuenow={burnRate} aria-valuemin='0' aria-valuemax='100'>{util.format(burnRate, 0)}%</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t<td class='text-right'>{mill.installed ? util.isoDate(eol, false, false, true) : 'n/a'}</td>\n\t\t\t\t\t\t\t\t\t\t\t<td class='text-right'>{mill.lat}, {mill.lng}</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</div>\n\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default ParkManagement;\n"],"sourceRoot":""}