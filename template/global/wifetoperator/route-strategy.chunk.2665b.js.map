{"version":3,"sources":["webpack:///./routes/strategy/index.js"],"names":["initialState","Strategy","observer","props","setWindpark","e","stores","windmillStore","setCurrentWindparkName","target","dataset","windpark","loadAll","state","xMin","xMax","now","forcastYrData","weatherYrStore","this","productionStore","priceStore","demandStore","currentWindparkName","wutil","getDateDiffTime","Math","floor","Date","getTime","setState","loadYrData","getWindSpeeds","generateData","prices","i","l","updateQueryFilter","name","park","windparks","altitude","position","lat","lon","load","Promise","all","yrPromises","length","componentDidMount","render","productionData","productionBoostData","productionLongLifeData","demandData","demands","demandAi","class","map","wp","onClick","data-windpark","width","height","showXTicks","xTicksVal","val","util","isoDate","paddingTop","dataLeft","legendLeft","yMaxLeft","yMinLeft","showYTicksLeft","yTicksLeft","unitLeft","dataRight","legendRight","yMaxRight","yMinRight","showYTicksRight","yTicksRight","unitRight","avgWindowRight","marker","Component"],"mappings":"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","file":"route-strategy.chunk.2665b.js","sourcesContent":["import { h, Component } from 'preact';\nimport { observer } from 'mobx-preact';\nimport util from 'preact-util';\n\nimport wutil from '../../lib/wifet-util';\nimport LineGraph from '../../components/lineGraph';\n\nconst initialState = {};\n\n@observer\nclass Strategy extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\tasync loadAll() {\n\t\tconst { windmillStore, weatherYrStore, productionStore, priceStore, demandStore } = this.props.stores;\n\t\tconst { currentWindparkName } = windmillStore;\n\n\t\tconst xMin = wutil.getDateDiffTime(-4);\n\t\tconst xMax = wutil.getDateDiffTime(10);\n\t\tconst now = Math.floor(new Date().getTime() / 1000);\n\t\tthis.setState({ now, xMin, xMax });\n\n\t\tawait this.loadYrData();\n\t\tconst forcastYrData = weatherYrStore.getWindSpeeds(currentWindparkName);\n\t\tpriceStore.generateData();\n\n\t\tconst { prices } = priceStore;\n\t\tproductionStore.generateData(forcastYrData, prices);\n\n\t\tdemandStore.generateData();\n\t}\n\n\tasync loadYrData() {\n\t\tconst { weatherYrStore, windmillStore } = this.props.stores;\n\t\tconst { windparks } = windmillStore;\n\n\t\tconst yrPromises = [];\n\t\tfor (let i = 0, l = windparks.length; i < l; i += 1) {\n\t\t\tconst park = windparks[i];\n\t\t\tweatherYrStore.updateQueryFilter({\n\t\t\t\tname: park.name,\n\t\t\t\taltitude: park.position.altitude,\n\t\t\t\tlat: park.position.lat,\n\t\t\t\tlon: park.position.lon,\n\t\t\t});\n\t\t\tawait weatherYrStore.load();\n\t\t}\n\t\treturn await Promise.all(yrPromises);\n\t}\n\n\tsetWindpark = (e) => {\n\t\tconst { windmillStore } = this.props.stores;\n\t\tconst windpark = e.target.dataset.windpark;\n\t\twindmillStore.setCurrentWindparkName(windpark);\n\t\tthis.loadAll();\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.loadAll();\n\t}\n\n\trender() {\n\t\tconst { now, xMin, xMax } = this.state;\n\t\tconst { windmillStore, productionStore, demandStore } = this.props.stores;\n\t\tconst { productionData, productionBoostData, productionLongLifeData } = productionStore;\n\t\tconst { demands: demandData, demandAi } = demandStore;\n\t\tconst { windparks, currentWindparkName } = windmillStore;\n\n\t\treturn (\n\t\t\t<div class='container-fluid mt-5 pt-2'>\n\t\t\t\t<div class='row'>\n\t\t\t\t\t<div class='col-4'>\n\t\t\t\t\t\t<h1><i class='fas fa-chess-knight' /> Strategy</h1>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col-8 pt-2'>\n\t\t\t\t\t\t<ul class='nav nav-pills float-right'>\n\t\t\t\t\t\t{windparks && windparks.map(wp => (\n\t\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass={`btn btn-link nav-link ${wp.name === currentWindparkName ? 'active' : ''}`}\n\t\t\t\t\t\t\t\t\tonClick={this.setWindpark}\n\t\t\t\t\t\t\t\t\tdata-windpark={wp.name}\n\t\t\t\t\t\t\t\t>{wp.name}</button>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t))}\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col-12'>\n\t\t\t\t\t\t<LineGraph\n\t\t\t\t\t\t\tstores={this.props.stores}\n\t\t\t\t\t\t\twidth={1200}\n\t\t\t\t\t\t\theight={500}\n\t\t\t\t\t\t\tshowXTicks={1}\n\t\t\t\t\t\t\txTicksVal={val => util.isoDate(val)}\n\t\t\t\t\t\t\txMin={xMin}\n\t\t\t\t\t\t\txMax={xMax}\n\t\t\t\t\t\t\tpaddingTop={30}\n\n\t\t\t\t\t\t\tdataLeft={[demandData, demandAi]}\n\t\t\t\t\t\t\tlegendLeft={['Demand', 'Demand AI prediction']}\n\t\t\t\t\t\t\tyMaxLeft={4000}\n\t\t\t\t\t\t\tyMinLeft={0}\n\t\t\t\t\t\t\tshowYTicksLeft={1}\n\t\t\t\t\t\t\tyTicksLeft={['4TW', '3TW', '2TW', '1TW', '0TW']}\n\t\t\t\t\t\t\tunitLeft={['Mw', 'Mw']}\n\n\t\t\t\t\t\t\tdataRight={[productionData, productionBoostData, productionLongLifeData]}\n\t\t\t\t\t\t\tlegendRight={['Normal production', 'Boost 10%', 'Long life -5%']}\n\t\t\t\t\t\t\tyMaxRight={4000}\n\t\t\t\t\t\t\tyMinRight={0}\n\t\t\t\t\t\t\tshowYTicksRight={1}\n\t\t\t\t\t\t\tyTicksRight={['4TW', '3TW', '2TW', '1TW', '0TW']}\n\t\t\t\t\t\t\tunitRight={['Mw']}\n\t\t\t\t\t\t\tavgWindowRight={[8, 8, 8]}\n\n\t\t\t\t\t\t\tmarker={now}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Strategy;\n"],"sourceRoot":""}