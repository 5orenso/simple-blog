{"version":3,"sources":["webpack:///./routes/home/index.js"],"names":["initialState","Home","observer","Component","constructor","props","super","setWindpark","e","windmillStore","this","stores","setCurrentWindparkName","target","dataset","windpark","loadAll","state","appState","userStore","weatherYrStore","weatherAiStore","productionStore","demandStore","priceStore","currentWindparkName","getFingerprint","getInfo","xMin","wutil","getDateDiffTime","xMax","now","Math","floor","Date","getTime","setState","loadYrData","forcastYrData","getWindSpeeds","generateData","prices","windparks","i","l","length","park","updateQueryFilter","name","altitude","position","lat","lon","load","Promise","all","render","forcasts","weatherAiData","productionData","productionBoostData","productionLongLifeData","productionDataNOK","demands","demandData","priceData","class","map","wp","onClick","data-windpark","width","height","showXTicks","xTicksVal","val","util","isoDate","paddingTop","dataLeft","legendLeft","yMaxLeft","yMinLeft","showYTicksLeft","yTicksLeft","unitLeft","avgWindowLeft","dataRight","legendRight","showYTicksRight","unitRight","hoverValRight","format","yTicksRightVal","marker"],"mappings":"4fAOA,MAAMA,EAAe,G,IAGfC,EADLC,Y,EAAD,cACmBC,YACfC,YAAYC,GACRC,MAAMD,GADS,KAiDtBE,YAAeC,IACd,MAAM,cAAEC,GAAkBC,KAAKL,MAAMM,OAErCF,EAAcG,uBADGJ,EAAEK,OAAOC,QAAQC,UAElCL,KAAKM,WAnDCN,KAAKO,M,+VAAL,IACOjB,GAEbU,KAAKM,UAGN,gBACC,MAAM,SAAEE,EAAF,UAAYC,EAAZ,cAAuBV,EAAvB,eAAsCW,EAAtC,eAAsDC,EAAtD,gBAAsEC,EAAtE,YAAuFC,EAAvF,WAAoGC,GAAed,KAAKL,MAAMM,QAC9H,oBAAEc,GAAwBhB,EAE1BS,EAASQ,uBACHP,EAAUQ,UAEtB,MAAMC,EAAOC,IAAMC,iBAAiB,GAC9BC,EAAOF,IAAMC,gBAAgB,IAC7BE,EAAMC,KAAKC,OAAM,IAAIC,MAAOC,UAAY,KAC9C1B,KAAK2B,SAAS,CAAEL,MAAKJ,OAAMG,eAErBrB,KAAK4B,aACX,MAAMC,EAAgBnB,EAAeoB,cAAcf,GAEnDJ,EAAeoB,aAAaF,GAC5Bf,EAAWiB,eACXlB,EAAYkB,eAEZ,MAAM,OAAEC,GAAWlB,EACnBF,EAAgBmB,aAAaF,EAAeG,GAG7C,mBACC,MAAM,eAAEtB,EAAF,cAAkBX,GAAkBC,KAAKL,MAAMM,QAC/C,UAAEgC,GAAclC,EAGtB,IAAK,IAAImC,EAAI,EAAGC,EAAIF,EAAUG,OAAQF,EAAIC,EAAGD,GAAK,EAAG,CACpD,MAAMG,EAAOJ,EAAUC,GACvBxB,EAAe4B,kBAAkB,CAChCC,KAAMF,EAAKE,KACXC,SAAUH,EAAKI,SAASD,SACxBE,IAAKL,EAAKI,SAASC,IACnBC,IAAKN,EAAKI,SAASE,YAEdjC,EAAekC,OAEtB,aAAaC,QAAQC,IAXF,IAqBpBC,SACC,MAAM,IAAEzB,EAAF,KAAOJ,EAAP,KAAaG,GAASrB,KAAKO,OAC3B,cAAER,EAAF,eAAiBW,EAAjB,eAAiCC,EAAjC,gBAAiDC,EAAjD,YAAkEC,EAAlE,WAA+EC,GAAed,KAAKL,MAAMM,QACzG,UAAEgC,EAAF,oBAAalB,GAAwBhB,EACrC8B,EAAgBnB,EAAeoB,cAAcf,IAC3CiC,SAAUC,GAAkBtC,GAC9B,eAAEuC,EAAF,oBAAkBC,EAAlB,uBAAuCC,EAAvC,kBAA+DC,GAAsBzC,GACnF0C,QAASC,GAAe1C,GACxBmB,OAAQwB,GAAc1C,EAE9B,OACC,mBAAK2C,MAAM,kCACV,mBAAKA,MAAM,OACV,mBAAKA,MAAM,SACV,sBAAI,iBAAGA,MAAM,mBAAb,UAED,mBAAKA,MAAM,cACV,kBAAIA,MAAM,6BACTxB,GAAaA,EAAUyB,IAAIC,GAC3B,kBAAIF,MAAM,YACT,sBACCA,MAAQ,0BAAwBE,EAAGpB,OAASxB,EAAsB,SAAW,IAC7E6C,QAAS5D,KAAKH,YACdgE,gBAAeF,EAAGpB,MACjBoB,EAAGpB,UAKR,mBAAKkB,MAAM,UACV,mBAAKA,MAAM,UACV,mBAAKA,MAAM,iCACV,iBAAGA,MAAM,qBADV,cAEC,YAAC,IAAD,CACCxD,OAAQD,KAAKL,MAAMM,OACnB6D,MAAO,KACPC,OAAQ,IACRC,WAAY,EACZC,UAAWC,GAAOC,IAAKC,QAAQF,GAC/BhD,KAAMA,EACNG,KAAMA,EACNgD,WAAY,GAEZC,SAAU,CAACpB,EAAgBC,EAAqBC,GAChDmB,WAAY,CAAC,oBAAqB,YAAa,kBAC/CC,SAAU,IACVC,SAAU,EACVC,eAAgB,EAChBC,WAAY,CAAC,QAAS,QAAS,QAAS,QAAS,QAAS,OAC1DC,SAAU,CAAC,KAAM,KAAM,MACvBC,cAAe,CAAC,EAAG,EAAG,GAEtBC,UAAW,CAACzB,GACZ0B,YAAa,CAAC,YACdC,gBAAiB,EACjBC,UAAW,CAAC,MACZC,cAAe,CAAChB,GAAOC,IAAKgB,OAAQjB,EAAM,IAAO,KAAM,EAAG,IAAK,KAAK,IACpEkB,eAAgBlB,GAAOC,IAAKgB,OAAQjB,EAAM,IAAO,KAAM,EAAG,IAAK,KAAK,GAEpEmB,OAAQ/D,MAQX,mBAAKmC,MAAM,eACV,mBAAKA,MAAM,+BACV,iBAAGA,MAAM,0BADV,WAEC,YAAC,IAAD,CACCxD,OAAQD,KAAKL,MAAMM,OACnB6D,MAAO,KACPC,OAAQ,IACRC,WAAY,EACZ9C,KAAMA,EACNG,KAAMA,EACN4C,UAAWC,GAAOC,IAAKC,QAAQF,GAC/BG,WAAY,GAEZC,SAAU,CAACzC,EAAeoB,GAC1BsB,WAAY,CAAC,kBAAmB,sBAChCC,SAAU,GACVC,SAAU,EACVC,eAAgB,EAChBC,WAAY,CAAC,QAAS,QAAS,QAAS,QAAS,QAAS,OAAQ,QAClEC,SAAU,CAAC,MAAO,MAAO,OAEzBS,OAAQ/D,MAIX,mBAAKmC,MAAM,eACV,mBAAKA,MAAM,+BACV,iBAAGA,MAAM,sBADV,sBAEC,YAAC,IAAD,CACCxD,OAAQD,KAAKL,MAAMM,OACnB6D,MAAO,KACPC,OAAQ,IACRC,WAAY,EACZ9C,KAAMA,EACNG,KAAMA,EACN4C,UAAWC,GAAOC,IAAKC,QAAQF,GAC/BG,WAAY,GAEZC,SAAU,CAACd,GACXe,WAAY,CAAC,SACbC,SAAU,IACVC,SAAU,EACVC,eAAgB,EAChBC,WAAY,CAAC,OAAQ,SAAU,OAAQ,SAAU,QACjDC,SAAU,CAAC,OAEXS,OAAQ/D,MAIX,mBAAKmC,MAAM,eACV,mBAAKA,MAAM,0BACV,iBAAGA,MAAM,4BADV,UAEC,YAAC,IAAD,CACCxD,OAAQD,KAAKL,MAAMM,OACnB6D,MAAO,KACPC,OAAQ,IACRC,WAAY,EACZ9C,KAAMA,EACNG,KAAMA,EACN4C,UAAWC,GAAOC,IAAKC,QAAQF,GAC/BG,WAAY,GAEZC,SAAU,CAACf,GACXgB,WAAY,CAAC,UACbC,SAAU,IACVC,SAAU,EACVC,eAAgB,EAChBC,WAAY,CAAC,MAAO,MAAO,MAAO,MAAO,OACzCC,SAAU,CAAC,MAEXS,OAAQ/D,a,EAWF/B","file":"route-home.chunk.c4f1f.esm.js","sourcesContent":["import { h, Component } from 'preact';\nimport { observer } from 'mobx-preact';\nimport util from 'preact-util';\n\nimport wutil from '../../lib/wifet-util';\nimport LineGraph from '../../components/lineGraph';\n\nconst initialState = {};\n\n@observer\nclass Home extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n\t\tthis.loadAll();\t\n    }\n\n\tasync loadAll() {\n\t\tconst { appState, userStore, windmillStore, weatherYrStore, weatherAiStore, productionStore, demandStore, priceStore } = this.props.stores;\n\t\tconst { currentWindparkName } = windmillStore;\n\n        appState.getFingerprint();\n        await userStore.getInfo();\n\n\t\tconst xMin = wutil.getDateDiffTime(-4);\n\t\tconst xMax = wutil.getDateDiffTime(10);\n\t\tconst now = Math.floor(new Date().getTime() / 1000);\n\t\tthis.setState({ now, xMin, xMax });\n\n\t\tawait this.loadYrData();\n\t\tconst forcastYrData = weatherYrStore.getWindSpeeds(currentWindparkName);\n\n\t\tweatherAiStore.generateData(forcastYrData);\n\t\tpriceStore.generateData();\n\t\tdemandStore.generateData();\n\n\t\tconst { prices } = priceStore;\n\t\tproductionStore.generateData(forcastYrData, prices);\n    }\n\n\tasync loadYrData() {\n\t\tconst { weatherYrStore, windmillStore } = this.props.stores;\n\t\tconst { windparks } = windmillStore;\n\n\t\tconst yrPromises = [];\n\t\tfor (let i = 0, l = windparks.length; i < l; i += 1) {\n\t\t\tconst park = windparks[i];\n\t\t\tweatherYrStore.updateQueryFilter({\n\t\t\t\tname: park.name,\n\t\t\t\taltitude: park.position.altitude,\n\t\t\t\tlat: park.position.lat,\n\t\t\t\tlon: park.position.lon,\n\t\t\t});\n\t\t\tawait weatherYrStore.load();\n\t\t}\n\t\treturn await Promise.all(yrPromises);\n\t}\n\n\tsetWindpark = (e) => {\n\t\tconst { windmillStore } = this.props.stores;\n\t\tconst windpark = e.target.dataset.windpark;\n\t\twindmillStore.setCurrentWindparkName(windpark);\n\t\tthis.loadAll();\n\t}\n\n\trender() {\n\t\tconst { now, xMin, xMax } = this.state;\n\t\tconst { windmillStore, weatherYrStore, weatherAiStore, productionStore, demandStore, priceStore } = this.props.stores;\n\t\tconst { windparks, currentWindparkName } = windmillStore;\n\t\tconst forcastYrData = weatherYrStore.getWindSpeeds(currentWindparkName);\n\t\tconst { forcasts: weatherAiData } = weatherAiStore;\n\t\tconst { productionData, productionBoostData, productionLongLifeData, productionDataNOK } = productionStore;\n\t\tconst { demands: demandData } = demandStore;\n\t\tconst { prices: priceData } = priceStore;\n\n\t\treturn (\n\t\t\t<div class='container-fluid mt-5 mb-5 pt-2'>\n\t\t\t\t<div class='row'>\n\t\t\t\t\t<div class='col-4'>\n\t\t\t\t\t\t<h1><i class='fab fa-hubspot' /> Home</h1>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col-8 pt-2'>\n\t\t\t\t\t\t<ul class='nav nav-pills float-right'>\n\t\t\t\t\t\t{windparks && windparks.map(wp => (\n\t\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass={`btn btn-link nav-link ${wp.name === currentWindparkName ? 'active' : ''}`}\n\t\t\t\t\t\t\t\t\tonClick={this.setWindpark}\n\t\t\t\t\t\t\t\t\tdata-windpark={wp.name}\n\t\t\t\t\t\t\t\t>{wp.name}</button>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t))}\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col-12'>\n\t\t\t\t\t\t<div class='d-flex'>\n\t\t\t\t\t\t\t<div class='p-2 flex-grow-1 bg-light mr-2'>\n\t\t\t\t\t\t\t\t<i class='fas fa-chart-bar' /> Production\n\t\t\t\t\t\t\t\t<LineGraph\n\t\t\t\t\t\t\t\t\tstores={this.props.stores}\n\t\t\t\t\t\t\t\t\twidth={1200}\n\t\t\t\t\t\t\t\t\theight={200}\n\t\t\t\t\t\t\t\t\tshowXTicks={1}\n\t\t\t\t\t\t\t\t\txTicksVal={val => util.isoDate(val)}\n\t\t\t\t\t\t\t\t\txMin={xMin}\n\t\t\t\t\t\t\t\t\txMax={xMax}\n\t\t\t\t\t\t\t\t\tpaddingTop={30}\n\n\t\t\t\t\t\t\t\t\tdataLeft={[productionData, productionBoostData, productionLongLifeData]}\n\t\t\t\t\t\t\t\t\tlegendLeft={['Normal production', 'Boost 10%', 'Long life -10%']}\n\t\t\t\t\t\t\t\t\tyMaxLeft={500}\n\t\t\t\t\t\t\t\t\tyMinLeft={0}\n\t\t\t\t\t\t\t\t\tshowYTicksLeft={1}\n\t\t\t\t\t\t\t\t\tyTicksLeft={['335Mw', '400Mw', '300Mw', '200Mw', '100Mw', '0Mw']}\n\t\t\t\t\t\t\t\t\tunitLeft={['Mw', 'Mw', 'Mw']}\n\t\t\t\t\t\t\t\t\tavgWindowLeft={[5, 5, 5]}\n\n\t\t\t\t\t\t\t\t\tdataRight={[productionDataNOK]}\n\t\t\t\t\t\t\t\t\tlegendRight={['Earnings']}\n\t\t\t\t\t\t\t\t\tshowYTicksRight={1}\n\t\t\t\t\t\t\t\t\tunitRight={['/h']}\n\t\t\t\t\t\t\t\t\thoverValRight={[val => util.format((val / 100) * 3600, 2, ',', ' ', true)]}\n\t\t\t\t\t\t\t\t\tyTicksRightVal={val => util.format((val / 100) * 3600, 2, ',', ' ', true)}\n\n\t\t\t\t\t\t\t\t\tmarker={now}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/* <div class='p-2 bg-light'>\n\t\t\t\t\t\t\t\t<i class='fas fa-battery-three-quarters' /> Wear status\n\t\t\t\t\t\t\t</div> */}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class='d-flex mt-2'>\n\t\t\t\t\t\t\t<div class='p-2 flex-fill bg-light mr-2'>\n\t\t\t\t\t\t\t\t<i class='fas fa-cloud-sun-rain' /> Weather\n\t\t\t\t\t\t\t\t<LineGraph\n\t\t\t\t\t\t\t\t\tstores={this.props.stores}\n\t\t\t\t\t\t\t\t\twidth={1200}\n\t\t\t\t\t\t\t\t\theight={200}\n\t\t\t\t\t\t\t\t\tshowXTicks={1}\n\t\t\t\t\t\t\t\t\txMin={xMin}\n\t\t\t\t\t\t\t\t\txMax={xMax}\n\t\t\t\t\t\t\t\t\txTicksVal={val => util.isoDate(val)}\n\t\t\t\t\t\t\t\t\tpaddingTop={30}\n\n\t\t\t\t\t\t\t\t\tdataLeft={[forcastYrData, weatherAiData]}\n\t\t\t\t\t\t\t\t\tlegendLeft={['Wind forcast Yr', 'Wind AI prediction']}\n\t\t\t\t\t\t\t\t\tyMaxLeft={30}\n\t\t\t\t\t\t\t\t\tyMinLeft={0}\n\t\t\t\t\t\t\t\t\tshowYTicksLeft={1}\n\t\t\t\t\t\t\t\t\tyTicksLeft={['30m/s', '25m/s', '20m/s', '15m/s', '10m/s', '5m/s', '0m/s']}\n\t\t\t\t\t\t\t\t\tunitLeft={['m/s', 'm/s', 'm/s']}\n\n\t\t\t\t\t\t\t\t\tmarker={now}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class='d-flex mt-2'>\n\t\t\t\t\t\t\t<div class='p-2 flex-fill bg-light mr-2'>\n\t\t\t\t\t\t\t\t<i class='fas fa-chart-line' /> Electricity prices\n\t\t\t\t\t\t\t\t<LineGraph\n\t\t\t\t\t\t\t\t\tstores={this.props.stores}\n\t\t\t\t\t\t\t\t\twidth={1200}\n\t\t\t\t\t\t\t\t\theight={200}\n\t\t\t\t\t\t\t\t\tshowXTicks={1}\n\t\t\t\t\t\t\t\t\txMin={xMin}\n\t\t\t\t\t\t\t\t\txMax={xMax}\n\t\t\t\t\t\t\t\t\txTicksVal={val => util.isoDate(val)}\n\t\t\t\t\t\t\t\t\tpaddingTop={30}\n\n\t\t\t\t\t\t\t\t\tdataLeft={[priceData]}\n\t\t\t\t\t\t\t\t\tlegendLeft={['Price']}\n\t\t\t\t\t\t\t\t\tyMaxLeft={200}\n\t\t\t\t\t\t\t\t\tyMinLeft={0}\n\t\t\t\t\t\t\t\t\tshowYTicksLeft={1}\n\t\t\t\t\t\t\t\t\tyTicksLeft={['2NOK', '1.5NOK', '1NOK', '0.5NOK', '0NOK']}\n\t\t\t\t\t\t\t\t\tunitLeft={['øre']}\n\n\t\t\t\t\t\t\t\t\tmarker={now}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class='d-flex mt-2'>\n\t\t\t\t\t\t\t<div class='p-2 flex-fill bg-light'>\n\t\t\t\t\t\t\t\t<i class='fas fa-hand-holding-usd' /> Demand\n\t\t\t\t\t\t\t\t<LineGraph\n\t\t\t\t\t\t\t\t\tstores={this.props.stores}\n\t\t\t\t\t\t\t\t\twidth={1200}\n\t\t\t\t\t\t\t\t\theight={200}\n\t\t\t\t\t\t\t\t\tshowXTicks={1}\n\t\t\t\t\t\t\t\t\txMin={xMin}\n\t\t\t\t\t\t\t\t\txMax={xMax}\n\t\t\t\t\t\t\t\t\txTicksVal={val => util.isoDate(val)}\n\t\t\t\t\t\t\t\t\tpaddingTop={30}\n\n\t\t\t\t\t\t\t\t\tdataLeft={[demandData]}\n\t\t\t\t\t\t\t\t\tlegendLeft={['Demand']}\n\t\t\t\t\t\t\t\t\tyMaxLeft={4000}\n\t\t\t\t\t\t\t\t\tyMinLeft={0}\n\t\t\t\t\t\t\t\t\tshowYTicksLeft={1}\n\t\t\t\t\t\t\t\t\tyTicksLeft={['4TW', '3TW', '2TW', '1TW', '0TW']}\n\t\t\t\t\t\t\t\t\tunitLeft={['Mw']}\n\n\t\t\t\t\t\t\t\t\tmarker={now}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Home;\n"],"sourceRoot":""}