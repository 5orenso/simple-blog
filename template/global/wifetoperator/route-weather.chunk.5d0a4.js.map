{"version":3,"sources":["webpack:///./routes/weather/index.js"],"names":["initialState","Weather","observer","props","setWindpark","e","stores","windmillStore","setCurrentWindparkName","target","dataset","windpark","loadAll","state","xMin","xMax","now","markerDays","forcastYrData","weatherAiStore","this","weatherYrStore","currentWindparkName","wutil","getDateDiffTime","getEpoch","timeRangeDays","setState","loadYrData","loadOpenData","getWindSpeeds","generateData","updateQueryFilter","name","currentWindpark","altitude","position","lat","lon","load","weatherOpenStore","componentDidMount","render","darkmode","appState","windparks","windspeeds","windspeedsOpen","weatherAiData","forcastsFiltered","class","style","map","wp","onClick","data-windpark","width","height","showXTicks","xTicksVal","val","util","isoDate","paddingTop","dataLeft","legendLeft","yMaxLeft","yMinLeft","showYTicksLeft","yTicksLeft","unitLeft","avgWindowLeft","smoothLeft","marker","markers","center","zoom","waypoints","windmills","Component"],"mappings":"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","file":"route-weather.chunk.5d0a4.js","sourcesContent":["import { h, Component } from 'preact';\nimport { observer } from 'mobx-preact';\nimport util from 'preact-util';\n\nimport wutil from '../../lib/wifet-util';\nimport LineGraph from '../../components/lineGraph';\nimport Map from '../../components/map';\n\nconst initialState = {};\n\n@observer\nclass Weather extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\tasync loadAll() {\n\t\tconst { windmillStore, weatherAiStore, weatherYrStore } = this.props.stores;\n\t\tconst { currentWindparkName } = windmillStore;\n\n\t\tconst xMin = wutil.getDateDiffTime(-4);\n\t\tconst xMax = wutil.getDateDiffTime(10);\n\t\tconst now = wutil.getEpoch();\n\t\tconst markerDays = wutil.timeRangeDays(-4, 11);\n\t\tthis.setState({ now, xMin, xMax, markerDays });\n\n\t\tawait this.loadYrData();\n\t\tawait this.loadOpenData();\n\t\tconst forcastYrData = weatherYrStore.getWindSpeeds(currentWindparkName);\n\n\t\tweatherAiStore.generateData(forcastYrData);\n\t}\n\n\tasync loadYrData() {\n\t\tconst { weatherYrStore, windmillStore } = this.props.stores;\n\t\tconst { currentWindpark } = windmillStore;\n\n\t\tweatherYrStore.updateQueryFilter({\n\t\t\tname: currentWindpark.name,\n\t\t\taltitude: currentWindpark.position.altitude,\n\t\t\tlat: currentWindpark.position.lat,\n\t\t\tlon: currentWindpark.position.lon,\n\t\t});\n\t\treturn await weatherYrStore.load();\n\t}\n\n\tasync loadOpenData() {\n\t\tconst { weatherOpenStore, windmillStore } = this.props.stores;\n\t\tconst { currentWindpark } = windmillStore;\n\n\t\tweatherOpenStore.updateQueryFilter({\n\t\t\tname: currentWindpark.name,\n\t\t\tlat: currentWindpark.position.lat,\n\t\t\tlon: currentWindpark.position.lon,\n\t\t});\n\t\treturn await weatherOpenStore.load();\n\t}\n\n\tsetWindpark = (e) => {\n\t\tconst { windmillStore } = this.props.stores;\n\t\tconst windpark = e.target.dataset.windpark;\n\t\twindmillStore.setCurrentWindparkName(windpark);\n\t\tthis.loadAll();\n\t}\n\n\tcomponentDidMount() {\n\t\t// console.log('componentDidMount');\n\t\tthis.loadAll();\n\t}\n\n\trender() {\n\t\tconst { now, xMin, xMax, markerDays } = this.state;\n\t\tconst { appState, weatherYrStore, weatherOpenStore, weatherAiStore, windmillStore } = this.props.stores;\n\t\tconst { darkmode } = appState;\n\t\tconst { windparks, currentWindparkName, currentWindpark } = windmillStore;\n\t\tconst windspeeds = weatherYrStore.getWindSpeeds(currentWindparkName);\n\t\tconst windspeedsOpen = weatherOpenStore.getWindSpeeds(currentWindparkName);\n\t\tconst { forcastsFiltered: weatherAiData } = weatherAiStore;\n\n\t\treturn (\n\t\t\t<div class='container-fluid mt-5 pt-2' style='margin-bottom: 200px;'>\n\t\t\t\t<div class='row'>\n\t\t\t\t\t<div class='col-4'>\n\t\t\t\t\t\t<h1><i class='fas fa-cloud-sun-rain' /> Weather</h1>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col-8 pt-2'>\n\t\t\t\t\t\t<ul class='nav nav-pills float-right'>\n\t\t\t\t\t\t{windparks && windparks.map(wp => (\n\t\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass={`btn btn-link nav-link ${wp.name === currentWindparkName ? 'active' : ''}`}\n\t\t\t\t\t\t\t\t\tonClick={this.setWindpark}\n\t\t\t\t\t\t\t\t\tdata-windpark={wp.name}\n\t\t\t\t\t\t\t\t>{wp.name}</button>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t))}\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col-12'>\n\t\t\t\t\t\t<LineGraph\n\t\t\t\t\t\t\tstores={this.props.stores}\n\t\t\t\t\t\t\twidth={1200}\n\t\t\t\t\t\t\theight={500}\n\t\t\t\t\t\t\tshowXTicks={1}\n\t\t\t\t\t\t\txTicksVal={val => util.isoDate(val)}\n\t\t\t\t\t\t\txMin={xMin}\n\t\t\t\t\t\t\txMax={xMax}\n\t\t\t\t\t\t\tpaddingTop={30}\n\n\t\t\t\t\t\t\t// dataLeft={[windspeeds, aiData, forcastStormData, forcastYrData]}\n\t\t\t\t\t\t\tdataLeft={[windspeeds, windspeedsOpen, weatherAiData]}\n\t\t\t\t\t\t\tlegendLeft={['Wind forcast Yr', 'Wind OpenWeather', 'Wind AI prediction']}\n\t\t\t\t\t\t\tyMaxLeft={30}\n\t\t\t\t\t\t\tyMinLeft={0}\n\t\t\t\t\t\t\tshowYTicksLeft={1}\n\t\t\t\t\t\t\tyTicksLeft={['30 m/s', '25 m/s', '20 m/s', '15 m/s', '10 m/s', '5 m/s', '0 m/s']}\n\t\t\t\t\t\t\tunitLeft={['m/s', 'm/s']}\n\t\t\t\t\t\t\tavgWindowLeft={[0, 0, 4]}\n\t\t\t\t\t\t\tsmoothLeft={[1, 1, 1]}\n\n\t\t\t\t\t\t\tmarker={now}\n\t\t\t\t\t\t\tmarkers={markerDays}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class='row pt-4'>\n\t\t\t\t\t<div class='col-12' style='height: 45vh;'>\n\t\t\t\t\t\t<Map stores={this.props.stores}\n\t\t\t\t\t\t\tdarkmode={darkmode}\n\t\t\t\t\t\t\tcenter={[currentWindpark.position.lat, currentWindpark.position.lon]}\n\t\t\t\t\t\t\tzoom={currentWindpark.zoom - 2}\n\t\t\t\t\t\t\twaypoints={currentWindpark.windmills}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{/* <xmp>{forcasts.length}</xmp>\n\t\t\t\t<xmp>{JSON.stringify(windspeeds, null, 4)}</xmp>\n\t\t\t\t<xmp>{JSON.stringify(forcasts, null, 4)}</xmp> */}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Weather;\n"],"sourceRoot":""}