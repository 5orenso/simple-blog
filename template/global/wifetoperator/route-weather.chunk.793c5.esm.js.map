{"version":3,"sources":["webpack:///./routes/weather/index.js"],"names":["initialState","Weather","observer","Component","constructor","props","super","setWindpark","e","windmillStore","this","stores","setCurrentWindparkName","target","dataset","windpark","loadAll","state","weatherAiStore","weatherYrStore","currentWindparkName","xMin","wutil","getDateDiffTime","xMax","now","Math","floor","Date","getTime","setState","loadYrData","forcastYrData","getWindSpeeds","generateData","currentWindpark","updateQueryFilter","name","altitude","position","lat","lon","load","componentDidMount","console","log","render","windparks","windspeeds","forcasts","weatherAiData","class","map","wp","onClick","data-windpark","width","height","showXTicks","xTicksVal","val","util","isoDate","paddingTop","dataLeft","legendLeft","yMaxLeft","yMinLeft","showYTicksLeft","yTicksLeft","unitLeft","marker"],"mappings":"2fAOA,MAAMA,EAAe,G,IAGfC,EADLC,Y,EAAD,cACsBC,YAClBC,YAAYC,GACRC,MAAMD,GADS,KAmCtBE,YAAeC,IACd,MAAM,cAAEC,GAAkBC,KAAKL,MAAMM,OAErCF,EAAcG,uBADGJ,EAAEK,OAAOC,QAAQC,UAElCL,KAAKM,WArCCN,KAAKO,M,+VAAL,IACOjB,GAId,gBACC,MAAM,cAAES,EAAF,eAAiBS,EAAjB,eAAiCC,GAAmBT,KAAKL,MAAMM,QAC/D,oBAAES,GAAwBX,EAE1BY,EAAOC,IAAMC,iBAAiB,GAC9BC,EAAOF,IAAMC,gBAAgB,IAC7BE,EAAMC,KAAKC,OAAM,IAAIC,MAAOC,UAAY,KAC9CnB,KAAKoB,SAAS,CAAEL,MAAKJ,OAAMG,eAErBd,KAAKqB,aACX,MAAMC,EAAgBb,EAAec,cAAcb,GAEnDF,EAAegB,aAAaF,GAG7B,mBACC,MAAM,eAAEb,EAAF,cAAkBV,GAAkBC,KAAKL,MAAMM,QAC/C,gBAAEwB,GAAoB1B,EAQ5B,OANAU,EAAeiB,kBAAkB,CAChCC,KAAMF,EAAgBE,KACtBC,SAAUH,EAAgBI,SAASD,SACnCE,IAAKL,EAAgBI,SAASC,IAC9BC,IAAKN,EAAgBI,SAASE,YAElBtB,EAAeuB,OAU7BC,oBACCC,QAAQC,IAAI,qBACZnC,KAAKM,UAGN8B,SACC,MAAM,IAAErB,EAAF,KAAOJ,EAAP,KAAaG,GAASd,KAAKO,OAC3B,eAAEE,EAAF,eAAkBD,EAAlB,cAAkCT,GAAkBC,KAAKL,MAAMM,QAC/D,UAAEoC,EAAF,oBAAa3B,GAAwBX,EACrCuC,EAAa7B,EAAec,cAAcb,IACxC6B,SAAUC,GAAkBhC,EAEpC,OACC,mBAAKiC,MAAM,6BACV,mBAAKA,MAAM,OACV,mBAAKA,MAAM,SACV,sBAAI,iBAAGA,MAAM,0BAAb,aAED,mBAAKA,MAAM,cACV,kBAAIA,MAAM,6BACTJ,GAAaA,EAAUK,IAAIC,GAC3B,kBAAIF,MAAM,YACT,sBACCA,MAAQ,0BAAwBE,EAAGhB,OAASjB,EAAsB,SAAW,IAC7EkC,QAAS5C,KAAKH,YACdgD,gBAAeF,EAAGhB,MACjBgB,EAAGhB,UAKR,mBAAKc,MAAM,UAEV,YAAC,IAAD,CACCxC,OAAQD,KAAKL,MAAMM,OACnB6C,MAAO,KACPC,OAAQ,IACRC,WAAY,EACZC,UAAWC,GAAOC,IAAKC,QAAQF,GAC/BvC,KAAMA,EACNG,KAAMA,EACNuC,WAAY,GAGZC,SAAU,CAAChB,EAAYE,GACvBe,WAAY,CAAC,kBAAmB,sBAChCC,SAAU,GACVC,SAAU,EACVC,eAAgB,EAChBC,WAAY,CAAC,SAAU,SAAU,SAAU,SAAU,SAAU,QAAS,SACxEC,SAAU,CAAC,MAAO,OAElBC,OAAQ9C,W,EAYAxB","file":"route-weather.chunk.793c5.esm.js","sourcesContent":["import { h, Component } from 'preact';\nimport { observer } from 'mobx-preact';\nimport util from 'preact-util';\n\nimport wutil from '../../lib/wifet-util';\nimport LineGraph from '../../components/lineGraph';\n\nconst initialState = {};\n\n@observer\nclass Weather extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ...initialState,\n        };\n    }\n\n\tasync loadAll() {\n\t\tconst { windmillStore, weatherAiStore, weatherYrStore } = this.props.stores;\n\t\tconst { currentWindparkName } = windmillStore;\n\n\t\tconst xMin = wutil.getDateDiffTime(-4);\n\t\tconst xMax = wutil.getDateDiffTime(10);\n\t\tconst now = Math.floor(new Date().getTime() / 1000);\n\t\tthis.setState({ now, xMin, xMax });\n\n\t\tawait this.loadYrData();\n\t\tconst forcastYrData = weatherYrStore.getWindSpeeds(currentWindparkName);\n\n\t\tweatherAiStore.generateData(forcastYrData);\n\t}\n\n\tasync loadYrData() {\n\t\tconst { weatherYrStore, windmillStore } = this.props.stores;\n\t\tconst { currentWindpark } = windmillStore;\n\n\t\tweatherYrStore.updateQueryFilter({\n\t\t\tname: currentWindpark.name,\n\t\t\taltitude: currentWindpark.position.altitude,\n\t\t\tlat: currentWindpark.position.lat,\n\t\t\tlon: currentWindpark.position.lon,\n\t\t});\n\t\treturn await weatherYrStore.load();\n\t}\n\n\tsetWindpark = (e) => {\n\t\tconst { windmillStore } = this.props.stores;\n\t\tconst windpark = e.target.dataset.windpark;\n\t\twindmillStore.setCurrentWindparkName(windpark);\n\t\tthis.loadAll();\n\t}\n\n\tcomponentDidMount() {\n\t\tconsole.log('componentDidMount');\n\t\tthis.loadAll();\n\t}\n\n\trender() {\n\t\tconst { now, xMin, xMax } = this.state;\n\t\tconst { weatherYrStore, weatherAiStore, windmillStore } = this.props.stores;\n\t\tconst { windparks, currentWindparkName } = windmillStore;\n\t\tconst windspeeds = weatherYrStore.getWindSpeeds(currentWindparkName);\n\t\tconst { forcasts: weatherAiData } = weatherAiStore;\n\n\t\treturn (\n\t\t\t<div class='container-fluid mt-5 pt-2'>\n\t\t\t\t<div class='row'>\n\t\t\t\t\t<div class='col-4'>\n\t\t\t\t\t\t<h1><i class='fas fa-cloud-sun-rain' /> Weather</h1>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col-8 pt-2'>\n\t\t\t\t\t\t<ul class='nav nav-pills float-right'>\n\t\t\t\t\t\t{windparks && windparks.map(wp => (\n\t\t\t\t\t\t\t<li class='nav-item'>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass={`btn btn-link nav-link ${wp.name === currentWindparkName ? 'active' : ''}`}\n\t\t\t\t\t\t\t\t\tonClick={this.setWindpark}\n\t\t\t\t\t\t\t\t\tdata-windpark={wp.name}\n\t\t\t\t\t\t\t\t>{wp.name}</button>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t))}\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='col-12'>\n\t\t\t\t\t{/* <xmp>{JSON.stringify(windspeeds, null, 4)}</xmp> */}\n\t\t\t\t\t\t<LineGraph\n\t\t\t\t\t\t\tstores={this.props.stores}\n\t\t\t\t\t\t\twidth={1200}\n\t\t\t\t\t\t\theight={500}\n\t\t\t\t\t\t\tshowXTicks={1}\n\t\t\t\t\t\t\txTicksVal={val => util.isoDate(val)}\n\t\t\t\t\t\t\txMin={xMin}\n\t\t\t\t\t\t\txMax={xMax}\n\t\t\t\t\t\t\tpaddingTop={30}\n\n\t\t\t\t\t\t\t// dataLeft={[windspeeds, aiData, forcastStormData, forcastYrData]}\n\t\t\t\t\t\t\tdataLeft={[windspeeds, weatherAiData]}\n\t\t\t\t\t\t\tlegendLeft={['Wind forcast Yr', 'Wind AI prediction']}\n\t\t\t\t\t\t\tyMaxLeft={30}\n\t\t\t\t\t\t\tyMinLeft={0}\n\t\t\t\t\t\t\tshowYTicksLeft={1}\n\t\t\t\t\t\t\tyTicksLeft={['30 m/s', '25 m/s', '20 m/s', '15 m/s', '10 m/s', '5 m/s', '0 m/s']}\n\t\t\t\t\t\t\tunitLeft={['m/s', 'm/s']}\n\n\t\t\t\t\t\t\tmarker={now}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{/* <xmp>{forcasts.length}</xmp>\n\t\t\t\t<xmp>{JSON.stringify(windspeeds, null, 4)}</xmp>\n\t\t\t\t<xmp>{JSON.stringify(forcasts, null, 4)}</xmp> */}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Weather;\n"],"sourceRoot":""}