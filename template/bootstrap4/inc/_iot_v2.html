{% set isPhoto = false %}
{% if file.path|match('photo') || file.path|match('film') %}
    {% set isPhoto = true %}
{% endif %}
{% set baseHref = file.path|replace('/', '', 'g') %}
{% if !page %}
    {% set page = 1 %}
{% endif %}
{% set pageStart = page - 1 %}
{% set pageStart = pageStart * limit %}
    <div class='container-full'>
        <div class='row'>
            {% for bucket, value in iotResultsFixed %}
                {% if iotDeviceChipIdRef|asString(bucket, 'sensors', 'bme280') %}
                    <div class='col-sm-4 text-center mb-4'>
                        <span class='text-muted'>
                            <i class='fas fa-temperature-low'></i> 
                            {% if iotDeviceChipIdRef[bucket] %}
                                {{ iotDeviceChipIdRef[bucket].title }}
                            {% else %}
                                {{ bucket }}
                            {% endif %}
                        </span>
                        <h2>{{ value.tempGauge|format(1) }}°C</h2>
                            <div data-widget-host="simpleGraph">
                                <script type="text/props">
                                {
                                    "legend": "Temp",
                                    "jsonData": "{{ (value.tempGraphSimpleGraph || [{x:0, y:0}])|json|addslashes|raw }}",
                                    {% if iotDeviceChipIdRef|asString(bucket, 'sensors', 'dallasTemp') %}
                                        "legendB": "Soil temp",
                                        "jsonDataB": "{{ (value.soiltempGraphSimpleGraph || [{x:0, y:0}])|json|addslashes|raw }}",
                                    {%- endif -%}
                                    "legend2": "Humidity",
                                    "jsonData2": "{{ (value.humidityGraphSimpleGraph || [{x:0, y:0}])|json|addslashes|raw }}",
                                    {% if iotDeviceChipIdRef|asString(bucket, 'sensors', 'moisture') %}
                                        "legend2B": "Moisture",
                                        "jsonData2B": "{{ (value.moistureGraphSimpleGraph || [{x:0, y:0}])|json|addslashes|raw }}",
                                        "yMin2B": 8,
                                        "yMax2B": 18,                                
                                    {%- endif -%}
                                    {% if iotDeviceChipIdRef|asString(bucket, 'sensors', 'light') %}
                                        "legend2C": "Light",
                                        "jsonData2C": "{{ (value.lightGraphSimpleGraph || [{x:0, y:0}])|json|addslashes|raw }}",
                                        "yMin2C": 40,
                                        "yMax2C": 160,                                
                                    {%- endif -%}
                                    "legend3": "Pressure",
                                    "jsonData3": "{{ (value.pressureGraphSimpleGraph || [{x:0, y:0}])|json|addslashes|raw }}",
                                    "width": 600,
                                    "height": 200,
                                    "yMax": 30,
                                    "yMax2": 100,
                                    "showYTicks": 1,
                                    "yTicks": "[\"30°C\", \"25°C\", \"20°C\", \"15°C\", \"10°C\", \"5°C\", \"0°C\"]",
                                    "showYTicks2": 1,
                                    "yTicks2": "[\"100%\",\"75%\",\"50%\",\"25%\",\"0%\"]",
                                    "showXTicks": 1,                            
                                    "xTicks": "[\"48h\",\"24h\",\"0h\"]"
                                }
                                </script>
                            </div>
                        <small>
                            {% if iotDeviceChipIdRef|asString(bucket, 'description') %}
                                <p>{{ iotDeviceChipIdRef[bucket].description }}</p>
                            {% endif %}
                            {% if iotDeviceChipIdRef|isDefined(bucket, 'sensors') %}
                                {% for sensor in ['bme280', 'dallasTemp', 'flame', 'light', 'gasMq2', 'gasMq3', 'moisture', 'motion', 'co2', 'dsm501a'] %}
                                    {% if iotDeviceChipIdRef|asString(bucket, 'sensors', sensor) %}
                                        <span class="badge badge-secondary">{{ sensor }}</span>
                                    {% endif %}
                                {% endfor %}
                            {% endif %}
                        </small>
                    </div>
                {% endif %}
            {% endfor %}
        </div>
    </div>

    <script type="text/javascript" src="/global/js/simple-graphs-0.4.1.js"></script>
